adding 500 optional negatives
2025-06-19 08:23:05,118 - INFO - Randomness sources seeded with 42 for reproducibility.
2025-06-19 08:23:05,118 - INFO - Namespace(balanced=False, balance_coeff=5, n_folds=5, n_runs=2, with_title=True, with_keywords=False, nb_opt_negs=500)
2025-06-19 08:23:05,224 - INFO - Optional negatives loaded from CSV with 5000 entries.
2025-06-19 08:23:05,224 - INFO - Loading original negatives...
2025-06-19 08:23:05,233 - INFO - Negatives column names: ['Article ID', 'Title', 'Author', 'Publication year', 'Title secondary', 'URL', 'DOI', 'Abstract', 'Criteria for exclusion A', ' Criteria for exclusion B', ' Criteria for exclusion C', 'labels', 'Keywords']
2025-06-19 08:23:05,233 - INFO - Loading original positives...
2025-06-19 08:23:05,248 - INFO - Positives column names: ['Article ID', 'Title', 'Author', 'Secondary authors', 'Keywords', 'title of unpublished reference', 'primary date', 'publication year', 'notes', 'reprint status', 'start page number', 'ending page number', 'periodical full name', 'periodical standard abbreviation', 'periodical in which article was published', 'periodical name - user abbreviation 1', 'periodical name - user abbreviation 2', 'volume number', 'issue number', 'title secondary', 'city of publication', 'publisher', 'user definable 1', 'user definable 5', 'title series', 'Abstract', 'ISSN/ISBN', 'availability', 'Misc. 1', 'Misc. 2', 'address', 'Web/URL', 'link to PDF', 'link to full-text', 'related records', 'images', 'DOI', 'labels']
2025-06-19 08:23:05,254 - INFO - Class balance:
labels
1    326
0    123
Name: count, dtype: int64
2025-06-19 08:23:05,254 - INFO -    Article ID  ...  Criteria for exclusion C
0       12959  ...                       NaN
1       13470  ...                       NaN
2        4686  ...                       NaN
3        2503  ...                       NaN
4        2951  ...                       NaN

[5 rows x 44 columns]
2025-06-19 08:23:05,276 - INFO - Original dataset size: 449
2025-06-19 08:23:05,276 - INFO - Optional negatives size: 5000
2025-06-19 08:23:05,281 - INFO - Optional negatives:                                                title  ... labels
0  Towards evidence-based conservation of subterr...  ...     -1
1                  Marine biodiversity conservation.  ...     -1
2  Climate teleconnections modulate global burned...  ...     -1
3  Integrating carbon sequestration and biodivers...  ...     -1
4  Principle, technique and application of grassl...  ...     -1

[5 rows x 7 columns]
2025-06-19 08:23:05,285 - INFO - Combined dataset size: 949
2025-06-19 08:23:05,285 - INFO - Before cleaning, head:
                                               title  ... labels
0  Feral pig (Sus scrofa) disturbance facilitates...  ...      1
1  Effects of woody plant diversity on abovegroun...  ...      1
2  Scaling species richness and endemism of tropi...  ...      1
3  Not as the crow flies: Assessing effective iso...  ...      0
4  Species-group concepts and biogeography of the...  ...      1

[5 rows x 5 columns]
2025-06-19 08:23:05,290 - INFO - Null counts before cleaning:
title        0
abstract     0
Keywords     8
doi         37
labels       0
dtype: int64
2025-06-19 08:23:05,292 - INFO - Total duplicate title: 0
2025-06-19 08:23:05,296 - INFO - Conflicts on title (same value, multiple labels):
Empty DataFrame
Columns: [title, n_labels]
Index: []
2025-06-19 08:23:05,298 - INFO - Total duplicate abstract: 0
2025-06-19 08:23:05,307 - INFO - Conflicts on abstract (same value, multiple labels):
Empty DataFrame
Columns: [abstract, n_labels]
Index: []
2025-06-19 08:23:05,309 - INFO - Total duplicate doi: 18
2025-06-19 08:23:05,311 - INFO - Conflicts on doi (same value, multiple labels):
Empty DataFrame
Columns: [doi, n_labels]
Index: []
2025-06-19 08:23:05,312 - INFO - Cleaned dataset size: 896
2025-06-19 08:23:05,312 - INFO - Number of positives : 293
2025-06-19 08:23:05,313 - INFO - Number of negatives : 603
2025-06-19 08:23:05,313 - INFO - clean_og_df size : 397
2025-06-19 08:23:05,313 - INFO - opt_neg_df size : 499
2025-06-19 08:23:05,317 - INFO - Fold 1:
2025-06-19 08:23:05,317 - INFO -   Train label distribution: {-1: 0.6779891304347826, 1: 0.23777173913043478, 0: 0.08423913043478261}
2025-06-19 08:23:05,317 - INFO -   Test label distribution: {1: 0.7375, 0: 0.2625}
2025-06-19 08:23:05,320 - INFO - Fold 2:
2025-06-19 08:23:05,320 - INFO -   Train label distribution: {-1: 0.6779891304347826, 1: 0.23777173913043478, 0: 0.08423913043478261}
2025-06-19 08:23:05,320 - INFO -   Test label distribution: {1: 0.7375, 0: 0.2625}
2025-06-19 08:23:05,322 - INFO - Fold 3:
2025-06-19 08:23:05,322 - INFO -   Train label distribution: {-1: 0.6770691994572592, 1: 0.23744911804613297, 0: 0.08548168249660787}
2025-06-19 08:23:05,322 - INFO -   Test label distribution: {1: 0.7468354430379747, 0: 0.25316455696202533}
2025-06-19 08:23:05,324 - INFO - Fold 4:
2025-06-19 08:23:05,324 - INFO -   Train label distribution: {-1: 0.6770691994572592, 1: 0.23880597014925373, 0: 0.08412483039348712}
2025-06-19 08:23:05,325 - INFO -   Test label distribution: {1: 0.7341772151898734, 0: 0.26582278481012656}
2025-06-19 08:23:05,327 - INFO - Fold 5:
2025-06-19 08:23:05,327 - INFO -   Train label distribution: {-1: 0.6770691994572592, 1: 0.23880597014925373, 0: 0.08412483039348712}
2025-06-19 08:23:05,327 - INFO -   Test label distribution: {1: 0.7341772151898734, 0: 0.26582278481012656}
2025-06-19 08:23:05,330 - INFO - Fold 1:
2025-06-19 08:23:05,330 - INFO -   Train label distribution: {-1: 0.6779891304347826, 1: 0.23777173913043478, 0: 0.08423913043478261}
2025-06-19 08:23:05,330 - INFO -   Test label distribution: {1: 0.7375, 0: 0.2625}
2025-06-19 08:23:05,332 - INFO - Fold 2:
2025-06-19 08:23:05,332 - INFO -   Train label distribution: {-1: 0.6779891304347826, 1: 0.23777173913043478, 0: 0.08423913043478261}
2025-06-19 08:23:05,332 - INFO -   Test label distribution: {1: 0.7375, 0: 0.2625}
2025-06-19 08:23:05,334 - INFO - Fold 3:
2025-06-19 08:23:05,334 - INFO -   Train label distribution: {-1: 0.6770691994572592, 1: 0.23744911804613297, 0: 0.08548168249660787}
2025-06-19 08:23:05,334 - INFO -   Test label distribution: {1: 0.7468354430379747, 0: 0.25316455696202533}
2025-06-19 08:23:05,337 - INFO - Fold 4:
2025-06-19 08:23:05,337 - INFO -   Train label distribution: {-1: 0.6770691994572592, 1: 0.23880597014925373, 0: 0.08412483039348712}
2025-06-19 08:23:05,337 - INFO -   Test label distribution: {1: 0.7341772151898734, 0: 0.26582278481012656}
2025-06-19 08:23:05,339 - INFO - Fold 5:
2025-06-19 08:23:05,339 - INFO -   Train label distribution: {-1: 0.6770691994572592, 1: 0.23880597014925373, 0: 0.08412483039348712}
2025-06-19 08:23:05,339 - INFO -   Test label distribution: {1: 0.7341772151898734, 0: 0.26582278481012656}
2025-06-19 08:23:05,340 - INFO - Indices of clean_df remain the same after resetting.
2025-06-19 08:23:05,356 - INFO - clean_df index : RangeIndex(start=0, stop=896, step=1)
Stringifying the column:   0%|          | 0/896 [00:00<?, ? examples/s]Stringifying the column: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 896/896 [00:00<00:00, 165547.61 examples/s]
Casting to class labels:   0%|          | 0/896 [00:00<?, ? examples/s]Casting to class labels: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 896/896 [00:00<00:00, 178108.83 examples/s]
2025-06-19 08:23:05,371 - INFO - Number of positives : 293
2025-06-19 08:23:05,372 - INFO - Number of negatives : 603
2025-06-19 08:23:05,372 - INFO - All 5 testâ€folds in run 1 are pairwise disjoint.
2025-06-19 08:23:05,372 - INFO - All 5 testâ€folds in run 2 are pairwise disjoint.
2025-06-19 08:23:05,373 - INFO - 
fold number 1 / 5
2025-06-19 08:23:05,378 - INFO - train split size : 736
2025-06-19 08:23:05,378 - INFO - dev split size : 80
2025-06-19 08:23:05,378 - INFO - test split size : 80
2025-06-19 08:23:05,432 - INFO - 
fold number 2 / 5
2025-06-19 08:23:05,438 - INFO - train split size : 736
2025-06-19 08:23:05,438 - INFO - dev split size : 80
2025-06-19 08:23:05,438 - INFO - test split size : 80
2025-06-19 08:23:05,492 - INFO - 
fold number 3 / 5
2025-06-19 08:23:05,497 - INFO - train split size : 737
2025-06-19 08:23:05,497 - INFO - dev split size : 80
2025-06-19 08:23:05,497 - INFO - test split size : 79
2025-06-19 08:23:05,548 - INFO - 
fold number 4 / 5
2025-06-19 08:23:05,554 - INFO - train split size : 737
2025-06-19 08:23:05,554 - INFO - dev split size : 80
2025-06-19 08:23:05,554 - INFO - test split size : 79
2025-06-19 08:23:05,603 - INFO - 
fold number 5 / 5
2025-06-19 08:23:05,608 - INFO - train split size : 737
2025-06-19 08:23:05,608 - INFO - dev split size : 80
2025-06-19 08:23:05,608 - INFO - test split size : 79
2025-06-19 08:23:05,661 - INFO - 
fold number 1 / 5
2025-06-19 08:23:05,667 - INFO - train split size : 736
2025-06-19 08:23:05,667 - INFO - dev split size : 80
2025-06-19 08:23:05,667 - INFO - test split size : 80
2025-06-19 08:23:05,718 - INFO - 
fold number 2 / 5
2025-06-19 08:23:05,723 - INFO - train split size : 736
2025-06-19 08:23:05,723 - INFO - dev split size : 80
2025-06-19 08:23:05,723 - INFO - test split size : 80
2025-06-19 08:23:05,773 - INFO - 
fold number 3 / 5
2025-06-19 08:23:05,779 - INFO - train split size : 737
2025-06-19 08:23:05,779 - INFO - dev split size : 80
2025-06-19 08:23:05,779 - INFO - test split size : 79
2025-06-19 08:23:05,830 - INFO - 
fold number 4 / 5
2025-06-19 08:23:05,835 - INFO - train split size : 737
2025-06-19 08:23:05,835 - INFO - dev split size : 80
2025-06-19 08:23:05,835 - INFO - test split size : 79
2025-06-19 08:23:05,885 - INFO - 
fold number 5 / 5
2025-06-19 08:23:05,890 - INFO - train split size : 737
2025-06-19 08:23:05,890 - INFO - dev split size : 80
2025-06-19 08:23:05,890 - INFO - test split size : 79
Loss function: BCE
Fold number: 0
Run number: 0
Model: microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract
2025-06-19 08:23:12,559 - INFO - Randomness sources seeded with 42 for reproducibility.
2025-06-19 08:23:12,560 - INFO - Random seeds set to 42
2025-06-19 08:23:12,560 - INFO - Namespace(config='configs/hpo.yaml', fold=0, run=0, gpu=None, model_name='microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract', nb_opt_negs=500, n_trials=3, hpo_metric='eval_f1', direction=None, loss='BCE', with_title=True, with_keywords=False)
2025-06-19 08:23:12,561 - INFO - {'model_name': 'google-bert/bert-base-uncased', 'num_trials': 20, 'fold': 0, 'hpo_metric': 'eval_kappa', 'direction': 'max', 'loss_type': 'BCE', 'with_title': True, 'with_keywords': False, 'nb_optional_negs': 100}
2025-06-19 08:23:12,968 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
2025-06-19 08:23:12,968 - INFO - 
fold number 1 | run no. 1
Generating train split: 0 examples [00:00, ? examples/s]Generating train split: 736 examples [00:00, 26551.94 examples/s]
Generating train split: 0 examples [00:00, ? examples/s]Generating train split: 80 examples [00:00, 13716.96 examples/s]
Generating train split: 0 examples [00:00, ? examples/s]Generating train split: 80 examples [00:00, 14359.75 examples/s]
2025-06-19 08:23:13,608 - INFO - train split size : 736
2025-06-19 08:23:13,608 - INFO - dev split size : 80
2025-06-19 08:23:13,608 - INFO - test split size : 80
Map (num_proc=32):   0%|          | 0/736 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 23/736 [00:00<00:03, 185.58 examples/s]Map (num_proc=32):  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 345/736 [00:00<00:00, 1728.48 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 736/736 [00:00<00:00, 1793.11 examples/s]
Map (num_proc=32):   0%|          | 0/80 [00:00<?, ? examples/s]Map (num_proc=32):  15%|â–ˆâ–Œ        | 12/80 [00:00<00:00, 113.95 examples/s]Map (num_proc=32):  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 56/80 [00:00<00:00, 292.85 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 80/80 [00:00<00:00, 216.40 examples/s]
Map (num_proc=32):   0%|          | 0/80 [00:00<?, ? examples/s]Map (num_proc=32):  15%|â–ˆâ–Œ        | 12/80 [00:00<00:00, 111.27 examples/s]Map (num_proc=32):  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 50/80 [00:00<00:00, 260.83 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 80/80 [00:00<00:00, 266.73 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 80/80 [00:00<00:00, 199.84 examples/s]
2025-06-19 08:23:16,014 - INFO - 3 datasets tokenized successfully
2025-06-19 08:23:16,135 - INFO - Fold 1 max seq len = 512
2025-06-19 08:23:16,135 - INFO - Starting hyperparameter search for BCE loss
2025-06-19 08:23:17,543	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
2025-06-19 08:23:18,227	INFO tune.py:253 -- Initializing Ray automatically. For cluster usage or custom Ray initialization, call `ray.init(...)` before `tune.run(...)`.
[36m(trainable pid=2440989)[0m 2025-06-19 08:23:26,075 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
[36m(trainable pid=2440989)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=2440989)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=2440989)[0m 2025-06-19 08:23:26,685 - INFO - Trial on GPU 0 using batch size 25
[36m(trainable pid=2440989)[0m 2025-06-19 08:23:26,864 - INFO - pos_weight value in TrainingArguments : 6.828424226204718
[36m(trainable pid=2440989)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=2440989)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=2441192)[0m 2025-06-19 08:23:32,709 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
[36m(trainable pid=2441192)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=2441192)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=2441192)[0m 2025-06-19 08:23:33,311 - INFO - Trial on GPU 1 using batch size 25
[36m(trainable pid=2441192)[0m 2025-06-19 08:23:33,466 - INFO - pos_weight value in TrainingArguments : 6.094080202241274
[36m(trainable pid=2441192)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=2441192)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=2441584)[0m 2025-06-19 08:23:39,060 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
[36m(trainable pid=2441584)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=2441584)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=2441584)[0m 2025-06-19 08:23:40,817 - INFO - Trial on GPU 2 using batch size 100
[36m(trainable pid=2441584)[0m 2025-06-19 08:23:40,957 - INFO - pos_weight value in TrainingArguments : 7.183206941666034
[36m(trainable pid=2441584)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=2441584)[0m   super().__init__(*args, **kwargs)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     trainable_2025-06-19_08-23-18   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-19_08-23-18
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-19_08-23-16_158592_2438123/artifacts/2025-06-19_08-23-18/trainable_2025-06-19_08-23-18/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-19 08:23:19. Total running time: 0s
Logical resource usage: 0/32 CPUs, 0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_c1f6625a   PENDING         6.82842       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_c1f6625a started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_c1f6625a config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          6.82842 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=2440989)[0m [2025-06-19 08:23:27,093] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=2440989)[0m [2025-06-19 08:23:29,709] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=2440989)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=180, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=25, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial trainable_e9ac7bd2 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_e9ac7bd2 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          6.09408 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=2441192)[0m [2025-06-19 08:23:33,854] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=2441192)[0m [2025-06-19 08:23:36,482] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=2441192)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=150, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=25, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial trainable_db65e8e4 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_db65e8e4 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          7.18321 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=2441584)[0m [2025-06-19 08:23:41,170] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=2441584)[0m [2025-06-19 08:23:43,756] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=2441584)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=24, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=100, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 3 RUNNING
Current time: 2025-06-19 08:23:49. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_c1f6625a   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ trainable_e9ac7bd2   RUNNING         6.09408       4.55539e-06         0.123031                    5 â”‚
â”‚ trainable_db65e8e4   RUNNING         7.18321       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=2441584)[0m 2025-06-19 08:24:27,990 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=2441584)[0m 2025-06-19 08:24:27,995 - INFO - eval_result: {'eval_loss': 0.7900792956352234, 'eval_f1': 0.8740740740740741, 'eval_accuracy': 0.7875, 'eval_kappa': 0.25764192139737985, 'eval_precision': 0.7763157894736842, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9573222398757935, 'eval_AP': 0.8757183109603139, 'eval_MCC': 0.38453826101633065, 'eval_NDCG': 0.9683932920854801, 'eval_runtime': 3.3219, 'eval_samples_per_second': 24.083, 'eval_steps_per_second': 0.301, 'epoch': 3.0}
2025-06-19 08:24:28,331 - INFO - Cleaning up trial db65e8e4
2025-06-19 08:24:28,331 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-19_08-23-18/trainable_db65e8e4_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512_2025-06-19_08-23-32
[36m(trainable pid=2441584)[0m 2025-06-19 08:24:28,309 - INFO - Cleared CUDA cache. Memory allocated: 1.33 GB, Memory reserved: 1.63 GB

[36m(trainable pid=2440989)[0m {'loss': 1.6358, 'grad_norm': 31.500518798828125, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}
[36m(trainable pid=2441192)[0m {'loss': 1.316, 'grad_norm': 26.03297233581543, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0}[32m [repeated 2x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
Trial status: 3 RUNNING
Current time: 2025-06-19 08:24:19. Total running time: 1min 0s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_c1f6625a   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ trainable_e9ac7bd2   RUNNING         6.09408       4.55539e-06         0.123031                    5 â”‚
â”‚ trainable_db65e8e4   RUNNING         7.18321       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=2441584)[0m {'train_runtime': 40.5849, 'train_samples_per_second': 54.404, 'train_steps_per_second': 0.591, 'train_loss': 0.7484971086184183, 'epoch': 3.0}
[36m(trainable pid=2441584)[0m STATE at ending of training  :  TrainerState(epoch=3.0, global_step=24, max_steps=24, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=100, num_train_epochs=3, num_input_tokens_seen=0, total_flos=580943994126336.0, log_history=[{'loss': 1.3322, 'grad_norm': 6.313852787017822, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0, 'step': 8}, {'loss': 0.5818, 'grad_norm': 11.163935661315918, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0, 'step': 16}, {'loss': 0.3314, 'grad_norm': 1.3847286701202393, 'learning_rate': 0.0, 'epoch': 3.0, 'step': 24}, {'train_runtime': 40.5849, 'train_samples_per_second': 54.404, 'train_steps_per_second': 0.591, 'total_flos': 580943994126336.0, 'train_loss': 0.7484971086184183, 'epoch': 3.0, 'step': 24}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=2441584)[0m {'loss': 0.3314, 'grad_norm': 1.3847286701202393, 'learning_rate': 0.0, 'epoch': 3.0}[32m [repeated 2x across cluster][0m
[36m(trainable pid=2441584)[0m {'eval_loss': 0.7900792956352234, 'eval_f1': 0.8740740740740741, 'eval_accuracy': 0.7875, 'eval_kappa': 0.25764192139737985, 'eval_precision': 0.7763157894736842, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9573222398757935, 'eval_AP': 0.8757183109603139, 'eval_MCC': 0.38453826101633065, 'eval_NDCG': 0.9683932920854801, 'eval_runtime': 3.3219, 'eval_samples_per_second': 24.083, 'eval_steps_per_second': 0.301, 'epoch': 3.0}

Trial trainable_db65e8e4 finished iteration 1 at 2025-06-19 08:24:28. Total running time: 1min 8s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_db65e8e4 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    49.5141 â”‚
â”‚ time_total_s                        49.5141 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     3 â”‚
â”‚ eval_AP                             0.87572 â”‚
â”‚ eval_MCC                            0.38454 â”‚
â”‚ eval_NDCG                           0.96839 â”‚
â”‚ eval_accuracy                        0.7875 â”‚
â”‚ eval_f1                             0.87407 â”‚
â”‚ eval_kappa                          0.25764 â”‚
â”‚ eval_loss                           0.79008 â”‚
â”‚ eval_optim_threshold                0.95732 â”‚
â”‚ eval_precision                      0.77632 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.3219 â”‚
â”‚ eval_samples_per_second              24.083 â”‚
â”‚ eval_steps_per_second                 0.301 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_db65e8e4 completed after 1 iterations at 2025-06-19 08:24:28. Total running time: 1min 9s
[36m(trainable pid=2441192)[0m {'loss': 0.8845, 'grad_norm': 16.683534622192383, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0}[32m [repeated 2x across cluster][0m

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-19 08:24:49. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_c1f6625a   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_e9ac7bd2   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_db65e8e4   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            49.5141      0.790079    0.874074            0.7875       0.257642 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=2440989)[0m {'loss': 1.2721, 'grad_norm': 29.570192337036133, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0}
[36m(trainable pid=2441192)[0m {'loss': 0.6507, 'grad_norm': 11.931262016296387, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-19 08:25:19. Total running time: 2min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_c1f6625a   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_e9ac7bd2   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_db65e8e4   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            49.5141      0.790079    0.874074            0.7875       0.257642 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=2440989)[0m {'loss': 1.1936, 'grad_norm': 21.45138168334961, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-19 08:25:49. Total running time: 2min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_c1f6625a   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_e9ac7bd2   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_db65e8e4   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            49.5141      0.790079    0.874074            0.7875       0.257642 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=2441192)[0m {'loss': 0.559, 'grad_norm': 16.633201599121094, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0}
[36m(trainable pid=2440989)[0m {'loss': 1.1406, 'grad_norm': 19.26542854309082, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-19 08:26:19. Total running time: 3min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_c1f6625a   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_e9ac7bd2   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_db65e8e4   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            49.5141      0.790079    0.874074            0.7875       0.257642 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=2441192)[0m {'loss': 0.515, 'grad_norm': 10.2951021194458, 'learning_rate': 0.0, 'epoch': 5.0}
[36m(trainable pid=2441192)[0m {'train_runtime': 171.203, 'train_samples_per_second': 21.495, 'train_steps_per_second': 0.876, 'train_loss': 0.7850330543518066, 'epoch': 5.0}
[36m(trainable pid=2441192)[0m STATE at ending of training  :  TrainerState(epoch=5.0, global_step=150, max_steps=150, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=25, num_train_epochs=5, num_input_tokens_seen=0, total_flos=966381271182138.0, log_history=[{'loss': 1.316, 'grad_norm': 26.03297233581543, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0, 'step': 30}, {'loss': 0.8845, 'grad_norm': 16.683534622192383, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0, 'step': 60}, {'loss': 0.6507, 'grad_norm': 11.931262016296387, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0, 'step': 90}, {'loss': 0.559, 'grad_norm': 16.633201599121094, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0, 'step': 120}, {'loss': 0.515, 'grad_norm': 10.2951021194458, 'learning_rate': 0.0, 'epoch': 5.0, 'step': 150}, {'train_runtime': 171.203, 'train_samples_per_second': 21.495, 'train_steps_per_second': 0.876, 'total_flos': 966381271182138.0, 'train_loss': 0.7850330543518066, 'epoch': 5.0, 'step': 150}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=2440989)[0m STATE at ending of training  :  TrainerState(epoch=6.0, global_step=180, max_steps=180, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=25, num_train_epochs=6, num_input_tokens_seen=0, total_flos=1158834488538300.0, log_history=[{'loss': 1.6358, 'grad_norm': 31.500518798828125, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0, 'step': 30}, {'loss': 1.3855, 'grad_norm': 19.38045310974121, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0, 'step': 60}, {'loss': 1.2721, 'grad_norm': 29.570192337036133, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0, 'step': 90}, {'loss': 1.1936, 'grad_norm': 21.45138168334961, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0, 'step': 120}, {'loss': 1.1406, 'grad_norm': 19.26542854309082, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0, 'step': 150}, {'loss': 1.106, 'grad_norm': 14.53369426727295, 'learning_rate': 0.0, 'epoch': 6.0, 'step': 180}, {'train_runtime': 186.4333, 'train_samples_per_second': 23.687, 'train_steps_per_second': 0.965, 'total_flos': 1158834488538300.0, 'train_loss': 1.2889400482177735, 'epoch': 6.0, 'step': 180}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=2440989)[0m {'loss': 1.106, 'grad_norm': 14.53369426727295, 'learning_rate': 0.0, 'epoch': 6.0}
[36m(trainable pid=2440989)[0m {'train_runtime': 186.4333, 'train_samples_per_second': 23.687, 'train_steps_per_second': 0.965, 'train_loss': 1.2889400482177735, 'epoch': 6.0}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-19 08:26:49. Total running time: 3min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_c1f6625a   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_e9ac7bd2   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_db65e8e4   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            49.5141      0.790079    0.874074            0.7875       0.257642 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-19 08:27:19. Total running time: 4min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_c1f6625a   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_e9ac7bd2   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_db65e8e4   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            49.5141      0.790079    0.874074            0.7875       0.257642 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=2440989)[0m 2025-06-19 08:28:12,778 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=2440989)[0m 2025-06-19 08:28:12,784 - INFO - eval_result: {'eval_loss': 1.869196891784668, 'eval_f1': 0.855072463768116, 'eval_accuracy': 0.75, 'eval_kappa': 0.06868451688009314, 'eval_precision': 0.7468354430379747, 'eval_recall': 1.0, 'eval_optim_threshold': 0.7492634057998657, 'eval_AP': 0.7758357024689844, 'eval_MCC': 0.18858311834736916, 'eval_NDCG': 0.9158293843556649, 'eval_runtime': 96.3027, 'eval_samples_per_second': 0.831, 'eval_steps_per_second': 0.042, 'epoch': 6.0}
2025-06-19 08:28:13,117 - INFO - Cleaning up trial c1f6625a
2025-06-19 08:28:13,117 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-19_08-23-18/trainable_c1f6625a_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-19_08-23-19
2025-06-19 08:28:13,117 - INFO - Current best: db65e8e4 with eval_f1 : 0.8740740740740741 at iteration 1
[36m(trainable pid=2440989)[0m 2025-06-19 08:28:13,097 - INFO - Cleared CUDA cache. Memory allocated: 1.33 GB, Memory reserved: 1.63 GB
[36m(trainable pid=2440989)[0m /home/leandre/.local/share/uv/python/cpython-3.11.11-linux-x86_64-gnu/lib/python3.11/multiprocessing/resource_tracker.py:123: UserWarning: resource_tracker: process died unexpectedly, relaunching.  Some resources might leak.
[36m(trainable pid=2440989)[0m   warnings.warn('resource_tracker: process died unexpectedly, '
[36m(trainable pid=2440989)[0m Traceback (most recent call last):
[36m(trainable pid=2440989)[0m   File "/home/leandre/.local/share/uv/python/cpython-3.11.11-linux-x86_64-gnu/lib/python3.11/multiprocessing/resource_tracker.py", line 239, in main
[36m(trainable pid=2440989)[0m     cache[rtype].remove(name)
[36m(trainable pid=2440989)[0m KeyError: '/loky-2440989-48rq2sdt'
[36m(trainable pid=2441192)[0m 2025-06-19 08:28:16,741 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=2441192)[0m 2025-06-19 08:28:16,748 - INFO - eval_result: {'eval_loss': 1.303078293800354, 'eval_f1': 0.8421052631578947, 'eval_accuracy': 0.7375, 'eval_kappa': 0.11949685534591203, 'eval_precision': 0.7567567567567568, 'eval_recall': 0.9491525423728814, 'eval_optim_threshold': 0.8966814875602722, 'eval_AP': 0.8537391874418818, 'eval_MCC': 0.1537013609890006, 'eval_NDCG': 0.961916739021799, 'eval_runtime': 108.7228, 'eval_samples_per_second': 0.736, 'eval_steps_per_second': 0.037, 'epoch': 5.0}
2025-06-19 08:28:17,221 - INFO - Cleaning up trial e9ac7bd2
2025-06-19 08:28:17,221 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-19_08-23-18/trainable_e9ac7bd2_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-19_08-23-25
2025-06-19 08:28:17,221 - INFO - Cleaning up trial c1f6625a
2025-06-19 08:28:17,221 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-19_08-23-18/trainable_c1f6625a_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-19_08-23-19
2025-06-19 08:28:17,221 - INFO - Current best: db65e8e4 with eval_f1 : 0.8740740740740741 at iteration 1
2025-06-19 08:28:17,229	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-19_08-23-18' in 0.0064s.

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-19 08:27:49. Total running time: 4min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_c1f6625a   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_e9ac7bd2   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_db65e8e4   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            49.5141      0.790079    0.874074            0.7875       0.257642 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=2440989)[0m {'eval_loss': 1.869196891784668, 'eval_f1': 0.855072463768116, 'eval_accuracy': 0.75, 'eval_kappa': 0.06868451688009314, 'eval_precision': 0.7468354430379747, 'eval_recall': 1.0, 'eval_optim_threshold': 0.7492634057998657, 'eval_AP': 0.7758357024689844, 'eval_MCC': 0.18858311834736916, 'eval_NDCG': 0.9158293843556649, 'eval_runtime': 96.3027, 'eval_samples_per_second': 0.831, 'eval_steps_per_second': 0.042, 'epoch': 6.0}

Trial trainable_c1f6625a finished iteration 1 at 2025-06-19 08:28:13. Total running time: 4min 53s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_c1f6625a result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    287.304 â”‚
â”‚ time_total_s                        287.304 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     6 â”‚
â”‚ eval_AP                             0.77584 â”‚
â”‚ eval_MCC                            0.18858 â”‚
â”‚ eval_NDCG                           0.91583 â”‚
â”‚ eval_accuracy                          0.75 â”‚
â”‚ eval_f1                             0.85507 â”‚
â”‚ eval_kappa                          0.06868 â”‚
â”‚ eval_loss                            1.8692 â”‚
â”‚ eval_optim_threshold                0.74926 â”‚
â”‚ eval_precision                      0.74684 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                        96.3027 â”‚
â”‚ eval_samples_per_second               0.831 â”‚
â”‚ eval_steps_per_second                 0.042 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_c1f6625a completed after 1 iterations at 2025-06-19 08:28:13. Total running time: 4min 53s

Trial trainable_e9ac7bd2 finished iteration 1 at 2025-06-19 08:28:17. Total running time: 4min 57s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_e9ac7bd2 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    284.772 â”‚
â”‚ time_total_s                        284.772 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     5 â”‚
â”‚ eval_AP                             0.85374 â”‚
â”‚ eval_MCC                             0.1537 â”‚
â”‚ eval_NDCG                           0.96192 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84211 â”‚
â”‚ eval_kappa                           0.1195 â”‚
â”‚ eval_loss                           1.30308 â”‚
â”‚ eval_optim_threshold                0.89668 â”‚
â”‚ eval_precision                      0.75676 â”‚
â”‚ eval_recall                         0.94915 â”‚
â”‚ eval_runtime                        108.723 â”‚
â”‚ eval_samples_per_second               0.736 â”‚
â”‚ eval_steps_per_second                 0.037 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_e9ac7bd2 completed after 1 iterations at 2025-06-19 08:28:17. Total running time: 4min 57s

Trial status: 3 TERMINATED
Current time: 2025-06-19 08:28:17. Total running time: 4min 57s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_c1f6625a   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1           287.304       1.8692      0.855072            0.75        0.0686845 â”‚
â”‚ trainable_e9ac7bd2   TERMINATED        6.09408       4.55539e-06         0.123031                    5        1           284.772       1.30308     0.842105            0.7375      0.119497  â”‚
â”‚ trainable_db65e8e4   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            49.5141      0.790079    0.874074            0.7875      0.257642  â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯2025-06-19 08:28:17,235 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x7291d06232d0>
2025-06-19 08:28:17,235 - INFO - Best trial : trainable_db65e8e4
2025-06-19 08:28:17,235 - INFO - Best config : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-19 08:28:17,236 - INFO - Best trial after optimization: {'eval_loss': 0.7900792956352234, 'eval_f1': 0.8740740740740741, 'eval_accuracy': 0.7875, 'eval_kappa': 0.25764192139737985, 'eval_precision': 0.7763157894736842, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9573222398757935, 'eval_AP': 0.8757183109603139, 'eval_MCC': 0.38453826101633065, 'eval_NDCG': 0.9683932920854801, 'eval_runtime': 3.3219, 'eval_samples_per_second': 24.083, 'eval_steps_per_second': 0.301, 'epoch': 3.0, 'timestamp': 1750314268, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': 'db65e8e4', 'date': '2025-06-19_08-24-28', 'time_this_iter_s': 49.514065980911255, 'time_total_s': 49.514065980911255, 'pid': 2441584, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 49.514065980911255, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512'}
2025-06-19 08:28:17,257 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   1.869197  0.855072  ...                        6  c1f6625a
1   1.303078  0.842105  ...                        5  e9ac7bd2
2   0.790079  0.874074  ...                        3  db65e8e4

[3 rows x 32 columns]
2025-06-19 08:28:17,441 - INFO - Trial comparison plot saved
2025-06-19 08:28:17,449 - INFO - Best Hyperparameters after HPO : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}


[36m(trainable pid=2441192)[0m 2025-06-19 08:28:17,199 - INFO - Cleared CUDA cache. Memory allocated: 1.33 GB, Memory reserved: 1.63 GB
[36m(trainable pid=2441192)[0m {'eval_loss': 1.303078293800354, 'eval_f1': 0.8421052631578947, 'eval_accuracy': 0.7375, 'eval_kappa': 0.11949685534591203, 'eval_precision': 0.7567567567567568, 'eval_recall': 0.9491525423728814, 'eval_optim_threshold': 0.8966814875602722, 'eval_AP': 0.8537391874418818, 'eval_MCC': 0.1537013609890006, 'eval_NDCG': 0.961916739021799, 'eval_runtime': 108.7228, 'eval_samples_per_second': 0.736, 'eval_steps_per_second': 0.037, 'epoch': 5.0}
2025-06-19 08:28:26,429 - INFO - Randomness sources seeded with 42 for reproducibility.
2025-06-19 08:28:26,429 - INFO - Namespace(config='configs/train.yaml', hp_config='configs/best_hpo.yaml', fold=0, run=0, gpu='2', model_name='microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract', nb_opt_negs=500, loss='BCE', with_title=True, with_keywords=False, best_metric='eval_f1')
2025-06-19 08:28:26,431 - INFO - {'model_name': 'bert-base-uncased', 'fold': 0, 'run': 0, 'output_dir': 'outputs/checkpoints', 'best_metric': 'eval_kappa', 'loss_type': 'BCE', 'nb_optional_negs': 100, 'with_title': True, 'with_keywords': False, 'default_hyperparameters': {'learning_rate': 'None', 'num_train_epochs': 'None', 'pos_weight': 'None', 'weight_decay': 'None'}}
2025-06-19 08:28:37,121 - INFO - train split size : 736
2025-06-19 08:28:37,121 - INFO - dev split size : 80
2025-06-19 08:28:37,121 - INFO - test split size : 80
2025-06-19 08:28:37,363 - INFO - 3 datasets tokenized successfully
2025-06-19 08:28:37,364 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-19 08:28:57,986 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
[2025-06-19 08:28:58,218] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-06-19 08:29:00,953] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
2025-06-19 08:29:00,991 - INFO - training size : 736
2025-06-19 08:29:00,992 - INFO - dev size : 80
2025-06-19 08:29:00,992 - INFO - test size : 80
  0%|          | 0/24 [00:00<?, ?it/s]  4%|â–         | 1/24 [00:02<00:53,  2.34s/it]  8%|â–Š         | 2/24 [00:04<00:44,  2.04s/it] 12%|â–ˆâ–Ž        | 3/24 [00:05<00:40,  1.94s/it] 17%|â–ˆâ–‹        | 4/24 [00:07<00:37,  1.88s/it] 21%|â–ˆâ–ˆ        | 5/24 [00:09<00:35,  1.86s/it] 25%|â–ˆâ–ˆâ–Œ       | 6/24 [00:11<00:33,  1.84s/it] 29%|â–ˆâ–ˆâ–‰       | 7/24 [00:13<00:30,  1.82s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 8/24 [00:13<00:23,  1.44s/it]                                               33%|â–ˆâ–ˆâ–ˆâ–Ž      | 8/24 [00:13<00:23,  1.44s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 9/24 [00:15<00:23,  1.59s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 10/24 [00:17<00:23,  1.65s/it] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 11/24 [00:19<00:22,  1.70s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 12/24 [00:21<00:20,  1.73s/it] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 13/24 [00:22<00:19,  1.76s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 14/24 [00:24<00:17,  1.79s/it] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 15/24 [00:26<00:16,  1.79s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 16/24 [00:27<00:11,  1.44s/it]                                                67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 16/24 [00:27<00:11,  1.44s/it] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 17/24 [00:29<00:11,  1.58s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 18/24 [00:30<00:09,  1.65s/it] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 19/24 [00:32<00:08,  1.70s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 20/24 [00:34<00:06,  1.74s/it] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 21/24 [00:36<00:05,  1.76s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 22/24 [00:38<00:03,  1.78s/it] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 23/24 [00:40<00:01,  1.78s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 24/24 [00:40<00:00,  1.44s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 24/24 [00:42<00:00,  1.44s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 24/24 [00:42<00:00,  1.44s/it]2025-06-19 08:29:43,809 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 24/24 [00:42<00:00,  1.77s/it]
{'loss': 1.1581, 'grad_norm': 6.918379306793213, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
{'loss': 0.4658, 'grad_norm': 4.333345890045166, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
{'loss': 0.2978, 'grad_norm': 2.06264328956604, 'learning_rate': 0.0, 'epoch': 3.0}
{'train_runtime': 42.5322, 'train_samples_per_second': 51.914, 'train_steps_per_second': 0.564, 'train_loss': 0.6405532360076904, 'epoch': 3.0}
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-19 08:32:39,824 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [02:55<00:00, 175.51s/it]
2025-06-19 08:32:39,831 - INFO - Training time : 242.4673758969875
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-19 08:36:35,834 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [03:55<00:00, 235.49s/it]
2025-06-19 08:36:35,839 - INFO - Evaluation time : 236.007519264007
2025-06-19 08:36:35,839 - INFO - Evaluation results on test set: {'eval_loss': 1.5225058794021606, 'eval_f1': 0.8296296296296296, 'eval_accuracy': 0.7125, 'eval_kappa': -0.004366812227074357, 'eval_precision': 0.7368421052631579, 'eval_recall': 0.9491525423728814, 'eval_optim_threshold': 0.976102352142334, 'eval_AP': 0.8783106100437907, 'eval_MCC': -0.006517597644344587, 'eval_NDCG': 0.9742343822875441, 'eval_runtime': 235.9953, 'eval_samples_per_second': 0.339, 'eval_steps_per_second': 0.004, 'epoch': 3.0}
2025-06-19 08:36:35,839 - INFO - Total updates (optimizer steps): 24
2025-06-19 08:36:35,839 - INFO - Avg time / step: 1.773s
2025-06-19 08:36:36,812 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCE_BiomedBERT-abs_fold-1
2025-06-19 08:36:36,812 - INFO - On test Set (with threshold 0.5) : 
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-19 08:40:26,570 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [03:49<00:00, 229.25s/it]
2025-06-19 08:40:26,574 - INFO - Raw predictions shape: (80, 1)
2025-06-19 08:40:26,575 - INFO - Raw predictions: [[3.660373 ]
 [3.5367157]
 [2.915645 ]
 [3.6638193]
 [3.7425048]
 [3.7449415]
 [3.7669137]
 [3.2258766]
 [2.4536169]
 [3.193639 ]]
2025-06-19 08:40:26,575 - INFO - Scores shape: (80,)
2025-06-19 08:40:26,575 - INFO - Scores: [0.97492224 0.9717146  0.9486144  0.9750063  0.9768538  0.97690874
 0.97739935 0.9617966  0.9208255  0.96059424]
2025-06-19 08:40:26,575 - INFO - Preds shape: (80,)
2025-06-19 08:40:26,575 - INFO - Preds: [1 1 1 1 1 1 1 1 1 1]
2025-06-19 08:40:26,575 - INFO - Test labels shape: (80,)
2025-06-19 08:40:26,575 - INFO - Test labels: [1, 1, 0, 0, 1, 1, 1, 1, 0, 0]
2025-06-19 08:40:26,575 - INFO - Test split: Dataset({
    features: ['Unnamed: 0', 'title', 'abstract', 'Keywords', 'doi', 'labels'],
    num_rows: 80
})
2025-06-19 08:40:26,575 - INFO - Unique values in predictions: [0 1]
2025-06-19 08:40:26,576 - INFO - Unique values in labels: [0 1]
2025-06-19 08:40:26,577 - INFO - Confusion matrix:
[[ 1 20]
 [ 3 56]]
2025-06-19 08:40:26,577 - INFO - Confusion matrix: TN=1, FP=20, FN=3, TP=56
2025-06-19 08:44:15,934 - INFO - Metrics: {'f1': 0.8296296296296296, 'recall': 0.9491525423728814, 'precision': 0.7368421052631579, 'accuracy': 0.7125, 'AP': 0.8783106100437907, 'MCC': -0.006517597644344587, 'NDCG': 0.9742343822875441, 'kappa': -0.004366812227074357, 'TN': 1, 'FP': 20, 'FN': 3, 'TP': 56}
2025-06-19 08:44:16,049 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-19 08:44:16,145 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-19 08:44:16,145 - INFO - 
On test Set (optimal threshold of 0.9273493885993958 according to cross validation on the training set): 
2025-06-19 08:44:16,146 - INFO - Confusion matrix: TN=5, FP=16, FN=4, TP=55
2025-06-19 08:45:11,607 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--recall/11f90e583db35601050aed380d48e83202a896976b9608432fba9244fb447f24 (last modified on Mon Mar 17 17:18:25 2025) since it couldn't be found locally at evaluate-metric--recall, or remotely on the Hugging Face Hub.
2025-06-19 08:45:13,042 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--precision/155d3220d6cd4a6553f12da68eeb3d1f97cf431206304a4bc6e2d564c29502e9 (last modified on Mon Mar 17 17:18:26 2025) since it couldn't be found locally at evaluate-metric--precision, or remotely on the Hugging Face Hub.
2025-06-19 08:45:14,458 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--accuracy/f887c0aab52c2d38e1f8a215681126379eca617f96c447638f751434e8e65b14 (last modified on Mon Mar 17 17:18:23 2025) since it couldn't be found locally at evaluate-metric--accuracy, or remotely on the Hugging Face Hub.
2025-06-19 08:45:14,466 - INFO - Metrics: {'f1': 0.8461538461538461, 'recall': 0.9322033898305084, 'precision': 0.7746478873239436, 'accuracy': 0.75, 'AP': 0.8783106100437907, 'MCC': 0.23713539014397733, 'NDCG': 0.9742343822875441, 'kappa': 0.20870425321463892, 'TN': 5, 'FP': 16, 'FN': 4, 'TP': 55}
2025-06-19 08:45:14,561 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-19 08:45:14,561 - INFO - Results for fold 1 with optim_threshold leqrned from dev set : {'f1': 0.8461538461538461, 'recall': 0.9322033898305084, 'precision': 0.7746478873239436, 'accuracy': 0.75, 'AP': 0.8783106100437907, 'MCC': 0.23713539014397733, 'NDCG': 0.9742343822875441, 'kappa': 0.20870425321463892, 'TN': 5, 'FP': 16, 'FN': 4, 'TP': 55}
2025-06-19 08:45:14,890 - INFO - Cleared CUDA cache. Memory allocated: 1.33 GB, Memory reserved: 1.63 GB
2025-06-19 08:45:14,896 - INFO - Metrics stored successfully at /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/metrics/binary_metrics.csv
Traceback (most recent call last):
  File "/home/leandre/Projects/BioMoQA_Playground/experiments/biomoqa.py", line 20, in <module>
    from src.models.biomoqa import *
  File "/home/leandre/Projects/BioMoQA_Playground/src/__init__.py", line 1, in <module>
    from .models import biomoqa
  File "/home/leandre/Projects/BioMoQA_Playground/src/models/__init__.py", line 1, in <module>
    from .biomoqa import *
  File "/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/__init__.py", line 4, in <module>
    from .old_binary_pipeline import *
  File "/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/old_binary_pipeline.py", line 109
    logger.info(f"Randomness sources seeded with {CONFIG["seed"]} for reproducibility.")
                                                          ^^^^
SyntaxError: f-string: unmatched '['
2025-06-19 08:52:12,105	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
2025-06-19 08:52:12,736 - INFO - Randomness sources seeded with 42 for reproducibility.
2025-06-19 08:52:12,737 - INFO - Random seeds set to 42
2025-06-19 08:52:12,837 - INFO - Optional negatives loaded from CSV with 5000 entries.
2025-06-19 08:52:12,837 - INFO - Loading original negatives...
2025-06-19 08:52:12,846 - INFO - Negatives column names: ['Article ID', 'Title', 'Author', 'Publication year', 'Title secondary', 'URL', 'DOI', 'Abstract', 'Criteria for exclusion A', ' Criteria for exclusion B', ' Criteria for exclusion C', 'labels', 'Keywords']
2025-06-19 08:52:12,846 - INFO - Loading original positives...
2025-06-19 08:52:12,862 - INFO - Positives column names: ['Article ID', 'Title', 'Author', 'Secondary authors', 'Keywords', 'title of unpublished reference', 'primary date', 'publication year', 'notes', 'reprint status', 'start page number', 'ending page number', 'periodical full name', 'periodical standard abbreviation', 'periodical in which article was published', 'periodical name - user abbreviation 1', 'periodical name - user abbreviation 2', 'volume number', 'issue number', 'title secondary', 'city of publication', 'publisher', 'user definable 1', 'user definable 5', 'title series', 'Abstract', 'ISSN/ISBN', 'availability', 'Misc. 1', 'Misc. 2', 'address', 'Web/URL', 'link to PDF', 'link to full-text', 'related records', 'images', 'DOI', 'labels']
2025-06-19 08:52:12,867 - INFO - Class balance:
labels
1    326
0    123
Name: count, dtype: int64
2025-06-19 08:52:12,867 - INFO -    Article ID  ...  Criteria for exclusion C
0       12959  ...                       NaN
1       13470  ...                       NaN
2        4686  ...                       NaN
3        2503  ...                       NaN
4        2951  ...                       NaN

[5 rows x 44 columns]
2025-06-19 08:52:12,892 - INFO - Original dataset size: 449
2025-06-19 08:52:12,892 - INFO - Optional negatives size: 5000
2025-06-19 08:52:12,897 - INFO - Optional negatives:                                                title  ... labels
0  Towards evidence-based conservation of subterr...  ...     -1
1                  Marine biodiversity conservation.  ...     -1
2  Climate teleconnections modulate global burned...  ...     -1
3  Integrating carbon sequestration and biodivers...  ...     -1
4  Principle, technique and application of grassl...  ...     -1

[5 rows x 7 columns]
2025-06-19 08:52:12,900 - INFO - Combined dataset size: 949
2025-06-19 08:52:12,900 - INFO - Before cleaning, head:
                                               title  ... labels
0  Feral pig (Sus scrofa) disturbance facilitates...  ...      1
1  Effects of woody plant diversity on abovegroun...  ...      1
2  Scaling species richness and endemism of tropi...  ...      1
3  Not as the crow flies: Assessing effective iso...  ...      0
4  Species-group concepts and biogeography of the...  ...      1

[5 rows x 5 columns]
2025-06-19 08:52:12,905 - INFO - Null counts before cleaning:
title        0
abstract     0
Keywords     8
doi         37
labels       0
dtype: int64
2025-06-19 08:52:12,908 - INFO - Total duplicate title: 0
2025-06-19 08:52:12,913 - INFO - Conflicts on title (same value, multiple labels):
Empty DataFrame
Columns: [title, n_labels]
Index: []
2025-06-19 08:52:12,915 - INFO - Total duplicate abstract: 0
2025-06-19 08:52:12,924 - INFO - Conflicts on abstract (same value, multiple labels):
Empty DataFrame
Columns: [abstract, n_labels]
Index: []
2025-06-19 08:52:12,926 - INFO - Total duplicate doi: 18
2025-06-19 08:52:12,929 - INFO - Conflicts on doi (same value, multiple labels):
Empty DataFrame
Columns: [doi, n_labels]
Index: []
2025-06-19 08:52:12,930 - INFO - Cleaned dataset size: 896
2025-06-19 08:52:12,930 - INFO - Number of positives : 293
2025-06-19 08:52:12,930 - INFO - Number of negatives : 603
2025-06-19 08:52:12,931 - INFO - clean_og_df size : 397
2025-06-19 08:52:12,931 - INFO - opt_neg_df size : 499
2025-06-19 08:52:12,935 - INFO - Fold 1:
2025-06-19 08:52:12,935 - INFO -   Train label distribution: {-1: 0.6779891304347826, 1: 0.23777173913043478, 0: 0.08423913043478261}
2025-06-19 08:52:12,935 - INFO -   Test label distribution: {1: 0.7375, 0: 0.2625}
2025-06-19 08:52:12,938 - INFO - Fold 2:
2025-06-19 08:52:12,938 - INFO -   Train label distribution: {-1: 0.6779891304347826, 1: 0.23777173913043478, 0: 0.08423913043478261}
2025-06-19 08:52:12,938 - INFO -   Test label distribution: {1: 0.7375, 0: 0.2625}
2025-06-19 08:52:12,940 - INFO - Fold 3:
2025-06-19 08:52:12,940 - INFO -   Train label distribution: {-1: 0.6770691994572592, 1: 0.23744911804613297, 0: 0.08548168249660787}
2025-06-19 08:52:12,940 - INFO -   Test label distribution: {1: 0.7468354430379747, 0: 0.25316455696202533}
2025-06-19 08:52:12,943 - INFO - Fold 4:
2025-06-19 08:52:12,943 - INFO -   Train label distribution: {-1: 0.6770691994572592, 1: 0.23880597014925373, 0: 0.08412483039348712}
2025-06-19 08:52:12,943 - INFO -   Test label distribution: {1: 0.7341772151898734, 0: 0.26582278481012656}
2025-06-19 08:52:12,945 - INFO - Fold 5:
2025-06-19 08:52:12,945 - INFO -   Train label distribution: {-1: 0.6770691994572592, 1: 0.23880597014925373, 0: 0.08412483039348712}
2025-06-19 08:52:12,945 - INFO -   Test label distribution: {1: 0.7341772151898734, 0: 0.26582278481012656}
2025-06-19 08:52:12,948 - INFO - Fold 1:
2025-06-19 08:52:12,948 - INFO -   Train label distribution: {-1: 0.6779891304347826, 1: 0.23777173913043478, 0: 0.08423913043478261}
2025-06-19 08:52:12,948 - INFO -   Test label distribution: {1: 0.7375, 0: 0.2625}
2025-06-19 08:52:12,950 - INFO - Fold 2:
2025-06-19 08:52:12,950 - INFO -   Train label distribution: {-1: 0.6779891304347826, 1: 0.23777173913043478, 0: 0.08423913043478261}
2025-06-19 08:52:12,950 - INFO -   Test label distribution: {1: 0.7375, 0: 0.2625}
2025-06-19 08:52:12,953 - INFO - Fold 3:
2025-06-19 08:52:12,953 - INFO -   Train label distribution: {-1: 0.6770691994572592, 1: 0.23744911804613297, 0: 0.08548168249660787}
2025-06-19 08:52:12,953 - INFO -   Test label distribution: {1: 0.7468354430379747, 0: 0.25316455696202533}
2025-06-19 08:52:12,955 - INFO - Fold 4:
2025-06-19 08:52:12,955 - INFO -   Train label distribution: {-1: 0.6770691994572592, 1: 0.23880597014925373, 0: 0.08412483039348712}
2025-06-19 08:52:12,955 - INFO -   Test label distribution: {1: 0.7341772151898734, 0: 0.26582278481012656}
2025-06-19 08:52:12,957 - INFO - Fold 5:
2025-06-19 08:52:12,957 - INFO -   Train label distribution: {-1: 0.6770691994572592, 1: 0.23880597014925373, 0: 0.08412483039348712}
2025-06-19 08:52:12,957 - INFO -   Test label distribution: {1: 0.7341772151898734, 0: 0.26582278481012656}
2025-06-19 08:52:12,958 - INFO - Indices of clean_df remain the same after resetting.
2025-06-19 08:52:12,977 - INFO - clean_df index : RangeIndex(start=0, stop=896, step=1)
Stringifying the column:   0%|          | 0/896 [00:00<?, ? examples/s]Stringifying the column: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 896/896 [00:00<00:00, 155666.32 examples/s]
Casting to class labels:   0%|          | 0/896 [00:00<?, ? examples/s]Casting to class labels: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 896/896 [00:00<00:00, 175521.76 examples/s]
2025-06-19 08:52:12,994 - INFO - Number of positives : 293
2025-06-19 08:52:12,995 - INFO - Number of negatives : 603
2025-06-19 08:52:12,995 - INFO - All 5 testâ€folds in run 1 are pairwise disjoint.
2025-06-19 08:52:12,996 - INFO - All 5 testâ€folds in run 2 are pairwise disjoint.
2025-06-19 08:52:12,996 - INFO - with_title : True
2025-06-19 08:52:12,996 - INFO - with_keywords : False
2025-06-19 08:52:12,996 - INFO - fold indexes for run no.1: [[392, 341, 378, 173, 113, 324, 114, 177, 302, 216, 267, 44, 264, 187, 70, 68, 73, 226, 15, 300, 223, 163, 236, 337, 112, 65, 327, 12, 125, 385, 103, 43, 274, 330, 94, 220, 18, 225, 123, 199, 295, 120, 355, 389, 28, 137, 357, 23, 89, 134, 145, 339, 308, 171, 228, 356, 373, 76, 323, 203, 258, 222, 133, 111, 313, 36, 319, 375, 256, 61, 393, 175, 344, 116, 260, 3, 334, 396, 273, 107, 139, 60, 109, 303, 42, 194, 343, 248, 320, 332, 37, 4, 72, 81, 118, 146, 246, 135, 286, 151, 380, 183, 170, 46, 115, 346, 35, 189, 235, 237, 354, 55, 172, 278, 261, 150, 305, 368, 304, 395, 83, 161, 215, 325, 366, 162, 232, 105, 64, 127, 381, 269, 229, 205, 318, 59, 307, 96, 149, 136, 331, 24, 27, 99, 19, 252, 39, 309, 66, 144, 117, 292, 342, 168, 210, 247, 82, 374, 14, 169, 190, 348, 181, 376, 63, 159, 299, 377, 294, 121, 91, 192, 95, 391, 253, 204, 200, 148, 10, 358, 38, 138, 97, 265, 132, 104, 33, 209, 394, 243, 370, 31, 155, 321, 62, 126, 384, 387, 350, 263, 40, 369, 87, 48, 217, 54, 130, 276, 244, 2, 157, 6, 219, 317, 32, 336, 141, 268, 312, 166, 7, 49, 353, 196, 176, 185, 306, 207, 93, 21, 297, 77, 224, 233, 290, 41, 202, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 532, 533, 534, 535, 536, 537, 538, 539, 540, 541, 542, 543, 544, 545, 546, 547, 548, 549, 550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 560, 561, 562, 563, 564, 565, 566, 567, 568, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582, 583, 584, 585, 586, 587, 588, 589, 590, 591, 592, 593, 594, 595, 596, 597, 598, 599, 600, 601, 602, 603, 604, 605, 606, 607, 608, 609, 610, 611, 612, 613, 614, 615, 616, 617, 618, 619, 620, 621, 622, 623, 624, 625, 626, 627, 628, 629, 630, 631, 632, 633, 634, 635, 636, 637, 638, 639, 640, 641, 642, 643, 644, 645, 646, 647, 648, 649, 650, 651, 652, 653, 654, 655, 656, 657, 658, 659, 660, 661, 662, 663, 664, 665, 666, 667, 668, 669, 670, 671, 672, 673, 674, 675, 676, 677, 678, 679, 680, 681, 682, 683, 684, 685, 686, 687, 688, 689, 690, 691, 692, 693, 694, 695, 696, 697, 698, 699, 700, 701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 714, 715, 716, 717, 718, 719, 720, 721, 722, 723, 724, 725, 726, 727, 728, 729, 730, 731, 732, 733, 734, 735, 736, 737, 738, 739, 740, 741, 742, 743, 744, 745, 746, 747, 748, 749, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764, 765, 766, 767, 768, 769, 770, 771, 772, 773, 774, 775, 776, 777, 778, 779, 780, 781, 782, 783, 784, 785, 786, 787, 788, 789, 790, 791, 792, 793, 794, 795, 796, 797, 798, 799, 800, 801, 802, 803, 804, 805, 806, 807, 808, 809, 810, 811, 812, 813, 814, 815, 816, 817, 818, 819, 820, 821, 822, 823, 824, 825, 826, 827, 828, 829, 830, 831, 832, 833, 834, 835, 836, 837, 838, 839, 840, 841, 842, 843, 844, 845, 846, 847, 848, 849, 850, 851, 852, 853, 854, 855, 856, 857, 858, 859, 860, 861, 862, 863, 864, 865, 866, 867, 868, 869, 870, 871, 872, 873, 874, 875, 876, 877, 878, 879, 880, 881, 882, 883, 884, 885, 886, 887, 888, 889, 890, 891, 892, 893, 894, 895], [174, 311, 45, 242, 251, 241, 188, 102, 283, 250, 388, 239, 328, 255, 230, 84, 333, 29, 67, 279, 227, 338, 80, 211, 56, 315, 218, 206, 386, 129, 245, 158, 301, 262, 291, 314, 178, 8, 88, 254, 0, 57, 329, 367, 156, 266, 289, 284, 213, 147, 285, 296, 191, 322, 85, 214, 98, 100, 282, 212, 52, 53, 30, 51, 179, 131, 298, 167, 352, 326, 365, 92, 34, 363, 78, 26, 71, 1, 17, 50], [5, 9, 11, 13, 16, 20, 22, 25, 47, 58, 69, 74, 75, 79, 86, 90, 101, 106, 108, 110, 119, 122, 124, 128, 140, 142, 143, 152, 153, 154, 160, 164, 165, 180, 182, 184, 186, 193, 195, 197, 198, 201, 208, 221, 231, 234, 238, 240, 249, 257, 259, 270, 271, 272, 275, 277, 280, 281, 287, 288, 293, 310, 316, 335, 340, 345, 347, 349, 351, 359, 360, 361, 362, 364, 371, 372, 379, 382, 383, 390]]
2025-06-19 08:52:12,996 - INFO - Run no 1/2
2025-06-19 08:52:12,996 - INFO - Loss Type : BCE
2025-06-19 08:52:12,996 - INFO - Ensemble learning pipeline
2025-06-19 08:52:12,996 - INFO - Training model 1/5: microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract
2025-06-19 08:52:13,356 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
2025-06-19 08:52:13,357 - INFO - 
fold number 1 / 5
2025-06-19 08:52:13,362 - INFO - train split size : 736
2025-06-19 08:52:13,362 - INFO - dev split size : 80
2025-06-19 08:52:13,363 - INFO - test split size : 80
Map (num_proc=32):   0%|          | 0/736 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 23/736 [00:00<00:04, 152.70 examples/s]Map (num_proc=32):  16%|â–ˆâ–Œ        | 115/736 [00:00<00:01, 509.74 examples/s]Map (num_proc=32):  28%|â–ˆâ–ˆâ–Š       | 207/736 [00:00<00:00, 674.28 examples/s]Map (num_proc=32):  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 322/736 [00:00<00:00, 795.99 examples/s]Map (num_proc=32):  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 437/736 [00:00<00:00, 873.62 examples/s]Map (num_proc=32):  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 529/736 [00:00<00:00, 862.02 examples/s]Map (num_proc=32):  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 621/736 [00:00<00:00, 878.99 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 736/736 [00:00<00:00, 928.82 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 736/736 [00:00<00:00, 738.83 examples/s]
Map (num_proc=32):   0%|          | 0/80 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/80 [00:00<00:02, 27.35 examples/s]Map (num_proc=32):  19%|â–ˆâ–‰        | 15/80 [00:00<00:00, 74.95 examples/s]Map (num_proc=32):  34%|â–ˆâ–ˆâ–ˆâ–      | 27/80 [00:00<00:00, 91.30 examples/s]Map (num_proc=32):  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 39/80 [00:00<00:00, 96.54 examples/s]Map (num_proc=32):  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 52/80 [00:00<00:00, 105.53 examples/s]Map (num_proc=32):  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 64/80 [00:00<00:00, 95.93 examples/s] Map (num_proc=32):  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 74/80 [00:00<00:00, 87.01 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 80/80 [00:01<00:00, 79.46 examples/s]
Map (num_proc=32):   0%|          | 0/80 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/80 [00:00<00:03, 25.13 examples/s]Map (num_proc=32):  22%|â–ˆâ–ˆâ–Ž       | 18/80 [00:00<00:00, 82.44 examples/s]Map (num_proc=32):  38%|â–ˆâ–ˆâ–ˆâ–Š      | 30/80 [00:00<00:00, 97.55 examples/s]Map (num_proc=32):  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 45/80 [00:00<00:00, 110.19 examples/s]Map (num_proc=32):  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 58/80 [00:00<00:00, 97.72 examples/s] Map (num_proc=32):  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 70/80 [00:00<00:00, 87.80 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 80/80 [00:00<00:00, 89.43 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 80/80 [00:00<00:00, 81.95 examples/s]
2025-06-19 08:52:18,196 - INFO - 3 datasets tokenized successfully
2025-06-19 08:52:18,326 - INFO - Fold 1 max seq len = 512
2025-06-19 08:52:18,327 - INFO - Starting hyperparameter search for BCE loss
[36m(train_hpo pid=2451807)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=2451807)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=2451807)[0m 2025-06-19 08:52:26,788 - INFO - pos_weight value in TrainingArguments : 6.828424226204718
[36m(train_hpo pid=2451807)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=2451807)[0m   super().__init__(*args, **kwargs)
2025-06-19 08:52:36,847	WARNING tune.py:219 -- Stop signal received (e.g. via SIGINT/Ctrl+C), ending Ray Tune run. This will try to checkpoint the experiment state one last time. Press CTRL+C (or send SIGINT/SIGKILL/SIGTERM) to skip. 
2025-06-19 08:52:36,851	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-19_08-52-18' in 0.0032s.
2025-06-19 08:52:46,857	WARNING tune.py:1056 -- Experiment has been interrupted, but the most recent state was saved.
Resume experiment with: tune.run(..., resume=True)
2025-06-19 08:52:46,859	WARNING experiment_analysis.py:180 -- Failed to fetch metrics for 1 trial(s):
- train_hpo_45e8e561: FileNotFoundError('Could not fetch metrics for train_hpo_45e8e561: both result.json and progress.csv were not found at /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-19_08-52-18/train_hpo_45e8e561_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-19_08-52-26')
2025-06-19 08:52:46,859 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x7612fadb8210>
2025-06-19 08:52:46,859	WARNING experiment_analysis.py:558 -- Could not find best trial. Did you pass the correct `metric` parameter?
2025-06-19 08:52:46,859 - INFO - Best trial : None
2025-06-19 08:52:46,859 - ERROR - No successful trials found. Please check the training process and metric logging.
2025-06-19 08:52:47,138 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-19_08-52-18   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 12                              â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-19_08-52-18
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-19_08-52-10_521430_2448801/artifacts/2025-06-19_08-52-18/train_hpo_2025-06-19_08-52-18/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-19 08:52:19. Total running time: 0s
Logical resource usage: 0/32 CPUs, 0/1 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_cf398792   PENDING         6.82842       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_cf398792 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_cf398792 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          6.82842 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=2451807)[0m [2025-06-19 08:52:27,026] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=2451807)[0m [2025-06-19 08:52:29,795] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(train_hpo pid=2451807)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=222, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 1 RUNNING | 1 PENDING
Current time: 2025-06-19 08:52:36. Total running time: 17s
Logical resource usage: 10.0/32 CPUs, 1.0/1 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_cf398792   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_45e8e561   PENDING         6.09408       4.55539e-06         0.123031                    5 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=2451807)[0m {'loss': 1.62, 'grad_norm': 23.6956844329834, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}

Traceback (most recent call last):
  File "/home/leandre/Projects/BioMoQA_Playground/experiments/biomoqa.py", line 67, in <module>
    main()
  File "/home/leandre/Projects/BioMoQA_Playground/experiments/biomoqa.py", line 53, in main
    pipeline.whole_pipeline()
  File "/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/old_binary_pipeline.py", line 645, in whole_pipeline
    avg_ens_metrics=self.run_pipeline()
                    ^^^^^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/old_binary_pipeline.py", line 575, in run_pipeline
    scores_by_fold_by_model[k].append(scores_by_fold[k]) 
                                      ~~~~~~~~~~~~~~^^^
IndexError: tuple index out of range
2025-06-19 08:53:06,775	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
2025-06-19 08:53:07,419 - INFO - Randomness sources seeded with 42 for reproducibility.
2025-06-19 08:53:07,419 - INFO - Random seeds set to 42
2025-06-19 08:53:07,520 - INFO - Optional negatives loaded from CSV with 5000 entries.
2025-06-19 08:53:07,520 - INFO - Loading original negatives...
2025-06-19 08:53:07,529 - INFO - Negatives column names: ['Article ID', 'Title', 'Author', 'Publication year', 'Title secondary', 'URL', 'DOI', 'Abstract', 'Criteria for exclusion A', ' Criteria for exclusion B', ' Criteria for exclusion C', 'labels', 'Keywords']
2025-06-19 08:53:07,529 - INFO - Loading original positives...
2025-06-19 08:53:07,546 - INFO - Positives column names: ['Article ID', 'Title', 'Author', 'Secondary authors', 'Keywords', 'title of unpublished reference', 'primary date', 'publication year', 'notes', 'reprint status', 'start page number', 'ending page number', 'periodical full name', 'periodical standard abbreviation', 'periodical in which article was published', 'periodical name - user abbreviation 1', 'periodical name - user abbreviation 2', 'volume number', 'issue number', 'title secondary', 'city of publication', 'publisher', 'user definable 1', 'user definable 5', 'title series', 'Abstract', 'ISSN/ISBN', 'availability', 'Misc. 1', 'Misc. 2', 'address', 'Web/URL', 'link to PDF', 'link to full-text', 'related records', 'images', 'DOI', 'labels']
2025-06-19 08:53:07,551 - INFO - Class balance:
labels
1    326
0    123
Name: count, dtype: int64
2025-06-19 08:53:07,551 - INFO -    Article ID  ...  Criteria for exclusion C
0       12959  ...                       NaN
1       13470  ...                       NaN
2        4686  ...                       NaN
3        2503  ...                       NaN
4        2951  ...                       NaN

[5 rows x 44 columns]
2025-06-19 08:53:07,577 - INFO - Original dataset size: 449
2025-06-19 08:53:07,577 - INFO - Optional negatives size: 5000
2025-06-19 08:53:07,582 - INFO - Optional negatives:                                                title  ... labels
0  Towards evidence-based conservation of subterr...  ...     -1
1                  Marine biodiversity conservation.  ...     -1
2  Climate teleconnections modulate global burned...  ...     -1
3  Integrating carbon sequestration and biodivers...  ...     -1
4  Principle, technique and application of grassl...  ...     -1

[5 rows x 7 columns]
2025-06-19 08:53:07,586 - INFO - Combined dataset size: 949
2025-06-19 08:53:07,586 - INFO - Before cleaning, head:
                                               title  ... labels
0  Feral pig (Sus scrofa) disturbance facilitates...  ...      1
1  Effects of woody plant diversity on abovegroun...  ...      1
2  Scaling species richness and endemism of tropi...  ...      1
3  Not as the crow flies: Assessing effective iso...  ...      0
4  Species-group concepts and biogeography of the...  ...      1

[5 rows x 5 columns]
2025-06-19 08:53:07,591 - INFO - Null counts before cleaning:
title        0
abstract     0
Keywords     8
doi         37
labels       0
dtype: int64
2025-06-19 08:53:07,594 - INFO - Total duplicate title: 0
2025-06-19 08:53:07,599 - INFO - Conflicts on title (same value, multiple labels):
Empty DataFrame
Columns: [title, n_labels]
Index: []
2025-06-19 08:53:07,602 - INFO - Total duplicate abstract: 0
2025-06-19 08:53:07,611 - INFO - Conflicts on abstract (same value, multiple labels):
Empty DataFrame
Columns: [abstract, n_labels]
Index: []
2025-06-19 08:53:07,613 - INFO - Total duplicate doi: 18
2025-06-19 08:53:07,615 - INFO - Conflicts on doi (same value, multiple labels):
Empty DataFrame
Columns: [doi, n_labels]
Index: []
2025-06-19 08:53:07,616 - INFO - Cleaned dataset size: 896
2025-06-19 08:53:07,616 - INFO - Number of positives : 293
2025-06-19 08:53:07,617 - INFO - Number of negatives : 603
2025-06-19 08:53:07,617 - INFO - clean_og_df size : 397
2025-06-19 08:53:07,618 - INFO - opt_neg_df size : 499
2025-06-19 08:53:07,622 - INFO - Fold 1:
2025-06-19 08:53:07,622 - INFO -   Train label distribution: {-1: 0.6779891304347826, 1: 0.23777173913043478, 0: 0.08423913043478261}
2025-06-19 08:53:07,622 - INFO -   Test label distribution: {1: 0.7375, 0: 0.2625}
2025-06-19 08:53:07,624 - INFO - Fold 2:
2025-06-19 08:53:07,624 - INFO -   Train label distribution: {-1: 0.6779891304347826, 1: 0.23777173913043478, 0: 0.08423913043478261}
2025-06-19 08:53:07,624 - INFO -   Test label distribution: {1: 0.7375, 0: 0.2625}
2025-06-19 08:53:07,627 - INFO - Fold 3:
2025-06-19 08:53:07,627 - INFO -   Train label distribution: {-1: 0.6770691994572592, 1: 0.23744911804613297, 0: 0.08548168249660787}
2025-06-19 08:53:07,627 - INFO -   Test label distribution: {1: 0.7468354430379747, 0: 0.25316455696202533}
2025-06-19 08:53:07,629 - INFO - Fold 4:
2025-06-19 08:53:07,629 - INFO -   Train label distribution: {-1: 0.6770691994572592, 1: 0.23880597014925373, 0: 0.08412483039348712}
2025-06-19 08:53:07,629 - INFO -   Test label distribution: {1: 0.7341772151898734, 0: 0.26582278481012656}
2025-06-19 08:53:07,632 - INFO - Fold 5:
2025-06-19 08:53:07,632 - INFO -   Train label distribution: {-1: 0.6770691994572592, 1: 0.23880597014925373, 0: 0.08412483039348712}
2025-06-19 08:53:07,632 - INFO -   Test label distribution: {1: 0.7341772151898734, 0: 0.26582278481012656}
2025-06-19 08:53:07,635 - INFO - Fold 1:
2025-06-19 08:53:07,635 - INFO -   Train label distribution: {-1: 0.6779891304347826, 1: 0.23777173913043478, 0: 0.08423913043478261}
2025-06-19 08:53:07,635 - INFO -   Test label distribution: {1: 0.7375, 0: 0.2625}
2025-06-19 08:53:07,637 - INFO - Fold 2:
2025-06-19 08:53:07,637 - INFO -   Train label distribution: {-1: 0.6779891304347826, 1: 0.23777173913043478, 0: 0.08423913043478261}
2025-06-19 08:53:07,637 - INFO -   Test label distribution: {1: 0.7375, 0: 0.2625}
2025-06-19 08:53:07,640 - INFO - Fold 3:
2025-06-19 08:53:07,640 - INFO -   Train label distribution: {-1: 0.6770691994572592, 1: 0.23744911804613297, 0: 0.08548168249660787}
2025-06-19 08:53:07,640 - INFO -   Test label distribution: {1: 0.7468354430379747, 0: 0.25316455696202533}
2025-06-19 08:53:07,642 - INFO - Fold 4:
2025-06-19 08:53:07,642 - INFO -   Train label distribution: {-1: 0.6770691994572592, 1: 0.23880597014925373, 0: 0.08412483039348712}
2025-06-19 08:53:07,642 - INFO -   Test label distribution: {1: 0.7341772151898734, 0: 0.26582278481012656}
2025-06-19 08:53:07,644 - INFO - Fold 5:
2025-06-19 08:53:07,644 - INFO -   Train label distribution: {-1: 0.6770691994572592, 1: 0.23880597014925373, 0: 0.08412483039348712}
2025-06-19 08:53:07,644 - INFO -   Test label distribution: {1: 0.7341772151898734, 0: 0.26582278481012656}
2025-06-19 08:53:07,645 - INFO - Indices of clean_df remain the same after resetting.
2025-06-19 08:53:07,664 - INFO - clean_df index : RangeIndex(start=0, stop=896, step=1)
Stringifying the column:   0%|          | 0/896 [00:00<?, ? examples/s]Stringifying the column: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 896/896 [00:00<00:00, 157996.15 examples/s]
Casting to class labels:   0%|          | 0/896 [00:00<?, ? examples/s]Casting to class labels: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 896/896 [00:00<00:00, 174673.32 examples/s]
2025-06-19 08:53:07,680 - INFO - Number of positives : 293
2025-06-19 08:53:07,681 - INFO - Number of negatives : 603
2025-06-19 08:53:07,681 - INFO - All 5 testâ€folds in run 1 are pairwise disjoint.
2025-06-19 08:53:07,681 - INFO - All 5 testâ€folds in run 2 are pairwise disjoint.
2025-06-19 08:53:07,682 - INFO - with_title : True
2025-06-19 08:53:07,682 - INFO - with_keywords : False
2025-06-19 08:53:07,682 - INFO - fold indexes for run no.1: [[392, 341, 378, 173, 113, 324, 114, 177, 302, 216, 267, 44, 264, 187, 70, 68, 73, 226, 15, 300, 223, 163, 236, 337, 112, 65, 327, 12, 125, 385, 103, 43, 274, 330, 94, 220, 18, 225, 123, 199, 295, 120, 355, 389, 28, 137, 357, 23, 89, 134, 145, 339, 308, 171, 228, 356, 373, 76, 323, 203, 258, 222, 133, 111, 313, 36, 319, 375, 256, 61, 393, 175, 344, 116, 260, 3, 334, 396, 273, 107, 139, 60, 109, 303, 42, 194, 343, 248, 320, 332, 37, 4, 72, 81, 118, 146, 246, 135, 286, 151, 380, 183, 170, 46, 115, 346, 35, 189, 235, 237, 354, 55, 172, 278, 261, 150, 305, 368, 304, 395, 83, 161, 215, 325, 366, 162, 232, 105, 64, 127, 381, 269, 229, 205, 318, 59, 307, 96, 149, 136, 331, 24, 27, 99, 19, 252, 39, 309, 66, 144, 117, 292, 342, 168, 210, 247, 82, 374, 14, 169, 190, 348, 181, 376, 63, 159, 299, 377, 294, 121, 91, 192, 95, 391, 253, 204, 200, 148, 10, 358, 38, 138, 97, 265, 132, 104, 33, 209, 394, 243, 370, 31, 155, 321, 62, 126, 384, 387, 350, 263, 40, 369, 87, 48, 217, 54, 130, 276, 244, 2, 157, 6, 219, 317, 32, 336, 141, 268, 312, 166, 7, 49, 353, 196, 176, 185, 306, 207, 93, 21, 297, 77, 224, 233, 290, 41, 202, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 532, 533, 534, 535, 536, 537, 538, 539, 540, 541, 542, 543, 544, 545, 546, 547, 548, 549, 550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 560, 561, 562, 563, 564, 565, 566, 567, 568, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582, 583, 584, 585, 586, 587, 588, 589, 590, 591, 592, 593, 594, 595, 596, 597, 598, 599, 600, 601, 602, 603, 604, 605, 606, 607, 608, 609, 610, 611, 612, 613, 614, 615, 616, 617, 618, 619, 620, 621, 622, 623, 624, 625, 626, 627, 628, 629, 630, 631, 632, 633, 634, 635, 636, 637, 638, 639, 640, 641, 642, 643, 644, 645, 646, 647, 648, 649, 650, 651, 652, 653, 654, 655, 656, 657, 658, 659, 660, 661, 662, 663, 664, 665, 666, 667, 668, 669, 670, 671, 672, 673, 674, 675, 676, 677, 678, 679, 680, 681, 682, 683, 684, 685, 686, 687, 688, 689, 690, 691, 692, 693, 694, 695, 696, 697, 698, 699, 700, 701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 714, 715, 716, 717, 718, 719, 720, 721, 722, 723, 724, 725, 726, 727, 728, 729, 730, 731, 732, 733, 734, 735, 736, 737, 738, 739, 740, 741, 742, 743, 744, 745, 746, 747, 748, 749, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764, 765, 766, 767, 768, 769, 770, 771, 772, 773, 774, 775, 776, 777, 778, 779, 780, 781, 782, 783, 784, 785, 786, 787, 788, 789, 790, 791, 792, 793, 794, 795, 796, 797, 798, 799, 800, 801, 802, 803, 804, 805, 806, 807, 808, 809, 810, 811, 812, 813, 814, 815, 816, 817, 818, 819, 820, 821, 822, 823, 824, 825, 826, 827, 828, 829, 830, 831, 832, 833, 834, 835, 836, 837, 838, 839, 840, 841, 842, 843, 844, 845, 846, 847, 848, 849, 850, 851, 852, 853, 854, 855, 856, 857, 858, 859, 860, 861, 862, 863, 864, 865, 866, 867, 868, 869, 870, 871, 872, 873, 874, 875, 876, 877, 878, 879, 880, 881, 882, 883, 884, 885, 886, 887, 888, 889, 890, 891, 892, 893, 894, 895], [174, 311, 45, 242, 251, 241, 188, 102, 283, 250, 388, 239, 328, 255, 230, 84, 333, 29, 67, 279, 227, 338, 80, 211, 56, 315, 218, 206, 386, 129, 245, 158, 301, 262, 291, 314, 178, 8, 88, 254, 0, 57, 329, 367, 156, 266, 289, 284, 213, 147, 285, 296, 191, 322, 85, 214, 98, 100, 282, 212, 52, 53, 30, 51, 179, 131, 298, 167, 352, 326, 365, 92, 34, 363, 78, 26, 71, 1, 17, 50], [5, 9, 11, 13, 16, 20, 22, 25, 47, 58, 69, 74, 75, 79, 86, 90, 101, 106, 108, 110, 119, 122, 124, 128, 140, 142, 143, 152, 153, 154, 160, 164, 165, 180, 182, 184, 186, 193, 195, 197, 198, 201, 208, 221, 231, 234, 238, 240, 249, 257, 259, 270, 271, 272, 275, 277, 280, 281, 287, 288, 293, 310, 316, 335, 340, 345, 347, 349, 351, 359, 360, 361, 362, 364, 371, 372, 379, 382, 383, 390]]
2025-06-19 08:53:07,682 - INFO - Run no 1/2
2025-06-19 08:53:07,682 - INFO - Loss Type : BCE
2025-06-19 08:53:07,682 - INFO - Ensemble learning pipeline
2025-06-19 08:53:07,682 - INFO - Training model 1/5: microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract
2025-06-19 08:53:07,998 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
2025-06-19 08:53:07,998 - INFO - 
fold number 1 / 5
2025-06-19 08:53:08,005 - INFO - train split size : 736
2025-06-19 08:53:08,005 - INFO - dev split size : 80
2025-06-19 08:53:08,005 - INFO - test split size : 80
Map (num_proc=32):   0%|          | 0/736 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 23/736 [00:00<00:04, 153.08 examples/s]Map (num_proc=32):  16%|â–ˆâ–Œ        | 115/736 [00:00<00:01, 511.26 examples/s]Map (num_proc=32):  31%|â–ˆâ–ˆâ–ˆâ–      | 230/736 [00:00<00:00, 699.35 examples/s]Map (num_proc=32):  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 345/736 [00:00<00:00, 838.97 examples/s]Map (num_proc=32):  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 437/736 [00:00<00:00, 850.77 examples/s]Map (num_proc=32):  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 552/736 [00:00<00:00, 880.66 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 667/736 [00:00<00:00, 915.60 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 736/736 [00:00<00:00, 744.25 examples/s]
Map (num_proc=32):   0%|          | 0/80 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/80 [00:00<00:02, 27.88 examples/s]Map (num_proc=32):  22%|â–ˆâ–ˆâ–Ž       | 18/80 [00:00<00:00, 84.61 examples/s]Map (num_proc=32):  38%|â–ˆâ–ˆâ–ˆâ–Š      | 30/80 [00:00<00:00, 98.98 examples/s]Map (num_proc=32):  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 45/80 [00:00<00:00, 111.20 examples/s]Map (num_proc=32):  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 58/80 [00:00<00:00, 100.51 examples/s]Map (num_proc=32):  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 70/80 [00:00<00:00, 92.73 examples/s] Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 80/80 [00:00<00:00, 88.55 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 80/80 [00:00<00:00, 83.13 examples/s]
Map (num_proc=32):   0%|          | 0/80 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/80 [00:00<00:02, 27.95 examples/s]Map (num_proc=32):  22%|â–ˆâ–ˆâ–Ž       | 18/80 [00:00<00:00, 84.99 examples/s]Map (num_proc=32):  41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 33/80 [00:00<00:00, 106.10 examples/s]Map (num_proc=32):  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 48/80 [00:00<00:00, 108.34 examples/s]Map (num_proc=32):  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 60/80 [00:00<00:00, 99.50 examples/s] Map (num_proc=32):  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 70/80 [00:00<00:00, 85.25 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 80/80 [00:00<00:00, 85.90 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 80/80 [00:00<00:00, 81.61 examples/s]
2025-06-19 08:53:12,484 - INFO - 3 datasets tokenized successfully
2025-06-19 08:53:12,632 - INFO - Fold 1 max seq len = 512
2025-06-19 08:53:12,633 - INFO - Starting hyperparameter search for BCE loss
[36m(train_hpo pid=2455722)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=2455722)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=2455722)[0m 2025-06-19 08:53:21,234 - INFO - pos_weight value in TrainingArguments : 6.828424226204718
[36m(train_hpo pid=2455722)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=2455722)[0m   super().__init__(*args, **kwargs)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-19_08-53-12   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-19_08-53-12
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-19_08-53-05_394440_2452736/artifacts/2025-06-19_08-53-12/train_hpo_2025-06-19_08-53-12/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-19 08:53:14. Total running time: 0s
Logical resource usage: 0/32 CPUs, 0/1 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_16f905be   PENDING         6.82842       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_16f905be started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_16f905be config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          6.82842 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=2455722)[0m [2025-06-19 08:53:21,462] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=2455722)[0m [2025-06-19 08:53:24,169] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(train_hpo pid=2455722)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=222, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=2455722)[0m {'loss': 1.5103, 'grad_norm': 26.71760368347168, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}

Trial status: 1 RUNNING | 1 PENDING
Current time: 2025-06-19 08:53:44. Total running time: 30s
Logical resource usage: 10.0/32 CPUs, 1.0/1 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_16f905be   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_7cfe5553   PENDING         6.09408       4.55539e-06         0.123031                    5 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=2455722)[0m {'loss': 1.2675, 'grad_norm': 27.62204933166504, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0}
[36m(train_hpo pid=2455722)[0m {'loss': 1.1168, 'grad_norm': 18.899076461791992, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0}
Trial status: 1 RUNNING | 1 PENDING
Current time: 2025-06-19 08:54:14. Total running time: 1min 0s
Logical resource usage: 10.0/32 CPUs, 1.0/1 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_16f905be   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_7cfe5553   PENDING         6.09408       4.55539e-06         0.123031                    5 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=2455722)[0m {'loss': 1.0184, 'grad_norm': 17.701736450195312, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0}
[36m(train_hpo pid=2455722)[0m {'loss': 0.9535, 'grad_norm': 17.69354248046875, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0}
Trial status: 1 RUNNING | 1 PENDING
Current time: 2025-06-19 08:54:44. Total running time: 1min 30s
Logical resource usage: 10.0/32 CPUs, 1.0/1 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_16f905be   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_7cfe5553   PENDING         6.09408       4.55539e-06         0.123031                    5 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(train_hpo pid=2455722)[0m 2025-06-19 08:54:53,531 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=2455722)[0m 2025-06-19 08:54:53,537 - INFO - eval_result: {'eval_loss': 1.6901214122772217, 'eval_f1': 0.8529411764705882, 'eval_accuracy': 0.75, 'eval_kappa': 0.10813823857302107, 'eval_precision': 0.7532467532467533, 'eval_recall': 0.9830508474576272, 'eval_optim_threshold': 0.8158189654350281, 'eval_AP': 0.8420037155207245, 'eval_MCC': 0.1813134790046414, 'eval_NDCG': 0.9605626939443597, 'eval_runtime': 3.4321, 'eval_samples_per_second': 23.31, 'eval_steps_per_second': 1.165, 'epoch': 6.0}
2025-06-19 08:54:53,877 - INFO - Cleaning up trial 16f905be
2025-06-19 08:54:53,877 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-19_08-53-12/train_hpo_16f905be_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-19_08-53-13
[36m(train_hpo pid=2455722)[0m 2025-06-19 08:54:53,854 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=2457483)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=2457483)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=2457483)[0m 2025-06-19 08:55:01,737 - INFO - pos_weight value in TrainingArguments : 6.094080202241274
[36m(train_hpo pid=2457483)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=2457483)[0m   super().__init__(*args, **kwargs)

[36m(train_hpo pid=2455722)[0m {'loss': 0.9297, 'grad_norm': 16.704572677612305, 'learning_rate': 0.0, 'epoch': 6.0}
[36m(train_hpo pid=2455722)[0m {'train_runtime': 85.6023, 'train_samples_per_second': 51.587, 'train_steps_per_second': 2.593, 'train_loss': 1.1327275628442164, 'epoch': 6.0}
[36m(train_hpo pid=2455722)[0m STATE at ending of training  :  TrainerState(epoch=6.0, global_step=222, max_steps=222, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=1156298984063256.0, log_history=[{'loss': 1.5103, 'grad_norm': 26.71760368347168, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0, 'step': 37}, {'loss': 1.2675, 'grad_norm': 27.62204933166504, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0, 'step': 74}, {'loss': 1.1168, 'grad_norm': 18.899076461791992, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0, 'step': 111}, {'loss': 1.0184, 'grad_norm': 17.701736450195312, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0, 'step': 148}, {'loss': 0.9535, 'grad_norm': 17.69354248046875, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0, 'step': 185}, {'loss': 0.9297, 'grad_norm': 16.704572677612305, 'learning_rate': 0.0, 'epoch': 6.0, 'step': 222}, {'train_runtime': 85.6023, 'train_samples_per_second': 51.587, 'train_steps_per_second': 2.593, 'total_flos': 1156298984063256.0, 'train_loss': 1.1327275628442164, 'epoch': 6.0, 'step': 222}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=2455722)[0m {'eval_loss': 1.6901214122772217, 'eval_f1': 0.8529411764705882, 'eval_accuracy': 0.75, 'eval_kappa': 0.10813823857302107, 'eval_precision': 0.7532467532467533, 'eval_recall': 0.9830508474576272, 'eval_optim_threshold': 0.8158189654350281, 'eval_AP': 0.8420037155207245, 'eval_MCC': 0.1813134790046414, 'eval_NDCG': 0.9605626939443597, 'eval_runtime': 3.4321, 'eval_samples_per_second': 23.31, 'eval_steps_per_second': 1.165, 'epoch': 6.0}

Trial train_hpo_16f905be finished iteration 1 at 2025-06-19 08:54:53. Total running time: 1min 39s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_16f905be result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    93.2693 â”‚
â”‚ time_total_s                        93.2693 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     6 â”‚
â”‚ eval_AP                               0.842 â”‚
â”‚ eval_MCC                            0.18131 â”‚
â”‚ eval_NDCG                           0.96056 â”‚
â”‚ eval_accuracy                          0.75 â”‚
â”‚ eval_f1                             0.85294 â”‚
â”‚ eval_kappa                          0.10814 â”‚
â”‚ eval_loss                           1.69012 â”‚
â”‚ eval_optim_threshold                0.81582 â”‚
â”‚ eval_precision                      0.75325 â”‚
â”‚ eval_recall                         0.98305 â”‚
â”‚ eval_runtime                         3.4321 â”‚
â”‚ eval_samples_per_second               23.31 â”‚
â”‚ eval_steps_per_second                 1.165 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_16f905be completed after 1 iterations at 2025-06-19 08:54:53. Total running time: 1min 39s

Trial train_hpo_7cfe5553 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_7cfe5553 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          6.09408 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=2457483)[0m [2025-06-19 08:55:01,959] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=2457483)[0m [2025-06-19 08:55:04,682] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(train_hpo pid=2457483)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=185, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 1 TERMINATED | 1 RUNNING | 1 PENDING
Current time: 2025-06-19 08:55:14. Total running time: 2min 0s
Logical resource usage: 10.0/32 CPUs, 1.0/1 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_7cfe5553   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ train_hpo_16f905be   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1            93.2693       1.69012    0.852941              0.75       0.108138 â”‚
â”‚ train_hpo_7687fc91   PENDING           7.18321       7.98818e-05         0.251217                    3                                                                                        â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(train_hpo pid=2457483)[0m 2025-06-19 08:56:20,404 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=2457483)[0m 2025-06-19 08:56:20,410 - INFO - eval_result: {'eval_loss': 1.0723977088928223, 'eval_f1': 0.8467153284671532, 'eval_accuracy': 0.7375, 'eval_kappa': 0.04328018223234642, 'eval_precision': 0.7435897435897436, 'eval_recall': 0.9830508474576272, 'eval_optim_threshold': 0.9246906042098999, 'eval_AP': 0.8859341974542563, 'eval_MCC': 0.08643420548400696, 'eval_NDCG': 0.974894351570153, 'eval_runtime': 3.3784, 'eval_samples_per_second': 23.68, 'eval_steps_per_second': 1.184, 'epoch': 5.0}
[36m(train_hpo pid=2457483)[0m 2025-06-19 08:56:20,717 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB

[36m(train_hpo pid=2457483)[0m {'loss': 1.2807, 'grad_norm': 16.00396728515625, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0}
[36m(train_hpo pid=2457483)[0m {'loss': 0.839, 'grad_norm': 44.50065231323242, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0}
Trial status: 1 TERMINATED | 1 RUNNING | 1 PENDING
Current time: 2025-06-19 08:55:44. Total running time: 2min 30s
Logical resource usage: 10.0/32 CPUs, 1.0/1 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_7cfe5553   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ train_hpo_16f905be   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1            93.2693       1.69012    0.852941              0.75       0.108138 â”‚
â”‚ train_hpo_7687fc91   PENDING           7.18321       7.98818e-05         0.251217                    3                                                                                        â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=2457483)[0m {'loss': 0.5602, 'grad_norm': 12.749128341674805, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0}
[36m(train_hpo pid=2457483)[0m {'loss': 0.4274, 'grad_norm': 11.176733016967773, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0}
Trial status: 1 TERMINATED | 1 RUNNING | 1 PENDING
Current time: 2025-06-19 08:56:14. Total running time: 3min 0s
Logical resource usage: 10.0/32 CPUs, 1.0/1 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_7cfe5553   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ train_hpo_16f905be   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1            93.2693       1.69012    0.852941              0.75       0.108138 â”‚
â”‚ train_hpo_7687fc91   PENDING           7.18321       7.98818e-05         0.251217                    3                                                                                        â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=2457483)[0m {'loss': 0.3767, 'grad_norm': 4.5308685302734375, 'learning_rate': 0.0, 'epoch': 5.0}
[36m(train_hpo pid=2457483)[0m {'train_runtime': 72.0206, 'train_samples_per_second': 51.096, 'train_steps_per_second': 2.569, 'train_loss': 0.6967847050847233, 'epoch': 5.0}
[36m(train_hpo pid=2457483)[0m STATE at ending of training  :  TrainerState(epoch=5.0, global_step=185, max_steps=185, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=964829854884984.0, log_history=[{'loss': 1.2807, 'grad_norm': 16.00396728515625, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0, 'step': 37}, {'loss': 0.839, 'grad_norm': 44.50065231323242, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0, 'step': 74}, {'loss': 0.5602, 'grad_norm': 12.749128341674805, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0, 'step': 111}, {'loss': 0.4274, 'grad_norm': 11.176733016967773, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0, 'step': 148}, {'loss': 0.3767, 'grad_norm': 4.5308685302734375, 'learning_rate': 0.0, 'epoch': 5.0, 'step': 185}, {'train_runtime': 72.0206, 'train_samples_per_second': 51.096, 'train_steps_per_second': 2.569, 'total_flos': 964829854884984.0, 'train_loss': 0.6967847050847233, 'epoch': 5.0, 'step': 185}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=2457483)[0m {'eval_loss': 1.0723977088928223, 'eval_f1': 0.8467153284671532, 'eval_accuracy': 0.7375, 'eval_kappa': 0.04328018223234642, 'eval_precision': 0.7435897435897436, 'eval_recall': 0.9830508474576272, 'eval_optim_threshold': 0.9246906042098999, 'eval_AP': 0.8859341974542563, 'eval_MCC': 0.08643420548400696, 'eval_NDCG': 0.974894351570153, 'eval_runtime': 3.3784, 'eval_samples_per_second': 23.68, 'eval_steps_per_second': 1.184, 'epoch': 5.0}

Trial train_hpo_7cfe5553 finished iteration 1 at 2025-06-19 08:56:20. Total running time: 3min 6s2025-06-19 08:56:20,738 - INFO - Cleaning up trial 7cfe5553
2025-06-19 08:56:20,738 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-19_08-53-12/train_hpo_7cfe5553_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-19_08-53-20
2025-06-19 08:56:20,738 - INFO - Current best: 16f905be with eval_f1 : 0.8529411764705882 at iteration 1
[36m(train_hpo pid=2457483)[0m /home/leandre/.local/share/uv/python/cpython-3.11.11-linux-x86_64-gnu/lib/python3.11/multiprocessing/resource_tracker.py:123: UserWarning: resource_tracker: process died unexpectedly, relaunching.  Some resources might leak.
[36m(train_hpo pid=2457483)[0m   warnings.warn('resource_tracker: process died unexpectedly, '
[36m(train_hpo pid=2457483)[0m Traceback (most recent call last):
[36m(train_hpo pid=2457483)[0m   File "/home/leandre/.local/share/uv/python/cpython-3.11.11-linux-x86_64-gnu/lib/python3.11/multiprocessing/resource_tracker.py", line 239, in main
[36m(train_hpo pid=2457483)[0m     cache[rtype].remove(name)
[36m(train_hpo pid=2457483)[0m KeyError: '/loky-2457483-4fn96kxb'
[36m(train_hpo pid=2458923)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=2458923)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=2458923)[0m 2025-06-19 08:56:28,734 - INFO - pos_weight value in TrainingArguments : 7.183206941666034
[36m(train_hpo pid=2458923)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=2458923)[0m   super().__init__(*args, **kwargs)

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_7cfe5553 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    79.7909 â”‚
â”‚ time_total_s                        79.7909 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     5 â”‚
â”‚ eval_AP                             0.88593 â”‚
â”‚ eval_MCC                            0.08643 â”‚
â”‚ eval_NDCG                           0.97489 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84672 â”‚
â”‚ eval_kappa                          0.04328 â”‚
â”‚ eval_loss                            1.0724 â”‚
â”‚ eval_optim_threshold                0.92469 â”‚
â”‚ eval_precision                      0.74359 â”‚
â”‚ eval_recall                         0.98305 â”‚
â”‚ eval_runtime                         3.3784 â”‚
â”‚ eval_samples_per_second               23.68 â”‚
â”‚ eval_steps_per_second                 1.184 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_7cfe5553 completed after 1 iterations at 2025-06-19 08:56:20. Total running time: 3min 6s

Trial train_hpo_7687fc91 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_7687fc91 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          7.18321 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=2458923)[0m [2025-06-19 08:56:28,957] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=2458923)[0m [2025-06-19 08:56:31,749] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(train_hpo pid=2458923)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=111, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 2 TERMINATED | 1 RUNNING
Current time: 2025-06-19 08:56:44. Total running time: 3min 30s
Logical resource usage: 10.0/32 CPUs, 1.0/1 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_7687fc91   RUNNING           7.18321       7.98818e-05         0.251217                    3                                                                                        â”‚
â”‚ train_hpo_16f905be   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1            93.2693       1.69012    0.852941            0.75        0.108138  â”‚
â”‚ train_hpo_7cfe5553   TERMINATED        6.09408       4.55539e-06         0.123031                    5        1            79.7909       1.0724     0.846715            0.7375      0.0432802 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=2458923)[0m {'loss': 0.6134, 'grad_norm': 62.050926208496094, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
[36m(train_hpo pid=2458923)[0m {'loss': 0.4277, 'grad_norm': 8.804749488830566, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
Trial status: 2 TERMINATED | 1 RUNNING
Current time: 2025-06-19 08:57:14. Total running time: 4min 0s
Logical resource usage: 10.0/32 CPUs, 1.0/1 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_7687fc91   RUNNING           7.18321       7.98818e-05         0.251217                    3                                                                                        â”‚
â”‚ train_hpo_16f905be   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1            93.2693       1.69012    0.852941            0.75        0.108138  â”‚
â”‚ train_hpo_7cfe5553   TERMINATED        6.09408       4.55539e-06         0.123031                    5        1            79.7909       1.0724     0.846715            0.7375      0.0432802 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(train_hpo pid=2458923)[0m 2025-06-19 08:57:18,965 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=2458923)[0m 2025-06-19 08:57:18,970 - INFO - eval_result: {'eval_loss': 0.5624396204948425, 'eval_f1': 0.9291338582677166, 'eval_accuracy': 0.8875, 'eval_kappa': 0.6629213483146068, 'eval_precision': 0.8676470588235294, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8400484323501587, 'eval_AP': 0.9624074225029141, 'eval_MCC': 0.7041294762525789, 'eval_NDCG': 0.9928943020323051, 'eval_runtime': 3.4954, 'eval_samples_per_second': 22.887, 'eval_steps_per_second': 1.144, 'epoch': 3.0}
2025-06-19 08:57:19,307 - INFO - Cleaning up trial 7687fc91
2025-06-19 08:57:19,307 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-19_08-53-12/train_hpo_7687fc91_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512_2025-06-19_08-55-00
2025-06-19 08:57:19,307 - INFO - Cleaning up trial 16f905be
2025-06-19 08:57:19,307 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-19_08-53-12/train_hpo_16f905be_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-19_08-53-13
2025-06-19 08:57:19,307 - INFO - Cleaning up trial 7cfe5553
2025-06-19 08:57:19,307 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-19_08-53-12/train_hpo_7cfe5553_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-19_08-53-20
2025-06-19 08:57:19,314	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-19_08-53-12' in 0.0046s.
2025-06-19 08:57:19,320 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x7db92d15f050>
2025-06-19 08:57:19,320 - INFO - Best trial : train_hpo_7687fc91
2025-06-19 08:57:19,320 - INFO - Best config : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-19 08:57:19,320 - INFO - Best trial after optimization: {'eval_loss': 0.5624396204948425, 'eval_f1': 0.9291338582677166, 'eval_accuracy': 0.8875, 'eval_kappa': 0.6629213483146068, 'eval_precision': 0.8676470588235294, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8400484323501587, 'eval_AP': 0.9624074225029141, 'eval_MCC': 0.7041294762525789, 'eval_NDCG': 0.9928943020323051, 'eval_runtime': 3.4954, 'eval_samples_per_second': 22.887, 'eval_steps_per_second': 1.144, 'epoch': 3.0, 'timestamp': 1750316239, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '7687fc91', 'date': '2025-06-19_08-57-19', 'time_this_iter_s': 51.4034903049469, 'time_total_s': 51.4034903049469, 'pid': 2458923, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 51.4034903049469, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512'}
2025-06-19 08:57:19,342 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   1.690121  0.852941  ...                        6  16f905be
1   1.072398  0.846715  ...                        5  7cfe5553
2   0.562440  0.929134  ...                        3  7687fc91

[3 rows x 32 columns]
[36m(train_hpo pid=2458923)[0m 2025-06-19 08:57:19,284 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
2025-06-19 08:57:19,481 - INFO - Trial comparison plot saved
2025-06-19 08:57:19,481 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-19 08:57:20,134 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)

[36m(train_hpo pid=2458923)[0m {'loss': 0.1328, 'grad_norm': 0.3876011073589325, 'learning_rate': 0.0, 'epoch': 3.0}
[36m(train_hpo pid=2458923)[0m {'train_runtime': 43.4004, 'train_samples_per_second': 50.875, 'train_steps_per_second': 2.558, 'train_loss': 0.3913128612277744, 'epoch': 3.0}
[36m(train_hpo pid=2458923)[0m STATE at ending of training  :  TrainerState(epoch=3.0, global_step=111, max_steps=111, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=578487627812856.0, log_history=[{'loss': 0.6134, 'grad_norm': 62.050926208496094, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0, 'step': 37}, {'loss': 0.4277, 'grad_norm': 8.804749488830566, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0, 'step': 74}, {'loss': 0.1328, 'grad_norm': 0.3876011073589325, 'learning_rate': 0.0, 'epoch': 3.0, 'step': 111}, {'train_runtime': 43.4004, 'train_samples_per_second': 50.875, 'train_steps_per_second': 2.558, 'total_flos': 578487627812856.0, 'train_loss': 0.3913128612277744, 'epoch': 3.0, 'step': 111}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=2458923)[0m {'eval_loss': 0.5624396204948425, 'eval_f1': 0.9291338582677166, 'eval_accuracy': 0.8875, 'eval_kappa': 0.6629213483146068, 'eval_precision': 0.8676470588235294, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8400484323501587, 'eval_AP': 0.9624074225029141, 'eval_MCC': 0.7041294762525789, 'eval_NDCG': 0.9928943020323051, 'eval_runtime': 3.4954, 'eval_samples_per_second': 22.887, 'eval_steps_per_second': 1.144, 'epoch': 3.0}

Trial train_hpo_7687fc91 finished iteration 1 at 2025-06-19 08:57:19. Total running time: 4min 5s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_7687fc91 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    51.4035 â”‚
â”‚ time_total_s                        51.4035 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     3 â”‚
â”‚ eval_AP                             0.96241 â”‚
â”‚ eval_MCC                            0.70413 â”‚
â”‚ eval_NDCG                           0.99289 â”‚
â”‚ eval_accuracy                        0.8875 â”‚
â”‚ eval_f1                             0.92913 â”‚
â”‚ eval_kappa                          0.66292 â”‚
â”‚ eval_loss                           0.56244 â”‚
â”‚ eval_optim_threshold                0.84005 â”‚
â”‚ eval_precision                      0.86765 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.4954 â”‚
â”‚ eval_samples_per_second              22.887 â”‚
â”‚ eval_steps_per_second                 1.144 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_7687fc91 completed after 1 iterations at 2025-06-19 08:57:19. Total running time: 4min 5s

Trial status: 3 TERMINATED
Current time: 2025-06-19 08:57:19. Total running time: 4min 5s
Logical resource usage: 10.0/32 CPUs, 1.0/1 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_16f905be   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1            93.2693       1.69012    0.852941            0.75        0.108138  â”‚
â”‚ train_hpo_7cfe5553   TERMINATED        6.09408       4.55539e-06         0.123031                    5        1            79.7909       1.0724     0.846715            0.7375      0.0432802 â”‚
â”‚ train_hpo_7687fc91   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            51.4035       0.56244    0.929134            0.8875      0.662921  â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

[2025-06-19 08:57:20,417] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-06-19 08:57:22,064] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
2025-06-19 08:57:22,099 - INFO - training size : 736
2025-06-19 08:57:22,099 - INFO - dev size : 80
2025-06-19 08:57:22,099 - INFO - test size : 80
  0%|          | 0/276 [00:00<?, ?it/s]  0%|          | 1/276 [00:00<02:37,  1.75it/s]  1%|          | 2/276 [00:00<01:32,  2.97it/s]  1%|          | 3/276 [00:00<01:11,  3.82it/s]  1%|â–         | 4/276 [00:01<01:01,  4.40it/s]  2%|â–         | 5/276 [00:01<00:56,  4.82it/s]  2%|â–         | 6/276 [00:01<00:51,  5.25it/s]  3%|â–Ž         | 7/276 [00:01<00:49,  5.41it/s]  3%|â–Ž         | 8/276 [00:01<00:48,  5.51it/s]  3%|â–Ž         | 9/276 [00:01<00:47,  5.59it/s]  4%|â–Ž         | 10/276 [00:02<00:46,  5.67it/s]  4%|â–         | 11/276 [00:02<00:43,  6.05it/s]  4%|â–         | 12/276 [00:02<00:44,  5.96it/s]  5%|â–         | 13/276 [00:02<00:44,  5.90it/s]  5%|â–Œ         | 14/276 [00:02<00:43,  6.03it/s]  5%|â–Œ         | 15/276 [00:02<00:44,  5.90it/s]  6%|â–Œ         | 16/276 [00:03<00:43,  6.02it/s]  6%|â–Œ         | 17/276 [00:03<00:41,  6.26it/s]  7%|â–‹         | 18/276 [00:03<00:42,  6.11it/s]  7%|â–‹         | 19/276 [00:03<00:42,  6.01it/s]  7%|â–‹         | 20/276 [00:03<00:40,  6.26it/s]  8%|â–Š         | 21/276 [00:03<00:41,  6.11it/s]  8%|â–Š         | 22/276 [00:04<00:42,  6.00it/s]  8%|â–Š         | 23/276 [00:04<00:42,  5.95it/s]  9%|â–Š         | 24/276 [00:04<00:41,  6.07it/s]  9%|â–‰         | 25/276 [00:04<00:41,  6.08it/s]  9%|â–‰         | 26/276 [00:04<00:41,  5.99it/s] 10%|â–‰         | 27/276 [00:04<00:41,  5.93it/s] 10%|â–ˆ         | 28/276 [00:05<00:42,  5.90it/s] 11%|â–ˆ         | 29/276 [00:05<00:40,  6.11it/s] 11%|â–ˆ         | 30/276 [00:05<00:40,  6.02it/s] 11%|â–ˆ         | 31/276 [00:05<00:41,  5.94it/s] 12%|â–ˆâ–        | 32/276 [00:05<00:41,  5.90it/s] 12%|â–ˆâ–        | 33/276 [00:05<00:41,  5.86it/s] 12%|â–ˆâ–        | 34/276 [00:06<00:41,  5.84it/s] 13%|â–ˆâ–Ž        | 35/276 [00:06<00:41,  5.84it/s] 13%|â–ˆâ–Ž        | 36/276 [00:06<00:41,  5.83it/s] 13%|â–ˆâ–Ž        | 37/276 [00:06<00:40,  5.92it/s] 14%|â–ˆâ–        | 38/276 [00:06<00:38,  6.23it/s] 14%|â–ˆâ–        | 39/276 [00:06<00:38,  6.09it/s] 14%|â–ˆâ–        | 40/276 [00:07<00:39,  6.04it/s] 15%|â–ˆâ–        | 41/276 [00:07<00:39,  5.97it/s] 15%|â–ˆâ–Œ        | 42/276 [00:07<00:38,  6.07it/s] 16%|â–ˆâ–Œ        | 43/276 [00:07<00:38,  5.98it/s] 16%|â–ˆâ–Œ        | 44/276 [00:07<00:39,  5.92it/s] 16%|â–ˆâ–‹        | 45/276 [00:07<00:39,  5.88it/s] 17%|â–ˆâ–‹        | 46/276 [00:08<00:38,  6.04it/s] 17%|â–ˆâ–‹        | 47/276 [00:08<00:38,  5.96it/s] 17%|â–ˆâ–‹        | 48/276 [00:08<00:38,  5.91it/s] 18%|â–ˆâ–Š        | 49/276 [00:08<00:36,  6.25it/s] 18%|â–ˆâ–Š        | 50/276 [00:08<00:37,  6.10it/s] 18%|â–ˆâ–Š        | 51/276 [00:08<00:37,  5.99it/s] 19%|â–ˆâ–‰        | 52/276 [00:09<00:37,  5.93it/s] 19%|â–ˆâ–‰        | 53/276 [00:09<00:37,  5.88it/s] 20%|â–ˆâ–‰        | 54/276 [00:09<00:37,  5.86it/s] 20%|â–ˆâ–‰        | 55/276 [00:09<00:36,  6.05it/s] 20%|â–ˆâ–ˆ        | 56/276 [00:09<00:34,  6.31it/s] 21%|â–ˆâ–ˆ        | 57/276 [00:09<00:35,  6.14it/s] 21%|â–ˆâ–ˆ        | 58/276 [00:10<00:36,  6.04it/s] 21%|â–ˆâ–ˆâ–       | 59/276 [00:10<00:33,  6.46it/s] 22%|â–ˆâ–ˆâ–       | 60/276 [00:10<00:33,  6.37it/s] 22%|â–ˆâ–ˆâ–       | 61/276 [00:10<00:32,  6.56it/s] 22%|â–ˆâ–ˆâ–       | 62/276 [00:10<00:32,  6.49it/s] 23%|â–ˆâ–ˆâ–Ž       | 63/276 [00:10<00:33,  6.27it/s] 23%|â–ˆâ–ˆâ–Ž       | 64/276 [00:10<00:32,  6.44it/s] 24%|â–ˆâ–ˆâ–Ž       | 65/276 [00:11<00:33,  6.22it/s] 24%|â–ˆâ–ˆâ–       | 66/276 [00:11<00:34,  6.10it/s] 24%|â–ˆâ–ˆâ–       | 67/276 [00:11<00:33,  6.33it/s] 25%|â–ˆâ–ˆâ–       | 68/276 [00:11<00:33,  6.16it/s] 25%|â–ˆâ–ˆâ–Œ       | 69/276 [00:11<00:34,  6.05it/s] 25%|â–ˆâ–ˆâ–Œ       | 70/276 [00:11<00:32,  6.33it/s] 26%|â–ˆâ–ˆâ–Œ       | 71/276 [00:12<00:32,  6.33it/s] 26%|â–ˆâ–ˆâ–Œ       | 72/276 [00:12<00:33,  6.16it/s] 26%|â–ˆâ–ˆâ–‹       | 73/276 [00:12<00:33,  6.04it/s] 27%|â–ˆâ–ˆâ–‹       | 74/276 [00:12<00:32,  6.28it/s] 27%|â–ˆâ–ˆâ–‹       | 75/276 [00:12<00:32,  6.22it/s] 28%|â–ˆâ–ˆâ–Š       | 76/276 [00:12<00:32,  6.08it/s] 28%|â–ˆâ–ˆâ–Š       | 77/276 [00:13<00:32,  6.08it/s] 28%|â–ˆâ–ˆâ–Š       | 78/276 [00:13<00:33,  5.98it/s] 29%|â–ˆâ–ˆâ–Š       | 79/276 [00:13<00:33,  5.92it/s] 29%|â–ˆâ–ˆâ–‰       | 80/276 [00:13<00:33,  5.88it/s] 29%|â–ˆâ–ˆâ–‰       | 81/276 [00:13<00:33,  5.85it/s] 30%|â–ˆâ–ˆâ–‰       | 82/276 [00:13<00:33,  5.83it/s] 30%|â–ˆâ–ˆâ–ˆ       | 83/276 [00:14<00:33,  5.81it/s] 30%|â–ˆâ–ˆâ–ˆ       | 84/276 [00:14<00:33,  5.80it/s] 31%|â–ˆâ–ˆâ–ˆ       | 85/276 [00:14<00:33,  5.79it/s] 31%|â–ˆâ–ˆâ–ˆ       | 86/276 [00:14<00:31,  5.99it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 87/276 [00:14<00:31,  5.92it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 88/276 [00:14<00:32,  5.87it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 89/276 [00:15<00:32,  5.84it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 90/276 [00:15<00:31,  5.82it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 91/276 [00:15<00:30,  6.10it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 92/276 [00:15<00:30,  6.06it/s]                                                 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 92/276 [00:15<00:30,  6.06it/s] 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 93/276 [00:15<00:30,  5.92it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 94/276 [00:16<00:30,  5.88it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 95/276 [00:16<00:30,  5.90it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 96/276 [00:16<00:30,  5.85it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 97/276 [00:16<00:30,  5.82it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 98/276 [00:16<00:30,  5.80it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 99/276 [00:16<00:30,  5.79it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 100/276 [00:17<00:30,  5.78it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 101/276 [00:17<00:30,  5.77it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 102/276 [00:17<00:30,  5.77it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 103/276 [00:17<00:30,  5.76it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 104/276 [00:17<00:29,  5.75it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 105/276 [00:17<00:29,  5.86it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 106/276 [00:18<00:29,  5.82it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 107/276 [00:18<00:29,  5.81it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 108/276 [00:18<00:28,  5.91it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 109/276 [00:18<00:28,  5.86it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 110/276 [00:18<00:28,  5.83it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 111/276 [00:18<00:27,  6.01it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 112/276 [00:19<00:27,  5.93it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 113/276 [00:19<00:27,  5.89it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 114/276 [00:19<00:27,  5.84it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 115/276 [00:19<00:27,  5.81it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 116/276 [00:19<00:27,  5.80it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 117/276 [00:19<00:27,  5.79it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 118/276 [00:20<00:26,  5.98it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 119/276 [00:20<00:25,  6.24it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 120/276 [00:20<00:25,  6.10it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 121/276 [00:20<00:24,  6.35it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 122/276 [00:20<00:25,  6.15it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 123/276 [00:20<00:25,  6.02it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 124/276 [00:21<00:25,  6.02it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 125/276 [00:21<00:25,  5.94it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 126/276 [00:21<00:25,  5.88it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 127/276 [00:21<00:25,  5.83it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 128/276 [00:21<00:25,  5.81it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 129/276 [00:21<00:25,  5.73it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 130/276 [00:22<00:24,  5.86it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 131/276 [00:22<00:23,  6.30it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 132/276 [00:22<00:22,  6.29it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 133/276 [00:22<00:23,  6.13it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 134/276 [00:22<00:23,  6.06it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 135/276 [00:22<00:23,  5.98it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 136/276 [00:23<00:22,  6.25it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 137/276 [00:23<00:22,  6.08it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 138/276 [00:23<00:23,  5.98it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 139/276 [00:23<00:23,  5.90it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 140/276 [00:23<00:23,  5.86it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 141/276 [00:23<00:23,  5.83it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 142/276 [00:24<00:23,  5.82it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 143/276 [00:24<00:22,  5.96it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 144/276 [00:24<00:22,  5.91it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 145/276 [00:24<00:21,  6.21it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 146/276 [00:24<00:21,  6.06it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 147/276 [00:24<00:21,  5.96it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 148/276 [00:25<00:21,  5.90it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 149/276 [00:25<00:21,  5.85it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 150/276 [00:25<00:21,  5.81it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 151/276 [00:25<00:21,  5.80it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 152/276 [00:25<00:21,  5.78it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 153/276 [00:25<00:21,  5.78it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 154/276 [00:26<00:20,  5.85it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 155/276 [00:26<00:20,  5.87it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 156/276 [00:26<00:20,  5.97it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 157/276 [00:26<00:20,  5.95it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 158/276 [00:26<00:20,  5.90it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 159/276 [00:26<00:19,  5.86it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 160/276 [00:27<00:18,  6.18it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 161/276 [00:27<00:18,  6.15it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 162/276 [00:27<00:18,  6.03it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 163/276 [00:27<00:19,  5.95it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 164/276 [00:27<00:18,  6.10it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 165/276 [00:27<00:18,  5.98it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 166/276 [00:28<00:18,  5.90it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 167/276 [00:28<00:18,  5.85it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 168/276 [00:28<00:18,  5.98it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 169/276 [00:28<00:18,  5.92it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 170/276 [00:28<00:17,  6.19it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 171/276 [00:28<00:17,  6.05it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 172/276 [00:29<00:17,  5.94it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 173/276 [00:29<00:17,  5.88it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 174/276 [00:29<00:17,  5.92it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 175/276 [00:29<00:17,  5.88it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 176/276 [00:29<00:17,  5.84it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 177/276 [00:29<00:16,  6.13it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 178/276 [00:30<00:16,  6.01it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 179/276 [00:30<00:16,  5.93it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 180/276 [00:30<00:16,  5.88it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 181/276 [00:30<00:15,  6.06it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 182/276 [00:30<00:15,  5.96it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 183/276 [00:31<00:15,  5.88it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 184/276 [00:31<00:15,  5.90it/s]                                                  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 184/276 [00:31<00:15,  5.90it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 185/276 [00:31<00:14,  6.09it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 186/276 [00:31<00:15,  6.00it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 187/276 [00:31<00:13,  6.40it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 188/276 [00:31<00:14,  6.18it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 189/276 [00:31<00:14,  6.04it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 190/276 [00:32<00:14,  5.94it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 191/276 [00:32<00:14,  5.88it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 192/276 [00:32<00:14,  5.88it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 193/276 [00:32<00:14,  5.85it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 194/276 [00:32<00:14,  5.81it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 195/276 [00:33<00:13,  5.79it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 196/276 [00:33<00:13,  5.87it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 197/276 [00:33<00:13,  5.84it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 198/276 [00:33<00:12,  6.13it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 199/276 [00:33<00:12,  6.03it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 200/276 [00:33<00:11,  6.36it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 201/276 [00:33<00:11,  6.39it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 202/276 [00:34<00:11,  6.19it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 203/276 [00:34<00:11,  6.12it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 204/276 [00:34<00:11,  6.01it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 205/276 [00:34<00:11,  6.12it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 206/276 [00:34<00:11,  6.10it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 207/276 [00:34<00:11,  5.98it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 208/276 [00:35<00:11,  5.89it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 209/276 [00:35<00:11,  5.84it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 210/276 [00:35<00:11,  5.81it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 211/276 [00:35<00:11,  5.78it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 212/276 [00:35<00:11,  5.77it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 213/276 [00:36<00:10,  5.93it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 214/276 [00:36<00:10,  5.87it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 215/276 [00:36<00:10,  5.92it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 216/276 [00:36<00:09,  6.18it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 217/276 [00:36<00:09,  6.42it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 218/276 [00:36<00:09,  6.21it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 219/276 [00:36<00:09,  6.07it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 220/276 [00:37<00:09,  5.97it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 221/276 [00:37<00:09,  5.91it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 222/276 [00:37<00:08,  6.20it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 223/276 [00:37<00:08,  6.06it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 224/276 [00:37<00:08,  6.00it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 225/276 [00:37<00:08,  5.93it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 226/276 [00:38<00:08,  6.19it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 227/276 [00:38<00:07,  6.26it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 228/276 [00:38<00:07,  6.09it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 229/276 [00:38<00:07,  5.97it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 230/276 [00:38<00:07,  6.06it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 231/276 [00:38<00:07,  5.96it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 232/276 [00:39<00:07,  5.89it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 233/276 [00:39<00:07,  5.97it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 234/276 [00:39<00:06,  6.24it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 235/276 [00:39<00:06,  6.20it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 236/276 [00:39<00:06,  6.06it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 237/276 [00:39<00:06,  6.17it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 238/276 [00:40<00:06,  6.02it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 239/276 [00:40<00:06,  5.93it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 240/276 [00:40<00:06,  5.86it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 241/276 [00:40<00:06,  5.82it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 242/276 [00:40<00:05,  5.80it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 243/276 [00:40<00:05,  6.08it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 244/276 [00:41<00:05,  5.97it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 245/276 [00:41<00:05,  5.94it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 246/276 [00:41<00:05,  5.88it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 247/276 [00:41<00:04,  5.83it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 248/276 [00:41<00:04,  5.81it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 249/276 [00:41<00:04,  6.13it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 250/276 [00:42<00:04,  6.02it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 251/276 [00:42<00:04,  6.18it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 252/276 [00:42<00:03,  6.04it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 253/276 [00:42<00:04,  5.62it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 254/276 [00:42<00:03,  5.67it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 255/276 [00:43<00:03,  5.69it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 256/276 [00:43<00:03,  5.70it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 257/276 [00:43<00:03,  5.72it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 258/276 [00:43<00:03,  5.73it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 259/276 [00:43<00:02,  5.91it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 260/276 [00:43<00:02,  5.86it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 261/276 [00:44<00:02,  5.83it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 262/276 [00:44<00:02,  6.12it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 263/276 [00:44<00:02,  6.33it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 264/276 [00:44<00:01,  6.15it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 265/276 [00:44<00:01,  6.39it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 266/276 [00:44<00:01,  6.53it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 267/276 [00:44<00:01,  6.28it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 268/276 [00:45<00:01,  6.45it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 269/276 [00:45<00:01,  6.23it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 270/276 [00:45<00:00,  6.41it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 271/276 [00:45<00:00,  6.38it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 272/276 [00:45<00:00,  6.18it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 273/276 [00:45<00:00,  6.04it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 274/276 [00:46<00:00,  5.94it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 275/276 [00:46<00:00,  5.87it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 276/276 [00:46<00:00,  5.90it/s]                                                 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 276/276 [00:48<00:00,  5.90it/s]                                                 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 276/276 [00:48<00:00,  5.90it/s]2025-06-19 08:58:10,777 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 276/276 [00:48<00:00,  5.71it/s]
{'loss': 0.9345, 'grad_norm': 2.8655223846435547, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
{'loss': 0.546, 'grad_norm': 4.610090255737305, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
{'loss': 0.4065, 'grad_norm': 0.49525827169418335, 'learning_rate': 0.0, 'epoch': 3.0}
{'train_runtime': 48.3827, 'train_samples_per_second': 45.636, 'train_steps_per_second': 5.705, 'train_loss': 0.6290321488311326, 'epoch': 3.0}
  0%|          | 0/10 [00:00<?, ?it/s] 30%|â–ˆâ–ˆâ–ˆ       | 3/10 [00:00<00:00, 25.74it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 6/10 [00:00<00:00, 20.02it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 9/10 [00:00<00:00, 18.60it/s]2025-06-19 08:58:14,231 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:03<00:00,  2.95it/s]
2025-06-19 08:58:14,237 - INFO - Training time : 54.75661729299463
  0%|          | 0/10 [00:00<?, ?it/s] 30%|â–ˆâ–ˆâ–ˆ       | 3/10 [00:00<00:00, 25.72it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 6/10 [00:00<00:00, 19.85it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 9/10 [00:00<00:00, 18.38it/s]2025-06-19 08:58:17,836 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:03<00:00,  2.83it/s]
2025-06-19 08:58:17,841 - INFO - Evaluation time : 3.6035665060626343
2025-06-19 08:58:17,841 - INFO - Evaluation results on test set: {'eval_loss': 2.4513580799102783, 'eval_f1': 0.8396946564885496, 'eval_accuracy': 0.7375, 'eval_kappa': 0.15322580645161277, 'eval_precision': 0.7638888888888888, 'eval_recall': 0.9322033898305084, 'eval_optim_threshold': 0.992124617099762, 'eval_AP': 0.9152044393390373, 'eval_MCC': 0.17992714674692645, 'eval_NDCG': 0.981216912844385, 'eval_runtime': 3.5995, 'eval_samples_per_second': 22.225, 'eval_steps_per_second': 2.778, 'epoch': 3.0}
2025-06-19 08:58:17,841 - INFO - Total updates (optimizer steps): 276
2025-06-19 08:58:17,841 - INFO - Avg time / step: 0.175s
2025-06-19 08:58:18,606 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCEmicrosoft/BiomedNLP-BiomedBERT-base-uncased-abstract3trials_fold-1
2025-06-19 08:58:18,606 - INFO - On test Set (with threshold 0.5) : 
  0%|          | 0/10 [00:00<?, ?it/s] 30%|â–ˆâ–ˆâ–ˆ       | 3/10 [00:00<00:00, 25.72it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 6/10 [00:00<00:00, 18.57it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 8/10 [00:00<00:00, 18.08it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:00<00:00, 18.14it/s]2025-06-19 08:58:21,957 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:03<00:00,  3.04it/s]
2025-06-19 08:58:21,961 - INFO - Raw predictions shape: (80, 1)
2025-06-19 08:58:21,961 - INFO - Raw predictions: [[4.9359202]
 [4.9171257]
 [4.794225 ]
 [5.009918 ]
 [5.0268793]
 [5.067515 ]
 [4.9097095]
 [4.772695 ]
 [4.509914 ]
 [4.6134667]]
2025-06-19 08:58:21,961 - INFO - Scores shape: (80,)
2025-06-19 08:58:21,961 - INFO - Scores: [0.99286747 0.992733   0.99179053 0.9933728  0.9934835  0.99374133
 0.99267936 0.9916134  0.98912024 0.99018   ]
2025-06-19 08:58:21,961 - INFO - Preds shape: (80,)
2025-06-19 08:58:21,962 - INFO - Preds: [1 1 1 1 1 1 1 1 1 1]
2025-06-19 08:58:21,962 - INFO - Test labels shape: (80,)
2025-06-19 08:58:21,963 - INFO - Test labels: [1, 1, 0, 0, 1, 1, 1, 1, 0, 0]
2025-06-19 08:58:21,963 - INFO - Test split: Dataset({
    features: ['title', 'abstract', 'Keywords', 'doi', 'labels'],
    num_rows: 80
})
2025-06-19 08:58:21,963 - INFO - Unique values in predictions: [0 1]
2025-06-19 08:58:21,964 - INFO - Unique values in labels: [0 1]
2025-06-19 08:58:21,965 - INFO - Confusion matrix:
[[ 4 17]
 [ 4 55]]
2025-06-19 08:58:21,966 - INFO - Confusion matrix: TN=4, FP=17, FN=4, TP=55
2025-06-19 08:58:24,701 - INFO - Metrics: {'f1': 0.8396946564885496, 'recall': 0.9322033898305084, 'precision': 0.7638888888888888, 'accuracy': 0.7375, 'AP': 0.9152044393390373, 'MCC': 0.17992714674692645, 'NDCG': 0.981216912844385, 'kappa': 0.15322580645161277, 'TN': 4, 'FP': 17, 'FN': 4, 'TP': 55}
2025-06-19 08:58:24,705 - INFO - Metrics stored successfully at /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/metrics/binary_metrics.csv
2025-06-19 08:58:24,822 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-19 08:58:24,924 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-19 08:58:24,924 - INFO - 
On test Set (optimal threshold of 0.9926530122756958 according to cross validation on the training set): 
2025-06-19 08:58:24,926 - INFO - Confusion matrix: TN=18, FP=3, FN=25, TP=34
2025-06-19 08:58:27,639 - INFO - Metrics: {'f1': 0.7083333333333334, 'recall': 0.576271186440678, 'precision': 0.918918918918919, 'accuracy': 0.65, 'AP': 0.9152044393390373, 'MCC': 0.3824754309937626, 'NDCG': 0.981216912844385, 'kappa': 0.32407966203983096, 'TN': 18, 'FP': 3, 'FN': 25, 'TP': 34}
2025-06-19 08:58:27,743 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-19 08:58:27,744 - INFO - Results for fold 1 : [{'f1': 0.7083333333333334, 'recall': 0.576271186440678, 'precision': 0.918918918918919, 'accuracy': 0.65, 'AP': 0.9152044393390373, 'MCC': 0.3824754309937626, 'NDCG': 0.981216912844385, 'kappa': 0.32407966203983096, 'TN': 18, 'FP': 3, 'FN': 25, 'TP': 34}]
2025-06-19 08:58:28,061 - INFO - Cleared CUDA cache. Memory allocated: 1.38 GB, Memory reserved: 1.55 GB
2025-06-19 08:58:28,338 - INFO - Cleared CUDA cache. Memory allocated: 1.38 GB, Memory reserved: 1.55 GB
2025-06-19 08:58:28,338 - INFO - 
fold number 2 / 5
2025-06-19 08:58:28,344 - INFO - train split size : 736
2025-06-19 08:58:28,344 - INFO - dev split size : 80
2025-06-19 08:58:28,344 - INFO - test split size : 80
Map (num_proc=32):   0%|          | 0/736 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 23/736 [00:00<00:13, 52.13 examples/s]Map (num_proc=32):  16%|â–ˆâ–Œ        | 115/736 [00:00<00:02, 263.39 examples/s]Map (num_proc=32):  28%|â–ˆâ–ˆâ–Š       | 207/736 [00:00<00:01, 410.31 examples/s]Map (num_proc=32):  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 345/736 [00:00<00:00, 636.96 examples/s]Map (num_proc=32):  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 460/736 [00:00<00:00, 684.51 examples/s]Map (num_proc=32):  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 552/736 [00:01<00:00, 733.87 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 667/736 [00:01<00:00, 827.44 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 736/736 [00:01<00:00, 554.99 examples/s]
Map (num_proc=32):   0%|          | 0/80 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/80 [00:00<00:09,  8.12 examples/s]Map (num_proc=32):  22%|â–ˆâ–ˆâ–Ž       | 18/80 [00:00<00:01, 44.86 examples/s]Map (num_proc=32):  41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 33/80 [00:00<00:00, 69.36 examples/s]Map (num_proc=32):  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 45/80 [00:00<00:00, 82.40 examples/s]Map (num_proc=32):  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 56/80 [00:00<00:00, 82.96 examples/s]Map (num_proc=32):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 66/80 [00:00<00:00, 82.14 examples/s]Map (num_proc=32):  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 76/80 [00:01<00:00, 86.60 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 80/80 [00:01<00:00, 64.46 examples/s]
Map (num_proc=32):   0%|          | 0/80 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/80 [00:00<00:09,  8.09 examples/s]Map (num_proc=32):  19%|â–ˆâ–‰        | 15/80 [00:00<00:01, 38.07 examples/s]Map (num_proc=32):  38%|â–ˆâ–ˆâ–ˆâ–Š      | 30/80 [00:00<00:00, 65.18 examples/s]Map (num_proc=32):  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 45/80 [00:00<00:00, 79.00 examples/s]Map (num_proc=32):  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 58/80 [00:00<00:00, 79.77 examples/s]Map (num_proc=32):  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 72/80 [00:01<00:00, 86.96 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 80/80 [00:01<00:00, 63.16 examples/s]
2025-06-19 08:58:38,041 - INFO - 3 datasets tokenized successfully
2025-06-19 08:58:38,185 - INFO - Fold 2 max seq len = 512
2025-06-19 08:58:38,185 - INFO - Starting hyperparameter search for BCE loss
[36m(train_hpo pid=2461676)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=2461676)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=2461676)[0m 2025-06-19 08:58:45,641 - INFO - pos_weight value in TrainingArguments : 6.828424226204718
[36m(train_hpo pid=2461676)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=2461676)[0m   super().__init__(*args, **kwargs)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-19_08-58-38   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-19_08-58-38
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-19_08-53-05_394440_2452736/artifacts/2025-06-19_08-58-38/train_hpo_2025-06-19_08-58-38/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-19 08:58:38. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/1 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_d015ac55   PENDING         6.82842       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_d015ac55 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_d015ac55 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          6.82842 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=2461676)[0m [2025-06-19 08:58:45,869] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=2461676)[0m [2025-06-19 08:58:48,553] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(train_hpo pid=2461676)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=222, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=2461676)[0m {'loss': 1.4595, 'grad_norm': 17.291913986206055, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}

Trial status: 1 RUNNING | 1 PENDING
Current time: 2025-06-19 08:59:08. Total running time: 30s
Logical resource usage: 10.0/32 CPUs, 1.0/1 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_d015ac55   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_37f9363b   PENDING         6.09408       4.55539e-06         0.123031                    5 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=2461676)[0m {'loss': 1.3688, 'grad_norm': 24.020761489868164, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0}
[36m(train_hpo pid=2461676)[0m {'loss': 1.2711, 'grad_norm': 17.415443420410156, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0}
Trial status: 1 RUNNING | 1 PENDING
Current time: 2025-06-19 08:59:38. Total running time: 1min 0s
Logical resource usage: 10.0/32 CPUs, 1.0/1 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_d015ac55   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_37f9363b   PENDING         6.09408       4.55539e-06         0.123031                    5 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=2461676)[0m {'loss': 1.1904, 'grad_norm': 16.605070114135742, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0}
[36m(train_hpo pid=2461676)[0m {'loss': 1.1472, 'grad_norm': 14.115935325622559, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0}
Trial status: 1 RUNNING | 1 PENDING
Current time: 2025-06-19 09:00:08. Total running time: 1min 30s
Logical resource usage: 10.0/32 CPUs, 1.0/1 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_d015ac55   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_37f9363b   PENDING         6.09408       4.55539e-06         0.123031                    5 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(train_hpo pid=2461676)[0m 2025-06-19 09:00:18,398 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=2461676)[0m 2025-06-19 09:00:18,403 - INFO - eval_result: {'eval_loss': 1.7617136240005493, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.7773106694221497, 'eval_AP': 0.8628536266305777, 'eval_MCC': 0.0, 'eval_NDCG': 0.9628593171557821, 'eval_runtime': 3.359, 'eval_samples_per_second': 23.816, 'eval_steps_per_second': 1.191, 'epoch': 6.0}
2025-06-19 09:00:18,750 - INFO - Cleaning up trial d015ac55
2025-06-19 09:00:18,750 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-19_08-58-38/train_hpo_d015ac55_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-19_08-58-38
[36m(train_hpo pid=2461676)[0m 2025-06-19 09:00:18,728 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.60 GB
2025-06-19 09:00:26,501	WARNING tune.py:219 -- Stop signal received (e.g. via SIGINT/Ctrl+C), ending Ray Tune run. This will try to checkpoint the experiment state one last time. Press CTRL+C (or send SIGINT/SIGKILL/SIGTERM) to skip. 
2025-06-19 09:00:26,505	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-19_08-58-38' in 0.0041s.
[36m(train_hpo pid=2463403)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=2463403)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=2463403)[0m 2025-06-19 09:00:26,734 - INFO - pos_weight value in TrainingArguments : 6.094080202241274
[36m(train_hpo pid=2463403)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=2463403)[0m   super().__init__(*args, **kwargs)

[36m(train_hpo pid=2461676)[0m {'loss': 1.109, 'grad_norm': 16.786256790161133, 'learning_rate': 0.0, 'epoch': 6.0}
[36m(train_hpo pid=2461676)[0m {'train_runtime': 86.1618, 'train_samples_per_second': 51.252, 'train_steps_per_second': 2.577, 'train_loss': 1.257657695460964, 'epoch': 6.0}
[36m(train_hpo pid=2461676)[0m STATE at ending of training  :  TrainerState(epoch=6.0, global_step=222, max_steps=222, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=1153491120980232.0, log_history=[{'loss': 1.4595, 'grad_norm': 17.291913986206055, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0, 'step': 37}, {'loss': 1.3688, 'grad_norm': 24.020761489868164, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0, 'step': 74}, {'loss': 1.2711, 'grad_norm': 17.415443420410156, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0, 'step': 111}, {'loss': 1.1904, 'grad_norm': 16.605070114135742, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0, 'step': 148}, {'loss': 1.1472, 'grad_norm': 14.115935325622559, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0, 'step': 185}, {'loss': 1.109, 'grad_norm': 16.786256790161133, 'learning_rate': 0.0, 'epoch': 6.0, 'step': 222}, {'train_runtime': 86.1618, 'train_samples_per_second': 51.252, 'train_steps_per_second': 2.577, 'total_flos': 1153491120980232.0, 'train_loss': 1.257657695460964, 'epoch': 6.0, 'step': 222}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=2461676)[0m {'eval_loss': 1.7617136240005493, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.7773106694221497, 'eval_AP': 0.8628536266305777, 'eval_MCC': 0.0, 'eval_NDCG': 0.9628593171557821, 'eval_runtime': 3.359, 'eval_samples_per_second': 23.816, 'eval_steps_per_second': 1.191, 'epoch': 6.0}

Trial train_hpo_d015ac55 finished iteration 1 at 2025-06-19 09:00:18. Total running time: 1min 40s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_d015ac55 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                     93.943 â”‚
â”‚ time_total_s                         93.943 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     6 â”‚
â”‚ eval_AP                             0.86285 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.96286 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.76171 â”‚
â”‚ eval_optim_threshold                0.77731 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                          3.359 â”‚
â”‚ eval_samples_per_second              23.816 â”‚
â”‚ eval_steps_per_second                 1.191 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_d015ac55 completed after 1 iterations at 2025-06-19 09:00:18. Total running time: 1min 40s

Trial train_hpo_37f9363b started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_37f9363b config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          6.09408 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial status: 1 TERMINATED | 1 RUNNING | 1 PENDING
Current time: 2025-06-19 09:00:26. Total running time: 1min 48s
Logical resource usage: 10.0/32 CPUs, 1.0/1 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_37f9363b   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ train_hpo_d015ac55   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1             93.943       1.76171    0.848921            0.7375              0 â”‚
â”‚ train_hpo_2ef630ae   PENDING           7.18321       7.98818e-05         0.251217                    3                                                                                        â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=2463403)[0m [2025-06-19 09:00:26,962] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=2463403)[0m [2025-06-19 09:00:29,673] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(train_hpo pid=2463403)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=185, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})2025-06-19 09:00:36,512	WARNING tune.py:1056 -- Experiment has been interrupted, but the most recent state was saved.
Resume experiment with: tune.run(..., resume=True)
2025-06-19 09:00:36,517	WARNING experiment_analysis.py:180 -- Failed to fetch metrics for 1 trial(s):
- train_hpo_2ef630ae: FileNotFoundError('Could not fetch metrics for train_hpo_2ef630ae: both result.json and progress.csv were not found at /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-19_08-58-38/train_hpo_2ef630ae_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512_2025-06-19_09-00-25')
2025-06-19 09:00:36,518 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x7db0805a5c90>
2025-06-19 09:00:36,518 - INFO - Best trial : train_hpo_d015ac55
2025-06-19 09:00:36,518 - INFO - Best config : {'pos_weight': 6.828424226204718, 'learning_rate': 1.4956066518424355e-06, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 6}
2025-06-19 09:00:36,518 - INFO - Best trial after optimization: {'eval_loss': 1.7617136240005493, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.7773106694221497, 'eval_AP': 0.8628536266305777, 'eval_MCC': 0.0, 'eval_NDCG': 0.9628593171557821, 'eval_runtime': 3.359, 'eval_samples_per_second': 23.816, 'eval_steps_per_second': 1.191, 'epoch': 6.0, 'timestamp': 1750316418, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': 'd015ac55', 'date': '2025-06-19_09-00-18', 'time_this_iter_s': 93.94297671318054, 'time_total_s': 93.94297671318054, 'pid': 2461676, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 6.828424226204718, 'learning_rate': 1.4956066518424355e-06, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 6}, 'time_since_restore': 93.94297671318054, 'iterations_since_restore': 1, 'experiment_tag': '1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364'}
2025-06-19 09:00:36,537 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   1.761714  0.848921  ...                        6  d015ac55

[1 rows x 32 columns]
2025-06-19 09:00:36,700 - INFO - Trial comparison plot saved
2025-06-19 09:00:36,700 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-19 09:00:37,298 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-19 09:00:37,413 - INFO - training size : 736
2025-06-19 09:00:37,414 - INFO - dev size : 80
2025-06-19 09:00:37,414 - INFO - test size : 80


  0%|          | 0/552 [00:00<?, ?it/s]  0%|          | 1/552 [00:00<01:47,  5.11it/s]  0%|          | 2/552 [00:00<01:34,  5.85it/s]  1%|          | 3/552 [00:00<01:34,  5.81it/s]  1%|          | 4/552 [00:00<01:34,  5.79it/s]  1%|          | 5/552 [00:00<01:34,  5.78it/s]  1%|          | 6/552 [00:01<01:34,  5.77it/s]  1%|â–         | 7/552 [00:01<01:34,  5.76it/s]  1%|â–         | 8/552 [00:01<01:34,  5.76it/s]  2%|â–         | 9/552 [00:01<01:34,  5.75it/s]  2%|â–         | 10/552 [00:01<01:34,  5.76it/s]  2%|â–         | 11/552 [00:01<01:29,  6.06it/s]  2%|â–         | 12/552 [00:02<01:30,  5.95it/s]  2%|â–         | 13/552 [00:02<01:31,  5.88it/s]  3%|â–Ž         | 14/552 [00:02<01:29,  6.01it/s]  3%|â–Ž         | 15/552 [00:02<01:30,  5.94it/s]  3%|â–Ž         | 16/552 [00:02<01:28,  6.04it/s]  3%|â–Ž         | 17/552 [00:02<01:29,  5.96it/s]  3%|â–Ž         | 18/552 [00:03<01:30,  5.90it/s]  3%|â–Ž         | 19/552 [00:03<01:30,  5.86it/s]  4%|â–Ž         | 20/552 [00:03<01:26,  6.14it/s]  4%|â–         | 21/552 [00:03<01:28,  6.03it/s]  4%|â–         | 22/552 [00:03<01:26,  6.11it/s]  4%|â–         | 23/552 [00:03<01:27,  6.01it/s]  4%|â–         | 24/552 [00:04<01:24,  6.26it/s]  5%|â–         | 25/552 [00:04<01:26,  6.11it/s]  5%|â–         | 26/552 [00:04<01:22,  6.35it/s]  5%|â–         | 27/552 [00:04<01:25,  6.16it/s]  5%|â–Œ         | 28/552 [00:04<01:26,  6.05it/s]  5%|â–Œ         | 29/552 [00:04<01:22,  6.32it/s]  5%|â–Œ         | 30/552 [00:05<01:24,  6.19it/s]  6%|â–Œ         | 31/552 [00:05<01:26,  6.05it/s]  6%|â–Œ         | 32/552 [00:05<01:27,  5.96it/s]  6%|â–Œ         | 33/552 [00:05<01:27,  5.90it/s]  6%|â–Œ         | 34/552 [00:05<01:26,  6.01it/s]  6%|â–‹         | 35/552 [00:05<01:27,  5.93it/s]  7%|â–‹         | 36/552 [00:06<01:27,  5.88it/s]  7%|â–‹         | 37/552 [00:06<01:26,  5.96it/s]  7%|â–‹         | 38/552 [00:06<01:27,  5.90it/s]  7%|â–‹         | 39/552 [00:06<01:27,  5.86it/s]  7%|â–‹         | 40/552 [00:06<01:27,  5.87it/s]  7%|â–‹         | 41/552 [00:06<01:26,  5.94it/s]  8%|â–Š         | 42/552 [00:07<01:24,  6.04it/s]  8%|â–Š         | 43/552 [00:07<01:25,  5.94it/s]  8%|â–Š         | 44/552 [00:07<01:26,  5.89it/s]  8%|â–Š         | 45/552 [00:07<01:26,  5.86it/s]  8%|â–Š         | 46/552 [00:07<01:22,  6.14it/s]  9%|â–Š         | 47/552 [00:07<01:24,  6.01it/s]  9%|â–Š         | 48/552 [00:08<01:24,  5.95it/s]  9%|â–‰         | 49/552 [00:08<01:20,  6.28it/s]  9%|â–‰         | 50/552 [00:08<01:22,  6.10it/s]  9%|â–‰         | 51/552 [00:08<01:23,  6.00it/s]  9%|â–‰         | 52/552 [00:08<01:24,  5.92it/s] 10%|â–‰         | 53/552 [00:08<01:24,  5.87it/s] 10%|â–‰         | 54/552 [00:09<01:25,  5.84it/s] 10%|â–‰         | 55/552 [00:09<01:25,  5.83it/s] 10%|â–ˆ         | 56/552 [00:09<01:20,  6.13it/s] 10%|â–ˆ         | 57/552 [00:09<01:19,  6.20it/s] 11%|â–ˆ         | 58/552 [00:09<01:20,  6.12it/s] 11%|â–ˆ         | 59/552 [00:09<01:21,  6.02it/s] 11%|â–ˆ         | 60/552 [00:10<01:21,  6.07it/s] 11%|â–ˆ         | 61/552 [00:10<01:22,  5.98it/s] 11%|â–ˆ         | 62/552 [00:10<01:20,  6.09it/s] 11%|â–ˆâ–        | 63/552 [00:10<01:18,  6.19it/s] 12%|â–ˆâ–        | 64/552 [00:10<01:20,  6.05it/s] 12%|â–ˆâ–        | 65/552 [00:10<01:21,  5.96it/s] 12%|â–ˆâ–        | 66/552 [00:11<01:22,  5.91it/s] 12%|â–ˆâ–        | 67/552 [00:11<01:19,  6.08it/s] 12%|â–ˆâ–        | 68/552 [00:11<01:19,  6.11it/s] 12%|â–ˆâ–Ž        | 69/552 [00:11<01:19,  6.10it/s] 13%|â–ˆâ–Ž        | 70/552 [00:11<01:15,  6.36it/s] 13%|â–ˆâ–Ž        | 71/552 [00:11<01:17,  6.17it/s] 13%|â–ˆâ–Ž        | 72/552 [00:12<01:19,  6.06it/s] 13%|â–ˆâ–Ž        | 73/552 [00:12<01:20,  5.97it/s] 13%|â–ˆâ–Ž        | 74/552 [00:12<01:17,  6.13it/s] 14%|â–ˆâ–Ž        | 75/552 [00:12<01:19,  6.02it/s] 14%|â–ˆâ–        | 76/552 [00:12<01:20,  5.94it/s] 14%|â–ˆâ–        | 77/552 [00:12<01:16,  6.22it/s] 14%|â–ˆâ–        | 78/552 [00:12<01:17,  6.08it/s] 14%|â–ˆâ–        | 79/552 [00:13<01:18,  6.00it/s] 14%|â–ˆâ–        | 80/552 [00:13<01:15,  6.24it/s] 15%|â–ˆâ–        | 81/552 [00:13<01:17,  6.10it/s] 15%|â–ˆâ–        | 82/552 [00:13<01:16,  6.17it/s] 15%|â–ˆâ–Œ        | 83/552 [00:13<01:17,  6.05it/s] 15%|â–ˆâ–Œ        | 84/552 [00:13<01:18,  5.96it/s] 15%|â–ˆâ–Œ        | 85/552 [00:14<01:18,  5.98it/s] 16%|â–ˆâ–Œ        | 86/552 [00:14<01:18,  5.91it/s] 16%|â–ˆâ–Œ        | 87/552 [00:14<01:18,  5.95it/s] 16%|â–ˆâ–Œ        | 88/552 [00:14<01:18,  5.89it/s] 16%|â–ˆâ–Œ        | 89/552 [00:14<01:19,  5.85it/s] 16%|â–ˆâ–‹        | 90/552 [00:15<01:19,  5.82it/s] 16%|â–ˆâ–‹        | 91/552 [00:15<01:17,  5.96it/s] 17%|â–ˆâ–‹        | 92/552 [00:15<01:16,  6.01it/s]                                                 17%|â–ˆâ–‹        | 92/552 [00:15<01:16,  6.01it/s] 17%|â–ˆâ–‹        | 93/552 [00:15<01:17,  5.93it/s] 17%|â–ˆâ–‹        | 94/552 [00:15<01:17,  5.88it/s] 17%|â–ˆâ–‹        | 95/552 [00:15<01:17,  5.90it/s] 17%|â–ˆâ–‹        | 96/552 [00:16<01:17,  5.85it/s] 18%|â–ˆâ–Š        | 97/552 [00:16<01:17,  5.91it/s] 18%|â–ˆâ–Š        | 98/552 [00:16<01:17,  5.87it/s] 18%|â–ˆâ–Š        | 99/552 [00:16<01:17,  5.84it/s] 18%|â–ˆâ–Š        | 100/552 [00:16<01:17,  5.81it/s] 18%|â–ˆâ–Š        | 101/552 [00:16<01:17,  5.80it/s] 18%|â–ˆâ–Š        | 102/552 [00:17<01:17,  5.79it/s] 19%|â–ˆâ–Š        | 103/552 [00:17<01:17,  5.78it/s] 19%|â–ˆâ–‰        | 104/552 [00:17<01:16,  5.85it/s] 19%|â–ˆâ–‰        | 105/552 [00:17<01:16,  5.81it/s] 19%|â–ˆâ–‰        | 106/552 [00:17<01:16,  5.79it/s] 19%|â–ˆâ–‰        | 107/552 [00:17<01:16,  5.79it/s] 20%|â–ˆâ–‰        | 108/552 [00:18<01:16,  5.78it/s] 20%|â–ˆâ–‰        | 109/552 [00:18<01:16,  5.77it/s] 20%|â–ˆâ–‰        | 110/552 [00:18<01:16,  5.77it/s] 20%|â–ˆâ–ˆ        | 111/552 [00:18<01:13,  5.98it/s] 20%|â–ˆâ–ˆ        | 112/552 [00:18<01:10,  6.23it/s] 20%|â–ˆâ–ˆ        | 113/552 [00:18<01:11,  6.10it/s] 21%|â–ˆâ–ˆ        | 114/552 [00:19<01:09,  6.34it/s] 21%|â–ˆâ–ˆ        | 115/552 [00:19<01:11,  6.15it/s] 21%|â–ˆâ–ˆ        | 116/552 [00:19<01:12,  6.03it/s] 21%|â–ˆâ–ˆ        | 117/552 [00:19<01:13,  5.94it/s] 21%|â–ˆâ–ˆâ–       | 118/552 [00:19<01:11,  6.08it/s] 22%|â–ˆâ–ˆâ–       | 119/552 [00:19<01:08,  6.29it/s] 22%|â–ˆâ–ˆâ–       | 120/552 [00:20<01:10,  6.14it/s] 22%|â–ˆâ–ˆâ–       | 121/552 [00:20<01:07,  6.38it/s] 22%|â–ˆâ–ˆâ–       | 122/552 [00:20<01:08,  6.25it/s] 22%|â–ˆâ–ˆâ–       | 123/552 [00:20<01:10,  6.08it/s] 22%|â–ˆâ–ˆâ–       | 124/552 [00:20<01:11,  5.97it/s] 23%|â–ˆâ–ˆâ–Ž       | 125/552 [00:20<01:12,  5.90it/s] 23%|â–ˆâ–ˆâ–Ž       | 126/552 [00:21<01:12,  5.86it/s] 23%|â–ˆâ–ˆâ–Ž       | 127/552 [00:21<01:13,  5.82it/s] 23%|â–ˆâ–ˆâ–Ž       | 128/552 [00:21<01:13,  5.80it/s] 23%|â–ˆâ–ˆâ–Ž       | 129/552 [00:21<01:13,  5.78it/s] 24%|â–ˆâ–ˆâ–Ž       | 130/552 [00:21<01:12,  5.79it/s] 24%|â–ˆâ–ˆâ–Ž       | 131/552 [00:21<01:07,  6.24it/s] 24%|â–ˆâ–ˆâ–       | 132/552 [00:22<01:08,  6.09it/s] 24%|â–ˆâ–ˆâ–       | 133/552 [00:22<01:10,  5.98it/s] 24%|â–ˆâ–ˆâ–       | 134/552 [00:22<01:10,  5.91it/s] 24%|â–ˆâ–ˆâ–       | 135/552 [00:22<01:10,  5.88it/s] 25%|â–ˆâ–ˆâ–       | 136/552 [00:22<01:07,  6.17it/s] 25%|â–ˆâ–ˆâ–       | 137/552 [00:22<01:08,  6.04it/s] 25%|â–ˆâ–ˆâ–Œ       | 138/552 [00:23<01:09,  5.95it/s] 25%|â–ˆâ–ˆâ–Œ       | 139/552 [00:23<01:10,  5.90it/s] 25%|â–ˆâ–ˆâ–Œ       | 140/552 [00:23<01:06,  6.17it/s] 26%|â–ˆâ–ˆâ–Œ       | 141/552 [00:23<01:07,  6.05it/s] 26%|â–ˆâ–ˆâ–Œ       | 142/552 [00:23<01:04,  6.31it/s] 26%|â–ˆâ–ˆâ–Œ       | 143/552 [00:23<01:03,  6.49it/s] 26%|â–ˆâ–ˆâ–Œ       | 144/552 [00:24<01:05,  6.25it/s] 26%|â–ˆâ–ˆâ–‹       | 145/552 [00:24<01:02,  6.48it/s] 26%|â–ˆâ–ˆâ–‹       | 146/552 [00:24<01:05,  6.24it/s] 27%|â–ˆâ–ˆâ–‹       | 147/552 [00:24<01:04,  6.26it/s] 27%|â–ˆâ–ˆâ–‹       | 148/552 [00:24<01:05,  6.19it/s] 27%|â–ˆâ–ˆâ–‹       | 149/552 [00:24<01:06,  6.05it/s] 27%|â–ˆâ–ˆâ–‹       | 150/552 [00:24<01:06,  6.02it/s] 27%|â–ˆâ–ˆâ–‹       | 151/552 [00:25<01:07,  5.93it/s] 28%|â–ˆâ–ˆâ–Š       | 152/552 [00:25<01:08,  5.87it/s] 28%|â–ˆâ–ˆâ–Š       | 153/552 [00:25<01:08,  5.82it/s] 28%|â–ˆâ–ˆâ–Š       | 154/552 [00:25<01:07,  5.87it/s] 28%|â–ˆâ–ˆâ–Š       | 155/552 [00:25<01:07,  5.89it/s] 28%|â–ˆâ–ˆâ–Š       | 156/552 [00:26<01:06,  5.98it/s] 28%|â–ˆâ–ˆâ–Š       | 157/552 [00:26<01:05,  6.07it/s] 29%|â–ˆâ–ˆâ–Š       | 158/552 [00:26<01:05,  5.98it/s] 29%|â–ˆâ–ˆâ–‰       | 159/552 [00:26<01:06,  5.91it/s] 29%|â–ˆâ–ˆâ–‰       | 160/552 [00:26<01:04,  6.10it/s] 29%|â–ˆâ–ˆâ–‰       | 161/552 [00:26<01:01,  6.35it/s] 29%|â–ˆâ–ˆâ–‰       | 162/552 [00:26<01:03,  6.17it/s] 30%|â–ˆâ–ˆâ–‰       | 163/552 [00:27<01:04,  6.04it/s] 30%|â–ˆâ–ˆâ–‰       | 164/552 [00:27<01:03,  6.16it/s] 30%|â–ˆâ–ˆâ–‰       | 165/552 [00:27<01:04,  6.02it/s] 30%|â–ˆâ–ˆâ–ˆ       | 166/552 [00:27<01:05,  5.93it/s] 30%|â–ˆâ–ˆâ–ˆ       | 167/552 [00:27<01:05,  5.88it/s] 30%|â–ˆâ–ˆâ–ˆ       | 168/552 [00:28<01:05,  5.84it/s] 31%|â–ˆâ–ˆâ–ˆ       | 169/552 [00:28<01:02,  6.13it/s] 31%|â–ˆâ–ˆâ–ˆ       | 170/552 [00:28<01:03,  6.05it/s] 31%|â–ˆâ–ˆâ–ˆ       | 171/552 [00:28<01:02,  6.07it/s] 31%|â–ˆâ–ˆâ–ˆ       | 172/552 [00:28<01:03,  5.95it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 173/552 [00:28<01:04,  5.88it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 174/552 [00:29<01:03,  5.92it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 175/552 [00:29<01:04,  5.88it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 176/552 [00:29<01:02,  6.03it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 177/552 [00:29<00:59,  6.27it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 178/552 [00:29<01:01,  6.09it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 179/552 [00:29<01:02,  5.98it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 180/552 [00:29<01:01,  6.04it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 181/552 [00:30<00:58,  6.30it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 182/552 [00:30<01:00,  6.12it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 183/552 [00:30<01:01,  5.99it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 184/552 [00:30<01:01,  5.97it/s]                                                  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 184/552 [00:30<01:01,  5.97it/s] 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 185/552 [00:30<00:59,  6.15it/s] 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 186/552 [00:30<01:00,  6.09it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 187/552 [00:31<00:56,  6.48it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 188/552 [00:31<00:58,  6.23it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 189/552 [00:31<00:59,  6.08it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 190/552 [00:31<00:59,  6.05it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 191/552 [00:31<01:00,  5.94it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 192/552 [00:31<01:00,  5.99it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 193/552 [00:32<01:00,  5.92it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 194/552 [00:32<01:01,  5.86it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 195/552 [00:32<01:01,  5.82it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 196/552 [00:32<01:01,  5.79it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 197/552 [00:32<00:59,  5.93it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 198/552 [00:32<00:56,  6.22it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 199/552 [00:33<00:56,  6.28it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 200/552 [00:33<00:53,  6.55it/s] 36%|â–ˆâ–ˆâ–ˆâ–‹      | 201/552 [00:33<00:52,  6.66it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 202/552 [00:33<00:52,  6.61it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 203/552 [00:33<00:54,  6.45it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 204/552 [00:33<00:54,  6.43it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 205/552 [00:34<00:55,  6.21it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 206/552 [00:34<00:56,  6.16it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 207/552 [00:34<00:57,  6.03it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 208/552 [00:34<00:58,  5.92it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 209/552 [00:34<00:58,  5.86it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 210/552 [00:34<00:58,  5.82it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 211/552 [00:35<00:58,  5.79it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 212/552 [00:35<00:58,  5.78it/s] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 213/552 [00:35<00:55,  6.09it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 214/552 [00:35<00:51,  6.55it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 215/552 [00:35<00:53,  6.28it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 216/552 [00:35<00:51,  6.50it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 217/552 [00:35<00:50,  6.60it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 218/552 [00:36<00:52,  6.31it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 219/552 [00:36<00:54,  6.14it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 220/552 [00:36<00:51,  6.44it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 221/552 [00:36<00:50,  6.59it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 222/552 [00:36<00:49,  6.70it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 223/552 [00:37<00:59,  5.48it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 224/552 [00:37<00:58,  5.60it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 225/552 [00:37<00:57,  5.65it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 226/552 [00:37<00:54,  5.96it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 227/552 [00:37<00:55,  5.89it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 228/552 [00:37<00:55,  5.85it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 229/552 [00:38<00:54,  5.91it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 230/552 [00:38<00:53,  6.01it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 231/552 [00:38<00:52,  6.09it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 232/552 [00:38<00:50,  6.33it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 233/552 [00:38<00:51,  6.17it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 234/552 [00:38<00:49,  6.42it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 235/552 [00:38<00:48,  6.54it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 236/552 [00:39<00:50,  6.27it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 237/552 [00:39<00:51,  6.16it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 238/552 [00:39<00:52,  6.02it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 239/552 [00:39<00:52,  5.94it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 240/552 [00:39<00:53,  5.85it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 241/552 [00:39<00:53,  5.82it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 242/552 [00:40<00:53,  5.80it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 243/552 [00:40<00:50,  6.15it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 244/552 [00:40<00:51,  6.02it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 245/552 [00:40<00:51,  5.94it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 246/552 [00:40<00:52,  5.88it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 247/552 [00:41<00:52,  5.82it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 248/552 [00:41<00:52,  5.80it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 249/552 [00:41<00:52,  5.77it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 250/552 [00:41<00:52,  5.78it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 251/552 [00:41<00:52,  5.78it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 252/552 [00:41<00:51,  5.77it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 253/552 [00:42<00:51,  5.76it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 254/552 [00:42<00:51,  5.76it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 255/552 [00:42<00:51,  5.77it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 256/552 [00:42<00:49,  5.92it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 257/552 [00:42<00:50,  5.86it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 258/552 [00:42<00:50,  5.84it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 259/552 [00:43<00:49,  5.92it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 260/552 [00:43<00:49,  5.87it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 261/552 [00:43<00:49,  5.84it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 262/552 [00:43<00:47,  6.12it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 263/552 [00:43<00:45,  6.36it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 264/552 [00:43<00:45,  6.35it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 265/552 [00:44<00:45,  6.37it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 266/552 [00:44<00:43,  6.55it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 267/552 [00:44<00:44,  6.35it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 268/552 [00:44<00:43,  6.50it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 269/552 [00:44<00:45,  6.25it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 270/552 [00:44<00:46,  6.09it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 271/552 [00:44<00:47,  5.97it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 272/552 [00:45<00:47,  5.90it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 273/552 [00:45<00:47,  5.85it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 274/552 [00:45<00:47,  5.82it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 275/552 [00:45<00:47,  5.79it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 276/552 [00:45<00:47,  5.84it/s]                                                  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 276/552 [00:45<00:47,  5.84it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 277/552 [00:46<00:47,  5.74it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 278/552 [00:46<00:47,  5.75it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 279/552 [00:46<00:47,  5.75it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 280/552 [00:46<00:47,  5.75it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 281/552 [00:46<00:47,  5.74it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 282/552 [00:46<00:46,  5.75it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 283/552 [00:47<00:46,  5.82it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 284/552 [00:47<00:46,  5.79it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 285/552 [00:47<00:46,  5.78it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 286/552 [00:47<00:43,  6.09it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 287/552 [00:47<00:42,  6.17it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 288/552 [00:47<00:42,  6.15it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 289/552 [00:48<00:43,  6.05it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 290/552 [00:48<00:40,  6.44it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 291/552 [00:48<00:42,  6.21it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 292/552 [00:48<00:42,  6.06it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 293/552 [00:48<00:43,  5.98it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 294/552 [00:48<00:41,  6.24it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 295/552 [00:49<00:41,  6.14it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 296/552 [00:49<00:42,  6.00it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 297/552 [00:49<00:43,  5.92it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 298/552 [00:49<00:43,  5.86it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 299/552 [00:49<00:42,  5.95it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 300/552 [00:49<00:41,  6.00it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 301/552 [00:50<00:39,  6.29it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 302/552 [00:50<00:40,  6.11it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 303/552 [00:50<00:41,  5.99it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 304/552 [00:50<00:41,  6.00it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 305/552 [00:50<00:40,  6.15it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 306/552 [00:50<00:40,  6.02it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 307/552 [00:51<00:41,  5.94it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 308/552 [00:51<00:39,  6.22it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 309/552 [00:51<00:38,  6.30it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 310/552 [00:51<00:38,  6.30it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 311/552 [00:51<00:39,  6.11it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 312/552 [00:51<00:40,  6.00it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 313/552 [00:51<00:38,  6.26it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 314/552 [00:52<00:38,  6.25it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 315/552 [00:52<00:38,  6.09it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 316/552 [00:52<00:38,  6.09it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 317/552 [00:52<00:39,  5.99it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 318/552 [00:52<00:37,  6.25it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 319/552 [00:52<00:38,  6.09it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 320/552 [00:53<00:38,  5.98it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 321/552 [00:53<00:39,  5.90it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 322/552 [00:53<00:39,  5.85it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 323/552 [00:53<00:39,  5.83it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 324/552 [00:53<00:38,  5.98it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 325/552 [00:53<00:36,  6.28it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 326/552 [00:54<00:37,  6.09it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 327/552 [00:54<00:37,  5.97it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 328/552 [00:54<00:37,  5.90it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 329/552 [00:54<00:38,  5.85it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 330/552 [00:54<00:38,  5.81it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 331/552 [00:55<00:38,  5.81it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 332/552 [00:55<00:38,  5.78it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 333/552 [00:55<00:38,  5.76it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 334/552 [00:55<00:37,  5.76it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 335/552 [00:55<00:35,  6.05it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 336/552 [00:55<00:36,  5.96it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 337/552 [00:56<00:36,  5.90it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 338/552 [00:56<00:35,  6.01it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 339/552 [00:56<00:35,  5.92it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 340/552 [00:56<00:36,  5.86it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 341/552 [00:56<00:35,  5.95it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 342/552 [00:56<00:34,  6.11it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 343/552 [00:57<00:34,  5.98it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 344/552 [00:57<00:35,  5.91it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 345/552 [00:57<00:34,  6.01it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 346/552 [00:57<00:34,  5.93it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 347/552 [00:57<00:34,  5.86it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 348/552 [00:57<00:33,  6.14it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 349/552 [00:58<00:33,  6.01it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 350/552 [00:58<00:34,  5.93it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 351/552 [00:58<00:34,  5.87it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 352/552 [00:58<00:34,  5.83it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 353/552 [00:58<00:34,  5.79it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 354/552 [00:58<00:34,  5.77it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 355/552 [00:59<00:34,  5.76it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 356/552 [00:59<00:32,  5.94it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 357/552 [00:59<00:33,  5.88it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 358/552 [00:59<00:32,  5.89it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 359/552 [00:59<00:32,  5.95it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 360/552 [00:59<00:32,  5.89it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 361/552 [01:00<00:32,  5.83it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 362/552 [01:00<00:32,  5.79it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 363/552 [01:00<00:32,  5.77it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 364/552 [01:00<00:32,  5.75it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 365/552 [01:00<00:32,  5.75it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 366/552 [01:00<00:32,  5.74it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 367/552 [01:01<00:32,  5.73it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 368/552 [01:01<00:31,  5.84it/s]                                                  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 368/552 [01:01<00:31,  5.84it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 369/552 [01:01<00:31,  5.73it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 370/552 [01:01<00:31,  5.73it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 371/552 [01:01<00:31,  5.73it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 372/552 [01:02<00:31,  5.73it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 373/552 [01:02<00:30,  5.79it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 374/552 [01:02<00:29,  5.99it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 375/552 [01:02<00:29,  5.90it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 376/552 [01:02<00:30,  5.83it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 377/552 [01:02<00:30,  5.78it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 378/552 [01:03<00:30,  5.77it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 379/552 [01:03<00:29,  5.95it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 380/552 [01:03<00:28,  5.98it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 381/552 [01:03<00:27,  6.27it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 382/552 [01:03<00:26,  6.50it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 383/552 [01:03<00:27,  6.24it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 384/552 [01:03<00:26,  6.26it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 385/552 [01:04<00:25,  6.44it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 386/552 [01:04<00:25,  6.59it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 387/552 [01:04<00:25,  6.51it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 388/552 [01:04<00:25,  6.35it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 389/552 [01:04<00:26,  6.16it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 390/552 [01:04<00:25,  6.26it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 391/552 [01:05<00:24,  6.44it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 392/552 [01:05<00:25,  6.20it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 393/552 [01:05<00:26,  6.04it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 394/552 [01:05<00:26,  5.93it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 395/552 [01:05<00:26,  5.87it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 396/552 [01:05<00:26,  5.90it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 397/552 [01:06<00:26,  5.87it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 398/552 [01:06<00:24,  6.23it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 399/552 [01:06<00:24,  6.24it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 400/552 [01:06<00:24,  6.08it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 401/552 [01:06<00:25,  5.98it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 402/552 [01:06<00:23,  6.27it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 403/552 [01:07<00:24,  6.19it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 404/552 [01:07<00:23,  6.41it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 405/552 [01:07<00:23,  6.20it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 406/552 [01:07<00:23,  6.16it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 407/552 [01:07<00:23,  6.13it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 408/552 [01:07<00:23,  6.01it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 409/552 [01:08<00:24,  5.92it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 410/552 [01:08<00:24,  5.87it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 411/552 [01:08<00:23,  6.00it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 412/552 [01:08<00:21,  6.42it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 413/552 [01:08<00:22,  6.20it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 414/552 [01:08<00:22,  6.07it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 415/552 [01:09<00:22,  6.05it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 416/552 [01:09<00:22,  5.95it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 417/552 [01:09<00:22,  5.89it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 418/552 [01:09<00:22,  5.84it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 419/552 [01:09<00:22,  5.82it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 420/552 [01:09<00:22,  5.81it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 421/552 [01:10<00:22,  5.79it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 422/552 [01:10<00:22,  5.79it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 423/552 [01:10<00:20,  6.26it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 424/552 [01:10<00:20,  6.10it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 425/552 [01:10<00:20,  6.09it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 426/552 [01:10<00:21,  5.98it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 427/552 [01:11<00:21,  5.90it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 428/552 [01:11<00:21,  5.87it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 429/552 [01:11<00:20,  5.88it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 430/552 [01:11<00:20,  5.85it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 431/552 [01:11<00:19,  6.12it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 432/552 [01:11<00:19,  6.01it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 433/552 [01:12<00:19,  6.15it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 434/552 [01:12<00:19,  6.03it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 435/552 [01:12<00:19,  5.94it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 436/552 [01:12<00:19,  5.87it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 437/552 [01:12<00:19,  5.83it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 438/552 [01:12<00:19,  5.87it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 439/552 [01:13<00:19,  5.83it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 440/552 [01:13<00:19,  5.80it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 441/552 [01:13<00:18,  5.87it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 442/552 [01:13<00:18,  5.82it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 443/552 [01:13<00:18,  5.81it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 444/552 [01:13<00:18,  5.92it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 445/552 [01:14<00:17,  6.16it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 446/552 [01:14<00:17,  6.03it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 447/552 [01:14<00:17,  5.93it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 448/552 [01:14<00:17,  5.86it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 449/552 [01:14<00:17,  5.82it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 450/552 [01:14<00:17,  5.81it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 451/552 [01:15<00:16,  6.10it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 452/552 [01:15<00:15,  6.34it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 453/552 [01:15<00:16,  6.14it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 454/552 [01:15<00:16,  6.01it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 455/552 [01:15<00:16,  5.93it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 456/552 [01:15<00:16,  5.94it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 457/552 [01:16<00:16,  5.89it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 458/552 [01:16<00:15,  6.03it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 459/552 [01:16<00:15,  6.06it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 460/552 [01:16<00:15,  6.02it/s]                                                  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 460/552 [01:16<00:15,  6.02it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 461/552 [01:16<00:15,  5.90it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 462/552 [01:16<00:15,  5.85it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 463/552 [01:17<00:14,  5.99it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 464/552 [01:17<00:14,  5.99it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 465/552 [01:17<00:14,  5.91it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 466/552 [01:17<00:14,  5.91it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 467/552 [01:17<00:13,  6.19it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 468/552 [01:17<00:13,  6.04it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 469/552 [01:18<00:13,  5.94it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 470/552 [01:18<00:13,  5.87it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 471/552 [01:18<00:13,  6.05it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 472/552 [01:18<00:12,  6.30it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 473/552 [01:18<00:12,  6.31it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 474/552 [01:18<00:12,  6.14it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 475/552 [01:19<00:12,  6.01it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 476/552 [01:19<00:12,  5.92it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 477/552 [01:19<00:12,  5.88it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 478/552 [01:19<00:12,  6.15it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 479/552 [01:19<00:12,  6.03it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 480/552 [01:19<00:11,  6.27it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 481/552 [01:20<00:11,  6.23it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 482/552 [01:20<00:11,  6.07it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 483/552 [01:20<00:11,  6.03it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 484/552 [01:20<00:11,  5.93it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 485/552 [01:20<00:11,  5.93it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 486/552 [01:20<00:11,  5.87it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 487/552 [01:21<00:11,  5.84it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 488/552 [01:21<00:11,  5.81it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 489/552 [01:21<00:10,  5.79it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 490/552 [01:21<00:10,  5.87it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 491/552 [01:21<00:10,  5.83it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 492/552 [01:21<00:10,  5.81it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 493/552 [01:22<00:10,  5.79it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 494/552 [01:22<00:09,  5.92it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 495/552 [01:22<00:09,  5.95it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 496/552 [01:22<00:09,  5.88it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 497/552 [01:22<00:09,  6.00it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 498/552 [01:22<00:09,  5.92it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 499/552 [01:23<00:09,  5.87it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 500/552 [01:23<00:08,  5.83it/s]{'loss': 1.4316, 'grad_norm': 22.423757553100586, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}
{'loss': 1.041, 'grad_norm': 56.885963439941406, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0}
{'loss': 0.8176, 'grad_norm': 43.04924392700195, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0}
{'loss': 0.6984, 'grad_norm': 10.028144836425781, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0}
{'loss': 0.6311, 'grad_norm': 14.433449745178223, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0}

  0%|          | 0/10 [00:00<?, ?it/s][A
 30%|â–ˆâ–ˆâ–ˆ       | 3/10 [00:00<00:00, 25.76it/s][A
 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 6/10 [00:00<00:00, 19.79it/s][A
 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 9/10 [00:00<00:00, 18.48it/s][A2025-06-19 09:02:04,534 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png

                                              [A                                                 
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:03<00:00, 18.48it/s][A 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 500/552 [01:26<00:08,  5.83it/s]
                                               [A 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 501/552 [01:28<01:29,  1.76s/it] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 502/552 [01:28<01:04,  1.29s/it] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 503/552 [01:29<00:46,  1.05it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 504/552 [01:29<00:34,  1.39it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 505/552 [01:29<00:26,  1.80it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 506/552 [01:29<00:20,  2.27it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 507/552 [01:29<00:16,  2.81it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 508/552 [01:29<00:12,  3.42it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 509/552 [01:30<00:11,  3.91it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 510/552 [01:30<00:09,  4.44it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 511/552 [01:30<00:08,  4.90it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 512/552 [01:30<00:07,  5.12it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 513/552 [01:30<00:07,  5.30it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 514/552 [01:30<00:06,  5.45it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 515/552 [01:31<00:06,  5.82it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 516/552 [01:31<00:06,  5.79it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 517/552 [01:31<00:06,  5.82it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 518/552 [01:31<00:05,  5.78it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 519/552 [01:31<00:05,  5.77it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 520/552 [01:31<00:05,  5.93it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 521/552 [01:32<00:05,  5.87it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 522/552 [01:32<00:05,  5.83it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 523/552 [01:32<00:05,  5.79it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 524/552 [01:32<00:04,  5.78it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 525/552 [01:32<00:04,  5.78it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 526/552 [01:32<00:04,  5.95it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 527/552 [01:33<00:04,  5.89it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 528/552 [01:33<00:04,  5.84it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 529/552 [01:33<00:03,  5.81it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 530/552 [01:33<00:03,  5.78it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 531/552 [01:33<00:03,  5.97it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 532/552 [01:33<00:03,  5.91it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 533/552 [01:34<00:03,  6.17it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 534/552 [01:34<00:02,  6.03it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 535/552 [01:34<00:02,  5.93it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 536/552 [01:34<00:02,  6.18it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 537/552 [01:34<00:02,  6.06it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 538/552 [01:34<00:02,  6.10it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 539/552 [01:35<00:02,  6.08it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 540/552 [01:35<00:02,  5.98it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 541/552 [01:35<00:01,  5.90it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 542/552 [01:35<00:01,  5.85it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 543/552 [01:35<00:01,  6.12it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 544/552 [01:35<00:01,  6.00it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 545/552 [01:36<00:01,  6.24it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 546/552 [01:36<00:00,  6.09it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 547/552 [01:36<00:00,  6.22it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 548/552 [01:36<00:00,  6.07it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 549/552 [01:36<00:00,  5.95it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 550/552 [01:36<00:00,  5.87it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 551/552 [01:37<00:00,  5.83it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 552/552 [01:37<00:00,  5.86it/s]                                                 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 552/552 [01:39<00:00,  5.86it/s]                                                 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 552/552 [01:39<00:00,  5.86it/s]2025-06-19 09:02:17,480 - INFO - Early stopping triggered. Best model checkpoint saved at: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/models/checkpoint-500
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 552/552 [01:39<00:00,  5.54it/s]
{'eval_loss': 1.4436591863632202, 'eval_f1': 0.8421052631578947, 'eval_accuracy': 0.7375, 'eval_kappa': 0.11949685534591203, 'eval_precision': 0.7567567567567568, 'eval_recall': 0.9491525423728814, 'eval_optim_threshold': 0.8793545365333557, 'eval_AP': 0.8710483143685863, 'eval_MCC': 0.1537013609890006, 'eval_NDCG': 0.968640410415716, 'eval_runtime': 3.4537, 'eval_samples_per_second': 23.163, 'eval_steps_per_second': 2.895, 'epoch': 5.43}
{'loss': 0.6005, 'grad_norm': 10.948038101196289, 'learning_rate': 0.0, 'epoch': 6.0}
{'train_runtime': 99.5092, 'train_samples_per_second': 44.378, 'train_steps_per_second': 5.547, 'train_loss': 0.8700334853020267, 'epoch': 6.0}
  0%|          | 0/10 [00:00<?, ?it/s] 30%|â–ˆâ–ˆâ–ˆ       | 3/10 [00:00<00:00, 25.96it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 6/10 [00:00<00:00, 19.94it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 9/10 [00:00<00:00, 18.55it/s]2025-06-19 09:02:20,882 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:03<00:00,  3.00it/s]
2025-06-19 09:02:20,888 - INFO - Training time : 104.18766962096561
  0%|          | 0/10 [00:00<?, ?it/s] 30%|â–ˆâ–ˆâ–ˆ       | 3/10 [00:00<00:00, 25.76it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 6/10 [00:00<00:00, 19.97it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 9/10 [00:00<00:00, 18.60it/s]2025-06-19 09:02:24,245 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:03<00:00,  3.04it/s]
2025-06-19 09:02:24,250 - INFO - Evaluation time : 3.3618132050614804
2025-06-19 09:02:24,250 - INFO - Evaluation results on test set: {'eval_loss': 1.1926705837249756, 'eval_f1': 0.8592592592592593, 'eval_accuracy': 0.7625, 'eval_kappa': 0.17030567685589515, 'eval_precision': 0.7631578947368421, 'eval_recall': 0.9830508474576272, 'eval_optim_threshold': 0.8199763298034668, 'eval_AP': 0.8980501744056228, 'eval_MCC': 0.25418630812943893, 'eval_NDCG': 0.978153447486877, 'eval_runtime': 3.3578, 'eval_samples_per_second': 23.825, 'eval_steps_per_second': 2.978, 'epoch': 6.0}
2025-06-19 09:02:24,250 - INFO - Total updates (optimizer steps): 552
2025-06-19 09:02:24,250 - INFO - Avg time / step: 0.180s
2025-06-19 09:02:24,965 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCEmicrosoft/BiomedNLP-BiomedBERT-base-uncased-abstract3trials_fold-2
2025-06-19 09:02:24,966 - INFO - On test Set (with threshold 0.5) : 
  0%|          | 0/10 [00:00<?, ?it/s] 30%|â–ˆâ–ˆâ–ˆ       | 3/10 [00:00<00:00, 25.78it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 6/10 [00:00<00:00, 19.91it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 9/10 [00:00<00:00, 18.51it/s]2025-06-19 09:02:28,691 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:03<00:00,  2.73it/s]
2025-06-19 09:02:28,695 - INFO - Raw predictions shape: (80, 1)
2025-06-19 09:02:28,695 - INFO - Raw predictions: [[1.9565933 ]
 [2.461622  ]
 [1.9211445 ]
 [2.4560292 ]
 [0.9344909 ]
 [2.1910837 ]
 [2.6069963 ]
 [1.8438547 ]
 [2.4071581 ]
 [0.09633031]]
2025-06-19 09:02:28,695 - INFO - Scores shape: (80,)
2025-06-19 09:02:28,696 - INFO - Scores: [0.87616384 0.92140716 0.872266   0.9210012  0.7179855  0.89944595
 0.9313105  0.8634039  0.9173716  0.52406394]
2025-06-19 09:02:28,696 - INFO - Preds shape: (80,)
2025-06-19 09:02:28,696 - INFO - Preds: [1 1 1 1 1 1 1 1 1 1]
2025-06-19 09:02:28,696 - INFO - Test labels shape: (80,)
2025-06-19 09:02:28,697 - INFO - Test labels: [1, 1, 1, 1, 1, 1, 1, 0, 1, 0]
2025-06-19 09:02:28,697 - INFO - Test split: Dataset({
    features: ['title', 'abstract', 'Keywords', 'doi', 'labels'],
    num_rows: 80
})
2025-06-19 09:02:28,697 - INFO - Unique values in predictions: [0 1]
2025-06-19 09:02:28,698 - INFO - Unique values in labels: [0 1]
2025-06-19 09:02:28,699 - INFO - Confusion matrix:
[[ 3 18]
 [ 1 58]]
2025-06-19 09:02:28,700 - INFO - Confusion matrix: TN=3, FP=18, FN=1, TP=58
2025-06-19 09:02:33,128 - INFO - Metrics: {'f1': 0.8592592592592593, 'recall': 0.9830508474576272, 'precision': 0.7631578947368421, 'accuracy': 0.7625, 'AP': 0.8980501744056228, 'MCC': 0.25418630812943893, 'NDCG': 0.978153447486877, 'kappa': 0.17030567685589515, 'TN': 3, 'FP': 18, 'FN': 1, 'TP': 58}
2025-06-19 09:02:33,131 - INFO - Metrics stored successfully at /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/metrics/binary_metrics.csv
2025-06-19 09:02:33,252 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-19 09:02:33,354 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-19 09:02:33,354 - INFO - 
On test Set (optimal threshold of 0.8793545365333557 according to cross validation on the training set): 
2025-06-19 09:02:33,356 - INFO - Confusion matrix: TN=15, FP=6, FN=30, TP=29
2025-06-19 09:02:37,253 - INFO - Metrics: {'f1': 0.6170212765957447, 'recall': 0.4915254237288136, 'precision': 0.8285714285714286, 'accuracy': 0.55, 'AP': 0.8980501744056228, 'MCC': 0.182542606800687, 'NDCG': 0.978153447486877, 'kappa': 0.1504424778761062, 'TN': 15, 'FP': 6, 'FN': 30, 'TP': 29}
2025-06-19 09:02:37,355 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-19 09:02:37,355 - INFO - Results for fold 2 : [{'f1': 0.6170212765957447, 'recall': 0.4915254237288136, 'precision': 0.8285714285714286, 'accuracy': 0.55, 'AP': 0.8980501744056228, 'MCC': 0.182542606800687, 'NDCG': 0.978153447486877, 'kappa': 0.1504424778761062, 'TN': 15, 'FP': 6, 'FN': 30, 'TP': 29}]
2025-06-19 09:02:37,674 - INFO - Cleared CUDA cache. Memory allocated: 1.38 GB, Memory reserved: 1.57 GB
2025-06-19 09:02:37,953 - INFO - Cleared CUDA cache. Memory allocated: 1.38 GB, Memory reserved: 1.57 GB
2025-06-19 09:02:37,954 - INFO - 
fold number 3 / 5
2025-06-19 09:02:37,960 - INFO - train split size : 737
2025-06-19 09:02:37,960 - INFO - dev split size : 80
2025-06-19 09:02:37,960 - INFO - test split size : 79
Map (num_proc=32):   0%|          | 0/737 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 24/737 [00:00<00:19, 37.22 examples/s]Map (num_proc=32):  16%|â–ˆâ–Œ        | 116/737 [00:00<00:03, 194.90 examples/s]Map (num_proc=32):  34%|â–ˆâ–ˆâ–ˆâ–      | 254/737 [00:00<00:01, 414.97 examples/s]Map (num_proc=32):  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 438/737 [00:00<00:00, 699.90 examples/s]Map (num_proc=32):  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 553/737 [00:01<00:00, 686.79 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 668/737 [00:01<00:00, 731.30 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 737/737 [00:01<00:00, 484.40 examples/s]
Map (num_proc=32):   0%|          | 0/80 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/80 [00:00<00:10,  7.28 examples/s]Map (num_proc=32):  19%|â–ˆâ–‰        | 15/80 [00:00<00:01, 36.17 examples/s]Map (num_proc=32):  38%|â–ˆâ–ˆâ–ˆâ–Š      | 30/80 [00:00<00:00, 62.78 examples/s]Map (num_proc=32):  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 45/80 [00:00<00:00, 83.61 examples/s]Map (num_proc=32):  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 58/80 [00:00<00:00, 87.46 examples/s]Map (num_proc=32):  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 70/80 [00:01<00:00, 83.97 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 80/80 [00:01<00:00, 80.12 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 80/80 [00:01<00:00, 60.94 examples/s]
Map (num_proc=32):   0%|          | 0/79 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/79 [00:00<00:10,  7.28 examples/s]Map (num_proc=32):  19%|â–ˆâ–‰        | 15/79 [00:00<00:01, 35.91 examples/s]Map (num_proc=32):  34%|â–ˆâ–ˆâ–ˆâ–      | 27/79 [00:00<00:00, 55.34 examples/s]Map (num_proc=32):  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 44/79 [00:00<00:00, 77.84 examples/s]Map (num_proc=32):  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 57/79 [00:00<00:00, 85.85 examples/s]Map (num_proc=32):  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 69/79 [00:01<00:00, 83.89 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 79/79 [00:01<00:00, 61.71 examples/s]
2025-06-19 09:02:50,753 - INFO - 3 datasets tokenized successfully
2025-06-19 09:02:50,900 - INFO - Fold 3 max seq len = 512
2025-06-19 09:02:50,900 - INFO - Starting hyperparameter search for BCE loss
[36m(train_hpo pid=2466417)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=2466417)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=2466417)[0m 2025-06-19 09:02:58,157 - INFO - pos_weight value in TrainingArguments : 6.828424226204718
[36m(train_hpo pid=2466417)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=2466417)[0m   super().__init__(*args, **kwargs)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-19_09-02-50   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-19_09-02-50
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-19_08-53-05_394440_2452736/artifacts/2025-06-19_09-02-50/train_hpo_2025-06-19_09-02-50/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-19 09:02:51. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/1 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_7ec5cc09   PENDING         6.82842       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_7ec5cc09 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_7ec5cc09 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          6.82842 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=2466417)[0m [2025-06-19 09:02:58,388] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=2466417)[0m [2025-06-19 09:03:01,098] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(train_hpo pid=2466417)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=222, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=2466417)[0m {'loss': 1.4638, 'grad_norm': 14.546878814697266, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}

Trial status: 1 RUNNING | 1 PENDING
Current time: 2025-06-19 09:03:21. Total running time: 30s
Logical resource usage: 10.0/32 CPUs, 1.0/1 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_7ec5cc09   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_e3787b12   PENDING         6.09408       4.55539e-06         0.123031                    5 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=2466417)[0m {'loss': 1.3133, 'grad_norm': 20.789691925048828, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0}
[36m(train_hpo pid=2466417)[0m {'loss': 1.1868, 'grad_norm': 14.79028606414795, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0}
Trial status: 1 RUNNING | 1 PENDING
Current time: 2025-06-19 09:03:51. Total running time: 1min 0s
Logical resource usage: 10.0/32 CPUs, 1.0/1 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_7ec5cc09   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_e3787b12   PENDING         6.09408       4.55539e-06         0.123031                    5 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=2466417)[0m {'loss': 1.08, 'grad_norm': 14.715163230895996, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0}
[36m(train_hpo pid=2466417)[0m {'loss': 1.0151, 'grad_norm': 13.695906639099121, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0}
Trial status: 1 RUNNING | 1 PENDING
Current time: 2025-06-19 09:04:21. Total running time: 1min 30s
Logical resource usage: 10.0/32 CPUs, 1.0/1 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_7ec5cc09   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_e3787b12   PENDING         6.09408       4.55539e-06         0.123031                    5 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(train_hpo pid=2466417)[0m 2025-06-19 09:04:31,302 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=2466417)[0m 2025-06-19 09:04:31,308 - INFO - eval_result: {'eval_loss': 1.8293159008026123, 'eval_f1': 0.8382352941176471, 'eval_accuracy': 0.725, 'eval_kappa': 0.018952062430323213, 'eval_precision': 0.7402597402597403, 'eval_recall': 0.9661016949152542, 'eval_optim_threshold': 0.7871100306510925, 'eval_AP': 0.8245070630198038, 'eval_MCC': 0.031776589103906225, 'eval_NDCG': 0.955690054646602, 'eval_runtime': 3.3472, 'eval_samples_per_second': 23.901, 'eval_steps_per_second': 1.195, 'epoch': 6.0}
2025-06-19 09:04:31,639 - INFO - Cleaning up trial 7ec5cc09
2025-06-19 09:04:31,639 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-19_09-02-50/train_hpo_7ec5cc09_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-19_09-02-50
[36m(train_hpo pid=2466417)[0m 2025-06-19 09:04:31,614 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=2468071)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=2468071)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=2468071)[0m 2025-06-19 09:04:39,573 - INFO - pos_weight value in TrainingArguments : 6.094080202241274
[36m(train_hpo pid=2468071)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=2468071)[0m   super().__init__(*args, **kwargs)

[36m(train_hpo pid=2466417)[0m {'loss': 0.9775, 'grad_norm': 12.942985534667969, 'learning_rate': 0.0, 'epoch': 6.0}
[36m(train_hpo pid=2466417)[0m {'train_runtime': 86.5334, 'train_samples_per_second': 51.102, 'train_steps_per_second': 2.565, 'train_loss': 1.1727447853432045, 'epoch': 6.0}
[36m(train_hpo pid=2466417)[0m STATE at ending of training  :  TrainerState(epoch=6.0, global_step=222, max_steps=222, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=1161441936796584.0, log_history=[{'loss': 1.4638, 'grad_norm': 14.546878814697266, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0, 'step': 37}, {'loss': 1.3133, 'grad_norm': 20.789691925048828, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0, 'step': 74}, {'loss': 1.1868, 'grad_norm': 14.79028606414795, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0, 'step': 111}, {'loss': 1.08, 'grad_norm': 14.715163230895996, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0, 'step': 148}, {'loss': 1.0151, 'grad_norm': 13.695906639099121, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0, 'step': 185}, {'loss': 0.9775, 'grad_norm': 12.942985534667969, 'learning_rate': 0.0, 'epoch': 6.0, 'step': 222}, {'train_runtime': 86.5334, 'train_samples_per_second': 51.102, 'train_steps_per_second': 2.565, 'total_flos': 1161441936796584.0, 'train_loss': 1.1727447853432045, 'epoch': 6.0, 'step': 222}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=2466417)[0m {'eval_loss': 1.8293159008026123, 'eval_f1': 0.8382352941176471, 'eval_accuracy': 0.725, 'eval_kappa': 0.018952062430323213, 'eval_precision': 0.7402597402597403, 'eval_recall': 0.9661016949152542, 'eval_optim_threshold': 0.7871100306510925, 'eval_AP': 0.8245070630198038, 'eval_MCC': 0.031776589103906225, 'eval_NDCG': 0.955690054646602, 'eval_runtime': 3.3472, 'eval_samples_per_second': 23.901, 'eval_steps_per_second': 1.195, 'epoch': 6.0}

Trial train_hpo_7ec5cc09 finished iteration 1 at 2025-06-19 09:04:31. Total running time: 1min 40s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_7ec5cc09 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    94.2731 â”‚
â”‚ time_total_s                        94.2731 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     6 â”‚
â”‚ eval_AP                             0.82451 â”‚
â”‚ eval_MCC                            0.03178 â”‚
â”‚ eval_NDCG                           0.95569 â”‚
â”‚ eval_accuracy                         0.725 â”‚
â”‚ eval_f1                             0.83824 â”‚
â”‚ eval_kappa                          0.01895 â”‚
â”‚ eval_loss                           1.82932 â”‚
â”‚ eval_optim_threshold                0.78711 â”‚
â”‚ eval_precision                      0.74026 â”‚
â”‚ eval_recall                          0.9661 â”‚
â”‚ eval_runtime                         3.3472 â”‚
â”‚ eval_samples_per_second              23.901 â”‚
â”‚ eval_steps_per_second                 1.195 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_7ec5cc09 completed after 1 iterations at 2025-06-19 09:04:31. Total running time: 1min 40s

Trial train_hpo_e3787b12 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_e3787b12 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          6.09408 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=2468071)[0m [2025-06-19 09:04:39,790] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=2468071)[0m [2025-06-19 09:04:42,454] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(train_hpo pid=2468071)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=185, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 1 TERMINATED | 1 RUNNING | 1 PENDING
Current time: 2025-06-19 09:04:51. Total running time: 2min 0s
Logical resource usage: 10.0/32 CPUs, 1.0/1 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_e3787b12   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ train_hpo_7ec5cc09   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1            94.2731       1.82932    0.838235             0.725      0.0189521 â”‚
â”‚ train_hpo_5b5580b3   PENDING           7.18321       7.98818e-05         0.251217                    3                                                                                        â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(train_hpo pid=2468071)[0m 2025-06-19 09:05:58,626 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=2468071)[0m 2025-06-19 09:05:58,631 - INFO - eval_result: {'eval_loss': 1.2105433940887451, 'eval_f1': 0.8467153284671532, 'eval_accuracy': 0.7375, 'eval_kappa': 0.04328018223234642, 'eval_precision': 0.7435897435897436, 'eval_recall': 0.9830508474576272, 'eval_optim_threshold': 0.9185706973075867, 'eval_AP': 0.8525368407161189, 'eval_MCC': 0.08643420548400696, 'eval_NDCG': 0.966113726735116, 'eval_runtime': 3.3472, 'eval_samples_per_second': 23.9, 'eval_steps_per_second': 1.195, 'epoch': 5.0}

[36m(train_hpo pid=2468071)[0m {'loss': 1.3095, 'grad_norm': 12.432028770446777, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0}
[36m(train_hpo pid=2468071)[0m {'loss': 0.8378, 'grad_norm': 14.302763938903809, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0}
Trial status: 1 TERMINATED | 1 RUNNING | 1 PENDING
Current time: 2025-06-19 09:05:21. Total running time: 2min 30s
Logical resource usage: 10.0/32 CPUs, 1.0/1 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_e3787b12   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ train_hpo_7ec5cc09   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1            94.2731       1.82932    0.838235             0.725      0.0189521 â”‚
â”‚ train_hpo_5b5580b3   PENDING           7.18321       7.98818e-05         0.251217                    3                                                                                        â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=2468071)[0m {'loss': 0.5997, 'grad_norm': 7.97756290435791, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0}
[36m(train_hpo pid=2468071)[0m {'loss': 0.4992, 'grad_norm': 8.817976951599121, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0}
Trial status: 1 TERMINATED | 1 RUNNING | 1 PENDING
Current time: 2025-06-19 09:05:51. Total running time: 3min 0s
Logical resource usage: 10.0/32 CPUs, 1.0/1 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_e3787b12   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ train_hpo_7ec5cc09   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1            94.2731       1.82932    0.838235             0.725      0.0189521 â”‚
â”‚ train_hpo_5b5580b3   PENDING           7.18321       7.98818e-05         0.251217                    3                                                                                        â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=2468071)[0m {'loss': 0.4574, 'grad_norm': 6.362757682800293, 'learning_rate': 0.0, 'epoch': 5.0}
[36m(train_hpo pid=2468071)[0m {'train_runtime': 72.5146, 'train_samples_per_second': 50.817, 'train_steps_per_second': 2.551, 'train_loss': 0.7407113771180849, 'epoch': 5.0}
[36m(train_hpo pid=2468071)[0m STATE at ending of training  :  TrainerState(epoch=5.0, global_step=185, max_steps=185, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=968106380327400.0, log_history=[{'loss': 1.3095, 'grad_norm': 12.432028770446777, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0, 'step': 37}, {'loss': 0.8378, 'grad_norm': 14.302763938903809, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0, 'step': 74}, {'loss': 0.5997, 'grad_norm': 7.97756290435791, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0, 'step': 111}, {'loss': 0.4992, 'grad_norm': 8.817976951599121, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0, 'step': 148}, {'loss': 0.4574, 'grad_norm': 6.362757682800293, 'learning_rate': 0.0, 'epoch': 5.0, 'step': 185}, {'train_runtime': 72.5146, 'train_samples_per_second': 50.817, 'train_steps_per_second': 2.551, 'total_flos': 968106380327400.0, 'train_loss': 0.7407113771180849, 'epoch': 5.0, 'step': 185}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=2468071)[0m {'eval_loss': 1.2105433940887451, 'eval_f1': 0.8467153284671532, 'eval_accuracy': 0.7375, 'eval_kappa': 0.04328018223234642, 'eval_precision': 0.7435897435897436, 'eval_recall': 0.9830508474576272, 'eval_optim_threshold': 0.9185706973075867, 'eval_AP': 0.8525368407161189, 'eval_MCC': 0.08643420548400696, 'eval_NDCG': 0.966113726735116, 'eval_runtime': 3.3472, 'eval_samples_per_second': 23.9, 'eval_steps_per_second': 1.195, 'epoch': 5.0}

Trial train_hpo_e3787b12 finished iteration 1 at 2025-06-19 09:05:58. Total running time: 3min 7s2025-06-19 09:05:58,953 - INFO - Cleaning up trial e3787b12
2025-06-19 09:05:58,953 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-19_09-02-50/train_hpo_e3787b12_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-19_09-02-57
2025-06-19 09:05:58,953 - INFO - Cleaning up trial 7ec5cc09
2025-06-19 09:05:58,953 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-19_09-02-50/train_hpo_7ec5cc09_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-19_09-02-50
[36m(train_hpo pid=2468071)[0m 2025-06-19 09:05:58,931 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=2469573)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=2469573)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=2469573)[0m 2025-06-19 09:06:06,662 - INFO - pos_weight value in TrainingArguments : 7.183206941666034
[36m(train_hpo pid=2469573)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=2469573)[0m   super().__init__(*args, **kwargs)

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_e3787b12 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    80.1736 â”‚
â”‚ time_total_s                        80.1736 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     5 â”‚
â”‚ eval_AP                             0.85254 â”‚
â”‚ eval_MCC                            0.08643 â”‚
â”‚ eval_NDCG                           0.96611 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84672 â”‚
â”‚ eval_kappa                          0.04328 â”‚
â”‚ eval_loss                           1.21054 â”‚
â”‚ eval_optim_threshold                0.91857 â”‚
â”‚ eval_precision                      0.74359 â”‚
â”‚ eval_recall                         0.98305 â”‚
â”‚ eval_runtime                         3.3472 â”‚
â”‚ eval_samples_per_second                23.9 â”‚
â”‚ eval_steps_per_second                 1.195 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_e3787b12 completed after 1 iterations at 2025-06-19 09:05:58. Total running time: 3min 7s

Trial train_hpo_5b5580b3 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_5b5580b3 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          7.18321 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=2469573)[0m [2025-06-19 09:06:06,888] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=2469573)[0m [2025-06-19 09:06:09,605] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(train_hpo pid=2469573)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=111, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 2 TERMINATED | 1 RUNNING
Current time: 2025-06-19 09:06:21. Total running time: 3min 30s
Logical resource usage: 10.0/32 CPUs, 1.0/1 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_5b5580b3   RUNNING           7.18321       7.98818e-05         0.251217                    3                                                                                        â”‚
â”‚ train_hpo_7ec5cc09   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1            94.2731       1.82932    0.838235            0.725       0.0189521 â”‚
â”‚ train_hpo_e3787b12   TERMINATED        6.09408       4.55539e-06         0.123031                    5        1            80.1736       1.21054    0.846715            0.7375      0.0432802 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=2469573)[0m {'loss': 0.6612, 'grad_norm': 15.471101760864258, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
[36m(train_hpo pid=2469573)[0m {'loss': 0.5216, 'grad_norm': 78.53952026367188, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
Trial status: 2 TERMINATED | 1 RUNNING
Current time: 2025-06-19 09:06:51. Total running time: 4min 0s
Logical resource usage: 10.0/32 CPUs, 1.0/1 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_5b5580b3   RUNNING           7.18321       7.98818e-05         0.251217                    3                                                                                        â”‚
â”‚ train_hpo_7ec5cc09   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1            94.2731       1.82932    0.838235            0.725       0.0189521 â”‚
â”‚ train_hpo_e3787b12   TERMINATED        6.09408       4.55539e-06         0.123031                    5        1            80.1736       1.21054    0.846715            0.7375      0.0432802 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(train_hpo pid=2469573)[0m 2025-06-19 09:06:57,057 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=2469573)[0m 2025-06-19 09:06:57,063 - INFO - eval_result: {'eval_loss': 4.390303611755371, 'eval_f1': 0.8403361344537815, 'eval_accuracy': 0.7625, 'eval_kappa': 0.3770491803278688, 'eval_precision': 0.8333333333333334, 'eval_recall': 0.847457627118644, 'eval_optim_threshold': 0.9898310303688049, 'eval_AP': 0.9145851322146804, 'eval_MCC': 0.3772520040005942, 'eval_NDCG': 0.9823627596249604, 'eval_runtime': 3.5122, 'eval_samples_per_second': 22.777, 'eval_steps_per_second': 1.139, 'epoch': 3.0}
2025-06-19 09:06:57,396 - INFO - Cleaning up trial 5b5580b3
2025-06-19 09:06:57,396 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-19_09-02-50/train_hpo_5b5580b3_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512_2025-06-19_09-04-38
2025-06-19 09:06:57,396 - INFO - Cleaning up trial 7ec5cc09
2025-06-19 09:06:57,396 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-19_09-02-50/train_hpo_7ec5cc09_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-19_09-02-50
2025-06-19 09:06:57,397 - INFO - Current best: e3787b12 with eval_f1 : 0.8467153284671532 at iteration 1
2025-06-19 09:06:57,403	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-19_09-02-50' in 0.0049s.
2025-06-19 09:06:57,410 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x7db08052c210>
2025-06-19 09:06:57,410 - INFO - Best trial : train_hpo_e3787b12
2025-06-19 09:06:57,410 - INFO - Best config : {'pos_weight': 6.094080202241274, 'learning_rate': 4.555391530860597e-06, 'weight_decay': 0.12303118765599412, 'num_train_epochs': 5}
2025-06-19 09:06:57,410 - INFO - Best trial after optimization: {'eval_loss': 1.2105433940887451, 'eval_f1': 0.8467153284671532, 'eval_accuracy': 0.7375, 'eval_kappa': 0.04328018223234642, 'eval_precision': 0.7435897435897436, 'eval_recall': 0.9830508474576272, 'eval_optim_threshold': 0.9185706973075867, 'eval_AP': 0.8525368407161189, 'eval_MCC': 0.08643420548400696, 'eval_NDCG': 0.966113726735116, 'eval_runtime': 3.3472, 'eval_samples_per_second': 23.9, 'eval_steps_per_second': 1.195, 'epoch': 5.0, 'timestamp': 1750316758, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': 'e3787b12', 'date': '2025-06-19_09-05-58', 'time_this_iter_s': 80.17357778549194, 'time_total_s': 80.17357778549194, 'pid': 2468071, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 6.094080202241274, 'learning_rate': 4.555391530860597e-06, 'weight_decay': 0.12303118765599412, 'num_train_epochs': 5}, 'time_since_restore': 80.17357778549194, 'iterations_since_restore': 1, 'experiment_tag': '2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230'}
2025-06-19 09:06:57,430 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   1.829316  0.838235  ...                        6  7ec5cc09
1   1.210543  0.846715  ...                        5  e3787b12
2   4.390304  0.840336  ...                        3  5b5580b3

[3 rows x 32 columns]
[36m(train_hpo pid=2469573)[0m 2025-06-19 09:06:57,377 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
2025-06-19 09:06:57,609 - INFO - Trial comparison plot saved
2025-06-19 09:06:57,609 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-19 09:06:58,263 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-19 09:06:58,377 - INFO - training size : 737
2025-06-19 09:06:58,378 - INFO - dev size : 80
2025-06-19 09:06:58,378 - INFO - test size : 79

[36m(train_hpo pid=2469573)[0m {'loss': 0.2375, 'grad_norm': 0.45272296667099, 'learning_rate': 0.0, 'epoch': 3.0}
[36m(train_hpo pid=2469573)[0m {'train_runtime': 43.6218, 'train_samples_per_second': 50.686, 'train_steps_per_second': 2.545, 'train_loss': 0.4734077969112912, 'epoch': 3.0}
[36m(train_hpo pid=2469573)[0m STATE at ending of training  :  TrainerState(epoch=3.0, global_step=111, max_steps=111, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=580818606389832.0, log_history=[{'loss': 0.6612, 'grad_norm': 15.471101760864258, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0, 'step': 37}, {'loss': 0.5216, 'grad_norm': 78.53952026367188, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0, 'step': 74}, {'loss': 0.2375, 'grad_norm': 0.45272296667099, 'learning_rate': 0.0, 'epoch': 3.0, 'step': 111}, {'train_runtime': 43.6218, 'train_samples_per_second': 50.686, 'train_steps_per_second': 2.545, 'total_flos': 580818606389832.0, 'train_loss': 0.4734077969112912, 'epoch': 3.0, 'step': 111}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=2469573)[0m {'eval_loss': 4.390303611755371, 'eval_f1': 0.8403361344537815, 'eval_accuracy': 0.7625, 'eval_kappa': 0.3770491803278688, 'eval_precision': 0.8333333333333334, 'eval_recall': 0.847457627118644, 'eval_optim_threshold': 0.9898310303688049, 'eval_AP': 0.9145851322146804, 'eval_MCC': 0.3772520040005942, 'eval_NDCG': 0.9823627596249604, 'eval_runtime': 3.5122, 'eval_samples_per_second': 22.777, 'eval_steps_per_second': 1.139, 'epoch': 3.0}

Trial train_hpo_5b5580b3 finished iteration 1 at 2025-06-19 09:06:57. Total running time: 4min 6s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_5b5580b3 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    51.5375 â”‚
â”‚ time_total_s                        51.5375 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     3 â”‚
â”‚ eval_AP                             0.91459 â”‚
â”‚ eval_MCC                            0.37725 â”‚
â”‚ eval_NDCG                           0.98236 â”‚
â”‚ eval_accuracy                        0.7625 â”‚
â”‚ eval_f1                             0.84034 â”‚
â”‚ eval_kappa                          0.37705 â”‚
â”‚ eval_loss                            4.3903 â”‚
â”‚ eval_optim_threshold                0.98983 â”‚
â”‚ eval_precision                      0.83333 â”‚
â”‚ eval_recall                         0.84746 â”‚
â”‚ eval_runtime                         3.5122 â”‚
â”‚ eval_samples_per_second              22.777 â”‚
â”‚ eval_steps_per_second                 1.139 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_5b5580b3 completed after 1 iterations at 2025-06-19 09:06:57. Total running time: 4min 6s

Trial status: 3 TERMINATED
Current time: 2025-06-19 09:06:57. Total running time: 4min 6s
Logical resource usage: 10.0/32 CPUs, 1.0/1 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_7ec5cc09   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1            94.2731       1.82932    0.838235            0.725       0.0189521 â”‚
â”‚ train_hpo_e3787b12   TERMINATED        6.09408       4.55539e-06         0.123031                    5        1            80.1736       1.21054    0.846715            0.7375      0.0432802 â”‚
â”‚ train_hpo_5b5580b3   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            51.5375       4.3903     0.840336            0.7625      0.377049  â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

  0%|          | 0/465 [00:00<?, ?it/s]  0%|          | 1/465 [00:00<01:31,  5.10it/s]  0%|          | 2/465 [00:00<01:24,  5.45it/s]  1%|          | 3/465 [00:00<01:22,  5.58it/s]  1%|          | 4/465 [00:00<01:21,  5.64it/s]  1%|          | 5/465 [00:00<01:21,  5.67it/s]  1%|â–         | 6/465 [00:01<01:19,  5.79it/s]  2%|â–         | 7/465 [00:01<01:16,  5.99it/s]  2%|â–         | 8/465 [00:01<01:17,  5.91it/s]  2%|â–         | 9/465 [00:01<01:11,  6.37it/s]  2%|â–         | 10/465 [00:01<01:14,  6.14it/s]  2%|â–         | 11/465 [00:01<01:15,  6.01it/s]  3%|â–Ž         | 12/465 [00:02<01:16,  5.93it/s]  3%|â–Ž         | 13/465 [00:02<01:13,  6.18it/s]  3%|â–Ž         | 14/465 [00:02<01:14,  6.04it/s]  3%|â–Ž         | 15/465 [00:02<01:15,  5.94it/s]  3%|â–Ž         | 16/465 [00:02<01:16,  5.88it/s]  4%|â–Ž         | 17/465 [00:02<01:16,  5.83it/s]  4%|â–         | 18/465 [00:03<01:16,  5.81it/s]  4%|â–         | 19/465 [00:03<01:12,  6.12it/s]  4%|â–         | 20/465 [00:03<01:11,  6.18it/s]  5%|â–         | 21/465 [00:03<01:12,  6.10it/s]  5%|â–         | 22/465 [00:03<01:14,  5.97it/s]  5%|â–         | 23/465 [00:03<01:14,  5.89it/s]  5%|â–Œ         | 24/465 [00:04<01:15,  5.84it/s]  5%|â–Œ         | 25/465 [00:04<01:15,  5.81it/s]  6%|â–Œ         | 26/465 [00:04<01:15,  5.79it/s]  6%|â–Œ         | 27/465 [00:04<01:15,  5.78it/s]  6%|â–Œ         | 28/465 [00:04<01:15,  5.77it/s]  6%|â–Œ         | 29/465 [00:04<01:11,  6.09it/s]  6%|â–‹         | 30/465 [00:05<01:10,  6.14it/s]  7%|â–‹         | 31/465 [00:05<01:11,  6.11it/s]  7%|â–‹         | 32/465 [00:05<01:12,  5.99it/s]  7%|â–‹         | 33/465 [00:05<01:13,  5.91it/s]  7%|â–‹         | 34/465 [00:05<01:13,  5.86it/s]  8%|â–Š         | 35/465 [00:05<01:13,  5.82it/s]  8%|â–Š         | 36/465 [00:06<01:13,  5.80it/s]  8%|â–Š         | 37/465 [00:06<01:13,  5.79it/s]  8%|â–Š         | 38/465 [00:06<01:13,  5.83it/s]  8%|â–Š         | 39/465 [00:06<01:13,  5.80it/s]  9%|â–Š         | 40/465 [00:06<01:13,  5.78it/s]  9%|â–‰         | 41/465 [00:06<01:13,  5.77it/s]  9%|â–‰         | 42/465 [00:07<01:13,  5.76it/s]  9%|â–‰         | 43/465 [00:07<01:13,  5.75it/s]  9%|â–‰         | 44/465 [00:07<01:11,  5.86it/s] 10%|â–‰         | 45/465 [00:07<01:12,  5.82it/s] 10%|â–‰         | 46/465 [00:07<01:12,  5.79it/s] 10%|â–ˆ         | 47/465 [00:07<01:12,  5.77it/s] 10%|â–ˆ         | 48/465 [00:08<01:12,  5.76it/s] 11%|â–ˆ         | 49/465 [00:08<01:12,  5.74it/s] 11%|â–ˆ         | 50/465 [00:08<01:12,  5.74it/s] 11%|â–ˆ         | 51/465 [00:08<01:12,  5.73it/s] 11%|â–ˆ         | 52/465 [00:08<01:11,  5.75it/s] 11%|â–ˆâ–        | 53/465 [00:09<01:07,  6.09it/s] 12%|â–ˆâ–        | 54/465 [00:09<01:03,  6.47it/s] 12%|â–ˆâ–        | 55/465 [00:09<01:05,  6.22it/s] 12%|â–ˆâ–        | 56/465 [00:09<01:07,  6.08it/s] 12%|â–ˆâ–        | 57/465 [00:09<01:08,  5.98it/s] 12%|â–ˆâ–        | 58/465 [00:09<01:05,  6.25it/s] 13%|â–ˆâ–Ž        | 59/465 [00:09<01:03,  6.44it/s] 13%|â–ˆâ–Ž        | 60/465 [00:10<01:05,  6.21it/s] 13%|â–ˆâ–Ž        | 61/465 [00:10<01:06,  6.07it/s] 13%|â–ˆâ–Ž        | 62/465 [00:10<01:07,  5.97it/s] 14%|â–ˆâ–Ž        | 63/465 [00:10<01:06,  6.02it/s] 14%|â–ˆâ–        | 64/465 [00:10<01:07,  5.93it/s] 14%|â–ˆâ–        | 65/465 [00:10<01:07,  5.89it/s] 14%|â–ˆâ–        | 66/465 [00:11<01:07,  5.95it/s] 14%|â–ˆâ–        | 67/465 [00:11<01:07,  5.88it/s] 15%|â–ˆâ–        | 68/465 [00:11<01:07,  5.85it/s] 15%|â–ˆâ–        | 69/465 [00:11<01:04,  6.14it/s] 15%|â–ˆâ–Œ        | 70/465 [00:11<01:05,  6.02it/s] 15%|â–ˆâ–Œ        | 71/465 [00:11<01:06,  5.94it/s] 15%|â–ˆâ–Œ        | 72/465 [00:12<01:06,  5.88it/s] 16%|â–ˆâ–Œ        | 73/465 [00:12<01:07,  5.84it/s] 16%|â–ˆâ–Œ        | 74/465 [00:12<01:05,  5.97it/s] 16%|â–ˆâ–Œ        | 75/465 [00:12<01:06,  5.90it/s] 16%|â–ˆâ–‹        | 76/465 [00:12<01:05,  5.95it/s] 17%|â–ˆâ–‹        | 77/465 [00:13<01:05,  5.89it/s] 17%|â–ˆâ–‹        | 78/465 [00:13<01:04,  6.05it/s] 17%|â–ˆâ–‹        | 79/465 [00:13<01:04,  5.95it/s] 17%|â–ˆâ–‹        | 80/465 [00:13<01:05,  5.88it/s] 17%|â–ˆâ–‹        | 81/465 [00:13<01:05,  5.84it/s] 18%|â–ˆâ–Š        | 82/465 [00:13<01:02,  6.12it/s] 18%|â–ˆâ–Š        | 83/465 [00:13<01:03,  6.00it/s] 18%|â–ˆâ–Š        | 84/465 [00:14<01:04,  5.92it/s] 18%|â–ˆâ–Š        | 85/465 [00:14<01:04,  5.86it/s] 18%|â–ˆâ–Š        | 86/465 [00:14<01:01,  6.16it/s] 19%|â–ˆâ–Š        | 87/465 [00:14<01:02,  6.03it/s] 19%|â–ˆâ–‰        | 88/465 [00:14<01:03,  5.94it/s] 19%|â–ˆâ–‰        | 89/465 [00:15<01:03,  5.91it/s] 19%|â–ˆâ–‰        | 90/465 [00:15<01:03,  5.86it/s] 20%|â–ˆâ–‰        | 91/465 [00:15<01:04,  5.82it/s] 20%|â–ˆâ–‰        | 92/465 [00:15<01:03,  5.85it/s]                                                 20%|â–ˆâ–ˆ        | 93/465 [00:15<01:03,  5.85it/s] 20%|â–ˆâ–ˆ        | 94/465 [00:15<00:54,  6.80it/s] 20%|â–ˆâ–ˆ        | 95/465 [00:15<00:55,  6.61it/s] 21%|â–ˆâ–ˆ        | 96/465 [00:16<00:57,  6.37it/s] 21%|â–ˆâ–ˆ        | 97/465 [00:16<00:57,  6.40it/s] 21%|â–ˆâ–ˆ        | 98/465 [00:16<00:58,  6.24it/s] 21%|â–ˆâ–ˆâ–       | 99/465 [00:16<01:00,  6.09it/s] 22%|â–ˆâ–ˆâ–       | 100/465 [00:16<01:00,  5.99it/s] 22%|â–ˆâ–ˆâ–       | 101/465 [00:16<01:00,  5.97it/s] 22%|â–ˆâ–ˆâ–       | 102/465 [00:17<01:00,  6.00it/s] 22%|â–ˆâ–ˆâ–       | 103/465 [00:17<01:01,  5.91it/s] 22%|â–ˆâ–ˆâ–       | 104/465 [00:17<01:01,  5.86it/s] 23%|â–ˆâ–ˆâ–Ž       | 105/465 [00:17<01:01,  5.82it/s] 23%|â–ˆâ–ˆâ–Ž       | 106/465 [00:17<01:01,  5.81it/s] 23%|â–ˆâ–ˆâ–Ž       | 107/465 [00:17<01:01,  5.78it/s] 23%|â–ˆâ–ˆâ–Ž       | 108/465 [00:18<01:00,  5.95it/s] 23%|â–ˆâ–ˆâ–Ž       | 109/465 [00:18<01:00,  5.89it/s] 24%|â–ˆâ–ˆâ–Ž       | 110/465 [00:18<01:00,  5.84it/s] 24%|â–ˆâ–ˆâ–       | 111/465 [00:18<01:00,  5.81it/s] 24%|â–ˆâ–ˆâ–       | 112/465 [00:18<01:00,  5.88it/s] 24%|â–ˆâ–ˆâ–       | 113/465 [00:18<01:00,  5.83it/s] 25%|â–ˆâ–ˆâ–       | 114/465 [00:19<01:00,  5.80it/s] 25%|â–ˆâ–ˆâ–       | 115/465 [00:19<01:00,  5.83it/s] 25%|â–ˆâ–ˆâ–       | 116/465 [00:19<01:00,  5.79it/s] 25%|â–ˆâ–ˆâ–Œ       | 117/465 [00:19<00:59,  5.83it/s] 25%|â–ˆâ–ˆâ–Œ       | 118/465 [00:19<00:59,  5.80it/s] 26%|â–ˆâ–ˆâ–Œ       | 119/465 [00:20<00:59,  5.77it/s] 26%|â–ˆâ–ˆâ–Œ       | 120/465 [00:20<00:59,  5.76it/s] 26%|â–ˆâ–ˆâ–Œ       | 121/465 [00:20<00:59,  5.75it/s] 26%|â–ˆâ–ˆâ–Œ       | 122/465 [00:20<00:59,  5.75it/s] 26%|â–ˆâ–ˆâ–‹       | 123/465 [00:20<00:58,  5.82it/s] 27%|â–ˆâ–ˆâ–‹       | 124/465 [00:20<00:58,  5.80it/s] 27%|â–ˆâ–ˆâ–‹       | 125/465 [00:21<00:55,  6.07it/s] 27%|â–ˆâ–ˆâ–‹       | 126/465 [00:21<00:56,  5.98it/s] 27%|â–ˆâ–ˆâ–‹       | 127/465 [00:21<00:55,  6.04it/s] 28%|â–ˆâ–ˆâ–Š       | 128/465 [00:21<00:53,  6.30it/s] 28%|â–ˆâ–ˆâ–Š       | 129/465 [00:21<00:54,  6.11it/s] 28%|â–ˆâ–ˆâ–Š       | 130/465 [00:21<00:55,  6.05it/s] 28%|â–ˆâ–ˆâ–Š       | 131/465 [00:22<00:56,  5.96it/s] 28%|â–ˆâ–ˆâ–Š       | 132/465 [00:22<00:53,  6.24it/s] 29%|â–ˆâ–ˆâ–Š       | 133/465 [00:22<00:53,  6.22it/s] 29%|â–ˆâ–ˆâ–‰       | 134/465 [00:22<00:54,  6.08it/s] 29%|â–ˆâ–ˆâ–‰       | 135/465 [00:22<00:54,  6.10it/s] 29%|â–ˆâ–ˆâ–‰       | 136/465 [00:22<00:53,  6.15it/s] 29%|â–ˆâ–ˆâ–‰       | 137/465 [00:23<00:54,  6.02it/s] 30%|â–ˆâ–ˆâ–‰       | 138/465 [00:23<00:52,  6.26it/s] 30%|â–ˆâ–ˆâ–‰       | 139/465 [00:23<00:52,  6.23it/s] 30%|â–ˆâ–ˆâ–ˆ       | 140/465 [00:23<00:52,  6.24it/s] 30%|â–ˆâ–ˆâ–ˆ       | 141/465 [00:23<00:53,  6.07it/s] 31%|â–ˆâ–ˆâ–ˆ       | 142/465 [00:23<00:53,  6.03it/s] 31%|â–ˆâ–ˆâ–ˆ       | 143/465 [00:24<00:54,  5.94it/s] 31%|â–ˆâ–ˆâ–ˆ       | 144/465 [00:24<00:54,  5.87it/s] 31%|â–ˆâ–ˆâ–ˆ       | 145/465 [00:24<00:53,  5.95it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 146/465 [00:24<00:54,  5.89it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 147/465 [00:24<00:52,  6.03it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 148/465 [00:24<00:53,  5.91it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 149/465 [00:25<00:53,  5.86it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 150/465 [00:25<00:54,  5.83it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 151/465 [00:25<00:54,  5.81it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 152/465 [00:25<00:54,  5.79it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 153/465 [00:25<00:53,  5.79it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 154/465 [00:25<00:53,  5.79it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 155/465 [00:26<00:52,  5.89it/s] 34%|â–ˆâ–ˆâ–ˆâ–Ž      | 156/465 [00:26<00:48,  6.32it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 157/465 [00:26<00:49,  6.18it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 158/465 [00:26<00:50,  6.06it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 159/465 [00:26<00:51,  5.97it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 160/465 [00:26<00:50,  6.00it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 161/465 [00:27<00:51,  5.93it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 162/465 [00:27<00:51,  5.89it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 163/465 [00:27<00:51,  5.84it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 164/465 [00:27<00:51,  5.82it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 165/465 [00:27<00:51,  5.80it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 166/465 [00:27<00:51,  5.82it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 167/465 [00:28<00:51,  5.81it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 168/465 [00:28<01:00,  4.91it/s] 36%|â–ˆâ–ˆâ–ˆâ–‹      | 169/465 [00:28<00:57,  5.13it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 170/465 [00:28<00:55,  5.29it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 171/465 [00:28<00:54,  5.41it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 172/465 [00:29<00:53,  5.51it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 173/465 [00:29<00:51,  5.72it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 174/465 [00:29<00:50,  5.73it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 175/465 [00:29<00:48,  5.93it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 176/465 [00:29<00:49,  5.88it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 177/465 [00:29<00:46,  6.17it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 178/465 [00:30<00:47,  6.04it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 179/465 [00:30<00:46,  6.13it/s] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 180/465 [00:30<00:46,  6.17it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 181/465 [00:30<00:47,  6.03it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 182/465 [00:30<00:47,  5.93it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 183/465 [00:30<00:48,  5.86it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 184/465 [00:31<00:48,  5.84it/s] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 185/465 [00:31<00:46,  6.07it/s]                                                  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 186/465 [00:31<00:45,  6.07it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 187/465 [00:31<00:38,  7.14it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 188/465 [00:31<00:40,  6.91it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 189/465 [00:31<00:42,  6.55it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 190/465 [00:31<00:42,  6.41it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 191/465 [00:32<00:44,  6.22it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 192/465 [00:32<00:44,  6.17it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 193/465 [00:32<00:42,  6.36it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 194/465 [00:32<00:43,  6.19it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 195/465 [00:32<00:44,  6.05it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 196/465 [00:32<00:45,  5.96it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 197/465 [00:33<00:45,  5.90it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 198/465 [00:33<00:45,  5.90it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 199/465 [00:33<00:45,  5.84it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 200/465 [00:33<00:45,  5.81it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 201/465 [00:33<00:45,  5.79it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 202/465 [00:33<00:45,  5.77it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 203/465 [00:34<00:44,  5.91it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 204/465 [00:34<00:44,  5.86it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 205/465 [00:34<00:44,  5.82it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 206/465 [00:34<00:44,  5.79it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 207/465 [00:34<00:44,  5.78it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 208/465 [00:34<00:44,  5.78it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 209/465 [00:35<00:44,  5.77it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 210/465 [00:35<00:43,  5.85it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 211/465 [00:35<00:43,  5.83it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 212/465 [00:35<00:43,  5.79it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 213/465 [00:35<00:43,  5.76it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 214/465 [00:36<00:43,  5.75it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 215/465 [00:36<00:43,  5.74it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 216/465 [00:36<00:43,  5.73it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 217/465 [00:36<00:43,  5.74it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 218/465 [00:36<00:43,  5.74it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 219/465 [00:36<00:42,  5.74it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 220/465 [00:37<00:42,  5.74it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 221/465 [00:37<00:42,  5.74it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 222/465 [00:37<00:42,  5.74it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 223/465 [00:37<00:42,  5.74it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 224/465 [00:37<00:42,  5.73it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 225/465 [00:37<00:41,  5.77it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 226/465 [00:38<00:41,  5.77it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 227/465 [00:38<00:41,  5.77it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 228/465 [00:38<00:38,  6.23it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 229/465 [00:38<00:38,  6.07it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 230/465 [00:38<00:39,  5.96it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 231/465 [00:38<00:37,  6.21it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 232/465 [00:39<00:37,  6.20it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 233/465 [00:39<00:37,  6.23it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 234/465 [00:39<00:38,  6.06it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 235/465 [00:39<00:38,  5.93it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 236/465 [00:39<00:39,  5.86it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 237/465 [00:39<00:38,  5.90it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 238/465 [00:40<00:38,  5.86it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 239/465 [00:40<00:38,  5.88it/s]2025-06-19 09:07:39,166	WARNING tune.py:219 -- Stop signal received (e.g. via SIGINT/Ctrl+C), ending Ray Tune run. This will try to checkpoint the experiment state one last time. Press CTRL+C (or send SIGINT/SIGKILL/SIGTERM) to skip. 
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 240/465 [00:40<00:38,  5.89it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 241/465 [00:40<00:38,  5.84it/s]2025-06-19 09:07:39,371	WARNING tune.py:219 -- Stop signal received (e.g. via SIGINT/Ctrl+C), ending Ray Tune run. This will try to checkpoint the experiment state one last time. Press CTRL+C (or send SIGINT/SIGKILL/SIGTERM) to skip. 
2025-06-19 09:07:39,371	WARNING tune.py:219 -- Stop signal received (e.g. via SIGINT/Ctrl+C), ending Ray Tune run. This will try to checkpoint the experiment state one last time. Press CTRL+C (or send SIGINT/SIGKILL/SIGTERM) to skip. 
 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 242/465 [00:40<00:38,  5.81it/s]{'loss': 1.1882, 'grad_norm': 21.811092376708984, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0}
{'loss': 0.6471, 'grad_norm': 3.800259828567505, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0}
Traceback (most recent call last):
  File "/home/leandre/Projects/BioMoQA_Playground/experiments/biomoqa.py", line 67, in <module>
    main()
  File "/home/leandre/Projects/BioMoQA_Playground/experiments/biomoqa.py", line 53, in main
    pipeline.whole_pipeline()
  File "/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/old_binary_pipeline.py", line 645, in whole_pipeline
    avg_ens_metrics=self.run_pipeline()
                    ^^^^^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/old_binary_pipeline.py", line 569, in run_pipeline
    scores_by_fold = self.train(model_name=model_name)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/old_binary_pipeline.py", line 448, in train
    metrics = trainer.train().metrics
              ^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/trainer.py", line 2241, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/trainer.py", line 2553, in _inner_training_loop
    and (torch.isnan(tr_loss_step) or torch.isinf(tr_loss_step))
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
Exception ignored in atexit callback: <function shutdown at 0x7db9f4c2f740>
Traceback (most recent call last):
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 1921, in shutdown
    time.sleep(0.5)
KeyboardInterrupt: 
adding 500 optional negatives
2025-06-19 09:24:23,558 - INFO - Randomness sources seeded with 42 for reproducibility.
2025-06-19 09:24:23,558 - INFO - Namespace(balanced=False, balance_coeff=5, n_folds=5, n_runs=2, with_title=True, with_keywords=False, nb_opt_negs=500)
2025-06-19 09:24:23,649 - INFO - Optional negatives loaded from CSV with 5000 entries.
2025-06-19 09:24:23,649 - INFO - Loading original negatives...
2025-06-19 09:24:23,658 - INFO - Negatives column names: ['Article ID', 'Title', 'Author', 'Publication year', 'Title secondary', 'URL', 'DOI', 'Abstract', 'Criteria for exclusion A', ' Criteria for exclusion B', ' Criteria for exclusion C', 'labels', 'Keywords']
2025-06-19 09:24:23,658 - INFO - Loading original positives...
2025-06-19 09:24:23,673 - INFO - Positives column names: ['Article ID', 'Title', 'Author', 'Secondary authors', 'Keywords', 'title of unpublished reference', 'primary date', 'publication year', 'notes', 'reprint status', 'start page number', 'ending page number', 'periodical full name', 'periodical standard abbreviation', 'periodical in which article was published', 'periodical name - user abbreviation 1', 'periodical name - user abbreviation 2', 'volume number', 'issue number', 'title secondary', 'city of publication', 'publisher', 'user definable 1', 'user definable 5', 'title series', 'Abstract', 'ISSN/ISBN', 'availability', 'Misc. 1', 'Misc. 2', 'address', 'Web/URL', 'link to PDF', 'link to full-text', 'related records', 'images', 'DOI', 'labels']
2025-06-19 09:24:23,679 - INFO - Class balance:
labels
1    326
0    123
Name: count, dtype: int64
2025-06-19 09:24:23,680 - INFO -    Article ID  ...  Criteria for exclusion C
0       12959  ...                       NaN
1       13470  ...                       NaN
2        4686  ...                       NaN
3        2503  ...                       NaN
4        2951  ...                       NaN

[5 rows x 44 columns]
2025-06-19 09:24:23,702 - INFO - Original dataset size: 449
2025-06-19 09:24:23,702 - INFO - Optional negatives size: 5000
2025-06-19 09:24:23,707 - INFO - Optional negatives:                                                title  ... labels
0  Towards evidence-based conservation of subterr...  ...     -1
1                  Marine biodiversity conservation.  ...     -1
2  Climate teleconnections modulate global burned...  ...     -1
3  Integrating carbon sequestration and biodivers...  ...     -1
4  Principle, technique and application of grassl...  ...     -1

[5 rows x 7 columns]
2025-06-19 09:24:23,711 - INFO - Combined dataset size: 949
2025-06-19 09:24:23,711 - INFO - Before cleaning, head:
                                               title  ... labels
0  Feral pig (Sus scrofa) disturbance facilitates...  ...      1
1  Effects of woody plant diversity on abovegroun...  ...      1
2  Scaling species richness and endemism of tropi...  ...      1
3  Not as the crow flies: Assessing effective iso...  ...      0
4  Species-group concepts and biogeography of the...  ...      1

[5 rows x 5 columns]
2025-06-19 09:24:23,715 - INFO - Null counts before cleaning:
title        0
abstract     0
Keywords     8
doi         37
labels       0
dtype: int64
2025-06-19 09:24:23,718 - INFO - Total duplicate title: 0
2025-06-19 09:24:23,722 - INFO - Conflicts on title (same value, multiple labels):
Empty DataFrame
Columns: [title, n_labels]
Index: []
2025-06-19 09:24:23,724 - INFO - Total duplicate abstract: 0
2025-06-19 09:24:23,733 - INFO - Conflicts on abstract (same value, multiple labels):
Empty DataFrame
Columns: [abstract, n_labels]
Index: []
2025-06-19 09:24:23,735 - INFO - Total duplicate doi: 18
2025-06-19 09:24:23,737 - INFO - Conflicts on doi (same value, multiple labels):
Empty DataFrame
Columns: [doi, n_labels]
Index: []
2025-06-19 09:24:23,738 - INFO - Cleaned dataset size: 896
2025-06-19 09:24:23,738 - INFO - Number of positives : 293
2025-06-19 09:24:23,739 - INFO - Number of negatives : 603
2025-06-19 09:24:23,739 - INFO - clean_og_df size : 397
2025-06-19 09:24:23,739 - INFO - opt_neg_df size : 499
2025-06-19 09:24:23,743 - INFO - Fold 1:
2025-06-19 09:24:23,743 - INFO -   Train label distribution: {-1: 0.6779891304347826, 1: 0.23777173913043478, 0: 0.08423913043478261}
2025-06-19 09:24:23,743 - INFO -   Test label distribution: {1: 0.7375, 0: 0.2625}
2025-06-19 09:24:23,745 - INFO - Fold 2:
2025-06-19 09:24:23,745 - INFO -   Train label distribution: {-1: 0.6779891304347826, 1: 0.23777173913043478, 0: 0.08423913043478261}
2025-06-19 09:24:23,745 - INFO -   Test label distribution: {1: 0.7375, 0: 0.2625}
2025-06-19 09:24:23,748 - INFO - Fold 3:
2025-06-19 09:24:23,748 - INFO -   Train label distribution: {-1: 0.6770691994572592, 1: 0.23744911804613297, 0: 0.08548168249660787}
2025-06-19 09:24:23,748 - INFO -   Test label distribution: {1: 0.7468354430379747, 0: 0.25316455696202533}
2025-06-19 09:24:23,750 - INFO - Fold 4:
2025-06-19 09:24:23,750 - INFO -   Train label distribution: {-1: 0.6770691994572592, 1: 0.23880597014925373, 0: 0.08412483039348712}
2025-06-19 09:24:23,750 - INFO -   Test label distribution: {1: 0.7341772151898734, 0: 0.26582278481012656}
2025-06-19 09:24:23,752 - INFO - Fold 5:
2025-06-19 09:24:23,752 - INFO -   Train label distribution: {-1: 0.6770691994572592, 1: 0.23880597014925373, 0: 0.08412483039348712}
2025-06-19 09:24:23,752 - INFO -   Test label distribution: {1: 0.7341772151898734, 0: 0.26582278481012656}
2025-06-19 09:24:23,755 - INFO - Fold 1:
2025-06-19 09:24:23,755 - INFO -   Train label distribution: {-1: 0.6779891304347826, 1: 0.23777173913043478, 0: 0.08423913043478261}
2025-06-19 09:24:23,755 - INFO -   Test label distribution: {1: 0.7375, 0: 0.2625}
2025-06-19 09:24:23,757 - INFO - Fold 2:
2025-06-19 09:24:23,757 - INFO -   Train label distribution: {-1: 0.6779891304347826, 1: 0.23777173913043478, 0: 0.08423913043478261}
2025-06-19 09:24:23,757 - INFO -   Test label distribution: {1: 0.7375, 0: 0.2625}
2025-06-19 09:24:23,760 - INFO - Fold 3:
2025-06-19 09:24:23,760 - INFO -   Train label distribution: {-1: 0.6770691994572592, 1: 0.23744911804613297, 0: 0.08548168249660787}
2025-06-19 09:24:23,760 - INFO -   Test label distribution: {1: 0.7468354430379747, 0: 0.25316455696202533}
2025-06-19 09:24:23,762 - INFO - Fold 4:
2025-06-19 09:24:23,762 - INFO -   Train label distribution: {-1: 0.6770691994572592, 1: 0.23880597014925373, 0: 0.08412483039348712}
2025-06-19 09:24:23,762 - INFO -   Test label distribution: {1: 0.7341772151898734, 0: 0.26582278481012656}
2025-06-19 09:24:23,764 - INFO - Fold 5:
2025-06-19 09:24:23,764 - INFO -   Train label distribution: {-1: 0.6770691994572592, 1: 0.23880597014925373, 0: 0.08412483039348712}
2025-06-19 09:24:23,764 - INFO -   Test label distribution: {1: 0.7341772151898734, 0: 0.26582278481012656}
2025-06-19 09:24:23,765 - INFO - Indices of clean_df remain the same after resetting.
2025-06-19 09:24:23,782 - INFO - clean_df index : RangeIndex(start=0, stop=896, step=1)
Stringifying the column:   0%|          | 0/896 [00:00<?, ? examples/s]Stringifying the column: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 896/896 [00:00<00:00, 167689.81 examples/s]
Casting to class labels:   0%|          | 0/896 [00:00<?, ? examples/s]Casting to class labels: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 896/896 [00:00<00:00, 176229.61 examples/s]
2025-06-19 09:24:23,798 - INFO - Number of positives : 293
2025-06-19 09:24:23,799 - INFO - Number of negatives : 603
2025-06-19 09:24:23,799 - INFO - All 5 testâ€folds in run 1 are pairwise disjoint.
2025-06-19 09:24:23,799 - INFO - All 5 testâ€folds in run 2 are pairwise disjoint.
2025-06-19 09:24:23,800 - INFO - 
fold number 1 / 5
2025-06-19 09:24:23,805 - INFO - train split size : 736
2025-06-19 09:24:23,805 - INFO - dev split size : 80
2025-06-19 09:24:23,805 - INFO - test split size : 80
2025-06-19 09:24:23,861 - INFO - 
fold number 2 / 5
2025-06-19 09:24:23,866 - INFO - train split size : 736
2025-06-19 09:24:23,866 - INFO - dev split size : 80
2025-06-19 09:24:23,866 - INFO - test split size : 80
2025-06-19 09:24:23,918 - INFO - 
fold number 3 / 5
2025-06-19 09:24:23,923 - INFO - train split size : 737
2025-06-19 09:24:23,923 - INFO - dev split size : 80
2025-06-19 09:24:23,923 - INFO - test split size : 79
2025-06-19 09:24:23,974 - INFO - 
fold number 4 / 5
2025-06-19 09:24:23,979 - INFO - train split size : 737
2025-06-19 09:24:23,979 - INFO - dev split size : 80
2025-06-19 09:24:23,979 - INFO - test split size : 79
2025-06-19 09:24:24,032 - INFO - 
fold number 5 / 5
2025-06-19 09:24:24,037 - INFO - train split size : 737
2025-06-19 09:24:24,037 - INFO - dev split size : 80
2025-06-19 09:24:24,037 - INFO - test split size : 79
2025-06-19 09:24:24,090 - INFO - 
fold number 1 / 5
2025-06-19 09:24:24,095 - INFO - train split size : 736
2025-06-19 09:24:24,095 - INFO - dev split size : 80
2025-06-19 09:24:24,095 - INFO - test split size : 80
2025-06-19 09:24:24,146 - INFO - 
fold number 2 / 5
2025-06-19 09:24:24,152 - INFO - train split size : 736
2025-06-19 09:24:24,152 - INFO - dev split size : 80
2025-06-19 09:24:24,152 - INFO - test split size : 80
2025-06-19 09:24:24,203 - INFO - 
fold number 3 / 5
2025-06-19 09:24:24,209 - INFO - train split size : 737
2025-06-19 09:24:24,209 - INFO - dev split size : 80
2025-06-19 09:24:24,209 - INFO - test split size : 79
2025-06-19 09:24:24,261 - INFO - 
fold number 4 / 5
2025-06-19 09:24:24,267 - INFO - train split size : 737
2025-06-19 09:24:24,267 - INFO - dev split size : 80
2025-06-19 09:24:24,267 - INFO - test split size : 79
2025-06-19 09:24:24,318 - INFO - 
fold number 5 / 5
2025-06-19 09:24:24,323 - INFO - train split size : 737
2025-06-19 09:24:24,323 - INFO - dev split size : 80
2025-06-19 09:24:24,323 - INFO - test split size : 79
Loss function: BCE
Fold number: 0
Run number: 0
Model: microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract
2025-06-19 09:24:30,893 - INFO - Randomness sources seeded with 42 for reproducibility.
2025-06-19 09:24:30,893 - INFO - Random seeds set to 42
2025-06-19 09:24:30,894 - INFO - Namespace(config='configs/hpo.yaml', fold=0, run=0, gpu=None, model_name='microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract', nb_opt_negs=500, n_trials=3, hpo_metric='eval_f1', direction=None, loss='BCE', with_title=True, with_keywords=False)
2025-06-19 09:24:30,894 - INFO - {'model_name': 'google-bert/bert-base-uncased', 'num_trials': 20, 'fold': 0, 'hpo_metric': 'eval_kappa', 'direction': 'max', 'loss_type': 'BCE', 'with_title': True, 'with_keywords': False, 'nb_optional_negs': 100}
2025-06-19 09:24:31,325 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
2025-06-19 09:24:31,325 - INFO - 
fold number 1 | run no. 1
Generating train split: 0 examples [00:00, ? examples/s]Generating train split: 736 examples [00:00, 28498.96 examples/s]
Generating train split: 0 examples [00:00, ? examples/s]Generating train split: 80 examples [00:00, 13972.28 examples/s]
Generating train split: 0 examples [00:00, ? examples/s]Generating train split: 80 examples [00:00, 14098.50 examples/s]
2025-06-19 09:24:31,976 - INFO - train split size : 736
2025-06-19 09:24:31,976 - INFO - dev split size : 80
2025-06-19 09:24:31,976 - INFO - test split size : 80
Map (num_proc=32):   0%|          | 0/736 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 23/736 [00:00<00:03, 189.32 examples/s]Map (num_proc=32):  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 345/736 [00:00<00:00, 1785.93 examples/s]Map (num_proc=32):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 690/736 [00:00<00:00, 2462.75 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 736/736 [00:00<00:00, 1793.70 examples/s]
Map (num_proc=32):   0%|          | 0/80 [00:00<?, ? examples/s]Map (num_proc=32):  15%|â–ˆâ–Œ        | 12/80 [00:00<00:00, 115.83 examples/s]Map (num_proc=32):  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 56/80 [00:00<00:00, 292.16 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 80/80 [00:00<00:00, 220.06 examples/s]
Map (num_proc=32):   0%|          | 0/80 [00:00<?, ? examples/s]Map (num_proc=32):  11%|â–ˆâ–        | 9/80 [00:00<00:00, 87.90 examples/s]Map (num_proc=32):  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 52/80 [00:00<00:00, 278.70 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 80/80 [00:00<00:00, 212.46 examples/s]
2025-06-19 09:24:34,393 - INFO - 3 datasets tokenized successfully
2025-06-19 09:24:34,510 - INFO - Fold 1 max seq len = 512
Traceback (most recent call last):
  File "/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/hpo.py", line 369, in <module>
    main()
  File "/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/hpo.py", line 360, in main
    best_params=train_hpo(cfg,args.fold,args.run)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/hpo.py", line 287, in train_hpo
    mode=cfg['directiron']
         ~~~^^^^^^^^^^^^^^
KeyError: 'directiron'
2025-06-19 09:24:41,180 - INFO - Randomness sources seeded with 42 for reproducibility.
2025-06-19 09:24:41,181 - INFO - Random seeds set to 42
2025-06-19 09:24:41,181 - INFO - Namespace(config='configs/train.yaml', hp_config='configs/best_hpo.yaml', fold=0, run=0, gpu='2', model_name='microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract', nb_opt_negs=500, loss='BCE', with_title=True, with_keywords=False, best_metric='eval_f1')
2025-06-19 09:24:41,183 - INFO - {'model_name': 'bert-base-uncased', 'fold': 0, 'run': 0, 'output_dir': 'outputs/checkpoints', 'best_metric': 'eval_kappa', 'loss_type': 'BCE', 'nb_optional_negs': 100, 'with_title': True, 'with_keywords': False, 'default_hyperparameters': {'learning_rate': 'None', 'num_train_epochs': 'None', 'pos_weight': 'None', 'weight_decay': 'None'}}
2025-06-19 09:24:41,985 - INFO - train split size : 736
2025-06-19 09:24:41,985 - INFO - dev split size : 80
2025-06-19 09:24:41,985 - INFO - test split size : 80
2025-06-19 09:24:42,230 - INFO - 3 datasets tokenized successfully
2025-06-19 09:24:42,230 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-19 09:24:42,959 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
[2025-06-19 09:24:43,193] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-06-19 09:24:45,942] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
2025-06-19 09:24:45,981 - INFO - training size : 736
2025-06-19 09:24:45,981 - INFO - dev size : 80
2025-06-19 09:24:45,981 - INFO - test size : 80
  0%|          | 0/24 [00:00<?, ?it/s]  4%|â–         | 1/24 [00:02<00:53,  2.31s/it]  8%|â–Š         | 2/24 [00:04<00:44,  2.03s/it] 12%|â–ˆâ–Ž        | 3/24 [00:05<00:40,  1.93s/it] 17%|â–ˆâ–‹        | 4/24 [00:07<00:37,  1.88s/it] 21%|â–ˆâ–ˆ        | 5/24 [00:09<00:35,  1.85s/it] 25%|â–ˆâ–ˆâ–Œ       | 6/24 [00:11<00:33,  1.84s/it] 29%|â–ˆâ–ˆâ–‰       | 7/24 [00:13<00:30,  1.81s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 8/24 [00:13<00:23,  1.44s/it]                                               33%|â–ˆâ–ˆâ–ˆâ–Ž      | 8/24 [00:13<00:23,  1.44s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 9/24 [00:15<00:23,  1.58s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 10/24 [00:17<00:23,  1.65s/it] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 11/24 [00:19<00:22,  1.70s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 12/24 [00:21<00:20,  1.73s/it] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 13/24 [00:22<00:19,  1.76s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 14/24 [00:24<00:17,  1.77s/it] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 15/24 [00:26<00:15,  1.77s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 16/24 [00:27<00:11,  1.43s/it]                                                67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 16/24 [00:27<00:11,  1.43s/it] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 17/24 [00:29<00:10,  1.57s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 18/24 [00:30<00:09,  1.65s/it] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 19/24 [00:32<00:08,  1.70s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 20/24 [00:34<00:06,  1.74s/it] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 21/24 [00:36<00:05,  1.76s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 22/24 [00:38<00:03,  1.78s/it] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 23/24 [00:39<00:01,  1.78s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 24/24 [00:40<00:00,  1.44s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 24/24 [00:42<00:00,  1.44s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 24/24 [00:42<00:00,  1.44s/it]2025-06-19 09:25:28,739 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 24/24 [00:42<00:00,  1.77s/it]
{'loss': 1.1581, 'grad_norm': 6.918366432189941, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
{'loss': 0.4658, 'grad_norm': 4.333384990692139, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
{'loss': 0.2978, 'grad_norm': 2.0626416206359863, 'learning_rate': 0.0, 'epoch': 3.0}
{'train_runtime': 42.4659, 'train_samples_per_second': 51.995, 'train_steps_per_second': 0.565, 'train_loss': 0.6405531466007233, 'epoch': 3.0}
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-19 09:25:32,427 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:03<00:00,  3.18s/it]
2025-06-19 09:25:32,434 - INFO - Training time : 50.2038530659629
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-19 09:25:35,749 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.80s/it]
2025-06-19 09:25:35,754 - INFO - Evaluation time : 3.3197883350076154
2025-06-19 09:25:35,754 - INFO - Evaluation results on test set: {'eval_loss': 1.5225064754486084, 'eval_f1': 0.8296296296296296, 'eval_accuracy': 0.7125, 'eval_kappa': -0.004366812227074357, 'eval_precision': 0.7368421052631579, 'eval_recall': 0.9491525423728814, 'eval_optim_threshold': 0.976102352142334, 'eval_AP': 0.8783106100437907, 'eval_MCC': -0.006517597644344587, 'eval_NDCG': 0.9742343822875441, 'eval_runtime': 3.3076, 'eval_samples_per_second': 24.186, 'eval_steps_per_second': 0.302, 'epoch': 3.0}
2025-06-19 09:25:35,754 - INFO - Total updates (optimizer steps): 24
2025-06-19 09:25:35,754 - INFO - Avg time / step: 1.770s
2025-06-19 09:25:36,735 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCE_BiomedBERT-abs_fold-1
2025-06-19 09:25:36,735 - INFO - On test Set (with threshold 0.5) : 
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-19 09:25:40,156 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.91s/it]
2025-06-19 09:25:40,160 - INFO - Raw predictions shape: (80, 1)
2025-06-19 09:25:40,160 - INFO - Raw predictions: [[3.6603723]
 [3.5367153]
 [2.915646 ]
 [3.6638193]
 [3.7425063]
 [3.7449424]
 [3.7669146]
 [3.2258778]
 [2.4536207]
 [3.1936378]]
2025-06-19 09:25:40,160 - INFO - Scores shape: (80,)
2025-06-19 09:25:40,161 - INFO - Scores: [0.9749221  0.9717146  0.9486144  0.9750063  0.9768538  0.97690886
 0.97739935 0.9617966  0.9208258  0.9605941 ]
2025-06-19 09:25:40,161 - INFO - Preds shape: (80,)
2025-06-19 09:25:40,161 - INFO - Preds: [1 1 1 1 1 1 1 1 1 1]
2025-06-19 09:25:40,161 - INFO - Test labels shape: (80,)
2025-06-19 09:25:40,161 - INFO - Test labels: [1, 1, 0, 0, 1, 1, 1, 1, 0, 0]
2025-06-19 09:25:40,161 - INFO - Test split: Dataset({
    features: ['Unnamed: 0', 'title', 'abstract', 'Keywords', 'doi', 'labels'],
    num_rows: 80
})
2025-06-19 09:25:40,161 - INFO - Unique values in predictions: [0 1]
2025-06-19 09:25:40,162 - INFO - Unique values in labels: [0 1]
2025-06-19 09:25:40,162 - INFO - Confusion matrix:
[[ 1 20]
 [ 3 56]]
2025-06-19 09:25:40,163 - INFO - Confusion matrix: TN=1, FP=20, FN=3, TP=56
2025-06-19 09:25:43,055 - INFO - Metrics: {'f1': 0.8296296296296296, 'recall': 0.9491525423728814, 'precision': 0.7368421052631579, 'accuracy': 0.7125, 'AP': 0.8783106100437907, 'MCC': -0.006517597644344587, 'NDCG': 0.9742343822875441, 'kappa': -0.004366812227074357, 'TN': 1, 'FP': 20, 'FN': 3, 'TP': 56}
2025-06-19 09:25:43,171 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-19 09:25:43,265 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-19 09:25:43,265 - INFO - 
On test Set (optimal threshold of 0.9273492097854614 according to cross validation on the training set): 
2025-06-19 09:25:43,266 - INFO - Confusion matrix: TN=5, FP=16, FN=4, TP=55
2025-06-19 09:25:45,990 - INFO - Metrics: {'f1': 0.8461538461538461, 'recall': 0.9322033898305084, 'precision': 0.7746478873239436, 'accuracy': 0.75, 'AP': 0.8783106100437907, 'MCC': 0.23713539014397733, 'NDCG': 0.9742343822875441, 'kappa': 0.20870425321463892, 'TN': 5, 'FP': 16, 'FN': 4, 'TP': 55}
2025-06-19 09:25:46,089 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-19 09:25:46,089 - INFO - Results for fold 1 with optim_threshold leqrned from dev set : {'f1': 0.8461538461538461, 'recall': 0.9322033898305084, 'precision': 0.7746478873239436, 'accuracy': 0.75, 'AP': 0.8783106100437907, 'MCC': 0.23713539014397733, 'NDCG': 0.9742343822875441, 'kappa': 0.20870425321463892, 'TN': 5, 'FP': 16, 'FN': 4, 'TP': 55}
2025-06-19 09:25:46,544 - INFO - Cleared CUDA cache. Memory allocated: 1.33 GB, Memory reserved: 1.63 GB
2025-06-19 09:25:46,550 - INFO - Metrics stored successfully at /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/metrics/binary_metrics.csv
Model: microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext
2025-06-19 09:25:54,438 - INFO - Randomness sources seeded with 42 for reproducibility.
2025-06-19 09:25:54,439 - INFO - Random seeds set to 42
2025-06-19 09:25:54,439 - INFO - Namespace(config='configs/hpo.yaml', fold=0, run=0, gpu=None, model_name='microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext', nb_opt_negs=500, n_trials=3, hpo_metric='eval_f1', direction=None, loss='BCE', with_title=True, with_keywords=False)
2025-06-19 09:25:54,440 - INFO - {'model_name': 'google-bert/bert-base-uncased', 'num_trials': 20, 'fold': 0, 'hpo_metric': 'eval_kappa', 'direction': 'max', 'loss_type': 'BCE', 'with_title': True, 'with_keywords': False, 'nb_optional_negs': 100}
2025-06-19 09:25:54,871 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
2025-06-19 09:25:54,871 - INFO - 
fold number 1 | run no. 1
2025-06-19 09:25:55,477 - INFO - train split size : 736
2025-06-19 09:25:55,478 - INFO - dev split size : 80
2025-06-19 09:25:55,478 - INFO - test split size : 80
Map (num_proc=32):   0%|          | 0/736 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 23/736 [00:00<00:03, 191.48 examples/s]Map (num_proc=32):  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 345/736 [00:00<00:00, 1802.96 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 736/736 [00:00<00:00, 1884.74 examples/s]
Map (num_proc=32):   0%|          | 0/80 [00:00<?, ? examples/s]Map (num_proc=32):  15%|â–ˆâ–Œ        | 12/80 [00:00<00:00, 112.10 examples/s]Map (num_proc=32):  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 54/80 [00:00<00:00, 283.45 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 80/80 [00:00<00:00, 212.23 examples/s]
Map (num_proc=32):   0%|          | 0/80 [00:00<?, ? examples/s]Map (num_proc=32):  19%|â–ˆâ–‰        | 15/80 [00:00<00:00, 136.22 examples/s]Map (num_proc=32):  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 52/80 [00:00<00:00, 262.30 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 80/80 [00:00<00:00, 250.94 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 80/80 [00:00<00:00, 194.22 examples/s]
2025-06-19 09:25:57,830 - INFO - 3 datasets tokenized successfully
2025-06-19 09:25:57,948 - INFO - Fold 1 max seq len = 512
Traceback (most recent call last):
  File "/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/hpo.py", line 369, in <module>
    main()
  File "/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/hpo.py", line 360, in main
    best_params=train_hpo(cfg,args.fold,args.run)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/hpo.py", line 287, in train_hpo
    mode=cfg['directiron']
         ~~~^^^^^^^^^^^^^^
KeyError: 'directiron'
2025-06-19 09:26:04,704 - INFO - Randomness sources seeded with 42 for reproducibility.
2025-06-19 09:26:04,704 - INFO - Random seeds set to 42
2025-06-19 09:26:04,705 - INFO - Namespace(config='configs/train.yaml', hp_config='configs/best_hpo.yaml', fold=0, run=0, gpu='2', model_name='microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext', nb_opt_negs=500, loss='BCE', with_title=True, with_keywords=False, best_metric='eval_f1')
2025-06-19 09:26:04,706 - INFO - {'model_name': 'bert-base-uncased', 'fold': 0, 'run': 0, 'output_dir': 'outputs/checkpoints', 'best_metric': 'eval_kappa', 'loss_type': 'BCE', 'nb_optional_negs': 100, 'with_title': True, 'with_keywords': False, 'default_hyperparameters': {'learning_rate': 'None', 'num_train_epochs': 'None', 'pos_weight': 'None', 'weight_decay': 'None'}}
2025-06-19 09:26:05,494 - INFO - train split size : 736
2025-06-19 09:26:05,494 - INFO - dev split size : 80
2025-06-19 09:26:05,494 - INFO - test split size : 80
2025-06-19 09:26:05,737 - INFO - 3 datasets tokenized successfully
2025-06-19 09:26:05,737 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-19 09:26:06,459 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
[2025-06-19 09:26:06,682] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-06-19 09:26:09,352] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
2025-06-19 09:26:09,388 - INFO - training size : 736
2025-06-19 09:26:09,388 - INFO - dev size : 80
2025-06-19 09:26:09,388 - INFO - test size : 80
  0%|          | 0/24 [00:00<?, ?it/s]  4%|â–         | 1/24 [00:02<00:53,  2.33s/it]  8%|â–Š         | 2/24 [00:04<00:44,  2.04s/it] 12%|â–ˆâ–Ž        | 3/24 [00:05<00:40,  1.93s/it] 17%|â–ˆâ–‹        | 4/24 [00:07<00:37,  1.89s/it] 21%|â–ˆâ–ˆ        | 5/24 [00:09<00:35,  1.86s/it] 25%|â–ˆâ–ˆâ–Œ       | 6/24 [00:11<00:33,  1.84s/it] 29%|â–ˆâ–ˆâ–‰       | 7/24 [00:13<00:31,  1.82s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 8/24 [00:13<00:23,  1.45s/it]                                               33%|â–ˆâ–ˆâ–ˆâ–Ž      | 8/24 [00:13<00:23,  1.45s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 9/24 [00:15<00:23,  1.59s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 10/24 [00:17<00:23,  1.66s/it] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 11/24 [00:19<00:22,  1.71s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 12/24 [00:21<00:20,  1.74s/it] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 13/24 [00:23<00:19,  1.77s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 14/24 [00:24<00:17,  1.79s/it] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 15/24 [00:26<00:16,  1.79s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 16/24 [00:27<00:11,  1.45s/it]                                                67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 16/24 [00:27<00:11,  1.45s/it]adding 500 optional negatives
2025-06-19 09:27:02,577 - INFO - Randomness sources seeded with 42 for reproducibility.
2025-06-19 09:27:02,577 - INFO - Namespace(balanced=False, balance_coeff=5, n_folds=5, n_runs=2, with_title=True, with_keywords=False, nb_opt_negs=500)
2025-06-19 09:27:02,668 - INFO - Optional negatives loaded from CSV with 5000 entries.
2025-06-19 09:27:02,668 - INFO - Loading original negatives...
2025-06-19 09:27:02,676 - INFO - Negatives column names: ['Article ID', 'Title', 'Author', 'Publication year', 'Title secondary', 'URL', 'DOI', 'Abstract', 'Criteria for exclusion A', ' Criteria for exclusion B', ' Criteria for exclusion C', 'labels', 'Keywords']
2025-06-19 09:27:02,676 - INFO - Loading original positives...
2025-06-19 09:27:02,693 - INFO - Positives column names: ['Article ID', 'Title', 'Author', 'Secondary authors', 'Keywords', 'title of unpublished reference', 'primary date', 'publication year', 'notes', 'reprint status', 'start page number', 'ending page number', 'periodical full name', 'periodical standard abbreviation', 'periodical in which article was published', 'periodical name - user abbreviation 1', 'periodical name - user abbreviation 2', 'volume number', 'issue number', 'title secondary', 'city of publication', 'publisher', 'user definable 1', 'user definable 5', 'title series', 'Abstract', 'ISSN/ISBN', 'availability', 'Misc. 1', 'Misc. 2', 'address', 'Web/URL', 'link to PDF', 'link to full-text', 'related records', 'images', 'DOI', 'labels']
2025-06-19 09:27:02,698 - INFO - Class balance:
labels
1    326
0    123
Name: count, dtype: int64
2025-06-19 09:27:02,698 - INFO -    Article ID  ...  Criteria for exclusion C
0       12959  ...                       NaN
1       13470  ...                       NaN
2        4686  ...                       NaN
3        2503  ...                       NaN
4        2951  ...                       NaN

[5 rows x 44 columns]
2025-06-19 09:27:02,720 - INFO - Original dataset size: 449
2025-06-19 09:27:02,720 - INFO - Optional negatives size: 5000
2025-06-19 09:27:02,725 - INFO - Optional negatives:                                                title  ... labels
0  Towards evidence-based conservation of subterr...  ...     -1
1                  Marine biodiversity conservation.  ...     -1
2  Climate teleconnections modulate global burned...  ...     -1
3  Integrating carbon sequestration and biodivers...  ...     -1
4  Principle, technique and application of grassl...  ...     -1

[5 rows x 7 columns]
2025-06-19 09:27:02,728 - INFO - Combined dataset size: 949
2025-06-19 09:27:02,728 - INFO - Before cleaning, head:
                                               title  ... labels
0  Feral pig (Sus scrofa) disturbance facilitates...  ...      1
1  Effects of woody plant diversity on abovegroun...  ...      1
2  Scaling species richness and endemism of tropi...  ...      1
3  Not as the crow flies: Assessing effective iso...  ...      0
4  Species-group concepts and biogeography of the...  ...      1

[5 rows x 5 columns]
2025-06-19 09:27:02,733 - INFO - Null counts before cleaning:
title        0
abstract     0
Keywords     8
doi         37
labels       0
dtype: int64
2025-06-19 09:27:02,735 - INFO - Total duplicate title: 0
2025-06-19 09:27:02,739 - INFO - Conflicts on title (same value, multiple labels):
Empty DataFrame
Columns: [title, n_labels]
Index: []
2025-06-19 09:27:02,742 - INFO - Total duplicate abstract: 0
2025-06-19 09:27:02,750 - INFO - Conflicts on abstract (same value, multiple labels):
Empty DataFrame
Columns: [abstract, n_labels]
Index: []
2025-06-19 09:27:02,752 - INFO - Total duplicate doi: 18
2025-06-19 09:27:02,754 - INFO - Conflicts on doi (same value, multiple labels):
Empty DataFrame
Columns: [doi, n_labels]
Index: []
2025-06-19 09:27:02,755 - INFO - Cleaned dataset size: 896
2025-06-19 09:27:02,755 - INFO - Number of positives : 293
2025-06-19 09:27:02,756 - INFO - Number of negatives : 603
2025-06-19 09:27:02,756 - INFO - clean_og_df size : 397
2025-06-19 09:27:02,756 - INFO - opt_neg_df size : 499
2025-06-19 09:27:02,760 - INFO - Fold 1:
2025-06-19 09:27:02,760 - INFO -   Train label distribution: {-1: 0.6779891304347826, 1: 0.23777173913043478, 0: 0.08423913043478261}
2025-06-19 09:27:02,760 - INFO -   Test label distribution: {1: 0.7375, 0: 0.2625}
2025-06-19 09:27:02,762 - INFO - Fold 2:
2025-06-19 09:27:02,762 - INFO -   Train label distribution: {-1: 0.6779891304347826, 1: 0.23777173913043478, 0: 0.08423913043478261}
2025-06-19 09:27:02,762 - INFO -   Test label distribution: {1: 0.7375, 0: 0.2625}
2025-06-19 09:27:02,764 - INFO - Fold 3:
2025-06-19 09:27:02,764 - INFO -   Train label distribution: {-1: 0.6770691994572592, 1: 0.23744911804613297, 0: 0.08548168249660787}
2025-06-19 09:27:02,764 - INFO -   Test label distribution: {1: 0.7468354430379747, 0: 0.25316455696202533}
2025-06-19 09:27:02,766 - INFO - Fold 4:
2025-06-19 09:27:02,766 - INFO -   Train label distribution: {-1: 0.6770691994572592, 1: 0.23880597014925373, 0: 0.08412483039348712}
2025-06-19 09:27:02,766 - INFO -   Test label distribution: {1: 0.7341772151898734, 0: 0.26582278481012656}
2025-06-19 09:27:02,768 - INFO - Fold 5:
2025-06-19 09:27:02,768 - INFO -   Train label distribution: {-1: 0.6770691994572592, 1: 0.23880597014925373, 0: 0.08412483039348712}
2025-06-19 09:27:02,769 - INFO -   Test label distribution: {1: 0.7341772151898734, 0: 0.26582278481012656}
2025-06-19 09:27:02,771 - INFO - Fold 1:
2025-06-19 09:27:02,771 - INFO -   Train label distribution: {-1: 0.6779891304347826, 1: 0.23777173913043478, 0: 0.08423913043478261}
2025-06-19 09:27:02,771 - INFO -   Test label distribution: {1: 0.7375, 0: 0.2625}
2025-06-19 09:27:02,773 - INFO - Fold 2:
2025-06-19 09:27:02,773 - INFO -   Train label distribution: {-1: 0.6779891304347826, 1: 0.23777173913043478, 0: 0.08423913043478261}
2025-06-19 09:27:02,773 - INFO -   Test label distribution: {1: 0.7375, 0: 0.2625}
2025-06-19 09:27:02,775 - INFO - Fold 3:
2025-06-19 09:27:02,776 - INFO -   Train label distribution: {-1: 0.6770691994572592, 1: 0.23744911804613297, 0: 0.08548168249660787}
2025-06-19 09:27:02,776 - INFO -   Test label distribution: {1: 0.7468354430379747, 0: 0.25316455696202533}
2025-06-19 09:27:02,778 - INFO - Fold 4:
2025-06-19 09:27:02,778 - INFO -   Train label distribution: {-1: 0.6770691994572592, 1: 0.23880597014925373, 0: 0.08412483039348712}
2025-06-19 09:27:02,778 - INFO -   Test label distribution: {1: 0.7341772151898734, 0: 0.26582278481012656}
2025-06-19 09:27:02,780 - INFO - Fold 5:
2025-06-19 09:27:02,780 - INFO -   Train label distribution: {-1: 0.6770691994572592, 1: 0.23880597014925373, 0: 0.08412483039348712}
2025-06-19 09:27:02,780 - INFO -   Test label distribution: {1: 0.7341772151898734, 0: 0.26582278481012656}
2025-06-19 09:27:02,781 - INFO - Indices of clean_df remain the same after resetting.
2025-06-19 09:27:02,796 - INFO - clean_df index : RangeIndex(start=0, stop=896, step=1)
Stringifying the column:   0%|          | 0/896 [00:00<?, ? examples/s]Stringifying the column: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 896/896 [00:00<00:00, 167197.42 examples/s]
Casting to class labels:   0%|          | 0/896 [00:00<?, ? examples/s]Casting to class labels: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 896/896 [00:00<00:00, 178752.68 examples/s]
2025-06-19 09:27:02,812 - INFO - Number of positives : 293
2025-06-19 09:27:02,812 - INFO - Number of negatives : 603
2025-06-19 09:27:02,813 - INFO - All 5 testâ€folds in run 1 are pairwise disjoint.
2025-06-19 09:27:02,813 - INFO - All 5 testâ€folds in run 2 are pairwise disjoint.
2025-06-19 09:27:02,813 - INFO - 
fold number 1 / 5
2025-06-19 09:27:02,818 - INFO - train split size : 736
2025-06-19 09:27:02,818 - INFO - dev split size : 80
2025-06-19 09:27:02,818 - INFO - test split size : 80
2025-06-19 09:27:02,874 - INFO - 
fold number 2 / 5
2025-06-19 09:27:02,879 - INFO - train split size : 736
2025-06-19 09:27:02,879 - INFO - dev split size : 80
2025-06-19 09:27:02,879 - INFO - test split size : 80
2025-06-19 09:27:02,930 - INFO - 
fold number 3 / 5
2025-06-19 09:27:02,936 - INFO - train split size : 737
2025-06-19 09:27:02,936 - INFO - dev split size : 80
2025-06-19 09:27:02,936 - INFO - test split size : 79
2025-06-19 09:27:02,986 - INFO - 
fold number 4 / 5
2025-06-19 09:27:02,991 - INFO - train split size : 737
2025-06-19 09:27:02,991 - INFO - dev split size : 80
2025-06-19 09:27:02,991 - INFO - test split size : 79
2025-06-19 09:27:03,041 - INFO - 
fold number 5 / 5
2025-06-19 09:27:03,047 - INFO - train split size : 737
2025-06-19 09:27:03,047 - INFO - dev split size : 80
2025-06-19 09:27:03,047 - INFO - test split size : 79
2025-06-19 09:27:03,095 - INFO - 
fold number 1 / 5
2025-06-19 09:27:03,101 - INFO - train split size : 736
2025-06-19 09:27:03,101 - INFO - dev split size : 80
2025-06-19 09:27:03,101 - INFO - test split size : 80
2025-06-19 09:27:03,152 - INFO - 
fold number 2 / 5
2025-06-19 09:27:03,158 - INFO - train split size : 736
2025-06-19 09:27:03,158 - INFO - dev split size : 80
2025-06-19 09:27:03,158 - INFO - test split size : 80
2025-06-19 09:27:03,209 - INFO - 
fold number 3 / 5
2025-06-19 09:27:03,214 - INFO - train split size : 737
2025-06-19 09:27:03,214 - INFO - dev split size : 80
2025-06-19 09:27:03,214 - INFO - test split size : 79
2025-06-19 09:27:03,262 - INFO - 
fold number 4 / 5
2025-06-19 09:27:03,267 - INFO - train split size : 737
2025-06-19 09:27:03,267 - INFO - dev split size : 80
2025-06-19 09:27:03,268 - INFO - test split size : 79
2025-06-19 09:27:03,318 - INFO - 
fold number 5 / 5
2025-06-19 09:27:03,324 - INFO - train split size : 737
2025-06-19 09:27:03,324 - INFO - dev split size : 80
2025-06-19 09:27:03,324 - INFO - test split size : 79
Loss function: BCE
Fold number: 0
Run number: 0
Model: microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract
2025-06-19 09:27:09,959 - INFO - Randomness sources seeded with 42 for reproducibility.
2025-06-19 09:27:09,960 - INFO - Random seeds set to 42
2025-06-19 09:27:09,960 - INFO - Namespace(config='configs/hpo.yaml', fold=0, run=0, gpu=None, model_name='microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract', nb_opt_negs=500, n_trials=3, hpo_metric='eval_f1', direction=None, loss='BCE', with_title=True, with_keywords=False)
2025-06-19 09:27:09,961 - INFO - {'model_name': 'google-bert/bert-base-uncased', 'num_trials': 20, 'fold': 0, 'hpo_metric': 'eval_kappa', 'direction': 'max', 'loss_type': 'BCE', 'with_title': True, 'with_keywords': False, 'nb_optional_negs': 100}
2025-06-19 09:27:10,368 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
2025-06-19 09:27:10,368 - INFO - 
fold number 1 | run no. 1
Generating train split: 0 examples [00:00, ? examples/s]Generating train split: 736 examples [00:00, 29708.19 examples/s]
Generating train split: 0 examples [00:00, ? examples/s]Generating train split: 80 examples [00:00, 14372.05 examples/s]
Generating train split: 0 examples [00:00, ? examples/s]Generating train split: 80 examples [00:00, 14231.25 examples/s]
2025-06-19 09:27:10,998 - INFO - train split size : 736
2025-06-19 09:27:10,998 - INFO - dev split size : 80
2025-06-19 09:27:10,998 - INFO - test split size : 80
Map (num_proc=32):   0%|          | 0/736 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 23/736 [00:00<00:03, 188.22 examples/s]Map (num_proc=32):  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 391/736 [00:00<00:00, 1986.05 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 736/736 [00:00<00:00, 1862.81 examples/s]
Map (num_proc=32):   0%|          | 0/80 [00:00<?, ? examples/s]Map (num_proc=32):  15%|â–ˆâ–Œ        | 12/80 [00:00<00:00, 118.69 examples/s]Map (num_proc=32):  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 58/80 [00:00<00:00, 310.72 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 80/80 [00:00<00:00, 225.97 examples/s]
Map (num_proc=32):   0%|          | 0/80 [00:00<?, ? examples/s]Map (num_proc=32):  19%|â–ˆâ–‰        | 15/80 [00:00<00:00, 138.70 examples/s]Map (num_proc=32):  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 58/80 [00:00<00:00, 302.16 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 80/80 [00:00<00:00, 227.19 examples/s]
2025-06-19 09:27:13,244 - INFO - 3 datasets tokenized successfully
2025-06-19 09:27:13,364 - INFO - Fold 1 max seq len = 512
2025-06-19 09:27:13,364 - INFO - Starting hyperparameter search for BCE loss
2025-06-19 09:27:14,768	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
2025-06-19 09:27:15,505	INFO tune.py:253 -- Initializing Ray automatically. For cluster usage or custom Ray initialization, call `ray.init(...)` before `tune.run(...)`.
[36m(trainable pid=2476795)[0m 2025-06-19 09:27:23,485 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
[36m(trainable pid=2476795)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=2476795)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=2476795)[0m 2025-06-19 09:27:24,096 - INFO - Trial on GPU 0 using batch size 25
[36m(trainable pid=2476795)[0m 2025-06-19 09:27:24,267 - INFO - pos_weight value in TrainingArguments : 6.828424226204718
[36m(trainable pid=2476795)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=2476795)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=2476997)[0m 2025-06-19 09:27:29,894 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
[36m(trainable pid=2476997)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=2476997)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=2476997)[0m 2025-06-19 09:27:30,495 - INFO - Trial on GPU 1 using batch size 25
[36m(trainable pid=2476997)[0m 2025-06-19 09:27:30,655 - INFO - pos_weight value in TrainingArguments : 6.094080202241274
[36m(trainable pid=2476997)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=2476997)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=2477388)[0m 2025-06-19 09:27:36,161 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
[36m(trainable pid=2477388)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=2477388)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=2477388)[0m 2025-06-19 09:27:37,038 - INFO - Trial on GPU 2 using batch size 100
[36m(trainable pid=2477388)[0m 2025-06-19 09:27:37,180 - INFO - pos_weight value in TrainingArguments : 7.183206941666034
[36m(trainable pid=2477388)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=2477388)[0m   super().__init__(*args, **kwargs)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     trainable_2025-06-19_09-27-15   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-19_09-27-15
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-19_09-27-13_387434_2473931/artifacts/2025-06-19_09-27-15/trainable_2025-06-19_09-27-15/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-19 09:27:16. Total running time: 0s
Logical resource usage: 0/32 CPUs, 0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_816cf686   PENDING         6.82842       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_816cf686 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_816cf686 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          6.82842 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=2476795)[0m [2025-06-19 09:27:24,496] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=2476795)[0m [2025-06-19 09:27:27,141] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=2476795)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=180, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=25, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial trainable_575b341b started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_575b341b config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          6.09408 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=2476997)[0m [2025-06-19 09:27:30,995] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=2476997)[0m [2025-06-19 09:27:33,607] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=2476997)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=150, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=25, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial trainable_9f17fb7e started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_9f17fb7e config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          7.18321 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=2477388)[0m [2025-06-19 09:27:37,393] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=2477388)[0m [2025-06-19 09:27:40,063] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=2477388)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=24, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=100, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 3 RUNNING
Current time: 2025-06-19 09:27:46. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_816cf686   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ trainable_575b341b   RUNNING         6.09408       4.55539e-06         0.123031                    5 â”‚
â”‚ trainable_9f17fb7e   RUNNING         7.18321       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=2477388)[0m 2025-06-19 09:28:24,492 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=2477388)[0m 2025-06-19 09:28:24,498 - INFO - eval_result: {'eval_loss': 0.8731426000595093, 'eval_f1': 0.8613138686131386, 'eval_accuracy': 0.7625, 'eval_kappa': 0.13439635535307526, 'eval_precision': 0.7564102564102564, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9501543641090393, 'eval_AP': 0.8394688409937882, 'eval_MCC': 0.26840095387139007, 'eval_NDCG': 0.9581086994541083, 'eval_runtime': 3.3434, 'eval_samples_per_second': 23.928, 'eval_steps_per_second': 0.299, 'epoch': 3.0}
[36m(trainable pid=2477388)[0m 2025-06-19 09:28:24,816 - INFO - Cleared CUDA cache. Memory allocated: 1.33 GB, Memory reserved: 1.63 GB
2025-06-19 09:28:24,838 - INFO - Cleaning up trial 9f17fb7e
2025-06-19 09:28:24,838 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-19_09-27-15/trainable_9f17fb7e_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512_2025-06-19_09-27-29

[36m(trainable pid=2476795)[0m {'loss': 1.6437, 'grad_norm': 34.293914794921875, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}
[36m(trainable pid=2477388)[0m {'loss': 0.4956, 'grad_norm': 6.339297294616699, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}[32m [repeated 2x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
Trial status: 3 RUNNING
Current time: 2025-06-19 09:28:16. Total running time: 1min 0s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_816cf686   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ trainable_575b341b   RUNNING         6.09408       4.55539e-06         0.123031                    5 â”‚
â”‚ trainable_9f17fb7e   RUNNING         7.18321       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=2477388)[0m {'train_runtime': 40.7618, 'train_samples_per_second': 54.168, 'train_steps_per_second': 0.589, 'train_loss': 0.6734300355116526, 'epoch': 3.0}
[36m(trainable pid=2477388)[0m STATE at ending of training  :  TrainerState(epoch=3.0, global_step=24, max_steps=24, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=100, num_train_epochs=3, num_input_tokens_seen=0, total_flos=580943994126336.0, log_history=[{'loss': 1.2498, 'grad_norm': 8.488737106323242, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0, 'step': 8}, {'loss': 0.4956, 'grad_norm': 6.339297294616699, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0, 'step': 16}, {'loss': 0.2749, 'grad_norm': 1.4985311031341553, 'learning_rate': 0.0, 'epoch': 3.0, 'step': 24}, {'train_runtime': 40.7618, 'train_samples_per_second': 54.168, 'train_steps_per_second': 0.589, 'total_flos': 580943994126336.0, 'train_loss': 0.6734300355116526, 'epoch': 3.0, 'step': 24}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=2477388)[0m {'loss': 0.2749, 'grad_norm': 1.4985311031341553, 'learning_rate': 0.0, 'epoch': 3.0}[32m [repeated 2x across cluster][0m
[36m(trainable pid=2477388)[0m {'eval_loss': 0.8731426000595093, 'eval_f1': 0.8613138686131386, 'eval_accuracy': 0.7625, 'eval_kappa': 0.13439635535307526, 'eval_precision': 0.7564102564102564, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9501543641090393, 'eval_AP': 0.8394688409937882, 'eval_MCC': 0.26840095387139007, 'eval_NDCG': 0.9581086994541083, 'eval_runtime': 3.3434, 'eval_samples_per_second': 23.928, 'eval_steps_per_second': 0.299, 'epoch': 3.0}

Trial trainable_9f17fb7e finished iteration 1 at 2025-06-19 09:28:24. Total running time: 1min 8s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_9f17fb7e result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    48.9216 â”‚
â”‚ time_total_s                        48.9216 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     3 â”‚
â”‚ eval_AP                             0.83947 â”‚
â”‚ eval_MCC                             0.2684 â”‚
â”‚ eval_NDCG                           0.95811 â”‚
â”‚ eval_accuracy                        0.7625 â”‚
â”‚ eval_f1                             0.86131 â”‚
â”‚ eval_kappa                           0.1344 â”‚
â”‚ eval_loss                           0.87314 â”‚
â”‚ eval_optim_threshold                0.95015 â”‚
â”‚ eval_precision                      0.75641 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.3434 â”‚
â”‚ eval_samples_per_second              23.928 â”‚
â”‚ eval_steps_per_second                 0.299 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_9f17fb7e completed after 1 iterations at 2025-06-19 09:28:24. Total running time: 1min 8s
[36m(trainable pid=2476795)[0m {'loss': 1.3876, 'grad_norm': 22.590837478637695, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0}
[36m(trainable pid=2476997)[0m {'loss': 0.9665, 'grad_norm': 17.476978302001953, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0}

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-19 09:28:46. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_816cf686   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_575b341b   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_9f17fb7e   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            48.9216      0.873143    0.861314            0.7625       0.134396 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=2476795)[0m {'loss': 1.2789, 'grad_norm': 22.90744972229004, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0}
[36m(trainable pid=2476997)[0m {'loss': 0.7542, 'grad_norm': 17.514888763427734, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-19 09:29:16. Total running time: 2min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_816cf686   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_575b341b   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_9f17fb7e   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            48.9216      0.873143    0.861314            0.7625       0.134396 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=2476795)[0m {'loss': 1.197, 'grad_norm': 19.993274688720703, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-19 09:29:46. Total running time: 2min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_816cf686   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_575b341b   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_9f17fb7e   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            48.9216      0.873143    0.861314            0.7625       0.134396 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=2476997)[0m {'loss': 0.6294, 'grad_norm': 12.137713432312012, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0}
[36m(trainable pid=2476795)[0m {'loss': 1.1549, 'grad_norm': 16.867860794067383, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-19 09:30:16. Total running time: 3min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_816cf686   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_575b341b   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_9f17fb7e   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            48.9216      0.873143    0.861314            0.7625       0.134396 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=2476997)[0m 2025-06-19 09:30:28,341 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=2476997)[0m 2025-06-19 09:30:28,347 - INFO - eval_result: {'eval_loss': 1.2315832376480103, 'eval_f1': 0.8592592592592593, 'eval_accuracy': 0.7625, 'eval_kappa': 0.17030567685589515, 'eval_precision': 0.7631578947368421, 'eval_recall': 0.9830508474576272, 'eval_optim_threshold': 0.8106740117073059, 'eval_AP': 0.8620529711399664, 'eval_MCC': 0.25418630812943893, 'eval_NDCG': 0.9680153968034244, 'eval_runtime': 4.262, 'eval_samples_per_second': 18.77, 'eval_steps_per_second': 0.939, 'epoch': 5.0}
2025-06-19 09:30:28,684 - INFO - Cleaning up trial 575b341b
2025-06-19 09:30:28,684 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-19_09-27-15/trainable_575b341b_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-19_09-27-23
2025-06-19 09:30:28,684 - INFO - Current best: 9f17fb7e with eval_f1 : 0.8613138686131386 at iteration 1
[36m(trainable pid=2476997)[0m 2025-06-19 09:30:28,664 - INFO - Cleared CUDA cache. Memory allocated: 1.33 GB, Memory reserved: 1.63 GB
[36m(trainable pid=2476795)[0m 2025-06-19 09:30:36,451 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=2476795)[0m 2025-06-19 09:30:36,458 - INFO - eval_result: {'eval_loss': 1.9971774816513062, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.7367804646492004, 'eval_AP': 0.8039128502197583, 'eval_MCC': 0.0, 'eval_NDCG': 0.9449274257643682, 'eval_runtime': 3.4368, 'eval_samples_per_second': 23.277, 'eval_steps_per_second': 1.164, 'epoch': 6.0}
2025-06-19 09:30:36,974 - INFO - Cleaning up trial 816cf686
2025-06-19 09:30:36,975 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-19_09-27-15/trainable_816cf686_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-19_09-27-16
2025-06-19 09:30:36,975 - INFO - Cleaning up trial 575b341b
2025-06-19 09:30:36,975 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-19_09-27-15/trainable_575b341b_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-19_09-27-23
2025-06-19 09:30:36,975 - INFO - Current best: 9f17fb7e with eval_f1 : 0.8613138686131386 at iteration 1
2025-06-19 09:30:36,983	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-19_09-27-15' in 0.0063s.

[36m(trainable pid=2476997)[0m {'loss': 0.5673, 'grad_norm': 11.906838417053223, 'learning_rate': 0.0, 'epoch': 5.0}
[36m(trainable pid=2476997)[0m {'train_runtime': 170.1399, 'train_samples_per_second': 21.629, 'train_steps_per_second': 0.882, 'train_loss': 0.8416056950887044, 'epoch': 5.0}
[36m(trainable pid=2476997)[0m STATE at ending of training  :  TrainerState(epoch=5.0, global_step=150, max_steps=150, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=25, num_train_epochs=5, num_input_tokens_seen=0, total_flos=966381271182138.0, log_history=[{'loss': 1.2906, 'grad_norm': 15.361464500427246, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0, 'step': 30}, {'loss': 0.9665, 'grad_norm': 17.476978302001953, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0, 'step': 60}, {'loss': 0.7542, 'grad_norm': 17.514888763427734, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0, 'step': 90}, {'loss': 0.6294, 'grad_norm': 12.137713432312012, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0, 'step': 120}, {'loss': 0.5673, 'grad_norm': 11.906838417053223, 'learning_rate': 0.0, 'epoch': 5.0, 'step': 150}, {'train_runtime': 170.1399, 'train_samples_per_second': 21.629, 'train_steps_per_second': 0.882, 'total_flos': 966381271182138.0, 'train_loss': 0.8416056950887044, 'epoch': 5.0, 'step': 150}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=2476997)[0m {'eval_loss': 1.2315832376480103, 'eval_f1': 0.8592592592592593, 'eval_accuracy': 0.7625, 'eval_kappa': 0.17030567685589515, 'eval_precision': 0.7631578947368421, 'eval_recall': 0.9830508474576272, 'eval_optim_threshold': 0.8106740117073059, 'eval_AP': 0.8620529711399664, 'eval_MCC': 0.25418630812943893, 'eval_NDCG': 0.9680153968034244, 'eval_runtime': 4.262, 'eval_samples_per_second': 18.77, 'eval_steps_per_second': 0.939, 'epoch': 5.0}

Trial trainable_575b341b finished iteration 1 at 2025-06-19 09:30:28. Total running time: 3min 12s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_575b341b result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    179.046 â”‚
â”‚ time_total_s                        179.046 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     5 â”‚
â”‚ eval_AP                             0.86205 â”‚
â”‚ eval_MCC                            0.25419 â”‚
â”‚ eval_NDCG                           0.96802 â”‚
â”‚ eval_accuracy                        0.7625 â”‚
â”‚ eval_f1                             0.85926 â”‚
â”‚ eval_kappa                          0.17031 â”‚
â”‚ eval_loss                           1.23158 â”‚
â”‚ eval_optim_threshold                0.81067 â”‚
â”‚ eval_precision                      0.76316 â”‚
â”‚ eval_recall                         0.98305 â”‚
â”‚ eval_runtime                          4.262 â”‚
â”‚ eval_samples_per_second               18.77 â”‚
â”‚ eval_steps_per_second                 0.939 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_575b341b completed after 1 iterations at 2025-06-19 09:30:28. Total running time: 3min 12s
[36m(trainable pid=2476795)[0m STATE at ending of training  :  TrainerState(epoch=6.0, global_step=180, max_steps=180, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=25, num_train_epochs=6, num_input_tokens_seen=0, total_flos=1158834488538300.0, log_history=[{'loss': 1.6437, 'grad_norm': 34.293914794921875, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0, 'step': 30}, {'loss': 1.3876, 'grad_norm': 22.590837478637695, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0, 'step': 60}, {'loss': 1.2789, 'grad_norm': 22.90744972229004, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0, 'step': 90}, {'loss': 1.197, 'grad_norm': 19.993274688720703, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0, 'step': 120}, {'loss': 1.1549, 'grad_norm': 16.867860794067383, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0, 'step': 150}, {'loss': 1.1196, 'grad_norm': 14.031940460205078, 'learning_rate': 0.0, 'epoch': 6.0, 'step': 180}, {'train_runtime': 185.5317, 'train_samples_per_second': 23.802, 'train_steps_per_second': 0.97, 'total_flos': 1158834488538300.0, 'train_loss': 1.296951209174262, 'epoch': 6.0, 'step': 180}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=2476795)[0m {'loss': 1.1196, 'grad_norm': 14.031940460205078, 'learning_rate': 0.0, 'epoch': 6.0}
[36m(trainable pid=2476795)[0m {'train_runtime': 185.5317, 'train_samples_per_second': 23.802, 'train_steps_per_second': 0.97, 'train_loss': 1.296951209174262, 'epoch': 6.0}
[36m(trainable pid=2476795)[0m {'eval_loss': 1.9971774816513062, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.7367804646492004, 'eval_AP': 0.8039128502197583, 'eval_MCC': 0.0, 'eval_NDCG': 0.9449274257643682, 'eval_runtime': 3.4368, 'eval_samples_per_second': 23.277, 'eval_steps_per_second': 1.164, 'epoch': 6.0}

Trial trainable_816cf686 finished iteration 1 at 2025-06-19 09:30:36. Total running time: 3min 20s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_816cf686 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    193.748 â”‚
â”‚ time_total_s                        193.748 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     6 â”‚
â”‚ eval_AP                             0.80391 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.94493 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.99718 â”‚
â”‚ eval_optim_threshold                0.73678 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.4368 â”‚
â”‚ eval_samples_per_second              23.277 â”‚
â”‚ eval_steps_per_second                 1.164 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_816cf686 completed after 1 iterations at 2025-06-19 09:30:36. Total running time: 3min 20s

Trial status: 3 TERMINATED
Current time: 2025-06-19 09:30:36. Total running time: 3min 20s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_816cf686   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1           193.748       1.99718     0.848921            0.7375       0        â”‚
â”‚ trainable_575b341b   TERMINATED        6.09408       4.55539e-06         0.123031                    5        1           179.046       1.23158     0.859259            0.7625       0.170306 â”‚
â”‚ trainable_9f17fb7e   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            48.9216      0.873143    0.861314            0.7625       0.134396 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯2025-06-19 09:30:36,990 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x7ec1b861dcd0>
2025-06-19 09:30:36,990 - INFO - Best trial : trainable_9f17fb7e
2025-06-19 09:30:36,990 - INFO - Best config : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-19 09:30:36,991 - INFO - Best trial after optimization: {'eval_loss': 0.8731426000595093, 'eval_f1': 0.8613138686131386, 'eval_accuracy': 0.7625, 'eval_kappa': 0.13439635535307526, 'eval_precision': 0.7564102564102564, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9501543641090393, 'eval_AP': 0.8394688409937882, 'eval_MCC': 0.26840095387139007, 'eval_NDCG': 0.9581086994541083, 'eval_runtime': 3.3434, 'eval_samples_per_second': 23.928, 'eval_steps_per_second': 0.299, 'epoch': 3.0, 'timestamp': 1750318104, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '9f17fb7e', 'date': '2025-06-19_09-28-24', 'time_this_iter_s': 48.921616077423096, 'time_total_s': 48.921616077423096, 'pid': 2477388, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 48.921616077423096, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512'}
2025-06-19 09:30:37,013 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   1.997177  0.848921  ...                        6  816cf686
1   1.231583  0.859259  ...                        5  575b341b
2   0.873143  0.861314  ...                        3  9f17fb7e

[3 rows x 32 columns]
[36m(trainable pid=2476795)[0m 2025-06-19 09:30:36,952 - INFO - Cleared CUDA cache. Memory allocated: 1.33 GB, Memory reserved: 1.63 GB
2025-06-19 09:30:37,135 - INFO - Trial comparison plot saved
2025-06-19 09:30:37,147 - INFO - Best Hyperparameters after HPO : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}


2025-06-19 09:30:46,586 - INFO - Randomness sources seeded with 42 for reproducibility.
2025-06-19 09:30:46,586 - INFO - Random seeds set to 42
2025-06-19 09:30:46,587 - INFO - Namespace(config='configs/train.yaml', hp_config='configs/best_hpo.yaml', fold=0, run=0, gpu='2', model_name='microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract', nb_opt_negs=500, loss='BCE', with_title=True, with_keywords=False, best_metric='eval_f1')
2025-06-19 09:30:46,589 - INFO - {'model_name': 'bert-base-uncased', 'fold': 0, 'run': 0, 'output_dir': 'outputs/checkpoints', 'best_metric': 'eval_kappa', 'loss_type': 'BCE', 'nb_optional_negs': 100, 'with_title': True, 'with_keywords': False, 'default_hyperparameters': {'learning_rate': 'None', 'num_train_epochs': 'None', 'pos_weight': 'None', 'weight_decay': 'None'}}
2025-06-19 09:30:47,387 - INFO - train split size : 736
2025-06-19 09:30:47,387 - INFO - dev split size : 80
2025-06-19 09:30:47,387 - INFO - test split size : 80
2025-06-19 09:30:47,627 - INFO - 3 datasets tokenized successfully
2025-06-19 09:30:47,627 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-19 09:30:48,444 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
[2025-06-19 09:30:48,695] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-06-19 09:30:51,535] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
2025-06-19 09:30:51,573 - INFO - training size : 736
2025-06-19 09:30:51,574 - INFO - dev size : 80
2025-06-19 09:30:51,574 - INFO - test size : 80
  0%|          | 0/24 [00:00<?, ?it/s]  4%|â–         | 1/24 [00:02<00:54,  2.35s/it]  8%|â–Š         | 2/24 [00:04<00:44,  2.04s/it] 12%|â–ˆâ–Ž        | 3/24 [00:05<00:40,  1.94s/it] 17%|â–ˆâ–‹        | 4/24 [00:07<00:37,  1.89s/it] 21%|â–ˆâ–ˆ        | 5/24 [00:09<00:35,  1.86s/it] 25%|â–ˆâ–ˆâ–Œ       | 6/24 [00:11<00:33,  1.84s/it] 29%|â–ˆâ–ˆâ–‰       | 7/24 [00:13<00:30,  1.82s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 8/24 [00:13<00:23,  1.44s/it]                                               33%|â–ˆâ–ˆâ–ˆâ–Ž      | 8/24 [00:13<00:23,  1.44s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 9/24 [00:15<00:23,  1.58s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 10/24 [00:17<00:23,  1.65s/it] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 11/24 [00:19<00:22,  1.70s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 12/24 [00:21<00:20,  1.74s/it] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 13/24 [00:22<00:19,  1.76s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 14/24 [00:24<00:17,  1.78s/it] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 15/24 [00:26<00:16,  1.78s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 16/24 [00:27<00:11,  1.44s/it]                                                67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 16/24 [00:27<00:11,  1.44s/it] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 17/24 [00:29<00:11,  1.57s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 18/24 [00:30<00:09,  1.65s/it] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 19/24 [00:32<00:08,  1.70s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 20/24 [00:34<00:06,  1.74s/it] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 21/24 [00:36<00:05,  1.77s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 22/24 [00:38<00:03,  1.78s/it] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 23/24 [00:40<00:01,  1.78s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 24/24 [00:40<00:00,  1.44s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 24/24 [00:42<00:00,  1.44s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 24/24 [00:42<00:00,  1.44s/it]2025-06-19 09:31:34,456 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 24/24 [00:42<00:00,  1.77s/it]
{'loss': 1.1581, 'grad_norm': 6.918411731719971, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
{'loss': 0.4658, 'grad_norm': 4.333280563354492, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
{'loss': 0.2978, 'grad_norm': 2.062652587890625, 'learning_rate': 0.0, 'epoch': 3.0}
{'train_runtime': 42.5741, 'train_samples_per_second': 51.863, 'train_steps_per_second': 0.564, 'train_loss': 0.6405534247557322, 'epoch': 3.0}
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-19 09:31:37,814 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.85s/it]
2025-06-19 09:31:37,820 - INFO - Training time : 50.19302904594224
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-19 09:31:41,256 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.92s/it]
2025-06-19 09:31:41,260 - INFO - Evaluation time : 3.44007439003326
2025-06-19 09:31:41,260 - INFO - Evaluation results on test set: {'eval_loss': 1.5225077867507935, 'eval_f1': 0.8296296296296296, 'eval_accuracy': 0.7125, 'eval_kappa': -0.004366812227074357, 'eval_precision': 0.7368421052631579, 'eval_recall': 0.9491525423728814, 'eval_optim_threshold': 0.9761022329330444, 'eval_AP': 0.8783106100437907, 'eval_MCC': -0.006517597644344587, 'eval_NDCG': 0.9742343822875441, 'eval_runtime': 3.4282, 'eval_samples_per_second': 23.336, 'eval_steps_per_second': 0.292, 'epoch': 3.0}
2025-06-19 09:31:41,261 - INFO - Total updates (optimizer steps): 24
2025-06-19 09:31:41,261 - INFO - Avg time / step: 1.773s
2025-06-19 09:31:42,390 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCE_BiomedBERT-abs_fold-1
2025-06-19 09:31:42,390 - INFO - On test Set (with threshold 0.5) : 
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-19 09:31:45,834 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.93s/it]
2025-06-19 09:31:45,837 - INFO - Raw predictions shape: (80, 1)
2025-06-19 09:31:45,838 - INFO - Raw predictions: [[3.6603725]
 [3.5367174]
 [2.9156306]
 [3.663816 ]
 [3.7425017]
 [3.7449386]
 [3.7669094]
 [3.2258756]
 [2.453606 ]
 [3.193639 ]]
2025-06-19 09:31:45,838 - INFO - Scores shape: (80,)
2025-06-19 09:31:45,838 - INFO - Scores: [0.9749221  0.9717146  0.9486137  0.97500616 0.97685367 0.97690874
 0.97739923 0.96179646 0.9208247  0.96059424]
2025-06-19 09:31:45,838 - INFO - Preds shape: (80,)
2025-06-19 09:31:45,838 - INFO - Preds: [1 1 1 1 1 1 1 1 1 1]
2025-06-19 09:31:45,838 - INFO - Test labels shape: (80,)
2025-06-19 09:31:45,838 - INFO - Test labels: [1, 1, 0, 0, 1, 1, 1, 1, 0, 0]
2025-06-19 09:31:45,838 - INFO - Test split: Dataset({
    features: ['Unnamed: 0', 'title', 'abstract', 'Keywords', 'doi', 'labels'],
    num_rows: 80
})
2025-06-19 09:31:45,839 - INFO - Unique values in predictions: [0 1]
2025-06-19 09:31:45,839 - INFO - Unique values in labels: [0 1]
2025-06-19 09:31:45,840 - INFO - Confusion matrix:
[[ 1 20]
 [ 3 56]]
2025-06-19 09:31:45,840 - INFO - Confusion matrix: TN=1, FP=20, FN=3, TP=56
2025-06-19 09:31:48,538 - INFO - Metrics: {'f1': 0.8296296296296296, 'recall': 0.9491525423728814, 'precision': 0.7368421052631579, 'accuracy': 0.7125, 'AP': 0.8783106100437907, 'MCC': -0.006517597644344587, 'NDCG': 0.9742343822875441, 'kappa': -0.004366812227074357, 'TN': 1, 'FP': 20, 'FN': 3, 'TP': 56}
2025-06-19 09:31:48,648 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-19 09:31:48,742 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-19 09:31:48,742 - INFO - 
On test Set (optimal threshold of 0.927349328994751 according to cross validation on the training set): 
2025-06-19 09:31:48,743 - INFO - Confusion matrix: TN=5, FP=16, FN=4, TP=55
2025-06-19 09:31:51,516 - INFO - Metrics: {'f1': 0.8461538461538461, 'recall': 0.9322033898305084, 'precision': 0.7746478873239436, 'accuracy': 0.75, 'AP': 0.8783106100437907, 'MCC': 0.23713539014397733, 'NDCG': 0.9742343822875441, 'kappa': 0.20870425321463892, 'TN': 5, 'FP': 16, 'FN': 4, 'TP': 55}
2025-06-19 09:31:51,606 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-19 09:31:51,606 - INFO - Results for fold 1 with optim_threshold leqrned from dev set : {'f1': 0.8461538461538461, 'recall': 0.9322033898305084, 'precision': 0.7746478873239436, 'accuracy': 0.75, 'AP': 0.8783106100437907, 'MCC': 0.23713539014397733, 'NDCG': 0.9742343822875441, 'kappa': 0.20870425321463892, 'TN': 5, 'FP': 16, 'FN': 4, 'TP': 55}
2025-06-19 09:31:51,933 - INFO - Cleared CUDA cache. Memory allocated: 1.33 GB, Memory reserved: 1.63 GB
2025-06-19 09:31:51,939 - INFO - Metrics stored successfully at /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/metrics/binary_metrics.csv
Model: microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext
2025-06-19 09:31:59,680 - INFO - Randomness sources seeded with 42 for reproducibility.
2025-06-19 09:31:59,680 - INFO - Random seeds set to 42
2025-06-19 09:31:59,681 - INFO - Namespace(config='configs/hpo.yaml', fold=0, run=0, gpu=None, model_name='microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext', nb_opt_negs=500, n_trials=3, hpo_metric='eval_f1', direction=None, loss='BCE', with_title=True, with_keywords=False)
2025-06-19 09:31:59,682 - INFO - {'model_name': 'google-bert/bert-base-uncased', 'num_trials': 20, 'fold': 0, 'hpo_metric': 'eval_kappa', 'direction': 'max', 'loss_type': 'BCE', 'with_title': True, 'with_keywords': False, 'nb_optional_negs': 100}
2025-06-19 09:32:00,150 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
2025-06-19 09:32:00,150 - INFO - 
fold number 1 | run no. 1
2025-06-19 09:32:00,941 - INFO - train split size : 736
2025-06-19 09:32:00,942 - INFO - dev split size : 80
2025-06-19 09:32:00,942 - INFO - test split size : 80
Map (num_proc=32):   0%|          | 0/736 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 23/736 [00:00<00:03, 182.42 examples/s]Map (num_proc=32):  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 299/736 [00:00<00:00, 1543.75 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 736/736 [00:00<00:00, 1856.63 examples/s]
Map (num_proc=32):   0%|          | 0/80 [00:00<?, ? examples/s]Map (num_proc=32):  22%|â–ˆâ–ˆâ–Ž       | 18/80 [00:00<00:00, 167.47 examples/s]Map (num_proc=32):  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 56/80 [00:00<00:00, 283.18 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 80/80 [00:00<00:00, 219.46 examples/s]
Map (num_proc=32):   0%|          | 0/80 [00:00<?, ? examples/s]Map (num_proc=32):  15%|â–ˆâ–Œ        | 12/80 [00:00<00:00, 113.98 examples/s]Map (num_proc=32):  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 47/80 [00:00<00:00, 238.75 examples/s]Map (num_proc=32):  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 78/80 [00:00<00:00, 263.07 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 80/80 [00:00<00:00, 200.10 examples/s]
2025-06-19 09:32:03,298 - INFO - 3 datasets tokenized successfully
2025-06-19 09:32:03,418 - INFO - Fold 1 max seq len = 512
2025-06-19 09:32:03,419 - INFO - Starting hyperparameter search for BCE loss
2025-06-19 09:32:04,943	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
2025-06-19 09:32:05,658	INFO tune.py:253 -- Initializing Ray automatically. For cluster usage or custom Ray initialization, call `ray.init(...)` before `tune.run(...)`.
[36m(trainable pid=2483822)[0m 2025-06-19 09:32:13,961 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
[36m(trainable pid=2483822)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=2483822)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=2483822)[0m 2025-06-19 09:32:14,612 - INFO - Trial on GPU 0 using batch size 25
[36m(trainable pid=2483822)[0m 2025-06-19 09:32:14,775 - INFO - pos_weight value in TrainingArguments : 6.828424226204718
[36m(trainable pid=2483822)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=2483822)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=2484028)[0m 2025-06-19 09:32:20,663 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
[36m(trainable pid=2484028)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=2484028)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=2484028)[0m 2025-06-19 09:32:21,612 - INFO - Trial on GPU 1 using batch size 25
[36m(trainable pid=2484028)[0m 2025-06-19 09:32:21,794 - INFO - pos_weight value in TrainingArguments : 6.094080202241274
[36m(trainable pid=2484028)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=2484028)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=2484419)[0m 2025-06-19 09:32:27,149 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
[36m(trainable pid=2484419)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=2484419)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=2484419)[0m 2025-06-19 09:32:27,763 - INFO - Trial on GPU 2 using batch size 100
[36m(trainable pid=2484419)[0m 2025-06-19 09:32:27,913 - INFO - pos_weight value in TrainingArguments : 7.183206941666034
[36m(trainable pid=2484419)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=2484419)[0m   super().__init__(*args, **kwargs)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     trainable_2025-06-19_09-32-05   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-19_09-32-05
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-19_09-32-03_442896_2480956/artifacts/2025-06-19_09-32-05/trainable_2025-06-19_09-32-05/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-19 09:32:06. Total running time: 0s
Logical resource usage: 0/32 CPUs, 0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_8f41a214   PENDING         6.82842       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_8f41a214 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_8f41a214 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          6.82842 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=2483822)[0m [2025-06-19 09:32:15,004] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=2483822)[0m [2025-06-19 09:32:17,715] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=2483822)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=180, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=25, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial trainable_1785cd66 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_1785cd66 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          6.09408 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=2484028)[0m [2025-06-19 09:32:22,158] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=2484028)[0m [2025-06-19 09:32:25,012] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=2484028)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=150, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=25, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial trainable_6eb4c7e3 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_6eb4c7e3 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          7.18321 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=2484419)[0m [2025-06-19 09:32:28,132] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=2484419)[0m [2025-06-19 09:32:30,780] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=2484419)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=24, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=100, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 3 RUNNING
Current time: 2025-06-19 09:32:36. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_8f41a214   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ trainable_1785cd66   RUNNING         6.09408       4.55539e-06         0.123031                    5 â”‚
â”‚ trainable_6eb4c7e3   RUNNING         7.18321       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=2484419)[0m 2025-06-19 09:33:15,468 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=2484419)[0m 2025-06-19 09:33:15,473 - INFO - eval_result: {'eval_loss': 1.0499393939971924, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9718979597091675, 'eval_AP': 0.8087853891402255, 'eval_MCC': 0.0, 'eval_NDCG': 0.9356594631476054, 'eval_runtime': 3.5652, 'eval_samples_per_second': 22.439, 'eval_steps_per_second': 0.28, 'epoch': 3.0}
[36m(trainable pid=2484419)[0m 2025-06-19 09:33:15,958 - INFO - Cleared CUDA cache. Memory allocated: 1.33 GB, Memory reserved: 1.63 GB
2025-06-19 09:33:15,990 - INFO - Cleaning up trial 6eb4c7e3
2025-06-19 09:33:15,990 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-19_09-32-05/trainable_6eb4c7e3_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512_2025-06-19_09-32-20

[36m(trainable pid=2483822)[0m {'loss': 1.4917, 'grad_norm': 14.187821388244629, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}
[36m(trainable pid=2484419)[0m {'loss': 0.5502, 'grad_norm': 4.932548999786377, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}[32m [repeated 2x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
Trial status: 3 RUNNING
Current time: 2025-06-19 09:33:06. Total running time: 1min 0s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_8f41a214   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ trainable_1785cd66   RUNNING         6.09408       4.55539e-06         0.123031                    5 â”‚
â”‚ trainable_6eb4c7e3   RUNNING         7.18321       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=2484419)[0m {'train_runtime': 40.79, 'train_samples_per_second': 54.131, 'train_steps_per_second': 0.588, 'train_loss': 0.7119257052739462, 'epoch': 3.0}
[36m(trainable pid=2484419)[0m STATE at ending of training  :  TrainerState(epoch=3.0, global_step=24, max_steps=24, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=100, num_train_epochs=3, num_input_tokens_seen=0, total_flos=580943994126336.0, log_history=[{'loss': 1.2315, 'grad_norm': 9.086222648620605, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0, 'step': 8}, {'loss': 0.5502, 'grad_norm': 4.932548999786377, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0, 'step': 16}, {'loss': 0.354, 'grad_norm': 2.4551730155944824, 'learning_rate': 0.0, 'epoch': 3.0, 'step': 24}, {'train_runtime': 40.79, 'train_samples_per_second': 54.131, 'train_steps_per_second': 0.588, 'total_flos': 580943994126336.0, 'train_loss': 0.7119257052739462, 'epoch': 3.0, 'step': 24}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=2484419)[0m {'loss': 0.354, 'grad_norm': 2.4551730155944824, 'learning_rate': 0.0, 'epoch': 3.0}[32m [repeated 2x across cluster][0m
[36m(trainable pid=2484419)[0m {'eval_loss': 1.0499393939971924, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9718979597091675, 'eval_AP': 0.8087853891402255, 'eval_MCC': 0.0, 'eval_NDCG': 0.9356594631476054, 'eval_runtime': 3.5652, 'eval_samples_per_second': 22.439, 'eval_steps_per_second': 0.28, 'epoch': 3.0}

Trial trainable_6eb4c7e3 finished iteration 1 at 2025-06-19 09:33:15. Total running time: 1min 9s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_6eb4c7e3 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    49.0912 â”‚
â”‚ time_total_s                        49.0912 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     3 â”‚
â”‚ eval_AP                             0.80879 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.93566 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.04994 â”‚
â”‚ eval_optim_threshold                 0.9719 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.5652 â”‚
â”‚ eval_samples_per_second              22.439 â”‚
â”‚ eval_steps_per_second                  0.28 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_6eb4c7e3 completed after 1 iterations at 2025-06-19 09:33:15. Total running time: 1min 9s
[36m(trainable pid=2484028)[0m {'loss': 0.9479, 'grad_norm': 19.836685180664062, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0}[32m [repeated 2x across cluster][0m

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-19 09:33:36. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_8f41a214   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_1785cd66   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_6eb4c7e3   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            49.0912       1.04994    0.848921            0.7375              0 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=2483822)[0m {'loss': 1.3497, 'grad_norm': 16.711301803588867, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-19 09:34:07. Total running time: 2min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_8f41a214   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_1785cd66   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_6eb4c7e3   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            49.0912       1.04994    0.848921            0.7375              0 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=2484028)[0m {'loss': 0.7422, 'grad_norm': 13.731138229370117, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0}
[36m(trainable pid=2483822)[0m {'loss': 1.2976, 'grad_norm': 9.711115837097168, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-19 09:34:37. Total running time: 2min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_8f41a214   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_1785cd66   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_6eb4c7e3   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            49.0912       1.04994    0.848921            0.7375              0 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=2484028)[0m {'loss': 0.6317, 'grad_norm': 7.491095542907715, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0}
[36m(trainable pid=2483822)[0m {'loss': 1.2549, 'grad_norm': 9.92264175415039, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-19 09:35:07. Total running time: 3min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_8f41a214   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_1785cd66   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_6eb4c7e3   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            49.0912       1.04994    0.848921            0.7375              0 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=2484028)[0m 2025-06-19 09:35:20,685 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=2484028)[0m 2025-06-19 09:35:20,690 - INFO - eval_result: {'eval_loss': 1.1478198766708374, 'eval_f1': 0.8467153284671532, 'eval_accuracy': 0.7375, 'eval_kappa': 0.04328018223234642, 'eval_precision': 0.7435897435897436, 'eval_recall': 0.9830508474576272, 'eval_optim_threshold': 0.8701655268669128, 'eval_AP': 0.8529921291668265, 'eval_MCC': 0.08643420548400696, 'eval_NDCG': 0.9657899433070265, 'eval_runtime': 4.0578, 'eval_samples_per_second': 19.715, 'eval_steps_per_second': 0.986, 'epoch': 5.0}
2025-06-19 09:35:21,257 - INFO - Cleaning up trial 1785cd66
2025-06-19 09:35:21,258 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-19_09-32-05/trainable_1785cd66_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-19_09-32-13
2025-06-19 09:35:21,258 - INFO - Current best: 6eb4c7e3 with eval_f1 : 0.8489208633093526 at iteration 1
[36m(trainable pid=2484028)[0m 2025-06-19 09:35:21,235 - INFO - Cleared CUDA cache. Memory allocated: 1.33 GB, Memory reserved: 1.63 GB
[36m(trainable pid=2483822)[0m 2025-06-19 09:35:27,896 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=2483822)[0m 2025-06-19 09:35:27,901 - INFO - eval_result: {'eval_loss': 2.0448336601257324, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.7304458022117615, 'eval_AP': 0.7853430875161316, 'eval_MCC': 0.0, 'eval_NDCG': 0.904994845561701, 'eval_runtime': 3.4679, 'eval_samples_per_second': 23.069, 'eval_steps_per_second': 1.153, 'epoch': 6.0}
2025-06-19 09:35:28,249 - INFO - Cleaning up trial 8f41a214
2025-06-19 09:35:28,249 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-19_09-32-05/trainable_8f41a214_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-19_09-32-06
2025-06-19 09:35:28,249 - INFO - Cleaning up trial 1785cd66
2025-06-19 09:35:28,249 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-19_09-32-05/trainable_1785cd66_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-19_09-32-13
2025-06-19 09:35:28,249 - INFO - Current best: 6eb4c7e3 with eval_f1 : 0.8489208633093526 at iteration 1
2025-06-19 09:35:28,255	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-19_09-32-05' in 0.0047s.

[36m(trainable pid=2484028)[0m {'loss': 0.5757, 'grad_norm': 17.084922790527344, 'learning_rate': 0.0, 'epoch': 5.0}
[36m(trainable pid=2484028)[0m {'train_runtime': 171.1477, 'train_samples_per_second': 21.502, 'train_steps_per_second': 0.876, 'train_loss': 0.8316711934407552, 'epoch': 5.0}
[36m(trainable pid=2484028)[0m STATE at ending of training  :  TrainerState(epoch=5.0, global_step=150, max_steps=150, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=25, num_train_epochs=5, num_input_tokens_seen=0, total_flos=966321660618882.0, log_history=[{'loss': 1.2608, 'grad_norm': 12.946150779724121, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0, 'step': 30}, {'loss': 0.9479, 'grad_norm': 19.836685180664062, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0, 'step': 60}, {'loss': 0.7422, 'grad_norm': 13.731138229370117, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0, 'step': 90}, {'loss': 0.6317, 'grad_norm': 7.491095542907715, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0, 'step': 120}, {'loss': 0.5757, 'grad_norm': 17.084922790527344, 'learning_rate': 0.0, 'epoch': 5.0, 'step': 150}, {'train_runtime': 171.1477, 'train_samples_per_second': 21.502, 'train_steps_per_second': 0.876, 'total_flos': 966321660618882.0, 'train_loss': 0.8316711934407552, 'epoch': 5.0, 'step': 150}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=2484028)[0m {'eval_loss': 1.1478198766708374, 'eval_f1': 0.8467153284671532, 'eval_accuracy': 0.7375, 'eval_kappa': 0.04328018223234642, 'eval_precision': 0.7435897435897436, 'eval_recall': 0.9830508474576272, 'eval_optim_threshold': 0.8701655268669128, 'eval_AP': 0.8529921291668265, 'eval_MCC': 0.08643420548400696, 'eval_NDCG': 0.9657899433070265, 'eval_runtime': 4.0578, 'eval_samples_per_second': 19.715, 'eval_steps_per_second': 0.986, 'epoch': 5.0}

Trial trainable_1785cd66 finished iteration 1 at 2025-06-19 09:35:21. Total running time: 3min 14s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_1785cd66 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                     180.94 â”‚
â”‚ time_total_s                         180.94 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     5 â”‚
â”‚ eval_AP                             0.85299 â”‚
â”‚ eval_MCC                            0.08643 â”‚
â”‚ eval_NDCG                           0.96579 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84672 â”‚
â”‚ eval_kappa                          0.04328 â”‚
â”‚ eval_loss                           1.14782 â”‚
â”‚ eval_optim_threshold                0.87017 â”‚
â”‚ eval_precision                      0.74359 â”‚
â”‚ eval_recall                         0.98305 â”‚
â”‚ eval_runtime                         4.0578 â”‚
â”‚ eval_samples_per_second              19.715 â”‚
â”‚ eval_steps_per_second                 0.986 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_1785cd66 completed after 1 iterations at 2025-06-19 09:35:21. Total running time: 3min 14s
[36m(trainable pid=2483822)[0m STATE at ending of training  :  TrainerState(epoch=6.0, global_step=180, max_steps=180, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=25, num_train_epochs=6, num_input_tokens_seen=0, total_flos=1158762030870894.0, log_history=[{'loss': 1.4917, 'grad_norm': 14.187821388244629, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0, 'step': 30}, {'loss': 1.4161, 'grad_norm': 15.632628440856934, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0, 'step': 60}, {'loss': 1.3497, 'grad_norm': 16.711301803588867, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0, 'step': 90}, {'loss': 1.2976, 'grad_norm': 9.711115837097168, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0, 'step': 120}, {'loss': 1.2549, 'grad_norm': 9.92264175415039, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0, 'step': 150}, {'loss': 1.2337, 'grad_norm': 10.666271209716797, 'learning_rate': 0.0, 'epoch': 6.0, 'step': 180}, {'train_runtime': 186.2942, 'train_samples_per_second': 23.704, 'train_steps_per_second': 0.966, 'total_flos': 1158762030870894.0, 'train_loss': 1.340623876783583, 'epoch': 6.0, 'step': 180}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=2483822)[0m {'loss': 1.2337, 'grad_norm': 10.666271209716797, 'learning_rate': 0.0, 'epoch': 6.0}
[36m(trainable pid=2483822)[0m {'train_runtime': 186.2942, 'train_samples_per_second': 23.704, 'train_steps_per_second': 0.966, 'train_loss': 1.340623876783583, 'epoch': 6.0}
[36m(trainable pid=2483822)[0m {'eval_loss': 2.0448336601257324, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.7304458022117615, 'eval_AP': 0.7853430875161316, 'eval_MCC': 0.0, 'eval_NDCG': 0.904994845561701, 'eval_runtime': 3.4679, 'eval_samples_per_second': 23.069, 'eval_steps_per_second': 1.153, 'epoch': 6.0}

Trial trainable_8f41a214 finished iteration 1 at 2025-06-19 09:35:28. Total running time: 3min 21s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_8f41a214 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    194.554 â”‚
â”‚ time_total_s                        194.554 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     6 â”‚
â”‚ eval_AP                             0.78534 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.90499 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           2.04483 â”‚
â”‚ eval_optim_threshold                0.73045 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.4679 â”‚
â”‚ eval_samples_per_second              23.069 â”‚
â”‚ eval_steps_per_second                 1.153 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_8f41a214 completed after 1 iterations at 2025-06-19 09:35:28. Total running time: 3min 21s

Trial status: 3 TERMINATED
Current time: 2025-06-19 09:35:28. Total running time: 3min 21s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_8f41a214   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1           194.554        2.04483    0.848921            0.7375      0         â”‚
â”‚ trainable_1785cd66   TERMINATED        6.09408       4.55539e-06         0.123031                    5        1           180.94         1.14782    0.846715            0.7375      0.0432802 â”‚
â”‚ trainable_6eb4c7e3   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            49.0912       1.04994    0.848921            0.7375      0         â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯2025-06-19 09:35:28,262 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x72c3664129d0>
2025-06-19 09:35:28,262 - INFO - Best trial : trainable_8f41a214
2025-06-19 09:35:28,262 - INFO - Best config : {'pos_weight': 6.828424226204718, 'learning_rate': 1.4956066518424355e-06, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 6}
2025-06-19 09:35:28,262 - INFO - Best trial after optimization: {'eval_loss': 2.0448336601257324, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.7304458022117615, 'eval_AP': 0.7853430875161316, 'eval_MCC': 0.0, 'eval_NDCG': 0.904994845561701, 'eval_runtime': 3.4679, 'eval_samples_per_second': 23.069, 'eval_steps_per_second': 1.153, 'epoch': 6.0, 'timestamp': 1750318528, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '8f41a214', 'date': '2025-06-19_09-35-28', 'time_this_iter_s': 194.55398416519165, 'time_total_s': 194.55398416519165, 'pid': 2483822, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 6.828424226204718, 'learning_rate': 1.4956066518424355e-06, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 6}, 'time_since_restore': 194.55398416519165, 'iterations_since_restore': 1, 'experiment_tag': '1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364'}
2025-06-19 09:35:28,291 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   2.044834  0.848921  ...                        6  8f41a214
1   1.147820  0.846715  ...                        5  1785cd66
2   1.049939  0.848921  ...                        3  6eb4c7e3

[3 rows x 32 columns]
[36m(trainable pid=2483822)[0m 2025-06-19 09:35:28,226 - INFO - Cleared CUDA cache. Memory allocated: 1.33 GB, Memory reserved: 1.63 GB
2025-06-19 09:35:28,493 - INFO - Trial comparison plot saved
2025-06-19 09:35:28,503 - INFO - Best Hyperparameters after HPO : {'pos_weight': 6.828424226204718, 'learning_rate': 1.4956066518424355e-06, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 6}


2025-06-19 09:35:38,249 - INFO - Randomness sources seeded with 42 for reproducibility.
2025-06-19 09:35:38,250 - INFO - Random seeds set to 42
2025-06-19 09:35:38,250 - INFO - Namespace(config='configs/train.yaml', hp_config='configs/best_hpo.yaml', fold=0, run=0, gpu='2', model_name='microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext', nb_opt_negs=500, loss='BCE', with_title=True, with_keywords=False, best_metric='eval_f1')
2025-06-19 09:35:38,252 - INFO - {'model_name': 'bert-base-uncased', 'fold': 0, 'run': 0, 'output_dir': 'outputs/checkpoints', 'best_metric': 'eval_kappa', 'loss_type': 'BCE', 'nb_optional_negs': 100, 'with_title': True, 'with_keywords': False, 'default_hyperparameters': {'learning_rate': 'None', 'num_train_epochs': 'None', 'pos_weight': 'None', 'weight_decay': 'None'}}
2025-06-19 09:35:39,063 - INFO - train split size : 736
2025-06-19 09:35:39,064 - INFO - dev split size : 80
2025-06-19 09:35:39,064 - INFO - test split size : 80
2025-06-19 09:35:39,315 - INFO - 3 datasets tokenized successfully
2025-06-19 09:35:39,316 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-19 09:35:40,156 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
[2025-06-19 09:35:40,417] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-06-19 09:35:43,308] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
2025-06-19 09:35:43,347 - INFO - training size : 736
2025-06-19 09:35:43,347 - INFO - dev size : 80
2025-06-19 09:35:43,347 - INFO - test size : 80
  0%|          | 0/48 [00:00<?, ?it/s]  2%|â–         | 1/48 [00:02<01:48,  2.31s/it]  4%|â–         | 2/48 [00:04<01:33,  2.02s/it]  6%|â–‹         | 3/48 [00:05<01:26,  1.92s/it]  8%|â–Š         | 4/48 [00:07<01:22,  1.88s/it] 10%|â–ˆ         | 5/48 [00:09<01:19,  1.86s/it] 12%|â–ˆâ–Ž        | 6/48 [00:11<01:17,  1.85s/it] 15%|â–ˆâ–        | 7/48 [00:13<01:14,  1.82s/it] 17%|â–ˆâ–‹        | 8/48 [00:13<00:57,  1.45s/it]                                               17%|â–ˆâ–‹        | 8/48 [00:13<00:57,  1.45s/it] 19%|â–ˆâ–‰        | 9/48 [00:15<01:01,  1.58s/it] 21%|â–ˆâ–ˆ        | 10/48 [00:17<01:02,  1.65s/it] 23%|â–ˆâ–ˆâ–Ž       | 11/48 [00:19<01:02,  1.70s/it] 25%|â–ˆâ–ˆâ–Œ       | 12/48 [00:21<01:02,  1.73s/it] 27%|â–ˆâ–ˆâ–‹       | 13/48 [00:22<01:01,  1.76s/it] 29%|â–ˆâ–ˆâ–‰       | 14/48 [00:24<01:00,  1.77s/it] 31%|â–ˆâ–ˆâ–ˆâ–      | 15/48 [00:26<00:58,  1.77s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 16/48 [00:27<00:45,  1.43s/it]                                                33%|â–ˆâ–ˆâ–ˆâ–Ž      | 16/48 [00:27<00:45,  1.43s/it] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 17/48 [00:29<00:48,  1.57s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 18/48 [00:30<00:49,  1.64s/it] 40%|â–ˆâ–ˆâ–ˆâ–‰      | 19/48 [00:32<00:49,  1.70s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 20/48 [00:34<00:48,  1.74s/it] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/48 [00:36<00:47,  1.76s/it] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 22/48 [00:38<00:46,  1.78s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 23/48 [00:39<00:44,  1.78s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 24/48 [00:40<00:34,  1.44s/it]                                                50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 24/48 [00:40<00:34,  1.44s/it] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 25/48 [00:42<00:36,  1.58s/it] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/48 [00:44<00:36,  1.66s/it] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 27/48 [00:46<00:35,  1.71s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 28/48 [00:48<00:34,  1.75s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 29/48 [00:49<00:33,  1.77s/it] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 30/48 [00:51<00:32,  1.79s/it] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/48 [00:53<00:30,  1.79s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 32/48 [00:54<00:23,  1.45s/it]                                                67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 32/48 [00:54<00:23,  1.45s/it] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 33/48 [00:56<00:23,  1.58s/it] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 34/48 [00:57<00:23,  1.66s/it] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 35/48 [00:59<00:22,  1.71s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 36/48 [01:01<00:20,  1.75s/it] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 37/48 [01:03<00:19,  1.77s/it] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 38/48 [01:05<00:17,  1.79s/it] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 39/48 [01:06<00:16,  1.79s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 40/48 [01:07<00:11,  1.45s/it]                                                83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 40/48 [01:07<00:11,  1.45s/it] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 41/48 [01:09<00:11,  1.59s/it] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 42/48 [01:11<00:10,  1.67s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 43/48 [01:13<00:08,  1.72s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 44/48 [01:15<00:07,  1.75s/it] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 45/48 [01:16<00:05,  1.78s/it] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 46/48 [01:18<00:03,  1.80s/it] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 47/48 [01:20<00:01,  1.80s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 48/48 [01:21<00:00,  1.45s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 48/48 [01:23<00:00,  1.45s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 48/48 [01:23<00:00,  1.45s/it]2025-06-19 09:37:06,815 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 48/48 [01:23<00:00,  1.73s/it]
{'loss': 1.549, 'grad_norm': 7.909111499786377, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}
{'loss': 1.5255, 'grad_norm': 12.259493827819824, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0}
{'loss': 1.4706, 'grad_norm': 6.561932563781738, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0}
{'loss': 1.4408, 'grad_norm': 4.870361328125, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0}
{'loss': 1.4273, 'grad_norm': 7.637372970581055, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0}
{'loss': 1.4258, 'grad_norm': 7.006629943847656, 'learning_rate': 0.0, 'epoch': 6.0}
{'train_runtime': 83.0555, 'train_samples_per_second': 53.169, 'train_steps_per_second': 0.578, 'train_loss': 1.4731699228286743, 'epoch': 6.0}
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-19 09:37:10,201 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.87s/it]
2025-06-19 09:37:10,208 - INFO - Training time : 90.89180859003682
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-19 09:37:13,478 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.75s/it]
2025-06-19 09:37:13,483 - INFO - Evaluation time : 3.2749972119927406
2025-06-19 09:37:13,483 - INFO - Evaluation results on test set: {'eval_loss': 2.0960237979888916, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.692460298538208, 'eval_AP': 0.8146757491093852, 'eval_MCC': 0.0, 'eval_NDCG': 0.9376039648563368, 'eval_runtime': 3.2626, 'eval_samples_per_second': 24.52, 'eval_steps_per_second': 0.307, 'epoch': 6.0}
2025-06-19 09:37:13,483 - INFO - Total updates (optimizer steps): 48
2025-06-19 09:37:13,483 - INFO - Avg time / step: 1.730s
2025-06-19 09:37:14,678 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCE_BiomedBERT-abs-ft_fold-1
2025-06-19 09:37:14,679 - INFO - On test Set (with threshold 0.5) : 
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-19 09:37:17,979 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.76s/it]
2025-06-19 09:37:17,983 - INFO - Raw predictions shape: (80, 1)
2025-06-19 09:37:17,983 - INFO - Raw predictions: [[1.0952454 ]
 [0.9644824 ]
 [0.33647826]
 [0.97182345]
 [0.9602418 ]
 [0.8864292 ]
 [0.819451  ]
 [0.83076143]
 [0.8909363 ]
 [0.71084154]]
2025-06-19 09:37:17,983 - INFO - Scores shape: (80,)
2025-06-19 09:37:17,983 - INFO - Scores: [0.7493682  0.7240184  0.5833348  0.72548276 0.7231702  0.7081527
 0.69411975 0.6965159  0.7090834  0.67058706]
2025-06-19 09:37:17,983 - INFO - Preds shape: (80,)
2025-06-19 09:37:17,983 - INFO - Preds: [1 1 1 1 1 1 1 1 1 1]
2025-06-19 09:37:17,984 - INFO - Test labels shape: (80,)
2025-06-19 09:37:17,984 - INFO - Test labels: [1, 1, 0, 0, 1, 1, 1, 1, 0, 0]
2025-06-19 09:37:17,984 - INFO - Test split: Dataset({
    features: ['Unnamed: 0', 'title', 'abstract', 'Keywords', 'doi', 'labels'],
    num_rows: 80
})
2025-06-19 09:37:17,984 - INFO - Unique values in predictions: [1]
2025-06-19 09:37:17,984 - INFO - Unique values in labels: [0 1]
2025-06-19 09:37:17,985 - INFO - Confusion matrix:
[[ 0 21]
 [ 0 59]]
2025-06-19 09:37:17,986 - INFO - Confusion matrix: TN=0, FP=21, FN=0, TP=59
2025-06-19 09:37:20,649 - INFO - Metrics: {'f1': 0.8489208633093526, 'recall': 1.0, 'precision': 0.7375, 'accuracy': 0.7375, 'AP': 0.8146757491093852, 'MCC': 0.0, 'NDCG': 0.9376039648563368, 'kappa': 0.0, 'TN': 0, 'FP': 21, 'FN': 0, 'TP': 59}
2025-06-19 09:37:20,762 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-19 09:37:20,856 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-19 09:37:20,856 - INFO - 
On test Set (optimal threshold of 0.7065275311470032 according to cross validation on the training set): 
2025-06-19 09:37:20,857 - INFO - Confusion matrix: TN=15, FP=6, FN=31, TP=28
2025-06-19 09:37:23,661 - INFO - Metrics: {'f1': 0.6021505376344086, 'recall': 0.4745762711864407, 'precision': 0.8235294117647058, 'accuracy': 0.5375, 'AP': 0.8146757491093852, 'MCC': 0.1680977226904373, 'NDCG': 0.9376039648563368, 'kappa': 0.1365227537922986, 'TN': 15, 'FP': 6, 'FN': 31, 'TP': 28}
2025-06-19 09:37:23,756 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-19 09:37:23,757 - INFO - Results for fold 1 with optim_threshold leqrned from dev set : {'f1': 0.6021505376344086, 'recall': 0.4745762711864407, 'precision': 0.8235294117647058, 'accuracy': 0.5375, 'AP': 0.8146757491093852, 'MCC': 0.1680977226904373, 'NDCG': 0.9376039648563368, 'kappa': 0.1365227537922986, 'TN': 15, 'FP': 6, 'FN': 31, 'TP': 28}
2025-06-19 09:37:24,097 - INFO - Cleared CUDA cache. Memory allocated: 1.33 GB, Memory reserved: 1.63 GB
2025-06-19 09:37:24,103 - INFO - Metrics stored successfully at /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/metrics/binary_metrics.csv
Model: FacebookAI/roberta-base
2025-06-19 09:37:32,265 - INFO - Randomness sources seeded with 42 for reproducibility.
2025-06-19 09:37:32,266 - INFO - Random seeds set to 42
2025-06-19 09:37:32,266 - INFO - Namespace(config='configs/hpo.yaml', fold=0, run=0, gpu=None, model_name='FacebookAI/roberta-base', nb_opt_negs=500, n_trials=3, hpo_metric='eval_f1', direction=None, loss='BCE', with_title=True, with_keywords=False)
2025-06-19 09:37:32,267 - INFO - {'model_name': 'google-bert/bert-base-uncased', 'num_trials': 20, 'fold': 0, 'hpo_metric': 'eval_kappa', 'direction': 'max', 'loss_type': 'BCE', 'with_title': True, 'with_keywords': False, 'nb_optional_negs': 100}
2025-06-19 09:37:32,817 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
2025-06-19 09:37:32,818 - INFO - 
fold number 1 | run no. 1
2025-06-19 09:37:33,418 - INFO - train split size : 736
2025-06-19 09:37:33,419 - INFO - dev split size : 80
2025-06-19 09:37:33,419 - INFO - test split size : 80
Map (num_proc=32):   0%|          | 0/736 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 23/736 [00:00<00:08, 84.67 examples/s]Map (num_proc=32):  16%|â–ˆâ–Œ        | 115/736 [00:00<00:01, 338.34 examples/s]Map (num_proc=32):  25%|â–ˆâ–ˆâ–Œ       | 184/736 [00:00<00:01, 412.74 examples/s]Map (num_proc=32):  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 299/736 [00:00<00:00, 609.24 examples/s]Map (num_proc=32):  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 391/736 [00:00<00:00, 632.82 examples/s]Map (num_proc=32):  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 483/736 [00:00<00:00, 619.01 examples/s]Map (num_proc=32):  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 575/736 [00:01<00:00, 691.81 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 667/736 [00:01<00:00, 703.53 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 736/736 [00:01<00:00, 556.56 examples/s]
Map (num_proc=32):   0%|          | 0/80 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/80 [00:00<00:05, 13.76 examples/s]Map (num_proc=32):  19%|â–ˆâ–‰        | 15/80 [00:00<00:01, 51.08 examples/s]Map (num_proc=32):  34%|â–ˆâ–ˆâ–ˆâ–      | 27/80 [00:00<00:00, 68.04 examples/s]Map (num_proc=32):  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 39/80 [00:00<00:00, 78.64 examples/s]Map (num_proc=32):  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 52/80 [00:00<00:00, 80.82 examples/s]Map (num_proc=32):  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 62/80 [00:00<00:00, 75.66 examples/s]Map (num_proc=32):  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 70/80 [00:00<00:00, 76.38 examples/s]Map (num_proc=32):  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 78/80 [00:01<00:00, 69.47 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 80/80 [00:01<00:00, 64.68 examples/s]
Map (num_proc=32):   0%|          | 0/80 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/80 [00:00<00:05, 14.96 examples/s]Map (num_proc=32):  19%|â–ˆâ–‰        | 15/80 [00:00<00:01, 49.42 examples/s]Map (num_proc=32):  34%|â–ˆâ–ˆâ–ˆâ–      | 27/80 [00:00<00:00, 65.40 examples/s]Map (num_proc=32):  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 36/80 [00:00<00:00, 68.56 examples/s]Map (num_proc=32):  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 48/80 [00:00<00:00, 82.30 examples/s]Map (num_proc=32):  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 58/80 [00:00<00:00, 81.53 examples/s]Map (num_proc=32):  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 68/80 [00:01<00:00, 69.68 examples/s]Map (num_proc=32):  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 78/80 [00:01<00:00, 72.36 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 80/80 [00:01<00:00, 64.34 examples/s]
2025-06-19 09:37:38,673 - INFO - 3 datasets tokenized successfully
2025-06-19 09:37:38,794 - INFO - Fold 1 max seq len = 512
2025-06-19 09:37:38,795 - INFO - Starting hyperparameter search for BCE loss
2025-06-19 09:37:40,144	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
2025-06-19 09:37:40,914	INFO tune.py:253 -- Initializing Ray automatically. For cluster usage or custom Ray initialization, call `ray.init(...)` before `tune.run(...)`.
[36m(trainable pid=2491170)[0m 2025-06-19 09:37:49,368 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
[36m(trainable pid=2491170)[0m Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at FacebookAI/roberta-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
[36m(trainable pid=2491170)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=2491170)[0m 2025-06-19 09:37:49,676 - INFO - Trial on GPU 0 using batch size 25
[36m(trainable pid=2491170)[0m 2025-06-19 09:37:49,822 - INFO - pos_weight value in TrainingArguments : 6.828424226204718
[36m(trainable pid=2491170)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=2491170)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=2491372)[0m 2025-06-19 09:37:56,103 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
[36m(trainable pid=2491372)[0m Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at FacebookAI/roberta-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
[36m(trainable pid=2491372)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=2491372)[0m 2025-06-19 09:37:56,331 - INFO - Trial on GPU 1 using batch size 25
[36m(trainable pid=2491372)[0m 2025-06-19 09:37:56,487 - INFO - pos_weight value in TrainingArguments : 6.094080202241274
[36m(trainable pid=2491372)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=2491372)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=2491830)[0m 2025-06-19 09:38:02,698 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
[36m(trainable pid=2491830)[0m Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at FacebookAI/roberta-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
[36m(trainable pid=2491830)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=2491830)[0m 2025-06-19 09:38:02,928 - INFO - Trial on GPU 2 using batch size 100
[36m(trainable pid=2491830)[0m 2025-06-19 09:38:03,062 - INFO - pos_weight value in TrainingArguments : 7.183206941666034
[36m(trainable pid=2491830)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=2491830)[0m   super().__init__(*args, **kwargs)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     trainable_2025-06-19_09-37-40   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-19_09-37-40
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-19_09-37-38_819980_2488304/artifacts/2025-06-19_09-37-40/trainable_2025-06-19_09-37-40/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-19 09:37:42. Total running time: 0s
Logical resource usage: 0/32 CPUs, 0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_36593aee   PENDING         6.82842       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_36593aee started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_36593aee config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          6.82842 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=2491170)[0m [2025-06-19 09:37:50,084] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=2491170)[0m [2025-06-19 09:37:52,766] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=2491170)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=180, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=25, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial trainable_8ca320d6 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_8ca320d6 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          6.09408 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=2491372)[0m [2025-06-19 09:37:56,924] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=2491372)[0m [2025-06-19 09:37:59,750] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=2491372)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=150, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=25, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial trainable_54361564 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_54361564 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          7.18321 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=2491830)[0m [2025-06-19 09:38:03,325] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=2491830)[0m [2025-06-19 09:38:05,980] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=2491830)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=24, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=100, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 3 RUNNING
Current time: 2025-06-19 09:38:12. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_36593aee   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ trainable_8ca320d6   RUNNING         6.09408       4.55539e-06         0.123031                    5 â”‚
â”‚ trainable_54361564   RUNNING         7.18321       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯