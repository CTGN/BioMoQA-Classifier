2025-06-04 18:54:37,457	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
2025-06-04 18:54:38,213 - INFO - Random seeds set to 42
2025-06-04 18:54:38,318 - INFO - Optional negatives loaded from CSV with 5000 entries.
2025-06-04 18:54:38,318 - INFO - Loading original negatives...
2025-06-04 18:54:38,327 - INFO - Negatives column names: ['Article ID', 'Title', 'Author', 'Publication year', 'Title secondary', 'URL', 'DOI', 'Abstract', 'Criteria for exclusion A', ' Criteria for exclusion B', ' Criteria for exclusion C', 'labels', 'Keywords']
2025-06-04 18:54:38,328 - INFO - Loading original positives...
2025-06-04 18:54:38,345 - INFO - Positives column names: ['Article ID', 'Title', 'Author', 'Secondary authors', 'Keywords', 'title of unpublished reference', 'primary date', 'publication year', 'notes', 'reprint status', 'start page number', 'ending page number', 'periodical full name', 'periodical standard abbreviation', 'periodical in which article was published', 'periodical name - user abbreviation 1', 'periodical name - user abbreviation 2', 'volume number', 'issue number', 'title secondary', 'city of publication', 'publisher', 'user definable 1', 'user definable 5', 'title series', 'Abstract', 'ISSN/ISBN', 'availability', 'Misc. 1', 'Misc. 2', 'address', 'Web/URL', 'link to PDF', 'link to full-text', 'related records', 'images', 'DOI', 'labels']
2025-06-04 18:54:38,351 - INFO - Class balance:
labels
1    326
0    123
Name: count, dtype: int64
2025-06-04 18:54:38,351 - INFO -    Article ID  ...  Criteria for exclusion C
0       12959  ...                       NaN
1       13470  ...                       NaN
2        4686  ...                       NaN
3        2503  ...                       NaN
4        2951  ...                       NaN

[5 rows x 44 columns]
2025-06-04 18:54:38,377 - INFO - Original dataset size: 449
2025-06-04 18:54:38,377 - INFO - Optional negatives size: 5000
2025-06-04 18:54:38,382 - INFO - Optional negatives:                                                title  ... labels
0  Towards evidence-based conservation of subterr...  ...     -1
1                  Marine biodiversity conservation.  ...     -1
2  Climate teleconnections modulate global burned...  ...     -1
3  Integrating carbon sequestration and biodivers...  ...     -1
4  Principle, technique and application of grassl...  ...     -1

[5 rows x 7 columns]
2025-06-04 18:54:38,386 - INFO - Combined dataset size: 449
2025-06-04 18:54:38,390 - INFO -                                                title  ... labels
0  Feral pig (Sus scrofa) disturbance facilitates...  ...      1
1  Effects of woody plant diversity on abovegroun...  ...      1
2  Scaling species richness and endemism of tropi...  ...      1
3  Not as the crow flies: Assessing effective iso...  ...      0
4  Species-group concepts and biogeography of the...  ...      1

[5 rows x 5 columns]
2025-06-04 18:54:38,391 - INFO - title        0
abstract     0
Keywords     8
doi         36
labels       0
dtype: int64
2025-06-04 18:54:38,393 - INFO - Total duplicate abstracts: 0
2025-06-04 18:54:38,394 - INFO - Empty DataFrame
Columns: [abstract, labels, Keywords]
Index: []
2025-06-04 18:54:38,396 - INFO - Abstracts appearing in both classes: 0
2025-06-04 18:54:38,397 - INFO - Empty DataFrame
Columns: [title, labels]
Index: []
2025-06-04 18:54:38,398 - INFO - Total duplicate abstracts: 0
2025-06-04 18:54:38,399 - INFO - Empty DataFrame
Columns: [abstract, labels, Keywords]
Index: []
2025-06-04 18:54:38,405 - INFO - Abstracts appearing in both classes: 0
2025-06-04 18:54:38,405 - INFO - Empty DataFrame
Columns: [abstract, labels]
Index: []
2025-06-04 18:54:38,406 - INFO - Total duplicate abstracts: 18
2025-06-04 18:54:38,411 - INFO -                                               abstract  ...                                           Keywords
147  1. How could identical species appear in widel...  ...                                                   
253  Aims\r\n Developing plant conservation strateg...  ...  AFLP; genetic diversity; Indian Ocean; limited...
206  Aims Developing plant conservation strategies ...  ...  AFLP; Genetic diversity; Indian Ocean; Limited...
217  Coastal lagoons are considered one of the most...  ...                                                   
213  Coastal lagoons are considered one of the most...  ...                                                   
21   Distribution patterns of indigenous non-volant...  ...  Australian islands; Extreme-value function; Is...
300  Distribution patterns of indigenous non-volant...  ...  island mammals; Australian islands; species-ar...
197  Invasive plant species pose serious threats to...  ...                                                   
35   Island bat species are disproportionately at r...  ...  Hawaiian hoary bat; Hawai?i; Population geneti...
157  Island bat species are disproportionately at r...  ...  Bats; Endangered species; Hawai<sup>â€˜</sup>i; ...
126  Islands are hotspots of biodiversity and extin...  ...  Deforestation; Endemicity; Extinction; Island ...
276  Islands are hotspots of biodiversity and extin...  ...  Deforestation; Endemicity; Extinction; Island ...
364  KELLY, A. B. (Department of Environmental Scie...  ...                                                   
329  Summary o 1. How could identical species appea...  ...                                                   
278  The Galapagos Islands are recognized for their...  ...                                                   
149  The GalÃ¡pagos Islands are recognized for their...  ...                                                   
313  Working in the Galapagos Islands and surroundi...  ...                                                   
280  Working in the GalÃ¡pagos Islands and surroundi...  ...                                                   

[18 rows x 3 columns]
2025-06-04 18:54:38,413 - INFO - Abstracts appearing in both classes: 0
2025-06-04 18:54:38,413 - INFO - Empty DataFrame
Columns: [doi, labels]
Index: []
2025-06-04 18:54:38,692 - INFO - Cleaned dataset size: 397
2025-06-04 18:54:38,693 - INFO - Numnber of positives : 293
2025-06-04 18:54:38,694 - INFO - Numnber of negatives : 104
2025-06-04 18:54:38,694 - INFO - clean_og_df indices : RangeIndex(start=0, stop=397, step=1)
2025-06-04 18:54:38,694 - INFO - opt_neg_df indices : Index([], dtype='int64')
2025-06-04 18:54:38,699 - INFO - Fold 1:
2025-06-04 18:54:38,699 - INFO -   Train label distribution: {1: 0.7373737373737373, 0: 0.26262626262626265}
2025-06-04 18:54:38,699 - INFO -   Test label distribution: {1: 0.7368421052631579, 0: 0.2631578947368421}
2025-06-04 18:54:38,702 - INFO - Fold 2:
2025-06-04 18:54:38,702 - INFO -   Train label distribution: {1: 0.7373737373737373, 0: 0.26262626262626265}
2025-06-04 18:54:38,702 - INFO -   Test label distribution: {1: 0.7424242424242424, 0: 0.25757575757575757}
2025-06-04 18:54:38,704 - INFO - Fold 3:
2025-06-04 18:54:38,704 - INFO -   Train label distribution: {1: 0.7373737373737373, 0: 0.26262626262626265}
2025-06-04 18:54:38,705 - INFO -   Test label distribution: {1: 0.7348484848484849, 0: 0.26515151515151514}
2025-06-04 18:54:38,708 - INFO - Fold 1:
2025-06-04 18:54:38,708 - INFO -   Train label distribution: {1: 0.7373737373737373, 0: 0.26262626262626265}
2025-06-04 18:54:38,708 - INFO -   Test label distribution: {1: 0.7368421052631579, 0: 0.2631578947368421}
2025-06-04 18:54:38,710 - INFO - Fold 2:
2025-06-04 18:54:38,710 - INFO -   Train label distribution: {1: 0.7373737373737373, 0: 0.26262626262626265}
2025-06-04 18:54:38,710 - INFO -   Test label distribution: {1: 0.7424242424242424, 0: 0.25757575757575757}
2025-06-04 18:54:38,713 - INFO - Fold 3:
2025-06-04 18:54:38,713 - INFO -   Train label distribution: {1: 0.7373737373737373, 0: 0.26262626262626265}
2025-06-04 18:54:38,713 - INFO -   Test label distribution: {1: 0.7348484848484849, 0: 0.26515151515151514}
Stringifying the column:   0%|          | 0/397 [00:00<?, ? examples/s]Stringifying the column: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 397/397 [00:00<00:00, 79364.12 examples/s]
Casting to class labels:   0%|          | 0/397 [00:00<?, ? examples/s]Casting to class labels: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 397/397 [00:00<00:00, 90867.05 examples/s]
2025-06-04 18:54:38,741 - INFO - Number of positives : 293
2025-06-04 18:54:38,741 - INFO - Number of negatives : 104
2025-06-04 18:54:38,745 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 18:54:41,955 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': 0.7368421052631579, 'MCC': 0.0, 'NDCG': 0.9189307109272616, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 18:54:41,957 - INFO - Confusion matrix: TN=35, FP=0, FN=98, TP=0
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-06-04 18:54:45,271 - INFO - Metrics: {'f1': 0.0, 'recall': 0.0, 'precision': 0.0, 'accuracy': 0.2631578947368421, 'AP': 0.7368421052631579, 'MCC': 0.0, 'NDCG': 0.9189307109272616, 'kappa': 0.0, 'TN': 35, 'FP': 0, 'FN': 98, 'TP': 0}
2025-06-04 18:54:45,275 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 18:54:48,079 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': 0.7424242424242424, 'MCC': 0.0, 'NDCG': 0.9208012714375936, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 18:54:48,082 - INFO - Confusion matrix: TN=34, FP=0, FN=98, TP=0
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-06-04 18:54:51,045 - INFO - Metrics: {'f1': 0.0, 'recall': 0.0, 'precision': 0.0, 'accuracy': 0.25757575757575757, 'AP': 0.7424242424242424, 'MCC': 0.0, 'NDCG': 0.9208012714375936, 'kappa': 0.0, 'TN': 34, 'FP': 0, 'FN': 98, 'TP': 0}
2025-06-04 18:54:51,050 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 18:54:54,277 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': 0.7348484848484849, 'MCC': 0.0, 'NDCG': 0.9181159076123374, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 18:54:54,279 - INFO - Confusion matrix: TN=35, FP=0, FN=97, TP=0
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-06-04 18:54:57,055 - INFO - Metrics: {'f1': 0.0, 'recall': 0.0, 'precision': 0.0, 'accuracy': 0.26515151515151514, 'AP': 0.7348484848484849, 'MCC': 0.0, 'NDCG': 0.9181159076123374, 'kappa': 0.0, 'TN': 35, 'FP': 0, 'FN': 97, 'TP': 0}
2025-06-04 18:54:57,058 - INFO - Pipeline for loss type None and ensemble=True
2025-06-04 18:54:57,058 - INFO - with_title : True
2025-06-04 18:54:57,058 - INFO - with_keywords : True
2025-06-04 18:54:57,058 - INFO - fold indexes for run no.1: [[159, 206, 117, 82, 317, 330, 131, 380, 183, 158, 213, 260, 155, 332, 303, 269, 40, 232, 314, 244, 168, 218, 254, 100, 3, 235, 105, 243, 352, 394, 196, 223, 230, 307, 342, 289, 135, 7, 189, 134, 78, 133, 12, 375, 109, 46, 62, 393, 167, 151, 387, 374, 276, 323, 132, 319, 114, 176, 322, 263, 258, 266, 250, 329, 309, 367, 24, 229, 370, 211, 228, 346, 115, 392, 87, 88, 81, 343, 253, 278, 43, 333, 28, 80, 191, 10, 378, 388, 225, 363, 136, 104, 356, 8, 57, 162, 220, 391, 139, 386, 282, 70, 61, 170, 102, 296, 64, 35, 4, 251, 279, 44, 373, 129, 236, 327, 187, 68, 245, 215, 18, 42, 116, 212, 376, 148, 126, 27, 252, 173, 103, 336, 209, 199, 169, 283, 32, 246, 292, 210, 247, 141, 73, 194, 59, 385, 354, 51, 305, 200, 344, 179, 178, 355, 313, 112, 291, 23, 328, 130, 315, 181, 138, 94, 95, 121, 207, 175, 295, 321, 34, 300, 262, 33, 341, 54, 299, 48, 30, 204, 123, 331, 301, 150, 157, 265, 14, 53, 396, 242, 377, 366, 93, 214, 83, 52, 6, 188], [177, 268, 97, 248, 298, 320, 224, 137, 161, 145, 339, 98, 39, 66, 17, 325, 226, 91, 348, 67, 55, 237, 273, 353, 381, 261, 31, 2, 290, 107, 38, 113, 120, 1, 222, 84, 358, 202, 63, 337, 92, 99, 144, 256, 19, 171, 219, 285, 274, 174, 118, 233, 156, 324, 284, 190, 255, 357, 205, 111, 72, 384, 294, 71, 163, 217], array([  0,   5,   9,  11,  13,  15,  16,  20,  21,  22,  25,  26,  29,
        36,  37,  41,  45,  47,  49,  50,  56,  58,  60,  65,  69,  74,
        75,  76,  77,  79,  85,  86,  89,  90,  96, 101, 106, 108, 110,
       119, 122, 124, 125, 127, 128, 140, 142, 143, 146, 147, 149, 152,
       153, 154, 160, 164, 165, 166, 172, 180, 182, 184, 185, 186, 192,
       193, 195, 197, 198, 201, 203, 208, 216, 221, 227, 231, 234, 238,
       239, 240, 241, 249, 257, 259, 264, 267, 270, 271, 272, 275, 277,
       280, 281, 286, 287, 288, 293, 297, 302, 304, 306, 308, 310, 311,
       312, 316, 318, 326, 334, 335, 338, 340, 345, 347, 349, 350, 351,
       359, 360, 361, 362, 364, 365, 368, 369, 371, 372, 379, 382, 383,
       389, 390, 395])]
2025-06-04 18:54:57,058 - INFO - Run no 1/2
2025-06-04 18:54:57,058 - INFO - Loss Type : BCE
2025-06-04 18:54:57,058 - INFO - Ensemble learning pipeline
2025-06-04 18:54:57,058 - INFO - Training model 1/2: dmis-lab/biobert-v1.1
2025-06-04 18:54:57,256 - INFO - 
fold number 1 / 3
2025-06-04 18:54:57,262 - INFO - train split size : 198
2025-06-04 18:54:57,262 - INFO - dev split size : 66
2025-06-04 18:54:57,262 - INFO - test split size : 133
Map (num_proc=32):   0%|          | 0/198 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–Ž         | 7/198 [00:00<00:03, 56.22 examples/s]Map (num_proc=32):  24%|â–ˆâ–ˆâ–       | 48/198 [00:00<00:00, 235.66 examples/s]Map (num_proc=32):  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 84/198 [00:00<00:00, 268.63 examples/s]Map (num_proc=32):  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 120/198 [00:00<00:00, 286.34 examples/s]Map (num_proc=32):  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 150/198 [00:00<00:00, 287.74 examples/s]Map (num_proc=32):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 186/198 [00:00<00:00, 310.43 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 198/198 [00:00<00:00, 251.92 examples/s]
Map (num_proc=32):   0%|          | 0/66 [00:00<?, ? examples/s]Map (num_proc=32):   5%|â–         | 3/66 [00:00<00:02, 24.85 examples/s]Map (num_proc=32):  18%|â–ˆâ–Š        | 12/66 [00:00<00:00, 59.13 examples/s]Map (num_proc=32):  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 22/66 [00:00<00:00, 74.45 examples/s]Map (num_proc=32):  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 32/66 [00:00<00:00, 80.43 examples/s]Map (num_proc=32):  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 42/66 [00:00<00:00, 85.36 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 52/66 [00:00<00:00, 86.59 examples/s]Map (num_proc=32):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 62/66 [00:00<00:00, 88.69 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 66/66 [00:00<00:00, 73.18 examples/s]
Map (num_proc=32):   0%|          | 0/133 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/133 [00:00<00:03, 42.59 examples/s]Map (num_proc=32):  22%|â–ˆâ–ˆâ–       | 29/133 [00:00<00:00, 132.99 examples/s]Map (num_proc=32):  37%|â–ˆâ–ˆâ–ˆâ–‹      | 49/133 [00:00<00:00, 159.24 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 69/133 [00:00<00:00, 169.09 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 89/133 [00:00<00:00, 176.93 examples/s]Map (num_proc=32):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 109/133 [00:00<00:00, 183.39 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 133/133 [00:00<00:00, 192.33 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 133/133 [00:00<00:00, 153.25 examples/s]
2025-06-04 18:55:01,829 - INFO - 3 datasets tokenized successfully
2025-06-04 18:55:01,831 - INFO - Starting hyperparameter search for BCE loss
[36m(train_hpo pid=3397100)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3397100)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3397100)[0m 2025-06-04 18:55:11,108 - INFO - pos_weight value in TrainingArguments : 8.493688290834637
[36m(train_hpo pid=3397100)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3397100)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3397100)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3397100)[0m   warnings.warn(
[36m(train_hpo pid=3397335)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3397335)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3397335)[0m 2025-06-04 18:55:18,471 - INFO - pos_weight value in TrainingArguments : 7.549531688595925
[36m(train_hpo pid=3397335)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3397335)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3397335)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3397335)[0m   warnings.warn(
[36m(train_hpo pid=3397629)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3397629)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3397629)[0m 2025-06-04 18:55:25,386 - INFO - pos_weight value in TrainingArguments : 8.949837496427758
[36m(train_hpo pid=3397629)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3397629)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3397629)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3397629)[0m   warnings.warn(
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-04_18-55-01   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_18-55-01
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-04_18-54-36_274448_3393636/artifacts/2025-06-04_18-55-01/train_hpo_2025-06-04_18-55-01/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-04 18:55:03. Total running time: 0s
Logical resource usage: 0/32 CPUs, 0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_8eb2c954   PENDING         8.49369       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_8eb2c954 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_8eb2c954 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          8.49369 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3397100)[0m [2025-06-04 18:55:11,364] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3397100)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=12, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_03a65c1b started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_03a65c1b config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          7.54953 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3397335)[0m [2025-06-04 18:55:18,880] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3397100)[0m {'loss': 2.1902, 'grad_norm': 15.119211196899414, 'learning_rate': 1.1217049888818266e-06, 'epoch': 1.0}
[36m(train_hpo pid=3397335)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3397100)[0m {'loss': 2.1074, 'grad_norm': 16.47574806213379, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.0}

Trial train_hpo_b667a208 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_b667a208 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          8.94984 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3397629)[0m [2025-06-04 18:55:25,614] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3397629)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=6, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3397335)[0m {'loss': 2.657, 'grad_norm': 17.892826080322266, 'learning_rate': 3.188774071602418e-06, 'epoch': 1.0}

Trial status: 3 RUNNING
Current time: 2025-06-04 18:55:33. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_8eb2c954   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_03a65c1b   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_b667a208   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(train_hpo pid=3397629)[0m 2025-06-04 18:55:40,180 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3397629)[0m 2025-06-04 18:55:40,186 - INFO - eval_result: {'eval_loss': 1.0807064771652222, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.9413967132568359, 'eval_AP': 0.9808204226227236, 'eval_MCC': 0.0, 'eval_NDCG': 0.9964066714568224, 'eval_kappa': 0.0, 'eval_runtime': 3.3082, 'eval_samples_per_second': 19.951, 'eval_steps_per_second': 1.209, 'epoch': 2.0}
[36m(train_hpo pid=3397629)[0m 2025-06-04 18:55:40,219 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
2025-06-04 18:55:40,245 - INFO - Cleaning up trial b667a208
2025-06-04 18:55:40,245 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_18-55-01/train_hpo_b667a208_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512_2025-06-04_18-55-17
2025-06-04 18:55:45,081 - INFO - Cleaning up trial 8eb2c954
2025-06-04 18:55:45,081 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_18-55-01/train_hpo_8eb2c954_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-04_18-55-03
2025-06-04 18:55:45,081 - INFO - Current best: b667a208 with eval_f1 : 0.8521739130434782 at iteration 1

[36m(train_hpo pid=3397629)[0m {'train_runtime': 8.0363, 'train_samples_per_second': 73.915, 'train_steps_per_second': 0.747, 'train_loss': 1.723647157351176, 'epoch': 2.0}
[36m(train_hpo pid=3397629)[0m STATE at ending of training  :  TrainerState(epoch=2.0, global_step=6, max_steps=6, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=104191042424832.0, log_history=[{'loss': 2.4045, 'grad_norm': 7.873886585235596, 'learning_rate': 3.994089731390617e-05, 'epoch': 1.0, 'step': 3}, {'loss': 1.0428, 'grad_norm': 2.202641487121582, 'learning_rate': 0.0, 'epoch': 2.0, 'step': 6}, {'train_runtime': 8.0363, 'train_samples_per_second': 73.915, 'train_steps_per_second': 0.747, 'total_flos': 104191042424832.0, 'train_loss': 1.723647157351176, 'epoch': 2.0, 'step': 6}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3397629)[0m {'loss': 1.0428, 'grad_norm': 2.202641487121582, 'learning_rate': 0.0, 'epoch': 2.0}[32m [repeated 3x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(train_hpo pid=3397629)[0m {'eval_loss': 1.0807064771652222, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.9413967132568359, 'eval_AP': 0.9808204226227236, 'eval_MCC': 0.0, 'eval_NDCG': 0.9964066714568224, 'eval_kappa': 0.0, 'eval_runtime': 3.3082, 'eval_samples_per_second': 19.951, 'eval_steps_per_second': 1.209, 'epoch': 2.0}

Trial train_hpo_b667a208 finished iteration 1 at 2025-06-04 18:55:40. Total running time: 37s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_b667a208 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    15.7619 â”‚
â”‚ time_total_s                        15.7619 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     2 â”‚
â”‚ eval_AP                             0.98082 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.99641 â”‚
â”‚ eval_accuracy                       0.74242 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.08071 â”‚
â”‚ eval_optim_threshold                 0.9414 â”‚
â”‚ eval_precision                      0.74242 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.3082 â”‚
â”‚ eval_samples_per_second              19.951 â”‚
â”‚ eval_steps_per_second                 1.209 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_b667a208 completed after 1 iterations at 2025-06-04 18:55:40. Total running time: 37s
[36m(train_hpo pid=3397100)[0m STATE at ending of training  :  TrainerState(epoch=4.0, global_step=12, max_steps=12, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=208382084849664.0, log_history=[{'loss': 2.1902, 'grad_norm': 15.119211196899414, 'learning_rate': 1.1217049888818266e-06, 'epoch': 1.0, 'step': 3}, {'loss': 2.1074, 'grad_norm': 16.47574806213379, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.0, 'step': 6}, {'loss': 2.1192, 'grad_norm': 21.273757934570312, 'learning_rate': 3.7390166296060887e-07, 'epoch': 3.0, 'step': 9}, {'loss': 2.0998, 'grad_norm': 14.835906028747559, 'learning_rate': 0.0, 'epoch': 4.0, 'step': 12}, {'train_runtime': 26.3005, 'train_samples_per_second': 45.17, 'train_steps_per_second': 0.456, 'total_flos': 208382084849664.0, 'train_loss': 2.12915567557017, 'epoch': 4.0, 'step': 12}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_8eb2c954 finished iteration 1 at 2025-06-04 18:55:45. Total running time: 42s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_8eb2c954 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    34.8451 â”‚
â”‚ time_total_s                        34.8451 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     4 â”‚
â”‚ eval_AP                              0.8765 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.96491 â”‚
â”‚ eval_accuracy                       0.74242 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                            2.5048 â”‚
â”‚ eval_optim_threshold                0.70377 â”‚
â”‚ eval_precision                      0.74242 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.9178 â”‚
â”‚ eval_samples_per_second              16.846 â”‚
â”‚ eval_steps_per_second                 1.021 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_8eb2c954 completed after 1 iterations at 2025-06-04 18:55:45. Total running time: 42s
[36m(train_hpo pid=3397100)[0m {'train_runtime': 26.3005, 'train_samples_per_second': 45.17, 'train_steps_per_second': 0.456, 'train_loss': 2.12915567557017, 'epoch': 4.0}
[36m(train_hpo pid=3397100)[0m {'loss': 2.0998, 'grad_norm': 14.835906028747559, 'learning_rate': 0.0, 'epoch': 4.0}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3397335)[0m {'train_runtime': 24.4846, 'train_samples_per_second': 40.434, 'train_steps_per_second': 0.408, 'train_loss': 2.3938751935958864, 'epoch': 3.4}
[36m(train_hpo pid=3397100)[0m {'eval_loss': 2.50480318069458, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.7037724256515503, 'eval_AP': 0.8765003735840584, 'eval_MCC': 0.0, 'eval_NDCG': 0.9649083932395274, 'eval_kappa': 0.0, 'eval_runtime': 3.9178, 'eval_samples_per_second': 16.846, 'eval_steps_per_second': 1.021, 'epoch': 4.0}
[36m(train_hpo pid=3397335)[0m STATE at ending of training  :  TrainerState(epoch=3.4, global_step=10, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=177335259076608.0, log_history=[{'loss': 2.657, 'grad_norm': 17.892826080322266, 'learning_rate': 3.188774071602418e-06, 'epoch': 1.0, 'step': 3}, {'loss': 2.3289, 'grad_norm': 16.963666915893555, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.0, 'step': 6}, {'loss': 2.1635, 'grad_norm': 20.622774124145508, 'learning_rate': 4.555391530860598e-07, 'epoch': 3.0, 'step': 9}, {'loss': 2.4906, 'grad_norm': 30.06032371520996, 'learning_rate': 0.0, 'epoch': 3.4, 'step': 10}, {'train_runtime': 24.4846, 'train_samples_per_second': 40.434, 'train_steps_per_second': 0.408, 'total_flos': 177335259076608.0, 'train_loss': 2.3938751935958864, 'epoch': 3.4, 'step': 10}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})2025-06-04 18:55:50,156 - INFO - Cleaning up trial 03a65c1b
2025-06-04 18:55:50,157 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_18-55-01/train_hpo_03a65c1b_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-04_18-55-10
2025-06-04 18:55:50,157 - INFO - Current best: 8eb2c954 with eval_f1 : 0.8521739130434782 at iteration 1
2025-06-04 18:55:50,157 - INFO - Current best: b667a208 with eval_f1 : 0.8521739130434782 at iteration 1
[36m(train_hpo pid=3397335)[0m 2025-06-04 18:55:50,090 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3397335)[0m 2025-06-04 18:55:50,097 - INFO - eval_result: {'eval_loss': 2.4529473781585693, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.6405546069145203, 'eval_AP': 0.9874810735691331, 'eval_MCC': 0.0, 'eval_NDCG': 0.9977404256164996, 'eval_kappa': 0.0, 'eval_runtime': 3.4433, 'eval_samples_per_second': 19.168, 'eval_steps_per_second': 1.162, 'epoch': 3.4}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3397335)[0m 2025-06-04 18:55:50,131 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB[32m [repeated 2x across cluster][0m
2025-06-04 18:55:50,165	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_18-55-01' in 0.0066s.
2025-06-04 18:55:50,171 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x719b46af6b90>
2025-06-04 18:55:50,171 - INFO - Best trial : train_hpo_8eb2c954
2025-06-04 18:55:50,171 - INFO - Best config : {'pos_weight': 8.493688290834637, 'learning_rate': 1.4956066518424355e-06, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 6}
2025-06-04 18:55:50,171 - INFO - Best trial after optimization: {'eval_loss': 2.50480318069458, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.7037724256515503, 'eval_AP': 0.8765003735840584, 'eval_MCC': 0.0, 'eval_NDCG': 0.9649083932395274, 'eval_kappa': 0.0, 'eval_runtime': 3.9178, 'eval_samples_per_second': 16.846, 'eval_steps_per_second': 1.021, 'epoch': 4.0, 'timestamp': 1749056145, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '8eb2c954', 'date': '2025-06-04_18-55-45', 'time_this_iter_s': 34.84506297111511, 'time_total_s': 34.84506297111511, 'pid': 3397100, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 8.493688290834637, 'learning_rate': 1.4956066518424355e-06, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 6}, 'time_since_restore': 34.84506297111511, 'iterations_since_restore': 1, 'experiment_tag': '1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364'}
2025-06-04 18:55:50,194 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   2.504803  0.852174  ...                        6  8eb2c954
1   2.452947  0.852174  ...                        5  03a65c1b
2   1.080706  0.852174  ...                        3  b667a208

[3 rows x 32 columns]
2025-06-04 18:55:50,337 - INFO - Trial comparison plot saved
2025-06-04 18:55:50,337 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-04 18:55:51,357 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)


Trial train_hpo_03a65c1b finished iteration 1 at 2025-06-04 18:55:50. Total running time: 47s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_03a65c1b result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    32.5732 â”‚
â”‚ time_total_s                        32.5732 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   3.4 â”‚
â”‚ eval_AP                             0.98748 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.99774 â”‚
â”‚ eval_accuracy                       0.74242 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           2.45295 â”‚
â”‚ eval_optim_threshold                0.64055 â”‚
â”‚ eval_precision                      0.74242 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.4433 â”‚
â”‚ eval_samples_per_second              19.168 â”‚
â”‚ eval_steps_per_second                 1.162 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_03a65c1b completed after 1 iterations at 2025-06-04 18:55:50. Total running time: 47s
[36m(train_hpo pid=3397335)[0m {'eval_loss': 2.4529473781585693, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.6405546069145203, 'eval_AP': 0.9874810735691331, 'eval_MCC': 0.0, 'eval_NDCG': 0.9977404256164996, 'eval_kappa': 0.0, 'eval_runtime': 3.4433, 'eval_samples_per_second': 19.168, 'eval_steps_per_second': 1.162, 'epoch': 3.4}
[36m(train_hpo pid=3397335)[0m {'loss': 2.4906, 'grad_norm': 30.06032371520996, 'learning_rate': 0.0, 'epoch': 3.4}[32m [repeated 2x across cluster][0m

Trial status: 3 TERMINATED
Current time: 2025-06-04 18:55:50. Total running time: 47s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_8eb2c954   TERMINATED        8.49369       1.49561e-06         0.13641                     6        1            34.8451       2.5048     0.852174               1          0.742424 â”‚
â”‚ train_hpo_03a65c1b   TERMINATED        7.54953       4.55539e-06         0.123031                    5        1            32.5732       2.45295    0.852174               1          0.742424 â”‚
â”‚ train_hpo_b667a208   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            15.7619       1.08071    0.852174               1          0.742424 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

[2025-06-04 18:55:51,594] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2025-06-04 18:55:53,065 - INFO - training size : 198
2025-06-04 18:55:53,066 - INFO - dev size : 66
2025-06-04 18:55:53,066 - INFO - test size : 133
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
  0%|          | 0/54 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  2%|â–         | 1/54 [00:01<01:40,  1.89s/it]  4%|â–Ž         | 2/54 [00:02<00:59,  1.14s/it]  6%|â–Œ         | 3/54 [00:03<00:45,  1.11it/s]  7%|â–‹         | 4/54 [00:03<00:39,  1.27it/s]  9%|â–‰         | 5/54 [00:04<00:35,  1.38it/s] 11%|â–ˆ         | 6/54 [00:04<00:33,  1.45it/s] 13%|â–ˆâ–Ž        | 7/54 [00:05<00:31,  1.50it/s] 15%|â–ˆâ–        | 8/54 [00:06<00:29,  1.55it/s] 17%|â–ˆâ–‹        | 9/54 [00:06<00:24,  1.84it/s]                                               17%|â–ˆâ–‹        | 9/54 [00:06<00:24,  1.84it/s] 19%|â–ˆâ–Š        | 10/54 [00:07<00:25,  1.75it/s] 20%|â–ˆâ–ˆ        | 11/54 [00:07<00:25,  1.71it/s] 22%|â–ˆâ–ˆâ–       | 12/54 [00:08<00:25,  1.68it/s] 24%|â–ˆâ–ˆâ–       | 13/54 [00:08<00:24,  1.66it/s] 26%|â–ˆâ–ˆâ–Œ       | 14/54 [00:09<00:24,  1.65it/s] 28%|â–ˆâ–ˆâ–Š       | 15/54 [00:10<00:23,  1.64it/s] 30%|â–ˆâ–ˆâ–‰       | 16/54 [00:10<00:23,  1.64it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 17/54 [00:11<00:22,  1.64it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 18/54 [00:11<00:18,  1.92it/s]                                                33%|â–ˆâ–ˆâ–ˆâ–Ž      | 18/54 [00:11<00:18,  1.92it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 19/54 [00:12<00:19,  1.80it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 20/54 [00:13<00:19,  1.74it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 21/54 [00:13<00:19,  1.70it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 22/54 [00:14<00:19,  1.68it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 23/54 [00:14<00:18,  1.66it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 24/54 [00:15<00:18,  1.65it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 25/54 [00:16<00:17,  1.64it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 26/54 [00:16<00:16,  1.65it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 27/54 [00:17<00:14,  1.92it/s]                                                50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 27/54 [00:17<00:14,  1.92it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 28/54 [00:17<00:14,  1.80it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 29/54 [00:18<00:14,  1.74it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 30/54 [00:18<00:14,  1.70it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 31/54 [00:19<00:13,  1.68it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 32/54 [00:20<00:13,  1.66it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 33/54 [00:20<00:12,  1.65it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 34/54 [00:21<00:12,  1.64it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 35/54 [00:21<00:11,  1.65it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 36/54 [00:22<00:09,  1.92it/s]                                                67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 36/54 [00:22<00:09,  1.92it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 37/54 [00:22<00:09,  1.80it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 38/54 [00:23<00:09,  1.74it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 39/54 [00:24<00:08,  1.71it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 40/54 [00:24<00:08,  1.68it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 41/54 [00:25<00:07,  1.66it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 42/54 [00:25<00:07,  1.65it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 43/54 [00:26<00:06,  1.65it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 44/54 [00:27<00:06,  1.65it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 45/54 [00:27<00:04,  1.92it/s]                                                83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 45/54 [00:27<00:04,  1.92it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 46/54 [00:28<00:04,  1.80it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 47/54 [00:28<00:04,  1.74it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 48/54 [00:29<00:03,  1.70it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 49/54 [00:30<00:02,  1.68it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 50/54 [00:30<00:02,  1.66it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 51/54 [00:31<00:01,  1.65it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 52/54 [00:31<00:01,  1.64it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 53/54 [00:32<00:00,  1.65it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 54/54 [00:32<00:00,  1.92it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 54/54 [00:35<00:00,  1.92it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 54/54 [00:35<00:00,  1.92it/s]2025-06-04 18:56:29,009 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 54/54 [00:35<00:00,  1.52it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
{'loss': 3.9669, 'grad_norm': 33.944725036621094, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}
{'loss': 3.6838, 'grad_norm': 37.801029205322266, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0}
{'loss': 3.6039, 'grad_norm': 66.14639282226562, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0}
{'loss': 3.3107, 'grad_norm': 60.4851188659668, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0}
{'loss': 3.1237, 'grad_norm': 40.412132263183594, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0}
{'loss': 2.9405, 'grad_norm': 28.379009246826172, 'learning_rate': 0.0, 'epoch': 6.0}
{'train_runtime': 35.5766, 'train_samples_per_second': 33.393, 'train_steps_per_second': 1.518, 'train_loss': 3.4382667894716614, 'epoch': 6.0}
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.30it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.66it/s]2025-06-04 18:56:32,630 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.11s/it]
2025-06-04 18:56:32,636 - INFO - Training time : 42.29863605997525
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.12it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.04it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.37it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.11it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.27it/s]2025-06-04 18:56:37,396 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.35it/s]
2025-06-04 18:56:37,401 - INFO - Evaluation time : 4.764981260988861
2025-06-04 18:56:37,401 - INFO - Evaluation results on test set: {'eval_loss': 2.949110507965088, 'eval_f1': 0.8484848484848485, 'eval_recall': 1.0, 'eval_accuracy': 0.7368421052631579, 'eval_precision': 0.7368421052631579, 'eval_optim_threshold': 0.618845522403717, 'eval_AP': 0.9961532002559426, 'eval_MCC': 0.0, 'eval_NDCG': 0.9993800668405006, 'eval_kappa': 0.0, 'eval_runtime': 4.7606, 'eval_samples_per_second': 27.938, 'eval_steps_per_second': 1.26, 'epoch': 6.0}
2025-06-04 18:56:37,401 - INFO - Total updates (optimizer steps): 54
2025-06-04 18:56:37,401 - INFO - Avg time / step: 0.659s
2025-06-04 18:56:38,446 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCEdmis-lab/biobert-v1.13trials_fold-1
2025-06-04 18:56:38,446 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.17it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.06it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.39it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.13it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.28it/s]2025-06-04 18:56:42,886 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.45it/s]
2025-06-04 18:56:42,890 - INFO - preds : [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
2025-06-04 18:56:42,891 - INFO - test_split["labels"] : [1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0]
2025-06-04 18:56:42,892 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 18:56:45,645 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': 0.9961532002559426, 'MCC': 0.0, 'NDCG': 0.9993800668405006, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 18:56:45,762 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-04 18:56:45,857 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 18:56:45,858 - INFO - 
On test Set (optimal threshold of 0.6216930150985718 according to cross validation on the training set): 
2025-06-04 18:56:45,859 - INFO - Confusion matrix: TN=34, FP=1, FN=5, TP=93
2025-06-04 18:56:48,621 - INFO - Metrics: {'f1': 0.96875, 'recall': 0.9489795918367347, 'precision': 0.9893617021276596, 'accuracy': 0.9548872180451128, 'AP': 0.9961532002559426, 'MCC': 0.8902895823763642, 'NDCG': 0.9993800668405006, 'kappa': 0.8877952755905512, 'TN': 34, 'FP': 1, 'FN': 5, 'TP': 93}
2025-06-04 18:56:48,718 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 18:56:48,719 - INFO - Results for fold 1 : [{'f1': 0.96875, 'recall': 0.9489795918367347, 'precision': 0.9893617021276596, 'accuracy': 0.9548872180451128, 'AP': 0.9961532002559426, 'MCC': 0.8902895823763642, 'NDCG': 0.9993800668405006, 'kappa': 0.8877952755905512, 'TN': 34, 'FP': 1, 'FN': 5, 'TP': 93}]
2025-06-04 18:56:48,831 - INFO - Cleared CUDA cache. Memory allocated: 1.38 GB, Memory reserved: 1.76 GB
2025-06-04 18:56:48,831 - INFO - 
fold number 2 / 3
2025-06-04 18:56:48,837 - INFO - train split size : 198
2025-06-04 18:56:48,837 - INFO - dev split size : 67
2025-06-04 18:56:48,837 - INFO - test split size : 132
Map (num_proc=32):   0%|          | 0/198 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–Ž         | 7/198 [00:00<00:03, 49.27 examples/s]Map (num_proc=32):  27%|â–ˆâ–ˆâ–‹       | 54/198 [00:00<00:00, 236.02 examples/s]Map (num_proc=32):  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 96/198 [00:00<00:00, 289.28 examples/s]Map (num_proc=32):  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 138/198 [00:00<00:00, 318.04 examples/s]Map (num_proc=32):  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 174/198 [00:00<00:00, 331.06 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 198/198 [00:00<00:00, 260.71 examples/s]
Map (num_proc=32):   0%|          | 0/67 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/67 [00:00<00:02, 22.22 examples/s]Map (num_proc=32):  28%|â–ˆâ–ˆâ–Š       | 19/67 [00:00<00:00, 83.31 examples/s]Map (num_proc=32):  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 33/67 [00:00<00:00, 102.34 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 45/67 [00:00<00:00, 106.82 examples/s]Map (num_proc=32):  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 59/67 [00:00<00:00, 114.16 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:00<00:00, 88.35 examples/s] 
Map (num_proc=32):   0%|          | 0/132 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/132 [00:00<00:03, 34.90 examples/s]Map (num_proc=32):  24%|â–ˆâ–ˆâ–       | 32/132 [00:00<00:00, 149.80 examples/s]Map (num_proc=32):  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 60/132 [00:00<00:00, 202.70 examples/s]Map (num_proc=32):  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 92/132 [00:00<00:00, 233.41 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 120/132 [00:00<00:00, 241.61 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 132/132 [00:00<00:00, 181.69 examples/s]
2025-06-04 18:56:55,803 - INFO - 3 datasets tokenized successfully
2025-06-04 18:56:55,805 - INFO - Starting hyperparameter search for BCE loss
[36m(train_hpo pid=3400245)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3400245)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3400245)[0m 2025-06-04 18:57:03,563 - INFO - pos_weight value in TrainingArguments : 8.493688290834637
[36m(train_hpo pid=3400245)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3400245)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3400245)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3400245)[0m   warnings.warn(
[36m(train_hpo pid=3400415)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3400415)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3400415)[0m 2025-06-04 18:57:10,332 - INFO - pos_weight value in TrainingArguments : 7.549531688595925
[36m(train_hpo pid=3400415)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3400415)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3400415)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3400415)[0m   warnings.warn(
[36m(train_hpo pid=3400770)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3400770)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3400770)[0m 2025-06-04 18:57:17,129 - INFO - pos_weight value in TrainingArguments : 8.949837496427758
[36m(train_hpo pid=3400770)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3400770)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3400770)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3400770)[0m   warnings.warn(
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-04_18-56-55   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_18-56-55
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-04_18-54-36_274448_3393636/artifacts/2025-06-04_18-56-55/train_hpo_2025-06-04_18-56-55/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-04 18:56:55. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_4e8ea5c3   PENDING         8.49369       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_4e8ea5c3 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_4e8ea5c3 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          8.49369 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3400245)[0m [2025-06-04 18:57:03,794] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3400245)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=12, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_9a86c434 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_9a86c434 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          7.54953 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3400415)[0m [2025-06-04 18:57:10,680] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3400245)[0m {'loss': 3.6022, 'grad_norm': 25.551897048950195, 'learning_rate': 1.1217049888818266e-06, 'epoch': 1.0}
[36m(train_hpo pid=3400415)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_318702ec started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_318702ec config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          8.94984 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3400245)[0m {'loss': 3.4958, 'grad_norm': 28.30266761779785, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.0}
[36m(train_hpo pid=3400770)[0m [2025-06-04 18:57:17,362] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3400770)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=6, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3400415)[0m {'loss': 3.5672, 'grad_norm': 23.13637351989746, 'learning_rate': 3.188774071602418e-06, 'epoch': 1.0}

Trial status: 3 RUNNING
Current time: 2025-06-04 18:57:26. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_4e8ea5c3   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_9a86c434   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_318702ec   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(train_hpo pid=3400770)[0m 2025-06-04 18:57:32,121 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3400770)[0m 2025-06-04 18:57:32,127 - INFO - eval_result: {'eval_loss': 1.1897889375686646, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.9115983247756958, 'eval_AP': 0.9901815732593563, 'eval_MCC': 0.0, 'eval_NDCG': 0.9982413561125479, 'eval_kappa': 0.0, 'eval_runtime': 3.4274, 'eval_samples_per_second': 19.548, 'eval_steps_per_second': 1.167, 'epoch': 2.0}
2025-06-04 18:57:32,186 - INFO - Cleaning up trial 318702ec
2025-06-04 18:57:32,186 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_18-56-55/train_hpo_318702ec_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512_2025-06-04_18-57-09
[36m(train_hpo pid=3400770)[0m 2025-06-04 18:57:32,162 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
2025-06-04 18:57:37,627 - INFO - Cleaning up trial 4e8ea5c3
2025-06-04 18:57:37,627 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_18-56-55/train_hpo_4e8ea5c3_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-04_18-56-55
2025-06-04 18:57:37,627 - INFO - Current best: 318702ec with eval_f1 : 0.8448275862068966 at iteration 1
[36m(train_hpo pid=3400245)[0m 2025-06-04 18:57:37,562 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3400245)[0m 2025-06-04 18:57:37,569 - INFO - eval_result: {'eval_loss': 4.020423889160156, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.5447760820388794, 'eval_AP': 0.8617261906050345, 'eval_MCC': 0.0, 'eval_NDCG': 0.9675620612450465, 'eval_kappa': 0.0, 'eval_runtime': 3.8147, 'eval_samples_per_second': 17.564, 'eval_steps_per_second': 1.049, 'epoch': 4.0}
[36m(train_hpo pid=3400245)[0m 2025-06-04 18:57:37,602 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB

[36m(train_hpo pid=3400770)[0m {'train_runtime': 8.025, 'train_samples_per_second': 74.019, 'train_steps_per_second': 0.748, 'train_loss': 1.9570695559183757, 'epoch': 2.0}
[36m(train_hpo pid=3400770)[0m STATE at ending of training  :  TrainerState(epoch=2.0, global_step=6, max_steps=6, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=104191042424832.0, log_history=[{'loss': 2.718, 'grad_norm': 11.492520332336426, 'learning_rate': 3.994089731390617e-05, 'epoch': 1.0, 'step': 3}, {'loss': 1.1962, 'grad_norm': 4.5046067237854, 'learning_rate': 0.0, 'epoch': 2.0, 'step': 6}, {'train_runtime': 8.025, 'train_samples_per_second': 74.019, 'train_steps_per_second': 0.748, 'total_flos': 104191042424832.0, 'train_loss': 1.9570695559183757, 'epoch': 2.0, 'step': 6}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3400770)[0m {'loss': 1.1962, 'grad_norm': 4.5046067237854, 'learning_rate': 0.0, 'epoch': 2.0}[32m [repeated 3x across cluster][0m
[36m(train_hpo pid=3400770)[0m {'eval_loss': 1.1897889375686646, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.9115983247756958, 'eval_AP': 0.9901815732593563, 'eval_MCC': 0.0, 'eval_NDCG': 0.9982413561125479, 'eval_kappa': 0.0, 'eval_runtime': 3.4274, 'eval_samples_per_second': 19.548, 'eval_steps_per_second': 1.167, 'epoch': 2.0}

Trial train_hpo_318702ec finished iteration 1 at 2025-06-04 18:57:32. Total running time: 36s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_318702ec result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                     15.916 â”‚
â”‚ time_total_s                         15.916 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     2 â”‚
â”‚ eval_AP                             0.99018 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.99824 â”‚
â”‚ eval_accuracy                       0.73134 â”‚
â”‚ eval_f1                             0.84483 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.18979 â”‚
â”‚ eval_optim_threshold                 0.9116 â”‚
â”‚ eval_precision                      0.73134 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.4274 â”‚
â”‚ eval_samples_per_second              19.548 â”‚
â”‚ eval_steps_per_second                 1.167 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_318702ec completed after 1 iterations at 2025-06-04 18:57:32. Total running time: 36s
[36m(train_hpo pid=3400245)[0m STATE at ending of training  :  TrainerState(epoch=4.0, global_step=12, max_steps=12, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=208382084849664.0, log_history=[{'loss': 3.6022, 'grad_norm': 25.551897048950195, 'learning_rate': 1.1217049888818266e-06, 'epoch': 1.0, 'step': 3}, {'loss': 3.4958, 'grad_norm': 28.30266761779785, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.0, 'step': 6}, {'loss': 3.3952, 'grad_norm': 32.520294189453125, 'learning_rate': 3.7390166296060887e-07, 'epoch': 3.0, 'step': 9}, {'loss': 3.332, 'grad_norm': 23.92950439453125, 'learning_rate': 0.0, 'epoch': 4.0, 'step': 12}, {'train_runtime': 26.7509, 'train_samples_per_second': 44.41, 'train_steps_per_second': 0.449, 'total_flos': 208382084849664.0, 'train_loss': 3.4562939008076987, 'epoch': 4.0, 'step': 12}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3400245)[0m {'train_runtime': 26.7509, 'train_samples_per_second': 44.41, 'train_steps_per_second': 0.449, 'train_loss': 3.4562939008076987, 'epoch': 4.0}
[36m(train_hpo pid=3400245)[0m {'loss': 3.332, 'grad_norm': 23.92950439453125, 'learning_rate': 0.0, 'epoch': 4.0}[32m [repeated 2x across cluster][0m

Trial train_hpo_4e8ea5c3 finished iteration 1 at 2025-06-04 18:57:37. Total running time: 41s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_4e8ea5c3 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    34.9282 â”‚
â”‚ time_total_s                        34.9282 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     4 â”‚
â”‚ eval_AP                             0.86173 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.96756 â”‚
â”‚ eval_accuracy                       0.73134 â”‚
â”‚ eval_f1                             0.84483 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           4.02042 â”‚
â”‚ eval_optim_threshold                0.54478 â”‚
â”‚ eval_precision                      0.73134 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.8147 â”‚
â”‚ eval_samples_per_second              17.564 â”‚
â”‚ eval_steps_per_second                 1.049 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_4e8ea5c3 completed after 1 iterations at 2025-06-04 18:57:37. Total running time: 41s
[36m(train_hpo pid=3400245)[0m {'eval_loss': 4.020423889160156, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.5447760820388794, 'eval_AP': 0.8617261906050345, 'eval_MCC': 0.0, 'eval_NDCG': 0.9675620612450465, 'eval_kappa': 0.0, 'eval_runtime': 3.8147, 'eval_samples_per_second': 17.564, 'eval_steps_per_second': 1.049, 'epoch': 4.0}
[36m(train_hpo pid=3400415)[0m {'train_runtime': 25.0807, 'train_samples_per_second': 39.473, 'train_steps_per_second': 0.399, 'train_loss': 3.2271374225616456, 'epoch': 3.4}
[36m(train_hpo pid=3400415)[0m STATE at ending of training  :  TrainerState(epoch=3.4, global_step=10, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=177335259076608.0, log_history=[{'loss': 3.5672, 'grad_norm': 23.13637351989746, 'learning_rate': 3.188774071602418e-06, 'epoch': 1.0, 'step': 3}, {'loss': 3.2081, 'grad_norm': 24.923812866210938, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.0, 'step': 6}, {'loss': 2.8882, 'grad_norm': 26.40314483642578, 'learning_rate': 4.555391530860598e-07, 'epoch': 3.0, 'step': 9}, {'loss': 3.2811, 'grad_norm': 41.923744201660156, 'learning_rate': 0.0, 'epoch': 3.4, 'step': 10}, {'train_runtime': 25.0807, 'train_samples_per_second': 39.473, 'train_steps_per_second': 0.399, 'total_flos': 177335259076608.0, 'train_loss': 3.2271374225616456, 'epoch': 3.4, 'step': 10}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})[36m(train_hpo pid=3400415)[0m 2025-06-04 18:57:42,301 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3400415)[0m 2025-06-04 18:57:42,307 - INFO - eval_result: {'eval_loss': 3.222428321838379, 'eval_f1': 0.875, 'eval_recall': 1.0, 'eval_accuracy': 0.7910447761194029, 'eval_precision': 0.7777777777777778, 'eval_optim_threshold': 0.5276443958282471, 'eval_AP': 0.946105177911294, 'eval_MCC': 0.41573970964154905, 'eval_NDCG': 0.9818839183579887, 'eval_kappa': 0.2947368421052631, 'eval_runtime': 3.316, 'eval_samples_per_second': 20.205, 'eval_steps_per_second': 1.206, 'epoch': 3.4}
2025-06-04 18:57:42,366 - INFO - Cleaning up trial 9a86c434
2025-06-04 18:57:42,366 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_18-56-55/train_hpo_9a86c434_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-04_18-57-02
2025-06-04 18:57:42,366 - INFO - Cleaning up trial 4e8ea5c3
2025-06-04 18:57:42,366 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_18-56-55/train_hpo_4e8ea5c3_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-04_18-56-55
2025-06-04 18:57:42,366 - INFO - Cleaning up trial 318702ec
2025-06-04 18:57:42,366 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_18-56-55/train_hpo_318702ec_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512_2025-06-04_18-57-09
2025-06-04 18:57:42,375	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_18-56-55' in 0.0071s.
2025-06-04 18:57:42,383 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x719ac41c5550>
2025-06-04 18:57:42,383 - INFO - Best trial : train_hpo_9a86c434
2025-06-04 18:57:42,383 - INFO - Best config : {'pos_weight': 7.549531688595925, 'learning_rate': 4.555391530860597e-06, 'weight_decay': 0.12303118765599412, 'num_train_epochs': 5}
2025-06-04 18:57:42,383 - INFO - Best trial after optimization: {'eval_loss': 3.222428321838379, 'eval_f1': 0.875, 'eval_recall': 1.0, 'eval_accuracy': 0.7910447761194029, 'eval_precision': 0.7777777777777778, 'eval_optim_threshold': 0.5276443958282471, 'eval_AP': 0.946105177911294, 'eval_MCC': 0.41573970964154905, 'eval_NDCG': 0.9818839183579887, 'eval_kappa': 0.2947368421052631, 'eval_runtime': 3.316, 'eval_samples_per_second': 20.205, 'eval_steps_per_second': 1.206, 'epoch': 3.4, 'timestamp': 1749056262, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '9a86c434', 'date': '2025-06-04_18-57-42', 'time_this_iter_s': 32.88630533218384, 'time_total_s': 32.88630533218384, 'pid': 3400415, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 7.549531688595925, 'learning_rate': 4.555391530860597e-06, 'weight_decay': 0.12303118765599412, 'num_train_epochs': 5}, 'time_since_restore': 32.88630533218384, 'iterations_since_restore': 1, 'experiment_tag': '2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230'}
2025-06-04 18:57:42,405 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   4.020424  0.844828  ...                        6  4e8ea5c3
1   3.222428  0.875000  ...                        5  9a86c434
2   1.189789  0.844828  ...                        3  318702ec

[3 rows x 32 columns]
[36m(train_hpo pid=3400415)[0m 2025-06-04 18:57:42,341 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
2025-06-04 18:57:42,542 - INFO - Trial comparison plot saved
2025-06-04 18:57:42,542 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-04 18:57:43,169 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-04 18:57:43,262 - INFO - training size : 198
2025-06-04 18:57:43,263 - INFO - dev size : 67
2025-06-04 18:57:43,263 - INFO - test size : 132
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(

[36m(train_hpo pid=3400415)[0m {'loss': 3.2811, 'grad_norm': 41.923744201660156, 'learning_rate': 0.0, 'epoch': 3.4}[32m [repeated 2x across cluster][0m

Trial train_hpo_9a86c434 finished iteration 1 at 2025-06-04 18:57:42. Total running time: 46s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_9a86c434 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    32.8863 â”‚
â”‚ time_total_s                        32.8863 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   3.4 â”‚
â”‚ eval_AP                             0.94611 â”‚
â”‚ eval_MCC                            0.41574 â”‚
â”‚ eval_NDCG                           0.98188 â”‚
â”‚ eval_accuracy                       0.79104 â”‚
â”‚ eval_f1                               0.875 â”‚
â”‚ eval_kappa                          0.29474 â”‚
â”‚ eval_loss                           3.22243 â”‚
â”‚ eval_optim_threshold                0.52764 â”‚
â”‚ eval_precision                      0.77778 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                          3.316 â”‚
â”‚ eval_samples_per_second              20.205 â”‚
â”‚ eval_steps_per_second                 1.206 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_9a86c434 completed after 1 iterations at 2025-06-04 18:57:42. Total running time: 46s

Trial status: 3 TERMINATED
Current time: 2025-06-04 18:57:42. Total running time: 46s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_4e8ea5c3   TERMINATED        8.49369       1.49561e-06         0.13641                     6        1            34.9282       4.02042    0.844828               1          0.731343 â”‚
â”‚ train_hpo_9a86c434   TERMINATED        7.54953       4.55539e-06         0.123031                    5        1            32.8863       3.22243    0.875                  1          0.791045 â”‚
â”‚ train_hpo_318702ec   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            15.916        1.18979    0.844828               1          0.731343 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

  0%|          | 0/45 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  2%|â–         | 1/45 [00:00<00:28,  1.54it/s]  4%|â–         | 2/45 [00:01<00:27,  1.58it/s]  7%|â–‹         | 3/45 [00:01<00:26,  1.60it/s]  9%|â–‰         | 4/45 [00:02<00:25,  1.60it/s] 11%|â–ˆ         | 5/45 [00:03<00:24,  1.61it/s] 13%|â–ˆâ–Ž        | 6/45 [00:03<00:24,  1.61it/s] 16%|â–ˆâ–Œ        | 7/45 [00:04<00:23,  1.61it/s] 18%|â–ˆâ–Š        | 8/45 [00:04<00:22,  1.63it/s] 20%|â–ˆâ–ˆ        | 9/45 [00:05<00:18,  1.91it/s]                                               20%|â–ˆâ–ˆ        | 9/45 [00:05<00:18,  1.91it/s] 22%|â–ˆâ–ˆâ–       | 10/45 [00:05<00:19,  1.78it/s] 24%|â–ˆâ–ˆâ–       | 11/45 [00:06<00:19,  1.73it/s] 27%|â–ˆâ–ˆâ–‹       | 12/45 [00:07<00:19,  1.69it/s] 29%|â–ˆâ–ˆâ–‰       | 13/45 [00:07<00:19,  1.67it/s] 31%|â–ˆâ–ˆâ–ˆ       | 14/45 [00:08<00:18,  1.65it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 15/45 [00:09<00:18,  1.65it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 16/45 [00:09<00:17,  1.64it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 17/45 [00:10<00:17,  1.65it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 18/45 [00:10<00:14,  1.92it/s]                                                40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 18/45 [00:10<00:14,  1.92it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 19/45 [00:11<00:14,  1.80it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 20/45 [00:11<00:14,  1.74it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 21/45 [00:12<00:14,  1.70it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 22/45 [00:13<00:13,  1.68it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 23/45 [00:13<00:13,  1.66it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 24/45 [00:14<00:12,  1.65it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 25/45 [00:14<00:12,  1.64it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 26/45 [00:15<00:11,  1.64it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 27/45 [00:15<00:09,  1.91it/s]                                                60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 27/45 [00:15<00:09,  1.91it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 28/45 [00:16<00:09,  1.79it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 29/45 [00:17<00:09,  1.74it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 30/45 [00:17<00:08,  1.70it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 31/45 [00:18<00:08,  1.67it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 32/45 [00:18<00:07,  1.65it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 33/45 [00:19<00:07,  1.64it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 34/45 [00:20<00:06,  1.63it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 35/45 [00:20<00:06,  1.64it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 36/45 [00:21<00:04,  1.91it/s]                                                80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 36/45 [00:21<00:04,  1.91it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 37/45 [00:21<00:04,  1.79it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 38/45 [00:22<00:04,  1.74it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 39/45 [00:22<00:03,  1.70it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 40/45 [00:23<00:02,  1.67it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 41/45 [00:24<00:02,  1.66it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 42/45 [00:24<00:01,  1.65it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 43/45 [00:25<00:01,  1.64it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 44/45 [00:26<00:00,  1.64it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45/45 [00:26<00:00,  1.91it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45/45 [00:28<00:00,  1.91it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45/45 [00:28<00:00,  1.91it/s]2025-06-04 18:58:11,753 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45/45 [00:28<00:00,  1.60it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
{'loss': 3.4106, 'grad_norm': 25.48193359375, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0}
{'loss': 2.7409, 'grad_norm': 27.985071182250977, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0}
{'loss': 2.3071, 'grad_norm': 43.04111099243164, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0}
{'loss': 2.0293, 'grad_norm': 39.72749710083008, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0}
{'loss': 1.9099, 'grad_norm': 18.266216278076172, 'learning_rate': 0.0, 'epoch': 5.0}
{'train_runtime': 28.0516, 'train_samples_per_second': 35.292, 'train_steps_per_second': 1.604, 'train_loss': 2.4795589447021484, 'epoch': 5.0}
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.26it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.43it/s]2025-06-04 18:58:15,398 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.12s/it]
2025-06-04 18:58:15,404 - INFO - Training time : 32.86206542397849
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.16it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.04it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.37it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.11it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.34it/s]2025-06-04 18:58:19,819 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.46it/s]
2025-06-04 18:58:19,824 - INFO - Evaluation time : 4.419966034125537
2025-06-04 18:58:19,824 - INFO - Evaluation results on test set: {'eval_loss': 1.8138409852981567, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.7577463388442993, 'eval_AP': 0.9823651530515465, 'eval_MCC': 0.0, 'eval_NDCG': 0.9970778224969538, 'eval_kappa': 0.0, 'eval_runtime': 4.4154, 'eval_samples_per_second': 29.895, 'eval_steps_per_second': 1.359, 'epoch': 5.0}
2025-06-04 18:58:19,824 - INFO - Total updates (optimizer steps): 45
2025-06-04 18:58:19,824 - INFO - Avg time / step: 0.623s
2025-06-04 18:58:20,599 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCEdmis-lab/biobert-v1.13trials_fold-2
2025-06-04 18:58:20,599 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.16it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.05it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.39it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.13it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.35it/s]2025-06-04 18:58:24,999 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.46it/s]
2025-06-04 18:58:25,003 - INFO - preds : [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
2025-06-04 18:58:25,004 - INFO - test_split["labels"] : [1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1]
2025-06-04 18:58:25,005 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 18:58:27,807 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': 0.9823651530515465, 'MCC': 0.0, 'NDCG': 0.9970778224969538, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 18:58:27,932 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-04 18:58:28,036 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 18:58:28,037 - INFO - 
On test Set (optimal threshold of 0.7521507740020752 according to cross validation on the training set): 
2025-06-04 18:58:28,038 - INFO - Confusion matrix: TN=28, FP=6, FN=13, TP=85
2025-06-04 18:58:30,792 - INFO - Metrics: {'f1': 0.8994708994708994, 'recall': 0.8673469387755102, 'precision': 0.9340659340659341, 'accuracy': 0.8560606060606061, 'AP': 0.9823651530515465, 'MCC': 0.6528902730490582, 'NDCG': 0.9970778224969538, 'kappa': 0.6473565804274466, 'TN': 28, 'FP': 6, 'FN': 13, 'TP': 85}
2025-06-04 18:58:30,896 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 18:58:30,896 - INFO - Results for fold 2 : [{'f1': 0.8994708994708994, 'recall': 0.8673469387755102, 'precision': 0.9340659340659341, 'accuracy': 0.8560606060606061, 'AP': 0.9823651530515465, 'MCC': 0.6528902730490582, 'NDCG': 0.9970778224969538, 'kappa': 0.6473565804274466, 'TN': 28, 'FP': 6, 'FN': 13, 'TP': 85}]
2025-06-04 18:58:31,015 - INFO - Cleared CUDA cache. Memory allocated: 1.40 GB, Memory reserved: 1.78 GB
2025-06-04 18:58:31,015 - INFO - 
fold number 3 / 3
2025-06-04 18:58:31,021 - INFO - train split size : 198
2025-06-04 18:58:31,021 - INFO - dev split size : 67
2025-06-04 18:58:31,021 - INFO - test split size : 132
Map (num_proc=32):   0%|          | 0/198 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–Ž         | 7/198 [00:00<00:04, 40.05 examples/s]Map (num_proc=32):  24%|â–ˆâ–ˆâ–       | 48/198 [00:00<00:00, 191.17 examples/s]Map (num_proc=32):  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 84/198 [00:00<00:00, 252.28 examples/s]Map (num_proc=32):  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 120/198 [00:00<00:00, 280.10 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 156/198 [00:00<00:00, 289.68 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 192/198 [00:00<00:00, 308.28 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 198/198 [00:00<00:00, 230.10 examples/s]
Map (num_proc=32):   0%|          | 0/67 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/67 [00:00<00:03, 17.87 examples/s]Map (num_proc=32):  25%|â–ˆâ–ˆâ–Œ       | 17/67 [00:00<00:00, 66.24 examples/s]Map (num_proc=32):  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 29/67 [00:00<00:00, 80.97 examples/s]Map (num_proc=32):  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 39/67 [00:00<00:00, 87.19 examples/s]Map (num_proc=32):  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 51/67 [00:00<00:00, 90.81 examples/s]Map (num_proc=32):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 63/67 [00:00<00:00, 90.11 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:00<00:00, 74.42 examples/s]
Map (num_proc=32):   0%|          | 0/132 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/132 [00:00<00:04, 29.35 examples/s]Map (num_proc=32):  21%|â–ˆâ–ˆ        | 28/132 [00:00<00:00, 117.21 examples/s]Map (num_proc=32):  36%|â–ˆâ–ˆâ–ˆâ–‹      | 48/132 [00:00<00:00, 128.01 examples/s]Map (num_proc=32):  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 76/132 [00:00<00:00, 165.39 examples/s]Map (num_proc=32):  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 96/132 [00:00<00:00, 175.19 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 120/132 [00:00<00:00, 192.91 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 132/132 [00:00<00:00, 140.36 examples/s]
2025-06-04 18:58:39,468 - INFO - 3 datasets tokenized successfully
2025-06-04 18:58:39,470 - INFO - Starting hyperparameter search for BCE loss
[36m(train_hpo pid=3403067)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3403067)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3403067)[0m 2025-06-04 18:58:47,335 - INFO - pos_weight value in TrainingArguments : 8.493688290834637
[36m(train_hpo pid=3403067)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3403067)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3403067)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3403067)[0m   warnings.warn(
[36m(train_hpo pid=3403232)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3403232)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3403232)[0m 2025-06-04 18:58:54,080 - INFO - pos_weight value in TrainingArguments : 7.549531688595925
[36m(train_hpo pid=3403232)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3403232)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3403232)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3403232)[0m   warnings.warn(
[36m(train_hpo pid=3403461)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3403461)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3403461)[0m 2025-06-04 18:59:01,056 - INFO - pos_weight value in TrainingArguments : 8.949837496427758
[36m(train_hpo pid=3403461)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3403461)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3403461)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3403461)[0m   warnings.warn(
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-04_18-58-39   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_18-58-39
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-04_18-54-36_274448_3393636/artifacts/2025-06-04_18-58-39/train_hpo_2025-06-04_18-58-39/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-04 18:58:39. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_396923e3   PENDING         8.49369       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_396923e3 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_396923e3 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          8.49369 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3403067)[0m [2025-06-04 18:58:47,579] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3400415)[0m {'eval_loss': 3.222428321838379, 'eval_f1': 0.875, 'eval_recall': 1.0, 'eval_accuracy': 0.7910447761194029, 'eval_precision': 0.7777777777777778, 'eval_optim_threshold': 0.5276443958282471, 'eval_AP': 0.946105177911294, 'eval_MCC': 0.41573970964154905, 'eval_NDCG': 0.9818839183579887, 'eval_kappa': 0.2947368421052631, 'eval_runtime': 3.316, 'eval_samples_per_second': 20.205, 'eval_steps_per_second': 1.206, 'epoch': 3.4}
[36m(train_hpo pid=3403067)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=12, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_b6eb3e39 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_b6eb3e39 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          7.54953 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3403232)[0m [2025-06-04 18:58:54,486] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3403067)[0m {'loss': 4.5174, 'grad_norm': 30.749542236328125, 'learning_rate': 1.1217049888818266e-06, 'epoch': 1.0}
[36m(train_hpo pid=3403232)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_6af43bd6 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_6af43bd6 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          8.94984 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3403067)[0m {'loss': 4.444, 'grad_norm': 33.122440338134766, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.0}
[36m(train_hpo pid=3403461)[0m [2025-06-04 18:59:01,280] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3403461)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=6, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3403232)[0m {'loss': 2.0497, 'grad_norm': 13.806069374084473, 'learning_rate': 3.188774071602418e-06, 'epoch': 1.0}

Trial status: 3 RUNNING
Current time: 2025-06-04 18:59:09. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_396923e3   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_b6eb3e39   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_6af43bd6   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯2025-06-04 18:59:16,127 - INFO - Cleaning up trial 6af43bd6
2025-06-04 18:59:16,127 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_18-58-39/train_hpo_6af43bd6_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512_2025-06-04_18-58-53
[36m(train_hpo pid=3403461)[0m 2025-06-04 18:59:16,061 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3403461)[0m 2025-06-04 18:59:16,067 - INFO - eval_result: {'eval_loss': 1.1519930362701416, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.9037251472473145, 'eval_AP': 0.9996078431372549, 'eval_MCC': 0.0, 'eval_NDCG': 0.9999328276661524, 'eval_kappa': 0.0, 'eval_runtime': 3.4665, 'eval_samples_per_second': 19.328, 'eval_steps_per_second': 1.154, 'epoch': 2.0}
[36m(train_hpo pid=3403461)[0m 2025-06-04 18:59:16,102 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3403067)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
[36m(train_hpo pid=3403067)[0m   _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
[36m(train_hpo pid=3403067)[0m 2025-06-04 18:59:21,897 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3403067)[0m 2025-06-04 18:59:21,903 - INFO - eval_result: {'eval_loss': 5.18266487121582, 'eval_f1': 0.0, 'eval_recall': 0.0, 'eval_accuracy': 0.2537313432835821, 'eval_precision': 0.0, 'eval_optim_threshold': 0.44927477836608887, 'eval_AP': 0.826377332820764, 'eval_MCC': 0.0, 'eval_NDCG': 0.9484015529624095, 'eval_kappa': 0.0, 'eval_runtime': 4.0661, 'eval_samples_per_second': 16.478, 'eval_steps_per_second': 0.984, 'epoch': 4.0}
2025-06-04 18:59:21,963 - INFO - Cleaning up trial 396923e3
2025-06-04 18:59:21,963 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_18-58-39/train_hpo_396923e3_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-04_18-58-39
2025-06-04 18:59:21,963 - INFO - Current best: 6af43bd6 with eval_f1 : 0.8547008547008547 at iteration 1
[36m(train_hpo pid=3403067)[0m 2025-06-04 18:59:21,939 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB

[36m(train_hpo pid=3403461)[0m {'train_runtime': 8.0456, 'train_samples_per_second': 73.829, 'train_steps_per_second': 0.746, 'train_loss': 2.1165795723597207, 'epoch': 2.0}
[36m(train_hpo pid=3403461)[0m STATE at ending of training  :  TrainerState(epoch=2.0, global_step=6, max_steps=6, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=104191042424832.0, log_history=[{'loss': 3.0542, 'grad_norm': 9.585453987121582, 'learning_rate': 3.994089731390617e-05, 'epoch': 1.0, 'step': 3}, {'loss': 1.1789, 'grad_norm': 5.240856170654297, 'learning_rate': 0.0, 'epoch': 2.0, 'step': 6}, {'train_runtime': 8.0456, 'train_samples_per_second': 73.829, 'train_steps_per_second': 0.746, 'total_flos': 104191042424832.0, 'train_loss': 2.1165795723597207, 'epoch': 2.0, 'step': 6}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3403461)[0m {'loss': 1.1789, 'grad_norm': 5.240856170654297, 'learning_rate': 0.0, 'epoch': 2.0}[32m [repeated 3x across cluster][0m

Trial train_hpo_6af43bd6 finished iteration 1 at 2025-06-04 18:59:16. Total running time: 36s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_6af43bd6 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    15.9148 â”‚
â”‚ time_total_s                        15.9148 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     2 â”‚
â”‚ eval_AP                             0.99961 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.99993 â”‚
â”‚ eval_accuracy                       0.74627 â”‚
â”‚ eval_f1                              0.8547 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.15199 â”‚
â”‚ eval_optim_threshold                0.90373 â”‚
â”‚ eval_precision                      0.74627 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.4665 â”‚
â”‚ eval_samples_per_second              19.328 â”‚
â”‚ eval_steps_per_second                 1.154 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3403461)[0m {'eval_loss': 1.1519930362701416, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.9037251472473145, 'eval_AP': 0.9996078431372549, 'eval_MCC': 0.0, 'eval_NDCG': 0.9999328276661524, 'eval_kappa': 0.0, 'eval_runtime': 3.4665, 'eval_samples_per_second': 19.328, 'eval_steps_per_second': 1.154, 'epoch': 2.0}

Trial train_hpo_6af43bd6 completed after 1 iterations at 2025-06-04 18:59:16. Total running time: 36s
[36m(train_hpo pid=3403067)[0m STATE at ending of training  :  TrainerState(epoch=4.0, global_step=12, max_steps=12, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=208382084849664.0, log_history=[{'loss': 4.5174, 'grad_norm': 30.749542236328125, 'learning_rate': 1.1217049888818266e-06, 'epoch': 1.0, 'step': 3}, {'loss': 4.444, 'grad_norm': 33.122440338134766, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.0, 'step': 6}, {'loss': 4.3805, 'grad_norm': 40.29429626464844, 'learning_rate': 3.7390166296060887e-07, 'epoch': 3.0, 'step': 9}, {'loss': 4.2836, 'grad_norm': 29.4096736907959, 'learning_rate': 0.0, 'epoch': 4.0, 'step': 12}, {'train_runtime': 26.9399, 'train_samples_per_second': 44.098, 'train_steps_per_second': 0.445, 'total_flos': 208382084849664.0, 'train_loss': 4.406350056330363, 'epoch': 4.0, 'step': 12}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3403067)[0m {'train_runtime': 26.9399, 'train_samples_per_second': 44.098, 'train_steps_per_second': 0.445, 'train_loss': 4.406350056330363, 'epoch': 4.0}
[36m(train_hpo pid=3403067)[0m {'loss': 4.2836, 'grad_norm': 29.4096736907959, 'learning_rate': 0.0, 'epoch': 4.0}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3403067)[0m {'eval_loss': 5.18266487121582, 'eval_f1': 0.0, 'eval_recall': 0.0, 'eval_accuracy': 0.2537313432835821, 'eval_precision': 0.0, 'eval_optim_threshold': 0.44927477836608887, 'eval_AP': 0.826377332820764, 'eval_MCC': 0.0, 'eval_NDCG': 0.9484015529624095, 'eval_kappa': 0.0, 'eval_runtime': 4.0661, 'eval_samples_per_second': 16.478, 'eval_steps_per_second': 0.984, 'epoch': 4.0}

Trial train_hpo_396923e3 finished iteration 1 at 2025-06-04 18:59:21. Total running time: 42s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_396923e3 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    35.6357 â”‚
â”‚ time_total_s                        35.6357 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     4 â”‚
â”‚ eval_AP                             0.82638 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                            0.9484 â”‚
â”‚ eval_accuracy                       0.25373 â”‚
â”‚ eval_f1                                   0 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           5.18266 â”‚
â”‚ eval_optim_threshold                0.44927 â”‚
â”‚ eval_precision                            0 â”‚
â”‚ eval_recall                               0 â”‚
â”‚ eval_runtime                         4.0661 â”‚
â”‚ eval_samples_per_second              16.478 â”‚
â”‚ eval_steps_per_second                 0.984 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_396923e3 completed after 1 iterations at 2025-06-04 18:59:21. Total running time: 42s
[36m(train_hpo pid=3403232)[0m {'train_runtime': 25.2097, 'train_samples_per_second': 39.271, 'train_steps_per_second': 0.397, 'train_loss': 1.9419832944869995, 'epoch': 3.4}
[36m(train_hpo pid=3403232)[0m STATE at ending of training  :  TrainerState(epoch=3.4, global_step=10, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=177335259076608.0, log_history=[{'loss': 2.0497, 'grad_norm': 13.806069374084473, 'learning_rate': 3.188774071602418e-06, 'epoch': 1.0, 'step': 3}, {'loss': 1.9191, 'grad_norm': 14.609670639038086, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.0, 'step': 6}, {'loss': 1.7916, 'grad_norm': 17.720855712890625, 'learning_rate': 4.555391530860598e-07, 'epoch': 3.0, 'step': 9}, {'loss': 2.1387, 'grad_norm': 27.408035278320312, 'learning_rate': 0.0, 'epoch': 3.4, 'step': 10}, {'train_runtime': 25.2097, 'train_samples_per_second': 39.271, 'train_steps_per_second': 0.397, 'total_flos': 177335259076608.0, 'train_loss': 1.9419832944869995, 'epoch': 3.4, 'step': 10}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})2025-06-04 18:59:26,328 - INFO - Cleaning up trial b6eb3e39
2025-06-04 18:59:26,328 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_18-58-39/train_hpo_b6eb3e39_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-04_18-58-46
2025-06-04 18:59:26,328 - INFO - Cleaning up trial 396923e3
2025-06-04 18:59:26,328 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_18-58-39/train_hpo_396923e3_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-04_18-58-39
2025-06-04 18:59:26,328 - INFO - Current best: 6af43bd6 with eval_f1 : 0.8547008547008547 at iteration 1
2025-06-04 18:59:26,336	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_18-58-39' in 0.0063s.
2025-06-04 18:59:26,343 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x719ac428ba50>
2025-06-04 18:59:26,343 - INFO - Best trial : train_hpo_b6eb3e39
2025-06-04 18:59:26,344 - INFO - Best config : {'pos_weight': 7.549531688595925, 'learning_rate': 4.555391530860597e-06, 'weight_decay': 0.12303118765599412, 'num_train_epochs': 5}
2025-06-04 18:59:26,344 - INFO - Best trial after optimization: {'eval_loss': 2.115833044052124, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.7228327393531799, 'eval_AP': 0.912508213869889, 'eval_MCC': 0.0, 'eval_NDCG': 0.9791073345526656, 'eval_kappa': 0.0, 'eval_runtime': 3.2695, 'eval_samples_per_second': 20.492, 'eval_steps_per_second': 1.223, 'epoch': 3.4, 'timestamp': 1749056366, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': 'b6eb3e39', 'date': '2025-06-04_18-59-26', 'time_this_iter_s': 33.08959937095642, 'time_total_s': 33.08959937095642, 'pid': 3403232, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 7.549531688595925, 'learning_rate': 4.555391530860597e-06, 'weight_decay': 0.12303118765599412, 'num_train_epochs': 5}, 'time_since_restore': 33.08959937095642, 'iterations_since_restore': 1, 'experiment_tag': '2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230'}
2025-06-04 18:59:26,372 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   5.182665  0.000000  ...                        6  396923e3
1   2.115833  0.854701  ...                        5  b6eb3e39
2   1.151993  0.854701  ...                        3  6af43bd6

[3 rows x 32 columns]
2025-06-04 18:59:26,543 - INFO - Trial comparison plot saved
2025-06-04 18:59:26,543 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-04 18:59:27,203 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-04 18:59:27,299 - INFO - training size : 198
2025-06-04 18:59:27,300 - INFO - dev size : 67
2025-06-04 18:59:27,300 - INFO - test size : 132
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(

[36m(train_hpo pid=3403232)[0m {'loss': 2.1387, 'grad_norm': 27.408035278320312, 'learning_rate': 0.0, 'epoch': 3.4}[32m [repeated 2x across cluster][0m

Trial train_hpo_b6eb3e39 finished iteration 1 at 2025-06-04 18:59:26. Total running time: 46s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_b6eb3e39 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    33.0896 â”‚
â”‚ time_total_s                        33.0896 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   3.4 â”‚
â”‚ eval_AP                             0.91251 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.97911 â”‚
â”‚ eval_accuracy                       0.74627 â”‚
â”‚ eval_f1                              0.8547 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           2.11583 â”‚
â”‚ eval_optim_threshold                0.72283 â”‚
â”‚ eval_precision                      0.74627 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.2695 â”‚
â”‚ eval_samples_per_second              20.492 â”‚
â”‚ eval_steps_per_second                 1.223 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_b6eb3e39 completed after 1 iterations at 2025-06-04 18:59:26. Total running time: 46s

Trial status: 3 TERMINATED
Current time: 2025-06-04 18:59:26. Total running time: 46s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_396923e3   TERMINATED        8.49369       1.49561e-06         0.13641                     6        1            35.6357       5.18266    0                      0          0.253731 â”‚
â”‚ train_hpo_b6eb3e39   TERMINATED        7.54953       4.55539e-06         0.123031                    5        1            33.0896       2.11583    0.854701               1          0.746269 â”‚
â”‚ train_hpo_6af43bd6   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            15.9148       1.15199    0.854701               1          0.746269 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

  0%|          | 0/45 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  2%|â–         | 1/45 [00:00<00:28,  1.53it/s]  4%|â–         | 2/45 [00:01<00:27,  1.58it/s]  7%|â–‹         | 3/45 [00:01<00:26,  1.60it/s]  9%|â–‰         | 4/45 [00:02<00:25,  1.61it/s] 11%|â–ˆ         | 5/45 [00:03<00:24,  1.61it/s] 13%|â–ˆâ–Ž        | 6/45 [00:03<00:24,  1.61it/s] 16%|â–ˆâ–Œ        | 7/45 [00:04<00:23,  1.61it/s] 18%|â–ˆâ–Š        | 8/45 [00:04<00:22,  1.63it/s] 20%|â–ˆâ–ˆ        | 9/45 [00:05<00:18,  1.91it/s]                                               20%|â–ˆâ–ˆ        | 9/45 [00:05<00:18,  1.91it/s] 22%|â–ˆâ–ˆâ–       | 10/45 [00:05<00:19,  1.79it/s] 24%|â–ˆâ–ˆâ–       | 11/45 [00:06<00:19,  1.73it/s] 27%|â–ˆâ–ˆâ–‹       | 12/45 [00:07<00:19,  1.69it/s] 29%|â–ˆâ–ˆâ–‰       | 13/45 [00:07<00:19,  1.67it/s] 31%|â–ˆâ–ˆâ–ˆ       | 14/45 [00:08<00:18,  1.65it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 15/45 [00:09<00:18,  1.64it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 16/45 [00:09<00:17,  1.64it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 17/45 [00:10<00:17,  1.64it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 18/45 [00:10<00:14,  1.91it/s]                                                40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 18/45 [00:10<00:14,  1.91it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 19/45 [00:11<00:14,  1.79it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 20/45 [00:11<00:14,  1.74it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 21/45 [00:12<00:14,  1.70it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 22/45 [00:13<00:13,  1.67it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 23/45 [00:13<00:13,  1.66it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 24/45 [00:14<00:12,  1.64it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 25/45 [00:14<00:12,  1.64it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 26/45 [00:15<00:11,  1.64it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 27/45 [00:15<00:09,  1.91it/s]                                                60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 27/45 [00:15<00:09,  1.91it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 28/45 [00:16<00:09,  1.79it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 29/45 [00:17<00:09,  1.74it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 30/45 [00:17<00:08,  1.70it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 31/45 [00:18<00:08,  1.68it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 32/45 [00:18<00:07,  1.66it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 33/45 [00:19<00:07,  1.65it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 34/45 [00:20<00:06,  1.64it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 35/45 [00:20<00:06,  1.65it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 36/45 [00:21<00:04,  1.92it/s]                                                80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 36/45 [00:21<00:04,  1.92it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 37/45 [00:21<00:04,  1.80it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 38/45 [00:22<00:04,  1.74it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 39/45 [00:22<00:03,  1.70it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 40/45 [00:23<00:02,  1.67it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 41/45 [00:24<00:02,  1.66it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 42/45 [00:24<00:01,  1.64it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 43/45 [00:25<00:01,  1.64it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 44/45 [00:26<00:00,  1.64it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45/45 [00:26<00:00,  1.91it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45/45 [00:27<00:00,  1.91it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45/45 [00:27<00:00,  1.91it/s]2025-06-04 18:59:55,759 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45/45 [00:27<00:00,  1.61it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
{'loss': 5.4064, 'grad_norm': 41.29254150390625, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0}
{'loss': 3.2194, 'grad_norm': 26.172901153564453, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0}
{'loss': 1.8472, 'grad_norm': 32.208431243896484, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0}
{'loss': 1.6659, 'grad_norm': 30.242231369018555, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0}
{'loss': 1.505, 'grad_norm': 22.546016693115234, 'learning_rate': 0.0, 'epoch': 5.0}
{'train_runtime': 27.9959, 'train_samples_per_second': 35.362, 'train_steps_per_second': 1.607, 'train_loss': 2.7287812762790256, 'epoch': 5.0}
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.25it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.44it/s]2025-06-04 19:00:02,031 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:05<00:00,  1.99s/it]
2025-06-04 19:00:02,037 - INFO - Training time : 35.4939564820379
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.12it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.03it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.36it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.11it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.35it/s]2025-06-04 19:00:06,529 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.43it/s]
2025-06-04 19:00:06,534 - INFO - Evaluation time : 4.496967602986842
2025-06-04 19:00:06,534 - INFO - Evaluation results on test set: {'eval_loss': 1.4743037223815918, 'eval_f1': 0.8660714285714286, 'eval_recall': 1.0, 'eval_accuracy': 0.7727272727272727, 'eval_precision': 0.7637795275590551, 'eval_optim_threshold': 0.7472442984580994, 'eval_AP': 0.999306106264869, 'eval_MCC': 0.3303200888227433, 'eval_NDCG': 0.9998906069309654, 'eval_kappa': 0.19675456389452328, 'eval_runtime': 4.4922, 'eval_samples_per_second': 29.384, 'eval_steps_per_second': 1.336, 'epoch': 5.0}
2025-06-04 19:00:06,534 - INFO - Total updates (optimizer steps): 45
2025-06-04 19:00:06,534 - INFO - Avg time / step: 0.622s
2025-06-04 19:00:07,324 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCEdmis-lab/biobert-v1.13trials_fold-3
2025-06-04 19:00:07,324 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.17it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.05it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.38it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.12it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.35it/s]2025-06-04 19:00:11,812 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.43it/s]
2025-06-04 19:00:11,817 - INFO - preds : [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 0 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1]
2025-06-04 19:00:11,818 - INFO - test_split["labels"] : [1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1]
2025-06-04 19:00:11,819 - INFO - Confusion matrix: TN=5, FP=30, FN=0, TP=97
2025-06-04 19:00:14,587 - INFO - Metrics: {'f1': 0.8660714285714286, 'recall': 1.0, 'precision': 0.7637795275590551, 'accuracy': 0.7727272727272727, 'AP': 0.999306106264869, 'MCC': 0.3303200888227433, 'NDCG': 0.9998906069309654, 'kappa': 0.19675456389452328, 'TN': 5, 'FP': 30, 'FN': 0, 'TP': 97}
2025-06-04 19:00:14,701 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-04 19:00:14,798 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:00:14,798 - INFO - 
On test Set (optimal threshold of 0.6839479804039001 according to cross validation on the training set): 
2025-06-04 19:00:14,800 - INFO - Confusion matrix: TN=33, FP=2, FN=1, TP=96
2025-06-04 19:00:17,733 - INFO - Metrics: {'f1': 0.9846153846153847, 'recall': 0.9896907216494846, 'precision': 0.9795918367346939, 'accuracy': 0.9772727272727273, 'AP': 0.999306106264869, 'MCC': 0.9413226848786879, 'NDCG': 0.9998906069309654, 'kappa': 0.941141498216409, 'TN': 33, 'FP': 2, 'FN': 1, 'TP': 96}
2025-06-04 19:00:17,832 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:00:17,832 - INFO - Results for fold 3 : [{'f1': 0.9846153846153847, 'recall': 0.9896907216494846, 'precision': 0.9795918367346939, 'accuracy': 0.9772727272727273, 'AP': 0.999306106264869, 'MCC': 0.9413226848786879, 'NDCG': 0.9998906069309654, 'kappa': 0.941141498216409, 'TN': 33, 'FP': 2, 'FN': 1, 'TP': 96}]
2025-06-04 19:00:17,942 - INFO - Cleared CUDA cache. Memory allocated: 1.41 GB, Memory reserved: 1.79 GB
2025-06-04 19:00:17,942 - INFO - Cleared CUDA cache. Memory allocated: 1.41 GB, Memory reserved: 1.79 GB
2025-06-04 19:00:17,987 - INFO - Cleared CUDA cache. Memory allocated: 0.02 GB, Memory reserved: 0.03 GB
2025-06-04 19:00:18,000 - INFO - Metrics for dmis-lab/biobert-v1.1:               model_name fold loss_type run  ...   TN    FP   FN    TP
0  dmis-lab/biobert-v1.1    1       BCE   1  ...  0.0  35.0  0.0  98.0
0  dmis-lab/biobert-v1.1    2       BCE   1  ...  0.0  34.0  0.0  98.0
0  dmis-lab/biobert-v1.1    3       BCE   1  ...  5.0  30.0  0.0  97.0

[3 rows x 18 columns]
2025-06-04 19:00:18,000 - INFO - Training model 2/2: google-bert/bert-base-uncased
2025-06-04 19:00:18,186 - INFO - 
fold number 1 / 3
2025-06-04 19:00:18,195 - INFO - train split size : 198
2025-06-04 19:00:18,195 - INFO - dev split size : 66
2025-06-04 19:00:18,195 - INFO - test split size : 133
Map (num_proc=32):   0%|          | 0/198 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–Ž         | 7/198 [00:00<00:05, 36.82 examples/s]Map (num_proc=32):  21%|â–ˆâ–ˆ        | 42/198 [00:00<00:00, 158.34 examples/s]Map (num_proc=32):  39%|â–ˆâ–ˆâ–ˆâ–‰      | 78/198 [00:00<00:00, 214.10 examples/s]Map (num_proc=32):  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 108/198 [00:00<00:00, 238.65 examples/s]Map (num_proc=32):  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 144/198 [00:00<00:00, 270.72 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 180/198 [00:00<00:00, 288.66 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 198/198 [00:00<00:00, 216.05 examples/s]
Map (num_proc=32):   0%|          | 0/66 [00:00<?, ? examples/s]Map (num_proc=32):   5%|â–         | 3/66 [00:00<00:03, 16.75 examples/s]Map (num_proc=32):  21%|â–ˆâ–ˆ        | 14/66 [00:00<00:00, 57.05 examples/s]Map (num_proc=32):  36%|â–ˆâ–ˆâ–ˆâ–‹      | 24/66 [00:00<00:00, 70.88 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 34/66 [00:00<00:00, 79.69 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 44/66 [00:00<00:00, 86.17 examples/s]Map (num_proc=32):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 54/66 [00:00<00:00, 89.01 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 64/66 [00:00<00:00, 91.41 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 66/66 [00:00<00:00, 69.97 examples/s]
Map (num_proc=32):   0%|          | 0/133 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/133 [00:00<00:04, 27.47 examples/s]Map (num_proc=32):  22%|â–ˆâ–ˆâ–       | 29/133 [00:00<00:00, 118.01 examples/s]Map (num_proc=32):  37%|â–ˆâ–ˆâ–ˆâ–‹      | 49/133 [00:00<00:00, 138.77 examples/s]Map (num_proc=32):  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 73/133 [00:00<00:00, 160.31 examples/s]Map (num_proc=32):  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 97/133 [00:00<00:00, 179.17 examples/s]Map (num_proc=32):  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 117/133 [00:00<00:00, 182.38 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 133/133 [00:00<00:00, 140.82 examples/s]
2025-06-04 19:00:26,495 - INFO - 3 datasets tokenized successfully
2025-06-04 19:00:26,496 - INFO - Starting hyperparameter search for BCE loss
[36m(train_hpo pid=3406155)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3406155)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3403232)[0m 2025-06-04 18:59:26,262 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3403232)[0m 2025-06-04 18:59:26,268 - INFO - eval_result: {'eval_loss': 2.115833044052124, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.7228327393531799, 'eval_AP': 0.912508213869889, 'eval_MCC': 0.0, 'eval_NDCG': 0.9791073345526656, 'eval_kappa': 0.0, 'eval_runtime': 3.2695, 'eval_samples_per_second': 20.492, 'eval_steps_per_second': 1.223, 'epoch': 3.4}
[36m(train_hpo pid=3403232)[0m 2025-06-04 18:59:26,303 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3406155)[0m 2025-06-04 19:00:33,866 - INFO - pos_weight value in TrainingArguments : 8.493688290834637
[36m(train_hpo pid=3406155)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3406155)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3406155)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3406155)[0m   warnings.warn(
[36m(train_hpo pid=3406321)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3406321)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3406321)[0m 2025-06-04 19:00:40,746 - INFO - pos_weight value in TrainingArguments : 7.549531688595925
[36m(train_hpo pid=3406321)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3406321)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3406321)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3406321)[0m   warnings.warn(
[36m(train_hpo pid=3406605)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3406605)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3406605)[0m 2025-06-04 19:00:47,677 - INFO - pos_weight value in TrainingArguments : 8.949837496427758
[36m(train_hpo pid=3406605)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3406605)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3406605)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3406605)[0m   warnings.warn(
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-04_19-00-26   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-00-26
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-04_18-54-36_274448_3393636/artifacts/2025-06-04_19-00-26/train_hpo_2025-06-04_19-00-26/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-04 19:00:26. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_299b1d86   PENDING         8.49369       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_299b1d86 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_299b1d86 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          8.49369 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3406155)[0m [2025-06-04 19:00:34,118] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3403232)[0m {'eval_loss': 2.115833044052124, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.7228327393531799, 'eval_AP': 0.912508213869889, 'eval_MCC': 0.0, 'eval_NDCG': 0.9791073345526656, 'eval_kappa': 0.0, 'eval_runtime': 3.2695, 'eval_samples_per_second': 20.492, 'eval_steps_per_second': 1.223, 'epoch': 3.4}
[36m(train_hpo pid=3406155)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=12, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_79b65d83 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_79b65d83 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          7.54953 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3406321)[0m [2025-06-04 19:00:41,120] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3406155)[0m {'loss': 4.0697, 'grad_norm': 38.21735382080078, 'learning_rate': 1.1217049888818266e-06, 'epoch': 1.0}
[36m(train_hpo pid=3406321)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3406155)[0m {'loss': 3.9879, 'grad_norm': 41.317073822021484, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.0}

Trial train_hpo_d2975909 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_d2975909 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          8.94984 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3406605)[0m [2025-06-04 19:00:47,917] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3406605)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=6, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3406321)[0m {'loss': 3.2989, 'grad_norm': 30.207916259765625, 'learning_rate': 3.188774071602418e-06, 'epoch': 1.0}

Trial status: 3 RUNNING
Current time: 2025-06-04 19:00:56. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_299b1d86   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_79b65d83   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_d2975909   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯2025-06-04 19:01:02,611 - INFO - Cleaning up trial d2975909
2025-06-04 19:01:02,611 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-00-26/train_hpo_d2975909_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512_2025-06-04_19-00-40
[36m(train_hpo pid=3406605)[0m 2025-06-04 19:01:02,544 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3406605)[0m 2025-06-04 19:01:02,549 - INFO - eval_result: {'eval_loss': 1.8482016324996948, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.8070663213729858, 'eval_AP': 0.8634925489539207, 'eval_MCC': 0.0, 'eval_NDCG': 0.9685877963781631, 'eval_kappa': 0.0, 'eval_runtime': 3.3068, 'eval_samples_per_second': 19.959, 'eval_steps_per_second': 1.21, 'epoch': 2.0}
[36m(train_hpo pid=3406605)[0m 2025-06-04 19:01:02,584 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3406155)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
[36m(train_hpo pid=3406155)[0m   _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
[36m(train_hpo pid=3406155)[0m 2025-06-04 19:01:08,583 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3406155)[0m 2025-06-04 19:01:08,589 - INFO - eval_result: {'eval_loss': 4.799626350402832, 'eval_f1': 0.0, 'eval_recall': 0.0, 'eval_accuracy': 0.25757575757575757, 'eval_precision': 0.0, 'eval_optim_threshold': 0.4818692207336426, 'eval_AP': 0.7984032820143399, 'eval_MCC': 0.0, 'eval_NDCG': 0.9417831428026399, 'eval_kappa': 0.0, 'eval_runtime': 4.3982, 'eval_samples_per_second': 15.006, 'eval_steps_per_second': 0.909, 'epoch': 4.0}
[36m(train_hpo pid=3406155)[0m 2025-06-04 19:01:08,625 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
2025-06-04 19:01:08,650 - INFO - Cleaning up trial 299b1d86
2025-06-04 19:01:08,650 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-00-26/train_hpo_299b1d86_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-04_19-00-26
2025-06-04 19:01:08,650 - INFO - Current best: d2975909 with eval_f1 : 0.8521739130434782 at iteration 1

[36m(train_hpo pid=3406605)[0m {'train_runtime': 8.0582, 'train_samples_per_second': 73.714, 'train_steps_per_second': 0.745, 'train_loss': 2.8976054986317954, 'epoch': 2.0}
[36m(train_hpo pid=3406605)[0m STATE at ending of training  :  TrainerState(epoch=2.0, global_step=6, max_steps=6, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=104191042424832.0, log_history=[{'loss': 3.7412, 'grad_norm': 24.48684310913086, 'learning_rate': 3.994089731390617e-05, 'epoch': 1.0, 'step': 3}, {'loss': 2.054, 'grad_norm': 13.2774658203125, 'learning_rate': 0.0, 'epoch': 2.0, 'step': 6}, {'train_runtime': 8.0582, 'train_samples_per_second': 73.714, 'train_steps_per_second': 0.745, 'total_flos': 104191042424832.0, 'train_loss': 2.8976054986317954, 'epoch': 2.0, 'step': 6}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3406605)[0m {'loss': 2.054, 'grad_norm': 13.2774658203125, 'learning_rate': 0.0, 'epoch': 2.0}[32m [repeated 3x across cluster][0m

Trial train_hpo_d2975909 finished iteration 1 at 2025-06-04 19:01:02. Total running time: 36s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_d2975909 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    15.3688 â”‚
â”‚ time_total_s                        15.3688 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     2 â”‚
â”‚ eval_AP                             0.86349 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.96859 â”‚
â”‚ eval_accuracy                       0.74242 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                            1.8482 â”‚
â”‚ eval_optim_threshold                0.80707 â”‚
â”‚ eval_precision                      0.74242 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.3068 â”‚
â”‚ eval_samples_per_second              19.959 â”‚
â”‚ eval_steps_per_second                  1.21 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_d2975909 completed after 1 iterations at 2025-06-04 19:01:02. Total running time: 36s
[36m(train_hpo pid=3406605)[0m {'eval_loss': 1.8482016324996948, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.8070663213729858, 'eval_AP': 0.8634925489539207, 'eval_MCC': 0.0, 'eval_NDCG': 0.9685877963781631, 'eval_kappa': 0.0, 'eval_runtime': 3.3068, 'eval_samples_per_second': 19.959, 'eval_steps_per_second': 1.21, 'epoch': 2.0}
[36m(train_hpo pid=3406155)[0m STATE at ending of training  :  TrainerState(epoch=4.0, global_step=12, max_steps=12, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=208382084849664.0, log_history=[{'loss': 4.0697, 'grad_norm': 38.21735382080078, 'learning_rate': 1.1217049888818266e-06, 'epoch': 1.0, 'step': 3}, {'loss': 3.9879, 'grad_norm': 41.317073822021484, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.0, 'step': 6}, {'loss': 3.9755, 'grad_norm': 51.66078567504883, 'learning_rate': 3.7390166296060887e-07, 'epoch': 3.0, 'step': 9}, {'loss': 3.9666, 'grad_norm': 38.500911712646484, 'learning_rate': 0.0, 'epoch': 4.0, 'step': 12}, {'train_runtime': 26.7958, 'train_samples_per_second': 44.335, 'train_steps_per_second': 0.448, 'total_flos': 208382084849664.0, 'train_loss': 3.999928633371989, 'epoch': 4.0, 'step': 12}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3406155)[0m {'train_runtime': 26.7958, 'train_samples_per_second': 44.335, 'train_steps_per_second': 0.448, 'train_loss': 3.999928633371989, 'epoch': 4.0}
[36m(train_hpo pid=3406321)[0m {'loss': 3.1897, 'grad_norm': 42.01555252075195, 'learning_rate': 4.555391530860598e-07, 'epoch': 3.0}[32m [repeated 3x across cluster][0m
[36m(train_hpo pid=3406155)[0m {'eval_loss': 4.799626350402832, 'eval_f1': 0.0, 'eval_recall': 0.0, 'eval_accuracy': 0.25757575757575757, 'eval_precision': 0.0, 'eval_optim_threshold': 0.4818692207336426, 'eval_AP': 0.7984032820143399, 'eval_MCC': 0.0, 'eval_NDCG': 0.9417831428026399, 'eval_kappa': 0.0, 'eval_runtime': 4.3982, 'eval_samples_per_second': 15.006, 'eval_steps_per_second': 0.909, 'epoch': 4.0}

Trial train_hpo_299b1d86 finished iteration 1 at 2025-06-04 19:01:08. Total running time: 42s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_299b1d86 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    35.2224 â”‚
â”‚ time_total_s                        35.2224 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     4 â”‚
â”‚ eval_AP                              0.7984 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.94178 â”‚
â”‚ eval_accuracy                       0.25758 â”‚
â”‚ eval_f1                                   0 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           4.79963 â”‚
â”‚ eval_optim_threshold                0.48187 â”‚
â”‚ eval_precision                            0 â”‚
â”‚ eval_recall                               0 â”‚
â”‚ eval_runtime                         4.3982 â”‚
â”‚ eval_samples_per_second              15.006 â”‚
â”‚ eval_steps_per_second                 0.909 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_299b1d86 completed after 1 iterations at 2025-06-04 19:01:08. Total running time: 42s
[36m(train_hpo pid=3406321)[0m {'train_runtime': 25.0517, 'train_samples_per_second': 39.518, 'train_steps_per_second': 0.399, 'train_loss': 3.2654227733612062, 'epoch': 3.4}
[36m(train_hpo pid=3406321)[0m STATE at ending of training  :  TrainerState(epoch=3.4, global_step=10, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=177335259076608.0, log_history=[{'loss': 3.2989, 'grad_norm': 30.207916259765625, 'learning_rate': 3.188774071602418e-06, 'epoch': 1.0, 'step': 3}, {'loss': 3.1717, 'grad_norm': 34.1197624206543, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.0, 'step': 6}, {'loss': 3.1897, 'grad_norm': 42.01555252075195, 'learning_rate': 4.555391530860598e-07, 'epoch': 3.0, 'step': 9}, {'loss': 3.6732, 'grad_norm': 64.43852996826172, 'learning_rate': 0.0, 'epoch': 3.4, 'step': 10}, {'train_runtime': 25.0517, 'train_samples_per_second': 39.518, 'train_steps_per_second': 0.399, 'total_flos': 177335259076608.0, 'train_loss': 3.2654227733612062, 'epoch': 3.4, 'step': 10}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})2025-06-04 19:01:13,273 - INFO - Cleaning up trial 79b65d83
2025-06-04 19:01:13,273 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-00-26/train_hpo_79b65d83_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-04_19-00-33
2025-06-04 19:01:13,273 - INFO - Cleaning up trial 299b1d86
2025-06-04 19:01:13,273 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-00-26/train_hpo_299b1d86_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-04_19-00-26
2025-06-04 19:01:13,274 - INFO - Current best: d2975909 with eval_f1 : 0.8521739130434782 at iteration 1
2025-06-04 19:01:13,282	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-00-26' in 0.0068s.
2025-06-04 19:01:13,290 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x719abc14eb10>
2025-06-04 19:01:13,290 - INFO - Best trial : train_hpo_79b65d83
2025-06-04 19:01:13,290 - INFO - Best config : {'pos_weight': 7.549531688595925, 'learning_rate': 4.555391530860597e-06, 'weight_decay': 0.12303118765599412, 'num_train_epochs': 5}
2025-06-04 19:01:13,290 - INFO - Best trial after optimization: {'eval_loss': 3.697144031524658, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.5336548089981079, 'eval_AP': 0.8309325054754626, 'eval_MCC': 0.0, 'eval_NDCG': 0.9095671375435946, 'eval_kappa': 0.0, 'eval_runtime': 3.7472, 'eval_samples_per_second': 17.613, 'eval_steps_per_second': 1.067, 'epoch': 3.4, 'timestamp': 1749056473, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '79b65d83', 'date': '2025-06-04_19-01-13', 'time_this_iter_s': 32.95614004135132, 'time_total_s': 32.95614004135132, 'pid': 3406321, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 7.549531688595925, 'learning_rate': 4.555391530860597e-06, 'weight_decay': 0.12303118765599412, 'num_train_epochs': 5}, 'time_since_restore': 32.95614004135132, 'iterations_since_restore': 1, 'experiment_tag': '2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230'}
2025-06-04 19:01:13,311 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   4.799626  0.000000  ...                        6  299b1d86
1   3.697144  0.852174  ...                        5  79b65d83
2   1.848202  0.852174  ...                        3  d2975909

[3 rows x 32 columns]
2025-06-04 19:01:13,456 - INFO - Trial comparison plot saved
2025-06-04 19:01:13,456 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-04 19:01:13,663 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-04 19:01:13,780 - INFO - training size : 198
2025-06-04 19:01:13,781 - INFO - dev size : 66
2025-06-04 19:01:13,781 - INFO - test size : 133
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(

[36m(train_hpo pid=3406321)[0m {'loss': 3.6732, 'grad_norm': 64.43852996826172, 'learning_rate': 0.0, 'epoch': 3.4}

Trial train_hpo_79b65d83 finished iteration 1 at 2025-06-04 19:01:13. Total running time: 46s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_79b65d83 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    32.9561 â”‚
â”‚ time_total_s                        32.9561 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   3.4 â”‚
â”‚ eval_AP                             0.83093 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.90957 â”‚
â”‚ eval_accuracy                       0.74242 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           3.69714 â”‚
â”‚ eval_optim_threshold                0.53365 â”‚
â”‚ eval_precision                      0.74242 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.7472 â”‚
â”‚ eval_samples_per_second              17.613 â”‚
â”‚ eval_steps_per_second                 1.067 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_79b65d83 completed after 1 iterations at 2025-06-04 19:01:13. Total running time: 46s

Trial status: 3 TERMINATED
Current time: 2025-06-04 19:01:13. Total running time: 46s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_299b1d86   TERMINATED        8.49369       1.49561e-06         0.13641                     6        1            35.2224       4.79963    0                      0          0.257576 â”‚
â”‚ train_hpo_79b65d83   TERMINATED        7.54953       4.55539e-06         0.123031                    5        1            32.9561       3.69714    0.852174               1          0.742424 â”‚
â”‚ train_hpo_d2975909   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            15.3688       1.8482     0.852174               1          0.742424 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

  0%|          | 0/45 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  2%|â–         | 1/45 [00:00<00:28,  1.53it/s]  4%|â–         | 2/45 [00:01<00:27,  1.58it/s]  7%|â–‹         | 3/45 [00:01<00:26,  1.59it/s]  9%|â–‰         | 4/45 [00:02<00:25,  1.60it/s] 11%|â–ˆ         | 5/45 [00:03<00:24,  1.61it/s] 13%|â–ˆâ–Ž        | 6/45 [00:03<00:24,  1.61it/s] 16%|â–ˆâ–Œ        | 7/45 [00:04<00:23,  1.61it/s] 18%|â–ˆâ–Š        | 8/45 [00:04<00:22,  1.62it/s] 20%|â–ˆâ–ˆ        | 9/45 [00:05<00:18,  1.90it/s]                                               20%|â–ˆâ–ˆ        | 9/45 [00:05<00:18,  1.90it/s] 22%|â–ˆâ–ˆâ–       | 10/45 [00:05<00:19,  1.78it/s] 24%|â–ˆâ–ˆâ–       | 11/45 [00:06<00:19,  1.72it/s] 27%|â–ˆâ–ˆâ–‹       | 12/45 [00:07<00:19,  1.69it/s] 29%|â–ˆâ–ˆâ–‰       | 13/45 [00:07<00:19,  1.66it/s] 31%|â–ˆâ–ˆâ–ˆ       | 14/45 [00:08<00:18,  1.65it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 15/45 [00:09<00:18,  1.63it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 16/45 [00:09<00:17,  1.62it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 17/45 [00:10<00:17,  1.63it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 18/45 [00:10<00:14,  1.90it/s]                                                40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 18/45 [00:10<00:14,  1.90it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 19/45 [00:11<00:14,  1.78it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 20/45 [00:11<00:14,  1.72it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 21/45 [00:12<00:14,  1.69it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 22/45 [00:13<00:13,  1.67it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 23/45 [00:13<00:13,  1.65it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 24/45 [00:14<00:12,  1.63it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 25/45 [00:14<00:12,  1.63it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 26/45 [00:15<00:11,  1.63it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 27/45 [00:15<00:09,  1.90it/s]                                                60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 27/45 [00:15<00:09,  1.90it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 28/45 [00:16<00:09,  1.78it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 29/45 [00:17<00:09,  1.73it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 30/45 [00:17<00:08,  1.69it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 31/45 [00:18<00:08,  1.66it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 32/45 [00:19<00:07,  1.65it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 33/45 [00:19<00:07,  1.64it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 34/45 [00:20<00:06,  1.63it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 35/45 [00:20<00:06,  1.63it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 36/45 [00:21<00:04,  1.90it/s]                                                80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 36/45 [00:21<00:04,  1.90it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 37/45 [00:21<00:04,  1.76it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 38/45 [00:22<00:04,  1.71it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 39/45 [00:23<00:03,  1.68it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 40/45 [00:23<00:03,  1.66it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 41/45 [00:24<00:02,  1.64it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 42/45 [00:24<00:01,  1.63it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 43/45 [00:25<00:01,  1.63it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 44/45 [00:26<00:00,  1.64it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45/45 [00:26<00:00,  1.90it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45/45 [00:28<00:00,  1.90it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45/45 [00:28<00:00,  1.90it/s]2025-06-04 19:01:42,545 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45/45 [00:28<00:00,  1.59it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
{'loss': 2.4921, 'grad_norm': 21.103378295898438, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0}
{'loss': 2.189, 'grad_norm': 26.837430953979492, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0}
{'loss': 1.9389, 'grad_norm': 38.72433090209961, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0}
{'loss': 1.7076, 'grad_norm': 37.562252044677734, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0}
{'loss': 1.6212, 'grad_norm': 20.308210372924805, 'learning_rate': 0.0, 'epoch': 5.0}
{'train_runtime': 28.3232, 'train_samples_per_second': 34.954, 'train_steps_per_second': 1.589, 'train_loss': 1.9897561391194662, 'epoch': 5.0}
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.25it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.61it/s]2025-06-04 19:01:46,395 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.18s/it]
2025-06-04 19:01:46,401 - INFO - Training time : 32.94474575505592
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.10it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  4.99it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.30it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.07it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.22it/s]2025-06-04 19:01:50,958 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.41it/s]
2025-06-04 19:01:50,964 - INFO - Evaluation time : 4.5625095050781965
2025-06-04 19:01:50,964 - INFO - Evaluation results on test set: {'eval_loss': 1.546017050743103, 'eval_f1': 0.8484848484848485, 'eval_recall': 1.0, 'eval_accuracy': 0.7368421052631579, 'eval_precision': 0.7368421052631579, 'eval_optim_threshold': 0.7832239866256714, 'eval_AP': 0.9884497249128819, 'eval_MCC': 0.0, 'eval_NDCG': 0.9980935571448064, 'eval_kappa': 0.0, 'eval_runtime': 4.5579, 'eval_samples_per_second': 29.18, 'eval_steps_per_second': 1.316, 'epoch': 5.0}
2025-06-04 19:01:50,964 - INFO - Total updates (optimizer steps): 45
2025-06-04 19:01:50,964 - INFO - Avg time / step: 0.629s
2025-06-04 19:01:51,739 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCEgoogle-bert/bert-base-uncased3trials_fold-1
2025-06-04 19:01:51,739 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.09it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.01it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.34it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.08it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.23it/s]2025-06-04 19:01:56,264 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.42it/s]
2025-06-04 19:01:56,268 - INFO - preds : [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
2025-06-04 19:01:56,269 - INFO - test_split["labels"] : [1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0]
2025-06-04 19:01:56,270 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:01:59,074 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': 0.9884497249128819, 'MCC': 0.0, 'NDCG': 0.9980935571448064, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:01:59,191 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-04 19:01:59,291 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:01:59,291 - INFO - 
On test Set (optimal threshold of 0.7886089086532593 according to cross validation on the training set): 
2025-06-04 19:01:59,293 - INFO - Confusion matrix: TN=34, FP=1, FN=13, TP=85
2025-06-04 19:02:02,044 - INFO - Metrics: {'f1': 0.9239130434782609, 'recall': 0.8673469387755102, 'precision': 0.9883720930232558, 'accuracy': 0.8947368421052632, 'AP': 0.9884497249128819, 'MCC': 0.7726710617928554, 'NDCG': 0.9980935571448064, 'kappa': 0.7555147058823529, 'TN': 34, 'FP': 1, 'FN': 13, 'TP': 85}
2025-06-04 19:02:02,151 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:02:02,151 - INFO - Results for fold 1 : [{'f1': 0.9239130434782609, 'recall': 0.8673469387755102, 'precision': 0.9883720930232558, 'accuracy': 0.8947368421052632, 'AP': 0.9884497249128819, 'MCC': 0.7726710617928554, 'NDCG': 0.9980935571448064, 'kappa': 0.7555147058823529, 'TN': 34, 'FP': 1, 'FN': 13, 'TP': 85}]
2025-06-04 19:02:02,273 - INFO - Cleared CUDA cache. Memory allocated: 1.40 GB, Memory reserved: 1.77 GB
2025-06-04 19:02:02,273 - INFO - 
fold number 2 / 3
2025-06-04 19:02:02,278 - INFO - train split size : 198
2025-06-04 19:02:02,278 - INFO - dev split size : 67
2025-06-04 19:02:02,278 - INFO - test split size : 132
Map (num_proc=32):   0%|          | 0/198 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–Ž         | 7/198 [00:00<00:04, 39.40 examples/s]Map (num_proc=32):  21%|â–ˆâ–ˆ        | 42/198 [00:00<00:00, 176.12 examples/s]Map (num_proc=32):  36%|â–ˆâ–ˆâ–ˆâ–‹      | 72/198 [00:00<00:00, 221.56 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 102/198 [00:00<00:00, 247.82 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 132/198 [00:00<00:00, 264.12 examples/s]Map (num_proc=32):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 162/198 [00:00<00:00, 274.08 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 192/198 [00:00<00:00, 270.40 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 198/198 [00:00<00:00, 205.82 examples/s]
Map (num_proc=32):   0%|          | 0/67 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/67 [00:00<00:03, 18.18 examples/s]Map (num_proc=32):  25%|â–ˆâ–ˆâ–Œ       | 17/67 [00:00<00:00, 69.68 examples/s]Map (num_proc=32):  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 27/67 [00:00<00:00, 80.93 examples/s]Map (num_proc=32):  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 37/67 [00:00<00:00, 86.99 examples/s]Map (num_proc=32):  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 47/67 [00:00<00:00, 90.31 examples/s]Map (num_proc=32):  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 57/67 [00:00<00:00, 92.37 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:00<00:00, 94.27 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:00<00:00, 73.90 examples/s]
Map (num_proc=32):   0%|          | 0/132 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/132 [00:00<00:04, 29.54 examples/s]Map (num_proc=32):  21%|â–ˆâ–ˆ        | 28/132 [00:00<00:00, 119.62 examples/s]Map (num_proc=32):  39%|â–ˆâ–ˆâ–ˆâ–‰      | 52/132 [00:00<00:00, 157.85 examples/s]Map (num_proc=32):  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 72/132 [00:00<00:00, 171.46 examples/s]Map (num_proc=32):  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 92/132 [00:00<00:00, 178.77 examples/s]Map (num_proc=32):  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 116/132 [00:00<00:00, 190.77 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 132/132 [00:00<00:00, 146.84 examples/s]
2025-06-04 19:02:11,114 - INFO - 3 datasets tokenized successfully
2025-06-04 19:02:11,116 - INFO - Starting hyperparameter search for BCE loss
[36m(train_hpo pid=3408968)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3408968)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3406321)[0m 2025-06-04 19:01:13,206 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3406321)[0m 2025-06-04 19:01:13,211 - INFO - eval_result: {'eval_loss': 3.697144031524658, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.5336548089981079, 'eval_AP': 0.8309325054754626, 'eval_MCC': 0.0, 'eval_NDCG': 0.9095671375435946, 'eval_kappa': 0.0, 'eval_runtime': 3.7472, 'eval_samples_per_second': 17.613, 'eval_steps_per_second': 1.067, 'epoch': 3.4}
[36m(train_hpo pid=3406321)[0m 2025-06-04 19:01:13,247 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3408968)[0m 2025-06-04 19:02:18,385 - INFO - pos_weight value in TrainingArguments : 8.493688290834637
[36m(train_hpo pid=3408968)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3408968)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3408968)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3408968)[0m   warnings.warn(
[36m(train_hpo pid=3409134)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3409134)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3409134)[0m 2025-06-04 19:02:25,381 - INFO - pos_weight value in TrainingArguments : 7.549531688595925
[36m(train_hpo pid=3409134)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3409134)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3409134)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3409134)[0m   warnings.warn(
[36m(train_hpo pid=3409418)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3409418)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3409418)[0m 2025-06-04 19:02:32,356 - INFO - pos_weight value in TrainingArguments : 8.949837496427758
[36m(train_hpo pid=3409418)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3409418)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3409418)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3409418)[0m   warnings.warn(
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-04_19-02-11   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-02-11
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-04_18-54-36_274448_3393636/artifacts/2025-06-04_19-02-11/train_hpo_2025-06-04_19-02-11/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-04 19:02:11. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_07cc5ecb   PENDING         8.49369       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_07cc5ecb started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_07cc5ecb config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          8.49369 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3408968)[0m [2025-06-04 19:02:18,638] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3406321)[0m {'eval_loss': 3.697144031524658, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.5336548089981079, 'eval_AP': 0.8309325054754626, 'eval_MCC': 0.0, 'eval_NDCG': 0.9095671375435946, 'eval_kappa': 0.0, 'eval_runtime': 3.7472, 'eval_samples_per_second': 17.613, 'eval_steps_per_second': 1.067, 'epoch': 3.4}
[36m(train_hpo pid=3408968)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=12, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_25cf60a4 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_25cf60a4 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          7.54953 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3409134)[0m [2025-06-04 19:02:25,777] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3408968)[0m {'loss': 4.2274, 'grad_norm': 38.19997024536133, 'learning_rate': 1.1217049888818266e-06, 'epoch': 1.0}
[36m(train_hpo pid=3409134)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3408968)[0m {'loss': 4.2017, 'grad_norm': 43.146114349365234, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.0}

Trial train_hpo_4fa3a1d7 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_4fa3a1d7 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          8.94984 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3409418)[0m [2025-06-04 19:02:32,602] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3409418)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=6, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3409134)[0m {'loss': 6.6618, 'grad_norm': 49.21542739868164, 'learning_rate': 3.188774071602418e-06, 'epoch': 1.0}

Trial status: 3 RUNNING
Current time: 2025-06-04 19:02:41. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_07cc5ecb   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_25cf60a4   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_4fa3a1d7   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(train_hpo pid=3409418)[0m 2025-06-04 19:02:47,232 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3409418)[0m 2025-06-04 19:02:47,238 - INFO - eval_result: {'eval_loss': 1.5672345161437988, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.8061334490776062, 'eval_AP': 1.0, 'eval_MCC': 0.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 0.0, 'eval_runtime': 3.3464, 'eval_samples_per_second': 20.022, 'eval_steps_per_second': 1.195, 'epoch': 2.0}
2025-06-04 19:02:47,299 - INFO - Cleaning up trial 4fa3a1d7
2025-06-04 19:02:47,300 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-02-11/train_hpo_4fa3a1d7_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512_2025-06-04_19-02-24
[36m(train_hpo pid=3409418)[0m 2025-06-04 19:02:47,275 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3408968)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
[36m(train_hpo pid=3408968)[0m   _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
[36m(train_hpo pid=3408968)[0m 2025-06-04 19:02:52,511 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3408968)[0m 2025-06-04 19:02:52,517 - INFO - eval_result: {'eval_loss': 4.857252597808838, 'eval_f1': 0.0, 'eval_recall': 0.0, 'eval_accuracy': 0.26865671641791045, 'eval_precision': 0.0, 'eval_optim_threshold': 0.469552606344223, 'eval_AP': 0.7440857141600247, 'eval_MCC': 0.0, 'eval_NDCG': 0.8833706332614408, 'eval_kappa': 0.0, 'eval_runtime': 4.0121, 'eval_samples_per_second': 16.699, 'eval_steps_per_second': 0.997, 'epoch': 4.0}
[36m(train_hpo pid=3408968)[0m 2025-06-04 19:02:52,551 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
2025-06-04 19:02:52,574 - INFO - Cleaning up trial 07cc5ecb
2025-06-04 19:02:52,574 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-02-11/train_hpo_07cc5ecb_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-04_19-02-11
2025-06-04 19:02:52,574 - INFO - Current best: 4fa3a1d7 with eval_f1 : 0.8448275862068966 at iteration 1

[36m(train_hpo pid=3409418)[0m {'train_runtime': 8.0418, 'train_samples_per_second': 73.864, 'train_steps_per_second': 0.746, 'train_loss': 3.1402350266774497, 'epoch': 2.0}
[36m(train_hpo pid=3409418)[0m STATE at ending of training  :  TrainerState(epoch=2.0, global_step=6, max_steps=6, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=104191042424832.0, log_history=[{'loss': 4.3907, 'grad_norm': 23.0416202545166, 'learning_rate': 3.994089731390617e-05, 'epoch': 1.0, 'step': 3}, {'loss': 1.8898, 'grad_norm': 12.013223648071289, 'learning_rate': 0.0, 'epoch': 2.0, 'step': 6}, {'train_runtime': 8.0418, 'train_samples_per_second': 73.864, 'train_steps_per_second': 0.746, 'total_flos': 104191042424832.0, 'train_loss': 3.1402350266774497, 'epoch': 2.0, 'step': 6}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3409418)[0m {'loss': 1.8898, 'grad_norm': 12.013223648071289, 'learning_rate': 0.0, 'epoch': 2.0}[32m [repeated 3x across cluster][0m
[36m(train_hpo pid=3409418)[0m {'eval_loss': 1.5672345161437988, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.8061334490776062, 'eval_AP': 1.0, 'eval_MCC': 0.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 0.0, 'eval_runtime': 3.3464, 'eval_samples_per_second': 20.022, 'eval_steps_per_second': 1.195, 'epoch': 2.0}

Trial train_hpo_4fa3a1d7 finished iteration 1 at 2025-06-04 19:02:47. Total running time: 36s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_4fa3a1d7 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    15.4782 â”‚
â”‚ time_total_s                        15.4782 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     2 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                       0.73134 â”‚
â”‚ eval_f1                             0.84483 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.56723 â”‚
â”‚ eval_optim_threshold                0.80613 â”‚
â”‚ eval_precision                      0.73134 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.3464 â”‚
â”‚ eval_samples_per_second              20.022 â”‚
â”‚ eval_steps_per_second                 1.195 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_4fa3a1d7 completed after 1 iterations at 2025-06-04 19:02:47. Total running time: 36s
[36m(train_hpo pid=3408968)[0m STATE at ending of training  :  TrainerState(epoch=4.0, global_step=12, max_steps=12, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=208382084849664.0, log_history=[{'loss': 4.2274, 'grad_norm': 38.19997024536133, 'learning_rate': 1.1217049888818266e-06, 'epoch': 1.0, 'step': 3}, {'loss': 4.2017, 'grad_norm': 43.146114349365234, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.0, 'step': 6}, {'loss': 4.2357, 'grad_norm': 52.75139617919922, 'learning_rate': 3.7390166296060887e-07, 'epoch': 3.0, 'step': 9}, {'loss': 4.0781, 'grad_norm': 38.42606735229492, 'learning_rate': 0.0, 'epoch': 4.0, 'step': 12}, {'train_runtime': 26.5652, 'train_samples_per_second': 44.72, 'train_steps_per_second': 0.452, 'total_flos': 208382084849664.0, 'train_loss': 4.1857326825459795, 'epoch': 4.0, 'step': 12}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3408968)[0m {'train_runtime': 26.5652, 'train_samples_per_second': 44.72, 'train_steps_per_second': 0.452, 'train_loss': 4.1857326825459795, 'epoch': 4.0}
[36m(train_hpo pid=3409134)[0m {'loss': 6.1036, 'grad_norm': 60.94226837158203, 'learning_rate': 4.555391530860598e-07, 'epoch': 3.0}[32m [repeated 3x across cluster][0m
[36m(train_hpo pid=3408968)[0m {'eval_loss': 4.857252597808838, 'eval_f1': 0.0, 'eval_recall': 0.0, 'eval_accuracy': 0.26865671641791045, 'eval_precision': 0.0, 'eval_optim_threshold': 0.469552606344223, 'eval_AP': 0.7440857141600247, 'eval_MCC': 0.0, 'eval_NDCG': 0.8833706332614408, 'eval_kappa': 0.0, 'eval_runtime': 4.0121, 'eval_samples_per_second': 16.699, 'eval_steps_per_second': 0.997, 'epoch': 4.0}

Trial train_hpo_07cc5ecb finished iteration 1 at 2025-06-04 19:02:52. Total running time: 41s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_07cc5ecb result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    34.6137 â”‚
â”‚ time_total_s                        34.6137 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     4 â”‚
â”‚ eval_AP                             0.74409 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.88337 â”‚
â”‚ eval_accuracy                       0.26866 â”‚
â”‚ eval_f1                                   0 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           4.85725 â”‚
â”‚ eval_optim_threshold                0.46955 â”‚
â”‚ eval_precision                            0 â”‚
â”‚ eval_recall                               0 â”‚
â”‚ eval_runtime                         4.0121 â”‚
â”‚ eval_samples_per_second              16.699 â”‚
â”‚ eval_steps_per_second                 0.997 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_07cc5ecb completed after 1 iterations at 2025-06-04 19:02:52. Total running time: 41s
[36m(train_hpo pid=3409134)[0m {'train_runtime': 24.8449, 'train_samples_per_second': 39.847, 'train_steps_per_second': 0.402, 'train_loss': 6.498217296600342, 'epoch': 3.4}
[36m(train_hpo pid=3409134)[0m STATE at ending of training  :  TrainerState(epoch=3.4, global_step=10, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=177335259076608.0, log_history=[{'loss': 6.6618, 'grad_norm': 49.21542739868164, 'learning_rate': 3.188774071602418e-06, 'epoch': 1.0, 'step': 3}, {'loss': 6.4226, 'grad_norm': 52.24677276611328, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.0, 'step': 6}, {'loss': 6.1036, 'grad_norm': 60.94226837158203, 'learning_rate': 4.555391530860598e-07, 'epoch': 3.0, 'step': 9}, {'loss': 7.4182, 'grad_norm': 100.056640625, 'learning_rate': 0.0, 'epoch': 3.4, 'step': 10}, {'train_runtime': 24.8449, 'train_samples_per_second': 39.847, 'train_steps_per_second': 0.402, 'total_flos': 177335259076608.0, 'train_loss': 6.498217296600342, 'epoch': 3.4, 'step': 10}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})2025-06-04 19:02:57,442 - INFO - Cleaning up trial 25cf60a4
2025-06-04 19:02:57,443 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-02-11/train_hpo_25cf60a4_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-04_19-02-17
2025-06-04 19:02:57,443 - INFO - Cleaning up trial 07cc5ecb
2025-06-04 19:02:57,443 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-02-11/train_hpo_07cc5ecb_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-04_19-02-11
2025-06-04 19:02:57,443 - INFO - Current best: 4fa3a1d7 with eval_f1 : 0.8448275862068966 at iteration 1
[36m(train_hpo pid=3409134)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
[36m(train_hpo pid=3409134)[0m   _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-06-04 19:02:57,452	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-02-11' in 0.0065s.
2025-06-04 19:02:57,459 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x719ac415e490>
2025-06-04 19:02:57,459 - INFO - Best trial : train_hpo_4fa3a1d7
2025-06-04 19:02:57,459 - INFO - Best config : {'pos_weight': 8.949837496427758, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-04 19:02:57,459 - INFO - Best trial after optimization: {'eval_loss': 1.5672345161437988, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.8061334490776062, 'eval_AP': 1.0, 'eval_MCC': 0.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 0.0, 'eval_runtime': 3.3464, 'eval_samples_per_second': 20.022, 'eval_steps_per_second': 1.195, 'epoch': 2.0, 'timestamp': 1749056567, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '4fa3a1d7', 'date': '2025-06-04_19-02-47', 'time_this_iter_s': 15.47822642326355, 'time_total_s': 15.47822642326355, 'pid': 3409418, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 8.949837496427758, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 15.47822642326355, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512'}
2025-06-04 19:02:57,480 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   4.857253  0.000000  ...                        6  07cc5ecb
1   7.252339  0.000000  ...                        5  25cf60a4
2   1.567235  0.844828  ...                        3  4fa3a1d7

[3 rows x 32 columns]
2025-06-04 19:02:57,600 - INFO - Trial comparison plot saved
2025-06-04 19:02:57,600 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-04 19:02:57,810 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-04 19:02:57,933 - INFO - training size : 198
2025-06-04 19:02:57,934 - INFO - dev size : 67
2025-06-04 19:02:57,934 - INFO - test size : 132
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(


Trial train_hpo_25cf60a4 finished iteration 1 at 2025-06-04 19:02:57. Total running time: 46s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_25cf60a4 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    32.5365 â”‚
â”‚ time_total_s                        32.5365 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   3.4 â”‚
â”‚ eval_AP                             0.73642 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.87703 â”‚
â”‚ eval_accuracy                       0.26866 â”‚
â”‚ eval_f1                                   0 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           7.25234 â”‚
â”‚ eval_optim_threshold                0.25754 â”‚
â”‚ eval_precision                            0 â”‚
â”‚ eval_recall                               0 â”‚
â”‚ eval_runtime                          3.461 â”‚
â”‚ eval_samples_per_second              19.359 â”‚
â”‚ eval_steps_per_second                 1.156 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_25cf60a4 completed after 1 iterations at 2025-06-04 19:02:57. Total running time: 46s
[36m(train_hpo pid=3409134)[0m {'loss': 7.4182, 'grad_norm': 100.056640625, 'learning_rate': 0.0, 'epoch': 3.4}

Trial status: 3 TERMINATED
Current time: 2025-06-04 19:02:57. Total running time: 46s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_07cc5ecb   TERMINATED        8.49369       1.49561e-06         0.13641                     6        1            34.6137       4.85725    0                      0          0.268657 â”‚
â”‚ train_hpo_25cf60a4   TERMINATED        7.54953       4.55539e-06         0.123031                    5        1            32.5366       7.25234    0                      0          0.268657 â”‚
â”‚ train_hpo_4fa3a1d7   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            15.4782       1.56723    0.844828               1          0.731343 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

  0%|          | 0/27 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  4%|â–Ž         | 1/27 [00:00<00:16,  1.54it/s]  7%|â–‹         | 2/27 [00:01<00:15,  1.58it/s] 11%|â–ˆ         | 3/27 [00:01<00:15,  1.60it/s] 15%|â–ˆâ–        | 4/27 [00:02<00:14,  1.60it/s] 19%|â–ˆâ–Š        | 5/27 [00:03<00:13,  1.61it/s] 22%|â–ˆâ–ˆâ–       | 6/27 [00:03<00:13,  1.61it/s] 26%|â–ˆâ–ˆâ–Œ       | 7/27 [00:04<00:12,  1.61it/s] 30%|â–ˆâ–ˆâ–‰       | 8/27 [00:04<00:11,  1.62it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 9/27 [00:05<00:09,  1.90it/s]                                               33%|â–ˆâ–ˆâ–ˆâ–Ž      | 9/27 [00:05<00:09,  1.90it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 10/27 [00:05<00:09,  1.78it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 11/27 [00:06<00:09,  1.73it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 12/27 [00:07<00:08,  1.69it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 13/27 [00:07<00:08,  1.67it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 14/27 [00:08<00:07,  1.65it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 15/27 [00:09<00:07,  1.64it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 16/27 [00:09<00:06,  1.63it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 17/27 [00:10<00:06,  1.64it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 18/27 [00:10<00:04,  1.90it/s]                                                67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 18/27 [00:10<00:04,  1.90it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 19/27 [00:11<00:04,  1.78it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 20/27 [00:11<00:04,  1.73it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 21/27 [00:12<00:03,  1.69it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 22/27 [00:13<00:03,  1.67it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 23/27 [00:13<00:02,  1.65it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 24/27 [00:14<00:01,  1.64it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 25/27 [00:14<00:01,  1.63it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 26/27 [00:15<00:00,  1.64it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 27/27 [00:15<00:00,  1.90it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 27/27 [00:17<00:00,  1.90it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 27/27 [00:17<00:00,  1.90it/s]2025-06-04 19:03:16,026 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 27/27 [00:17<00:00,  1.53it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
{'loss': 1.9335, 'grad_norm': 7.099112510681152, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
{'loss': 0.8024, 'grad_norm': 9.353782653808594, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
{'loss': 0.4704, 'grad_norm': 2.3076012134552, 'learning_rate': 0.0, 'epoch': 3.0}
{'train_runtime': 17.6363, 'train_samples_per_second': 33.681, 'train_steps_per_second': 1.531, 'train_loss': 1.0687585760045935, 'epoch': 3.0}
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.22it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.39it/s]2025-06-04 19:03:20,053 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.24s/it]
2025-06-04 19:03:20,059 - INFO - Training time : 22.45902543887496
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.09it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.01it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.34it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.09it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.31it/s]2025-06-04 19:03:24,633 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.41it/s]
2025-06-04 19:03:24,638 - INFO - Evaluation time : 4.578760127071291
2025-06-04 19:03:24,638 - INFO - Evaluation results on test set: {'eval_loss': 0.4586685597896576, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.8124930262565613, 'eval_AP': 1.0, 'eval_MCC': 0.0, 'eval_NDCG': 1.0000000000000004, 'eval_kappa': 0.0, 'eval_runtime': 4.5741, 'eval_samples_per_second': 28.858, 'eval_steps_per_second': 1.312, 'epoch': 3.0}
2025-06-04 19:03:24,638 - INFO - Total updates (optimizer steps): 27
2025-06-04 19:03:24,638 - INFO - Avg time / step: 0.653s
2025-06-04 19:03:25,425 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCEgoogle-bert/bert-base-uncased3trials_fold-2
2025-06-04 19:03:25,425 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.06it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  4.98it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.32it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.08it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.30it/s]2025-06-04 19:03:30,001 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.41it/s]
2025-06-04 19:03:30,006 - INFO - preds : [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
2025-06-04 19:03:30,007 - INFO - test_split["labels"] : [1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1]
2025-06-04 19:03:30,008 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:03:32,890 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': 1.0, 'MCC': 0.0, 'NDCG': 1.0000000000000004, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:03:33,011 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-04 19:03:33,110 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:03:33,110 - INFO - 
On test Set (optimal threshold of 0.9852297902107239 according to cross validation on the training set): 
2025-06-04 19:03:33,112 - INFO - Confusion matrix: TN=34, FP=0, FN=5, TP=93
2025-06-04 19:03:35,871 - INFO - Metrics: {'f1': 0.9738219895287958, 'recall': 0.9489795918367347, 'precision': 1.0, 'accuracy': 0.9621212121212122, 'AP': 1.0, 'MCC': 0.9095688767769353, 'NDCG': 1.0000000000000004, 'kappa': 0.9054982817869416, 'TN': 34, 'FP': 0, 'FN': 5, 'TP': 93}
2025-06-04 19:03:35,975 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:03:35,975 - INFO - Results for fold 2 : [{'f1': 0.9738219895287958, 'recall': 0.9489795918367347, 'precision': 1.0, 'accuracy': 0.9621212121212122, 'AP': 1.0, 'MCC': 0.9095688767769353, 'NDCG': 1.0000000000000004, 'kappa': 0.9054982817869416, 'TN': 34, 'FP': 0, 'FN': 5, 'TP': 93}]
2025-06-04 19:03:36,093 - INFO - Cleared CUDA cache. Memory allocated: 1.41 GB, Memory reserved: 1.82 GB
2025-06-04 19:03:36,093 - INFO - 
fold number 3 / 3
2025-06-04 19:03:36,099 - INFO - train split size : 198
2025-06-04 19:03:36,099 - INFO - dev split size : 67
2025-06-04 19:03:36,099 - INFO - test split size : 132
Map (num_proc=32):   0%|          | 0/198 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–Ž         | 7/198 [00:00<00:05, 38.01 examples/s]Map (num_proc=32):  24%|â–ˆâ–ˆâ–       | 48/198 [00:00<00:00, 185.21 examples/s]Map (num_proc=32):  39%|â–ˆâ–ˆâ–ˆâ–‰      | 78/198 [00:00<00:00, 222.50 examples/s]Map (num_proc=32):  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 108/198 [00:00<00:00, 247.49 examples/s]Map (num_proc=32):  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 144/198 [00:00<00:00, 273.30 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 180/198 [00:00<00:00, 282.74 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 198/198 [00:00<00:00, 212.80 examples/s]
Map (num_proc=32):   0%|          | 0/67 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/67 [00:00<00:03, 16.62 examples/s]Map (num_proc=32):  22%|â–ˆâ–ˆâ–       | 15/67 [00:00<00:00, 59.06 examples/s]Map (num_proc=32):  37%|â–ˆâ–ˆâ–ˆâ–‹      | 25/67 [00:00<00:00, 73.70 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 35/67 [00:00<00:00, 80.20 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 45/67 [00:00<00:00, 83.70 examples/s]Map (num_proc=32):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 55/67 [00:00<00:00, 88.48 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:00<00:00, 93.81 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:00<00:00, 70.44 examples/s]
Map (num_proc=32):   0%|          | 0/132 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/132 [00:00<00:04, 28.55 examples/s]Map (num_proc=32):  21%|â–ˆâ–ˆ        | 28/132 [00:00<00:00, 110.23 examples/s]Map (num_proc=32):  39%|â–ˆâ–ˆâ–ˆâ–‰      | 52/132 [00:00<00:00, 154.50 examples/s]Map (num_proc=32):  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 72/132 [00:00<00:00, 163.95 examples/s]Map (num_proc=32):  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 96/132 [00:00<00:00, 177.23 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 120/132 [00:00<00:00, 189.15 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 132/132 [00:00<00:00, 145.81 examples/s]
2025-06-04 19:03:44,691 - INFO - 3 datasets tokenized successfully
2025-06-04 19:03:44,693 - INFO - Starting hyperparameter search for BCE loss
[36m(train_hpo pid=3411520)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3411520)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3409134)[0m 2025-06-04 19:02:57,378 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3409134)[0m 2025-06-04 19:02:57,384 - INFO - eval_result: {'eval_loss': 7.2523393630981445, 'eval_f1': 0.0, 'eval_recall': 0.0, 'eval_accuracy': 0.26865671641791045, 'eval_precision': 0.0, 'eval_optim_threshold': 0.2575433850288391, 'eval_AP': 0.7364226572497385, 'eval_MCC': 0.0, 'eval_NDCG': 0.8770269560014271, 'eval_kappa': 0.0, 'eval_runtime': 3.461, 'eval_samples_per_second': 19.359, 'eval_steps_per_second': 1.156, 'epoch': 3.4}
[36m(train_hpo pid=3409134)[0m 2025-06-04 19:02:57,418 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3411520)[0m 2025-06-04 19:03:52,166 - INFO - pos_weight value in TrainingArguments : 8.493688290834637
[36m(train_hpo pid=3411520)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3411520)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3411520)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3411520)[0m   warnings.warn(
[36m(train_hpo pid=3411755)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3411755)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3411755)[0m 2025-06-04 19:03:58,904 - INFO - pos_weight value in TrainingArguments : 7.549531688595925
[36m(train_hpo pid=3411755)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3411755)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3411755)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3411755)[0m   warnings.warn(
[36m(train_hpo pid=3412041)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3412041)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3412041)[0m 2025-06-04 19:04:05,739 - INFO - pos_weight value in TrainingArguments : 8.949837496427758
[36m(train_hpo pid=3412041)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3412041)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3412041)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3412041)[0m   warnings.warn(
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-04_19-03-44   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-03-44
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-04_18-54-36_274448_3393636/artifacts/2025-06-04_19-03-44/train_hpo_2025-06-04_19-03-44/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-04 19:03:44. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_1a220595   PENDING         8.49369       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_1a220595 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_1a220595 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          8.49369 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3411520)[0m [2025-06-04 19:03:52,413] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3409134)[0m {'eval_loss': 7.2523393630981445, 'eval_f1': 0.0, 'eval_recall': 0.0, 'eval_accuracy': 0.26865671641791045, 'eval_precision': 0.0, 'eval_optim_threshold': 0.2575433850288391, 'eval_AP': 0.7364226572497385, 'eval_MCC': 0.0, 'eval_NDCG': 0.8770269560014271, 'eval_kappa': 0.0, 'eval_runtime': 3.461, 'eval_samples_per_second': 19.359, 'eval_steps_per_second': 1.156, 'epoch': 3.4}
[36m(train_hpo pid=3411520)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=12, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_7c36e93d started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_7c36e93d config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          7.54953 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3411755)[0m [2025-06-04 19:03:59,313] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3411520)[0m {'loss': 4.2817, 'grad_norm': 39.7421989440918, 'learning_rate': 1.1217049888818266e-06, 'epoch': 1.0}
[36m(train_hpo pid=3411755)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3411520)[0m {'loss': 4.2479, 'grad_norm': 44.23157501220703, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.0}

Trial train_hpo_be3ca743 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_be3ca743 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          8.94984 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3412041)[0m [2025-06-04 19:04:05,970] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3412041)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=6, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3411755)[0m {'loss': 2.1487, 'grad_norm': 19.94321060180664, 'learning_rate': 3.188774071602418e-06, 'epoch': 1.0}

Trial status: 3 RUNNING
Current time: 2025-06-04 19:04:14. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_1a220595   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_7c36e93d   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_be3ca743   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(train_hpo pid=3412041)[0m 2025-06-04 19:04:20,391 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3412041)[0m 2025-06-04 19:04:20,396 - INFO - eval_result: {'eval_loss': 1.462552547454834, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.8553858399391174, 'eval_AP': 0.9955651835633039, 'eval_MCC': 0.0, 'eval_NDCG': 0.9992205640587742, 'eval_kappa': 0.0, 'eval_runtime': 3.2145, 'eval_samples_per_second': 20.843, 'eval_steps_per_second': 1.244, 'epoch': 2.0}
[36m(train_hpo pid=3412041)[0m 2025-06-04 19:04:20,439 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
2025-06-04 19:04:20,466 - INFO - Cleaning up trial be3ca743
2025-06-04 19:04:20,467 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-03-44/train_hpo_be3ca743_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512_2025-06-04_19-03-58
[36m(train_hpo pid=3411520)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
[36m(train_hpo pid=3411520)[0m   _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
[36m(train_hpo pid=3411520)[0m 2025-06-04 19:04:26,667 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3411520)[0m 2025-06-04 19:04:26,673 - INFO - eval_result: {'eval_loss': 5.067967414855957, 'eval_f1': 0.0, 'eval_recall': 0.0, 'eval_accuracy': 0.2537313432835821, 'eval_precision': 0.0, 'eval_optim_threshold': 0.45843565464019775, 'eval_AP': 0.8751860568526678, 'eval_MCC': 0.0, 'eval_NDCG': 0.9703618666168228, 'eval_kappa': 0.0, 'eval_runtime': 4.0055, 'eval_samples_per_second': 16.727, 'eval_steps_per_second': 0.999, 'epoch': 4.0}
2025-06-04 19:04:26,729 - INFO - Cleaning up trial 1a220595
2025-06-04 19:04:26,729 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-03-44/train_hpo_1a220595_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-04_19-03-44
2025-06-04 19:04:26,730 - INFO - Current best: be3ca743 with eval_f1 : 0.8547008547008547 at iteration 1
[36m(train_hpo pid=3411520)[0m 2025-06-04 19:04:26,707 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB

[36m(train_hpo pid=3412041)[0m {'train_runtime': 8.0099, 'train_samples_per_second': 74.158, 'train_steps_per_second': 0.749, 'train_loss': 2.420639912287394, 'epoch': 2.0}
[36m(train_hpo pid=3412041)[0m STATE at ending of training  :  TrainerState(epoch=2.0, global_step=6, max_steps=6, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=104191042424832.0, log_history=[{'loss': 3.3396, 'grad_norm': 40.284515380859375, 'learning_rate': 3.994089731390617e-05, 'epoch': 1.0, 'step': 3}, {'loss': 1.5017, 'grad_norm': 9.400849342346191, 'learning_rate': 0.0, 'epoch': 2.0, 'step': 6}, {'train_runtime': 8.0099, 'train_samples_per_second': 74.158, 'train_steps_per_second': 0.749, 'total_flos': 104191042424832.0, 'train_loss': 2.420639912287394, 'epoch': 2.0, 'step': 6}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3412041)[0m {'loss': 1.5017, 'grad_norm': 9.400849342346191, 'learning_rate': 0.0, 'epoch': 2.0}[32m [repeated 3x across cluster][0m
[36m(train_hpo pid=3412041)[0m {'eval_loss': 1.462552547454834, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.8553858399391174, 'eval_AP': 0.9955651835633039, 'eval_MCC': 0.0, 'eval_NDCG': 0.9992205640587742, 'eval_kappa': 0.0, 'eval_runtime': 3.2145, 'eval_samples_per_second': 20.843, 'eval_steps_per_second': 1.244, 'epoch': 2.0}

Trial train_hpo_be3ca743 finished iteration 1 at 2025-06-04 19:04:20. Total running time: 35s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_be3ca743 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    15.1455 â”‚
â”‚ time_total_s                        15.1455 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     2 â”‚
â”‚ eval_AP                             0.99557 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.99922 â”‚
â”‚ eval_accuracy                       0.74627 â”‚
â”‚ eval_f1                              0.8547 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.46255 â”‚
â”‚ eval_optim_threshold                0.85539 â”‚
â”‚ eval_precision                      0.74627 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.2145 â”‚
â”‚ eval_samples_per_second              20.843 â”‚
â”‚ eval_steps_per_second                 1.244 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_be3ca743 completed after 1 iterations at 2025-06-04 19:04:20. Total running time: 35s
[36m(train_hpo pid=3411520)[0m STATE at ending of training  :  TrainerState(epoch=4.0, global_step=12, max_steps=12, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=208382084849664.0, log_history=[{'loss': 4.2817, 'grad_norm': 39.7421989440918, 'learning_rate': 1.1217049888818266e-06, 'epoch': 1.0, 'step': 3}, {'loss': 4.2479, 'grad_norm': 44.23157501220703, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.0, 'step': 6}, {'loss': 4.2607, 'grad_norm': 53.54417419433594, 'learning_rate': 3.7390166296060887e-07, 'epoch': 3.0, 'step': 9}, {'loss': 4.2104, 'grad_norm': 40.16926574707031, 'learning_rate': 0.0, 'epoch': 4.0, 'step': 12}, {'train_runtime': 26.9559, 'train_samples_per_second': 44.072, 'train_steps_per_second': 0.445, 'total_flos': 208382084849664.0, 'train_loss': 4.250195264816284, 'epoch': 4.0, 'step': 12}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3411520)[0m {'train_runtime': 26.9559, 'train_samples_per_second': 44.072, 'train_steps_per_second': 0.445, 'train_loss': 4.250195264816284, 'epoch': 4.0}
[36m(train_hpo pid=3411520)[0m {'loss': 4.2104, 'grad_norm': 40.16926574707031, 'learning_rate': 0.0, 'epoch': 4.0}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3411520)[0m {'eval_loss': 5.067967414855957, 'eval_f1': 0.0, 'eval_recall': 0.0, 'eval_accuracy': 0.2537313432835821, 'eval_precision': 0.0, 'eval_optim_threshold': 0.45843565464019775, 'eval_AP': 0.8751860568526678, 'eval_MCC': 0.0, 'eval_NDCG': 0.9703618666168228, 'eval_kappa': 0.0, 'eval_runtime': 4.0055, 'eval_samples_per_second': 16.727, 'eval_steps_per_second': 0.999, 'epoch': 4.0}

Trial train_hpo_1a220595 finished iteration 1 at 2025-06-04 19:04:26. Total running time: 41s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_1a220595 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    35.0236 â”‚
â”‚ time_total_s                        35.0236 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     4 â”‚
â”‚ eval_AP                             0.87519 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.97036 â”‚
â”‚ eval_accuracy                       0.25373 â”‚
â”‚ eval_f1                                   0 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           5.06797 â”‚
â”‚ eval_optim_threshold                0.45844 â”‚
â”‚ eval_precision                            0 â”‚
â”‚ eval_recall                               0 â”‚
â”‚ eval_runtime                         4.0055 â”‚
â”‚ eval_samples_per_second              16.727 â”‚
â”‚ eval_steps_per_second                 0.999 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_1a220595 completed after 1 iterations at 2025-06-04 19:04:26. Total running time: 41s
[36m(train_hpo pid=3411755)[0m {'train_runtime': 25.2186, 'train_samples_per_second': 39.257, 'train_steps_per_second': 0.397, 'train_loss': 2.114586043357849, 'epoch': 3.4}
[36m(train_hpo pid=3411755)[0m STATE at ending of training  :  TrainerState(epoch=3.4, global_step=10, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=177335259076608.0, log_history=[{'loss': 2.1487, 'grad_norm': 19.94321060180664, 'learning_rate': 3.188774071602418e-06, 'epoch': 1.0, 'step': 3}, {'loss': 2.0507, 'grad_norm': 22.209566116333008, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.0, 'step': 6}, {'loss': 2.0379, 'grad_norm': 27.50994300842285, 'learning_rate': 4.555391530860598e-07, 'epoch': 3.0, 'step': 9}, {'loss': 2.4338, 'grad_norm': 42.446136474609375, 'learning_rate': 0.0, 'epoch': 3.4, 'step': 10}, {'train_runtime': 25.2186, 'train_samples_per_second': 39.257, 'train_steps_per_second': 0.397, 'total_flos': 177335259076608.0, 'train_loss': 2.114586043357849, 'epoch': 3.4, 'step': 10}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})2025-06-04 19:04:31,154 - INFO - Cleaning up trial 7c36e93d
2025-06-04 19:04:31,154 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-03-44/train_hpo_7c36e93d_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-04_19-03-51
2025-06-04 19:04:31,154 - INFO - Cleaning up trial 1a220595
2025-06-04 19:04:31,154 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-03-44/train_hpo_1a220595_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-04_19-03-44
2025-06-04 19:04:31,154 - INFO - Current best: be3ca743 with eval_f1 : 0.8547008547008547 at iteration 1
2025-06-04 19:04:31,162	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-03-44' in 0.0065s.
2025-06-04 19:04:31,169 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x719abc251290>
2025-06-04 19:04:31,169 - INFO - Best trial : train_hpo_7c36e93d
2025-06-04 19:04:31,169 - INFO - Best config : {'pos_weight': 7.549531688595925, 'learning_rate': 4.555391530860597e-06, 'weight_decay': 0.12303118765599412, 'num_train_epochs': 5}
2025-06-04 19:04:31,169 - INFO - Best trial after optimization: {'eval_loss': 2.380739212036133, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.6927793025970459, 'eval_AP': 0.8995343394520354, 'eval_MCC': 0.0, 'eval_NDCG': 0.9788315720751348, 'eval_kappa': 0.0, 'eval_runtime': 3.2875, 'eval_samples_per_second': 20.38, 'eval_steps_per_second': 1.217, 'epoch': 3.4, 'timestamp': 1749056671, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '7c36e93d', 'date': '2025-06-04_19-04-31', 'time_this_iter_s': 32.684951305389404, 'time_total_s': 32.684951305389404, 'pid': 3411755, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 7.549531688595925, 'learning_rate': 4.555391530860597e-06, 'weight_decay': 0.12303118765599412, 'num_train_epochs': 5}, 'time_since_restore': 32.684951305389404, 'iterations_since_restore': 1, 'experiment_tag': '2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230'}
2025-06-04 19:04:31,197 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   5.067967  0.000000  ...                        6  1a220595
1   2.380739  0.854701  ...                        5  7c36e93d
2   1.462553  0.854701  ...                        3  be3ca743

[3 rows x 32 columns]
2025-06-04 19:04:31,381 - INFO - Trial comparison plot saved
2025-06-04 19:04:31,382 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-04 19:04:31,589 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-04 19:04:31,703 - INFO - training size : 198
2025-06-04 19:04:31,704 - INFO - dev size : 67
2025-06-04 19:04:31,704 - INFO - test size : 132
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(

[36m(train_hpo pid=3411755)[0m {'loss': 2.4338, 'grad_norm': 42.446136474609375, 'learning_rate': 0.0, 'epoch': 3.4}[32m [repeated 2x across cluster][0m

Trial train_hpo_7c36e93d finished iteration 1 at 2025-06-04 19:04:31. Total running time: 46s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_7c36e93d result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                     32.685 â”‚
â”‚ time_total_s                         32.685 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   3.4 â”‚
â”‚ eval_AP                             0.89953 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.97883 â”‚
â”‚ eval_accuracy                       0.74627 â”‚
â”‚ eval_f1                              0.8547 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           2.38074 â”‚
â”‚ eval_optim_threshold                0.69278 â”‚
â”‚ eval_precision                      0.74627 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.2875 â”‚
â”‚ eval_samples_per_second               20.38 â”‚
â”‚ eval_steps_per_second                 1.217 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_7c36e93d completed after 1 iterations at 2025-06-04 19:04:31. Total running time: 46s

Trial status: 3 TERMINATED
Current time: 2025-06-04 19:04:31. Total running time: 46s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_1a220595   TERMINATED        8.49369       1.49561e-06         0.13641                     6        1            35.0236       5.06797    0                      0          0.253731 â”‚
â”‚ train_hpo_7c36e93d   TERMINATED        7.54953       4.55539e-06         0.123031                    5        1            32.685        2.38074    0.854701               1          0.746269 â”‚
â”‚ train_hpo_be3ca743   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            15.1455       1.46255    0.854701               1          0.746269 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

  0%|          | 0/45 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  2%|â–         | 1/45 [00:00<00:28,  1.53it/s]  4%|â–         | 2/45 [00:01<00:27,  1.58it/s]  7%|â–‹         | 3/45 [00:01<00:26,  1.60it/s]  9%|â–‰         | 4/45 [00:02<00:25,  1.60it/s] 11%|â–ˆ         | 5/45 [00:03<00:24,  1.61it/s] 13%|â–ˆâ–Ž        | 6/45 [00:03<00:24,  1.61it/s] 16%|â–ˆâ–Œ        | 7/45 [00:04<00:23,  1.61it/s] 18%|â–ˆâ–Š        | 8/45 [00:04<00:22,  1.62it/s] 20%|â–ˆâ–ˆ        | 9/45 [00:05<00:18,  1.90it/s]                                               20%|â–ˆâ–ˆ        | 9/45 [00:05<00:18,  1.90it/s] 22%|â–ˆâ–ˆâ–       | 10/45 [00:05<00:19,  1.78it/s] 24%|â–ˆâ–ˆâ–       | 11/45 [00:06<00:19,  1.72it/s] 27%|â–ˆâ–ˆâ–‹       | 12/45 [00:07<00:19,  1.69it/s] 29%|â–ˆâ–ˆâ–‰       | 13/45 [00:07<00:19,  1.67it/s] 31%|â–ˆâ–ˆâ–ˆ       | 14/45 [00:08<00:18,  1.65it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 15/45 [00:09<00:18,  1.64it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 16/45 [00:09<00:17,  1.63it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 17/45 [00:10<00:17,  1.64it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 18/45 [00:10<00:14,  1.90it/s]                                                40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 18/45 [00:10<00:14,  1.90it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 19/45 [00:11<00:14,  1.78it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 20/45 [00:11<00:14,  1.73it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 21/45 [00:12<00:14,  1.69it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 22/45 [00:13<00:13,  1.67it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 23/45 [00:13<00:13,  1.65it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 24/45 [00:14<00:12,  1.64it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 25/45 [00:14<00:12,  1.63it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 26/45 [00:15<00:11,  1.64it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 27/45 [00:15<00:09,  1.90it/s]                                                60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 27/45 [00:15<00:09,  1.90it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 28/45 [00:16<00:09,  1.78it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 29/45 [00:17<00:09,  1.73it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 30/45 [00:17<00:08,  1.69it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 31/45 [00:18<00:08,  1.67it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 32/45 [00:19<00:07,  1.65it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 33/45 [00:19<00:07,  1.64it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 34/45 [00:20<00:06,  1.63it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 35/45 [00:20<00:06,  1.64it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 36/45 [00:21<00:04,  1.90it/s]                                                80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 36/45 [00:21<00:04,  1.90it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 37/45 [00:21<00:04,  1.78it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 38/45 [00:22<00:04,  1.73it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 39/45 [00:23<00:03,  1.69it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 40/45 [00:23<00:03,  1.66it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 41/45 [00:24<00:02,  1.65it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 42/45 [00:24<00:01,  1.64it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 43/45 [00:25<00:01,  1.63it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 44/45 [00:26<00:00,  1.64it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45/45 [00:26<00:00,  1.90it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45/45 [00:28<00:00,  1.90it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45/45 [00:28<00:00,  1.90it/s]2025-06-04 19:05:00,416 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45/45 [00:28<00:00,  1.59it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
{'loss': 4.5799, 'grad_norm': 43.298675537109375, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0}
{'loss': 3.474, 'grad_norm': 35.90294647216797, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0}
{'loss': 2.6226, 'grad_norm': 42.19710159301758, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0}
{'loss': 2.2926, 'grad_norm': 41.10523986816406, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0}
{'loss': 2.107, 'grad_norm': 29.412153244018555, 'learning_rate': 0.0, 'epoch': 5.0}
{'train_runtime': 28.2567, 'train_samples_per_second': 35.036, 'train_steps_per_second': 1.593, 'train_loss': 3.015211910671658, 'epoch': 5.0}
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.20it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.38it/s]2025-06-04 19:05:04,337 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.21s/it]
2025-06-04 19:05:04,343 - INFO - Training time : 32.96092071500607
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.08it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.00it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.34it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.09it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.31it/s]2025-06-04 19:05:08,791 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.45it/s]
2025-06-04 19:05:08,796 - INFO - Evaluation time : 4.453411255963147
2025-06-04 19:05:08,796 - INFO - Evaluation results on test set: {'eval_loss': 2.1066155433654785, 'eval_f1': 0.8471615720524017, 'eval_recall': 1.0, 'eval_accuracy': 0.7348484848484849, 'eval_precision': 0.7348484848484849, 'eval_optim_threshold': 0.6814020276069641, 'eval_AP': 0.9771150631205622, 'eval_MCC': 0.0, 'eval_NDCG': 0.9961203535715102, 'eval_kappa': 0.0, 'eval_runtime': 4.4491, 'eval_samples_per_second': 29.669, 'eval_steps_per_second': 1.349, 'epoch': 5.0}
2025-06-04 19:05:08,796 - INFO - Total updates (optimizer steps): 45
2025-06-04 19:05:08,796 - INFO - Avg time / step: 0.628s
2025-06-04 19:05:09,617 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCEgoogle-bert/bert-base-uncased3trials_fold-3
2025-06-04 19:05:09,617 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.06it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  4.96it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.32it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.08it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.31it/s]2025-06-04 19:05:14,178 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.41it/s]
2025-06-04 19:05:14,182 - INFO - preds : [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
2025-06-04 19:05:14,183 - INFO - test_split["labels"] : [1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1]
2025-06-04 19:05:14,184 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:05:17,191 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': 0.9771150631205622, 'MCC': 0.0, 'NDCG': 0.9961203535715102, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:05:17,319 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-04 19:05:17,424 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:05:17,424 - INFO - 
On test Set (optimal threshold of 0.6804999709129333 according to cross validation on the training set): 
2025-06-04 19:05:17,426 - INFO - Confusion matrix: TN=29, FP=6, FN=10, TP=87
2025-06-04 19:05:20,313 - INFO - Metrics: {'f1': 0.9157894736842105, 'recall': 0.8969072164948454, 'precision': 0.9354838709677419, 'accuracy': 0.8787878787878788, 'AP': 0.9771150631205622, 'MCC': 0.7018927309706389, 'NDCG': 0.9961203535715102, 'kappa': 0.699914748508099, 'TN': 29, 'FP': 6, 'FN': 10, 'TP': 87}
2025-06-04 19:05:20,421 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:05:20,421 - INFO - Results for fold 3 : [{'f1': 0.9157894736842105, 'recall': 0.8969072164948454, 'precision': 0.9354838709677419, 'accuracy': 0.8787878787878788, 'AP': 0.9771150631205622, 'MCC': 0.7018927309706389, 'NDCG': 0.9961203535715102, 'kappa': 0.699914748508099, 'TN': 29, 'FP': 6, 'FN': 10, 'TP': 87}]
2025-06-04 19:05:20,537 - INFO - Cleared CUDA cache. Memory allocated: 1.42 GB, Memory reserved: 1.76 GB
2025-06-04 19:05:20,538 - INFO - Cleared CUDA cache. Memory allocated: 1.42 GB, Memory reserved: 1.76 GB
2025-06-04 19:05:20,581 - INFO - Cleared CUDA cache. Memory allocated: 0.02 GB, Memory reserved: 0.03 GB
2025-06-04 19:05:20,595 - INFO - Metrics for google-bert/bert-base-uncased:                       model_name fold loss_type run  ...   TN    FP   FN    TP
0  google-bert/bert-base-uncased    1       BCE   1  ...  0.0  35.0  0.0  98.0
0  google-bert/bert-base-uncased    2       BCE   1  ...  0.0  34.0  0.0  98.0
0  google-bert/bert-base-uncased    3       BCE   1  ...  0.0  35.0  0.0  97.0

[3 rows x 18 columns]
2025-06-04 19:05:20,595 - INFO - 
fold number 1 / 3
2025-06-04 19:05:20,600 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:05:23,723 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': 0.9978721715959111, 'MCC': 0.0, 'NDCG': 0.9996628382334811, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:05:23,725 - INFO - 
fold number 2 / 3
2025-06-04 19:05:23,729 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:05:26,564 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': 0.9998969284683572, 'MCC': 0.0, 'NDCG': 0.9999840486799633, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:05:26,566 - INFO - 
fold number 3 / 3
2025-06-04 19:05:26,570 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:05:29,424 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': 0.9996854505303862, 'MCC': 0.0, 'NDCG': 0.9999510836799266, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:05:29,431 - INFO - fold indexes for run no.2: [[284, 266, 388, 393, 133, 13, 20, 176, 269, 308, 45, 193, 147, 19, 168, 230, 151, 384, 157, 153, 149, 327, 321, 381, 385, 330, 199, 72, 142, 10, 47, 270, 377, 73, 0, 118, 184, 65, 343, 219, 86, 357, 201, 226, 264, 223, 33, 114, 67, 268, 182, 310, 53, 246, 145, 76, 320, 373, 280, 95, 254, 113, 154, 160, 228, 306, 325, 99, 355, 356, 125, 166, 346, 286, 102, 354, 92, 336, 81, 159, 52, 304, 323, 111, 96, 274, 236, 41, 91, 32, 90, 367, 179, 130, 74, 334, 378, 208, 77, 396, 361, 6, 332, 238, 222, 277, 365, 36, 256, 21, 260, 38, 234, 341, 173, 124, 183, 31, 202, 203, 196, 119, 150, 263, 105, 126, 48, 143, 289, 231, 324, 352, 186, 155, 292, 217, 198, 316, 109, 287, 44, 49, 82, 15, 309, 83, 135, 218, 305, 283, 122, 127, 290, 35, 85, 98, 271, 141, 167, 295, 93, 27, 262, 229, 273, 9, 370, 89, 129, 197, 164, 205, 347, 171, 178, 70, 140, 372, 100, 314, 69, 4, 301, 265, 244, 101, 248, 358, 364, 94, 296, 87, 307, 239, 192, 50, 169, 39], [326, 210, 250, 319, 380, 279, 293, 288, 220, 253, 162, 43, 152, 8, 221, 235, 297, 339, 331, 61, 106, 181, 329, 243, 375, 88, 257, 194, 117, 104, 55, 349, 14, 108, 62, 281, 282, 2, 63, 240, 351, 107, 97, 187, 215, 54, 80, 232, 318, 241, 303, 252, 29, 139, 247, 362, 51, 390, 285, 392, 174, 298, 5, 335, 294, 28], array([  1,   3,   7,  11,  12,  16,  17,  18,  22,  23,  24,  25,  26,
        30,  34,  37,  40,  42,  46,  56,  57,  58,  59,  60,  64,  66,
        68,  71,  75,  78,  79,  84, 103, 110, 112, 115, 116, 120, 121,
       123, 128, 131, 132, 134, 136, 137, 138, 144, 146, 148, 156, 158,
       161, 163, 165, 170, 172, 175, 177, 180, 185, 188, 189, 190, 191,
       195, 200, 204, 206, 207, 209, 211, 212, 213, 214, 216, 224, 225,
       227, 233, 237, 242, 245, 249, 251, 255, 258, 259, 261, 267, 272,
       275, 276, 278, 291, 299, 300, 302, 311, 312, 313, 315, 317, 322,
       328, 333, 337, 338, 340, 342, 344, 345, 348, 350, 353, 359, 360,
       363, 366, 368, 369, 371, 374, 376, 379, 382, 383, 386, 387, 389,
       391, 394, 395])]
2025-06-04 19:05:29,431 - INFO - Run no 2/2
2025-06-04 19:05:29,431 - INFO - Loss Type : BCE
2025-06-04 19:05:29,431 - INFO - Ensemble learning pipeline
2025-06-04 19:05:29,431 - INFO - Training model 1/2: dmis-lab/biobert-v1.1
2025-06-04 19:05:29,600 - INFO - 
fold number 1 / 3
2025-06-04 19:05:29,605 - INFO - train split size : 198
2025-06-04 19:05:29,605 - INFO - dev split size : 66
2025-06-04 19:05:29,605 - INFO - test split size : 133
Map (num_proc=32):   0%|          | 0/198 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–Ž         | 7/198 [00:00<00:04, 39.24 examples/s]Map (num_proc=32):  24%|â–ˆâ–ˆâ–       | 48/198 [00:00<00:00, 189.95 examples/s]Map (num_proc=32):  39%|â–ˆâ–ˆâ–ˆâ–‰      | 78/198 [00:00<00:00, 230.78 examples/s]Map (num_proc=32):  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 108/198 [00:00<00:00, 250.53 examples/s]Map (num_proc=32):  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 138/198 [00:00<00:00, 262.50 examples/s]Map (num_proc=32):  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 174/198 [00:00<00:00, 258.91 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 198/198 [00:00<00:00, 211.39 examples/s]
Map (num_proc=32):   0%|          | 0/66 [00:00<?, ? examples/s]Map (num_proc=32):   5%|â–         | 3/66 [00:00<00:03, 18.25 examples/s]Map (num_proc=32):  21%|â–ˆâ–ˆ        | 14/66 [00:00<00:00, 60.49 examples/s]Map (num_proc=32):  36%|â–ˆâ–ˆâ–ˆâ–‹      | 24/66 [00:00<00:00, 74.37 examples/s]Map (num_proc=32):  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 36/66 [00:00<00:00, 86.99 examples/s]Map (num_proc=32):  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 48/66 [00:00<00:00, 89.87 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 60/66 [00:00<00:00, 94.63 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 66/66 [00:00<00:00, 72.79 examples/s]
Map (num_proc=32):   0%|          | 0/133 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/133 [00:00<00:04, 30.53 examples/s]Map (num_proc=32):  22%|â–ˆâ–ˆâ–       | 29/133 [00:00<00:00, 127.14 examples/s]Map (num_proc=32):  37%|â–ˆâ–ˆâ–ˆâ–‹      | 49/133 [00:00<00:00, 153.56 examples/s]Map (num_proc=32):  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 73/133 [00:00<00:00, 176.16 examples/s]Map (num_proc=32):  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 97/133 [00:00<00:00, 186.03 examples/s]Map (num_proc=32):  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 117/133 [00:00<00:00, 182.55 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 133/133 [00:00<00:00, 146.70 examples/s]
2025-06-04 19:05:37,787 - INFO - 3 datasets tokenized successfully
2025-06-04 19:05:37,788 - INFO - Starting hyperparameter search for BCE loss
[36m(train_hpo pid=3414498)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3414498)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3411755)[0m 2025-06-04 19:04:31,092 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3411755)[0m 2025-06-04 19:04:31,097 - INFO - eval_result: {'eval_loss': 2.380739212036133, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.6927793025970459, 'eval_AP': 0.8995343394520354, 'eval_MCC': 0.0, 'eval_NDCG': 0.9788315720751348, 'eval_kappa': 0.0, 'eval_runtime': 3.2875, 'eval_samples_per_second': 20.38, 'eval_steps_per_second': 1.217, 'epoch': 3.4}
[36m(train_hpo pid=3411755)[0m 2025-06-04 19:04:31,129 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3414498)[0m 2025-06-04 19:05:45,508 - INFO - pos_weight value in TrainingArguments : 8.493688290834637
[36m(train_hpo pid=3414498)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3414498)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3414498)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3414498)[0m   warnings.warn(
[36m(train_hpo pid=3414737)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3414737)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3414737)[0m 2025-06-04 19:05:52,255 - INFO - pos_weight value in TrainingArguments : 7.549531688595925
[36m(train_hpo pid=3414737)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3414737)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3414737)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3414737)[0m   warnings.warn(
[36m(train_hpo pid=3414975)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3414975)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3414975)[0m 2025-06-04 19:05:58,969 - INFO - pos_weight value in TrainingArguments : 8.949837496427758
[36m(train_hpo pid=3414975)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3414975)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3414975)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3414975)[0m   warnings.warn(
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-04_19-05-37   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-05-37
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-04_18-54-36_274448_3393636/artifacts/2025-06-04_19-05-37/train_hpo_2025-06-04_19-05-37/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-04 19:05:37. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_c9725e22   PENDING         8.49369       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_c9725e22 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_c9725e22 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          8.49369 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3414498)[0m [2025-06-04 19:05:45,750] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3411755)[0m {'eval_loss': 2.380739212036133, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.6927793025970459, 'eval_AP': 0.8995343394520354, 'eval_MCC': 0.0, 'eval_NDCG': 0.9788315720751348, 'eval_kappa': 0.0, 'eval_runtime': 3.2875, 'eval_samples_per_second': 20.38, 'eval_steps_per_second': 1.217, 'epoch': 3.4}
[36m(train_hpo pid=3414498)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=12, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_d7448ca9 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_d7448ca9 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          7.54953 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3414737)[0m [2025-06-04 19:05:52,640] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3414498)[0m {'loss': 3.1233, 'grad_norm': 26.455137252807617, 'learning_rate': 1.1217049888818266e-06, 'epoch': 1.0}
[36m(train_hpo pid=3414737)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_593dd490 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_593dd490 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          8.94984 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3414498)[0m {'loss': 2.9969, 'grad_norm': 27.57137680053711, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.0}
[36m(train_hpo pid=3414975)[0m [2025-06-04 19:05:59,201] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3414975)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=6, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3414737)[0m {'loss': 3.0608, 'grad_norm': 24.82211685180664, 'learning_rate': 3.188774071602418e-06, 'epoch': 1.0}

Trial status: 3 RUNNING
Current time: 2025-06-04 19:06:08. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_c9725e22   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_d7448ca9   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_593dd490   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(train_hpo pid=3414975)[0m 2025-06-04 19:06:13,845 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3414975)[0m 2025-06-04 19:06:13,851 - INFO - eval_result: {'eval_loss': 1.1085283756256104, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.9004017114639282, 'eval_AP': 0.9995918367346939, 'eval_MCC': 0.0, 'eval_NDCG': 0.9999298518361316, 'eval_kappa': 0.0, 'eval_runtime': 3.2782, 'eval_samples_per_second': 20.133, 'eval_steps_per_second': 1.22, 'epoch': 2.0}
[36m(train_hpo pid=3414975)[0m 2025-06-04 19:06:13,885 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
2025-06-04 19:06:13,909 - INFO - Cleaning up trial 593dd490
2025-06-04 19:06:13,909 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-05-37/train_hpo_593dd490_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512_2025-06-04_19-05-51
[36m(train_hpo pid=3414498)[0m 2025-06-04 19:06:19,888 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3414498)[0m 2025-06-04 19:06:19,894 - INFO - eval_result: {'eval_loss': 3.50258207321167, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.5860236287117004, 'eval_AP': 0.8444037007656631, 'eval_MCC': 0.0, 'eval_NDCG': 0.9490821558485888, 'eval_kappa': 0.0, 'eval_runtime': 3.8254, 'eval_samples_per_second': 17.253, 'eval_steps_per_second': 1.046, 'epoch': 4.0}
2025-06-04 19:06:19,951 - INFO - Cleaning up trial c9725e22
2025-06-04 19:06:19,951 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-05-37/train_hpo_c9725e22_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-04_19-05-37
2025-06-04 19:06:19,951 - INFO - Current best: 593dd490 with eval_f1 : 0.8521739130434782 at iteration 1
[36m(train_hpo pid=3414498)[0m 2025-06-04 19:06:19,928 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB

[36m(train_hpo pid=3414975)[0m {'train_runtime': 8.0587, 'train_samples_per_second': 73.709, 'train_steps_per_second': 0.745, 'train_loss': 2.082861304283142, 'epoch': 2.0}
[36m(train_hpo pid=3414975)[0m STATE at ending of training  :  TrainerState(epoch=2.0, global_step=6, max_steps=6, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=104191042424832.0, log_history=[{'loss': 3.0042, 'grad_norm': 14.167771339416504, 'learning_rate': 3.994089731390617e-05, 'epoch': 1.0, 'step': 3}, {'loss': 1.1615, 'grad_norm': 6.420598983764648, 'learning_rate': 0.0, 'epoch': 2.0, 'step': 6}, {'train_runtime': 8.0587, 'train_samples_per_second': 73.709, 'train_steps_per_second': 0.745, 'total_flos': 104191042424832.0, 'train_loss': 2.082861304283142, 'epoch': 2.0, 'step': 6}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3414975)[0m {'loss': 1.1615, 'grad_norm': 6.420598983764648, 'learning_rate': 0.0, 'epoch': 2.0}[32m [repeated 3x across cluster][0m
[36m(train_hpo pid=3414975)[0m {'eval_loss': 1.1085283756256104, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.9004017114639282, 'eval_AP': 0.9995918367346939, 'eval_MCC': 0.0, 'eval_NDCG': 0.9999298518361316, 'eval_kappa': 0.0, 'eval_runtime': 3.2782, 'eval_samples_per_second': 20.133, 'eval_steps_per_second': 1.22, 'epoch': 2.0}

Trial train_hpo_593dd490 finished iteration 1 at 2025-06-04 19:06:13. Total running time: 36s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_593dd490 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    15.7801 â”‚
â”‚ time_total_s                        15.7801 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     2 â”‚
â”‚ eval_AP                             0.99959 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.99993 â”‚
â”‚ eval_accuracy                       0.74242 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.10853 â”‚
â”‚ eval_optim_threshold                 0.9004 â”‚
â”‚ eval_precision                      0.74242 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.2782 â”‚
â”‚ eval_samples_per_second              20.133 â”‚
â”‚ eval_steps_per_second                  1.22 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_593dd490 completed after 1 iterations at 2025-06-04 19:06:13. Total running time: 36s
[36m(train_hpo pid=3414498)[0m STATE at ending of training  :  TrainerState(epoch=4.0, global_step=12, max_steps=12, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=208382084849664.0, log_history=[{'loss': 3.1233, 'grad_norm': 26.455137252807617, 'learning_rate': 1.1217049888818266e-06, 'epoch': 1.0, 'step': 3}, {'loss': 2.9969, 'grad_norm': 27.57137680053711, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.0, 'step': 6}, {'loss': 2.9309, 'grad_norm': 21.836673736572266, 'learning_rate': 3.7390166296060887e-07, 'epoch': 3.0, 'step': 9}, {'loss': 2.8792, 'grad_norm': 29.409774780273438, 'learning_rate': 0.0, 'epoch': 4.0, 'step': 12}, {'train_runtime': 27.0249, 'train_samples_per_second': 43.959, 'train_steps_per_second': 0.444, 'total_flos': 208382084849664.0, 'train_loss': 2.982614358266195, 'epoch': 4.0, 'step': 12}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3414498)[0m {'train_runtime': 27.0249, 'train_samples_per_second': 43.959, 'train_steps_per_second': 0.444, 'train_loss': 2.982614358266195, 'epoch': 4.0}
[36m(train_hpo pid=3414498)[0m {'loss': 2.8792, 'grad_norm': 29.409774780273438, 'learning_rate': 0.0, 'epoch': 4.0}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3414498)[0m {'eval_loss': 3.50258207321167, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.5860236287117004, 'eval_AP': 0.8444037007656631, 'eval_MCC': 0.0, 'eval_NDCG': 0.9490821558485888, 'eval_kappa': 0.0, 'eval_runtime': 3.8254, 'eval_samples_per_second': 17.253, 'eval_steps_per_second': 1.046, 'epoch': 4.0}

Trial train_hpo_c9725e22 finished iteration 1 at 2025-06-04 19:06:19. Total running time: 42s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_c9725e22 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    35.3039 â”‚
â”‚ time_total_s                        35.3039 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     4 â”‚
â”‚ eval_AP                              0.8444 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.94908 â”‚
â”‚ eval_accuracy                       0.74242 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           3.50258 â”‚
â”‚ eval_optim_threshold                0.58602 â”‚
â”‚ eval_precision                      0.74242 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.8254 â”‚
â”‚ eval_samples_per_second              17.253 â”‚
â”‚ eval_steps_per_second                 1.046 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_c9725e22 completed after 1 iterations at 2025-06-04 19:06:19. Total running time: 42s
[36m(train_hpo pid=3414737)[0m {'train_runtime': 25.2744, 'train_samples_per_second': 39.17, 'train_steps_per_second': 0.396, 'train_loss': 2.8348445892333984, 'epoch': 3.4}
[36m(train_hpo pid=3414737)[0m STATE at ending of training  :  TrainerState(epoch=3.4, global_step=10, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=177335259076608.0, log_history=[{'loss': 3.0608, 'grad_norm': 24.82211685180664, 'learning_rate': 3.188774071602418e-06, 'epoch': 1.0, 'step': 3}, {'loss': 2.7956, 'grad_norm': 25.98405647277832, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.0, 'step': 6}, {'loss': 2.6553, 'grad_norm': 19.524255752563477, 'learning_rate': 4.555391530860598e-07, 'epoch': 3.0, 'step': 9}, {'loss': 2.8132, 'grad_norm': 33.423133850097656, 'learning_rate': 0.0, 'epoch': 3.4, 'step': 10}, {'train_runtime': 25.2744, 'train_samples_per_second': 39.17, 'train_steps_per_second': 0.396, 'total_flos': 177335259076608.0, 'train_loss': 2.8348445892333984, 'epoch': 3.4, 'step': 10}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})2025-06-04 19:06:24,500 - INFO - Cleaning up trial d7448ca9
2025-06-04 19:06:24,500 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-05-37/train_hpo_d7448ca9_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-04_19-05-44
2025-06-04 19:06:24,500 - INFO - Current best: c9725e22 with eval_f1 : 0.8521739130434782 at iteration 1
2025-06-04 19:06:24,500 - INFO - Current best: 593dd490 with eval_f1 : 0.8521739130434782 at iteration 1
2025-06-04 19:06:24,509	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-05-37' in 0.0072s.
2025-06-04 19:06:24,515 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x719ac427b7d0>
2025-06-04 19:06:24,516 - INFO - Best trial : train_hpo_c9725e22
2025-06-04 19:06:24,516 - INFO - Best config : {'pos_weight': 8.493688290834637, 'learning_rate': 1.4956066518424355e-06, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 6}
2025-06-04 19:06:24,516 - INFO - Best trial after optimization: {'eval_loss': 3.50258207321167, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.5860236287117004, 'eval_AP': 0.8444037007656631, 'eval_MCC': 0.0, 'eval_NDCG': 0.9490821558485888, 'eval_kappa': 0.0, 'eval_runtime': 3.8254, 'eval_samples_per_second': 17.253, 'eval_steps_per_second': 1.046, 'epoch': 4.0, 'timestamp': 1749056779, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': 'c9725e22', 'date': '2025-06-04_19-06-19', 'time_this_iter_s': 35.30392289161682, 'time_total_s': 35.30392289161682, 'pid': 3414498, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 8.493688290834637, 'learning_rate': 1.4956066518424355e-06, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 6}, 'time_since_restore': 35.30392289161682, 'iterations_since_restore': 1, 'experiment_tag': '1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364'}
[36m(train_hpo pid=3414737)[0m 2025-06-04 19:06:24,435 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3414737)[0m 2025-06-04 19:06:24,441 - INFO - eval_result: {'eval_loss': 3.102787733078003, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.596901535987854, 'eval_AP': 0.9350042793265456, 'eval_MCC': 0.0, 'eval_NDCG': 0.9872083327558734, 'eval_kappa': 0.0, 'eval_runtime': 3.2815, 'eval_samples_per_second': 20.113, 'eval_steps_per_second': 1.219, 'epoch': 3.4}
2025-06-04 19:06:24,543 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   3.502582  0.852174  ...                        6  c9725e22
1   3.102788  0.852174  ...                        5  d7448ca9
2   1.108528  0.852174  ...                        3  593dd490

[3 rows x 32 columns]
2025-06-04 19:06:24,736 - INFO - Trial comparison plot saved
2025-06-04 19:06:24,736 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-04 19:06:25,314 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-04 19:06:25,407 - INFO - training size : 198
2025-06-04 19:06:25,407 - INFO - dev size : 66
2025-06-04 19:06:25,407 - INFO - test size : 133
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(

[36m(train_hpo pid=3414737)[0m {'loss': 2.8132, 'grad_norm': 33.423133850097656, 'learning_rate': 0.0, 'epoch': 3.4}[32m [repeated 2x across cluster][0m

Trial train_hpo_d7448ca9 finished iteration 1 at 2025-06-04 19:06:24. Total running time: 46s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_d7448ca9 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    33.1407 â”‚
â”‚ time_total_s                        33.1407 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   3.4 â”‚
â”‚ eval_AP                               0.935 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.98721 â”‚
â”‚ eval_accuracy                       0.74242 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           3.10279 â”‚
â”‚ eval_optim_threshold                 0.5969 â”‚
â”‚ eval_precision                      0.74242 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.2815 â”‚
â”‚ eval_samples_per_second              20.113 â”‚
â”‚ eval_steps_per_second                 1.219 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_d7448ca9 completed after 1 iterations at 2025-06-04 19:06:24. Total running time: 46s

Trial status: 3 TERMINATED
Current time: 2025-06-04 19:06:24. Total running time: 46s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_c9725e22   TERMINATED        8.49369       1.49561e-06         0.13641                     6        1            35.3039       3.50258    0.852174               1          0.742424 â”‚
â”‚ train_hpo_d7448ca9   TERMINATED        7.54953       4.55539e-06         0.123031                    5        1            33.1407       3.10279    0.852174               1          0.742424 â”‚
â”‚ train_hpo_593dd490   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            15.7801       1.10853    0.852174               1          0.742424 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

  0%|          | 0/54 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  2%|â–         | 1/54 [00:00<00:34,  1.54it/s]  4%|â–Ž         | 2/54 [00:01<00:32,  1.59it/s]  6%|â–Œ         | 3/54 [00:01<00:31,  1.60it/s]  7%|â–‹         | 4/54 [00:02<00:31,  1.61it/s]  9%|â–‰         | 5/54 [00:03<00:30,  1.61it/s] 11%|â–ˆ         | 6/54 [00:03<00:29,  1.61it/s] 13%|â–ˆâ–Ž        | 7/54 [00:04<00:29,  1.62it/s] 15%|â–ˆâ–        | 8/54 [00:04<00:28,  1.63it/s] 17%|â–ˆâ–‹        | 9/54 [00:05<00:23,  1.91it/s]                                               17%|â–ˆâ–‹        | 9/54 [00:05<00:23,  1.91it/s] 19%|â–ˆâ–Š        | 10/54 [00:05<00:24,  1.79it/s] 20%|â–ˆâ–ˆ        | 11/54 [00:06<00:24,  1.73it/s] 22%|â–ˆâ–ˆâ–       | 12/54 [00:07<00:24,  1.70it/s] 24%|â–ˆâ–ˆâ–       | 13/54 [00:07<00:24,  1.67it/s] 26%|â–ˆâ–ˆâ–Œ       | 14/54 [00:08<00:24,  1.65it/s] 28%|â–ˆâ–ˆâ–Š       | 15/54 [00:09<00:23,  1.64it/s] 30%|â–ˆâ–ˆâ–‰       | 16/54 [00:09<00:23,  1.64it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 17/54 [00:10<00:22,  1.65it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 18/54 [00:10<00:18,  1.92it/s]                                                33%|â–ˆâ–ˆâ–ˆâ–Ž      | 18/54 [00:10<00:18,  1.92it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 19/54 [00:11<00:19,  1.80it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 20/54 [00:11<00:19,  1.74it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 21/54 [00:12<00:19,  1.70it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 22/54 [00:13<00:19,  1.68it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 23/54 [00:13<00:18,  1.66it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 24/54 [00:14<00:18,  1.65it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 25/54 [00:14<00:17,  1.64it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 26/54 [00:15<00:17,  1.65it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 27/54 [00:15<00:14,  1.92it/s]                                                50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 27/54 [00:15<00:14,  1.92it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 28/54 [00:16<00:14,  1.79it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 29/54 [00:17<00:14,  1.74it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 30/54 [00:17<00:14,  1.70it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 31/54 [00:18<00:13,  1.67it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 32/54 [00:18<00:13,  1.65it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 33/54 [00:19<00:12,  1.64it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 34/54 [00:20<00:12,  1.63it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 35/54 [00:20<00:11,  1.64it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 36/54 [00:21<00:09,  1.91it/s]                                                67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 36/54 [00:21<00:09,  1.91it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 37/54 [00:21<00:09,  1.79it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 38/54 [00:22<00:09,  1.74it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 39/54 [00:22<00:08,  1.68it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 40/54 [00:23<00:08,  1.66it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 41/54 [00:24<00:07,  1.65it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 42/54 [00:24<00:07,  1.64it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 43/54 [00:25<00:06,  1.63it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 44/54 [00:26<00:06,  1.64it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 45/54 [00:26<00:04,  1.91it/s]                                                83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 45/54 [00:26<00:04,  1.91it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 46/54 [00:27<00:04,  1.79it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 47/54 [00:27<00:04,  1.73it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 48/54 [00:28<00:03,  1.70it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 49/54 [00:28<00:02,  1.67it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 50/54 [00:29<00:02,  1.65it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 51/54 [00:30<00:01,  1.64it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 52/54 [00:30<00:01,  1.63it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 53/54 [00:31<00:00,  1.64it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 54/54 [00:31<00:00,  1.91it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 54/54 [00:33<00:00,  1.91it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 54/54 [00:33<00:00,  1.91it/s]2025-06-04 19:06:59,800 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 54/54 [00:33<00:00,  1.59it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
{'loss': 6.7296, 'grad_norm': 89.52112579345703, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}
{'loss': 6.2147, 'grad_norm': 85.07542419433594, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0}
{'loss': 5.7232, 'grad_norm': 133.20254516601562, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0}
{'loss': 4.8764, 'grad_norm': 116.97480010986328, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0}
{'loss': 3.893, 'grad_norm': 95.18091583251953, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0}
{'loss': 3.3808, 'grad_norm': 77.63134765625, 'learning_rate': 0.0, 'epoch': 6.0}
{'train_runtime': 33.9546, 'train_samples_per_second': 34.988, 'train_steps_per_second': 1.59, 'train_loss': 5.136293446576154, 'epoch': 6.0}
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.33it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.67it/s]2025-06-04 19:07:03,437 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.11s/it]
2025-06-04 19:07:03,444 - INFO - Training time : 38.70721784001216
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.18it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.06it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.38it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.12it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.27it/s]2025-06-04 19:07:07,885 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.45it/s]
2025-06-04 19:07:07,890 - INFO - Evaluation time : 4.4459320260211825
2025-06-04 19:07:07,890 - INFO - Evaluation results on test set: {'eval_loss': 3.2079339027404785, 'eval_f1': 0.9239130434782609, 'eval_recall': 0.8673469387755102, 'eval_accuracy': 0.8947368421052632, 'eval_precision': 0.9883720930232558, 'eval_optim_threshold': 0.4978412389755249, 'eval_AP': 0.991370152544838, 'eval_MCC': 0.7726710617928554, 'eval_NDCG': 0.9986096910575133, 'eval_kappa': 0.7555147058823529, 'eval_runtime': 4.4415, 'eval_samples_per_second': 29.945, 'eval_steps_per_second': 1.351, 'epoch': 6.0}
2025-06-04 19:07:07,890 - INFO - Total updates (optimizer steps): 54
2025-06-04 19:07:07,890 - INFO - Avg time / step: 0.629s
2025-06-04 19:07:08,538 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCEdmis-lab/biobert-v1.13trials_fold-1
2025-06-04 19:07:08,538 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.16it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.05it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.38it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.12it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.27it/s]2025-06-04 19:07:13,212 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.37it/s]
2025-06-04 19:07:13,216 - INFO - preds : [0 0 0 0 1 1 1 1 1 0 1 1 1 1 0 1 1 1 1 0 0 0 1 1 1 1 1 1 0 1 0 1 0 1 1 1 1
 1 1 1 0 0 1 0 1 1 0 1 1 1 1 0 0 1 1 0 1 1 1 0 1 0 1 1 0 1 1 1 1 1 1 1 0 0
 1 1 0 1 0 0 0 1 1 1 1 1 1 0 1 1 1 1 0 1 1 0 1 0 1 0 0 1 0 0 1 0 1 1 1 0 0
 0 1 1 1 1 1 0 1 0 1 1 0 1 1 1 1 0 0 0 1 1 0]
2025-06-04 19:07:13,217 - INFO - test_split["labels"] : [1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0]
2025-06-04 19:07:13,218 - INFO - Confusion matrix: TN=34, FP=1, FN=13, TP=85
2025-06-04 19:07:15,965 - INFO - Metrics: {'f1': 0.9239130434782609, 'recall': 0.8673469387755102, 'precision': 0.9883720930232558, 'accuracy': 0.8947368421052632, 'AP': 0.991370152544838, 'MCC': 0.7726710617928554, 'NDCG': 0.9986096910575133, 'kappa': 0.7555147058823529, 'TN': 34, 'FP': 1, 'FN': 13, 'TP': 85}
2025-06-04 19:07:16,091 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-04 19:07:16,195 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:07:16,195 - INFO - 
On test Set (optimal threshold of 0.5143629312515259 according to cross validation on the training set): 
2025-06-04 19:07:16,197 - INFO - Confusion matrix: TN=35, FP=0, FN=16, TP=82
2025-06-04 19:07:19,211 - INFO - Metrics: {'f1': 0.9111111111111111, 'recall': 0.8367346938775511, 'precision': 1.0, 'accuracy': 0.8796992481203008, 'AP': 0.991370152544838, 'MCC': 0.7577794480432619, 'NDCG': 0.9986096910575133, 'kappa': 0.7295373665480427, 'TN': 35, 'FP': 0, 'FN': 16, 'TP': 82}
2025-06-04 19:07:19,312 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:07:19,312 - INFO - Results for fold 1 : [{'f1': 0.9111111111111111, 'recall': 0.8367346938775511, 'precision': 1.0, 'accuracy': 0.8796992481203008, 'AP': 0.991370152544838, 'MCC': 0.7577794480432619, 'NDCG': 0.9986096910575133, 'kappa': 0.7295373665480427, 'TN': 35, 'FP': 0, 'FN': 16, 'TP': 82}]
2025-06-04 19:07:19,434 - INFO - Cleared CUDA cache. Memory allocated: 1.38 GB, Memory reserved: 1.76 GB
2025-06-04 19:07:19,434 - INFO - 
fold number 2 / 3
2025-06-04 19:07:19,440 - INFO - train split size : 198
2025-06-04 19:07:19,440 - INFO - dev split size : 67
2025-06-04 19:07:19,440 - INFO - test split size : 132
Map (num_proc=32):   0%|          | 0/198 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–Ž         | 7/198 [00:00<00:04, 42.64 examples/s]Map (num_proc=32):  24%|â–ˆâ–ˆâ–       | 48/198 [00:00<00:00, 200.22 examples/s]Map (num_proc=32):  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 84/198 [00:00<00:00, 238.51 examples/s]Map (num_proc=32):  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 120/198 [00:00<00:00, 270.15 examples/s]Map (num_proc=32):  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 150/198 [00:00<00:00, 270.23 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 180/198 [00:00<00:00, 277.84 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 198/198 [00:00<00:00, 219.68 examples/s]
Map (num_proc=32):   0%|          | 0/67 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/67 [00:00<00:03, 18.81 examples/s]Map (num_proc=32):  25%|â–ˆâ–ˆâ–Œ       | 17/67 [00:00<00:00, 69.68 examples/s]Map (num_proc=32):  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 29/67 [00:00<00:00, 86.39 examples/s]Map (num_proc=32):  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 41/67 [00:00<00:00, 93.16 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 53/67 [00:00<00:00, 96.66 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 65/67 [00:00<00:00, 101.24 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:00<00:00, 76.74 examples/s] 
Map (num_proc=32):   0%|          | 0/132 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/132 [00:00<00:04, 30.41 examples/s]Map (num_proc=32):  21%|â–ˆâ–ˆ        | 28/132 [00:00<00:00, 118.30 examples/s]Map (num_proc=32):  39%|â–ˆâ–ˆâ–ˆâ–‰      | 52/132 [00:00<00:00, 156.47 examples/s]Map (num_proc=32):  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 72/132 [00:00<00:00, 160.62 examples/s]Map (num_proc=32):  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 100/132 [00:00<00:00, 181.15 examples/s]Map (num_proc=32):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 124/132 [00:00<00:00, 188.84 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 132/132 [00:00<00:00, 145.14 examples/s]
2025-06-04 19:07:27,750 - INFO - 3 datasets tokenized successfully
2025-06-04 19:07:27,752 - INFO - Starting hyperparameter search for BCE loss
[36m(train_hpo pid=3417413)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3417413)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3414737)[0m 2025-06-04 19:06:24,475 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3417413)[0m 2025-06-04 19:07:35,691 - INFO - pos_weight value in TrainingArguments : 8.493688290834637
[36m(train_hpo pid=3417413)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3417413)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3417413)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3417413)[0m   warnings.warn(
[36m(train_hpo pid=3417579)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3417579)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3417579)[0m 2025-06-04 19:07:42,278 - INFO - pos_weight value in TrainingArguments : 7.549531688595925
[36m(train_hpo pid=3417579)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3417579)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3417579)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3417579)[0m   warnings.warn(
[36m(train_hpo pid=3417879)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3417879)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3417879)[0m 2025-06-04 19:07:49,122 - INFO - pos_weight value in TrainingArguments : 8.949837496427758
[36m(train_hpo pid=3417879)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3417879)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3417879)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3417879)[0m   warnings.warn(
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-04_19-07-27   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-07-27
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-04_18-54-36_274448_3393636/artifacts/2025-06-04_19-07-27/train_hpo_2025-06-04_19-07-27/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-04 19:07:27. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_5190e65e   PENDING         8.49369       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_5190e65e started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_5190e65e config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          8.49369 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3417413)[0m [2025-06-04 19:07:35,927] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3414737)[0m {'eval_loss': 3.102787733078003, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.596901535987854, 'eval_AP': 0.9350042793265456, 'eval_MCC': 0.0, 'eval_NDCG': 0.9872083327558734, 'eval_kappa': 0.0, 'eval_runtime': 3.2815, 'eval_samples_per_second': 20.113, 'eval_steps_per_second': 1.219, 'epoch': 3.4}
[36m(train_hpo pid=3417413)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=12, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_13cbb0ac started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_13cbb0ac config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          7.54953 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3417579)[0m [2025-06-04 19:07:42,670] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3417413)[0m {'loss': 5.5395, 'grad_norm': 38.534637451171875, 'learning_rate': 1.1217049888818266e-06, 'epoch': 1.0}
[36m(train_hpo pid=3417579)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_76f0794b started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_76f0794b config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          8.94984 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3417413)[0m {'loss': 5.3337, 'grad_norm': 38.634178161621094, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.0}
[36m(train_hpo pid=3417879)[0m [2025-06-04 19:07:49,352] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3417879)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=6, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3417579)[0m {'loss': 3.2555, 'grad_norm': 24.475873947143555, 'learning_rate': 3.188774071602418e-06, 'epoch': 1.0}

Trial status: 3 RUNNING
Current time: 2025-06-04 19:07:58. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_5190e65e   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_13cbb0ac   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_76f0794b   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯2025-06-04 19:08:04,650 - INFO - Cleaning up trial 76f0794b
2025-06-04 19:08:04,650 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-07-27/train_hpo_76f0794b_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512_2025-06-04_19-07-41
[36m(train_hpo pid=3417879)[0m 2025-06-04 19:08:04,586 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3417879)[0m 2025-06-04 19:08:04,592 - INFO - eval_result: {'eval_loss': 1.1744534969329834, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.8801649808883667, 'eval_AP': 1.0, 'eval_MCC': 0.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 0.0, 'eval_runtime': 3.8751, 'eval_samples_per_second': 17.29, 'eval_steps_per_second': 1.032, 'epoch': 2.0}
[36m(train_hpo pid=3417879)[0m 2025-06-04 19:08:04,626 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3417413)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
[36m(train_hpo pid=3417413)[0m   _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
[36m(train_hpo pid=3417413)[0m 2025-06-04 19:08:10,055 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3417413)[0m 2025-06-04 19:08:10,060 - INFO - eval_result: {'eval_loss': 6.236849308013916, 'eval_f1': 0.0, 'eval_recall': 0.0, 'eval_accuracy': 0.26865671641791045, 'eval_precision': 0.0, 'eval_optim_threshold': 0.3651634454727173, 'eval_AP': 0.7413434329874268, 'eval_MCC': 0.0, 'eval_NDCG': 0.8742575107227141, 'eval_kappa': 0.0, 'eval_runtime': 3.8773, 'eval_samples_per_second': 17.28, 'eval_steps_per_second': 1.032, 'epoch': 4.0}
2025-06-04 19:08:10,118 - INFO - Cleaning up trial 5190e65e
2025-06-04 19:08:10,119 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-07-27/train_hpo_5190e65e_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-04_19-07-27
2025-06-04 19:08:10,119 - INFO - Current best: 76f0794b with eval_f1 : 0.8448275862068966 at iteration 1
[36m(train_hpo pid=3417413)[0m 2025-06-04 19:08:10,095 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3417413)[0m *** SIGSEGV received at time=1749056890 on cpu 16 ***
[36m(train_hpo pid=3417413)[0m PC: @     0x7ea7e53385de  (unknown)  ray::gcs::TaskInfoAccessor::AsyncAddTaskEventData()
[36m(train_hpo pid=3417413)[0m     @     0x7ea7e6a45330       3664  (unknown)
[36m(train_hpo pid=3417413)[0m     @     0x7ea7e5216ce5       1392  ray::core::worker::TaskEventBufferImpl::FlushEvents()
[36m(train_hpo pid=3417413)[0m     @     0x7ea7e519d18c       1488  ray::core::CoreWorker::Disconnect()
[36m(train_hpo pid=3417413)[0m     @     0x7ea7e519d6bd       1152  ray::core::CoreWorker::ForceExit()
[36m(train_hpo pid=3417413)[0m     @     0x7ea7e519daef       1680  ray::core::CoreWorker::HandleKillActor()
[36m(train_hpo pid=3417413)[0m     @     0x7ea7e5194e74        192  ray::rpc::ServerCallImpl<>::HandleRequestImpl()
[36m(train_hpo pid=3417413)[0m     @     0x7ea7e556b5d8       1168  EventTracker::RecordExecution()
[36m(train_hpo pid=3417413)[0m     @     0x7ea7e55665ae         48  std::_Function_handler<>::_M_invoke()
[36m(train_hpo pid=3417413)[0m     @     0x7ea7e5566a26        112  boost::asio::detail::completion_handler<>::do_complete()
[36m(train_hpo pid=3417413)[0m     @     0x7ea7e5beaf4b        128  boost::asio::detail::scheduler::do_run_one()
[36m(train_hpo pid=3417413)[0m     @     0x7ea7e5bec8c9        288  boost::asio::detail::scheduler::run()
[36m(train_hpo pid=3417413)[0m     @     0x7ea7e5becfd2         96  boost::asio::io_context::run()
[36m(train_hpo pid=3417413)[0m     @     0x7ea7e50f5751       1280  ray::core::CoreWorker::RunIOService()
[36m(train_hpo pid=3417413)[0m     @     0x7ea7e5605f90         64  thread_proxy
[36m(train_hpo pid=3417413)[0m     @     0x7ea7e6a9caa4        176  (unknown)
[36m(train_hpo pid=3417413)[0m     @     0x7ea7e6b29c3c  (unknown)  (unknown)
[36m(train_hpo pid=3417413)[0m [2025-06-04 19:08:10,166 E 3417413 3417451] logging.cc:497: *** SIGSEGV received at time=1749056890 on cpu 16 ***
[36m(train_hpo pid=3417413)[0m [2025-06-04 19:08:10,166 E 3417413 3417451] logging.cc:497: PC: @     0x7ea7e53385de  (unknown)  ray::gcs::TaskInfoAccessor::AsyncAddTaskEventData()
[36m(train_hpo pid=3417413)[0m [2025-06-04 19:08:10,166 E 3417413 3417451] logging.cc:497:     @     0x7ea7e6a45330       3664  (unknown)
[36m(train_hpo pid=3417413)[0m [2025-06-04 19:08:10,166 E 3417413 3417451] logging.cc:497:     @     0x7ea7e5216ce5       1392  ray::core::worker::TaskEventBufferImpl::FlushEvents()
[36m(train_hpo pid=3417413)[0m [2025-06-04 19:08:10,166 E 3417413 3417451] logging.cc:497:     @     0x7ea7e519d18c       1488  ray::core::CoreWorker::Disconnect()
[36m(train_hpo pid=3417413)[0m [2025-06-04 19:08:10,166 E 3417413 3417451] logging.cc:497:     @     0x7ea7e519d6bd       1152  ray::core::CoreWorker::ForceExit()
[36m(train_hpo pid=3417413)[0m [2025-06-04 19:08:10,166 E 3417413 3417451] logging.cc:497:     @     0x7ea7e519daef       1680  ray::core::CoreWorker::HandleKillActor()
[36m(train_hpo pid=3417413)[0m [2025-06-04 19:08:10,166 E 3417413 3417451] logging.cc:497:     @     0x7ea7e5194e74        192  ray::rpc::ServerCallImpl<>::HandleRequestImpl()
[36m(train_hpo pid=3417413)[0m [2025-06-04 19:08:10,166 E 3417413 3417451] logging.cc:497:     @     0x7ea7e556b5d8       1168  EventTracker::RecordExecution()
[36m(train_hpo pid=3417413)[0m [2025-06-04 19:08:10,166 E 3417413 3417451] logging.cc:497:     @     0x7ea7e55665ae         48  std::_Function_handler<>::_M_invoke()
[36m(train_hpo pid=3417413)[0m [2025-06-04 19:08:10,166 E 3417413 3417451] logging.cc:497:     @     0x7ea7e5566a26        112  boost::asio::detail::completion_handler<>::do_complete()
[36m(train_hpo pid=3417413)[0m [2025-06-04 19:08:10,166 E 3417413 3417451] logging.cc:497:     @     0x7ea7e5beaf4b        128  boost::asio::detail::scheduler::do_run_one()
[36m(train_hpo pid=3417413)[0m [2025-06-04 19:08:10,166 E 3417413 3417451] logging.cc:497:     @     0x7ea7e5bec8c9        288  boost::asio::detail::scheduler::run()
[36m(train_hpo pid=3417413)[0m [2025-06-04 19:08:10,166 E 3417413 3417451] logging.cc:497:     @     0x7ea7e5becfd2         96  boost::asio::io_context::run()
[36m(train_hpo pid=3417413)[0m [2025-06-04 19:08:10,166 E 3417413 3417451] logging.cc:497:     @     0x7ea7e50f5751       1280  ray::core::CoreWorker::RunIOService()
[36m(train_hpo pid=3417413)[0m [2025-06-04 19:08:10,167 E 3417413 3417451] logging.cc:497:     @     0x7ea7e5605f90         64  thread_proxy
[36m(train_hpo pid=3417413)[0m [2025-06-04 19:08:10,167 E 3417413 3417451] logging.cc:497:     @     0x7ea7e6a9caa4        176  (unknown)
[36m(train_hpo pid=3417413)[0m [2025-06-04 19:08:10,167 E 3417413 3417451] logging.cc:497:     @     0x7ea7e6b29c3c  (unknown)  (unknown)
[36m(train_hpo pid=3417413)[0m Fatal Python error: Segmentation fault
[36m(train_hpo pid=3417413)[0m 
[36m(train_hpo pid=3417413)[0m 
[36m(train_hpo pid=3417413)[0m Extension modules: msgpack._cmsgpack, google._upb._message, psutil._psutil_linux, psutil._psutil_posix, setproctitle, yaml._yaml, zstandard.backend_c, charset_normalizer.md, ray._raylet, numpy.core._multiarray_umath, numpy.core._multiarray_tests, numpy.linalg._umath_linalg, numpy.fft._pocketfft_internal, numpy.random._common, numpy.random.bit_generator, numpy.random._bounded_integers, numpy.random._mt19937, numpy.random.mtrand, numpy.random._philox, numpy.random._pcg64, numpy.random._sfc64, numpy.random._generator, pyarrow.lib, pandas._libs.tslibs.ccalendar, pandas._libs.tslibs.np_datetime, pandas._libs.tslibs.dtypes, pandas._libs.tslibs.base, pandas._libs.tslibs.nattype, pandas._libs.tslibs.timezones, pandas._libs.tslibs.fields, pandas._libs.tslibs.timedeltas, pandas._libs.tslibs.tzconversion, pandas._libs.tslibs.timestamps, pandas._libs.properties, pandas._libs.tslibs.offsets, pandas._libs.tslibs.strptime, pandas._libs.tslibs.parsing, pandas._libs.tslibs.conversion, pandas._libs.tslibs.period, pandas._libs.tslibs.vectorized, pandas._libs.ops_dispatch, pandas._libs.missing, pandas._libs.hashtable, pandas._libs.algos, pandas._libs.interval, pandas._libs.lib, pyarrow._compute, pandas._libs.ops, bottleneck.move, bottleneck.nonreduce, bottleneck.nonreduce_axis, bottleneck.reduce, pandas._libs.hashing, pandas._libs.arrays, pandas._libs.tslib, pandas._libs.sparse, pandas._libs.internals, pandas._libs.indexing, pandas._libs.index, pandas._libs.writers, pandas._libs.join, pandas._libs.window.aggregations, pandas._libs.window.indexers, pandas._libs.reshape, pandas._libs.groupby, pandas._libs.json, pandas._libs.parsers, pandas._libs.testing, pyarrow._fs, pyarrow._azurefs, pyarrow._hdfs, pyarrow._gcsfs, pyarrow._s3fs, pyarrow._parquet, pyarrow._json, torch._C, torch._C._dynamo.autograd_compiler, torch._C._dynamo.eval_frame, torch._C._dynamo.guards, torch._C._dynamo.utils, torch._C._fft, torch._C._linalg, torch._C._nested, torch._C._nn, torch._C._sparse, torch._C._special, multidict._multidict, yarl._quoting_c, propcache._helpers_c, aiohttp._http_writer, aiohttp._http_parser, aiohttp._websocket.mask, aiohttp._websocket.reader_c, frozenlist._frozenlist, xxhash._xxhash, pyarrow._acero, pyarrow._csv, pyarrow._substrait, pyarrow._dataset, pyarrow._dataset_orc, pyarrow._parquet_encryption, pyarrow._dataset_parquet_encryption, pyarrow._dataset_parquet, markupsafe._speedups, PIL._imaging, PIL._imagingft, sklearn.__check_build._check_build, scipy._lib._ccallback_c, scipy.sparse._sparsetools, _csparsetools, scipy.sparse._csparsetools, scipy.linalg._fblas, scipy.linalg._flapack, scipy.linalg.cython_lapack, scipy.linalg._cythonized_array_utils, scipy.linalg._solve_toeplitz, scipy.linalg._decomp_lu_cython, scipy.linalg._matfuncs_sqrtm_triu, scipy.linalg._matfuncs_expm, scipy.linalg._linalg_pythran, scipy.linalg.cython_blas, scipy.linalg._decomp_update, scipy.sparse.linalg._dsolve._superlu, scipy.sparse.linalg._eigen.arpack._arpack, scipy.sparse.linalg._propack._spropack, scipy.sparse.linalg._propack._dpropack, scipy.sparse.linalg._propack._cpropack, scipy.sparse.linalg._propack._zpropack, scipy.sparse.csgraph._tools, scipy.sparse.csgraph._shortest_path, scipy.sparse.csgraph._traversal, scipy.sparse.csgraph._min_spanning_tree, scipy.sparse.csgraph._flow, scipy.sparse.csgraph._matching, scipy.sparse.csgraph._reordering, scipy.special._ufuncs_cxx, scipy.special._ufuncs, scipy.special._specfun, scipy.special._comb, scipy.special._ellip_harm_2, scipy.spatial._ckdtree, scipy._lib.messagestream, scipy.spatial._qhull, scipy.spatial._voronoi, scipy.spatial._distance_wrap, scipy.spatial._hausdorff, scipy.spatial.transform._rotation, scipy.optimize._group_columns, scipy.optimize._trlib._trlib, scipy.optimize._lbfgsb, _moduleTNC, scipy.optimize._moduleTNC, scipy.optimize._cobyla, scipy.optimize._slsqp, scipy.optimize._minpack, scipy.optimize._lsq.givens_elimination, scipy.optimize._zeros, scipy.optimize._cython_nnls, scipy._lib._uarray._uarray, scipy.linalg._decomp_interpolative, scipy.optimize._bglu_dense, scipy.optimize._lsap, scipy.optimize._direct, scipy.integrate._odepack, scipy.integrate._quadpack, scipy.integrate._vode, scipy.integrate._dop, scipy.integrate._lsoda, scipy.interpolate._fitpack, scipy.interpolate._dfitpack, scipy.interpolate._dierckx, scipy.interpolate._ppoly, scipy.interpolate._interpnd, scipy.interpolate._rbfinterp_pythran, scipy.interpolate._rgi_cython, scipy.interpolate._bspl, scipy.special.cython_special, scipy.stats._stats, scipy.stats._sobol, scipy.stats._qmc_cy, scipy.stats._biasedurn, scipy.stats._stats_pythran, scipy.stats._levy_stable.levyst, scipy.stats._ansari_swilk_statistics, scipy.stats._mvn, scipy.stats._rcont.rcont, scipy.ndimage._nd_image, scipy.ndimage._rank_filter_1d, _ni_label, scipy.ndimage._ni_label, sklearn.utils._isfinite, sklearn.utils.sparsefuncs_fast, sklearn.utils.murmurhash, sklearn.utils._openmp_helpers, sklearn.metrics.cluster._expected_mutual_info_fast, sklearn.preprocessing._csr_polynomial_expansion, sklearn.preprocessing._target_encoder_fast, sklearn.metrics._dist_metrics, sklearn.metrics._pairwise_distances_reduction._datasets_pair, sklearn.utils._cython_blas, sklearn.metrics._pairwise_distances_reduction._base, sklearn.metrics._pairwise_distances_reduction._middle_term_computer, sklearn.utils._heap, sklearn.utils._sorting, sklearn.metrics._pairwise_distances_reduction._argkmin, sklearn.metrics._pairwise_distances_reduction._argkmin_classmode, sklearn.utils._vector_sentinel, sklearn.metrics._pairwise_distances_reduction._radius_neighbors, sklearn.metrics._pairwise_distances_reduction._radius_neighbors_classmode, sklearn.metrics._pairwise_fast, kiwisolver._cext, sklearn.utils._random, sklearn.utils._seq_dataset, sklearn.linear_model._cd_fast, _loss, sklearn._loss._loss, sklearn.utils.arrayfuncs, sklearn.svm._liblinear, sklearn.svm._libsvm, sklearn.svm._libsvm_sparse, sklearn.linear_model._sag_fast, sklearn.utils._weight_vector, sklearn.linear_model._sgd_fast, sklearn.neighbors._partition_nodes, sklearn.neighbors._ball_tree, sklearn.neighbors._kd_tree, sklearn.decomposition._online_lda_fast, sklearn.decomposition._cdnmf_fast, sklearn.tree._utils, sklearn.neighbors._quad_tree, sklearn.tree._tree, sklearn.tree._partitioner, sklearn.tree._splitter, sklearn.tree._criterion, sklearn.ensemble._gradient_boosting, sklearn.ensemble._hist_gradient_boosting.common, sklearn.ensemble._hist_gradient_boosting._gradient_boosting, sklearn.ensemble._hist_gradient_boosting._binning, sklearn.ensemble._hist_gradient_boosting._bitset, sklearn.ensemble._hist_gradient_boosting.histogram, sklearn.ensemble._hist_gradient_boosting._predictor, sklearn.ensemble._hist_gradient_boosting.splitting, sklearn.feature_extraction._hashing_fast, scipy.cluster._vq, scipy.cluster._hierarchy, scipy.cluster._optimal_leaf_ordering, lxml._elementpath, lxml.etree, sklearn._isotonic, sklearn.utils._fast_dict, sklearn.cluster._hierarchical_fast, sklearn.cluster._k_means_common, sklearn.cluster._k_means_elkan, sklearn.cluster._k_means_lloyd, sklearn.cluster._k_means_minibatch, sklearn.cluster._dbscan_inner, sklearn.cluster._hdbscan._tree, sklearn.cluster._hdbscan._linkage, sklearn.cluster._hdbscan._reachability, sklearn.manifold._barnes_hut_tsne, sklearn.manifold._utils, scipy.io.matlab._mio_utils, scipy.io.matlab._streams, scipy.io.matlab._mio5_utils, sklearn.datasets._svmlight_format_fast, cuda_utils, _cffi_backend, PIL._imagingmath (total: 268)

[36m(train_hpo pid=3417879)[0m {'train_runtime': 8.0545, 'train_samples_per_second': 73.748, 'train_steps_per_second': 0.745, 'train_loss': 2.145343542098999, 'epoch': 2.0}
[36m(train_hpo pid=3417879)[0m STATE at ending of training  :  TrainerState(epoch=2.0, global_step=6, max_steps=6, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=104191042424832.0, log_history=[{'loss': 2.9368, 'grad_norm': 9.870875358581543, 'learning_rate': 3.994089731390617e-05, 'epoch': 1.0, 'step': 3}, {'loss': 1.3539, 'grad_norm': 10.129280090332031, 'learning_rate': 0.0, 'epoch': 2.0, 'step': 6}, {'train_runtime': 8.0545, 'train_samples_per_second': 73.748, 'train_steps_per_second': 0.745, 'total_flos': 104191042424832.0, 'train_loss': 2.145343542098999, 'epoch': 2.0, 'step': 6}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3417879)[0m {'loss': 1.3539, 'grad_norm': 10.129280090332031, 'learning_rate': 0.0, 'epoch': 2.0}[32m [repeated 3x across cluster][0m

Trial train_hpo_76f0794b finished iteration 1 at 2025-06-04 19:08:04. Total running time: 36s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_76f0794b result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                     16.363 â”‚
â”‚ time_total_s                         16.363 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     2 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                       0.73134 â”‚
â”‚ eval_f1                             0.84483 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.17445 â”‚
â”‚ eval_optim_threshold                0.88016 â”‚
â”‚ eval_precision                      0.73134 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.8751 â”‚
â”‚ eval_samples_per_second               17.29 â”‚
â”‚ eval_steps_per_second                 1.032 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_76f0794b completed after 1 iterations at 2025-06-04 19:08:04. Total running time: 36s
[36m(train_hpo pid=3417879)[0m {'eval_loss': 1.1744534969329834, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.8801649808883667, 'eval_AP': 1.0, 'eval_MCC': 0.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 0.0, 'eval_runtime': 3.8751, 'eval_samples_per_second': 17.29, 'eval_steps_per_second': 1.032, 'epoch': 2.0}
[36m(train_hpo pid=3417413)[0m STATE at ending of training  :  TrainerState(epoch=4.0, global_step=12, max_steps=12, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=208382084849664.0, log_history=[{'loss': 5.5395, 'grad_norm': 38.534637451171875, 'learning_rate': 1.1217049888818266e-06, 'epoch': 1.0, 'step': 3}, {'loss': 5.3337, 'grad_norm': 38.634178161621094, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.0, 'step': 6}, {'loss': 5.2489, 'grad_norm': 35.957740783691406, 'learning_rate': 3.7390166296060887e-07, 'epoch': 3.0, 'step': 9}, {'loss': 5.2001, 'grad_norm': 41.930091857910156, 'learning_rate': 0.0, 'epoch': 4.0, 'step': 12}, {'train_runtime': 27.0536, 'train_samples_per_second': 43.913, 'train_steps_per_second': 0.444, 'total_flos': 208382084849664.0, 'train_loss': 5.330548683802287, 'epoch': 4.0, 'step': 12}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3417413)[0m {'train_runtime': 27.0536, 'train_samples_per_second': 43.913, 'train_steps_per_second': 0.444, 'train_loss': 5.330548683802287, 'epoch': 4.0}
[36m(train_hpo pid=3417413)[0m {'loss': 5.2001, 'grad_norm': 41.930091857910156, 'learning_rate': 0.0, 'epoch': 4.0}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3417413)[0m {'eval_loss': 6.236849308013916, 'eval_f1': 0.0, 'eval_recall': 0.0, 'eval_accuracy': 0.26865671641791045, 'eval_precision': 0.0, 'eval_optim_threshold': 0.3651634454727173, 'eval_AP': 0.7413434329874268, 'eval_MCC': 0.0, 'eval_NDCG': 0.8742575107227141, 'eval_kappa': 0.0, 'eval_runtime': 3.8773, 'eval_samples_per_second': 17.28, 'eval_steps_per_second': 1.032, 'epoch': 4.0}

Trial train_hpo_5190e65e finished iteration 1 at 2025-06-04 19:08:10. Total running time: 42s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_5190e65e result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    35.4764 â”‚
â”‚ time_total_s                        35.4764 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     4 â”‚
â”‚ eval_AP                             0.74134 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.87426 â”‚
â”‚ eval_accuracy                       0.26866 â”‚
â”‚ eval_f1                                   0 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           6.23685 â”‚
â”‚ eval_optim_threshold                0.36516 â”‚
â”‚ eval_precision                            0 â”‚
â”‚ eval_recall                               0 â”‚
â”‚ eval_runtime                         3.8773 â”‚
â”‚ eval_samples_per_second               17.28 â”‚
â”‚ eval_steps_per_second                 1.032 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_5190e65e completed after 1 iterations at 2025-06-04 19:08:10. Total running time: 42s
[36m(train_hpo pid=3417579)[0m {'train_runtime': 25.3171, 'train_samples_per_second': 39.104, 'train_steps_per_second': 0.395, 'train_loss': 3.0178396224975588, 'epoch': 3.4}
[36m(train_hpo pid=3417579)[0m STATE at ending of training  :  TrainerState(epoch=3.4, global_step=10, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=177335259076608.0, log_history=[{'loss': 3.2555, 'grad_norm': 24.475873947143555, 'learning_rate': 3.188774071602418e-06, 'epoch': 1.0, 'step': 3}, {'loss': 2.9676, 'grad_norm': 24.31956672668457, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.0, 'step': 6}, {'loss': 2.7748, 'grad_norm': 22.109987258911133, 'learning_rate': 4.555391530860598e-07, 'epoch': 3.0, 'step': 9}, {'loss': 3.1848, 'grad_norm': 41.478153228759766, 'learning_rate': 0.0, 'epoch': 3.4, 'step': 10}, {'train_runtime': 25.3171, 'train_samples_per_second': 39.104, 'train_steps_per_second': 0.395, 'total_flos': 177335259076608.0, 'train_loss': 3.0178396224975588, 'epoch': 3.4, 'step': 10}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})2025-06-04 19:08:14,715 - INFO - Cleaning up trial 13cbb0ac
2025-06-04 19:08:14,716 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-07-27/train_hpo_13cbb0ac_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-04_19-07-34
2025-06-04 19:08:14,716 - INFO - Cleaning up trial 5190e65e
2025-06-04 19:08:14,716 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-07-27/train_hpo_5190e65e_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-04_19-07-27
2025-06-04 19:08:14,716 - INFO - Current best: 76f0794b with eval_f1 : 0.8448275862068966 at iteration 1
2025-06-04 19:08:14,724	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-07-27' in 0.0068s.
2025-06-04 19:08:14,731 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x719ac416ea50>
2025-06-04 19:08:14,732 - INFO - Best trial : train_hpo_13cbb0ac
2025-06-04 19:08:14,732 - INFO - Best config : {'pos_weight': 7.549531688595925, 'learning_rate': 4.555391530860597e-06, 'weight_decay': 0.12303118765599412, 'num_train_epochs': 5}
2025-06-04 19:08:14,732 - INFO - Best trial after optimization: {'eval_loss': 3.1829304695129395, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.5795644521713257, 'eval_AP': 0.770042496321593, 'eval_MCC': 0.0, 'eval_NDCG': 0.9199282895162827, 'eval_kappa': 0.0, 'eval_runtime': 3.4149, 'eval_samples_per_second': 19.62, 'eval_steps_per_second': 1.171, 'epoch': 3.4, 'timestamp': 1749056894, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '13cbb0ac', 'date': '2025-06-04_19-08-14', 'time_this_iter_s': 33.289899826049805, 'time_total_s': 33.289899826049805, 'pid': 3417579, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 7.549531688595925, 'learning_rate': 4.555391530860597e-06, 'weight_decay': 0.12303118765599412, 'num_train_epochs': 5}, 'time_since_restore': 33.289899826049805, 'iterations_since_restore': 1, 'experiment_tag': '2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230'}
2025-06-04 19:08:14,752 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   6.236849  0.000000  ...                        6  5190e65e
1   3.182930  0.844828  ...                        5  13cbb0ac
2   1.174453  0.844828  ...                        3  76f0794b

[3 rows x 32 columns]
2025-06-04 19:08:14,920 - INFO - Trial comparison plot saved
2025-06-04 19:08:14,920 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-04 19:08:15,490 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-04 19:08:15,583 - INFO - training size : 198
2025-06-04 19:08:15,584 - INFO - dev size : 67
2025-06-04 19:08:15,584 - INFO - test size : 132
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(

[36m(train_hpo pid=3417579)[0m {'loss': 3.1848, 'grad_norm': 41.478153228759766, 'learning_rate': 0.0, 'epoch': 3.4}[32m [repeated 2x across cluster][0m

Trial train_hpo_13cbb0ac finished iteration 1 at 2025-06-04 19:08:14. Total running time: 46s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_13cbb0ac result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    33.2899 â”‚
â”‚ time_total_s                        33.2899 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   3.4 â”‚
â”‚ eval_AP                             0.77004 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.91993 â”‚
â”‚ eval_accuracy                       0.73134 â”‚
â”‚ eval_f1                             0.84483 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           3.18293 â”‚
â”‚ eval_optim_threshold                0.57956 â”‚
â”‚ eval_precision                      0.73134 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.4149 â”‚
â”‚ eval_samples_per_second               19.62 â”‚
â”‚ eval_steps_per_second                 1.171 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_13cbb0ac completed after 1 iterations at 2025-06-04 19:08:14. Total running time: 46s

Trial status: 3 TERMINATED
Current time: 2025-06-04 19:08:14. Total running time: 46s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_5190e65e   TERMINATED        8.49369       1.49561e-06         0.13641                     6        1            35.4765       6.23685    0                      0          0.268657 â”‚
â”‚ train_hpo_13cbb0ac   TERMINATED        7.54953       4.55539e-06         0.123031                    5        1            33.2899       3.18293    0.844828               1          0.731343 â”‚
â”‚ train_hpo_76f0794b   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            16.363        1.17445    0.844828               1          0.731343 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

  0%|          | 0/45 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  2%|â–         | 1/45 [00:00<00:28,  1.54it/s]  4%|â–         | 2/45 [00:01<00:27,  1.59it/s]  7%|â–‹         | 3/45 [00:01<00:26,  1.60it/s]  9%|â–‰         | 4/45 [00:02<00:25,  1.61it/s] 11%|â–ˆ         | 5/45 [00:03<00:24,  1.61it/s] 13%|â–ˆâ–Ž        | 6/45 [00:03<00:24,  1.61it/s] 16%|â–ˆâ–Œ        | 7/45 [00:04<00:23,  1.62it/s] 18%|â–ˆâ–Š        | 8/45 [00:04<00:22,  1.63it/s] 20%|â–ˆâ–ˆ        | 9/45 [00:05<00:18,  1.91it/s]                                               20%|â–ˆâ–ˆ        | 9/45 [00:05<00:18,  1.91it/s] 22%|â–ˆâ–ˆâ–       | 10/45 [00:05<00:19,  1.78it/s] 24%|â–ˆâ–ˆâ–       | 11/45 [00:06<00:19,  1.73it/s] 27%|â–ˆâ–ˆâ–‹       | 12/45 [00:07<00:19,  1.69it/s] 29%|â–ˆâ–ˆâ–‰       | 13/45 [00:07<00:19,  1.67it/s] 31%|â–ˆâ–ˆâ–ˆ       | 14/45 [00:08<00:18,  1.65it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 15/45 [00:09<00:18,  1.64it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 16/45 [00:09<00:17,  1.64it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 17/45 [00:10<00:17,  1.64it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 18/45 [00:10<00:14,  1.91it/s]                                                40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 18/45 [00:10<00:14,  1.91it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 19/45 [00:11<00:14,  1.79it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 20/45 [00:11<00:14,  1.73it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 21/45 [00:12<00:14,  1.70it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 22/45 [00:13<00:13,  1.67it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 23/45 [00:13<00:13,  1.65it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 24/45 [00:14<00:12,  1.64it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 25/45 [00:14<00:12,  1.63it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 26/45 [00:15<00:11,  1.64it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 27/45 [00:15<00:09,  1.91it/s]                                                60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 27/45 [00:15<00:09,  1.91it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 28/45 [00:16<00:09,  1.79it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 29/45 [00:17<00:09,  1.73it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 30/45 [00:17<00:08,  1.70it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 31/45 [00:18<00:08,  1.67it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 32/45 [00:18<00:07,  1.65it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 33/45 [00:19<00:07,  1.64it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 34/45 [00:20<00:06,  1.63it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 35/45 [00:20<00:06,  1.64it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 36/45 [00:21<00:04,  1.91it/s]                                                80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 36/45 [00:21<00:04,  1.91it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 37/45 [00:21<00:04,  1.79it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 38/45 [00:22<00:04,  1.73it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 39/45 [00:23<00:03,  1.70it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 40/45 [00:23<00:02,  1.67it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 41/45 [00:24<00:02,  1.65it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 42/45 [00:24<00:01,  1.64it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 43/45 [00:25<00:01,  1.64it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 44/45 [00:26<00:00,  1.64it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45/45 [00:26<00:00,  1.91it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45/45 [00:28<00:00,  1.91it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45/45 [00:28<00:00,  1.91it/s]2025-06-04 19:08:44,117 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45/45 [00:28<00:00,  1.60it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
{'loss': 3.5459, 'grad_norm': 63.29026412963867, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0}
{'loss': 2.8289, 'grad_norm': 40.34697723388672, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0}
{'loss': 2.3052, 'grad_norm': 35.271785736083984, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0}
{'loss': 2.0366, 'grad_norm': 30.570659637451172, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0}
{'loss': 1.9023, 'grad_norm': 18.357139587402344, 'learning_rate': 0.0, 'epoch': 5.0}
{'train_runtime': 28.0779, 'train_samples_per_second': 35.259, 'train_steps_per_second': 1.603, 'train_loss': 2.523761494954427, 'epoch': 5.0}
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.25it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.42it/s]2025-06-04 19:08:47,718 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.10s/it]
2025-06-04 19:08:47,724 - INFO - Training time : 32.80409048311412
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.16it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.06it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.38it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.13it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.36it/s]2025-06-04 19:08:52,289 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.41it/s]
2025-06-04 19:08:52,294 - INFO - Evaluation time : 4.5696469058748335
2025-06-04 19:08:52,294 - INFO - Evaluation results on test set: {'eval_loss': 1.807850956916809, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.757912814617157, 'eval_AP': 0.9897948347790679, 'eval_MCC': 0.0, 'eval_NDCG': 0.9983307387169857, 'eval_kappa': 0.0, 'eval_runtime': 4.5652, 'eval_samples_per_second': 28.915, 'eval_steps_per_second': 1.314, 'epoch': 5.0}
2025-06-04 19:08:52,294 - INFO - Total updates (optimizer steps): 45
2025-06-04 19:08:52,294 - INFO - Avg time / step: 0.624s
2025-06-04 19:08:53,052 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCEdmis-lab/biobert-v1.13trials_fold-2
2025-06-04 19:08:53,052 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.12it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.04it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.37it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.12it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.35it/s]2025-06-04 19:08:57,511 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.45it/s]
2025-06-04 19:08:57,516 - INFO - preds : [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
2025-06-04 19:08:57,516 - INFO - test_split["labels"] : [1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1]
2025-06-04 19:08:57,518 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:09:00,678 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': 0.9897948347790679, 'MCC': 0.0, 'NDCG': 0.9983307387169857, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:09:00,798 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-04 19:09:00,912 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:09:00,912 - INFO - 
On test Set (optimal threshold of 0.745871365070343 according to cross validation on the training set): 
2025-06-04 19:09:00,914 - INFO - Confusion matrix: TN=28, FP=6, FN=5, TP=93
2025-06-04 19:09:03,791 - INFO - Metrics: {'f1': 0.9441624365482234, 'recall': 0.9489795918367347, 'precision': 0.9393939393939394, 'accuracy': 0.9166666666666666, 'AP': 0.9897948347790679, 'MCC': 0.7801560468156055, 'NDCG': 0.9983307387169857, 'kappa': 0.78, 'TN': 28, 'FP': 6, 'FN': 5, 'TP': 93}
2025-06-04 19:09:03,896 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:09:03,896 - INFO - Results for fold 2 : [{'f1': 0.9441624365482234, 'recall': 0.9489795918367347, 'precision': 0.9393939393939394, 'accuracy': 0.9166666666666666, 'AP': 0.9897948347790679, 'MCC': 0.7801560468156055, 'NDCG': 0.9983307387169857, 'kappa': 0.78, 'TN': 28, 'FP': 6, 'FN': 5, 'TP': 93}]
2025-06-04 19:09:04,005 - INFO - Cleared CUDA cache. Memory allocated: 1.40 GB, Memory reserved: 1.90 GB
2025-06-04 19:09:04,005 - INFO - 
fold number 3 / 3
2025-06-04 19:09:04,011 - INFO - train split size : 198
2025-06-04 19:09:04,011 - INFO - dev split size : 67
2025-06-04 19:09:04,011 - INFO - test split size : 132
Map (num_proc=32):   0%|          | 0/198 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–Ž         | 7/198 [00:00<00:04, 38.31 examples/s]Map (num_proc=32):  21%|â–ˆâ–ˆ        | 42/198 [00:00<00:00, 167.11 examples/s]Map (num_proc=32):  36%|â–ˆâ–ˆâ–ˆâ–‹      | 72/198 [00:00<00:00, 215.60 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 102/198 [00:00<00:00, 232.90 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 132/198 [00:00<00:00, 251.71 examples/s]Map (num_proc=32):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 162/198 [00:00<00:00, 261.69 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 192/198 [00:00<00:00, 269.06 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 198/198 [00:00<00:00, 206.43 examples/s]
Map (num_proc=32):   0%|          | 0/67 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/67 [00:00<00:03, 17.73 examples/s]Map (num_proc=32):  22%|â–ˆâ–ˆâ–       | 15/67 [00:00<00:00, 63.65 examples/s]Map (num_proc=32):  37%|â–ˆâ–ˆâ–ˆâ–‹      | 25/67 [00:00<00:00, 76.70 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 35/67 [00:00<00:00, 82.02 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 45/67 [00:00<00:00, 86.71 examples/s]Map (num_proc=32):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 55/67 [00:00<00:00, 84.02 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:00<00:00, 88.35 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:00<00:00, 68.91 examples/s]
Map (num_proc=32):   0%|          | 0/132 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/132 [00:00<00:04, 27.91 examples/s]Map (num_proc=32):  21%|â–ˆâ–ˆ        | 28/132 [00:00<00:00, 106.53 examples/s]Map (num_proc=32):  39%|â–ˆâ–ˆâ–ˆâ–‰      | 52/132 [00:00<00:00, 147.14 examples/s]Map (num_proc=32):  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 72/132 [00:00<00:00, 151.39 examples/s]Map (num_proc=32):  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 96/132 [00:00<00:00, 171.84 examples/s]Map (num_proc=32):  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 116/132 [00:00<00:00, 177.38 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 132/132 [00:00<00:00, 136.24 examples/s]
2025-06-04 19:09:13,265 - INFO - 3 datasets tokenized successfully
2025-06-04 19:09:13,266 - INFO - Starting hyperparameter search for BCE loss
[36m(train_hpo pid=3420219)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3420219)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3417579)[0m 2025-06-04 19:08:14,652 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3417579)[0m 2025-06-04 19:08:14,658 - INFO - eval_result: {'eval_loss': 3.1829304695129395, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.5795644521713257, 'eval_AP': 0.770042496321593, 'eval_MCC': 0.0, 'eval_NDCG': 0.9199282895162827, 'eval_kappa': 0.0, 'eval_runtime': 3.4149, 'eval_samples_per_second': 19.62, 'eval_steps_per_second': 1.171, 'epoch': 3.4}
[36m(train_hpo pid=3417579)[0m 2025-06-04 19:08:14,691 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3420219)[0m 2025-06-04 19:09:20,906 - INFO - pos_weight value in TrainingArguments : 8.493688290834637
[36m(train_hpo pid=3420219)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3420219)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3420219)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3420219)[0m   warnings.warn(
[36m(train_hpo pid=3420458)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3420458)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3420458)[0m 2025-06-04 19:09:27,602 - INFO - pos_weight value in TrainingArguments : 7.549531688595925
[36m(train_hpo pid=3420458)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3420458)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3420458)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3420458)[0m   warnings.warn(
[36m(train_hpo pid=3420699)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3420699)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3420699)[0m 2025-06-04 19:09:34,232 - INFO - pos_weight value in TrainingArguments : 8.949837496427758
[36m(train_hpo pid=3420699)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3420699)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3420699)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3420699)[0m   warnings.warn(
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-04_19-09-13   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-09-13
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-04_18-54-36_274448_3393636/artifacts/2025-06-04_19-09-13/train_hpo_2025-06-04_19-09-13/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-04 19:09:13. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_1f3f4a0e   PENDING         8.49369       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_1f3f4a0e started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_1f3f4a0e config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          8.49369 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3420219)[0m [2025-06-04 19:09:21,151] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3417579)[0m {'eval_loss': 3.1829304695129395, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.5795644521713257, 'eval_AP': 0.770042496321593, 'eval_MCC': 0.0, 'eval_NDCG': 0.9199282895162827, 'eval_kappa': 0.0, 'eval_runtime': 3.4149, 'eval_samples_per_second': 19.62, 'eval_steps_per_second': 1.171, 'epoch': 3.4}
[36m(train_hpo pid=3420219)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=12, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_a6114665 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_a6114665 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          7.54953 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3420458)[0m [2025-06-04 19:09:27,991] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3420219)[0m {'loss': 2.8214, 'grad_norm': 20.366518020629883, 'learning_rate': 1.1217049888818266e-06, 'epoch': 1.0}
[36m(train_hpo pid=3420458)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_b38952e3 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_b38952e3 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          8.94984 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3420219)[0m {'loss': 2.7685, 'grad_norm': 24.263599395751953, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.0}
[36m(train_hpo pid=3420699)[0m [2025-06-04 19:09:34,456] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3420699)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=6, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3420458)[0m {'loss': 2.5684, 'grad_norm': 17.42233657836914, 'learning_rate': 3.188774071602418e-06, 'epoch': 1.0}

Trial status: 3 RUNNING
Current time: 2025-06-04 19:09:43. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_1f3f4a0e   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_a6114665   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_b38952e3   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯2025-06-04 19:09:49,388 - INFO - Cleaning up trial b38952e3
2025-06-04 19:09:49,388 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-09-13/train_hpo_b38952e3_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512_2025-06-04_19-09-26
[36m(train_hpo pid=3420699)[0m 2025-06-04 19:09:49,322 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3420699)[0m 2025-06-04 19:09:49,328 - INFO - eval_result: {'eval_loss': 1.072526454925537, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.9481078386306763, 'eval_AP': 0.9720939740291792, 'eval_MCC': 0.0, 'eval_NDCG': 0.9947467136499923, 'eval_kappa': 0.0, 'eval_runtime': 3.5661, 'eval_samples_per_second': 18.788, 'eval_steps_per_second': 1.122, 'epoch': 2.0}
[36m(train_hpo pid=3420699)[0m 2025-06-04 19:09:49,362 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3420219)[0m 2025-06-04 19:09:56,261 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
2025-06-04 19:09:56,328 - INFO - Cleaning up trial 1f3f4a0e
2025-06-04 19:09:56,328 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-09-13/train_hpo_1f3f4a0e_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-04_19-09-13
2025-06-04 19:09:56,328 - INFO - Current best: b38952e3 with eval_f1 : 0.8547008547008547 at iteration 1
[36m(train_hpo pid=3420219)[0m 2025-06-04 19:09:56,267 - INFO - eval_result: {'eval_loss': 3.2304847240448, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.6257076263427734, 'eval_AP': 0.8909512084714097, 'eval_MCC': 0.0, 'eval_NDCG': 0.9767807623157908, 'eval_kappa': 0.0, 'eval_runtime': 4.7019, 'eval_samples_per_second': 14.249, 'eval_steps_per_second': 0.851, 'epoch': 4.0}
[36m(train_hpo pid=3420219)[0m 2025-06-04 19:09:56,303 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB

[36m(train_hpo pid=3420699)[0m {'train_runtime': 8.031, 'train_samples_per_second': 73.963, 'train_steps_per_second': 0.747, 'train_loss': 1.7963563601175945, 'epoch': 2.0}
[36m(train_hpo pid=3420699)[0m STATE at ending of training  :  TrainerState(epoch=2.0, global_step=6, max_steps=6, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=104191042424832.0, log_history=[{'loss': 2.597, 'grad_norm': 5.946587085723877, 'learning_rate': 3.994089731390617e-05, 'epoch': 1.0, 'step': 3}, {'loss': 0.9957, 'grad_norm': 2.681690216064453, 'learning_rate': 0.0, 'epoch': 2.0, 'step': 6}, {'train_runtime': 8.031, 'train_samples_per_second': 73.963, 'train_steps_per_second': 0.747, 'total_flos': 104191042424832.0, 'train_loss': 1.7963563601175945, 'epoch': 2.0, 'step': 6}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3420699)[0m {'loss': 0.9957, 'grad_norm': 2.681690216064453, 'learning_rate': 0.0, 'epoch': 2.0}[32m [repeated 3x across cluster][0m

Trial train_hpo_b38952e3 finished iteration 1 at 2025-06-04 19:09:49. Total running time: 36s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_b38952e3 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    16.0644 â”‚
â”‚ time_total_s                        16.0644 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     2 â”‚
â”‚ eval_AP                             0.97209 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.99475 â”‚
â”‚ eval_accuracy                       0.74627 â”‚
â”‚ eval_f1                              0.8547 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.07253 â”‚
â”‚ eval_optim_threshold                0.94811 â”‚
â”‚ eval_precision                      0.74627 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.5661 â”‚
â”‚ eval_samples_per_second              18.788 â”‚
â”‚ eval_steps_per_second                 1.122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_b38952e3 completed after 1 iterations at 2025-06-04 19:09:49. Total running time: 36s
[36m(train_hpo pid=3420699)[0m {'eval_loss': 1.072526454925537, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.9481078386306763, 'eval_AP': 0.9720939740291792, 'eval_MCC': 0.0, 'eval_NDCG': 0.9947467136499923, 'eval_kappa': 0.0, 'eval_runtime': 3.5661, 'eval_samples_per_second': 18.788, 'eval_steps_per_second': 1.122, 'epoch': 2.0}
[36m(train_hpo pid=3420219)[0m STATE at ending of training  :  TrainerState(epoch=4.0, global_step=12, max_steps=12, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=208382084849664.0, log_history=[{'loss': 2.8214, 'grad_norm': 20.366518020629883, 'learning_rate': 1.1217049888818266e-06, 'epoch': 1.0, 'step': 3}, {'loss': 2.7685, 'grad_norm': 24.263599395751953, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.0, 'step': 6}, {'loss': 2.7288, 'grad_norm': 27.18311309814453, 'learning_rate': 3.7390166296060887e-07, 'epoch': 3.0, 'step': 9}, {'loss': 2.6897, 'grad_norm': 19.5380802154541, 'learning_rate': 0.0, 'epoch': 4.0, 'step': 12}, {'train_runtime': 27.0957, 'train_samples_per_second': 43.845, 'train_steps_per_second': 0.443, 'total_flos': 208382084849664.0, 'train_loss': 2.7521024545033774, 'epoch': 4.0, 'step': 12}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3420219)[0m {'train_runtime': 27.0957, 'train_samples_per_second': 43.845, 'train_steps_per_second': 0.443, 'train_loss': 2.7521024545033774, 'epoch': 4.0}
[36m(train_hpo pid=3420219)[0m {'loss': 2.6897, 'grad_norm': 19.5380802154541, 'learning_rate': 0.0, 'epoch': 4.0}[32m [repeated 2x across cluster][0m

Trial train_hpo_1f3f4a0e finished iteration 1 at 2025-06-04 19:09:56. Total running time: 42s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_1f3f4a0e result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    36.3193 â”‚
â”‚ time_total_s                        36.3193 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     4 â”‚
â”‚ eval_AP                             0.89095 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.97678 â”‚
â”‚ eval_accuracy                       0.74627 â”‚
â”‚ eval_f1                              0.8547 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           3.23048 â”‚
â”‚ eval_optim_threshold                0.62571 â”‚
â”‚ eval_precision                      0.74627 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         4.7019 â”‚
â”‚ eval_samples_per_second              14.249 â”‚
â”‚ eval_steps_per_second                 0.851 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_1f3f4a0e completed after 1 iterations at 2025-06-04 19:09:56. Total running time: 42s
[36m(train_hpo pid=3420219)[0m {'eval_loss': 3.2304847240448, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.6257076263427734, 'eval_AP': 0.8909512084714097, 'eval_MCC': 0.0, 'eval_NDCG': 0.9767807623157908, 'eval_kappa': 0.0, 'eval_runtime': 4.7019, 'eval_samples_per_second': 14.249, 'eval_steps_per_second': 0.851, 'epoch': 4.0}
[36m(train_hpo pid=3420458)[0m {'train_runtime': 25.3628, 'train_samples_per_second': 39.034, 'train_steps_per_second': 0.394, 'train_loss': 2.4138075590133665, 'epoch': 3.4}
[36m(train_hpo pid=3420458)[0m STATE at ending of training  :  TrainerState(epoch=3.4, global_step=10, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=177335259076608.0, log_history=[{'loss': 2.5684, 'grad_norm': 17.42233657836914, 'learning_rate': 3.188774071602418e-06, 'epoch': 1.0, 'step': 3}, {'loss': 2.3508, 'grad_norm': 19.73484230041504, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.0, 'step': 6}, {'loss': 2.2237, 'grad_norm': 21.6508846282959, 'learning_rate': 4.555391530860598e-07, 'epoch': 3.0, 'step': 9}, {'loss': 2.7096, 'grad_norm': 33.64960479736328, 'learning_rate': 0.0, 'epoch': 3.4, 'step': 10}, {'train_runtime': 25.3628, 'train_samples_per_second': 39.034, 'train_steps_per_second': 0.394, 'total_flos': 177335259076608.0, 'train_loss': 2.4138075590133665, 'epoch': 3.4, 'step': 10}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})2025-06-04 19:10:00,035 - INFO - Cleaning up trial a6114665
2025-06-04 19:10:00,035 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-09-13/train_hpo_a6114665_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-04_19-09-20
2025-06-04 19:10:00,035 - INFO - Current best: 1f3f4a0e with eval_f1 : 0.8547008547008547 at iteration 1
2025-06-04 19:10:00,035 - INFO - Current best: b38952e3 with eval_f1 : 0.8547008547008547 at iteration 1
2025-06-04 19:10:00,044	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-09-13' in 0.0067s.
2025-06-04 19:10:00,050 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x719abc2a6f90>
2025-06-04 19:10:00,051 - INFO - Best trial : train_hpo_1f3f4a0e
2025-06-04 19:10:00,051 - INFO - Best config : {'pos_weight': 8.493688290834637, 'learning_rate': 1.4956066518424355e-06, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 6}
2025-06-04 19:10:00,051 - INFO - Best trial after optimization: {'eval_loss': 3.2304847240448, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.6257076263427734, 'eval_AP': 0.8909512084714097, 'eval_MCC': 0.0, 'eval_NDCG': 0.9767807623157908, 'eval_kappa': 0.0, 'eval_runtime': 4.7019, 'eval_samples_per_second': 14.249, 'eval_steps_per_second': 0.851, 'epoch': 4.0, 'timestamp': 1749056996, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '1f3f4a0e', 'date': '2025-06-04_19-09-56', 'time_this_iter_s': 36.31929397583008, 'time_total_s': 36.31929397583008, 'pid': 3420219, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 8.493688290834637, 'learning_rate': 1.4956066518424355e-06, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 6}, 'time_since_restore': 36.31929397583008, 'iterations_since_restore': 1, 'experiment_tag': '1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364'}
[36m(train_hpo pid=3420458)[0m 2025-06-04 19:09:59,967 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
2025-06-04 19:10:00,073 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   3.230485  0.854701  ...                        6  1f3f4a0e
1   2.612630  0.854701  ...                        5  a6114665
2   1.072526  0.854701  ...                        3  b38952e3

[3 rows x 32 columns]
2025-06-04 19:10:00,212 - INFO - Trial comparison plot saved
2025-06-04 19:10:00,212 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-04 19:10:00,770 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-04 19:10:00,856 - INFO - training size : 198
2025-06-04 19:10:00,857 - INFO - dev size : 67
2025-06-04 19:10:00,857 - INFO - test size : 132
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(

[36m(train_hpo pid=3420458)[0m {'loss': 2.7096, 'grad_norm': 33.64960479736328, 'learning_rate': 0.0, 'epoch': 3.4}[32m [repeated 2x across cluster][0m

Trial train_hpo_a6114665 finished iteration 1 at 2025-06-04 19:10:00. Total running time: 46s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_a6114665 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    33.2934 â”‚
â”‚ time_total_s                        33.2934 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   3.4 â”‚
â”‚ eval_AP                             0.95174 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.99052 â”‚
â”‚ eval_accuracy                       0.74627 â”‚
â”‚ eval_f1                              0.8547 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           2.61263 â”‚
â”‚ eval_optim_threshold                0.65138 â”‚
â”‚ eval_precision                      0.74627 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                          3.391 â”‚
â”‚ eval_samples_per_second              19.758 â”‚
â”‚ eval_steps_per_second                  1.18 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_a6114665 completed after 1 iterations at 2025-06-04 19:10:00. Total running time: 46s

Trial status: 3 TERMINATED
Current time: 2025-06-04 19:10:00. Total running time: 46s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_1f3f4a0e   TERMINATED        8.49369       1.49561e-06         0.13641                     6        1            36.3193       3.23048    0.854701               1          0.746269 â”‚
â”‚ train_hpo_a6114665   TERMINATED        7.54953       4.55539e-06         0.123031                    5        1            33.2934       2.61263    0.854701               1          0.746269 â”‚
â”‚ train_hpo_b38952e3   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            16.0644       1.07253    0.854701               1          0.746269 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

  0%|          | 0/54 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  2%|â–         | 1/54 [00:00<00:34,  1.54it/s]  4%|â–Ž         | 2/54 [00:01<00:32,  1.58it/s]  6%|â–Œ         | 3/54 [00:01<00:31,  1.60it/s]  7%|â–‹         | 4/54 [00:02<00:31,  1.60it/s]  9%|â–‰         | 5/54 [00:03<00:30,  1.60it/s] 11%|â–ˆ         | 6/54 [00:03<00:29,  1.61it/s] 13%|â–ˆâ–Ž        | 7/54 [00:04<00:29,  1.61it/s] 15%|â–ˆâ–        | 8/54 [00:04<00:28,  1.63it/s] 17%|â–ˆâ–‹        | 9/54 [00:05<00:23,  1.91it/s]                                               17%|â–ˆâ–‹        | 9/54 [00:05<00:23,  1.91it/s] 19%|â–ˆâ–Š        | 10/54 [00:05<00:24,  1.79it/s] 20%|â–ˆâ–ˆ        | 11/54 [00:06<00:24,  1.73it/s] 22%|â–ˆâ–ˆâ–       | 12/54 [00:07<00:24,  1.69it/s] 24%|â–ˆâ–ˆâ–       | 13/54 [00:07<00:24,  1.67it/s] 26%|â–ˆâ–ˆâ–Œ       | 14/54 [00:08<00:24,  1.65it/s] 28%|â–ˆâ–ˆâ–Š       | 15/54 [00:09<00:23,  1.64it/s] 30%|â–ˆâ–ˆâ–‰       | 16/54 [00:09<00:23,  1.63it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 17/54 [00:10<00:22,  1.64it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 18/54 [00:10<00:18,  1.91it/s]                                                33%|â–ˆâ–ˆâ–ˆâ–Ž      | 18/54 [00:10<00:18,  1.91it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 19/54 [00:11<00:19,  1.79it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 20/54 [00:11<00:19,  1.74it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 21/54 [00:12<00:19,  1.70it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 22/54 [00:13<00:19,  1.67it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 23/54 [00:13<00:18,  1.66it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 24/54 [00:14<00:18,  1.65it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 25/54 [00:14<00:17,  1.64it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 26/54 [00:15<00:17,  1.64it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 27/54 [00:15<00:14,  1.92it/s]                                                50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 27/54 [00:15<00:14,  1.92it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 28/54 [00:16<00:14,  1.77it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 29/54 [00:17<00:14,  1.72it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 30/54 [00:17<00:14,  1.69it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 31/54 [00:18<00:13,  1.67it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 32/54 [00:18<00:13,  1.65it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 33/54 [00:19<00:12,  1.64it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 34/54 [00:20<00:12,  1.63it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 35/54 [00:20<00:11,  1.64it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 36/54 [00:21<00:09,  1.91it/s]                                                67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 36/54 [00:21<00:09,  1.91it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 37/54 [00:21<00:09,  1.79it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 38/54 [00:22<00:09,  1.73it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 39/54 [00:23<00:08,  1.70it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 40/54 [00:23<00:08,  1.67it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 41/54 [00:24<00:07,  1.66it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 42/54 [00:24<00:07,  1.64it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 43/54 [00:25<00:06,  1.64it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 44/54 [00:26<00:06,  1.64it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 45/54 [00:26<00:04,  1.91it/s]                                                83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 45/54 [00:26<00:04,  1.91it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 46/54 [00:27<00:04,  1.79it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 47/54 [00:27<00:04,  1.73it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 48/54 [00:28<00:03,  1.70it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 49/54 [00:28<00:02,  1.67it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 50/54 [00:29<00:02,  1.65it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 51/54 [00:30<00:01,  1.64it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 52/54 [00:30<00:01,  1.64it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 53/54 [00:31<00:00,  1.64it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 54/54 [00:31<00:00,  1.91it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 54/54 [00:34<00:00,  1.91it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 54/54 [00:34<00:00,  1.91it/s]2025-06-04 19:10:35,519 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 54/54 [00:34<00:00,  1.58it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
{'loss': 6.866, 'grad_norm': 110.4852066040039, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}
{'loss': 6.329, 'grad_norm': 103.53665161132812, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0}
{'loss': 5.6889, 'grad_norm': 88.13792419433594, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0}
{'loss': 4.7448, 'grad_norm': 117.7813720703125, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0}
{'loss': 3.8768, 'grad_norm': 71.1795654296875, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0}
{'loss': 3.2286, 'grad_norm': 42.93790054321289, 'learning_rate': 0.0, 'epoch': 6.0}
{'train_runtime': 34.2128, 'train_samples_per_second': 34.724, 'train_steps_per_second': 1.578, 'train_loss': 5.122342922069408, 'epoch': 6.0}
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.29it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.44it/s]2025-06-04 19:10:39,169 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.12s/it]
2025-06-04 19:10:39,175 - INFO - Training time : 38.96292575681582
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.16it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.03it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.36it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.11it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.34it/s]2025-06-04 19:10:43,669 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.43it/s]
2025-06-04 19:10:43,675 - INFO - Evaluation time : 4.499588664155453
2025-06-04 19:10:43,675 - INFO - Evaluation results on test set: {'eval_loss': 3.0728695392608643, 'eval_f1': 0.9368421052631579, 'eval_recall': 0.9175257731958762, 'eval_accuracy': 0.9090909090909091, 'eval_precision': 0.956989247311828, 'eval_optim_threshold': 0.5360986590385437, 'eval_AP': 0.9876106287585732, 'eval_MCC': 0.7771260565801593, 'eval_NDCG': 0.9978809061875189, 'eval_kappa': 0.7749360613810742, 'eval_runtime': 4.4946, 'eval_samples_per_second': 29.368, 'eval_steps_per_second': 1.335, 'epoch': 6.0}
2025-06-04 19:10:43,675 - INFO - Total updates (optimizer steps): 54
2025-06-04 19:10:43,675 - INFO - Avg time / step: 0.634s
2025-06-04 19:10:44,392 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCEdmis-lab/biobert-v1.13trials_fold-3
2025-06-04 19:10:44,392 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.20it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.08it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.39it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.13it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.36it/s]2025-06-04 19:10:48,758 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.48it/s]
2025-06-04 19:10:48,762 - INFO - preds : [1 1 1 1 1 0 1 1 1 0 1 1 0 0 0 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 0 0 0 0 1 0 1
 1 0 1 1 1 1 0 1 1 0 1 1 1 0 1 0 1 0 1 1 1 1 0 1 1 1 1 1 0 1 0 1 1 1 1 0 1
 1 1 1 1 1 1 0 1 1 0 1 1 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 0 0 0 1 0 1 1 1 1 0
 0 1 1 1 0 1 1 1 0 0 1 0 0 0 0 1 1 0 1 1 1]
2025-06-04 19:10:48,763 - INFO - test_split["labels"] : [1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1]
2025-06-04 19:10:48,764 - INFO - Confusion matrix: TN=31, FP=4, FN=8, TP=89
2025-06-04 19:10:51,542 - INFO - Metrics: {'f1': 0.9368421052631579, 'recall': 0.9175257731958762, 'precision': 0.956989247311828, 'accuracy': 0.9090909090909091, 'AP': 0.9876106287585732, 'MCC': 0.7771260565801593, 'NDCG': 0.9978809061875189, 'kappa': 0.7749360613810742, 'TN': 31, 'FP': 4, 'FN': 8, 'TP': 89}
2025-06-04 19:10:51,662 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-04 19:10:51,763 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:10:51,763 - INFO - 
On test Set (optimal threshold of 0.511191725730896 according to cross validation on the training set): 
2025-06-04 19:10:51,767 - INFO - Confusion matrix: TN=32, FP=3, FN=12, TP=85
2025-06-04 19:10:54,504 - INFO - Metrics: {'f1': 0.918918918918919, 'recall': 0.8762886597938144, 'precision': 0.9659090909090909, 'accuracy': 0.8863636363636364, 'AP': 0.9876106287585732, 'MCC': 0.7402781788168556, 'NDCG': 0.9978809061875189, 'kappa': 0.7305389221556886, 'TN': 32, 'FP': 3, 'FN': 12, 'TP': 85}
2025-06-04 19:10:54,612 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:10:54,613 - INFO - Results for fold 3 : [{'f1': 0.918918918918919, 'recall': 0.8762886597938144, 'precision': 0.9659090909090909, 'accuracy': 0.8863636363636364, 'AP': 0.9876106287585732, 'MCC': 0.7402781788168556, 'NDCG': 0.9978809061875189, 'kappa': 0.7305389221556886, 'TN': 32, 'FP': 3, 'FN': 12, 'TP': 85}]
2025-06-04 19:10:54,728 - INFO - Cleared CUDA cache. Memory allocated: 1.40 GB, Memory reserved: 1.84 GB
2025-06-04 19:10:54,728 - INFO - Cleared CUDA cache. Memory allocated: 1.40 GB, Memory reserved: 1.84 GB
2025-06-04 19:10:54,773 - INFO - Cleared CUDA cache. Memory allocated: 0.02 GB, Memory reserved: 0.03 GB
2025-06-04 19:10:54,787 - INFO - Metrics for dmis-lab/biobert-v1.1:               model_name fold loss_type run  ...    TN    FP    FN    TP
0  dmis-lab/biobert-v1.1    1       BCE   1  ...   0.0  35.0   0.0  98.0
1  dmis-lab/biobert-v1.1    2       BCE   1  ...   0.0  34.0   0.0  98.0
2  dmis-lab/biobert-v1.1    3       BCE   1  ...   5.0  30.0   0.0  97.0
0  dmis-lab/biobert-v1.1    1       BCE   2  ...  34.0   1.0  13.0  85.0
0  dmis-lab/biobert-v1.1    2       BCE   2  ...   0.0  34.0   0.0  98.0
0  dmis-lab/biobert-v1.1    3       BCE   2  ...  31.0   4.0   8.0  89.0

[6 rows x 18 columns]
2025-06-04 19:10:54,787 - INFO - Training model 2/2: google-bert/bert-base-uncased
2025-06-04 19:10:54,958 - INFO - 
fold number 1 / 3
2025-06-04 19:10:54,964 - INFO - train split size : 198
2025-06-04 19:10:54,964 - INFO - dev split size : 66
2025-06-04 19:10:54,964 - INFO - test split size : 133
Map (num_proc=32):   0%|          | 0/198 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–Ž         | 7/198 [00:00<00:05, 35.56 examples/s]Map (num_proc=32):  21%|â–ˆâ–ˆ        | 42/198 [00:00<00:00, 159.47 examples/s]Map (num_proc=32):  39%|â–ˆâ–ˆâ–ˆâ–‰      | 78/198 [00:00<00:00, 220.04 examples/s]Map (num_proc=32):  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 108/198 [00:00<00:00, 239.02 examples/s]Map (num_proc=32):  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 144/198 [00:00<00:00, 258.52 examples/s]Map (num_proc=32):  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 174/198 [00:00<00:00, 258.20 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 198/198 [00:00<00:00, 202.67 examples/s]
Map (num_proc=32):   0%|          | 0/66 [00:00<?, ? examples/s]Map (num_proc=32):   5%|â–         | 3/66 [00:00<00:03, 16.20 examples/s]Map (num_proc=32):  18%|â–ˆâ–Š        | 12/66 [00:00<00:01, 46.78 examples/s]Map (num_proc=32):  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 22/66 [00:00<00:00, 62.78 examples/s]Map (num_proc=32):  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 32/66 [00:00<00:00, 73.53 examples/s]Map (num_proc=32):  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 42/66 [00:00<00:00, 78.34 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 52/66 [00:00<00:00, 83.32 examples/s]Map (num_proc=32):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 62/66 [00:00<00:00, 86.65 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 66/66 [00:01<00:00, 65.00 examples/s]
Map (num_proc=32):   0%|          | 0/133 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/133 [00:00<00:04, 27.01 examples/s]Map (num_proc=32):  19%|â–ˆâ–‰        | 25/133 [00:00<00:01, 99.49 examples/s]Map (num_proc=32):  37%|â–ˆâ–ˆâ–ˆâ–‹      | 49/133 [00:00<00:00, 149.14 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 69/133 [00:00<00:00, 161.15 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 89/133 [00:00<00:00, 171.18 examples/s]Map (num_proc=32):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 109/133 [00:00<00:00, 175.77 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 129/133 [00:00<00:00, 177.88 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 133/133 [00:00<00:00, 136.59 examples/s]
2025-06-04 19:11:03,687 - INFO - 3 datasets tokenized successfully
2025-06-04 19:11:03,689 - INFO - Starting hyperparameter search for BCE loss
[36m(train_hpo pid=3423107)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3423107)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3420458)[0m 2025-06-04 19:09:59,973 - INFO - eval_result: {'eval_loss': 2.6126301288604736, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.6513767242431641, 'eval_AP': 0.9517449199987316, 'eval_MCC': 0.0, 'eval_NDCG': 0.9905219428676305, 'eval_kappa': 0.0, 'eval_runtime': 3.391, 'eval_samples_per_second': 19.758, 'eval_steps_per_second': 1.18, 'epoch': 3.4}
[36m(train_hpo pid=3420458)[0m 2025-06-04 19:10:00,009 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3423107)[0m 2025-06-04 19:11:11,015 - INFO - pos_weight value in TrainingArguments : 8.493688290834637
[36m(train_hpo pid=3423107)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3423107)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3423107)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3423107)[0m   warnings.warn(
[36m(train_hpo pid=3423268)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3423268)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3423268)[0m 2025-06-04 19:11:17,894 - INFO - pos_weight value in TrainingArguments : 7.549531688595925
[36m(train_hpo pid=3423268)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3423268)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3423268)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3423268)[0m   warnings.warn(
[36m(train_hpo pid=3423548)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3423548)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3423548)[0m 2025-06-04 19:11:24,564 - INFO - pos_weight value in TrainingArguments : 8.949837496427758
[36m(train_hpo pid=3423548)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3423548)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3423548)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3423548)[0m   warnings.warn(
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-04_19-11-03   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-11-03
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-04_18-54-36_274448_3393636/artifacts/2025-06-04_19-11-03/train_hpo_2025-06-04_19-11-03/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-04 19:11:03. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_e239604c   PENDING         8.49369       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_e239604c started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_e239604c config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          8.49369 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3423107)[0m [2025-06-04 19:11:11,268] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3420458)[0m {'eval_loss': 2.6126301288604736, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.6513767242431641, 'eval_AP': 0.9517449199987316, 'eval_MCC': 0.0, 'eval_NDCG': 0.9905219428676305, 'eval_kappa': 0.0, 'eval_runtime': 3.391, 'eval_samples_per_second': 19.758, 'eval_steps_per_second': 1.18, 'epoch': 3.4}
[36m(train_hpo pid=3423107)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=12, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_e9381a04 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_e9381a04 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          7.54953 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3423268)[0m [2025-06-04 19:11:18,256] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3423107)[0m {'loss': 3.8589, 'grad_norm': 43.34275436401367, 'learning_rate': 1.1217049888818266e-06, 'epoch': 1.0}
[36m(train_hpo pid=3423268)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3423107)[0m {'loss': 3.8613, 'grad_norm': 46.96780776977539, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.0}

Trial train_hpo_fc7aaf05 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_fc7aaf05 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          8.94984 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3423548)[0m [2025-06-04 19:11:24,798] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3423548)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=6, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3423268)[0m {'loss': 3.3304, 'grad_norm': 36.64870834350586, 'learning_rate': 3.188774071602418e-06, 'epoch': 1.0}

Trial status: 3 RUNNING
Current time: 2025-06-04 19:11:33. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_e239604c   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_e9381a04   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_fc7aaf05   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯2025-06-04 19:11:39,482 - INFO - Cleaning up trial fc7aaf05
2025-06-04 19:11:39,482 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-11-03/train_hpo_fc7aaf05_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512_2025-06-04_19-11-17
[36m(train_hpo pid=3423548)[0m 2025-06-04 19:11:39,418 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3423548)[0m 2025-06-04 19:11:39,424 - INFO - eval_result: {'eval_loss': 1.3883728981018066, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.8878396153450012, 'eval_AP': 0.7049561277997695, 'eval_MCC': 0.0, 'eval_NDCG': 0.8715296383699476, 'eval_kappa': 0.0, 'eval_runtime': 3.3614, 'eval_samples_per_second': 19.635, 'eval_steps_per_second': 1.19, 'epoch': 2.0}
[36m(train_hpo pid=3423548)[0m 2025-06-04 19:11:39,458 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
2025-06-04 19:11:45,417 - WARNING - NaN or Inf found in input tensor.
2025-06-04 19:11:45,419 - INFO - Cleaning up trial e239604c
2025-06-04 19:11:45,419 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-11-03/train_hpo_e239604c_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-04_19-11-03
2025-06-04 19:11:45,419 - INFO - Current best: fc7aaf05 with eval_f1 : 0.8521739130434782 at iteration 1
[36m(train_hpo pid=3423107)[0m 2025-06-04 19:11:45,360 - INFO - eval_result: {'eval_loss': 4.558897018432617, 'eval_f1': 0.4691358024691358, 'eval_recall': 0.3877551020408163, 'eval_accuracy': 0.3484848484848485, 'eval_precision': 0.59375, 'eval_optim_threshold': inf, 'eval_AP': 0.6036861441140098, 'eval_MCC': -0.32983193277310924, 'eval_NDCG': 0.7827629859135689, 'eval_kappa': -0.2841628959276019, 'eval_runtime': 3.8864, 'eval_samples_per_second': 16.982, 'eval_steps_per_second': 1.029, 'epoch': 4.0}
[36m(train_hpo pid=3423107)[0m 2025-06-04 19:11:45,355 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3423107)[0m 2025-06-04 19:11:45,395 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB

[36m(train_hpo pid=3423548)[0m {'train_runtime': 8.0247, 'train_samples_per_second': 74.022, 'train_steps_per_second': 0.748, 'train_loss': 1.709458549817403, 'epoch': 2.0}
[36m(train_hpo pid=3423548)[0m STATE at ending of training  :  TrainerState(epoch=2.0, global_step=6, max_steps=6, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=104191042424832.0, log_history=[{'loss': 2.1337, 'grad_norm': 17.038166046142578, 'learning_rate': 3.994089731390617e-05, 'epoch': 1.0, 'step': 3}, {'loss': 1.2852, 'grad_norm': 10.271039009094238, 'learning_rate': 0.0, 'epoch': 2.0, 'step': 6}, {'train_runtime': 8.0247, 'train_samples_per_second': 74.022, 'train_steps_per_second': 0.748, 'total_flos': 104191042424832.0, 'train_loss': 1.709458549817403, 'epoch': 2.0, 'step': 6}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3423548)[0m {'loss': 1.2852, 'grad_norm': 10.271039009094238, 'learning_rate': 0.0, 'epoch': 2.0}[32m [repeated 3x across cluster][0m

Trial train_hpo_fc7aaf05 finished iteration 1 at 2025-06-04 19:11:39. Total running time: 35s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_fc7aaf05 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    15.3313 â”‚
â”‚ time_total_s                        15.3313 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     2 â”‚
â”‚ eval_AP                             0.70496 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.87153 â”‚
â”‚ eval_accuracy                       0.74242 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.38837 â”‚
â”‚ eval_optim_threshold                0.88784 â”‚
â”‚ eval_precision                      0.74242 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.3614 â”‚
â”‚ eval_samples_per_second              19.635 â”‚
â”‚ eval_steps_per_second                  1.19 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_fc7aaf05 completed after 1 iterations at 2025-06-04 19:11:39. Total running time: 35s
[36m(train_hpo pid=3423548)[0m {'eval_loss': 1.3883728981018066, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.8878396153450012, 'eval_AP': 0.7049561277997695, 'eval_MCC': 0.0, 'eval_NDCG': 0.8715296383699476, 'eval_kappa': 0.0, 'eval_runtime': 3.3614, 'eval_samples_per_second': 19.635, 'eval_steps_per_second': 1.19, 'epoch': 2.0}
[36m(train_hpo pid=3423107)[0m STATE at ending of training  :  TrainerState(epoch=4.0, global_step=12, max_steps=12, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=208382084849664.0, log_history=[{'loss': 3.8589, 'grad_norm': 43.34275436401367, 'learning_rate': 1.1217049888818266e-06, 'epoch': 1.0, 'step': 3}, {'loss': 3.8613, 'grad_norm': 46.96780776977539, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.0, 'step': 6}, {'loss': 3.8041, 'grad_norm': 38.490535736083984, 'learning_rate': 3.7390166296060887e-07, 'epoch': 3.0, 'step': 9}, {'loss': 3.7759, 'grad_norm': 50.40623474121094, 'learning_rate': 0.0, 'epoch': 4.0, 'step': 12}, {'train_runtime': 26.8752, 'train_samples_per_second': 44.204, 'train_steps_per_second': 0.447, 'total_flos': 208382084849664.0, 'train_loss': 3.8250394662221274, 'epoch': 4.0, 'step': 12}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3423107)[0m {'train_runtime': 26.8752, 'train_samples_per_second': 44.204, 'train_steps_per_second': 0.447, 'train_loss': 3.8250394662221274, 'epoch': 4.0}
[36m(train_hpo pid=3423107)[0m {'loss': 3.7759, 'grad_norm': 50.40623474121094, 'learning_rate': 0.0, 'epoch': 4.0}[32m [repeated 2x across cluster][0m

Trial train_hpo_e239604c finished iteration 1 at 2025-06-04 19:11:45. Total running time: 41s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_e239604c result              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                          â”‚
â”‚ time_this_iter_s                     34.8349 â”‚
â”‚ time_total_s                         34.8349 â”‚
â”‚ training_iteration                         1 â”‚
â”‚ epoch                                      4 â”‚
â”‚ eval_AP                              0.60369 â”‚
â”‚ eval_MCC                            -0.32983 â”‚
â”‚ eval_NDCG                            0.78276 â”‚
â”‚ eval_accuracy                        0.34848 â”‚
â”‚ eval_f1                              0.46914 â”‚
â”‚ eval_kappa                          -0.28416 â”‚
â”‚ eval_loss                             4.5589 â”‚
â”‚ eval_optim_threshold                     inf â”‚
â”‚ eval_precision                       0.59375 â”‚
â”‚ eval_recall                          0.38776 â”‚
â”‚ eval_runtime                          3.8864 â”‚
â”‚ eval_samples_per_second               16.982 â”‚
â”‚ eval_steps_per_second                  1.029 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_e239604c completed after 1 iterations at 2025-06-04 19:11:45. Total running time: 41s
[36m(train_hpo pid=3423107)[0m {'eval_loss': 4.558897018432617, 'eval_f1': 0.4691358024691358, 'eval_recall': 0.3877551020408163, 'eval_accuracy': 0.3484848484848485, 'eval_precision': 0.59375, 'eval_optim_threshold': inf, 'eval_AP': 0.6036861441140098, 'eval_MCC': -0.32983193277310924, 'eval_NDCG': 0.7827629859135689, 'eval_kappa': -0.2841628959276019, 'eval_runtime': 3.8864, 'eval_samples_per_second': 16.982, 'eval_steps_per_second': 1.029, 'epoch': 4.0}
[36m(train_hpo pid=3423268)[0m {'train_runtime': 25.1501, 'train_samples_per_second': 39.364, 'train_steps_per_second': 0.398, 'train_loss': 3.2501601934432984, 'epoch': 3.4}
[36m(train_hpo pid=3423268)[0m STATE at ending of training  :  TrainerState(epoch=3.4, global_step=10, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=177335259076608.0, log_history=[{'loss': 3.3304, 'grad_norm': 36.64870834350586, 'learning_rate': 3.188774071602418e-06, 'epoch': 1.0, 'step': 3}, {'loss': 3.2075, 'grad_norm': 40.79951095581055, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.0, 'step': 6}, {'loss': 3.1875, 'grad_norm': 33.0489501953125, 'learning_rate': 4.555391530860598e-07, 'epoch': 3.0, 'step': 9}, {'loss': 3.3256, 'grad_norm': 54.61236572265625, 'learning_rate': 0.0, 'epoch': 3.4, 'step': 10}, {'train_runtime': 25.1501, 'train_samples_per_second': 39.364, 'train_steps_per_second': 0.398, 'total_flos': 177335259076608.0, 'train_loss': 3.2501601934432984, 'epoch': 3.4, 'step': 10}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})[36m(train_hpo pid=3423268)[0m 2025-06-04 19:11:50,025 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3423268)[0m 2025-06-04 19:11:50,030 - INFO - eval_result: {'eval_loss': 3.759655475616455, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.5277893543243408, 'eval_AP': 0.7478943287568005, 'eval_MCC': 0.0, 'eval_NDCG': 0.8746226860469072, 'eval_kappa': 0.0, 'eval_runtime': 3.3113, 'eval_samples_per_second': 19.932, 'eval_steps_per_second': 1.208, 'epoch': 3.4}
[36m(train_hpo pid=3423268)[0m 2025-06-04 19:11:50,063 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
2025-06-04 19:11:50,088 - INFO - Cleaning up trial e9381a04
2025-06-04 19:11:50,088 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-11-03/train_hpo_e9381a04_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-04_19-11-10
2025-06-04 19:11:50,088 - INFO - Cleaning up trial e239604c
2025-06-04 19:11:50,088 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-11-03/train_hpo_e239604c_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-04_19-11-03
2025-06-04 19:11:50,089 - INFO - Current best: fc7aaf05 with eval_f1 : 0.8521739130434782 at iteration 1
2025-06-04 19:11:50,097	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-11-03' in 0.0067s.
2025-06-04 19:11:50,104 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x71a3bc11a690>
2025-06-04 19:11:50,104 - INFO - Best trial : train_hpo_e9381a04
2025-06-04 19:11:50,104 - INFO - Best config : {'pos_weight': 7.549531688595925, 'learning_rate': 4.555391530860597e-06, 'weight_decay': 0.12303118765599412, 'num_train_epochs': 5}
2025-06-04 19:11:50,104 - INFO - Best trial after optimization: {'eval_loss': 3.759655475616455, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.5277893543243408, 'eval_AP': 0.7478943287568005, 'eval_MCC': 0.0, 'eval_NDCG': 0.8746226860469072, 'eval_kappa': 0.0, 'eval_runtime': 3.3113, 'eval_samples_per_second': 19.932, 'eval_steps_per_second': 1.208, 'epoch': 3.4, 'timestamp': 1749057110, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': 'e9381a04', 'date': '2025-06-04_19-11-50', 'time_this_iter_s': 32.61023426055908, 'time_total_s': 32.61023426055908, 'pid': 3423268, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 7.549531688595925, 'learning_rate': 4.555391530860597e-06, 'weight_decay': 0.12303118765599412, 'num_train_epochs': 5}, 'time_since_restore': 32.61023426055908, 'iterations_since_restore': 1, 'experiment_tag': '2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230'}
2025-06-04 19:11:50,126 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   4.558897  0.469136  ...                        6  e239604c
1   3.759655  0.852174  ...                        5  e9381a04
2   1.388373  0.852174  ...                        3  fc7aaf05

[3 rows x 32 columns]
2025-06-04 19:11:50,274 - INFO - Trial comparison plot saved
2025-06-04 19:11:50,274 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-04 19:11:50,488 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-04 19:11:50,602 - INFO - training size : 198
2025-06-04 19:11:50,602 - INFO - dev size : 66
2025-06-04 19:11:50,602 - INFO - test size : 133
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(

[36m(train_hpo pid=3423268)[0m {'loss': 3.3256, 'grad_norm': 54.61236572265625, 'learning_rate': 0.0, 'epoch': 3.4}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3423268)[0m {'eval_loss': 3.759655475616455, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.5277893543243408, 'eval_AP': 0.7478943287568005, 'eval_MCC': 0.0, 'eval_NDCG': 0.8746226860469072, 'eval_kappa': 0.0, 'eval_runtime': 3.3113, 'eval_samples_per_second': 19.932, 'eval_steps_per_second': 1.208, 'epoch': 3.4}

Trial train_hpo_e9381a04 finished iteration 1 at 2025-06-04 19:11:50. Total running time: 46s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_e9381a04 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    32.6102 â”‚
â”‚ time_total_s                        32.6102 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   3.4 â”‚
â”‚ eval_AP                             0.74789 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.87462 â”‚
â”‚ eval_accuracy                       0.74242 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           3.75966 â”‚
â”‚ eval_optim_threshold                0.52779 â”‚
â”‚ eval_precision                      0.74242 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.3113 â”‚
â”‚ eval_samples_per_second              19.932 â”‚
â”‚ eval_steps_per_second                 1.208 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_e9381a04 completed after 1 iterations at 2025-06-04 19:11:50. Total running time: 46s

Trial status: 3 TERMINATED
Current time: 2025-06-04 19:11:50. Total running time: 46s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_e239604c   TERMINATED        8.49369       1.49561e-06         0.13641                     6        1            34.8349       4.5589     0.469136        0.387755          0.348485 â”‚
â”‚ train_hpo_e9381a04   TERMINATED        7.54953       4.55539e-06         0.123031                    5        1            32.6102       3.75966    0.852174        1                 0.742424 â”‚
â”‚ train_hpo_fc7aaf05   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            15.3313       1.38837    0.852174        1                 0.742424 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

  0%|          | 0/45 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  2%|â–         | 1/45 [00:00<00:28,  1.52it/s]  4%|â–         | 2/45 [00:01<00:27,  1.57it/s]  7%|â–‹         | 3/45 [00:01<00:26,  1.59it/s]  9%|â–‰         | 4/45 [00:02<00:25,  1.60it/s] 11%|â–ˆ         | 5/45 [00:03<00:24,  1.60it/s] 13%|â–ˆâ–Ž        | 6/45 [00:03<00:24,  1.60it/s] 16%|â–ˆâ–Œ        | 7/45 [00:04<00:23,  1.61it/s] 18%|â–ˆâ–Š        | 8/45 [00:04<00:22,  1.62it/s] 20%|â–ˆâ–ˆ        | 9/45 [00:05<00:18,  1.90it/s]                                               20%|â–ˆâ–ˆ        | 9/45 [00:05<00:18,  1.90it/s] 22%|â–ˆâ–ˆâ–       | 10/45 [00:05<00:19,  1.78it/s] 24%|â–ˆâ–ˆâ–       | 11/45 [00:06<00:19,  1.72it/s] 27%|â–ˆâ–ˆâ–‹       | 12/45 [00:07<00:19,  1.69it/s] 29%|â–ˆâ–ˆâ–‰       | 13/45 [00:07<00:19,  1.67it/s] 31%|â–ˆâ–ˆâ–ˆ       | 14/45 [00:08<00:18,  1.65it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 15/45 [00:09<00:18,  1.64it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 16/45 [00:09<00:17,  1.63it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 17/45 [00:10<00:17,  1.63it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 18/45 [00:10<00:14,  1.90it/s]                                                40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 18/45 [00:10<00:14,  1.90it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 19/45 [00:11<00:14,  1.78it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 20/45 [00:11<00:14,  1.73it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 21/45 [00:12<00:14,  1.69it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 22/45 [00:13<00:13,  1.66it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 23/45 [00:13<00:13,  1.65it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 24/45 [00:14<00:12,  1.64it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 25/45 [00:14<00:12,  1.63it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 26/45 [00:15<00:11,  1.64it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 27/45 [00:15<00:09,  1.90it/s]                                                60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 27/45 [00:15<00:09,  1.90it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 28/45 [00:16<00:09,  1.78it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 29/45 [00:17<00:09,  1.73it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 30/45 [00:17<00:08,  1.69it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 31/45 [00:18<00:08,  1.67it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 32/45 [00:19<00:07,  1.65it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 33/45 [00:19<00:07,  1.64it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 34/45 [00:20<00:06,  1.63it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 35/45 [00:20<00:06,  1.64it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 36/45 [00:21<00:04,  1.90it/s]                                                80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 36/45 [00:21<00:04,  1.90it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 37/45 [00:21<00:04,  1.78it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 38/45 [00:22<00:04,  1.72it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 39/45 [00:23<00:03,  1.69it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 40/45 [00:23<00:03,  1.66it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 41/45 [00:24<00:02,  1.65it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 42/45 [00:24<00:01,  1.64it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 43/45 [00:25<00:01,  1.63it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 44/45 [00:26<00:00,  1.64it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45/45 [00:26<00:00,  1.90it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45/45 [00:28<00:00,  1.90it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45/45 [00:28<00:00,  1.90it/s]2025-06-04 19:12:19,311 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45/45 [00:28<00:00,  1.59it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
{'loss': 4.6635, 'grad_norm': 88.178466796875, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0}
{'loss': 4.2935, 'grad_norm': 72.75723266601562, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0}
{'loss': 3.6749, 'grad_norm': 57.56135940551758, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0}
{'loss': 3.0656, 'grad_norm': 39.27204132080078, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0}
{'loss': 2.6587, 'grad_norm': 25.602123260498047, 'learning_rate': 0.0, 'epoch': 5.0}
{'train_runtime': 28.2736, 'train_samples_per_second': 35.015, 'train_steps_per_second': 1.592, 'train_loss': 3.6712305704752604, 'epoch': 5.0}
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.24it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.60it/s]2025-06-04 19:12:23,095 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.16s/it]
2025-06-04 19:12:23,101 - INFO - Training time : 32.82666578004137
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.15it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.03it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.35it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.09it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.23it/s]2025-06-04 19:12:27,690 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.40it/s]
2025-06-04 19:12:27,695 - INFO - Evaluation time : 4.593627396039665
2025-06-04 19:12:27,695 - INFO - Evaluation results on test set: {'eval_loss': 2.6856582164764404, 'eval_f1': 0.8484848484848485, 'eval_recall': 1.0, 'eval_accuracy': 0.7368421052631579, 'eval_precision': 0.7368421052631579, 'eval_optim_threshold': 0.6242954730987549, 'eval_AP': 0.9885113115326145, 'eval_MCC': 0.0, 'eval_NDCG': 0.998121712540453, 'eval_kappa': 0.0, 'eval_runtime': 4.5892, 'eval_samples_per_second': 28.981, 'eval_steps_per_second': 1.307, 'epoch': 5.0}
2025-06-04 19:12:27,695 - INFO - Total updates (optimizer steps): 45
2025-06-04 19:12:27,695 - INFO - Avg time / step: 0.628s
2025-06-04 19:12:28,375 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCEgoogle-bert/bert-base-uncased3trials_fold-1
2025-06-04 19:12:28,375 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.13it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.01it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.33it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.07it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.22it/s]2025-06-04 19:12:33,024 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.38it/s]
2025-06-04 19:12:33,029 - INFO - preds : [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
2025-06-04 19:12:33,030 - INFO - test_split["labels"] : [1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0]
2025-06-04 19:12:33,032 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:12:35,981 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': 0.9885113115326145, 'MCC': 0.0, 'NDCG': 0.998121712540453, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:12:36,126 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-04 19:12:36,223 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:12:36,223 - INFO - 
On test Set (optimal threshold of 0.6165241599082947 according to cross validation on the training set): 
2025-06-04 19:12:36,225 - INFO - Confusion matrix: TN=31, FP=4, FN=11, TP=87
2025-06-04 19:12:39,076 - INFO - Metrics: {'f1': 0.9206349206349206, 'recall': 0.8877551020408163, 'precision': 0.9560439560439561, 'accuracy': 0.8872180451127819, 'AP': 0.9885113115326145, 'MCC': 0.7327314770826093, 'NDCG': 0.998121712540453, 'kappa': 0.7267497603068073, 'TN': 31, 'FP': 4, 'FN': 11, 'TP': 87}
2025-06-04 19:12:39,180 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:12:39,180 - INFO - Results for fold 1 : [{'f1': 0.9206349206349206, 'recall': 0.8877551020408163, 'precision': 0.9560439560439561, 'accuracy': 0.8872180451127819, 'AP': 0.9885113115326145, 'MCC': 0.7327314770826093, 'NDCG': 0.998121712540453, 'kappa': 0.7267497603068073, 'TN': 31, 'FP': 4, 'FN': 11, 'TP': 87}]
2025-06-04 19:12:39,300 - INFO - Cleared CUDA cache. Memory allocated: 1.40 GB, Memory reserved: 1.77 GB
2025-06-04 19:12:39,300 - INFO - 
fold number 2 / 3
2025-06-04 19:12:39,306 - INFO - train split size : 198
2025-06-04 19:12:39,306 - INFO - dev split size : 67
2025-06-04 19:12:39,306 - INFO - test split size : 132
Map (num_proc=32):   0%|          | 0/198 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–Ž         | 7/198 [00:00<00:05, 36.86 examples/s]Map (num_proc=32):  21%|â–ˆâ–ˆ        | 42/198 [00:00<00:00, 163.05 examples/s]Map (num_proc=32):  39%|â–ˆâ–ˆâ–ˆâ–‰      | 78/198 [00:00<00:00, 220.11 examples/s]Map (num_proc=32):  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 108/198 [00:00<00:00, 244.66 examples/s]Map (num_proc=32):  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 138/198 [00:00<00:00, 257.75 examples/s]Map (num_proc=32):  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 168/198 [00:00<00:00, 270.59 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 198/198 [00:00<00:00, 206.64 examples/s]
Map (num_proc=32):   0%|          | 0/67 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/67 [00:00<00:03, 16.91 examples/s]Map (num_proc=32):  22%|â–ˆâ–ˆâ–       | 15/67 [00:00<00:00, 62.86 examples/s]Map (num_proc=32):  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 27/67 [00:00<00:00, 83.83 examples/s]Map (num_proc=32):  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 39/67 [00:00<00:00, 95.01 examples/s]Map (num_proc=32):  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 51/67 [00:00<00:00, 94.45 examples/s]Map (num_proc=32):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 63/67 [00:00<00:00, 100.70 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:00<00:00, 77.50 examples/s] 
Map (num_proc=32):   0%|          | 0/132 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/132 [00:00<00:04, 28.91 examples/s]Map (num_proc=32):  21%|â–ˆâ–ˆ        | 28/132 [00:00<00:00, 114.27 examples/s]Map (num_proc=32):  39%|â–ˆâ–ˆâ–ˆâ–‰      | 52/132 [00:00<00:00, 151.21 examples/s]Map (num_proc=32):  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 76/132 [00:00<00:00, 170.05 examples/s]Map (num_proc=32):  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 100/132 [00:00<00:00, 176.18 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 128/132 [00:00<00:00, 191.14 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 132/132 [00:00<00:00, 141.74 examples/s]
2025-06-04 19:12:48,317 - INFO - 3 datasets tokenized successfully
2025-06-04 19:12:48,322 - INFO - Starting hyperparameter search for BCE loss
[36m(train_hpo pid=3425857)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3425857)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3425857)[0m 2025-06-04 19:12:55,813 - INFO - pos_weight value in TrainingArguments : 8.493688290834637
[36m(train_hpo pid=3425857)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3425857)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3425857)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3425857)[0m   warnings.warn(
[36m(train_hpo pid=3426018)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3426018)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3426018)[0m 2025-06-04 19:13:02,660 - INFO - pos_weight value in TrainingArguments : 7.549531688595925
[36m(train_hpo pid=3426018)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3426018)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3426018)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3426018)[0m   warnings.warn(
[36m(train_hpo pid=3426298)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3426298)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3426298)[0m 2025-06-04 19:13:09,491 - INFO - pos_weight value in TrainingArguments : 8.949837496427758
[36m(train_hpo pid=3426298)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3426298)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3426298)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3426298)[0m   warnings.warn(
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-04_19-12-48   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-12-48
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-04_18-54-36_274448_3393636/artifacts/2025-06-04_19-12-48/train_hpo_2025-06-04_19-12-48/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-04 19:12:48. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_7dec72ff   PENDING         8.49369       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_7dec72ff started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_7dec72ff config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          8.49369 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3425857)[0m [2025-06-04 19:12:56,081] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3425857)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=12, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_bff5d423 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_bff5d423 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          7.54953 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3426018)[0m [2025-06-04 19:13:03,025] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3425857)[0m {'loss': 3.7566, 'grad_norm': 39.689537048339844, 'learning_rate': 1.1217049888818266e-06, 'epoch': 1.0}
[36m(train_hpo pid=3426018)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3425857)[0m {'loss': 3.7319, 'grad_norm': 40.78350067138672, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.0}

Trial train_hpo_1ecc846f started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_1ecc846f config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          8.94984 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3426298)[0m [2025-06-04 19:13:09,726] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3426298)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=6, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3426018)[0m {'loss': 2.9633, 'grad_norm': 30.270633697509766, 'learning_rate': 3.188774071602418e-06, 'epoch': 1.0}

Trial status: 3 RUNNING
Current time: 2025-06-04 19:13:18. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_7dec72ff   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_bff5d423   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_1ecc846f   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(train_hpo pid=3426298)[0m 2025-06-04 19:13:24,460 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3426298)[0m 2025-06-04 19:13:24,467 - INFO - eval_result: {'eval_loss': 1.319977045059204, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.8916694521903992, 'eval_AP': 0.8371463678876081, 'eval_MCC': 0.0, 'eval_NDCG': 0.947935687580298, 'eval_kappa': 0.0, 'eval_runtime': 3.38, 'eval_samples_per_second': 19.822, 'eval_steps_per_second': 1.183, 'epoch': 2.0}
[36m(train_hpo pid=3426298)[0m 2025-06-04 19:13:24,503 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
2025-06-04 19:13:24,527 - INFO - Cleaning up trial 1ecc846f
2025-06-04 19:13:24,527 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-12-48/train_hpo_1ecc846f_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512_2025-06-04_19-13-02
[36m(train_hpo pid=3425857)[0m 2025-06-04 19:13:30,087 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3425857)[0m 2025-06-04 19:13:30,093 - INFO - eval_result: {'eval_loss': 4.316805362701416, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.5136557817459106, 'eval_AP': 0.7579482594184326, 'eval_MCC': 0.0, 'eval_NDCG': 0.8686978031163629, 'eval_kappa': 0.0, 'eval_runtime': 3.8195, 'eval_samples_per_second': 17.542, 'eval_steps_per_second': 1.047, 'epoch': 4.0}
[36m(train_hpo pid=3425857)[0m 2025-06-04 19:13:30,129 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
2025-06-04 19:13:30,163 - INFO - Cleaning up trial 7dec72ff
2025-06-04 19:13:30,164 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-12-48/train_hpo_7dec72ff_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-04_19-12-48
2025-06-04 19:13:30,164 - INFO - Current best: 1ecc846f with eval_f1 : 0.8448275862068966 at iteration 1

[36m(train_hpo pid=3426298)[0m {'train_runtime': 8.0698, 'train_samples_per_second': 73.608, 'train_steps_per_second': 0.744, 'train_loss': 1.7215125163396199, 'epoch': 2.0}
[36m(train_hpo pid=3426298)[0m STATE at ending of training  :  TrainerState(epoch=2.0, global_step=6, max_steps=6, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=104191042424832.0, log_history=[{'loss': 2.1518, 'grad_norm': 22.555322647094727, 'learning_rate': 3.994089731390617e-05, 'epoch': 1.0, 'step': 3}, {'loss': 1.2913, 'grad_norm': 6.471519470214844, 'learning_rate': 0.0, 'epoch': 2.0, 'step': 6}, {'train_runtime': 8.0698, 'train_samples_per_second': 73.608, 'train_steps_per_second': 0.744, 'total_flos': 104191042424832.0, 'train_loss': 1.7215125163396199, 'epoch': 2.0, 'step': 6}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3426298)[0m {'loss': 1.2913, 'grad_norm': 6.471519470214844, 'learning_rate': 0.0, 'epoch': 2.0}[32m [repeated 3x across cluster][0m
[36m(train_hpo pid=3426298)[0m {'eval_loss': 1.319977045059204, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.8916694521903992, 'eval_AP': 0.8371463678876081, 'eval_MCC': 0.0, 'eval_NDCG': 0.947935687580298, 'eval_kappa': 0.0, 'eval_runtime': 3.38, 'eval_samples_per_second': 19.822, 'eval_steps_per_second': 1.183, 'epoch': 2.0}

Trial train_hpo_1ecc846f finished iteration 1 at 2025-06-04 19:13:24. Total running time: 36s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_1ecc846f result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    15.4707 â”‚
â”‚ time_total_s                        15.4707 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     2 â”‚
â”‚ eval_AP                             0.83715 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.94794 â”‚
â”‚ eval_accuracy                       0.73134 â”‚
â”‚ eval_f1                             0.84483 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.31998 â”‚
â”‚ eval_optim_threshold                0.89167 â”‚
â”‚ eval_precision                      0.73134 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                           3.38 â”‚
â”‚ eval_samples_per_second              19.822 â”‚
â”‚ eval_steps_per_second                 1.183 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_1ecc846f completed after 1 iterations at 2025-06-04 19:13:24. Total running time: 36s
[36m(train_hpo pid=3425857)[0m STATE at ending of training  :  TrainerState(epoch=4.0, global_step=12, max_steps=12, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=208382084849664.0, log_history=[{'loss': 3.7566, 'grad_norm': 39.689537048339844, 'learning_rate': 1.1217049888818266e-06, 'epoch': 1.0, 'step': 3}, {'loss': 3.7319, 'grad_norm': 40.78350067138672, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.0, 'step': 6}, {'loss': 3.6549, 'grad_norm': 38.001800537109375, 'learning_rate': 3.7390166296060887e-07, 'epoch': 3.0, 'step': 9}, {'loss': 3.6615, 'grad_norm': 44.33357620239258, 'learning_rate': 0.0, 'epoch': 4.0, 'step': 12}, {'train_runtime': 26.9044, 'train_samples_per_second': 44.156, 'train_steps_per_second': 0.446, 'total_flos': 208382084849664.0, 'train_loss': 3.701221227645874, 'epoch': 4.0, 'step': 12}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3425857)[0m {'train_runtime': 26.9044, 'train_samples_per_second': 44.156, 'train_steps_per_second': 0.446, 'train_loss': 3.701221227645874, 'epoch': 4.0}
[36m(train_hpo pid=3425857)[0m {'loss': 3.6615, 'grad_norm': 44.33357620239258, 'learning_rate': 0.0, 'epoch': 4.0}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3425857)[0m {'eval_loss': 4.316805362701416, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.5136557817459106, 'eval_AP': 0.7579482594184326, 'eval_MCC': 0.0, 'eval_NDCG': 0.8686978031163629, 'eval_kappa': 0.0, 'eval_runtime': 3.8195, 'eval_samples_per_second': 17.542, 'eval_steps_per_second': 1.047, 'epoch': 4.0}

Trial train_hpo_7dec72ff finished iteration 1 at 2025-06-04 19:13:30. Total running time: 41s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_7dec72ff result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    34.8057 â”‚
â”‚ time_total_s                        34.8057 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     4 â”‚
â”‚ eval_AP                             0.75795 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                            0.8687 â”‚
â”‚ eval_accuracy                       0.73134 â”‚
â”‚ eval_f1                             0.84483 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           4.31681 â”‚
â”‚ eval_optim_threshold                0.51366 â”‚
â”‚ eval_precision                      0.73134 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.8195 â”‚
â”‚ eval_samples_per_second              17.542 â”‚
â”‚ eval_steps_per_second                 1.047 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_7dec72ff completed after 1 iterations at 2025-06-04 19:13:30. Total running time: 41s
[36m(train_hpo pid=3426018)[0m {'train_runtime': 25.1684, 'train_samples_per_second': 39.335, 'train_steps_per_second': 0.397, 'train_loss': 2.861502742767334, 'epoch': 3.4}
[36m(train_hpo pid=3426018)[0m STATE at ending of training  :  TrainerState(epoch=3.4, global_step=10, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=177335259076608.0, log_history=[{'loss': 2.9633, 'grad_norm': 30.270633697509766, 'learning_rate': 3.188774071602418e-06, 'epoch': 1.0, 'step': 3}, {'loss': 2.7766, 'grad_norm': 29.92120361328125, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.0, 'step': 6}, {'loss': 2.725, 'grad_norm': 26.99224853515625, 'learning_rate': 4.555391530860598e-07, 'epoch': 3.0, 'step': 9}, {'loss': 3.2205, 'grad_norm': 52.42359924316406, 'learning_rate': 0.0, 'epoch': 3.4, 'step': 10}, {'train_runtime': 25.1684, 'train_samples_per_second': 39.335, 'train_steps_per_second': 0.397, 'total_flos': 177335259076608.0, 'train_loss': 2.861502742767334, 'epoch': 3.4, 'step': 10}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})2025-06-04 19:13:34,861 - INFO - Cleaning up trial bff5d423
2025-06-04 19:13:34,863 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-12-48/train_hpo_bff5d423_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-04_19-12-55
2025-06-04 19:13:34,863 - INFO - Current best: 7dec72ff with eval_f1 : 0.8448275862068966 at iteration 1
2025-06-04 19:13:34,863 - INFO - Current best: 1ecc846f with eval_f1 : 0.8448275862068966 at iteration 1
[36m(train_hpo pid=3426018)[0m 2025-06-04 19:13:34,791 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3426018)[0m 2025-06-04 19:13:34,797 - INFO - eval_result: {'eval_loss': 3.2605106830596924, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.5712555050849915, 'eval_AP': 0.7553062859363562, 'eval_MCC': 0.0, 'eval_NDCG': 0.9185085033743836, 'eval_kappa': 0.0, 'eval_runtime': 3.2796, 'eval_samples_per_second': 20.429, 'eval_steps_per_second': 1.22, 'epoch': 3.4}
[36m(train_hpo pid=3426018)[0m 2025-06-04 19:13:34,831 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
2025-06-04 19:13:34,871	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-12-48' in 0.0068s.
2025-06-04 19:13:34,880 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x719ac4261910>
2025-06-04 19:13:34,881 - INFO - Best trial : train_hpo_7dec72ff
2025-06-04 19:13:34,881 - INFO - Best config : {'pos_weight': 8.493688290834637, 'learning_rate': 1.4956066518424355e-06, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 6}
2025-06-04 19:13:34,881 - INFO - Best trial after optimization: {'eval_loss': 4.316805362701416, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.5136557817459106, 'eval_AP': 0.7579482594184326, 'eval_MCC': 0.0, 'eval_NDCG': 0.8686978031163629, 'eval_kappa': 0.0, 'eval_runtime': 3.8195, 'eval_samples_per_second': 17.542, 'eval_steps_per_second': 1.047, 'epoch': 4.0, 'timestamp': 1749057210, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '7dec72ff', 'date': '2025-06-04_19-13-30', 'time_this_iter_s': 34.80571007728577, 'time_total_s': 34.80571007728577, 'pid': 3425857, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 8.493688290834637, 'learning_rate': 1.4956066518424355e-06, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 6}, 'time_since_restore': 34.80571007728577, 'iterations_since_restore': 1, 'experiment_tag': '1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364'}
2025-06-04 19:13:34,903 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   4.316805  0.844828  ...                        6  7dec72ff
1   3.260511  0.844828  ...                        5  bff5d423
2   1.319977  0.844828  ...                        3  1ecc846f

[3 rows x 32 columns]
2025-06-04 19:13:35,016 - INFO - Trial comparison plot saved
2025-06-04 19:13:35,017 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-04 19:13:35,238 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-04 19:13:35,358 - INFO - training size : 198
2025-06-04 19:13:35,359 - INFO - dev size : 67
2025-06-04 19:13:35,359 - INFO - test size : 132
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(

[36m(train_hpo pid=3426018)[0m {'loss': 3.2205, 'grad_norm': 52.42359924316406, 'learning_rate': 0.0, 'epoch': 3.4}[32m [repeated 2x across cluster][0m

Trial train_hpo_bff5d423 finished iteration 1 at 2025-06-04 19:13:34. Total running time: 46s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_bff5d423 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    32.6441 â”‚
â”‚ time_total_s                        32.6441 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   3.4 â”‚
â”‚ eval_AP                             0.75531 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.91851 â”‚
â”‚ eval_accuracy                       0.73134 â”‚
â”‚ eval_f1                             0.84483 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           3.26051 â”‚
â”‚ eval_optim_threshold                0.57126 â”‚
â”‚ eval_precision                      0.73134 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.2796 â”‚
â”‚ eval_samples_per_second              20.429 â”‚
â”‚ eval_steps_per_second                  1.22 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_bff5d423 completed after 1 iterations at 2025-06-04 19:13:34. Total running time: 46s

Trial status: 3 TERMINATED
Current time: 2025-06-04 19:13:34. Total running time: 46s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_7dec72ff   TERMINATED        8.49369       1.49561e-06         0.13641                     6        1            34.8057       4.31681    0.844828               1          0.731343 â”‚
â”‚ train_hpo_bff5d423   TERMINATED        7.54953       4.55539e-06         0.123031                    5        1            32.6441       3.26051    0.844828               1          0.731343 â”‚
â”‚ train_hpo_1ecc846f   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            15.4707       1.31998    0.844828               1          0.731343 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

  0%|          | 0/54 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  2%|â–         | 1/54 [00:00<00:34,  1.52it/s]  4%|â–Ž         | 2/54 [00:01<00:33,  1.57it/s]  6%|â–Œ         | 3/54 [00:01<00:32,  1.58it/s]  7%|â–‹         | 4/54 [00:02<00:31,  1.59it/s]  9%|â–‰         | 5/54 [00:03<00:30,  1.60it/s] 11%|â–ˆ         | 6/54 [00:03<00:29,  1.60it/s] 13%|â–ˆâ–Ž        | 7/54 [00:04<00:29,  1.60it/s] 15%|â–ˆâ–        | 8/54 [00:04<00:28,  1.62it/s] 17%|â–ˆâ–‹        | 9/54 [00:05<00:23,  1.90it/s]                                               17%|â–ˆâ–‹        | 9/54 [00:05<00:23,  1.90it/s] 19%|â–ˆâ–Š        | 10/54 [00:05<00:24,  1.78it/s] 20%|â–ˆâ–ˆ        | 11/54 [00:06<00:24,  1.72it/s] 22%|â–ˆâ–ˆâ–       | 12/54 [00:07<00:24,  1.69it/s] 24%|â–ˆâ–ˆâ–       | 13/54 [00:07<00:24,  1.66it/s] 26%|â–ˆâ–ˆâ–Œ       | 14/54 [00:08<00:24,  1.64it/s] 28%|â–ˆâ–ˆâ–Š       | 15/54 [00:09<00:23,  1.63it/s] 30%|â–ˆâ–ˆâ–‰       | 16/54 [00:09<00:23,  1.62it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 17/54 [00:10<00:22,  1.63it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 18/54 [00:10<00:18,  1.90it/s]                                                33%|â–ˆâ–ˆâ–ˆâ–Ž      | 18/54 [00:10<00:18,  1.90it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 19/54 [00:11<00:19,  1.78it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 20/54 [00:11<00:19,  1.72it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 21/54 [00:12<00:19,  1.69it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 22/54 [00:13<00:19,  1.67it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 23/54 [00:13<00:18,  1.65it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 24/54 [00:14<00:18,  1.64it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 25/54 [00:15<00:17,  1.63it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 26/54 [00:15<00:17,  1.63it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 27/54 [00:15<00:14,  1.90it/s]                                                50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 27/54 [00:15<00:14,  1.90it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 28/54 [00:16<00:14,  1.78it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 29/54 [00:17<00:14,  1.73it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 30/54 [00:17<00:14,  1.69it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 31/54 [00:18<00:13,  1.67it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 32/54 [00:19<00:13,  1.65it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 33/54 [00:19<00:12,  1.63it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 34/54 [00:20<00:12,  1.63it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 35/54 [00:20<00:11,  1.64it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 36/54 [00:21<00:09,  1.90it/s]                                                67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 36/54 [00:21<00:09,  1.90it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 37/54 [00:21<00:09,  1.78it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 38/54 [00:22<00:09,  1.73it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 39/54 [00:23<00:08,  1.69it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 40/54 [00:23<00:08,  1.67it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 41/54 [00:24<00:07,  1.65it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 42/54 [00:24<00:07,  1.63it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 43/54 [00:25<00:06,  1.63it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 44/54 [00:26<00:06,  1.63it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 45/54 [00:26<00:04,  1.90it/s]                                                83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 45/54 [00:26<00:04,  1.90it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 46/54 [00:27<00:04,  1.78it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 47/54 [00:27<00:04,  1.73it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 48/54 [00:28<00:03,  1.69it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 49/54 [00:29<00:03,  1.66it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 50/54 [00:29<00:02,  1.65it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 51/54 [00:30<00:01,  1.64it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 52/54 [00:30<00:01,  1.63it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 53/54 [00:31<00:00,  1.63it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 54/54 [00:31<00:00,  1.90it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 54/54 [00:34<00:00,  1.90it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 54/54 [00:34<00:00,  1.90it/s]2025-06-04 19:14:10,136 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 54/54 [00:34<00:00,  1.58it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
{'loss': 2.9588, 'grad_norm': 73.00752258300781, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}
{'loss': 2.7364, 'grad_norm': 54.09208679199219, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0}
{'loss': 2.6865, 'grad_norm': 51.65205383300781, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0}
{'loss': 2.553, 'grad_norm': 48.803009033203125, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0}
{'loss': 2.6027, 'grad_norm': 46.66240310668945, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0}
{'loss': 2.5084, 'grad_norm': 65.68067932128906, 'learning_rate': 0.0, 'epoch': 6.0}
{'train_runtime': 34.2735, 'train_samples_per_second': 34.662, 'train_steps_per_second': 1.576, 'train_loss': 2.674275009720414, 'epoch': 6.0}
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.19it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.38it/s]2025-06-04 19:14:13,823 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.13s/it]
2025-06-04 19:14:13,829 - INFO - Training time : 38.812371314968914
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.07it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.00it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.32it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.07it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.30it/s]2025-06-04 19:14:18,239 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.46it/s]
2025-06-04 19:14:18,244 - INFO - Evaluation time : 4.415349764982238
2025-06-04 19:14:18,245 - INFO - Evaluation results on test set: {'eval_loss': 2.523588180541992, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.7016237378120422, 'eval_AP': 0.8845563405007546, 'eval_MCC': 0.0, 'eval_NDCG': 0.9767911063178923, 'eval_kappa': 0.0, 'eval_runtime': 4.4109, 'eval_samples_per_second': 29.926, 'eval_steps_per_second': 1.36, 'epoch': 6.0}
2025-06-04 19:14:18,245 - INFO - Total updates (optimizer steps): 54
2025-06-04 19:14:18,245 - INFO - Avg time / step: 0.635s
2025-06-04 19:14:18,983 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCEgoogle-bert/bert-base-uncased3trials_fold-2
2025-06-04 19:14:18,983 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.06it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.02it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.34it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.09it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.31it/s]2025-06-04 19:14:23,425 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.45it/s]
2025-06-04 19:14:23,429 - INFO - preds : [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
2025-06-04 19:14:23,430 - INFO - test_split["labels"] : [1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1]
2025-06-04 19:14:23,431 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:14:26,225 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': 0.8845563405007546, 'MCC': 0.0, 'NDCG': 0.9767911063178923, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:14:26,356 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-04 19:14:26,461 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:14:26,461 - INFO - 
On test Set (optimal threshold of 0.6997810006141663 according to cross validation on the training set): 
2025-06-04 19:14:26,463 - INFO - Confusion matrix: TN=22, FP=12, FN=28, TP=70
2025-06-04 19:14:29,411 - INFO - Metrics: {'f1': 0.7777777777777778, 'recall': 0.7142857142857143, 'precision': 0.8536585365853658, 'accuracy': 0.696969696969697, 'AP': 0.8845563405007546, 'MCC': 0.3257482282037852, 'NDCG': 0.9767911063178923, 'kappa': 0.3132154006243497, 'TN': 22, 'FP': 12, 'FN': 28, 'TP': 70}
2025-06-04 19:14:29,514 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:14:29,514 - INFO - Results for fold 2 : [{'f1': 0.7777777777777778, 'recall': 0.7142857142857143, 'precision': 0.8536585365853658, 'accuracy': 0.696969696969697, 'AP': 0.8845563405007546, 'MCC': 0.3257482282037852, 'NDCG': 0.9767911063178923, 'kappa': 0.3132154006243497, 'TN': 22, 'FP': 12, 'FN': 28, 'TP': 70}]
2025-06-04 19:14:29,633 - INFO - Cleared CUDA cache. Memory allocated: 1.41 GB, Memory reserved: 1.82 GB
2025-06-04 19:14:29,633 - INFO - 
fold number 3 / 3
2025-06-04 19:14:29,639 - INFO - train split size : 198
2025-06-04 19:14:29,639 - INFO - dev split size : 67
2025-06-04 19:14:29,639 - INFO - test split size : 132
Map (num_proc=32):   0%|          | 0/198 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–Ž         | 7/198 [00:00<00:04, 38.45 examples/s]Map (num_proc=32):  21%|â–ˆâ–ˆ        | 42/198 [00:00<00:00, 163.69 examples/s]Map (num_proc=32):  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 84/198 [00:00<00:00, 235.47 examples/s]Map (num_proc=32):  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 120/198 [00:00<00:00, 265.10 examples/s]Map (num_proc=32):  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 150/198 [00:00<00:00, 267.13 examples/s]Map (num_proc=32):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 186/198 [00:00<00:00, 284.13 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 198/198 [00:00<00:00, 214.48 examples/s]
Map (num_proc=32):   0%|          | 0/67 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/67 [00:00<00:03, 17.41 examples/s]Map (num_proc=32):  25%|â–ˆâ–ˆâ–Œ       | 17/67 [00:00<00:00, 68.22 examples/s]Map (num_proc=32):  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 29/67 [00:00<00:00, 84.63 examples/s]Map (num_proc=32):  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 39/67 [00:00<00:00, 85.53 examples/s]Map (num_proc=32):  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 49/67 [00:00<00:00, 89.93 examples/s]Map (num_proc=32):  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 59/67 [00:00<00:00, 92.17 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:00<00:00, 72.59 examples/s]
Map (num_proc=32):   0%|          | 0/132 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/132 [00:00<00:04, 29.26 examples/s]Map (num_proc=32):  24%|â–ˆâ–ˆâ–       | 32/132 [00:00<00:00, 126.31 examples/s]Map (num_proc=32):  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 56/132 [00:00<00:00, 156.45 examples/s]Map (num_proc=32):  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 80/132 [00:00<00:00, 171.09 examples/s]Map (num_proc=32):  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 100/132 [00:00<00:00, 179.15 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 120/132 [00:00<00:00, 173.98 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 132/132 [00:00<00:00, 140.28 examples/s]
2025-06-04 19:14:38,220 - INFO - 3 datasets tokenized successfully
2025-06-04 19:14:38,222 - INFO - Starting hyperparameter search for BCE loss
[36m(train_hpo pid=3428971)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3428971)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3428971)[0m 2025-06-04 19:14:45,597 - INFO - pos_weight value in TrainingArguments : 8.493688290834637
[36m(train_hpo pid=3428971)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3428971)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3428971)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3428971)[0m   warnings.warn(
[36m(train_hpo pid=3429132)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3429132)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3429132)[0m 2025-06-04 19:14:52,338 - INFO - pos_weight value in TrainingArguments : 7.549531688595925
[36m(train_hpo pid=3429132)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3429132)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3429132)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3429132)[0m   warnings.warn(
[36m(train_hpo pid=3429412)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3429412)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3429412)[0m 2025-06-04 19:14:59,189 - INFO - pos_weight value in TrainingArguments : 8.949837496427758
[36m(train_hpo pid=3429412)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3429412)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3429412)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3429412)[0m   warnings.warn(
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-04_19-14-38   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-14-38
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-04_18-54-36_274448_3393636/artifacts/2025-06-04_19-14-38/train_hpo_2025-06-04_19-14-38/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-04 19:14:38. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_5dbef367   PENDING         8.49369       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_5dbef367 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_5dbef367 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          8.49369 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3428971)[0m [2025-06-04 19:14:45,846] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3426018)[0m {'eval_loss': 3.2605106830596924, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.5712555050849915, 'eval_AP': 0.7553062859363562, 'eval_MCC': 0.0, 'eval_NDCG': 0.9185085033743836, 'eval_kappa': 0.0, 'eval_runtime': 3.2796, 'eval_samples_per_second': 20.429, 'eval_steps_per_second': 1.22, 'epoch': 3.4}
[36m(train_hpo pid=3428971)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=12, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_4fe7de27 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_4fe7de27 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          7.54953 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3429132)[0m [2025-06-04 19:14:52,751] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3428971)[0m {'loss': 3.3393, 'grad_norm': 32.610172271728516, 'learning_rate': 1.1217049888818266e-06, 'epoch': 1.0}
[36m(train_hpo pid=3429132)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_2d207621 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_2d207621 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          8.94984 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3428971)[0m {'loss': 3.2759, 'grad_norm': 39.686492919921875, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.0}
[36m(train_hpo pid=3429412)[0m [2025-06-04 19:14:59,425] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3429412)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=6, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3429132)[0m {'loss': 4.319, 'grad_norm': 37.17494201660156, 'learning_rate': 3.188774071602418e-06, 'epoch': 1.0}

Trial status: 3 RUNNING
Current time: 2025-06-04 19:15:08. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_5dbef367   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_4fe7de27   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_2d207621   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯2025-06-04 19:15:14,451 - INFO - Cleaning up trial 2d207621
2025-06-04 19:15:14,451 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-14-38/train_hpo_2d207621_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512_2025-06-04_19-14-51
[36m(train_hpo pid=3429412)[0m 2025-06-04 19:15:14,376 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3429412)[0m 2025-06-04 19:15:14,383 - INFO - eval_result: {'eval_loss': 1.8798458576202393, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.8020793795585632, 'eval_AP': 0.8204393997129417, 'eval_MCC': 0.0, 'eval_NDCG': 0.9098774619187231, 'eval_kappa': 0.0, 'eval_runtime': 3.6434, 'eval_samples_per_second': 18.389, 'eval_steps_per_second': 1.098, 'epoch': 2.0}
[36m(train_hpo pid=3429412)[0m 2025-06-04 19:15:14,425 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3428971)[0m 2025-06-04 19:15:20,322 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3428971)[0m 2025-06-04 19:15:20,329 - INFO - eval_result: {'eval_loss': 3.9187211990356445, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.5560413599014282, 'eval_AP': 0.8854156893571387, 'eval_MCC': 0.0, 'eval_NDCG': 0.9523430950123987, 'eval_kappa': 0.0, 'eval_runtime': 4.0854, 'eval_samples_per_second': 16.4, 'eval_steps_per_second': 0.979, 'epoch': 4.0}
2025-06-04 19:15:20,392 - INFO - Cleaning up trial 5dbef367
2025-06-04 19:15:20,392 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-14-38/train_hpo_5dbef367_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-04_19-14-38
2025-06-04 19:15:20,392 - INFO - Current best: 2d207621 with eval_f1 : 0.8547008547008547 at iteration 1
[36m(train_hpo pid=3428971)[0m 2025-06-04 19:15:20,366 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB

[36m(train_hpo pid=3429412)[0m {'train_runtime': 8.0646, 'train_samples_per_second': 73.655, 'train_steps_per_second': 0.744, 'train_loss': 2.242581764856974, 'epoch': 2.0}
[36m(train_hpo pid=3429412)[0m STATE at ending of training  :  TrainerState(epoch=2.0, global_step=6, max_steps=6, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=104191042424832.0, log_history=[{'loss': 2.7332, 'grad_norm': 17.651744842529297, 'learning_rate': 3.994089731390617e-05, 'epoch': 1.0, 'step': 3}, {'loss': 1.7519, 'grad_norm': 16.880212783813477, 'learning_rate': 0.0, 'epoch': 2.0, 'step': 6}, {'train_runtime': 8.0646, 'train_samples_per_second': 73.655, 'train_steps_per_second': 0.744, 'total_flos': 104191042424832.0, 'train_loss': 2.242581764856974, 'epoch': 2.0, 'step': 6}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3429412)[0m {'loss': 1.7519, 'grad_norm': 16.880212783813477, 'learning_rate': 0.0, 'epoch': 2.0}[32m [repeated 3x across cluster][0m

Trial train_hpo_2d207621 finished iteration 1 at 2025-06-04 19:15:14. Total running time: 36s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_2d207621 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                      15.71 â”‚
â”‚ time_total_s                          15.71 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     2 â”‚
â”‚ eval_AP                             0.82044 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.90988 â”‚
â”‚ eval_accuracy                       0.74627 â”‚
â”‚ eval_f1                              0.8547 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.87985 â”‚
â”‚ eval_optim_threshold                0.80208 â”‚
â”‚ eval_precision                      0.74627 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.6434 â”‚
â”‚ eval_samples_per_second              18.389 â”‚
â”‚ eval_steps_per_second                 1.098 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_2d207621 completed after 1 iterations at 2025-06-04 19:15:14. Total running time: 36s
[36m(train_hpo pid=3429412)[0m {'eval_loss': 1.8798458576202393, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.8020793795585632, 'eval_AP': 0.8204393997129417, 'eval_MCC': 0.0, 'eval_NDCG': 0.9098774619187231, 'eval_kappa': 0.0, 'eval_runtime': 3.6434, 'eval_samples_per_second': 18.389, 'eval_steps_per_second': 1.098, 'epoch': 2.0}
[36m(train_hpo pid=3428971)[0m STATE at ending of training  :  TrainerState(epoch=4.0, global_step=12, max_steps=12, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=208382084849664.0, log_history=[{'loss': 3.3393, 'grad_norm': 32.610172271728516, 'learning_rate': 1.1217049888818266e-06, 'epoch': 1.0, 'step': 3}, {'loss': 3.2759, 'grad_norm': 39.686492919921875, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.0, 'step': 6}, {'loss': 3.2655, 'grad_norm': 44.009552001953125, 'learning_rate': 3.7390166296060887e-07, 'epoch': 3.0, 'step': 9}, {'loss': 3.252, 'grad_norm': 31.631723403930664, 'learning_rate': 0.0, 'epoch': 4.0, 'step': 12}, {'train_runtime': 27.0804, 'train_samples_per_second': 43.869, 'train_steps_per_second': 0.443, 'total_flos': 208382084849664.0, 'train_loss': 3.2831788063049316, 'epoch': 4.0, 'step': 12}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3428971)[0m {'train_runtime': 27.0804, 'train_samples_per_second': 43.869, 'train_steps_per_second': 0.443, 'train_loss': 3.2831788063049316, 'epoch': 4.0}
[36m(train_hpo pid=3428971)[0m {'loss': 3.252, 'grad_norm': 31.631723403930664, 'learning_rate': 0.0, 'epoch': 4.0}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3428971)[0m {'eval_loss': 3.9187211990356445, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.5560413599014282, 'eval_AP': 0.8854156893571387, 'eval_MCC': 0.0, 'eval_NDCG': 0.9523430950123987, 'eval_kappa': 0.0, 'eval_runtime': 4.0854, 'eval_samples_per_second': 16.4, 'eval_steps_per_second': 0.979, 'epoch': 4.0}

Trial train_hpo_5dbef367 finished iteration 1 at 2025-06-04 19:15:20. Total running time: 42s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_5dbef367 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    35.2278 â”‚
â”‚ time_total_s                        35.2278 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     4 â”‚
â”‚ eval_AP                             0.88542 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.95234 â”‚
â”‚ eval_accuracy                       0.74627 â”‚
â”‚ eval_f1                              0.8547 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           3.91872 â”‚
â”‚ eval_optim_threshold                0.55604 â”‚
â”‚ eval_precision                      0.74627 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         4.0854 â”‚
â”‚ eval_samples_per_second                16.4 â”‚
â”‚ eval_steps_per_second                 0.979 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_5dbef367 completed after 1 iterations at 2025-06-04 19:15:20. Total running time: 42s
[36m(train_hpo pid=3429132)[0m {'train_runtime': 25.333, 'train_samples_per_second': 39.079, 'train_steps_per_second': 0.395, 'train_loss': 4.183948802947998, 'epoch': 3.4}
[36m(train_hpo pid=3429132)[0m STATE at ending of training  :  TrainerState(epoch=3.4, global_step=10, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=177335259076608.0, log_history=[{'loss': 4.319, 'grad_norm': 37.17494201660156, 'learning_rate': 3.188774071602418e-06, 'epoch': 1.0, 'step': 3}, {'loss': 4.1558, 'grad_norm': 43.16469955444336, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.0, 'step': 6}, {'loss': 3.9171, 'grad_norm': 45.778099060058594, 'learning_rate': 4.555391530860598e-07, 'epoch': 3.0, 'step': 9}, {'loss': 4.6635, 'grad_norm': 73.45996856689453, 'learning_rate': 0.0, 'epoch': 3.4, 'step': 10}, {'train_runtime': 25.333, 'train_samples_per_second': 39.079, 'train_steps_per_second': 0.395, 'total_flos': 177335259076608.0, 'train_loss': 4.183948802947998, 'epoch': 3.4, 'step': 10}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})[36m(train_hpo pid=3429132)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
[36m(train_hpo pid=3429132)[0m   _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
[36m(train_hpo pid=3429132)[0m 2025-06-04 19:15:24,640 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3429132)[0m 2025-06-04 19:15:24,646 - INFO - eval_result: {'eval_loss': 4.765669345855713, 'eval_f1': 0.0, 'eval_recall': 0.0, 'eval_accuracy': 0.2537313432835821, 'eval_precision': 0.0, 'eval_optim_threshold': 0.433952659368515, 'eval_AP': 0.6609792348155288, 'eval_MCC': 0.0, 'eval_NDCG': 0.8036504933152075, 'eval_kappa': 0.0, 'eval_runtime': 3.3257, 'eval_samples_per_second': 20.146, 'eval_steps_per_second': 1.203, 'epoch': 3.4}
2025-06-04 19:15:24,703 - INFO - Cleaning up trial 4fe7de27
2025-06-04 19:15:24,703 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-14-38/train_hpo_4fe7de27_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-04_19-14-45
2025-06-04 19:15:24,703 - INFO - Current best: 5dbef367 with eval_f1 : 0.8547008547008547 at iteration 1
2025-06-04 19:15:24,703 - INFO - Current best: 2d207621 with eval_f1 : 0.8547008547008547 at iteration 1
2025-06-04 19:15:24,712	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-14-38' in 0.0069s.
2025-06-04 19:15:24,719 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x719abc32d590>
2025-06-04 19:15:24,719 - INFO - Best trial : train_hpo_5dbef367
2025-06-04 19:15:24,719 - INFO - Best config : {'pos_weight': 8.493688290834637, 'learning_rate': 1.4956066518424355e-06, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 6}
2025-06-04 19:15:24,719 - INFO - Best trial after optimization: {'eval_loss': 3.9187211990356445, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.5560413599014282, 'eval_AP': 0.8854156893571387, 'eval_MCC': 0.0, 'eval_NDCG': 0.9523430950123987, 'eval_kappa': 0.0, 'eval_runtime': 4.0854, 'eval_samples_per_second': 16.4, 'eval_steps_per_second': 0.979, 'epoch': 4.0, 'timestamp': 1749057320, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '5dbef367', 'date': '2025-06-04_19-15-20', 'time_this_iter_s': 35.22784948348999, 'time_total_s': 35.22784948348999, 'pid': 3428971, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 8.493688290834637, 'learning_rate': 1.4956066518424355e-06, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 6}, 'time_since_restore': 35.22784948348999, 'iterations_since_restore': 1, 'experiment_tag': '1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364'}
2025-06-04 19:15:24,741 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   3.918721  0.854701  ...                        6  5dbef367
1   4.765669  0.000000  ...                        5  4fe7de27
2   1.879846  0.854701  ...                        3  2d207621

[3 rows x 32 columns]
2025-06-04 19:15:24,891 - INFO - Trial comparison plot saved
2025-06-04 19:15:24,891 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-04 19:15:25,104 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-04 19:15:25,215 - INFO - training size : 198
2025-06-04 19:15:25,216 - INFO - dev size : 67
2025-06-04 19:15:25,216 - INFO - test size : 132
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(

[36m(train_hpo pid=3429132)[0m {'loss': 4.6635, 'grad_norm': 73.45996856689453, 'learning_rate': 0.0, 'epoch': 3.4}[32m [repeated 2x across cluster][0m

Trial train_hpo_4fe7de27 finished iteration 1 at 2025-06-04 19:15:24. Total running time: 46s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_4fe7de27 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    32.7941 â”‚
â”‚ time_total_s                        32.7941 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   3.4 â”‚
â”‚ eval_AP                             0.66098 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.80365 â”‚
â”‚ eval_accuracy                       0.25373 â”‚
â”‚ eval_f1                                   0 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           4.76567 â”‚
â”‚ eval_optim_threshold                0.43395 â”‚
â”‚ eval_precision                            0 â”‚
â”‚ eval_recall                               0 â”‚
â”‚ eval_runtime                         3.3257 â”‚
â”‚ eval_samples_per_second              20.146 â”‚
â”‚ eval_steps_per_second                 1.203 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_4fe7de27 completed after 1 iterations at 2025-06-04 19:15:24. Total running time: 46s

Trial status: 3 TERMINATED
Current time: 2025-06-04 19:15:24. Total running time: 46s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_5dbef367   TERMINATED        8.49369       1.49561e-06         0.13641                     6        1            35.2278       3.91872    0.854701               1          0.746269 â”‚
â”‚ train_hpo_4fe7de27   TERMINATED        7.54953       4.55539e-06         0.123031                    5        1            32.7941       4.76567    0                      0          0.253731 â”‚
â”‚ train_hpo_2d207621   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            15.71         1.87985    0.854701               1          0.746269 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

  0%|          | 0/54 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  2%|â–         | 1/54 [00:00<00:34,  1.52it/s]  4%|â–Ž         | 2/54 [00:01<00:33,  1.57it/s]  6%|â–Œ         | 3/54 [00:01<00:32,  1.59it/s]  7%|â–‹         | 4/54 [00:02<00:31,  1.60it/s]  9%|â–‰         | 5/54 [00:03<00:30,  1.60it/s] 11%|â–ˆ         | 6/54 [00:03<00:29,  1.61it/s] 13%|â–ˆâ–Ž        | 7/54 [00:04<00:29,  1.61it/s] 15%|â–ˆâ–        | 8/54 [00:04<00:28,  1.62it/s] 17%|â–ˆâ–‹        | 9/54 [00:05<00:23,  1.90it/s]                                               17%|â–ˆâ–‹        | 9/54 [00:05<00:23,  1.90it/s] 19%|â–ˆâ–Š        | 10/54 [00:05<00:24,  1.78it/s] 20%|â–ˆâ–ˆ        | 11/54 [00:06<00:24,  1.72it/s] 22%|â–ˆâ–ˆâ–       | 12/54 [00:07<00:24,  1.68it/s] 24%|â–ˆâ–ˆâ–       | 13/54 [00:07<00:24,  1.66it/s] 26%|â–ˆâ–ˆâ–Œ       | 14/54 [00:08<00:24,  1.64it/s] 28%|â–ˆâ–ˆâ–Š       | 15/54 [00:09<00:23,  1.63it/s] 30%|â–ˆâ–ˆâ–‰       | 16/54 [00:09<00:23,  1.63it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 17/54 [00:10<00:22,  1.63it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 18/54 [00:10<00:18,  1.90it/s]                                                33%|â–ˆâ–ˆâ–ˆâ–Ž      | 18/54 [00:10<00:18,  1.90it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 19/54 [00:11<00:19,  1.78it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 20/54 [00:11<00:19,  1.72it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 21/54 [00:12<00:19,  1.69it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 22/54 [00:13<00:19,  1.66it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 23/54 [00:13<00:18,  1.65it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 24/54 [00:14<00:18,  1.63it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 25/54 [00:15<00:17,  1.63it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 26/54 [00:15<00:17,  1.63it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 27/54 [00:15<00:14,  1.90it/s]                                                50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 27/54 [00:15<00:14,  1.90it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 28/54 [00:16<00:14,  1.78it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 29/54 [00:17<00:14,  1.72it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 30/54 [00:17<00:14,  1.68it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 31/54 [00:18<00:13,  1.66it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 32/54 [00:19<00:13,  1.64it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 33/54 [00:19<00:12,  1.63it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 34/54 [00:20<00:12,  1.62it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 35/54 [00:20<00:11,  1.63it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 36/54 [00:21<00:09,  1.90it/s]                                                67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 36/54 [00:21<00:09,  1.90it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 37/54 [00:21<00:09,  1.78it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 38/54 [00:22<00:09,  1.72it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 39/54 [00:23<00:08,  1.69it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 40/54 [00:23<00:08,  1.66it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 41/54 [00:24<00:07,  1.65it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 42/54 [00:25<00:07,  1.63it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 43/54 [00:25<00:06,  1.62it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 44/54 [00:26<00:06,  1.63it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 45/54 [00:26<00:04,  1.90it/s]                                                83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 45/54 [00:26<00:04,  1.90it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 46/54 [00:27<00:04,  1.78it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 47/54 [00:27<00:04,  1.72it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 48/54 [00:28<00:03,  1.68it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 49/54 [00:29<00:03,  1.66it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 50/54 [00:29<00:02,  1.64it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 51/54 [00:30<00:01,  1.63it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 52/54 [00:30<00:01,  1.63it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 53/54 [00:31<00:00,  1.63it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 54/54 [00:31<00:00,  1.90it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 54/54 [00:34<00:00,  1.90it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 54/54 [00:34<00:00,  1.90it/s]2025-06-04 19:15:59,988 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 54/54 [00:34<00:00,  1.57it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
{'loss': 5.4642, 'grad_norm': 129.9392547607422, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}
{'loss': 5.4099, 'grad_norm': 127.13482666015625, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0}
{'loss': 4.9376, 'grad_norm': 85.56269073486328, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0}
{'loss': 5.0903, 'grad_norm': 85.1982650756836, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0}
{'loss': 4.9278, 'grad_norm': 71.66768646240234, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0}
{'loss': 4.8249, 'grad_norm': 62.92903518676758, 'learning_rate': 0.0, 'epoch': 6.0}
{'train_runtime': 34.3084, 'train_samples_per_second': 34.627, 'train_steps_per_second': 1.574, 'train_loss': 5.109106770268193, 'epoch': 6.0}
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.22it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.38it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-06-04 19:16:03,998 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.24s/it]
2025-06-04 19:16:04,004 - INFO - Training time : 39.113398055080324
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.09it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.02it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.35it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.10it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.32it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-06-04 19:16:08,476 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.44it/s]
2025-06-04 19:16:08,482 - INFO - Evaluation time : 4.477424715878442
2025-06-04 19:16:08,482 - INFO - Evaluation results on test set: {'eval_loss': 4.876191139221191, 'eval_f1': 0.0, 'eval_recall': 0.0, 'eval_accuracy': 0.26515151515151514, 'eval_precision': 0.0, 'eval_optim_threshold': 0.4663049578666687, 'eval_AP': 0.8838846633202448, 'eval_MCC': 0.0, 'eval_NDCG': 0.9447709691642994, 'eval_kappa': 0.0, 'eval_runtime': 4.4729, 'eval_samples_per_second': 29.511, 'eval_steps_per_second': 1.341, 'epoch': 6.0}
2025-06-04 19:16:08,482 - INFO - Total updates (optimizer steps): 54
2025-06-04 19:16:08,482 - INFO - Avg time / step: 0.635s
2025-06-04 19:16:09,220 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCEgoogle-bert/bert-base-uncased3trials_fold-3
2025-06-04 19:16:09,220 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.11it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.03it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.35it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.09it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.31it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-06-04 19:16:13,649 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.45it/s]
2025-06-04 19:16:13,654 - INFO - preds : [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
2025-06-04 19:16:13,655 - INFO - test_split["labels"] : [1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1]
2025-06-04 19:16:13,656 - INFO - Confusion matrix: TN=35, FP=0, FN=97, TP=0
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-06-04 19:16:17,094 - INFO - Metrics: {'f1': 0.0, 'recall': 0.0, 'precision': 0.0, 'accuracy': 0.26515151515151514, 'AP': 0.8838846633202448, 'MCC': 0.0, 'NDCG': 0.9447709691642994, 'kappa': 0.0, 'TN': 35, 'FP': 0, 'FN': 97, 'TP': 0}
2025-06-04 19:16:17,226 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-04 19:16:17,329 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:16:17,329 - INFO - 
On test Set (optimal threshold of 0.4675041437149048 according to cross validation on the training set): 
2025-06-04 19:16:17,331 - INFO - Confusion matrix: TN=25, FP=10, FN=28, TP=69
2025-06-04 19:16:20,115 - INFO - Metrics: {'f1': 0.7840909090909091, 'recall': 0.711340206185567, 'precision': 0.8734177215189873, 'accuracy': 0.7121212121212122, 'AP': 0.8838846633202448, 'MCC': 0.38326263165706076, 'NDCG': 0.9447709691642994, 'kappa': 0.365545155578042, 'TN': 25, 'FP': 10, 'FN': 28, 'TP': 69}
2025-06-04 19:16:20,215 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:16:20,215 - INFO - Results for fold 3 : [{'f1': 0.7840909090909091, 'recall': 0.711340206185567, 'precision': 0.8734177215189873, 'accuracy': 0.7121212121212122, 'AP': 0.8838846633202448, 'MCC': 0.38326263165706076, 'NDCG': 0.9447709691642994, 'kappa': 0.365545155578042, 'TN': 25, 'FP': 10, 'FN': 28, 'TP': 69}]
2025-06-04 19:16:20,332 - INFO - Cleared CUDA cache. Memory allocated: 1.42 GB, Memory reserved: 1.76 GB
2025-06-04 19:16:20,333 - INFO - Cleared CUDA cache. Memory allocated: 1.42 GB, Memory reserved: 1.76 GB
2025-06-04 19:16:20,379 - INFO - Cleared CUDA cache. Memory allocated: 0.02 GB, Memory reserved: 0.03 GB
2025-06-04 19:16:20,393 - INFO - Metrics for google-bert/bert-base-uncased:                       model_name fold loss_type run  ...    TN    FP    FN    TP
3  google-bert/bert-base-uncased    1       BCE   1  ...   0.0  35.0   0.0  98.0
4  google-bert/bert-base-uncased    2       BCE   1  ...   0.0  34.0   0.0  98.0
5  google-bert/bert-base-uncased    3       BCE   1  ...   0.0  35.0   0.0  97.0
0  google-bert/bert-base-uncased    1       BCE   2  ...   0.0  35.0   0.0  98.0
0  google-bert/bert-base-uncased    2       BCE   2  ...   0.0  34.0   0.0  98.0
0  google-bert/bert-base-uncased    3       BCE   2  ...  35.0   0.0  97.0   0.0

[6 rows x 18 columns]
2025-06-04 19:16:20,393 - INFO - 
fold number 1 / 3
2025-06-04 19:16:20,398 - INFO - Confusion matrix: TN=15, FP=20, FN=1, TP=97
2025-06-04 19:16:23,128 - INFO - Metrics: {'f1': 0.9023255813953488, 'recall': 0.9897959183673469, 'precision': 0.8290598290598291, 'accuracy': 0.8421052631578947, 'AP': 0.9947371833203409, 'MCC': 0.5663069856125756, 'NDCG': 0.9991544425346289, 'kappa': 0.5067985166872683, 'TN': 15, 'FP': 20, 'FN': 1, 'TP': 97}
2025-06-04 19:16:23,129 - INFO - 
fold number 2 / 3
2025-06-04 19:16:23,134 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:16:25,900 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': 0.9888369842942979, 'MCC': 0.0, 'NDCG': 0.9981809769694642, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:16:25,902 - INFO - 
fold number 3 / 3
2025-06-04 19:16:25,907 - INFO - Confusion matrix: TN=33, FP=2, FN=13, TP=84
2025-06-04 19:16:28,671 - INFO - Metrics: {'f1': 0.9180327868852459, 'recall': 0.865979381443299, 'precision': 0.9767441860465116, 'accuracy': 0.8863636363636364, 'AP': 0.9876424859978481, 'MCC': 0.7492944264066955, 'NDCG': 0.9979172262488742, 'kappa': 0.7350107066381156, 'TN': 33, 'FP': 2, 'FN': 13, 'TP': 84}
2025-06-04 19:16:28,678 - INFO - fold indexes for run no.1: [[159, 206, 117, 82, 317, 330, 131, 380, 183, 158, 213, 260, 155, 332, 303, 269, 40, 232, 314, 244, 168, 218, 254, 100, 3, 235, 105, 243, 352, 394, 196, 223, 230, 307, 342, 289, 135, 7, 189, 134, 78, 133, 12, 375, 109, 46, 62, 393, 167, 151, 387, 374, 276, 323, 132, 319, 114, 176, 322, 263, 258, 266, 250, 329, 309, 367, 24, 229, 370, 211, 228, 346, 115, 392, 87, 88, 81, 343, 253, 278, 43, 333, 28, 80, 191, 10, 378, 388, 225, 363, 136, 104, 356, 8, 57, 162, 220, 391, 139, 386, 282, 70, 61, 170, 102, 296, 64, 35, 4, 251, 279, 44, 373, 129, 236, 327, 187, 68, 245, 215, 18, 42, 116, 212, 376, 148, 126, 27, 252, 173, 103, 336, 209, 199, 169, 283, 32, 246, 292, 210, 247, 141, 73, 194, 59, 385, 354, 51, 305, 200, 344, 179, 178, 355, 313, 112, 291, 23, 328, 130, 315, 181, 138, 94, 95, 121, 207, 175, 295, 321, 34, 300, 262, 33, 341, 54, 299, 48, 30, 204, 123, 331, 301, 150, 157, 265, 14, 53, 396, 242, 377, 366, 93, 214, 83, 52, 6, 188], [177, 268, 97, 248, 298, 320, 224, 137, 161, 145, 339, 98, 39, 66, 17, 325, 226, 91, 348, 67, 55, 237, 273, 353, 381, 261, 31, 2, 290, 107, 38, 113, 120, 1, 222, 84, 358, 202, 63, 337, 92, 99, 144, 256, 19, 171, 219, 285, 274, 174, 118, 233, 156, 324, 284, 190, 255, 357, 205, 111, 72, 384, 294, 71, 163, 217], array([  0,   5,   9,  11,  13,  15,  16,  20,  21,  22,  25,  26,  29,
        36,  37,  41,  45,  47,  49,  50,  56,  58,  60,  65,  69,  74,
        75,  76,  77,  79,  85,  86,  89,  90,  96, 101, 106, 108, 110,
       119, 122, 124, 125, 127, 128, 140, 142, 143, 146, 147, 149, 152,
       153, 154, 160, 164, 165, 166, 172, 180, 182, 184, 185, 186, 192,
       193, 195, 197, 198, 201, 203, 208, 216, 221, 227, 231, 234, 238,
       239, 240, 241, 249, 257, 259, 264, 267, 270, 271, 272, 275, 277,
       280, 281, 286, 287, 288, 293, 297, 302, 304, 306, 308, 310, 311,
       312, 316, 318, 326, 334, 335, 338, 340, 345, 347, 349, 350, 351,
       359, 360, 361, 362, 364, 365, 368, 369, 371, 372, 379, 382, 383,
       389, 390, 395])]
2025-06-04 19:16:28,678 - INFO - Run no 1/2
2025-06-04 19:16:28,678 - INFO - Loss Type : focal
2025-06-04 19:16:28,678 - INFO - Ensemble learning pipeline
2025-06-04 19:16:28,678 - INFO - Training model 1/2: dmis-lab/biobert-v1.1
2025-06-04 19:16:28,846 - INFO - 
fold number 1 / 3
2025-06-04 19:16:28,852 - INFO - train split size : 198
2025-06-04 19:16:28,852 - INFO - dev split size : 66
2025-06-04 19:16:28,852 - INFO - test split size : 133
Map (num_proc=32):   0%|          | 0/198 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–Ž         | 7/198 [00:00<00:04, 40.49 examples/s]Map (num_proc=32):  21%|â–ˆâ–ˆ        | 42/198 [00:00<00:00, 173.29 examples/s]Map (num_proc=32):  39%|â–ˆâ–ˆâ–ˆâ–‰      | 78/198 [00:00<00:00, 244.50 examples/s]Map (num_proc=32):  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 114/198 [00:00<00:00, 271.44 examples/s]Map (num_proc=32):  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 150/198 [00:00<00:00, 282.91 examples/s]Map (num_proc=32):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 186/198 [00:00<00:00, 301.28 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 198/198 [00:00<00:00, 228.96 examples/s]
Map (num_proc=32):   0%|          | 0/66 [00:00<?, ? examples/s]Map (num_proc=32):   5%|â–         | 3/66 [00:00<00:03, 17.42 examples/s]Map (num_proc=32):  24%|â–ˆâ–ˆâ–       | 16/66 [00:00<00:00, 63.40 examples/s]Map (num_proc=32):  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 28/66 [00:00<00:00, 83.71 examples/s]Map (num_proc=32):  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 38/66 [00:00<00:00, 84.25 examples/s]Map (num_proc=32):  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 50/66 [00:00<00:00, 90.77 examples/s]Map (num_proc=32):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 62/66 [00:00<00:00, 91.49 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 66/66 [00:00<00:00, 73.51 examples/s]
Map (num_proc=32):   0%|          | 0/133 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/133 [00:00<00:04, 27.99 examples/s]Map (num_proc=32):  22%|â–ˆâ–ˆâ–       | 29/133 [00:00<00:00, 114.66 examples/s]Map (num_proc=32):  37%|â–ˆâ–ˆâ–ˆâ–‹      | 49/133 [00:00<00:00, 138.85 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 69/133 [00:00<00:00, 150.03 examples/s]Map (num_proc=32):  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 93/133 [00:00<00:00, 170.89 examples/s]Map (num_proc=32):  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 117/133 [00:00<00:00, 181.16 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 133/133 [00:00<00:00, 138.76 examples/s]
2025-06-04 19:16:37,563 - INFO - 3 datasets tokenized successfully
2025-06-04 19:16:37,564 - INFO - Starting hyperparameter search for focal loss
[36m(train_hpo pid=3431906)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3431906)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3429132)[0m 2025-06-04 19:15:24,679 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3431906)[0m 2025-06-04 19:16:45,386 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.6252016107931255 and gamma=2.6992695521978884
[36m(train_hpo pid=3431906)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3431906)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3431906)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3431906)[0m   warnings.warn(
[36m(train_hpo pid=3432138)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3432138)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3432138)[0m 2025-06-04 19:16:52,028 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.970577641092792 and gamma=4.634102840173219
[36m(train_hpo pid=3432138)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3432138)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3432138)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3432138)[0m   warnings.warn(
[36m(train_hpo pid=3432352)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3432352)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3432352)[0m 2025-06-04 19:16:58,853 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.7811204413478371 and gamma=6.807074484302038
[36m(train_hpo pid=3432352)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3432352)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3432352)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3432352)[0m   warnings.warn(
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-04_19-16-37   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-16-37
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-04_18-54-36_274448_3393636/artifacts/2025-06-04_19-16-37/train_hpo_2025-06-04_19-16-37/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-04 19:16:37. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_1069df82   PENDING    0.625202   2.69927       1.88223e-05          0.13641                    4 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_1069df82 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_1069df82 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                                0.6252 â”‚
â”‚ gamma                               2.69927 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          4 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3431906)[0m [2025-06-04 19:16:45,624] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3429132)[0m {'eval_loss': 4.765669345855713, 'eval_f1': 0.0, 'eval_recall': 0.0, 'eval_accuracy': 0.2537313432835821, 'eval_precision': 0.0, 'eval_optim_threshold': 0.433952659368515, 'eval_AP': 0.6609792348155288, 'eval_MCC': 0.0, 'eval_NDCG': 0.8036504933152075, 'eval_kappa': 0.0, 'eval_runtime': 3.3257, 'eval_samples_per_second': 20.146, 'eval_steps_per_second': 1.203, 'epoch': 3.4}
[36m(train_hpo pid=3431906)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=8, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_dc71ab26 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_dc71ab26 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.97058 â”‚
â”‚ gamma                                4.6341 â”‚
â”‚ learning_rate                         5e-05 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3432138)[0m [2025-06-04 19:16:52,416] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3431906)[0m {'loss': 0.0361, 'grad_norm': 0.24942009150981903, 'learning_rate': 1.176394468215133e-05, 'epoch': 1.0}
[36m(train_hpo pid=3432138)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_9b9b484d started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_9b9b484d config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.78112 â”‚
â”‚ gamma                               6.80707 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          2 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3431906)[0m {'loss': 0.03, 'grad_norm': 0.14144878089427948, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.0}
[36m(train_hpo pid=3432352)[0m [2025-06-04 19:16:59,073] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3432352)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=4, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3432138)[0m {'loss': 0.0097, 'grad_norm': 0.019343756139278412, 'learning_rate': 3.612785445936571e-05, 'epoch': 1.0}
[36m(train_hpo pid=3431906)[0m {'train_runtime': 16.5888, 'train_samples_per_second': 47.743, 'train_steps_per_second': 0.482, 'train_loss': 0.033472850918769836, 'epoch': 2.8}[36m(train_hpo pid=3431906)[0m 2025-06-04 19:17:09,407 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3431906)[0m 2025-06-04 19:17:09,413 - INFO - eval_result: {'eval_loss': 0.031024755910038948, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.6556690335273743, 'eval_AP': 0.9988226059654631, 'eval_MCC': 0.0, 'eval_NDCG': 0.9997955899781452, 'eval_kappa': 0.0, 'eval_runtime': 3.8707, 'eval_samples_per_second': 17.051, 'eval_steps_per_second': 1.033, 'epoch': 2.8}
2025-06-04 19:17:09,472 - INFO - Cleaning up trial 1069df82
2025-06-04 19:17:09,472 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-16-37/train_hpo_1069df82_1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364_2025-06-04_19-16-37
[36m(train_hpo pid=3431906)[0m 2025-06-04 19:17:09,447 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
2025-06-04 19:17:11,593 - INFO - Cleaning up trial 9b9b484d
2025-06-04 19:17:11,593 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-16-37/train_hpo_9b9b484d_3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512_2025-06-04_19-16-51
2025-06-04 19:17:11,594 - INFO - Current best: 1069df82 with eval_f1 : 0.8521739130434782 at iteration 1

[36m(train_hpo pid=3431906)[0m STATE at ending of training  :  TrainerState(epoch=2.8, global_step=8, max_steps=8, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=146288433303552.0, log_history=[{'loss': 0.0361, 'grad_norm': 0.24942009150981903, 'learning_rate': 1.176394468215133e-05, 'epoch': 1.0, 'step': 3}, {'loss': 0.03, 'grad_norm': 0.14144878089427948, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.0, 'step': 6}, {'loss': 0.0348, 'grad_norm': 0.5759424567222595, 'learning_rate': 0.0, 'epoch': 2.8, 'step': 8}, {'train_runtime': 16.5888, 'train_samples_per_second': 47.743, 'train_steps_per_second': 0.482, 'total_flos': 146288433303552.0, 'train_loss': 0.033472850918769836, 'epoch': 2.8, 'step': 8}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 3 RUNNING
Current time: 2025-06-04 19:17:07. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_1069df82   RUNNING    0.625202   2.69927       1.88223e-05         0.13641                     4 â”‚
â”‚ train_hpo_dc71ab26   RUNNING    0.970578   4.6341        5.16112e-05         0.123031                    5 â”‚
â”‚ train_hpo_9b9b484d   RUNNING    0.78112    6.80707       1.88581e-05         0.251217                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3432352)[0m STATE at ending of training  :  TrainerState(epoch=1.4, global_step=4, max_steps=4, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=73144216651776.0, log_history=[{'loss': 0.0022, 'grad_norm': 0.03738630935549736, 'learning_rate': 4.714527732738613e-06, 'epoch': 1.0, 'step': 3}, {'loss': 0.0025, 'grad_norm': 0.07346343994140625, 'learning_rate': 0.0, 'epoch': 1.4, 'step': 4}, {'train_runtime': 5.7961, 'train_samples_per_second': 68.322, 'train_steps_per_second': 0.69, 'total_flos': 73144216651776.0, 'train_loss': 0.002289692056365311, 'epoch': 1.4, 'step': 4}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3431906)[0m {'eval_loss': 0.031024755910038948, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.6556690335273743, 'eval_AP': 0.9988226059654631, 'eval_MCC': 0.0, 'eval_NDCG': 0.9997955899781452, 'eval_kappa': 0.0, 'eval_runtime': 3.8707, 'eval_samples_per_second': 17.051, 'eval_steps_per_second': 1.033, 'epoch': 2.8}

Trial train_hpo_1069df82 finished iteration 1 at 2025-06-04 19:17:09. Total running time: 31s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_1069df82 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    25.0645 â”‚
â”‚ time_total_s                        25.0645 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   2.8 â”‚
â”‚ eval_AP                             0.99882 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                            0.9998 â”‚
â”‚ eval_accuracy                       0.74242 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           0.03102 â”‚
â”‚ eval_optim_threshold                0.65567 â”‚
â”‚ eval_precision                      0.74242 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.8707 â”‚
â”‚ eval_samples_per_second              17.051 â”‚
â”‚ eval_steps_per_second                 1.033 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_1069df82 completed after 1 iterations at 2025-06-04 19:17:09. Total running time: 31s

Trial train_hpo_9b9b484d finished iteration 1 at 2025-06-04 19:17:11. Total running time: 33s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_9b9b484d result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    13.5912 â”‚
â”‚ time_total_s                        13.5912 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   1.4 â”‚
â”‚ eval_AP                              0.9128 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.98017 â”‚
â”‚ eval_accuracy                       0.74242 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           0.00212 â”‚
â”‚ eval_optim_threshold                0.60674 â”‚
â”‚ eval_precision                      0.74242 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.4415 â”‚
â”‚ eval_samples_per_second              19.178 â”‚
â”‚ eval_steps_per_second                 1.162 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3432138)[0m {'loss': 0.0026, 'grad_norm': 0.038126666098833084, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.0}[32m [repeated 4x across cluster][0m
[36m(train_hpo pid=3432352)[0m {'train_runtime': 5.7961, 'train_samples_per_second': 68.322, 'train_steps_per_second': 0.69, 'train_loss': 0.002289692056365311, 'epoch': 1.4}

Trial train_hpo_9b9b484d completed after 1 iterations at 2025-06-04 19:17:11. Total running time: 33s
[36m(train_hpo pid=3432138)[0m {'train_runtime': 19.4076, 'train_samples_per_second': 51.011, 'train_steps_per_second': 0.515, 'train_loss': 0.004798778239637614, 'epoch': 3.4}
[36m(train_hpo pid=3432138)[0m STATE at ending of training  :  TrainerState(epoch=3.4, global_step=10, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=177335259076608.0, log_history=[{'loss': 0.0097, 'grad_norm': 0.019343756139278412, 'learning_rate': 3.612785445936571e-05, 'epoch': 1.0, 'step': 3}, {'loss': 0.0026, 'grad_norm': 0.038126666098833084, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.0, 'step': 6}, {'loss': 0.0027, 'grad_norm': 0.010757971554994583, 'learning_rate': 5.161122065623674e-06, 'epoch': 3.0, 'step': 9}, {'loss': 0.0031, 'grad_norm': 0.0742858499288559, 'learning_rate': 0.0, 'epoch': 3.4, 'step': 10}, {'train_runtime': 19.4076, 'train_samples_per_second': 51.011, 'train_steps_per_second': 0.515, 'total_flos': 177335259076608.0, 'train_loss': 0.004798778239637614, 'epoch': 3.4, 'step': 10}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})2025-06-04 19:17:18,435 - INFO - Cleaning up trial dc71ab26
2025-06-04 19:17:18,435 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-16-37/train_hpo_dc71ab26_2_alpha=0.9706,gamma=4.6341,learning_rate=0.0001,num_train_epochs=5,weight_decay=0.1230_2025-06-04_19-16-44
2025-06-04 19:17:18,435 - INFO - Current best: 1069df82 with eval_f1 : 0.8521739130434782 at iteration 1
2025-06-04 19:17:18,435 - INFO - Current best: 9b9b484d with eval_f1 : 0.8521739130434782 at iteration 1
2025-06-04 19:17:18,443	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-16-37' in 0.0065s.
2025-06-04 19:17:18,450 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x71a3a86cd550>
2025-06-04 19:17:18,450 - INFO - Best trial : train_hpo_1069df82
2025-06-04 19:17:18,450 - INFO - Best config : {'alpha': 0.6252016107931255, 'gamma': 2.6992695521978884, 'learning_rate': 1.8822311491442127e-05, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 4}
2025-06-04 19:17:18,450 - INFO - Best trial after optimization: {'eval_loss': 0.031024755910038948, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.6556690335273743, 'eval_AP': 0.9988226059654631, 'eval_MCC': 0.0, 'eval_NDCG': 0.9997955899781452, 'eval_kappa': 0.0, 'eval_runtime': 3.8707, 'eval_samples_per_second': 17.051, 'eval_steps_per_second': 1.033, 'epoch': 2.8, 'timestamp': 1749057429, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '1069df82', 'date': '2025-06-04_19-17-09', 'time_this_iter_s': 25.06451416015625, 'time_total_s': 25.06451416015625, 'pid': 3431906, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'alpha': 0.6252016107931255, 'gamma': 2.6992695521978884, 'learning_rate': 1.8822311491442127e-05, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 4}, 'time_since_restore': 25.06451416015625, 'iterations_since_restore': 1, 'experiment_tag': '1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364'}
2025-06-04 19:17:18,474 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   0.031025  0.852174  ...                        4  1069df82
1   0.003000  0.852174  ...                        5  dc71ab26
2   0.002122  0.852174  ...                        2  9b9b484d

[3 rows x 33 columns]
[36m(train_hpo pid=3432138)[0m 2025-06-04 19:17:18,370 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3432138)[0m 2025-06-04 19:17:18,376 - INFO - eval_result: {'eval_loss': 0.0029995243530720472, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.7711384296417236, 'eval_AP': 0.9951406676030736, 'eval_MCC': 0.0, 'eval_NDCG': 0.9991396146124721, 'eval_kappa': 0.0, 'eval_runtime': 3.2724, 'eval_samples_per_second': 20.169, 'eval_steps_per_second': 1.222, 'epoch': 3.4}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3432138)[0m 2025-06-04 19:17:18,411 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB[32m [repeated 2x across cluster][0m
2025-06-04 19:17:18,663 - INFO - Trial comparison plot saved
2025-06-04 19:17:18,663 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-04 19:17:19,253 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.25 and gamma=2.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-04 19:17:19,340 - INFO - training size : 198
2025-06-04 19:17:19,340 - INFO - dev size : 66
2025-06-04 19:17:19,340 - INFO - test size : 133
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(

[36m(train_hpo pid=3432352)[0m {'eval_loss': 0.0021215800661593676, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.606737494468689, 'eval_AP': 0.9128045863371074, 'eval_MCC': 0.0, 'eval_NDCG': 0.9801740412913267, 'eval_kappa': 0.0, 'eval_runtime': 3.4415, 'eval_samples_per_second': 19.178, 'eval_steps_per_second': 1.162, 'epoch': 1.4}

Trial train_hpo_dc71ab26 finished iteration 1 at 2025-06-04 19:17:18. Total running time: 40s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_dc71ab26 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    27.2575 â”‚
â”‚ time_total_s                        27.2575 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   3.4 â”‚
â”‚ eval_AP                             0.99514 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.99914 â”‚
â”‚ eval_accuracy                       0.74242 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                             0.003 â”‚
â”‚ eval_optim_threshold                0.77114 â”‚
â”‚ eval_precision                      0.74242 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.2724 â”‚
â”‚ eval_samples_per_second              20.169 â”‚
â”‚ eval_steps_per_second                 1.222 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_dc71ab26 completed after 1 iterations at 2025-06-04 19:17:18. Total running time: 40s

Trial status: 3 TERMINATED
Current time: 2025-06-04 19:17:18. Total running time: 40s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_1069df82   TERMINATED   0.625202   2.69927       1.88223e-05         0.13641                     4        1            25.0645    0.0310248     0.852174               1          0.742424 â”‚
â”‚ train_hpo_dc71ab26   TERMINATED   0.970578   4.6341        5.16112e-05         0.123031                    5        1            27.2575    0.00299952    0.852174               1          0.742424 â”‚
â”‚ train_hpo_9b9b484d   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            13.5912    0.00212158    0.852174               1          0.742424 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

[36m(train_hpo pid=3432138)[0m {'eval_loss': 0.0029995243530720472, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.7711384296417236, 'eval_AP': 0.9951406676030736, 'eval_MCC': 0.0, 'eval_NDCG': 0.9991396146124721, 'eval_kappa': 0.0, 'eval_runtime': 3.2724, 'eval_samples_per_second': 20.169, 'eval_steps_per_second': 1.222, 'epoch': 3.4}
[36m(train_hpo pid=3432138)[0m {'loss': 0.0031, 'grad_norm': 0.0742858499288559, 'learning_rate': 0.0, 'epoch': 3.4}[32m [repeated 2x across cluster][0m
  0%|          | 0/36 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  3%|â–Ž         | 1/36 [00:00<00:23,  1.51it/s]  6%|â–Œ         | 2/36 [00:01<00:21,  1.58it/s]  8%|â–Š         | 3/36 [00:01<00:20,  1.60it/s] 11%|â–ˆ         | 4/36 [00:02<00:19,  1.61it/s] 14%|â–ˆâ–        | 5/36 [00:03<00:19,  1.62it/s] 17%|â–ˆâ–‹        | 6/36 [00:03<00:18,  1.62it/s] 19%|â–ˆâ–‰        | 7/36 [00:04<00:17,  1.62it/s] 22%|â–ˆâ–ˆâ–       | 8/36 [00:04<00:17,  1.64it/s] 25%|â–ˆâ–ˆâ–Œ       | 9/36 [00:05<00:14,  1.92it/s]                                               25%|â–ˆâ–ˆâ–Œ       | 9/36 [00:05<00:14,  1.92it/s] 28%|â–ˆâ–ˆâ–Š       | 10/36 [00:05<00:14,  1.80it/s] 31%|â–ˆâ–ˆâ–ˆ       | 11/36 [00:06<00:14,  1.74it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 12/36 [00:07<00:14,  1.71it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 13/36 [00:07<00:13,  1.68it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 14/36 [00:08<00:13,  1.67it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 15/36 [00:08<00:12,  1.65it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 16/36 [00:09<00:12,  1.64it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 17/36 [00:10<00:11,  1.65it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 18/36 [00:10<00:09,  1.92it/s]                                                50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 18/36 [00:10<00:09,  1.92it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 19/36 [00:11<00:09,  1.80it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 20/36 [00:11<00:09,  1.74it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 21/36 [00:12<00:08,  1.71it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 22/36 [00:12<00:08,  1.68it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 23/36 [00:13<00:07,  1.66it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 24/36 [00:14<00:07,  1.65it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 25/36 [00:14<00:06,  1.64it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 26/36 [00:15<00:06,  1.65it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 27/36 [00:15<00:04,  1.92it/s]                                                75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 27/36 [00:15<00:04,  1.92it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 28/36 [00:16<00:04,  1.80it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 29/36 [00:17<00:04,  1.75it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 30/36 [00:17<00:03,  1.71it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 31/36 [00:18<00:02,  1.68it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 32/36 [00:18<00:02,  1.66it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 33/36 [00:19<00:01,  1.65it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 34/36 [00:20<00:01,  1.65it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 35/36 [00:20<00:00,  1.65it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [00:21<00:00,  1.92it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [00:22<00:00,  1.92it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [00:22<00:00,  1.92it/s]2025-06-04 19:17:42,438 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [00:22<00:00,  1.59it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
{'loss': 0.0423, 'grad_norm': 1.6630369424819946, 'learning_rate': 1.4116733618581595e-05, 'epoch': 1.0}
{'loss': 0.0247, 'grad_norm': 0.4765987992286682, 'learning_rate': 9.411155745721064e-06, 'epoch': 2.0}
{'loss': 0.0136, 'grad_norm': 0.29383227229118347, 'learning_rate': 4.705577872860532e-06, 'epoch': 3.0}
{'loss': 0.0095, 'grad_norm': 0.1410416215658188, 'learning_rate': 0.0, 'epoch': 4.0}
{'train_runtime': 22.6444, 'train_samples_per_second': 34.976, 'train_steps_per_second': 1.59, 'train_loss': 0.022544786540998354, 'epoch': 4.0}
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.30it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.66it/s]2025-06-04 19:17:46,110 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.12s/it]
2025-06-04 19:17:46,116 - INFO - Training time : 27.452842694940045
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.13it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.03it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.36it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.10it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.26it/s]2025-06-04 19:17:50,592 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.44it/s]
2025-06-04 19:17:50,596 - INFO - Evaluation time : 4.480291974032298
2025-06-04 19:17:50,596 - INFO - Evaluation results on test set: {'eval_loss': 0.008098505437374115, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.7129175066947937, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000004, 'eval_kappa': 1.0, 'eval_runtime': 4.4756, 'eval_samples_per_second': 29.717, 'eval_steps_per_second': 1.341, 'epoch': 4.0}
2025-06-04 19:17:50,596 - INFO - Total updates (optimizer steps): 36
2025-06-04 19:17:50,596 - INFO - Avg time / step: 0.629s
2025-06-04 19:17:51,065 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_focaldmis-lab/biobert-v1.13trials_fold-1
2025-06-04 19:17:51,065 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.21it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.08it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.39it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.13it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.29it/s]2025-06-04 19:17:55,611 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.41it/s]
2025-06-04 19:17:55,615 - INFO - preds : [1 1 1 0 0 1 1 1 1 1 1 1 0 0 1 0 1 0 1 1 1 0 1 1 0 0 0 0 0 0 0 1 1 1 1 1 1
 1 1 1 0 1 1 0 0 1 1 1 1 1 1 1 1 0 0 1 1 1 1 0 1 1 1 1 1 0 1 1 0 1 1 1 1 1
 0 1 0 1 0 0 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 0 0 1 0 1 1 1
 1 0 0 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 0]
2025-06-04 19:17:55,616 - INFO - test_split["labels"] : [1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0]
2025-06-04 19:17:55,618 - INFO - Confusion matrix: TN=35, FP=0, FN=0, TP=98
2025-06-04 19:17:58,373 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 35, 'FP': 0, 'FN': 0, 'TP': 98}
2025-06-04 19:17:58,492 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-04 19:17:58,589 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:17:58,589 - INFO - 
On test Set (optimal threshold of 0.5565723776817322 according to cross validation on the training set): 
2025-06-04 19:17:58,591 - INFO - Confusion matrix: TN=35, FP=0, FN=0, TP=98
2025-06-04 19:18:01,373 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 35, 'FP': 0, 'FN': 0, 'TP': 98}
2025-06-04 19:18:01,472 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:18:01,472 - INFO - Results for fold 1 : [{'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 35, 'FP': 0, 'FN': 0, 'TP': 98}]
2025-06-04 19:18:01,600 - INFO - Cleared CUDA cache. Memory allocated: 1.38 GB, Memory reserved: 1.76 GB
2025-06-04 19:18:01,600 - INFO - 
fold number 2 / 3
2025-06-04 19:18:01,606 - INFO - train split size : 198
2025-06-04 19:18:01,606 - INFO - dev split size : 67
2025-06-04 19:18:01,606 - INFO - test split size : 132
Map (num_proc=32):   0%|          | 0/198 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–Ž         | 7/198 [00:00<00:05, 37.69 examples/s]Map (num_proc=32):  24%|â–ˆâ–ˆâ–       | 48/198 [00:00<00:00, 188.27 examples/s]Map (num_proc=32):  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 84/198 [00:00<00:00, 237.87 examples/s]Map (num_proc=32):  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 120/198 [00:00<00:00, 265.00 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 156/198 [00:00<00:00, 284.70 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 192/198 [00:00<00:00, 302.04 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 198/198 [00:00<00:00, 220.58 examples/s]
Map (num_proc=32):   0%|          | 0/67 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/67 [00:00<00:03, 19.27 examples/s]Map (num_proc=32):  22%|â–ˆâ–ˆâ–       | 15/67 [00:00<00:00, 66.46 examples/s]Map (num_proc=32):  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 29/67 [00:00<00:00, 88.47 examples/s]Map (num_proc=32):  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 41/67 [00:00<00:00, 98.48 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 53/67 [00:00<00:00, 104.29 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 65/67 [00:00<00:00, 105.22 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:00<00:00, 81.26 examples/s] 
Map (num_proc=32):   0%|          | 0/132 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/132 [00:00<00:04, 30.41 examples/s]Map (num_proc=32):  24%|â–ˆâ–ˆâ–       | 32/132 [00:00<00:00, 135.36 examples/s]Map (num_proc=32):  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 56/132 [00:00<00:00, 171.47 examples/s]Map (num_proc=32):  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 76/132 [00:00<00:00, 179.52 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 104/132 [00:00<00:00, 198.96 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 132/132 [00:00<00:00, 214.44 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 132/132 [00:00<00:00, 155.72 examples/s]
2025-06-04 19:18:10,127 - INFO - 3 datasets tokenized successfully
2025-06-04 19:18:10,129 - INFO - Starting hyperparameter search for focal loss
[36m(train_hpo pid=3434563)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3434563)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3434563)[0m 2025-06-04 19:18:18,049 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.6252016107931255 and gamma=2.6992695521978884
[36m(train_hpo pid=3434563)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3434563)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3434563)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3434563)[0m   warnings.warn(
[36m(train_hpo pid=3434725)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3434725)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3434725)[0m 2025-06-04 19:18:24,818 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.970577641092792 and gamma=4.634102840173219
[36m(train_hpo pid=3434725)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3434725)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3434725)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3434725)[0m   warnings.warn(
[36m(train_hpo pid=3434963)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3434963)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3434963)[0m 2025-06-04 19:18:32,819 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.7811204413478371 and gamma=6.807074484302038
[36m(train_hpo pid=3434963)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3434963)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3434963)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3434963)[0m   warnings.warn(
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-04_19-18-10   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-18-10
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-04_18-54-36_274448_3393636/artifacts/2025-06-04_19-18-10/train_hpo_2025-06-04_19-18-10/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-04 19:18:10. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_cc7917ab   PENDING    0.625202   2.69927       1.88223e-05          0.13641                    4 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_cc7917ab started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_cc7917ab config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                                0.6252 â”‚
â”‚ gamma                               2.69927 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          4 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3434563)[0m [2025-06-04 19:18:18,289] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3434563)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=8, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_48c6940b started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_48c6940b config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.97058 â”‚
â”‚ gamma                                4.6341 â”‚
â”‚ learning_rate                         5e-05 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3434725)[0m [2025-06-04 19:18:25,222] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3434563)[0m {'loss': 0.0366, 'grad_norm': 0.20528267323970795, 'learning_rate': 1.176394468215133e-05, 'epoch': 1.0}
[36m(train_hpo pid=3434725)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_8041a90a started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_8041a90a config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.78112 â”‚
â”‚ gamma                               6.80707 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          2 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3434563)[0m {'loss': 0.0318, 'grad_norm': 0.13290543854236603, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.0}
[36m(train_hpo pid=3434963)[0m [2025-06-04 19:18:33,050] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3434963)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=4, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3434725)[0m {'loss': 0.0146, 'grad_norm': 0.014530930668115616, 'learning_rate': 3.612785445936571e-05, 'epoch': 1.0}
[36m(train_hpo pid=3434563)[0m {'train_runtime': 16.3937, 'train_samples_per_second': 48.311, 'train_steps_per_second': 0.488, 'train_loss': 0.03564662765711546, 'epoch': 2.8}
[36m(train_hpo pid=3434563)[0m STATE at ending of training  :  TrainerState(epoch=2.8, global_step=8, max_steps=8, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=146288433303552.0, log_history=[{'loss': 0.0366, 'grad_norm': 0.20528267323970795, 'learning_rate': 1.176394468215133e-05, 'epoch': 1.0, 'step': 3}, {'loss': 0.0318, 'grad_norm': 0.13290543854236603, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.0, 'step': 6}, {'loss': 0.04, 'grad_norm': 0.5575705766677856, 'learning_rate': 0.0, 'epoch': 2.8, 'step': 8}, {'train_runtime': 16.3937, 'train_samples_per_second': 48.311, 'train_steps_per_second': 0.488, 'total_flos': 146288433303552.0, 'train_loss': 0.03564662765711546, 'epoch': 2.8, 'step': 8}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})2025-06-04 19:18:41,963 - INFO - Cleaning up trial cc7917ab
2025-06-04 19:18:41,963 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-18-10/train_hpo_cc7917ab_1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364_2025-06-04_19-18-10
[36m(train_hpo pid=3434563)[0m 2025-06-04 19:18:41,896 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3434563)[0m 2025-06-04 19:18:41,902 - INFO - eval_result: {'eval_loss': 0.03670252487063408, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.6400085091590881, 'eval_AP': 0.9864199298857816, 'eval_MCC': 0.0, 'eval_NDCG': 0.9975360919735883, 'eval_kappa': 0.0, 'eval_runtime': 3.9085, 'eval_samples_per_second': 17.142, 'eval_steps_per_second': 1.023, 'epoch': 2.8}
[36m(train_hpo pid=3434563)[0m 2025-06-04 19:18:41,938 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
2025-06-04 19:18:45,827 - INFO - Cleaning up trial 8041a90a
2025-06-04 19:18:45,827 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-18-10/train_hpo_8041a90a_3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512_2025-06-04_19-18-23
2025-06-04 19:18:45,827 - INFO - Cleaning up trial cc7917ab
2025-06-04 19:18:45,827 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-18-10/train_hpo_cc7917ab_1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364_2025-06-04_19-18-10


Trial status: 3 RUNNING
Current time: 2025-06-04 19:18:40. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_cc7917ab   RUNNING    0.625202   2.69927       1.88223e-05         0.13641                     4 â”‚
â”‚ train_hpo_48c6940b   RUNNING    0.970578   4.6341        5.16112e-05         0.123031                    5 â”‚
â”‚ train_hpo_8041a90a   RUNNING    0.78112    6.80707       1.88581e-05         0.251217                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_cc7917ab finished iteration 1 at 2025-06-04 19:18:41. Total running time: 31s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_cc7917ab result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    24.8466 â”‚
â”‚ time_total_s                        24.8466 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   2.8 â”‚
â”‚ eval_AP                             0.98642 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.99754 â”‚
â”‚ eval_accuracy                       0.73134 â”‚
â”‚ eval_f1                             0.84483 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                            0.0367 â”‚
â”‚ eval_optim_threshold                0.64001 â”‚
â”‚ eval_precision                      0.73134 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.9085 â”‚
â”‚ eval_samples_per_second              17.142 â”‚
â”‚ eval_steps_per_second                 1.023 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_cc7917ab completed after 1 iterations at 2025-06-04 19:18:41. Total running time: 31s
[36m(train_hpo pid=3434563)[0m {'eval_loss': 0.03670252487063408, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.6400085091590881, 'eval_AP': 0.9864199298857816, 'eval_MCC': 0.0, 'eval_NDCG': 0.9975360919735883, 'eval_kappa': 0.0, 'eval_runtime': 3.9085, 'eval_samples_per_second': 17.142, 'eval_steps_per_second': 1.023, 'epoch': 2.8}
[36m(train_hpo pid=3434963)[0m STATE at ending of training  :  TrainerState(epoch=1.4, global_step=4, max_steps=4, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=73144216651776.0, log_history=[{'loss': 0.0049, 'grad_norm': 0.03826461359858513, 'learning_rate': 4.714527732738613e-06, 'epoch': 1.0, 'step': 3}, {'loss': 0.0019, 'grad_norm': 0.0372643917798996, 'learning_rate': 0.0, 'epoch': 1.4, 'step': 4}, {'train_runtime': 5.8006, 'train_samples_per_second': 68.269, 'train_steps_per_second': 0.69, 'total_flos': 73144216651776.0, 'train_loss': 0.004140423989156261, 'epoch': 1.4, 'step': 4}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3434725)[0m {'loss': 0.0023, 'grad_norm': 0.03712719678878784, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.0}[32m [repeated 4x across cluster][0m
[36m(train_hpo pid=3434963)[0m {'train_runtime': 5.8006, 'train_samples_per_second': 68.269, 'train_steps_per_second': 0.69, 'train_loss': 0.004140423989156261, 'epoch': 1.4}

Trial train_hpo_8041a90a finished iteration 1 at 2025-06-04 19:18:45. Total running time: 35s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_8041a90a result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    15.0049 â”‚
â”‚ time_total_s                        15.0049 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   1.4 â”‚
â”‚ eval_AP                             0.98953 â”‚
â”‚ eval_MCC                            0.20309 â”‚
â”‚ eval_NDCG                           0.99809 â”‚
â”‚ eval_accuracy                       0.74627 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                          0.07922 â”‚
â”‚ eval_loss                           0.00149 â”‚
â”‚ eval_optim_threshold                0.55877 â”‚
â”‚ eval_precision                      0.74242 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.6685 â”‚
â”‚ eval_samples_per_second              18.264 â”‚
â”‚ eval_steps_per_second                  1.09 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_8041a90a completed after 1 iterations at 2025-06-04 19:18:45. Total running time: 35s
[36m(train_hpo pid=3434725)[0m {'train_runtime': 19.2527, 'train_samples_per_second': 51.421, 'train_steps_per_second': 0.519, 'train_loss': 0.006057319510728121, 'epoch': 3.4}
[36m(train_hpo pid=3434725)[0m STATE at ending of training  :  TrainerState(epoch=3.4, global_step=10, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=177335259076608.0, log_history=[{'loss': 0.0146, 'grad_norm': 0.014530930668115616, 'learning_rate': 3.612785445936571e-05, 'epoch': 1.0, 'step': 3}, {'loss': 0.0023, 'grad_norm': 0.03712719678878784, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.0, 'step': 6}, {'loss': 0.0024, 'grad_norm': 0.012951127253472805, 'learning_rate': 5.161122065623674e-06, 'epoch': 3.0, 'step': 9}, {'loss': 0.0025, 'grad_norm': 0.07550382614135742, 'learning_rate': 0.0, 'epoch': 3.4, 'step': 10}, {'train_runtime': 19.2527, 'train_samples_per_second': 51.421, 'train_steps_per_second': 0.519, 'total_flos': 177335259076608.0, 'train_loss': 0.006057319510728121, 'epoch': 3.4, 'step': 10}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3434963)[0m {'eval_loss': 0.0014886392746120691, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.5587723851203918, 'eval_AP': 0.9895256403764352, 'eval_MCC': 0.2030905986149808, 'eval_NDCG': 0.9980949689794106, 'eval_kappa': 0.0792239288601454, 'eval_runtime': 3.6685, 'eval_samples_per_second': 18.264, 'eval_steps_per_second': 1.09, 'epoch': 1.4}2025-06-04 19:18:51,120 - INFO - Cleaning up trial 48c6940b
2025-06-04 19:18:51,120 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-18-10/train_hpo_48c6940b_2_alpha=0.9706,gamma=4.6341,learning_rate=0.0001,num_train_epochs=5,weight_decay=0.1230_2025-06-04_19-18-17
2025-06-04 19:18:51,121 - INFO - Cleaning up trial cc7917ab
2025-06-04 19:18:51,121 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-18-10/train_hpo_cc7917ab_1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364_2025-06-04_19-18-10
2025-06-04 19:18:51,121 - INFO - Current best: 8041a90a with eval_f1 : 0.8521739130434782 at iteration 1
2025-06-04 19:18:51,128	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-18-10' in 0.0053s.
[36m(train_hpo pid=3434725)[0m 2025-06-04 19:18:51,048 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3434725)[0m 2025-06-04 19:18:51,054 - INFO - eval_result: {'eval_loss': 0.002562972716987133, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.7701024413108826, 'eval_AP': 1.0, 'eval_MCC': 0.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 0.0, 'eval_runtime': 3.308, 'eval_samples_per_second': 20.254, 'eval_steps_per_second': 1.209, 'epoch': 3.4}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3434725)[0m 2025-06-04 19:18:51,097 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB[32m [repeated 2x across cluster][0m
2025-06-04 19:18:51,135 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x71a43becd550>
2025-06-04 19:18:51,136 - INFO - Best trial : train_hpo_8041a90a
2025-06-04 19:18:51,136 - INFO - Best config : {'alpha': 0.7811204413478371, 'gamma': 6.807074484302038, 'learning_rate': 1.8858110930954453e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 2}
2025-06-04 19:18:51,136 - INFO - Best trial after optimization: {'eval_loss': 0.0014886392746120691, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.5587723851203918, 'eval_AP': 0.9895256403764352, 'eval_MCC': 0.2030905986149808, 'eval_NDCG': 0.9980949689794106, 'eval_kappa': 0.0792239288601454, 'eval_runtime': 3.6685, 'eval_samples_per_second': 18.264, 'eval_steps_per_second': 1.09, 'epoch': 1.4, 'timestamp': 1749057525, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '8041a90a', 'date': '2025-06-04_19-18-45', 'time_this_iter_s': 15.004881620407104, 'time_total_s': 15.004881620407104, 'pid': 3434963, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'alpha': 0.7811204413478371, 'gamma': 6.807074484302038, 'learning_rate': 1.8858110930954453e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 2}, 'time_since_restore': 15.004881620407104, 'iterations_since_restore': 1, 'experiment_tag': '3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512'}
2025-06-04 19:18:51,163 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   0.036703  0.844828  ...                        4  cc7917ab
1   0.002563  0.844828  ...                        5  48c6940b
2   0.001489  0.852174  ...                        2  8041a90a

[3 rows x 33 columns]
2025-06-04 19:18:51,306 - INFO - Trial comparison plot saved
2025-06-04 19:18:51,307 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-04 19:18:51,883 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.25 and gamma=2.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-04 19:18:51,973 - INFO - training size : 198
2025-06-04 19:18:51,974 - INFO - dev size : 67
2025-06-04 19:18:51,974 - INFO - test size : 132
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(


Trial train_hpo_48c6940b finished iteration 1 at 2025-06-04 19:18:51. Total running time: 40s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_48c6940b result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    27.1376 â”‚
â”‚ time_total_s                        27.1376 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   3.4 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                       0.73134 â”‚
â”‚ eval_f1                             0.84483 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           0.00256 â”‚
â”‚ eval_optim_threshold                 0.7701 â”‚
â”‚ eval_precision                      0.73134 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                          3.308 â”‚
â”‚ eval_samples_per_second              20.254 â”‚
â”‚ eval_steps_per_second                 1.209 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_48c6940b completed after 1 iterations at 2025-06-04 19:18:51. Total running time: 40s

Trial status: 3 TERMINATED
Current time: 2025-06-04 19:18:51. Total running time: 40s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_cc7917ab   TERMINATED   0.625202   2.69927       1.88223e-05         0.13641                     4        1            24.8466    0.0367025     0.844828               1          0.731343 â”‚
â”‚ train_hpo_48c6940b   TERMINATED   0.970578   4.6341        5.16112e-05         0.123031                    5        1            27.1376    0.00256297    0.844828               1          0.731343 â”‚
â”‚ train_hpo_8041a90a   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            15.0049    0.00148864    0.852174               1          0.746269 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

[36m(train_hpo pid=3434725)[0m {'eval_loss': 0.002562972716987133, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.7701024413108826, 'eval_AP': 1.0, 'eval_MCC': 0.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 0.0, 'eval_runtime': 3.308, 'eval_samples_per_second': 20.254, 'eval_steps_per_second': 1.209, 'epoch': 3.4}
[36m(train_hpo pid=3434725)[0m {'loss': 0.0025, 'grad_norm': 0.07550382614135742, 'learning_rate': 0.0, 'epoch': 3.4}[32m [repeated 2x across cluster][0m
  0%|          | 0/18 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  6%|â–Œ         | 1/18 [00:00<00:11,  1.53it/s] 11%|â–ˆ         | 2/18 [00:01<00:10,  1.58it/s] 17%|â–ˆâ–‹        | 3/18 [00:01<00:09,  1.60it/s] 22%|â–ˆâ–ˆâ–       | 4/18 [00:02<00:08,  1.61it/s] 28%|â–ˆâ–ˆâ–Š       | 5/18 [00:03<00:08,  1.61it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 6/18 [00:03<00:07,  1.62it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 7/18 [00:04<00:06,  1.62it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 8/18 [00:04<00:06,  1.64it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 9/18 [00:05<00:04,  1.92it/s]                                               50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 9/18 [00:05<00:04,  1.92it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 10/18 [00:05<00:04,  1.80it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 11/18 [00:06<00:04,  1.74it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 12/18 [00:07<00:03,  1.71it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 13/18 [00:07<00:02,  1.68it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 14/18 [00:08<00:02,  1.66it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 15/18 [00:08<00:01,  1.65it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 16/18 [00:09<00:01,  1.64it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 17/18 [00:10<00:00,  1.65it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 18/18 [00:10<00:00,  1.92it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 18/18 [00:12<00:00,  1.92it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 18/18 [00:12<00:00,  1.92it/s]2025-06-04 19:19:04,642 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 18/18 [00:12<00:00,  1.47it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
{'loss': 0.0021, 'grad_norm': 0.12164751440286636, 'learning_rate': 9.429055465477227e-06, 'epoch': 1.0}
{'loss': 0.0009, 'grad_norm': 0.043151069432497025, 'learning_rate': 0.0, 'epoch': 2.0}
{'train_runtime': 12.2114, 'train_samples_per_second': 32.429, 'train_steps_per_second': 1.474, 'train_loss': 0.0015205274232559735, 'epoch': 2.0}
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.29it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.46it/s]2025-06-04 19:19:08,224 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.09s/it]
2025-06-04 19:19:08,230 - INFO - Training time : 16.923023166134953
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.21it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.09it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.40it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.14it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.37it/s]2025-06-04 19:19:12,613 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.47it/s]
2025-06-04 19:19:12,618 - INFO - Evaluation time : 4.388680665986612
2025-06-04 19:19:12,618 - INFO - Evaluation results on test set: {'eval_loss': 0.0006970625254325569, 'eval_f1': 0.8558951965065502, 'eval_recall': 1.0, 'eval_accuracy': 0.75, 'eval_precision': 0.7480916030534351, 'eval_optim_threshold': 0.566699206829071, 'eval_AP': 0.9991417127598704, 'eval_MCC': 0.14833305163534516, 'eval_NDCG': 0.999864170469979, 'eval_kappa': 0.04305799648506148, 'eval_runtime': 4.3844, 'eval_samples_per_second': 30.107, 'eval_steps_per_second': 1.368, 'epoch': 2.0}
2025-06-04 19:19:12,618 - INFO - Total updates (optimizer steps): 18
2025-06-04 19:19:12,618 - INFO - Avg time / step: 0.678s
2025-06-04 19:19:13,103 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_focaldmis-lab/biobert-v1.13trials_fold-2
2025-06-04 19:19:13,103 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.21it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.07it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.40it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.14it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.37it/s]2025-06-04 19:19:17,566 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.44it/s]
2025-06-04 19:19:17,570 - INFO - preds : [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
2025-06-04 19:19:17,571 - INFO - test_split["labels"] : [1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1]
2025-06-04 19:19:17,572 - INFO - Confusion matrix: TN=1, FP=33, FN=0, TP=98
2025-06-04 19:19:20,344 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.75, 'AP': 0.9991417127598704, 'MCC': 0.14833305163534516, 'NDCG': 0.999864170469979, 'kappa': 0.04305799648506148, 'TN': 1, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:19:20,462 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-04 19:19:20,565 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:19:20,565 - INFO - 
On test Set (optimal threshold of 0.6125385761260986 according to cross validation on the training set): 
2025-06-04 19:19:20,567 - INFO - Confusion matrix: TN=34, FP=0, FN=10, TP=88
2025-06-04 19:19:23,427 - INFO - Metrics: {'f1': 0.946236559139785, 'recall': 0.8979591836734694, 'precision': 1.0, 'accuracy': 0.9242424242424242, 'AP': 0.9991417127598704, 'MCC': 0.8329931278350429, 'NDCG': 0.999864170469979, 'kappa': 0.8192771084337349, 'TN': 34, 'FP': 0, 'FN': 10, 'TP': 88}
2025-06-04 19:19:23,530 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:19:23,530 - INFO - Results for fold 2 : [{'f1': 0.946236559139785, 'recall': 0.8979591836734694, 'precision': 1.0, 'accuracy': 0.9242424242424242, 'AP': 0.9991417127598704, 'MCC': 0.8329931278350429, 'NDCG': 0.999864170469979, 'kappa': 0.8192771084337349, 'TN': 34, 'FP': 0, 'FN': 10, 'TP': 88}]
2025-06-04 19:19:23,648 - INFO - Cleared CUDA cache. Memory allocated: 1.40 GB, Memory reserved: 1.90 GB
2025-06-04 19:19:23,648 - INFO - 
fold number 3 / 3
2025-06-04 19:19:23,654 - INFO - train split size : 198
2025-06-04 19:19:23,654 - INFO - dev split size : 67
2025-06-04 19:19:23,654 - INFO - test split size : 132
Map (num_proc=32):   0%|          | 0/198 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–Ž         | 7/198 [00:00<00:04, 39.78 examples/s]Map (num_proc=32):  27%|â–ˆâ–ˆâ–‹       | 54/198 [00:00<00:00, 211.77 examples/s]Map (num_proc=32):  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 84/198 [00:00<00:00, 241.93 examples/s]Map (num_proc=32):  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 120/198 [00:00<00:00, 276.60 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 156/198 [00:00<00:00, 288.61 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 198/198 [00:00<00:00, 314.49 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 198/198 [00:00<00:00, 227.79 examples/s]
Map (num_proc=32):   0%|          | 0/67 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/67 [00:00<00:03, 17.96 examples/s]Map (num_proc=32):  25%|â–ˆâ–ˆâ–Œ       | 17/67 [00:00<00:00, 68.15 examples/s]Map (num_proc=32):  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 27/67 [00:00<00:00, 80.03 examples/s]Map (num_proc=32):  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 39/67 [00:00<00:00, 88.99 examples/s]Map (num_proc=32):  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 51/67 [00:00<00:00, 91.79 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 65/67 [00:00<00:00, 103.74 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:00<00:00, 75.80 examples/s] 
Map (num_proc=32):   0%|          | 0/132 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/132 [00:00<00:04, 29.86 examples/s]Map (num_proc=32):  24%|â–ˆâ–ˆâ–       | 32/132 [00:00<00:00, 137.10 examples/s]Map (num_proc=32):  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 56/132 [00:00<00:00, 172.55 examples/s]Map (num_proc=32):  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 80/132 [00:00<00:00, 191.79 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 104/132 [00:00<00:00, 206.73 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 128/132 [00:00<00:00, 208.01 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 132/132 [00:00<00:00, 154.43 examples/s]
2025-06-04 19:19:31,954 - INFO - 3 datasets tokenized successfully
2025-06-04 19:19:31,956 - INFO - Starting hyperparameter search for focal loss
[36m(train_hpo pid=3436882)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3436882)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3436882)[0m 2025-06-04 19:19:39,719 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.6252016107931255 and gamma=2.6992695521978884
[36m(train_hpo pid=3436882)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3436882)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3436882)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3436882)[0m   warnings.warn(
[36m(train_hpo pid=3437044)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3437044)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3437044)[0m 2025-06-04 19:19:46,535 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.970577641092792 and gamma=4.634102840173219
[36m(train_hpo pid=3437044)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3437044)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3437044)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3437044)[0m   warnings.warn(
[36m(train_hpo pid=3437280)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3437280)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3437280)[0m 2025-06-04 19:19:53,371 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.7811204413478371 and gamma=6.807074484302038
[36m(train_hpo pid=3437280)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3437280)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3437280)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3437280)[0m   warnings.warn(
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-04_19-19-32   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-19-32
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-04_18-54-36_274448_3393636/artifacts/2025-06-04_19-19-32/train_hpo_2025-06-04_19-19-32/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-04 19:19:32. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_b943afd6   PENDING    0.625202   2.69927       1.88223e-05          0.13641                    4 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_b943afd6 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_b943afd6 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                                0.6252 â”‚
â”‚ gamma                               2.69927 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          4 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3436882)[0m [2025-06-04 19:19:39,958] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3436882)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=8, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_bf06f6df started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_bf06f6df config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.97058 â”‚
â”‚ gamma                                4.6341 â”‚
â”‚ learning_rate                         5e-05 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3437044)[0m [2025-06-04 19:19:46,887] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3436882)[0m {'loss': 0.0612, 'grad_norm': 0.44435039162635803, 'learning_rate': 1.176394468215133e-05, 'epoch': 1.0}
[36m(train_hpo pid=3437044)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_89ffbcaf started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_89ffbcaf config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.78112 â”‚
â”‚ gamma                               6.80707 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          2 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3436882)[0m {'loss': 0.0363, 'grad_norm': 0.11729301512241364, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.0}
[36m(train_hpo pid=3437280)[0m [2025-06-04 19:19:53,600] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3437280)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=4, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3437044)[0m {'loss': 0.0059, 'grad_norm': 0.033619482070207596, 'learning_rate': 3.612785445936571e-05, 'epoch': 1.0}
[36m(train_hpo pid=3436882)[0m {'train_runtime': 16.3524, 'train_samples_per_second': 48.433, 'train_steps_per_second': 0.489, 'train_loss': 0.0474637420848012, 'epoch': 2.8}
[36m(train_hpo pid=3436882)[0m STATE at ending of training  :  TrainerState(epoch=2.8, global_step=8, max_steps=8, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=146288433303552.0, log_history=[{'loss': 0.0612, 'grad_norm': 0.44435039162635803, 'learning_rate': 1.176394468215133e-05, 'epoch': 1.0, 'step': 3}, {'loss': 0.0363, 'grad_norm': 0.11729301512241364, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.0, 'step': 6}, {'loss': 0.0436, 'grad_norm': 0.36862611770629883, 'learning_rate': 0.0, 'epoch': 2.8, 'step': 8}, {'train_runtime': 16.3524, 'train_samples_per_second': 48.433, 'train_steps_per_second': 0.489, 'total_flos': 146288433303552.0, 'train_loss': 0.0474637420848012, 'epoch': 2.8, 'step': 8}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})2025-06-04 19:20:03,512 - INFO - Cleaning up trial b943afd6
2025-06-04 19:20:03,512 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-19-32/train_hpo_b943afd6_1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364_2025-06-04_19-19-32
[36m(train_hpo pid=3436882)[0m 2025-06-04 19:20:03,449 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3436882)[0m 2025-06-04 19:20:03,454 - INFO - eval_result: {'eval_loss': 0.037179362028837204, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.6169906854629517, 'eval_AP': 0.9788377828812944, 'eval_MCC': 0.0, 'eval_NDCG': 0.9959619902290893, 'eval_kappa': 0.0, 'eval_runtime': 3.8577, 'eval_samples_per_second': 17.368, 'eval_steps_per_second': 1.037, 'epoch': 2.8}
[36m(train_hpo pid=3436882)[0m 2025-06-04 19:20:03,488 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
2025-06-04 19:20:06,114 - INFO - Cleaning up trial 89ffbcaf
2025-06-04 19:20:06,114 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-19-32/train_hpo_89ffbcaf_3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512_2025-06-04_19-19-45
2025-06-04 19:20:06,114 - INFO - Cleaning up trial b943afd6
2025-06-04 19:20:06,114 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-19-32/train_hpo_b943afd6_1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364_2025-06-04_19-19-32


Trial status: 3 RUNNING
Current time: 2025-06-04 19:20:02. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_b943afd6   RUNNING    0.625202   2.69927       1.88223e-05         0.13641                     4 â”‚
â”‚ train_hpo_bf06f6df   RUNNING    0.970578   4.6341        5.16112e-05         0.123031                    5 â”‚
â”‚ train_hpo_89ffbcaf   RUNNING    0.78112    6.80707       1.88581e-05         0.251217                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3437280)[0m STATE at ending of training  :  TrainerState(epoch=1.4, global_step=4, max_steps=4, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=73144216651776.0, log_history=[{'loss': 0.0135, 'grad_norm': 0.2011520266532898, 'learning_rate': 4.714527732738613e-06, 'epoch': 1.0, 'step': 3}, {'loss': 0.0042, 'grad_norm': 0.26887398958206177, 'learning_rate': 0.0, 'epoch': 1.4, 'step': 4}, {'train_runtime': 5.791, 'train_samples_per_second': 68.382, 'train_steps_per_second': 0.691, 'total_flos': 73144216651776.0, 'train_loss': 0.011186917894519866, 'epoch': 1.4, 'step': 4}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_b943afd6 finished iteration 1 at 2025-06-04 19:20:03. Total running time: 31s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_b943afd6 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    24.6462 â”‚
â”‚ time_total_s                        24.6462 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   2.8 â”‚
â”‚ eval_AP                             0.97884 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.99596 â”‚
â”‚ eval_accuracy                       0.74627 â”‚
â”‚ eval_f1                              0.8547 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           0.03718 â”‚
â”‚ eval_optim_threshold                0.61699 â”‚
â”‚ eval_precision                      0.74627 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.8577 â”‚
â”‚ eval_samples_per_second              17.368 â”‚
â”‚ eval_steps_per_second                 1.037 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_b943afd6 completed after 1 iterations at 2025-06-04 19:20:03. Total running time: 31s
[36m(train_hpo pid=3436882)[0m {'eval_loss': 0.037179362028837204, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.6169906854629517, 'eval_AP': 0.9788377828812944, 'eval_MCC': 0.0, 'eval_NDCG': 0.9959619902290893, 'eval_kappa': 0.0, 'eval_runtime': 3.8577, 'eval_samples_per_second': 17.368, 'eval_steps_per_second': 1.037, 'epoch': 2.8}

Trial train_hpo_89ffbcaf finished iteration 1 at 2025-06-04 19:20:06. Total running time: 34s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_89ffbcaf result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    13.5821 â”‚
â”‚ time_total_s                        13.5821 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   1.4 â”‚
â”‚ eval_AP                             0.97227 â”‚
â”‚ eval_MCC                            0.70896 â”‚
â”‚ eval_NDCG                           0.99473 â”‚
â”‚ eval_accuracy                       0.86567 â”‚
â”‚ eval_f1                             0.90323 â”‚
â”‚ eval_kappa                          0.68773 â”‚
â”‚ eval_loss                           0.00289 â”‚
â”‚ eval_optim_threshold                0.50179 â”‚
â”‚ eval_precision                      0.97674 â”‚
â”‚ eval_recall                            0.84 â”‚
â”‚ eval_runtime                         3.4048 â”‚
â”‚ eval_samples_per_second              19.678 â”‚
â”‚ eval_steps_per_second                 1.175 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_89ffbcaf completed after 1 iterations at 2025-06-04 19:20:06. Total running time: 34s
[36m(train_hpo pid=3437044)[0m {'loss': 0.0031, 'grad_norm': 0.03742876276373863, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.0}[32m [repeated 4x across cluster][0m
[36m(train_hpo pid=3437280)[0m {'train_runtime': 5.791, 'train_samples_per_second': 68.382, 'train_steps_per_second': 0.691, 'train_loss': 0.011186917894519866, 'epoch': 1.4}
[36m(train_hpo pid=3437044)[0m {'train_runtime': 19.2034, 'train_samples_per_second': 51.553, 'train_steps_per_second': 0.521, 'train_loss': 0.003759994078427553, 'epoch': 3.4}
[36m(train_hpo pid=3437044)[0m STATE at ending of training  :  TrainerState(epoch=3.4, global_step=10, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=177335259076608.0, log_history=[{'loss': 0.0059, 'grad_norm': 0.033619482070207596, 'learning_rate': 3.612785445936571e-05, 'epoch': 1.0, 'step': 3}, {'loss': 0.0031, 'grad_norm': 0.03742876276373863, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.0, 'step': 6}, {'loss': 0.0027, 'grad_norm': 0.038548409938812256, 'learning_rate': 5.161122065623674e-06, 'epoch': 3.0, 'step': 9}, {'loss': 0.0025, 'grad_norm': 0.02037077210843563, 'learning_rate': 0.0, 'epoch': 3.4, 'step': 10}, {'train_runtime': 19.2034, 'train_samples_per_second': 51.553, 'train_steps_per_second': 0.521, 'total_flos': 177335259076608.0, 'train_loss': 0.003759994078427553, 'epoch': 3.4, 'step': 10}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3437280)[0m {'eval_loss': 0.002885055961087346, 'eval_f1': 0.9032258064516129, 'eval_recall': 0.84, 'eval_accuracy': 0.8656716417910447, 'eval_precision': 0.9767441860465116, 'eval_optim_threshold': 0.5017884969711304, 'eval_AP': 0.9722661393883936, 'eval_MCC': 0.7089551601199102, 'eval_NDCG': 0.9947318216779305, 'eval_kappa': 0.6877265665458312, 'eval_runtime': 3.4048, 'eval_samples_per_second': 19.678, 'eval_steps_per_second': 1.175, 'epoch': 1.4}[36m(train_hpo pid=3437044)[0m 2025-06-04 19:20:12,695 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3437044)[0m 2025-06-04 19:20:12,701 - INFO - eval_result: {'eval_loss': 0.002556768013164401, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.7107190489768982, 'eval_AP': 0.845498547710152, 'eval_MCC': 0.0, 'eval_NDCG': 0.9169225431615179, 'eval_kappa': 0.0, 'eval_runtime': 3.3289, 'eval_samples_per_second': 20.127, 'eval_steps_per_second': 1.202, 'epoch': 3.4}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3437044)[0m 2025-06-04 19:20:12,735 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB[32m [repeated 2x across cluster][0m
2025-06-04 19:20:12,758 - INFO - Cleaning up trial bf06f6df
2025-06-04 19:20:12,759 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-19-32/train_hpo_bf06f6df_2_alpha=0.9706,gamma=4.6341,learning_rate=0.0001,num_train_epochs=5,weight_decay=0.1230_2025-06-04_19-19-38
2025-06-04 19:20:12,759 - INFO - Cleaning up trial b943afd6
2025-06-04 19:20:12,759 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-19-32/train_hpo_b943afd6_1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364_2025-06-04_19-19-32
2025-06-04 19:20:12,759 - INFO - Current best: 89ffbcaf with eval_f1 : 0.9032258064516129 at iteration 1
2025-06-04 19:20:12,766	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-19-32' in 0.0056s.
2025-06-04 19:20:12,773 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x719b4667d550>
2025-06-04 19:20:12,774 - INFO - Best trial : train_hpo_89ffbcaf
2025-06-04 19:20:12,774 - INFO - Best config : {'alpha': 0.7811204413478371, 'gamma': 6.807074484302038, 'learning_rate': 1.8858110930954453e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 2}
2025-06-04 19:20:12,774 - INFO - Best trial after optimization: {'eval_loss': 0.002885055961087346, 'eval_f1': 0.9032258064516129, 'eval_recall': 0.84, 'eval_accuracy': 0.8656716417910447, 'eval_precision': 0.9767441860465116, 'eval_optim_threshold': 0.5017884969711304, 'eval_AP': 0.9722661393883936, 'eval_MCC': 0.7089551601199102, 'eval_NDCG': 0.9947318216779305, 'eval_kappa': 0.6877265665458312, 'eval_runtime': 3.4048, 'eval_samples_per_second': 19.678, 'eval_steps_per_second': 1.175, 'epoch': 1.4, 'timestamp': 1749057606, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '89ffbcaf', 'date': '2025-06-04_19-20-06', 'time_this_iter_s': 13.582096099853516, 'time_total_s': 13.582096099853516, 'pid': 3437280, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'alpha': 0.7811204413478371, 'gamma': 6.807074484302038, 'learning_rate': 1.8858110930954453e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 2}, 'time_since_restore': 13.582096099853516, 'iterations_since_restore': 1, 'experiment_tag': '3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512'}
2025-06-04 19:20:12,796 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   0.037179  0.854701  ...                        4  b943afd6
1   0.002557  0.854701  ...                        5  bf06f6df
2   0.002885  0.903226  ...                        2  89ffbcaf

[3 rows x 33 columns]
2025-06-04 19:20:13,003 - INFO - Trial comparison plot saved
2025-06-04 19:20:13,004 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-04 19:20:13,582 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.25 and gamma=2.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-04 19:20:13,675 - INFO - training size : 198
2025-06-04 19:20:13,676 - INFO - dev size : 67
2025-06-04 19:20:13,676 - INFO - test size : 132
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(

[36m(train_hpo pid=3437044)[0m {'eval_loss': 0.002556768013164401, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.7107190489768982, 'eval_AP': 0.845498547710152, 'eval_MCC': 0.0, 'eval_NDCG': 0.9169225431615179, 'eval_kappa': 0.0, 'eval_runtime': 3.3289, 'eval_samples_per_second': 20.127, 'eval_steps_per_second': 1.202, 'epoch': 3.4}
[36m(train_hpo pid=3437044)[0m {'loss': 0.0025, 'grad_norm': 0.02037077210843563, 'learning_rate': 0.0, 'epoch': 3.4}[32m [repeated 2x across cluster][0m

Trial train_hpo_bf06f6df finished iteration 1 at 2025-06-04 19:20:12. Total running time: 40s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_bf06f6df result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    27.1092 â”‚
â”‚ time_total_s                        27.1092 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   3.4 â”‚
â”‚ eval_AP                              0.8455 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.91692 â”‚
â”‚ eval_accuracy                       0.74627 â”‚
â”‚ eval_f1                              0.8547 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           0.00256 â”‚
â”‚ eval_optim_threshold                0.71072 â”‚
â”‚ eval_precision                      0.74627 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.3289 â”‚
â”‚ eval_samples_per_second              20.127 â”‚
â”‚ eval_steps_per_second                 1.202 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_bf06f6df completed after 1 iterations at 2025-06-04 19:20:12. Total running time: 40s

Trial status: 3 TERMINATED
Current time: 2025-06-04 19:20:12. Total running time: 40s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_b943afd6   TERMINATED   0.625202   2.69927       1.88223e-05         0.13641                     4        1            24.6462    0.0371794     0.854701            1             0.746269 â”‚
â”‚ train_hpo_bf06f6df   TERMINATED   0.970578   4.6341        5.16112e-05         0.123031                    5        1            27.1092    0.00255677    0.854701            1             0.746269 â”‚
â”‚ train_hpo_89ffbcaf   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            13.5821    0.00288506    0.903226            0.84          0.865672 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

  0%|          | 0/18 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  6%|â–Œ         | 1/18 [00:00<00:10,  1.55it/s] 11%|â–ˆ         | 2/18 [00:01<00:10,  1.60it/s] 17%|â–ˆâ–‹        | 3/18 [00:01<00:09,  1.61it/s] 22%|â–ˆâ–ˆâ–       | 4/18 [00:02<00:08,  1.62it/s] 28%|â–ˆâ–ˆâ–Š       | 5/18 [00:03<00:08,  1.62it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 6/18 [00:03<00:07,  1.63it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 7/18 [00:04<00:06,  1.63it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 8/18 [00:04<00:06,  1.64it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 9/18 [00:05<00:04,  1.92it/s]                                               50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 9/18 [00:05<00:04,  1.92it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 10/18 [00:05<00:04,  1.80it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 11/18 [00:06<00:04,  1.74it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 12/18 [00:07<00:03,  1.71it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 13/18 [00:07<00:02,  1.67it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 14/18 [00:08<00:02,  1.66it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 15/18 [00:08<00:01,  1.64it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 16/18 [00:09<00:01,  1.64it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 17/18 [00:10<00:00,  1.65it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 18/18 [00:10<00:00,  1.92it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 18/18 [00:12<00:00,  1.92it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 18/18 [00:12<00:00,  1.92it/s]2025-06-04 19:20:26,318 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 18/18 [00:12<00:00,  1.48it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
{'loss': 0.0022, 'grad_norm': 0.1732969880104065, 'learning_rate': 9.429055465477227e-06, 'epoch': 1.0}
{'loss': 0.0011, 'grad_norm': 0.056766632944345474, 'learning_rate': 0.0, 'epoch': 2.0}
{'train_runtime': 12.1752, 'train_samples_per_second': 32.525, 'train_steps_per_second': 1.478, 'train_loss': 0.0016288613486621114, 'epoch': 2.0}
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.32it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.48it/s]2025-06-04 19:20:29,935 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.11s/it]
2025-06-04 19:20:29,941 - INFO - Training time : 16.937361593125388
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.21it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.09it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.40it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.14it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.37it/s]2025-06-04 19:20:34,333 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.47it/s]
2025-06-04 19:20:34,339 - INFO - Evaluation time : 4.397977123968303
2025-06-04 19:20:34,339 - INFO - Evaluation results on test set: {'eval_loss': 0.0008256351575255394, 'eval_f1': 0.8471615720524017, 'eval_recall': 1.0, 'eval_accuracy': 0.7348484848484849, 'eval_precision': 0.7348484848484849, 'eval_optim_threshold': 0.5856844186782837, 'eval_AP': 0.9987041708589119, 'eval_MCC': 0.0, 'eval_NDCG': 0.9997954576395468, 'eval_kappa': 0.0, 'eval_runtime': 4.3927, 'eval_samples_per_second': 30.05, 'eval_steps_per_second': 1.366, 'epoch': 2.0}
2025-06-04 19:20:34,339 - INFO - Total updates (optimizer steps): 18
2025-06-04 19:20:34,339 - INFO - Avg time / step: 0.677s
2025-06-04 19:20:34,852 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_focaldmis-lab/biobert-v1.13trials_fold-3
2025-06-04 19:20:34,852 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.12it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.04it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.36it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.10it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.33it/s]2025-06-04 19:20:39,280 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.46it/s]
2025-06-04 19:20:39,284 - INFO - preds : [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
2025-06-04 19:20:39,285 - INFO - test_split["labels"] : [1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1]
2025-06-04 19:20:39,287 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:20:42,027 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': 0.9987041708589119, 'MCC': 0.0, 'NDCG': 0.9997954576395468, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:20:42,149 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-04 19:20:42,252 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:20:42,252 - INFO - 
On test Set (optimal threshold of 0.5886285305023193 according to cross validation on the training set): 
2025-06-04 19:20:42,254 - INFO - Confusion matrix: TN=35, FP=0, FN=4, TP=93
2025-06-04 19:20:45,078 - INFO - Metrics: {'f1': 0.9789473684210527, 'recall': 0.9587628865979382, 'precision': 1.0, 'accuracy': 0.9696969696969697, 'AP': 0.9987041708589119, 'MCC': 0.9275927077992, 'NDCG': 0.9997954576395468, 'kappa': 0.9249786871270247, 'TN': 35, 'FP': 0, 'FN': 4, 'TP': 93}
2025-06-04 19:20:45,188 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:20:45,188 - INFO - Results for fold 3 : [{'f1': 0.9789473684210527, 'recall': 0.9587628865979382, 'precision': 1.0, 'accuracy': 0.9696969696969697, 'AP': 0.9987041708589119, 'MCC': 0.9275927077992, 'NDCG': 0.9997954576395468, 'kappa': 0.9249786871270247, 'TN': 35, 'FP': 0, 'FN': 4, 'TP': 93}]
2025-06-04 19:20:45,310 - INFO - Cleared CUDA cache. Memory allocated: 1.40 GB, Memory reserved: 1.84 GB
2025-06-04 19:20:45,311 - INFO - Cleared CUDA cache. Memory allocated: 1.40 GB, Memory reserved: 1.84 GB
2025-06-04 19:20:45,358 - INFO - Cleared CUDA cache. Memory allocated: 0.02 GB, Memory reserved: 0.03 GB
2025-06-04 19:20:45,372 - INFO - Metrics for dmis-lab/biobert-v1.1:               model_name fold loss_type run  ...    TN    FP   FN    TP
0  dmis-lab/biobert-v1.1    1     focal   1  ...  35.0   0.0  0.0  98.0
0  dmis-lab/biobert-v1.1    2     focal   1  ...   1.0  33.0  0.0  98.0
0  dmis-lab/biobert-v1.1    3     focal   1  ...   0.0  35.0  0.0  97.0

[3 rows x 18 columns]
2025-06-04 19:20:45,372 - INFO - Training model 2/2: google-bert/bert-base-uncased
2025-06-04 19:20:45,555 - INFO - 
fold number 1 / 3
2025-06-04 19:20:45,564 - INFO - train split size : 198
2025-06-04 19:20:45,564 - INFO - dev split size : 66
2025-06-04 19:20:45,564 - INFO - test split size : 133
Map (num_proc=32):   0%|          | 0/198 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–Ž         | 7/198 [00:00<00:05, 36.66 examples/s]Map (num_proc=32):  21%|â–ˆâ–ˆ        | 42/198 [00:00<00:00, 164.04 examples/s]Map (num_proc=32):  36%|â–ˆâ–ˆâ–ˆâ–‹      | 72/198 [00:00<00:00, 197.06 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 102/198 [00:00<00:00, 212.36 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 132/198 [00:00<00:00, 235.31 examples/s]Map (num_proc=32):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 162/198 [00:00<00:00, 250.35 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 192/198 [00:00<00:00, 238.67 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 198/198 [00:01<00:00, 193.05 examples/s]
Map (num_proc=32):   0%|          | 0/66 [00:00<?, ? examples/s]Map (num_proc=32):   5%|â–         | 3/66 [00:00<00:04, 15.47 examples/s]Map (num_proc=32):  18%|â–ˆâ–Š        | 12/66 [00:00<00:01, 46.96 examples/s]Map (num_proc=32):  36%|â–ˆâ–ˆâ–ˆâ–‹      | 24/66 [00:00<00:00, 65.69 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 34/66 [00:00<00:00, 74.82 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 44/66 [00:00<00:00, 81.49 examples/s]Map (num_proc=32):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 54/66 [00:00<00:00, 85.80 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 64/66 [00:00<00:00, 85.62 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 66/66 [00:01<00:00, 65.05 examples/s]
Map (num_proc=32):   0%|          | 0/133 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/133 [00:00<00:04, 26.32 examples/s]Map (num_proc=32):  22%|â–ˆâ–ˆâ–       | 29/133 [00:00<00:00, 113.06 examples/s]Map (num_proc=32):  37%|â–ˆâ–ˆâ–ˆâ–‹      | 49/133 [00:00<00:00, 138.11 examples/s]Map (num_proc=32):  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 65/133 [00:00<00:00, 145.25 examples/s]Map (num_proc=32):  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 85/133 [00:00<00:00, 159.69 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 105/133 [00:00<00:00, 170.07 examples/s]Map (num_proc=32):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 125/133 [00:00<00:00, 172.71 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 133/133 [00:01<00:00, 131.38 examples/s]
2025-06-04 19:20:54,987 - INFO - 3 datasets tokenized successfully
2025-06-04 19:20:54,988 - INFO - Starting hyperparameter search for focal loss
[36m(train_hpo pid=3439203)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3439203)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3439203)[0m 2025-06-04 19:21:02,136 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.6252016107931255 and gamma=2.6992695521978884
[36m(train_hpo pid=3439203)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3439203)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3439203)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3439203)[0m   warnings.warn(
[36m(train_hpo pid=3439434)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3439434)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3439434)[0m 2025-06-04 19:21:08,970 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.970577641092792 and gamma=4.634102840173219
[36m(train_hpo pid=3439434)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3439434)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3439434)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3439434)[0m   warnings.warn(
[36m(train_hpo pid=3439714)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3439714)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3439714)[0m 2025-06-04 19:21:15,716 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.7811204413478371 and gamma=6.807074484302038
[36m(train_hpo pid=3439714)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3439714)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3439714)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3439714)[0m   warnings.warn(
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-04_19-20-55   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-20-55
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-04_18-54-36_274448_3393636/artifacts/2025-06-04_19-20-55/train_hpo_2025-06-04_19-20-55/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-04 19:20:55. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_2cbc0a1f   PENDING    0.625202   2.69927       1.88223e-05          0.13641                    4 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_2cbc0a1f started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_2cbc0a1f config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                                0.6252 â”‚
â”‚ gamma                               2.69927 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          4 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3439203)[0m [2025-06-04 19:21:02,402] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3439203)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=8, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_74ec8035 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_74ec8035 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.97058 â”‚
â”‚ gamma                                4.6341 â”‚
â”‚ learning_rate                         5e-05 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3439434)[0m [2025-06-04 19:21:09,339] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3439203)[0m {'loss': 0.0413, 'grad_norm': 0.2707081139087677, 'learning_rate': 1.176394468215133e-05, 'epoch': 1.0}
[36m(train_hpo pid=3439434)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3439203)[0m {'loss': 0.0367, 'grad_norm': 0.12217004597187042, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.0}

Trial train_hpo_4e08584e started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_4e08584e config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.78112 â”‚
â”‚ gamma                               6.80707 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          2 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3439714)[0m [2025-06-04 19:21:15,957] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3439714)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=4, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3439203)[0m {'loss': 0.042, 'grad_norm': 0.528054416179657, 'learning_rate': 0.0, 'epoch': 2.8}
[36m(train_hpo pid=3439203)[0m {'train_runtime': 16.3268, 'train_samples_per_second': 48.509, 'train_steps_per_second': 0.49, 'train_loss': 0.03974441532045603, 'epoch': 2.8}
[36m(train_hpo pid=3439203)[0m STATE at ending of training  :  TrainerState(epoch=2.8, global_step=8, max_steps=8, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=146288433303552.0, log_history=[{'loss': 0.0413, 'grad_norm': 0.2707081139087677, 'learning_rate': 1.176394468215133e-05, 'epoch': 1.0, 'step': 3}, {'loss': 0.0367, 'grad_norm': 0.12217004597187042, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.0, 'step': 6}, {'loss': 0.042, 'grad_norm': 0.528054416179657, 'learning_rate': 0.0, 'epoch': 2.8, 'step': 8}, {'train_runtime': 16.3268, 'train_samples_per_second': 48.509, 'train_steps_per_second': 0.49, 'total_flos': 146288433303552.0, 'train_loss': 0.03974441532045603, 'epoch': 2.8, 'step': 8}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})[36m(train_hpo pid=3439203)[0m 2025-06-04 19:21:26,643 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3439203)[0m 2025-06-04 19:21:26,649 - INFO - eval_result: {'eval_loss': 0.03766217455267906, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.6173900365829468, 'eval_AP': 0.9907139945481664, 'eval_MCC': 0.0, 'eval_NDCG': 0.9983305395212713, 'eval_kappa': 0.0, 'eval_runtime': 4.6395, 'eval_samples_per_second': 14.226, 'eval_steps_per_second': 0.862, 'epoch': 2.8}
2025-06-04 19:21:26,709 - INFO - Cleaning up trial 2cbc0a1f
2025-06-04 19:21:26,709 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-20-55/train_hpo_2cbc0a1f_1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364_2025-06-04_19-20-55
[36m(train_hpo pid=3439203)[0m 2025-06-04 19:21:26,684 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
2025-06-04 19:21:28,425 - INFO - Cleaning up trial 4e08584e
2025-06-04 19:21:28,425 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-20-55/train_hpo_4e08584e_3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512_2025-06-04_19-21-08
2025-06-04 19:21:28,425 - INFO - Current best: 2cbc0a1f with eval_f1 : 0.8521739130434782 at iteration 1

[36m(train_hpo pid=3439714)[0m STATE at ending of training  :  TrainerState(epoch=1.4, global_step=4, max_steps=4, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=73144216651776.0, log_history=[{'loss': 0.0023, 'grad_norm': 0.051018230617046356, 'learning_rate': 4.714527732738613e-06, 'epoch': 1.0, 'step': 3}, {'loss': 0.0027, 'grad_norm': 0.02066146582365036, 'learning_rate': 0.0, 'epoch': 1.4, 'step': 4}, {'train_runtime': 5.7915, 'train_samples_per_second': 68.376, 'train_steps_per_second': 0.691, 'total_flos': 73144216651776.0, 'train_loss': 0.0023958435049280524, 'epoch': 1.4, 'step': 4}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 3 RUNNING
Current time: 2025-06-04 19:21:25. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_2cbc0a1f   RUNNING    0.625202   2.69927       1.88223e-05         0.13641                     4 â”‚
â”‚ train_hpo_74ec8035   RUNNING    0.970578   4.6341        5.16112e-05         0.123031                    5 â”‚
â”‚ train_hpo_4e08584e   RUNNING    0.78112    6.80707       1.88581e-05         0.251217                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3439203)[0m {'eval_loss': 0.03766217455267906, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.6173900365829468, 'eval_AP': 0.9907139945481664, 'eval_MCC': 0.0, 'eval_NDCG': 0.9983305395212713, 'eval_kappa': 0.0, 'eval_runtime': 4.6395, 'eval_samples_per_second': 14.226, 'eval_steps_per_second': 0.862, 'epoch': 2.8}

Trial train_hpo_2cbc0a1f finished iteration 1 at 2025-06-04 19:21:26. Total running time: 31s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_2cbc0a1f result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                     25.019 â”‚
â”‚ time_total_s                         25.019 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   2.8 â”‚
â”‚ eval_AP                             0.99071 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.99833 â”‚
â”‚ eval_accuracy                       0.74242 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           0.03766 â”‚
â”‚ eval_optim_threshold                0.61739 â”‚
â”‚ eval_precision                      0.74242 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         4.6395 â”‚
â”‚ eval_samples_per_second              14.226 â”‚
â”‚ eval_steps_per_second                 0.862 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_2cbc0a1f completed after 1 iterations at 2025-06-04 19:21:26. Total running time: 31s
[36m(train_hpo pid=3439434)[0m {'loss': 0.0022, 'grad_norm': 0.020275471732020378, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.0}[32m [repeated 4x across cluster][0m
[36m(train_hpo pid=3439714)[0m {'train_runtime': 5.7915, 'train_samples_per_second': 68.376, 'train_steps_per_second': 0.691, 'train_loss': 0.0023958435049280524, 'epoch': 1.4}

Trial train_hpo_4e08584e finished iteration 1 at 2025-06-04 19:21:28. Total running time: 33s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_4e08584e result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    13.1291 â”‚
â”‚ time_total_s                        13.1291 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   1.4 â”‚
â”‚ eval_AP                             0.92619 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.98305 â”‚
â”‚ eval_accuracy                       0.74242 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                            0.0018 â”‚
â”‚ eval_optim_threshold                0.58053 â”‚
â”‚ eval_precision                      0.74242 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.4387 â”‚
â”‚ eval_samples_per_second              19.193 â”‚
â”‚ eval_steps_per_second                 1.163 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_4e08584e completed after 1 iterations at 2025-06-04 19:21:28. Total running time: 33s
[36m(train_hpo pid=3439434)[0m {'train_runtime': 19.172, 'train_samples_per_second': 51.638, 'train_steps_per_second': 0.522, 'train_loss': 0.013728828507009894, 'epoch': 3.4}
[36m(train_hpo pid=3439434)[0m STATE at ending of training  :  TrainerState(epoch=3.4, global_step=10, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=177335259076608.0, log_history=[{'loss': 0.0417, 'grad_norm': 0.10592951625585556, 'learning_rate': 3.612785445936571e-05, 'epoch': 1.0, 'step': 3}, {'loss': 0.0022, 'grad_norm': 0.020275471732020378, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.0, 'step': 6}, {'loss': 0.0014, 'grad_norm': 0.008581059984862804, 'learning_rate': 5.161122065623674e-06, 'epoch': 3.0, 'step': 9}, {'loss': 0.0015, 'grad_norm': 0.055262476205825806, 'learning_rate': 0.0, 'epoch': 3.4, 'step': 10}, {'train_runtime': 19.172, 'train_samples_per_second': 51.638, 'train_steps_per_second': 0.522, 'total_flos': 177335259076608.0, 'train_loss': 0.013728828507009894, 'epoch': 3.4, 'step': 10}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3439714)[0m {'eval_loss': 0.0018041147850453854, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.5805304646492004, 'eval_AP': 0.9261862088459125, 'eval_MCC': 0.0, 'eval_NDCG': 0.9830510223868169, 'eval_kappa': 0.0, 'eval_runtime': 3.4387, 'eval_samples_per_second': 19.193, 'eval_steps_per_second': 1.163, 'epoch': 1.4}2025-06-04 19:21:35,085 - INFO - Cleaning up trial 74ec8035
2025-06-04 19:21:35,085 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-20-55/train_hpo_74ec8035_2_alpha=0.9706,gamma=4.6341,learning_rate=0.0001,num_train_epochs=5,weight_decay=0.1230_2025-06-04_19-21-01
2025-06-04 19:21:35,086 - INFO - Current best: 2cbc0a1f with eval_f1 : 0.8521739130434782 at iteration 1
2025-06-04 19:21:35,086 - INFO - Current best: 4e08584e with eval_f1 : 0.8521739130434782 at iteration 1
2025-06-04 19:21:35,095	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-20-55' in 0.0080s.
[36m(train_hpo pid=3439434)[0m 2025-06-04 19:21:35,021 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3439434)[0m 2025-06-04 19:21:35,027 - INFO - eval_result: {'eval_loss': 0.0014414782635867596, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.7516803741455078, 'eval_AP': 1.0, 'eval_MCC': 0.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 0.0, 'eval_runtime': 3.2543, 'eval_samples_per_second': 20.281, 'eval_steps_per_second': 1.229, 'epoch': 3.4}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3439434)[0m 2025-06-04 19:21:35,060 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB[32m [repeated 2x across cluster][0m
2025-06-04 19:21:35,102 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x71a3a8642010>
2025-06-04 19:21:35,102 - INFO - Best trial : train_hpo_2cbc0a1f
2025-06-04 19:21:35,103 - INFO - Best config : {'alpha': 0.6252016107931255, 'gamma': 2.6992695521978884, 'learning_rate': 1.8822311491442127e-05, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 4}
2025-06-04 19:21:35,103 - INFO - Best trial after optimization: {'eval_loss': 0.03766217455267906, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.6173900365829468, 'eval_AP': 0.9907139945481664, 'eval_MCC': 0.0, 'eval_NDCG': 0.9983305395212713, 'eval_kappa': 0.0, 'eval_runtime': 4.6395, 'eval_samples_per_second': 14.226, 'eval_steps_per_second': 0.862, 'epoch': 2.8, 'timestamp': 1749057686, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '2cbc0a1f', 'date': '2025-06-04_19-21-26', 'time_this_iter_s': 25.019018411636353, 'time_total_s': 25.019018411636353, 'pid': 3439203, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'alpha': 0.6252016107931255, 'gamma': 2.6992695521978884, 'learning_rate': 1.8822311491442127e-05, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 4}, 'time_since_restore': 25.019018411636353, 'iterations_since_restore': 1, 'experiment_tag': '1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364'}
2025-06-04 19:21:35,131 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   0.037662  0.852174  ...                        4  2cbc0a1f
1   0.001441  0.852174  ...                        5  74ec8035
2   0.001804  0.852174  ...                        2  4e08584e

[3 rows x 33 columns]
2025-06-04 19:21:35,305 - INFO - Trial comparison plot saved
2025-06-04 19:21:35,305 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-04 19:21:35,512 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.25 and gamma=2.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-04 19:21:35,625 - INFO - training size : 198
2025-06-04 19:21:35,625 - INFO - dev size : 66
2025-06-04 19:21:35,625 - INFO - test size : 133
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(


Trial train_hpo_74ec8035 finished iteration 1 at 2025-06-04 19:21:35. Total running time: 40s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_74ec8035 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    26.5441 â”‚
â”‚ time_total_s                        26.5441 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   3.4 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                       0.74242 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           0.00144 â”‚
â”‚ eval_optim_threshold                0.75168 â”‚
â”‚ eval_precision                      0.74242 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.2543 â”‚
â”‚ eval_samples_per_second              20.281 â”‚
â”‚ eval_steps_per_second                 1.229 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_74ec8035 completed after 1 iterations at 2025-06-04 19:21:35. Total running time: 40s

Trial status: 3 TERMINATED
Current time: 2025-06-04 19:21:35. Total running time: 40s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_2cbc0a1f   TERMINATED   0.625202   2.69927       1.88223e-05         0.13641                     4        1            25.019     0.0376622     0.852174               1          0.742424 â”‚
â”‚ train_hpo_74ec8035   TERMINATED   0.970578   4.6341        5.16112e-05         0.123031                    5        1            26.5441    0.00144148    0.852174               1          0.742424 â”‚
â”‚ train_hpo_4e08584e   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            13.1291    0.00180411    0.852174               1          0.742424 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

[36m(train_hpo pid=3439434)[0m {'eval_loss': 0.0014414782635867596, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.7516803741455078, 'eval_AP': 1.0, 'eval_MCC': 0.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 0.0, 'eval_runtime': 3.2543, 'eval_samples_per_second': 20.281, 'eval_steps_per_second': 1.229, 'epoch': 3.4}
[36m(train_hpo pid=3439434)[0m {'loss': 0.0015, 'grad_norm': 0.055262476205825806, 'learning_rate': 0.0, 'epoch': 3.4}[32m [repeated 2x across cluster][0m
  0%|          | 0/36 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  3%|â–Ž         | 1/36 [00:00<00:22,  1.55it/s]  6%|â–Œ         | 2/36 [00:01<00:21,  1.59it/s]  8%|â–Š         | 3/36 [00:01<00:20,  1.61it/s] 11%|â–ˆ         | 4/36 [00:02<00:19,  1.61it/s] 14%|â–ˆâ–        | 5/36 [00:03<00:19,  1.62it/s] 17%|â–ˆâ–‹        | 6/36 [00:03<00:18,  1.62it/s] 19%|â–ˆâ–‰        | 7/36 [00:04<00:17,  1.62it/s] 22%|â–ˆâ–ˆâ–       | 8/36 [00:04<00:17,  1.63it/s] 25%|â–ˆâ–ˆâ–Œ       | 9/36 [00:05<00:14,  1.92it/s]                                               25%|â–ˆâ–ˆâ–Œ       | 9/36 [00:05<00:14,  1.92it/s] 28%|â–ˆâ–ˆâ–Š       | 10/36 [00:05<00:14,  1.79it/s] 31%|â–ˆâ–ˆâ–ˆ       | 11/36 [00:06<00:14,  1.74it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 12/36 [00:07<00:14,  1.70it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 13/36 [00:07<00:13,  1.67it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 14/36 [00:08<00:13,  1.66it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 15/36 [00:08<00:12,  1.64it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 16/36 [00:09<00:12,  1.64it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 17/36 [00:10<00:11,  1.64it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 18/36 [00:10<00:09,  1.91it/s]                                                50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 18/36 [00:10<00:09,  1.91it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 19/36 [00:11<00:09,  1.79it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 20/36 [00:11<00:09,  1.74it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 21/36 [00:12<00:08,  1.70it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 22/36 [00:13<00:08,  1.67it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 23/36 [00:13<00:07,  1.66it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 24/36 [00:14<00:07,  1.65it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 25/36 [00:14<00:06,  1.64it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 26/36 [00:15<00:06,  1.64it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 27/36 [00:15<00:04,  1.91it/s]                                                75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 27/36 [00:15<00:04,  1.91it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 28/36 [00:16<00:04,  1.79it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 29/36 [00:17<00:04,  1.73it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 30/36 [00:17<00:03,  1.70it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 31/36 [00:18<00:02,  1.67it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 32/36 [00:18<00:02,  1.65it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 33/36 [00:19<00:01,  1.64it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 34/36 [00:20<00:01,  1.63it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 35/36 [00:20<00:00,  1.64it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [00:21<00:00,  1.91it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [00:22<00:00,  1.91it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [00:22<00:00,  1.91it/s]2025-06-04 19:21:58,922 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [00:22<00:00,  1.58it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
{'loss': 0.049, 'grad_norm': 1.754367709159851, 'learning_rate': 1.4116733618581595e-05, 'epoch': 1.0}
{'loss': 0.0381, 'grad_norm': 0.7404911518096924, 'learning_rate': 9.411155745721064e-06, 'epoch': 2.0}
{'loss': 0.0197, 'grad_norm': 0.571199357509613, 'learning_rate': 4.705577872860532e-06, 'epoch': 3.0}
{'loss': 0.0114, 'grad_norm': 0.40531328320503235, 'learning_rate': 0.0, 'epoch': 4.0}
{'train_runtime': 22.8498, 'train_samples_per_second': 34.661, 'train_steps_per_second': 1.576, 'train_loss': 0.029557779638303652, 'epoch': 4.0}
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.25it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.62it/s]2025-06-04 19:22:02,817 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.20s/it]
2025-06-04 19:22:02,823 - INFO - Training time : 27.518220622790977
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.12it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.01it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.34it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.08it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.23it/s]2025-06-04 19:22:07,587 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.35it/s]
2025-06-04 19:22:07,592 - INFO - Evaluation time : 4.768796409014612
2025-06-04 19:22:07,592 - INFO - Evaluation results on test set: {'eval_loss': 0.009635061025619507, 'eval_f1': 0.9949238578680203, 'eval_recall': 1.0, 'eval_accuracy': 0.9924812030075187, 'eval_precision': 0.98989898989899, 'eval_optim_threshold': 0.6340122818946838, 'eval_AP': 1.0, 'eval_MCC': 0.9806202943118002, 'eval_NDCG': 1.0000000000000004, 'eval_kappa': 0.98043254376931, 'eval_runtime': 4.7641, 'eval_samples_per_second': 27.917, 'eval_steps_per_second': 1.259, 'epoch': 4.0}
2025-06-04 19:22:07,592 - INFO - Total updates (optimizer steps): 36
2025-06-04 19:22:07,592 - INFO - Avg time / step: 0.635s
2025-06-04 19:22:08,122 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_focalgoogle-bert/bert-base-uncased3trials_fold-1
2025-06-04 19:22:08,122 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.13it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.03it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.35it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.09it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.24it/s]2025-06-04 19:22:13,501 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:05<00:00,  1.18it/s]
2025-06-04 19:22:13,505 - INFO - preds : [1 1 1 0 0 1 1 1 1 1 1 1 0 0 1 0 1 0 1 1 1 1 1 1 0 0 0 0 0 0 0 1 1 1 1 1 1
 1 1 1 0 1 1 0 0 1 1 1 1 1 1 1 1 0 0 1 1 1 1 0 1 1 1 1 1 0 1 1 0 1 1 1 1 1
 0 1 0 1 0 0 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 0 0 1 0 1 1 1
 1 0 0 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 0]
2025-06-04 19:22:13,506 - INFO - test_split["labels"] : [1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0]
2025-06-04 19:22:13,508 - INFO - Confusion matrix: TN=34, FP=1, FN=0, TP=98
2025-06-04 19:22:16,755 - INFO - Metrics: {'f1': 0.9949238578680203, 'recall': 1.0, 'precision': 0.98989898989899, 'accuracy': 0.9924812030075187, 'AP': 1.0, 'MCC': 0.9806202943118002, 'NDCG': 1.0000000000000004, 'kappa': 0.98043254376931, 'TN': 34, 'FP': 1, 'FN': 0, 'TP': 98}
2025-06-04 19:22:16,872 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-04 19:22:16,968 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:22:16,968 - INFO - 
On test Set (optimal threshold of 0.5568217635154724 according to cross validation on the training set): 
2025-06-04 19:22:16,970 - INFO - Confusion matrix: TN=35, FP=0, FN=0, TP=98
2025-06-04 19:22:19,897 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 35, 'FP': 0, 'FN': 0, 'TP': 98}
2025-06-04 19:22:19,994 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:22:19,994 - INFO - Results for fold 1 : [{'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 35, 'FP': 0, 'FN': 0, 'TP': 98}]
2025-06-04 19:22:20,109 - INFO - Cleared CUDA cache. Memory allocated: 1.40 GB, Memory reserved: 1.77 GB
2025-06-04 19:22:20,109 - INFO - 
fold number 2 / 3
2025-06-04 19:22:20,115 - INFO - train split size : 198
2025-06-04 19:22:20,115 - INFO - dev split size : 67
2025-06-04 19:22:20,115 - INFO - test split size : 132
Map (num_proc=32):   0%|          | 0/198 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–Ž         | 7/198 [00:00<00:05, 37.79 examples/s]Map (num_proc=32):  21%|â–ˆâ–ˆ        | 42/198 [00:00<00:00, 161.62 examples/s]Map (num_proc=32):  36%|â–ˆâ–ˆâ–ˆâ–‹      | 72/198 [00:00<00:00, 205.11 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 102/198 [00:00<00:00, 233.60 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 132/198 [00:00<00:00, 243.61 examples/s]Map (num_proc=32):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 162/198 [00:00<00:00, 253.88 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 192/198 [00:00<00:00, 258.46 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 198/198 [00:00<00:00, 198.01 examples/s]
Map (num_proc=32):   0%|          | 0/67 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/67 [00:00<00:03, 17.58 examples/s]Map (num_proc=32):  22%|â–ˆâ–ˆâ–       | 15/67 [00:00<00:00, 61.00 examples/s]Map (num_proc=32):  37%|â–ˆâ–ˆâ–ˆâ–‹      | 25/67 [00:00<00:00, 70.28 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 35/67 [00:00<00:00, 76.15 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 45/67 [00:00<00:00, 76.41 examples/s]Map (num_proc=32):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 55/67 [00:00<00:00, 80.69 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 65/67 [00:00<00:00, 82.48 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:01<00:00, 66.12 examples/s]
Map (num_proc=32):   0%|          | 0/132 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/132 [00:00<00:04, 28.46 examples/s]Map (num_proc=32):  21%|â–ˆâ–ˆ        | 28/132 [00:00<00:00, 114.21 examples/s]Map (num_proc=32):  36%|â–ˆâ–ˆâ–ˆâ–‹      | 48/132 [00:00<00:00, 144.39 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 68/132 [00:00<00:00, 152.30 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 88/132 [00:00<00:00, 161.53 examples/s]Map (num_proc=32):  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 112/132 [00:00<00:00, 180.48 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 132/132 [00:00<00:00, 185.81 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 132/132 [00:00<00:00, 136.96 examples/s]
2025-06-04 19:22:29,522 - INFO - 3 datasets tokenized successfully
2025-06-04 19:22:29,524 - INFO - Starting hyperparameter search for focal loss
[36m(train_hpo pid=3441854)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3441854)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3441854)[0m 2025-06-04 19:22:36,820 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.6252016107931255 and gamma=2.6992695521978884
[36m(train_hpo pid=3441854)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3441854)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3441854)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3441854)[0m   warnings.warn(
[36m(train_hpo pid=3442015)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3442015)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3442015)[0m 2025-06-04 19:22:43,629 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.970577641092792 and gamma=4.634102840173219
[36m(train_hpo pid=3442015)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3442015)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3442015)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3442015)[0m   warnings.warn(
[36m(train_hpo pid=3442365)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3442365)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3442365)[0m 2025-06-04 19:22:50,411 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.7811204413478371 and gamma=6.807074484302038
[36m(train_hpo pid=3442365)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3442365)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3442365)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3442365)[0m   warnings.warn(
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-04_19-22-29   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-22-29
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-04_18-54-36_274448_3393636/artifacts/2025-06-04_19-22-29/train_hpo_2025-06-04_19-22-29/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-04 19:22:29. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_108b74c3   PENDING    0.625202   2.69927       1.88223e-05          0.13641                    4 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_108b74c3 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_108b74c3 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                                0.6252 â”‚
â”‚ gamma                               2.69927 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          4 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3441854)[0m [2025-06-04 19:22:37,077] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3441854)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=8, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_a439be47 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_a439be47 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.97058 â”‚
â”‚ gamma                                4.6341 â”‚
â”‚ learning_rate                         5e-05 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3442015)[0m [2025-06-04 19:22:44,024] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3441854)[0m {'loss': 0.0604, 'grad_norm': 1.1360447406768799, 'learning_rate': 1.176394468215133e-05, 'epoch': 1.0}
[36m(train_hpo pid=3442015)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3441854)[0m {'loss': 0.0523, 'grad_norm': 0.7846565246582031, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.0}

Trial train_hpo_a5d675bb started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_a5d675bb config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.78112 â”‚
â”‚ gamma                               6.80707 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          2 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3442365)[0m [2025-06-04 19:22:50,645] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3442365)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=4, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3442015)[0m {'loss': 0.0027, 'grad_norm': 0.023526381701231003, 'learning_rate': 3.612785445936571e-05, 'epoch': 1.0}
[36m(train_hpo pid=3441854)[0m {'train_runtime': 16.458, 'train_samples_per_second': 48.122, 'train_steps_per_second': 0.486, 'train_loss': 0.05511652585119009, 'epoch': 2.8}
[36m(train_hpo pid=3441854)[0m STATE at ending of training  :  TrainerState(epoch=2.8, global_step=8, max_steps=8, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=146288433303552.0, log_history=[{'loss': 0.0604, 'grad_norm': 1.1360447406768799, 'learning_rate': 1.176394468215133e-05, 'epoch': 1.0, 'step': 3}, {'loss': 0.0523, 'grad_norm': 0.7846565246582031, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.0, 'step': 6}, {'loss': 0.0514, 'grad_norm': 0.8988322019577026, 'learning_rate': 0.0, 'epoch': 2.8, 'step': 8}, {'train_runtime': 16.458, 'train_samples_per_second': 48.122, 'train_steps_per_second': 0.486, 'total_flos': 146288433303552.0, 'train_loss': 0.05511652585119009, 'epoch': 2.8, 'step': 8}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})2025-06-04 19:23:01,136 - INFO - Cleaning up trial 108b74c3
2025-06-04 19:23:01,136 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-22-29/train_hpo_108b74c3_1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364_2025-06-04_19-22-29
[36m(train_hpo pid=3441854)[0m 2025-06-04 19:23:01,072 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3441854)[0m 2025-06-04 19:23:01,078 - INFO - eval_result: {'eval_loss': 0.04840618371963501, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.5358782410621643, 'eval_AP': 0.8419457441209552, 'eval_MCC': 0.0, 'eval_NDCG': 0.9557613110697747, 'eval_kappa': 0.0, 'eval_runtime': 4.1891, 'eval_samples_per_second': 15.994, 'eval_steps_per_second': 0.955, 'epoch': 2.8}
[36m(train_hpo pid=3441854)[0m 2025-06-04 19:23:01,112 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
2025-06-04 19:23:03,731 - INFO - Cleaning up trial a5d675bb
2025-06-04 19:23:03,731 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-22-29/train_hpo_a5d675bb_3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512_2025-06-04_19-22-43
2025-06-04 19:23:03,731 - INFO - Cleaning up trial 108b74c3
2025-06-04 19:23:03,731 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-22-29/train_hpo_108b74c3_1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364_2025-06-04_19-22-29


Trial status: 3 RUNNING
Current time: 2025-06-04 19:22:59. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_108b74c3   RUNNING    0.625202   2.69927       1.88223e-05         0.13641                     4 â”‚
â”‚ train_hpo_a439be47   RUNNING    0.970578   4.6341        5.16112e-05         0.123031                    5 â”‚
â”‚ train_hpo_a5d675bb   RUNNING    0.78112    6.80707       1.88581e-05         0.251217                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3442365)[0m STATE at ending of training  :  TrainerState(epoch=1.4, global_step=4, max_steps=4, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=73144216651776.0, log_history=[{'loss': 0.0021, 'grad_norm': 0.019903024658560753, 'learning_rate': 4.714527732738613e-06, 'epoch': 1.0, 'step': 3}, {'loss': 0.0023, 'grad_norm': 0.014394567348062992, 'learning_rate': 0.0, 'epoch': 1.4, 'step': 4}, {'train_runtime': 5.8046, 'train_samples_per_second': 68.222, 'train_steps_per_second': 0.689, 'total_flos': 73144216651776.0, 'train_loss': 0.0021532587707042694, 'epoch': 1.4, 'step': 4}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_108b74c3 finished iteration 1 at 2025-06-04 19:23:01. Total running time: 31s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_108b74c3 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    24.8004 â”‚
â”‚ time_total_s                        24.8004 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   2.8 â”‚
â”‚ eval_AP                             0.84195 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.95576 â”‚
â”‚ eval_accuracy                       0.73134 â”‚
â”‚ eval_f1                             0.84483 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           0.04841 â”‚
â”‚ eval_optim_threshold                0.53588 â”‚
â”‚ eval_precision                      0.73134 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         4.1891 â”‚
â”‚ eval_samples_per_second              15.994 â”‚
â”‚ eval_steps_per_second                 0.955 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_108b74c3 completed after 1 iterations at 2025-06-04 19:23:01. Total running time: 31s
[36m(train_hpo pid=3441854)[0m {'eval_loss': 0.04840618371963501, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.5358782410621643, 'eval_AP': 0.8419457441209552, 'eval_MCC': 0.0, 'eval_NDCG': 0.9557613110697747, 'eval_kappa': 0.0, 'eval_runtime': 4.1891, 'eval_samples_per_second': 15.994, 'eval_steps_per_second': 0.955, 'epoch': 2.8}

Trial train_hpo_a5d675bb finished iteration 1 at 2025-06-04 19:23:03. Total running time: 34s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_a5d675bb result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                     13.733 â”‚
â”‚ time_total_s                         13.733 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   1.4 â”‚
â”‚ eval_AP                              0.9364 â”‚
â”‚ eval_MCC                            0.20309 â”‚
â”‚ eval_NDCG                           0.98688 â”‚
â”‚ eval_accuracy                       0.74627 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                          0.07922 â”‚
â”‚ eval_loss                           0.00194 â”‚
â”‚ eval_optim_threshold                0.57628 â”‚
â”‚ eval_precision                      0.74242 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.9302 â”‚
â”‚ eval_samples_per_second              17.047 â”‚
â”‚ eval_steps_per_second                 1.018 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_a5d675bb completed after 1 iterations at 2025-06-04 19:23:03. Total running time: 34s
[36m(train_hpo pid=3442015)[0m {'loss': 0.0009, 'grad_norm': 0.02359703928232193, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.0}[32m [repeated 4x across cluster][0m
[36m(train_hpo pid=3442365)[0m {'train_runtime': 5.8046, 'train_samples_per_second': 68.222, 'train_steps_per_second': 0.689, 'train_loss': 0.0021532587707042694, 'epoch': 1.4}
[36m(train_hpo pid=3442015)[0m {'train_runtime': 19.296, 'train_samples_per_second': 51.306, 'train_steps_per_second': 0.518, 'train_loss': 0.0012641420878935605, 'epoch': 3.4}
[36m(train_hpo pid=3442015)[0m STATE at ending of training  :  TrainerState(epoch=3.4, global_step=10, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=177335259076608.0, log_history=[{'loss': 0.0027, 'grad_norm': 0.023526381701231003, 'learning_rate': 3.612785445936571e-05, 'epoch': 1.0, 'step': 3}, {'loss': 0.0009, 'grad_norm': 0.02359703928232193, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.0, 'step': 6}, {'loss': 0.0005, 'grad_norm': 0.014542515389621258, 'learning_rate': 5.161122065623674e-06, 'epoch': 3.0, 'step': 9}, {'loss': 0.0004, 'grad_norm': 0.023901620879769325, 'learning_rate': 0.0, 'epoch': 3.4, 'step': 10}, {'train_runtime': 19.296, 'train_samples_per_second': 51.306, 'train_steps_per_second': 0.518, 'total_flos': 177335259076608.0, 'train_loss': 0.0012641420878935605, 'epoch': 3.4, 'step': 10}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3442365)[0m {'eval_loss': 0.001935828709974885, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.5762794017791748, 'eval_AP': 0.9363989725100714, 'eval_MCC': 0.2030905986149808, 'eval_NDCG': 0.9868810503392481, 'eval_kappa': 0.0792239288601454, 'eval_runtime': 3.9302, 'eval_samples_per_second': 17.047, 'eval_steps_per_second': 1.018, 'epoch': 1.4}2025-06-04 19:23:10,009 - INFO - Cleaning up trial a439be47
2025-06-04 19:23:10,009 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-22-29/train_hpo_a439be47_2_alpha=0.9706,gamma=4.6341,learning_rate=0.0001,num_train_epochs=5,weight_decay=0.1230_2025-06-04_19-22-36
2025-06-04 19:23:10,009 - INFO - Cleaning up trial 108b74c3
2025-06-04 19:23:10,009 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-22-29/train_hpo_108b74c3_1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364_2025-06-04_19-22-29
2025-06-04 19:23:10,010 - INFO - Cleaning up trial a5d675bb
2025-06-04 19:23:10,010 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-22-29/train_hpo_a5d675bb_3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512_2025-06-04_19-22-43
2025-06-04 19:23:10,017	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-22-29' in 0.0055s.
[36m(train_hpo pid=3442015)[0m 2025-06-04 19:23:09,945 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3442015)[0m 2025-06-04 19:23:09,951 - INFO - eval_result: {'eval_loss': 0.0010891270358115435, 'eval_f1': 0.9074074074074074, 'eval_recall': 1.0, 'eval_accuracy': 0.8507462686567164, 'eval_precision': 0.8305084745762712, 'eval_optim_threshold': 0.7586296200752258, 'eval_AP': 0.9984597612629958, 'eval_MCC': 0.6075482512438447, 'eval_NDCG': 0.9997312822350676, 'eval_kappa': 0.5392022008253095, 'eval_runtime': 3.3639, 'eval_samples_per_second': 19.917, 'eval_steps_per_second': 1.189, 'epoch': 3.4}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3442015)[0m 2025-06-04 19:23:09,984 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB[32m [repeated 2x across cluster][0m
2025-06-04 19:23:10,024 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x719abc11d550>
2025-06-04 19:23:10,025 - INFO - Best trial : train_hpo_a439be47
2025-06-04 19:23:10,025 - INFO - Best config : {'alpha': 0.970577641092792, 'gamma': 4.634102840173219, 'learning_rate': 5.1611220656236736e-05, 'weight_decay': 0.12303118765599412, 'num_train_epochs': 5}
2025-06-04 19:23:10,025 - INFO - Best trial after optimization: {'eval_loss': 0.0010891270358115435, 'eval_f1': 0.9074074074074074, 'eval_recall': 1.0, 'eval_accuracy': 0.8507462686567164, 'eval_precision': 0.8305084745762712, 'eval_optim_threshold': 0.7586296200752258, 'eval_AP': 0.9984597612629958, 'eval_MCC': 0.6075482512438447, 'eval_NDCG': 0.9997312822350676, 'eval_kappa': 0.5392022008253095, 'eval_runtime': 3.3639, 'eval_samples_per_second': 19.917, 'eval_steps_per_second': 1.189, 'epoch': 3.4, 'timestamp': 1749057790, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': 'a439be47', 'date': '2025-06-04_19-23-10', 'time_this_iter_s': 26.822111129760742, 'time_total_s': 26.822111129760742, 'pid': 3442015, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'alpha': 0.970577641092792, 'gamma': 4.634102840173219, 'learning_rate': 5.1611220656236736e-05, 'weight_decay': 0.12303118765599412, 'num_train_epochs': 5}, 'time_since_restore': 26.822111129760742, 'iterations_since_restore': 1, 'experiment_tag': '2_alpha=0.9706,gamma=4.6341,learning_rate=0.0001,num_train_epochs=5,weight_decay=0.1230'}
2025-06-04 19:23:10,055 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   0.048406  0.844828  ...                        4  108b74c3
1   0.001089  0.907407  ...                        5  a439be47
2   0.001936  0.852174  ...                        2  a5d675bb

[3 rows x 33 columns]
2025-06-04 19:23:10,192 - INFO - Trial comparison plot saved
2025-06-04 19:23:10,192 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-04 19:23:10,418 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.25 and gamma=2.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-04 19:23:10,531 - INFO - training size : 198
2025-06-04 19:23:10,532 - INFO - dev size : 67
2025-06-04 19:23:10,532 - INFO - test size : 132
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(


Trial train_hpo_a439be47 finished iteration 1 at 2025-06-04 19:23:10. Total running time: 40s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_a439be47 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    26.8221 â”‚
â”‚ time_total_s                        26.8221 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   3.4 â”‚
â”‚ eval_AP                             0.99846 â”‚
â”‚ eval_MCC                            0.60755 â”‚
â”‚ eval_NDCG                           0.99973 â”‚
â”‚ eval_accuracy                       0.85075 â”‚
â”‚ eval_f1                             0.90741 â”‚
â”‚ eval_kappa                           0.5392 â”‚
â”‚ eval_loss                           0.00109 â”‚
â”‚ eval_optim_threshold                0.75863 â”‚
â”‚ eval_precision                      0.83051 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.3639 â”‚
â”‚ eval_samples_per_second              19.917 â”‚
â”‚ eval_steps_per_second                 1.189 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_a439be47 completed after 1 iterations at 2025-06-04 19:23:10. Total running time: 40s

Trial status: 3 TERMINATED
Current time: 2025-06-04 19:23:10. Total running time: 40s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_108b74c3   TERMINATED   0.625202   2.69927       1.88223e-05         0.13641                     4        1            24.8004    0.0484062     0.844828               1          0.731343 â”‚
â”‚ train_hpo_a439be47   TERMINATED   0.970578   4.6341        5.16112e-05         0.123031                    5        1            26.8221    0.00108913    0.907407               1          0.850746 â”‚
â”‚ train_hpo_a5d675bb   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            13.733     0.00193583    0.852174               1          0.746269 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

[36m(train_hpo pid=3442015)[0m {'eval_loss': 0.0010891270358115435, 'eval_f1': 0.9074074074074074, 'eval_recall': 1.0, 'eval_accuracy': 0.8507462686567164, 'eval_precision': 0.8305084745762712, 'eval_optim_threshold': 0.7586296200752258, 'eval_AP': 0.9984597612629958, 'eval_MCC': 0.6075482512438447, 'eval_NDCG': 0.9997312822350676, 'eval_kappa': 0.5392022008253095, 'eval_runtime': 3.3639, 'eval_samples_per_second': 19.917, 'eval_steps_per_second': 1.189, 'epoch': 3.4}
[36m(train_hpo pid=3442015)[0m {'loss': 0.0004, 'grad_norm': 0.023901620879769325, 'learning_rate': 0.0, 'epoch': 3.4}[32m [repeated 2x across cluster][0m
  0%|          | 0/45 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  2%|â–         | 1/45 [00:00<00:28,  1.54it/s]  4%|â–         | 2/45 [00:01<00:27,  1.59it/s]  7%|â–‹         | 3/45 [00:01<00:26,  1.60it/s]  9%|â–‰         | 4/45 [00:02<00:25,  1.61it/s] 11%|â–ˆ         | 5/45 [00:03<00:24,  1.61it/s] 13%|â–ˆâ–Ž        | 6/45 [00:03<00:24,  1.61it/s] 16%|â–ˆâ–Œ        | 7/45 [00:04<00:23,  1.62it/s] 18%|â–ˆâ–Š        | 8/45 [00:04<00:22,  1.63it/s] 20%|â–ˆâ–ˆ        | 9/45 [00:05<00:18,  1.91it/s]                                               20%|â–ˆâ–ˆ        | 9/45 [00:05<00:18,  1.91it/s] 22%|â–ˆâ–ˆâ–       | 10/45 [00:05<00:19,  1.79it/s] 24%|â–ˆâ–ˆâ–       | 11/45 [00:06<00:19,  1.74it/s] 27%|â–ˆâ–ˆâ–‹       | 12/45 [00:07<00:19,  1.70it/s] 29%|â–ˆâ–ˆâ–‰       | 13/45 [00:07<00:19,  1.67it/s] 31%|â–ˆâ–ˆâ–ˆ       | 14/45 [00:08<00:18,  1.66it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 15/45 [00:09<00:18,  1.64it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 16/45 [00:09<00:17,  1.63it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 17/45 [00:10<00:17,  1.64it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 18/45 [00:10<00:14,  1.91it/s]                                                40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 18/45 [00:10<00:14,  1.91it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 19/45 [00:11<00:14,  1.79it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 20/45 [00:11<00:14,  1.73it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 21/45 [00:12<00:14,  1.70it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 22/45 [00:13<00:13,  1.67it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 23/45 [00:13<00:13,  1.66it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 24/45 [00:14<00:12,  1.65it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 25/45 [00:14<00:12,  1.64it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 26/45 [00:15<00:11,  1.65it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 27/45 [00:15<00:09,  1.91it/s]                                                60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 27/45 [00:15<00:09,  1.91it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 28/45 [00:16<00:09,  1.80it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 29/45 [00:17<00:09,  1.74it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 30/45 [00:17<00:08,  1.70it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 31/45 [00:18<00:08,  1.68it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 32/45 [00:18<00:07,  1.66it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 33/45 [00:19<00:07,  1.64it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 34/45 [00:20<00:06,  1.64it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 35/45 [00:20<00:06,  1.64it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 36/45 [00:21<00:04,  1.91it/s]                                                80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 36/45 [00:21<00:04,  1.91it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 37/45 [00:21<00:04,  1.79it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 38/45 [00:22<00:04,  1.74it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 39/45 [00:22<00:03,  1.70it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 40/45 [00:23<00:02,  1.68it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 41/45 [00:24<00:02,  1.66it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 42/45 [00:24<00:01,  1.65it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 43/45 [00:25<00:01,  1.64it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 44/45 [00:26<00:00,  1.65it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45/45 [00:26<00:00,  1.92it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45/45 [00:28<00:00,  1.92it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45/45 [00:28<00:00,  1.92it/s]2025-06-04 19:23:39,110 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45/45 [00:28<00:00,  1.60it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
{'loss': 0.003, 'grad_norm': 0.15121445059776306, 'learning_rate': 4.128897652498939e-05, 'epoch': 1.0}
{'loss': 0.0004, 'grad_norm': 0.011312385089695454, 'learning_rate': 3.096673239374204e-05, 'epoch': 2.0}
{'loss': 0.0001, 'grad_norm': 0.0023280216846615076, 'learning_rate': 2.0644488262494696e-05, 'epoch': 3.0}
{'loss': 0.0, 'grad_norm': 0.0024036613758653402, 'learning_rate': 1.0322244131247348e-05, 'epoch': 4.0}
{'loss': 0.0, 'grad_norm': 0.0013230160111561418, 'learning_rate': 0.0, 'epoch': 5.0}
{'train_runtime': 28.1158, 'train_samples_per_second': 35.211, 'train_steps_per_second': 1.601, 'train_loss': 0.0007040418581002289, 'epoch': 5.0}
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.21it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.39it/s]2025-06-04 19:23:43,077 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.22s/it]
2025-06-04 19:23:43,083 - INFO - Training time : 32.89117353409529
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.10it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.02it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.34it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.09it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.31it/s]2025-06-04 19:23:47,574 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.43it/s]
2025-06-04 19:23:47,579 - INFO - Evaluation time : 4.4954645349644125
2025-06-04 19:23:47,579 - INFO - Evaluation results on test set: {'eval_loss': 1.3279563063406385e-05, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.7562445998191833, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000004, 'eval_kappa': 1.0, 'eval_runtime': 4.4896, 'eval_samples_per_second': 29.401, 'eval_steps_per_second': 1.336, 'epoch': 5.0}
2025-06-04 19:23:47,579 - INFO - Total updates (optimizer steps): 45
2025-06-04 19:23:47,579 - INFO - Avg time / step: 0.625s
2025-06-04 19:23:48,109 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_focalgoogle-bert/bert-base-uncased3trials_fold-2
2025-06-04 19:23:48,109 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.11it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.03it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.35it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.09it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.32it/s]2025-06-04 19:23:52,501 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.47it/s]
2025-06-04 19:23:52,505 - INFO - preds : [1 1 0 1 1 1 1 1 1 0 1 0 1 1 0 1 1 1 1 1 1 0 1 1 1 1 1 1 0 1 1 0 1 1 1 1 1
 1 1 1 1 1 0 0 1 0 1 0 0 1 0 0 1 1 1 1 0 0 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 1 0 1 1 1 1 1 1 0 1 0 1 1 1 1 1 0 1 1 1 0 1
 1 0 1 1 1 0 0 1 0 0 1 1 1 1 1 1 1 0 1 1 1]
2025-06-04 19:23:52,506 - INFO - test_split["labels"] : [1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1]
2025-06-04 19:23:52,508 - INFO - Confusion matrix: TN=34, FP=0, FN=0, TP=98
2025-06-04 19:23:55,262 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 34, 'FP': 0, 'FN': 0, 'TP': 98}
2025-06-04 19:23:55,384 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-04 19:23:55,483 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:23:55,483 - INFO - 
On test Set (optimal threshold of 0.8706048727035522 according to cross validation on the training set): 
2025-06-04 19:23:55,485 - INFO - Confusion matrix: TN=34, FP=0, FN=3, TP=95
2025-06-04 19:23:58,350 - INFO - Metrics: {'f1': 0.9844559585492227, 'recall': 0.9693877551020408, 'precision': 1.0, 'accuracy': 0.9772727272727273, 'AP': 1.0, 'MCC': 0.9438160561950645, 'NDCG': 1.0000000000000004, 'kappa': 0.9422403733955659, 'TN': 34, 'FP': 0, 'FN': 3, 'TP': 95}
2025-06-04 19:23:58,456 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:23:58,456 - INFO - Results for fold 2 : [{'f1': 0.9844559585492227, 'recall': 0.9693877551020408, 'precision': 1.0, 'accuracy': 0.9772727272727273, 'AP': 1.0, 'MCC': 0.9438160561950645, 'NDCG': 1.0000000000000004, 'kappa': 0.9422403733955659, 'TN': 34, 'FP': 0, 'FN': 3, 'TP': 95}]
2025-06-04 19:23:58,575 - INFO - Cleared CUDA cache. Memory allocated: 1.41 GB, Memory reserved: 1.82 GB
2025-06-04 19:23:58,575 - INFO - 
fold number 3 / 3
2025-06-04 19:23:58,581 - INFO - train split size : 198
2025-06-04 19:23:58,581 - INFO - dev split size : 67
2025-06-04 19:23:58,581 - INFO - test split size : 132
Map (num_proc=32):   0%|          | 0/198 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–Ž         | 7/198 [00:00<00:05, 37.96 examples/s]Map (num_proc=32):  18%|â–ˆâ–Š        | 35/198 [00:00<00:01, 134.74 examples/s]Map (num_proc=32):  36%|â–ˆâ–ˆâ–ˆâ–‹      | 72/198 [00:00<00:00, 219.50 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 102/198 [00:00<00:00, 244.41 examples/s]Map (num_proc=32):  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 138/198 [00:00<00:00, 266.05 examples/s]Map (num_proc=32):  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 168/198 [00:00<00:00, 265.24 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 198/198 [00:00<00:00, 206.07 examples/s]
Map (num_proc=32):   0%|          | 0/67 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/67 [00:00<00:04, 15.33 examples/s]Map (num_proc=32):  25%|â–ˆâ–ˆâ–Œ       | 17/67 [00:00<00:00, 62.96 examples/s]Map (num_proc=32):  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 29/67 [00:00<00:00, 79.12 examples/s]Map (num_proc=32):  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 39/67 [00:00<00:00, 84.59 examples/s]Map (num_proc=32):  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 51/67 [00:00<00:00, 90.37 examples/s]Map (num_proc=32):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 63/67 [00:00<00:00, 96.48 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:00<00:00, 70.09 examples/s]
Map (num_proc=32):   0%|          | 0/132 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/132 [00:00<00:04, 28.70 examples/s]Map (num_proc=32):  18%|â–ˆâ–Š        | 24/132 [00:00<00:01, 100.59 examples/s]Map (num_proc=32):  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 44/132 [00:00<00:00, 132.51 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 68/132 [00:00<00:00, 164.25 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 88/132 [00:00<00:00, 168.37 examples/s]Map (num_proc=32):  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 112/132 [00:00<00:00, 178.62 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 132/132 [00:00<00:00, 139.20 examples/s]
2025-06-04 19:24:08,005 - INFO - 3 datasets tokenized successfully
2025-06-04 19:24:08,007 - INFO - Starting hyperparameter search for focal loss
[36m(train_hpo pid=3444531)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3444531)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3444531)[0m 2025-06-04 19:24:15,322 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.6252016107931255 and gamma=2.6992695521978884
[36m(train_hpo pid=3444531)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3444531)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3444531)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3444531)[0m   warnings.warn(
[36m(train_hpo pid=3444694)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3444694)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3444694)[0m 2025-06-04 19:24:22,107 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.970577641092792 and gamma=4.634102840173219
[36m(train_hpo pid=3444694)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3444694)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3444694)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3444694)[0m   warnings.warn(
[36m(train_hpo pid=3445044)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3445044)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3445044)[0m 2025-06-04 19:24:28,643 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.7811204413478371 and gamma=6.807074484302038
[36m(train_hpo pid=3445044)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3445044)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3445044)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3445044)[0m   warnings.warn(
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-04_19-24-08   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-24-08
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-04_18-54-36_274448_3393636/artifacts/2025-06-04_19-24-08/train_hpo_2025-06-04_19-24-08/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-04 19:24:08. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_c7d36220   PENDING    0.625202   2.69927       1.88223e-05          0.13641                    4 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_c7d36220 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_c7d36220 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                                0.6252 â”‚
â”‚ gamma                               2.69927 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          4 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3444531)[0m [2025-06-04 19:24:15,575] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3444531)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=8, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_0df33e7a started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_0df33e7a config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.97058 â”‚
â”‚ gamma                                4.6341 â”‚
â”‚ learning_rate                         5e-05 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3444694)[0m [2025-06-04 19:24:22,474] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3444531)[0m {'loss': 0.0899, 'grad_norm': 1.353543758392334, 'learning_rate': 1.176394468215133e-05, 'epoch': 1.0}
[36m(train_hpo pid=3444694)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3444531)[0m {'loss': 0.0419, 'grad_norm': 0.41624516248703003, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.0}

Trial train_hpo_3b1ef815 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_3b1ef815 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.78112 â”‚
â”‚ gamma                               6.80707 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          2 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3445044)[0m [2025-06-04 19:24:28,878] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3445044)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=4, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3444694)[0m {'loss': 0.0092, 'grad_norm': 0.05393246188759804, 'learning_rate': 3.612785445936571e-05, 'epoch': 1.0}
[36m(train_hpo pid=3444531)[0m {'train_runtime': 16.3536, 'train_samples_per_second': 48.43, 'train_steps_per_second': 0.489, 'train_loss': 0.056318871676921844, 'epoch': 2.8}
[36m(train_hpo pid=3444531)[0m STATE at ending of training  :  TrainerState(epoch=2.8, global_step=8, max_steps=8, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=146288433303552.0, log_history=[{'loss': 0.0899, 'grad_norm': 1.353543758392334, 'learning_rate': 1.176394468215133e-05, 'epoch': 1.0, 'step': 3}, {'loss': 0.0419, 'grad_norm': 0.41624516248703003, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.0, 'step': 6}, {'loss': 0.0276, 'grad_norm': 0.6768728494644165, 'learning_rate': 0.0, 'epoch': 2.8, 'step': 8}, {'train_runtime': 16.3536, 'train_samples_per_second': 48.43, 'train_steps_per_second': 0.489, 'total_flos': 146288433303552.0, 'train_loss': 0.056318871676921844, 'epoch': 2.8, 'step': 8}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})[36m(train_hpo pid=3444531)[0m 2025-06-04 19:24:39,125 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3444531)[0m 2025-06-04 19:24:39,131 - INFO - eval_result: {'eval_loss': 0.024191109463572502, 'eval_f1': 0.8521739130434782, 'eval_recall': 0.98, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.7538461538461538, 'eval_optim_threshold': 0.6356721520423889, 'eval_AP': 0.9908230222454619, 'eval_MCC': 0.09927337820337083, 'eval_NDCG': 0.9983465587588332, 'eval_kappa': 0.054771784232365284, 'eval_runtime': 3.968, 'eval_samples_per_second': 16.885, 'eval_steps_per_second': 1.008, 'epoch': 2.8}
2025-06-04 19:24:39,189 - INFO - Cleaning up trial c7d36220
2025-06-04 19:24:39,189 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-24-08/train_hpo_c7d36220_1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364_2025-06-04_19-24-08
[36m(train_hpo pid=3444531)[0m 2025-06-04 19:24:39,164 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
2025-06-04 19:24:41,601 - INFO - Cleaning up trial 3b1ef815
2025-06-04 19:24:41,601 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-24-08/train_hpo_3b1ef815_3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512_2025-06-04_19-24-21
2025-06-04 19:24:41,601 - INFO - Cleaning up trial c7d36220
2025-06-04 19:24:41,602 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-24-08/train_hpo_c7d36220_1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364_2025-06-04_19-24-08

[36m(train_hpo pid=3445044)[0m STATE at ending of training  :  TrainerState(epoch=1.4, global_step=4, max_steps=4, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=73144216651776.0, log_history=[{'loss': 0.0036, 'grad_norm': 0.12004905939102173, 'learning_rate': 4.714527732738613e-06, 'epoch': 1.0, 'step': 3}, {'loss': 0.0027, 'grad_norm': 0.1520002782344818, 'learning_rate': 0.0, 'epoch': 1.4, 'step': 4}, {'train_runtime': 5.7948, 'train_samples_per_second': 68.337, 'train_steps_per_second': 0.69, 'total_flos': 73144216651776.0, 'train_loss': 0.0033798785298131406, 'epoch': 1.4, 'step': 4}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 3 RUNNING
Current time: 2025-06-04 19:24:38. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_c7d36220   RUNNING    0.625202   2.69927       1.88223e-05         0.13641                     4 â”‚
â”‚ train_hpo_0df33e7a   RUNNING    0.970578   4.6341        5.16112e-05         0.123031                    5 â”‚
â”‚ train_hpo_3b1ef815   RUNNING    0.78112    6.80707       1.88581e-05         0.251217                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3444531)[0m {'eval_loss': 0.024191109463572502, 'eval_f1': 0.8521739130434782, 'eval_recall': 0.98, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.7538461538461538, 'eval_optim_threshold': 0.6356721520423889, 'eval_AP': 0.9908230222454619, 'eval_MCC': 0.09927337820337083, 'eval_NDCG': 0.9983465587588332, 'eval_kappa': 0.054771784232365284, 'eval_runtime': 3.968, 'eval_samples_per_second': 16.885, 'eval_steps_per_second': 1.008, 'epoch': 2.8}

Trial train_hpo_c7d36220 finished iteration 1 at 2025-06-04 19:24:39. Total running time: 31s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_c7d36220 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                     24.299 â”‚
â”‚ time_total_s                         24.299 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   2.8 â”‚
â”‚ eval_AP                             0.99082 â”‚
â”‚ eval_MCC                            0.09927 â”‚
â”‚ eval_NDCG                           0.99835 â”‚
â”‚ eval_accuracy                       0.74627 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                          0.05477 â”‚
â”‚ eval_loss                           0.02419 â”‚
â”‚ eval_optim_threshold                0.63567 â”‚
â”‚ eval_precision                      0.75385 â”‚
â”‚ eval_recall                            0.98 â”‚
â”‚ eval_runtime                          3.968 â”‚
â”‚ eval_samples_per_second              16.885 â”‚
â”‚ eval_steps_per_second                 1.008 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_c7d36220 completed after 1 iterations at 2025-06-04 19:24:39. Total running time: 31s

Trial train_hpo_3b1ef815 finished iteration 1 at 2025-06-04 19:24:41. Total running time: 33s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_3b1ef815 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    13.3625 â”‚
â”‚ time_total_s                        13.3625 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   1.4 â”‚
â”‚ eval_AP                             0.81288 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.90862 â”‚
â”‚ eval_accuracy                       0.74627 â”‚
â”‚ eval_f1                              0.8547 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           0.00256 â”‚
â”‚ eval_optim_threshold                0.53423 â”‚
â”‚ eval_precision                      0.74627 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.5645 â”‚
â”‚ eval_samples_per_second              18.796 â”‚
â”‚ eval_steps_per_second                 1.122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_3b1ef815 completed after 1 iterations at 2025-06-04 19:24:41. Total running time: 33s
[36m(train_hpo pid=3444694)[0m {'loss': 0.0035, 'grad_norm': 0.011703355237841606, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.0}[32m [repeated 4x across cluster][0m
[36m(train_hpo pid=3445044)[0m {'train_runtime': 5.7948, 'train_samples_per_second': 68.337, 'train_steps_per_second': 0.69, 'train_loss': 0.0033798785298131406, 'epoch': 1.4}
[36m(train_hpo pid=3444694)[0m {'train_runtime': 19.2061, 'train_samples_per_second': 51.546, 'train_steps_per_second': 0.521, 'train_loss': 0.004755401448346674, 'epoch': 3.4}
[36m(train_hpo pid=3444694)[0m STATE at ending of training  :  TrainerState(epoch=3.4, global_step=10, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=177335259076608.0, log_history=[{'loss': 0.0092, 'grad_norm': 0.05393246188759804, 'learning_rate': 3.612785445936571e-05, 'epoch': 1.0, 'step': 3}, {'loss': 0.0035, 'grad_norm': 0.011703355237841606, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.0, 'step': 6}, {'loss': 0.0022, 'grad_norm': 0.0353027768433094, 'learning_rate': 5.161122065623674e-06, 'epoch': 3.0, 'step': 9}, {'loss': 0.0026, 'grad_norm': 0.01604507490992546, 'learning_rate': 0.0, 'epoch': 3.4, 'step': 10}, {'train_runtime': 19.2061, 'train_samples_per_second': 51.546, 'train_steps_per_second': 0.521, 'total_flos': 177335259076608.0, 'train_loss': 0.004755401448346674, 'epoch': 3.4, 'step': 10}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3445044)[0m {'eval_loss': 0.002561787376180291, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.5342330932617188, 'eval_AP': 0.8128762940412598, 'eval_MCC': 0.0, 'eval_NDCG': 0.9086228554470078, 'eval_kappa': 0.0, 'eval_runtime': 3.5645, 'eval_samples_per_second': 18.796, 'eval_steps_per_second': 1.122, 'epoch': 1.4}2025-06-04 19:24:48,207 - INFO - Cleaning up trial 0df33e7a
2025-06-04 19:24:48,207 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-24-08/train_hpo_0df33e7a_2_alpha=0.9706,gamma=4.6341,learning_rate=0.0001,num_train_epochs=5,weight_decay=0.1230_2025-06-04_19-24-14
2025-06-04 19:24:48,207 - INFO - Cleaning up trial c7d36220
2025-06-04 19:24:48,207 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-24-08/train_hpo_c7d36220_1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364_2025-06-04_19-24-08
2025-06-04 19:24:48,208 - INFO - Current best: 3b1ef815 with eval_f1 : 0.8547008547008547 at iteration 1
[36m(train_hpo pid=3444694)[0m 2025-06-04 19:24:48,143 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3444694)[0m 2025-06-04 19:24:48,148 - INFO - eval_result: {'eval_loss': 0.0024577330332249403, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.7030234336853027, 'eval_AP': 0.9341360200232962, 'eval_MCC': 0.0, 'eval_NDCG': 0.984013299349766, 'eval_kappa': 0.0, 'eval_runtime': 3.2527, 'eval_samples_per_second': 20.598, 'eval_steps_per_second': 1.23, 'epoch': 3.4}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3444694)[0m 2025-06-04 19:24:48,182 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB[32m [repeated 2x across cluster][0m
2025-06-04 19:24:48,247	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-24-08' in 0.0085s.
2025-06-04 19:24:48,253 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x719abc374850>
2025-06-04 19:24:48,254 - INFO - Best trial : train_hpo_0df33e7a
2025-06-04 19:24:48,254 - INFO - Best config : {'alpha': 0.970577641092792, 'gamma': 4.634102840173219, 'learning_rate': 5.1611220656236736e-05, 'weight_decay': 0.12303118765599412, 'num_train_epochs': 5}
2025-06-04 19:24:48,254 - INFO - Best trial after optimization: {'eval_loss': 0.0024577330332249403, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.7030234336853027, 'eval_AP': 0.9341360200232962, 'eval_MCC': 0.0, 'eval_NDCG': 0.984013299349766, 'eval_kappa': 0.0, 'eval_runtime': 3.2527, 'eval_samples_per_second': 20.598, 'eval_steps_per_second': 1.23, 'epoch': 3.4, 'timestamp': 1749057888, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '0df33e7a', 'date': '2025-06-04_19-24-48', 'time_this_iter_s': 26.520063161849976, 'time_total_s': 26.520063161849976, 'pid': 3444694, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'alpha': 0.970577641092792, 'gamma': 4.634102840173219, 'learning_rate': 5.1611220656236736e-05, 'weight_decay': 0.12303118765599412, 'num_train_epochs': 5}, 'time_since_restore': 26.520063161849976, 'iterations_since_restore': 1, 'experiment_tag': '2_alpha=0.9706,gamma=4.6341,learning_rate=0.0001,num_train_epochs=5,weight_decay=0.1230'}
2025-06-04 19:24:48,276 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   0.024191  0.852174  ...                        4  c7d36220
1   0.002458  0.854701  ...                        5  0df33e7a
2   0.002562  0.854701  ...                        2  3b1ef815

[3 rows x 33 columns]
2025-06-04 19:24:48,455 - INFO - Trial comparison plot saved
2025-06-04 19:24:48,455 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-04 19:24:48,662 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.25 and gamma=2.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-04 19:24:48,781 - INFO - training size : 198
2025-06-04 19:24:48,782 - INFO - dev size : 67
2025-06-04 19:24:48,782 - INFO - test size : 132
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(


Trial train_hpo_0df33e7a finished iteration 1 at 2025-06-04 19:24:48. Total running time: 40s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_0df33e7a result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    26.5201 â”‚
â”‚ time_total_s                        26.5201 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   3.4 â”‚
â”‚ eval_AP                             0.93414 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.98401 â”‚
â”‚ eval_accuracy                       0.74627 â”‚
â”‚ eval_f1                              0.8547 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           0.00246 â”‚
â”‚ eval_optim_threshold                0.70302 â”‚
â”‚ eval_precision                      0.74627 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.2527 â”‚
â”‚ eval_samples_per_second              20.598 â”‚
â”‚ eval_steps_per_second                  1.23 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_0df33e7a completed after 1 iterations at 2025-06-04 19:24:48. Total running time: 40s
[36m(train_hpo pid=3444694)[0m {'eval_loss': 0.0024577330332249403, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.7030234336853027, 'eval_AP': 0.9341360200232962, 'eval_MCC': 0.0, 'eval_NDCG': 0.984013299349766, 'eval_kappa': 0.0, 'eval_runtime': 3.2527, 'eval_samples_per_second': 20.598, 'eval_steps_per_second': 1.23, 'epoch': 3.4}
[36m(train_hpo pid=3444694)[0m {'loss': 0.0026, 'grad_norm': 0.01604507490992546, 'learning_rate': 0.0, 'epoch': 3.4}[32m [repeated 2x across cluster][0m

Trial status: 3 TERMINATED
Current time: 2025-06-04 19:24:48. Total running time: 40s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_c7d36220   TERMINATED   0.625202   2.69927       1.88223e-05         0.13641                     4        1            24.299     0.0241911     0.852174            0.98          0.746269 â”‚
â”‚ train_hpo_0df33e7a   TERMINATED   0.970578   4.6341        5.16112e-05         0.123031                    5        1            26.5201    0.00245773    0.854701            1             0.746269 â”‚
â”‚ train_hpo_3b1ef815   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            13.3625    0.00256179    0.854701            1             0.746269 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

  0%|          | 0/45 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  2%|â–         | 1/45 [00:00<00:28,  1.54it/s]  4%|â–         | 2/45 [00:01<00:27,  1.59it/s]  7%|â–‹         | 3/45 [00:01<00:26,  1.60it/s]  9%|â–‰         | 4/45 [00:02<00:25,  1.61it/s] 11%|â–ˆ         | 5/45 [00:03<00:24,  1.61it/s] 13%|â–ˆâ–Ž        | 6/45 [00:03<00:24,  1.62it/s] 16%|â–ˆâ–Œ        | 7/45 [00:04<00:23,  1.62it/s] 18%|â–ˆâ–Š        | 8/45 [00:04<00:22,  1.63it/s] 20%|â–ˆâ–ˆ        | 9/45 [00:05<00:18,  1.91it/s]                                               20%|â–ˆâ–ˆ        | 9/45 [00:05<00:18,  1.91it/s] 22%|â–ˆâ–ˆâ–       | 10/45 [00:05<00:19,  1.79it/s] 24%|â–ˆâ–ˆâ–       | 11/45 [00:06<00:19,  1.74it/s] 27%|â–ˆâ–ˆâ–‹       | 12/45 [00:07<00:19,  1.70it/s] 29%|â–ˆâ–ˆâ–‰       | 13/45 [00:07<00:19,  1.67it/s] 31%|â–ˆâ–ˆâ–ˆ       | 14/45 [00:08<00:18,  1.65it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 15/45 [00:09<00:18,  1.64it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 16/45 [00:09<00:17,  1.64it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 17/45 [00:10<00:17,  1.64it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 18/45 [00:10<00:14,  1.91it/s]                                                40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 18/45 [00:10<00:14,  1.91it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 19/45 [00:11<00:14,  1.80it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 20/45 [00:11<00:14,  1.74it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 21/45 [00:12<00:14,  1.70it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 22/45 [00:13<00:13,  1.68it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 23/45 [00:13<00:13,  1.66it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 24/45 [00:14<00:12,  1.65it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 25/45 [00:14<00:12,  1.64it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 26/45 [00:15<00:11,  1.65it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 27/45 [00:15<00:09,  1.91it/s]                                                60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 27/45 [00:15<00:09,  1.91it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 28/45 [00:16<00:09,  1.79it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 29/45 [00:17<00:09,  1.74it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 30/45 [00:17<00:08,  1.70it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 31/45 [00:18<00:08,  1.67it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 32/45 [00:18<00:07,  1.66it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 33/45 [00:19<00:07,  1.65it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 34/45 [00:20<00:06,  1.64it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 35/45 [00:20<00:06,  1.64it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 36/45 [00:21<00:04,  1.91it/s]                                                80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 36/45 [00:21<00:04,  1.91it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 37/45 [00:21<00:04,  1.79it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 38/45 [00:22<00:04,  1.73it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 39/45 [00:22<00:03,  1.70it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 40/45 [00:23<00:02,  1.67it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 41/45 [00:24<00:02,  1.66it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 42/45 [00:24<00:01,  1.64it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 43/45 [00:25<00:01,  1.64it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 44/45 [00:26<00:00,  1.64it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45/45 [00:26<00:00,  1.91it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45/45 [00:28<00:00,  1.91it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45/45 [00:28<00:00,  1.91it/s]2025-06-04 19:25:17,485 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 45/45 [00:28<00:00,  1.59it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
{'loss': 0.0066, 'grad_norm': 0.14589308202266693, 'learning_rate': 4.128897652498939e-05, 'epoch': 1.0}
{'loss': 0.0025, 'grad_norm': 0.12407248467206955, 'learning_rate': 3.096673239374204e-05, 'epoch': 2.0}
{'loss': 0.0017, 'grad_norm': 0.023241594433784485, 'learning_rate': 2.0644488262494696e-05, 'epoch': 3.0}
{'loss': 0.0014, 'grad_norm': 0.006943734362721443, 'learning_rate': 1.0322244131247348e-05, 'epoch': 4.0}
{'loss': 0.0012, 'grad_norm': 0.044726669788360596, 'learning_rate': 0.0, 'epoch': 5.0}
{'train_runtime': 28.2433, 'train_samples_per_second': 35.053, 'train_steps_per_second': 1.593, 'train_loss': 0.002670622430741787, 'epoch': 5.0}
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.21it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.40it/s]2025-06-04 19:25:21,114 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.11s/it]
2025-06-04 19:25:21,120 - INFO - Training time : 32.66413058503531
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.14it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.04it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.37it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.10it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.32it/s]2025-06-04 19:25:25,618 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.43it/s]
2025-06-04 19:25:25,623 - INFO - Evaluation time : 4.5034274510107934
2025-06-04 19:25:25,623 - INFO - Evaluation results on test set: {'eval_loss': 0.0010845507495105267, 'eval_f1': 0.8471615720524017, 'eval_recall': 1.0, 'eval_accuracy': 0.7348484848484849, 'eval_precision': 0.7348484848484849, 'eval_optim_threshold': 0.7225633263587952, 'eval_AP': 0.9999999999999999, 'eval_MCC': 0.0, 'eval_NDCG': 1.0000000000000004, 'eval_kappa': 0.0, 'eval_runtime': 4.4988, 'eval_samples_per_second': 29.341, 'eval_steps_per_second': 1.334, 'epoch': 5.0}
2025-06-04 19:25:25,623 - INFO - Total updates (optimizer steps): 45
2025-06-04 19:25:25,623 - INFO - Avg time / step: 0.628s
2025-06-04 19:25:26,124 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_focalgoogle-bert/bert-base-uncased3trials_fold-3
2025-06-04 19:25:26,124 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.08it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.03it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.36it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.11it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.32it/s]2025-06-04 19:25:30,535 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.46it/s]
2025-06-04 19:25:30,540 - INFO - preds : [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
2025-06-04 19:25:30,541 - INFO - test_split["labels"] : [1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1]
2025-06-04 19:25:30,542 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:25:33,363 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': 0.9999999999999999, 'MCC': 0.0, 'NDCG': 1.0000000000000004, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:25:33,483 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-04 19:25:33,584 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:25:33,584 - INFO - 
On test Set (optimal threshold of 0.7492254376411438 according to cross validation on the training set): 
2025-06-04 19:25:33,586 - INFO - Confusion matrix: TN=35, FP=0, FN=1, TP=96
2025-06-04 19:25:36,310 - INFO - Metrics: {'f1': 0.9948186528497409, 'recall': 0.9896907216494846, 'precision': 1.0, 'accuracy': 0.9924242424242424, 'AP': 0.9999999999999999, 'MCC': 0.9809175871166632, 'NDCG': 1.0000000000000004, 'kappa': 0.9807355516637478, 'TN': 35, 'FP': 0, 'FN': 1, 'TP': 96}
2025-06-04 19:25:36,441 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:25:36,441 - INFO - Results for fold 3 : [{'f1': 0.9948186528497409, 'recall': 0.9896907216494846, 'precision': 1.0, 'accuracy': 0.9924242424242424, 'AP': 0.9999999999999999, 'MCC': 0.9809175871166632, 'NDCG': 1.0000000000000004, 'kappa': 0.9807355516637478, 'TN': 35, 'FP': 0, 'FN': 1, 'TP': 96}]
2025-06-04 19:25:36,561 - INFO - Cleared CUDA cache. Memory allocated: 1.42 GB, Memory reserved: 1.76 GB
2025-06-04 19:25:36,561 - INFO - Cleared CUDA cache. Memory allocated: 1.42 GB, Memory reserved: 1.76 GB
2025-06-04 19:25:36,606 - INFO - Cleared CUDA cache. Memory allocated: 0.02 GB, Memory reserved: 0.03 GB
2025-06-04 19:25:36,619 - INFO - Metrics for google-bert/bert-base-uncased:                       model_name fold loss_type run  ...    TN    FP   FN    TP
0  google-bert/bert-base-uncased    1     focal   1  ...  34.0   1.0  0.0  98.0
0  google-bert/bert-base-uncased    2     focal   1  ...  34.0   0.0  0.0  98.0
0  google-bert/bert-base-uncased    3     focal   1  ...   0.0  35.0  0.0  97.0

[3 rows x 18 columns]
2025-06-04 19:25:36,619 - INFO - 
fold number 1 / 3
2025-06-04 19:25:36,626 - INFO - Confusion matrix: TN=34, FP=1, FN=0, TP=98
2025-06-04 19:25:39,661 - INFO - Metrics: {'f1': 0.9949238578680203, 'recall': 1.0, 'precision': 0.98989898989899, 'accuracy': 0.9924812030075187, 'AP': 1.0, 'MCC': 0.9806202943118002, 'NDCG': 1.0000000000000004, 'kappa': 0.98043254376931, 'TN': 34, 'FP': 1, 'FN': 0, 'TP': 98}
2025-06-04 19:25:39,663 - INFO - 
fold number 2 / 3
2025-06-04 19:25:39,667 - INFO - Confusion matrix: TN=34, FP=0, FN=0, TP=98
2025-06-04 19:25:42,411 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 34, 'FP': 0, 'FN': 0, 'TP': 98}
2025-06-04 19:25:42,413 - INFO - 
fold number 3 / 3
2025-06-04 19:25:42,417 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:25:45,168 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': 0.9999999999999999, 'MCC': 0.0, 'NDCG': 1.0000000000000004, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:25:45,176 - INFO - fold indexes for run no.2: [[284, 266, 388, 393, 133, 13, 20, 176, 269, 308, 45, 193, 147, 19, 168, 230, 151, 384, 157, 153, 149, 327, 321, 381, 385, 330, 199, 72, 142, 10, 47, 270, 377, 73, 0, 118, 184, 65, 343, 219, 86, 357, 201, 226, 264, 223, 33, 114, 67, 268, 182, 310, 53, 246, 145, 76, 320, 373, 280, 95, 254, 113, 154, 160, 228, 306, 325, 99, 355, 356, 125, 166, 346, 286, 102, 354, 92, 336, 81, 159, 52, 304, 323, 111, 96, 274, 236, 41, 91, 32, 90, 367, 179, 130, 74, 334, 378, 208, 77, 396, 361, 6, 332, 238, 222, 277, 365, 36, 256, 21, 260, 38, 234, 341, 173, 124, 183, 31, 202, 203, 196, 119, 150, 263, 105, 126, 48, 143, 289, 231, 324, 352, 186, 155, 292, 217, 198, 316, 109, 287, 44, 49, 82, 15, 309, 83, 135, 218, 305, 283, 122, 127, 290, 35, 85, 98, 271, 141, 167, 295, 93, 27, 262, 229, 273, 9, 370, 89, 129, 197, 164, 205, 347, 171, 178, 70, 140, 372, 100, 314, 69, 4, 301, 265, 244, 101, 248, 358, 364, 94, 296, 87, 307, 239, 192, 50, 169, 39], [326, 210, 250, 319, 380, 279, 293, 288, 220, 253, 162, 43, 152, 8, 221, 235, 297, 339, 331, 61, 106, 181, 329, 243, 375, 88, 257, 194, 117, 104, 55, 349, 14, 108, 62, 281, 282, 2, 63, 240, 351, 107, 97, 187, 215, 54, 80, 232, 318, 241, 303, 252, 29, 139, 247, 362, 51, 390, 285, 392, 174, 298, 5, 335, 294, 28], array([  1,   3,   7,  11,  12,  16,  17,  18,  22,  23,  24,  25,  26,
        30,  34,  37,  40,  42,  46,  56,  57,  58,  59,  60,  64,  66,
        68,  71,  75,  78,  79,  84, 103, 110, 112, 115, 116, 120, 121,
       123, 128, 131, 132, 134, 136, 137, 138, 144, 146, 148, 156, 158,
       161, 163, 165, 170, 172, 175, 177, 180, 185, 188, 189, 190, 191,
       195, 200, 204, 206, 207, 209, 211, 212, 213, 214, 216, 224, 225,
       227, 233, 237, 242, 245, 249, 251, 255, 258, 259, 261, 267, 272,
       275, 276, 278, 291, 299, 300, 302, 311, 312, 313, 315, 317, 322,
       328, 333, 337, 338, 340, 342, 344, 345, 348, 350, 353, 359, 360,
       363, 366, 368, 369, 371, 374, 376, 379, 382, 383, 386, 387, 389,
       391, 394, 395])]
2025-06-04 19:25:45,176 - INFO - Run no 2/2
2025-06-04 19:25:45,176 - INFO - Loss Type : focal
2025-06-04 19:25:45,176 - INFO - Ensemble learning pipeline
2025-06-04 19:25:45,176 - INFO - Training model 1/2: dmis-lab/biobert-v1.1
2025-06-04 19:25:45,349 - INFO - 
fold number 1 / 3
2025-06-04 19:25:45,354 - INFO - train split size : 198
2025-06-04 19:25:45,355 - INFO - dev split size : 66
2025-06-04 19:25:45,355 - INFO - test split size : 133
Map (num_proc=32):   0%|          | 0/198 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–Ž         | 7/198 [00:00<00:04, 38.69 examples/s]Map (num_proc=32):  27%|â–ˆâ–ˆâ–‹       | 54/198 [00:00<00:00, 201.41 examples/s]Map (num_proc=32):  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 90/198 [00:00<00:00, 243.35 examples/s]Map (num_proc=32):  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 126/198 [00:00<00:00, 263.24 examples/s]Map (num_proc=32):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 162/198 [00:00<00:00, 278.13 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 198/198 [00:00<00:00, 223.92 examples/s]
Map (num_proc=32):   0%|          | 0/66 [00:00<?, ? examples/s]Map (num_proc=32):   5%|â–         | 3/66 [00:00<00:03, 16.20 examples/s]Map (num_proc=32):  24%|â–ˆâ–ˆâ–       | 16/66 [00:00<00:00, 60.48 examples/s]Map (num_proc=32):  39%|â–ˆâ–ˆâ–ˆâ–‰      | 26/66 [00:00<00:00, 74.23 examples/s]Map (num_proc=32):  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 38/66 [00:00<00:00, 85.58 examples/s]Map (num_proc=32):  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 48/66 [00:00<00:00, 89.91 examples/s]Map (num_proc=32):  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 58/66 [00:00<00:00, 92.59 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 66/66 [00:00<00:00, 71.52 examples/s]
Map (num_proc=32):   0%|          | 0/133 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/133 [00:00<00:04, 26.59 examples/s]Map (num_proc=32):  22%|â–ˆâ–ˆâ–       | 29/133 [00:00<00:00, 117.43 examples/s]Map (num_proc=32):  37%|â–ˆâ–ˆâ–ˆâ–‹      | 49/133 [00:00<00:00, 148.64 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 69/133 [00:00<00:00, 165.53 examples/s]Map (num_proc=32):  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 93/133 [00:00<00:00, 180.53 examples/s]Map (num_proc=32):  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 117/133 [00:00<00:00, 189.69 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 133/133 [00:00<00:00, 144.61 examples/s]
2025-06-04 19:25:54,318 - INFO - 3 datasets tokenized successfully
2025-06-04 19:25:54,319 - INFO - Starting hyperparameter search for focal loss
[36m(train_hpo pid=3447372)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3447372)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3447372)[0m 2025-06-04 19:26:02,007 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.6252016107931255 and gamma=2.6992695521978884
[36m(train_hpo pid=3447372)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3447372)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3447372)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3447372)[0m   warnings.warn(
[36m(train_hpo pid=3447533)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3447533)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3447533)[0m 2025-06-04 19:26:08,671 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.970577641092792 and gamma=4.634102840173219
[36m(train_hpo pid=3447533)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3447533)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3447533)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3447533)[0m   warnings.warn(
[36m(train_hpo pid=3447787)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3447787)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3447787)[0m 2025-06-04 19:26:15,420 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.7811204413478371 and gamma=6.807074484302038
[36m(train_hpo pid=3447787)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3447787)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3447787)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3447787)[0m   warnings.warn(
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-04_19-25-54   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-25-54
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-04_18-54-36_274448_3393636/artifacts/2025-06-04_19-25-54/train_hpo_2025-06-04_19-25-54/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-04 19:25:54. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_e4305391   PENDING    0.625202   2.69927       1.88223e-05          0.13641                    4 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_e4305391 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_e4305391 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                                0.6252 â”‚
â”‚ gamma                               2.69927 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          4 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3447372)[0m [2025-06-04 19:26:02,254] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3447372)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=8, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_33295690 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_33295690 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.97058 â”‚
â”‚ gamma                                4.6341 â”‚
â”‚ learning_rate                         5e-05 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3447533)[0m [2025-06-04 19:26:09,051] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3447372)[0m {'loss': 0.0341, 'grad_norm': 0.06798377633094788, 'learning_rate': 1.176394468215133e-05, 'epoch': 1.0}
[36m(train_hpo pid=3447533)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_28545a0c started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_28545a0c config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.78112 â”‚
â”‚ gamma                               6.80707 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          2 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3447372)[0m {'loss': 0.0306, 'grad_norm': 0.21929702162742615, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.0}
[36m(train_hpo pid=3447787)[0m [2025-06-04 19:26:15,644] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3447787)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=4, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3447533)[0m {'loss': 0.0224, 'grad_norm': 0.03556511178612709, 'learning_rate': 3.612785445936571e-05, 'epoch': 1.0}
[36m(train_hpo pid=3447372)[0m {'train_runtime': 16.4183, 'train_samples_per_second': 48.239, 'train_steps_per_second': 0.487, 'train_loss': 0.03257569670677185, 'epoch': 2.8}
[36m(train_hpo pid=3447372)[0m STATE at ending of training  :  TrainerState(epoch=2.8, global_step=8, max_steps=8, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=146288433303552.0, log_history=[{'loss': 0.0341, 'grad_norm': 0.06798377633094788, 'learning_rate': 1.176394468215133e-05, 'epoch': 1.0, 'step': 3}, {'loss': 0.0306, 'grad_norm': 0.21929702162742615, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.0, 'step': 6}, {'loss': 0.0333, 'grad_norm': 0.234178826212883, 'learning_rate': 0.0, 'epoch': 2.8, 'step': 8}, {'train_runtime': 16.4183, 'train_samples_per_second': 48.239, 'train_steps_per_second': 0.487, 'total_flos': 146288433303552.0, 'train_loss': 0.03257569670677185, 'epoch': 2.8, 'step': 8}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})2025-06-04 19:26:25,921 - INFO - Cleaning up trial e4305391
2025-06-04 19:26:25,922 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-25-54/train_hpo_e4305391_1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364_2025-06-04_19-25-54
[36m(train_hpo pid=3447372)[0m 2025-06-04 19:26:25,855 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3447372)[0m 2025-06-04 19:26:25,861 - INFO - eval_result: {'eval_loss': 0.03400511294603348, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.6380951404571533, 'eval_AP': 0.9941347889234187, 'eval_MCC': 0.0, 'eval_NDCG': 0.9989301779927425, 'eval_kappa': 0.0, 'eval_runtime': 4.0023, 'eval_samples_per_second': 16.491, 'eval_steps_per_second': 0.999, 'epoch': 2.8}
[36m(train_hpo pid=3447372)[0m 2025-06-04 19:26:25,896 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
2025-06-04 19:26:28,226 - INFO - Cleaning up trial 28545a0c
2025-06-04 19:26:28,226 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-25-54/train_hpo_28545a0c_3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512_2025-06-04_19-26-07
2025-06-04 19:26:28,226 - INFO - Current best: e4305391 with eval_f1 : 0.8521739130434782 at iteration 1


Trial status: 3 RUNNING
Current time: 2025-06-04 19:26:24. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_e4305391   RUNNING    0.625202   2.69927       1.88223e-05         0.13641                     4 â”‚
â”‚ train_hpo_33295690   RUNNING    0.970578   4.6341        5.16112e-05         0.123031                    5 â”‚
â”‚ train_hpo_28545a0c   RUNNING    0.78112    6.80707       1.88581e-05         0.251217                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3447787)[0m STATE at ending of training  :  TrainerState(epoch=1.4, global_step=4, max_steps=4, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=73144216651776.0, log_history=[{'loss': 0.0026, 'grad_norm': 0.026429973542690277, 'learning_rate': 4.714527732738613e-06, 'epoch': 1.0, 'step': 3}, {'loss': 0.0021, 'grad_norm': 0.05227420851588249, 'learning_rate': 0.0, 'epoch': 1.4, 'step': 4}, {'train_runtime': 5.8322, 'train_samples_per_second': 67.898, 'train_steps_per_second': 0.686, 'total_flos': 73144216651776.0, 'train_loss': 0.0024405019357800484, 'epoch': 1.4, 'step': 4}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_e4305391 finished iteration 1 at 2025-06-04 19:26:25. Total running time: 31s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_e4305391 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    24.7812 â”‚
â”‚ time_total_s                        24.7812 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   2.8 â”‚
â”‚ eval_AP                             0.99413 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.99893 â”‚
â”‚ eval_accuracy                       0.74242 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           0.03401 â”‚
â”‚ eval_optim_threshold                 0.6381 â”‚
â”‚ eval_precision                      0.74242 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         4.0023 â”‚
â”‚ eval_samples_per_second              16.491 â”‚
â”‚ eval_steps_per_second                 0.999 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_e4305391 completed after 1 iterations at 2025-06-04 19:26:25. Total running time: 31s
[36m(train_hpo pid=3447372)[0m {'eval_loss': 0.03400511294603348, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.6380951404571533, 'eval_AP': 0.9941347889234187, 'eval_MCC': 0.0, 'eval_NDCG': 0.9989301779927425, 'eval_kappa': 0.0, 'eval_runtime': 4.0023, 'eval_samples_per_second': 16.491, 'eval_steps_per_second': 0.999, 'epoch': 2.8}

Trial train_hpo_28545a0c finished iteration 1 at 2025-06-04 19:26:28. Total running time: 33s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_28545a0c result              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                          â”‚
â”‚ time_this_iter_s                     13.7213 â”‚
â”‚ time_total_s                         13.7213 â”‚
â”‚ training_iteration                         1 â”‚
â”‚ epoch                                    1.4 â”‚
â”‚ eval_AP                              0.96948 â”‚
â”‚ eval_MCC                            -0.07306 â”‚
â”‚ eval_NDCG                            0.99416 â”‚
â”‚ eval_accuracy                        0.72727 â”‚
â”‚ eval_f1                              0.84211 â”‚
â”‚ eval_kappa                          -0.02946 â”‚
â”‚ eval_loss                            0.00181 â”‚
â”‚ eval_optim_threshold                 0.58388 â”‚
â”‚ eval_precision                       0.73846 â”‚
â”‚ eval_recall                          0.97959 â”‚
â”‚ eval_runtime                          3.4972 â”‚
â”‚ eval_samples_per_second               18.872 â”‚
â”‚ eval_steps_per_second                  1.144 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3447533)[0m {'loss': 0.0024, 'grad_norm': 0.024892015382647514, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.0}[32m [repeated 4x across cluster][0m
[36m(train_hpo pid=3447787)[0m {'train_runtime': 5.8322, 'train_samples_per_second': 67.898, 'train_steps_per_second': 0.686, 'train_loss': 0.0024405019357800484, 'epoch': 1.4}

Trial train_hpo_28545a0c completed after 1 iterations at 2025-06-04 19:26:28. Total running time: 33s
[36m(train_hpo pid=3447533)[0m {'train_runtime': 19.2564, 'train_samples_per_second': 51.411, 'train_steps_per_second': 0.519, 'train_loss': 0.00818245131522417, 'epoch': 3.4}
[36m(train_hpo pid=3447533)[0m STATE at ending of training  :  TrainerState(epoch=3.4, global_step=10, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=177335259076608.0, log_history=[{'loss': 0.0224, 'grad_norm': 0.03556511178612709, 'learning_rate': 3.612785445936571e-05, 'epoch': 1.0, 'step': 3}, {'loss': 0.0024, 'grad_norm': 0.024892015382647514, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.0, 'step': 6}, {'loss': 0.0016, 'grad_norm': 0.03411271050572395, 'learning_rate': 5.161122065623674e-06, 'epoch': 3.0, 'step': 9}, {'loss': 0.0023, 'grad_norm': 0.08022338151931763, 'learning_rate': 0.0, 'epoch': 3.4, 'step': 10}, {'train_runtime': 19.2564, 'train_samples_per_second': 51.411, 'train_steps_per_second': 0.519, 'total_flos': 177335259076608.0, 'train_loss': 0.00818245131522417, 'epoch': 3.4, 'step': 10}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3447787)[0m {'eval_loss': 0.0018073930405080318, 'eval_f1': 0.8421052631578947, 'eval_recall': 0.9795918367346939, 'eval_accuracy': 0.7272727272727273, 'eval_precision': 0.7384615384615385, 'eval_optim_threshold': 0.5838777422904968, 'eval_AP': 0.9694829014524233, 'eval_MCC': -0.07305833027953698, 'eval_NDCG': 0.994161952200456, 'eval_kappa': -0.029462738301559765, 'eval_runtime': 3.4972, 'eval_samples_per_second': 18.872, 'eval_steps_per_second': 1.144, 'epoch': 1.4}[36m(train_hpo pid=3447533)[0m 2025-06-04 19:26:34,901 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3447533)[0m 2025-06-04 19:26:34,906 - INFO - eval_result: {'eval_loss': 0.001696125720627606, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.7576197981834412, 'eval_AP': 1.0, 'eval_MCC': 0.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 0.0, 'eval_runtime': 3.3648, 'eval_samples_per_second': 19.615, 'eval_steps_per_second': 1.189, 'epoch': 3.4}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3447787)[0m 2025-06-04 19:26:28,203 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
2025-06-04 19:26:34,970 - INFO - Cleaning up trial 33295690
2025-06-04 19:26:34,970 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-25-54/train_hpo_33295690_2_alpha=0.9706,gamma=4.6341,learning_rate=0.0001,num_train_epochs=5,weight_decay=0.1230_2025-06-04_19-26-01
2025-06-04 19:26:34,970 - INFO - Current best: e4305391 with eval_f1 : 0.8521739130434782 at iteration 1
2025-06-04 19:26:34,970 - INFO - Cleaning up trial 28545a0c
2025-06-04 19:26:34,970 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-25-54/train_hpo_28545a0c_3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512_2025-06-04_19-26-07
2025-06-04 19:26:34,978	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-25-54' in 0.0055s.
2025-06-04 19:26:34,984 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x71a3bc118c10>
2025-06-04 19:26:34,985 - INFO - Best trial : train_hpo_e4305391
2025-06-04 19:26:34,985 - INFO - Best config : {'alpha': 0.6252016107931255, 'gamma': 2.6992695521978884, 'learning_rate': 1.8822311491442127e-05, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 4}
2025-06-04 19:26:34,985 - INFO - Best trial after optimization: {'eval_loss': 0.03400511294603348, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.6380951404571533, 'eval_AP': 0.9941347889234187, 'eval_MCC': 0.0, 'eval_NDCG': 0.9989301779927425, 'eval_kappa': 0.0, 'eval_runtime': 4.0023, 'eval_samples_per_second': 16.491, 'eval_steps_per_second': 0.999, 'epoch': 2.8, 'timestamp': 1749057985, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': 'e4305391', 'date': '2025-06-04_19-26-25', 'time_this_iter_s': 24.78121519088745, 'time_total_s': 24.78121519088745, 'pid': 3447372, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'alpha': 0.6252016107931255, 'gamma': 2.6992695521978884, 'learning_rate': 1.8822311491442127e-05, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 4}, 'time_since_restore': 24.78121519088745, 'iterations_since_restore': 1, 'experiment_tag': '1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364'}
2025-06-04 19:26:35,013 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   0.034005  0.852174  ...                        4  e4305391
1   0.001696  0.852174  ...                        5  33295690
2   0.001807  0.842105  ...                        2  28545a0c

[3 rows x 33 columns]
[36m(train_hpo pid=3447533)[0m 2025-06-04 19:26:34,946 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
2025-06-04 19:26:35,193 - INFO - Trial comparison plot saved
2025-06-04 19:26:35,193 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-04 19:26:35,770 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.25 and gamma=2.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-04 19:26:35,858 - INFO - training size : 198
2025-06-04 19:26:35,858 - INFO - dev size : 66
2025-06-04 19:26:35,858 - INFO - test size : 133
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(

[36m(train_hpo pid=3447533)[0m {'eval_loss': 0.001696125720627606, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.7576197981834412, 'eval_AP': 1.0, 'eval_MCC': 0.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 0.0, 'eval_runtime': 3.3648, 'eval_samples_per_second': 19.615, 'eval_steps_per_second': 1.189, 'epoch': 3.4}
[36m(train_hpo pid=3447533)[0m {'loss': 0.0023, 'grad_norm': 0.08022338151931763, 'learning_rate': 0.0, 'epoch': 3.4}[32m [repeated 2x across cluster][0m

Trial train_hpo_33295690 finished iteration 1 at 2025-06-04 19:26:34. Total running time: 40s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_33295690 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    27.1618 â”‚
â”‚ time_total_s                        27.1618 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   3.4 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                       0.74242 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                            0.0017 â”‚
â”‚ eval_optim_threshold                0.75762 â”‚
â”‚ eval_precision                      0.74242 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.3648 â”‚
â”‚ eval_samples_per_second              19.615 â”‚
â”‚ eval_steps_per_second                 1.189 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_33295690 completed after 1 iterations at 2025-06-04 19:26:34. Total running time: 40s

Trial status: 3 TERMINATED
Current time: 2025-06-04 19:26:34. Total running time: 40s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_e4305391   TERMINATED   0.625202   2.69927       1.88223e-05         0.13641                     4        1            24.7812    0.0340051     0.852174        1                 0.742424 â”‚
â”‚ train_hpo_33295690   TERMINATED   0.970578   4.6341        5.16112e-05         0.123031                    5        1            27.1618    0.00169613    0.852174        1                 0.742424 â”‚
â”‚ train_hpo_28545a0c   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            13.7213    0.00180739    0.842105        0.979592          0.727273 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

  0%|          | 0/36 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  3%|â–Ž         | 1/36 [00:00<00:22,  1.54it/s]  6%|â–Œ         | 2/36 [00:01<00:21,  1.59it/s]  8%|â–Š         | 3/36 [00:01<00:20,  1.61it/s] 11%|â–ˆ         | 4/36 [00:02<00:19,  1.62it/s] 14%|â–ˆâ–        | 5/36 [00:03<00:19,  1.62it/s] 17%|â–ˆâ–‹        | 6/36 [00:03<00:18,  1.62it/s] 19%|â–ˆâ–‰        | 7/36 [00:04<00:17,  1.62it/s] 22%|â–ˆâ–ˆâ–       | 8/36 [00:04<00:17,  1.64it/s] 25%|â–ˆâ–ˆâ–Œ       | 9/36 [00:05<00:14,  1.92it/s]                                               25%|â–ˆâ–ˆâ–Œ       | 9/36 [00:05<00:14,  1.92it/s] 28%|â–ˆâ–ˆâ–Š       | 10/36 [00:05<00:14,  1.80it/s] 31%|â–ˆâ–ˆâ–ˆ       | 11/36 [00:06<00:14,  1.74it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 12/36 [00:07<00:14,  1.71it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 13/36 [00:07<00:13,  1.68it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 14/36 [00:08<00:13,  1.66it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 15/36 [00:08<00:12,  1.65it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 16/36 [00:09<00:12,  1.65it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 17/36 [00:10<00:11,  1.65it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 18/36 [00:10<00:09,  1.93it/s]                                                50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 18/36 [00:10<00:09,  1.93it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 19/36 [00:11<00:09,  1.81it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 20/36 [00:11<00:09,  1.74it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 21/36 [00:12<00:08,  1.71it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 22/36 [00:12<00:08,  1.68it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 23/36 [00:13<00:07,  1.67it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 24/36 [00:14<00:07,  1.66it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 25/36 [00:14<00:06,  1.65it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 26/36 [00:15<00:06,  1.65it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 27/36 [00:15<00:04,  1.93it/s]                                                75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 27/36 [00:15<00:04,  1.93it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 28/36 [00:16<00:04,  1.80it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 29/36 [00:16<00:04,  1.75it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 30/36 [00:17<00:03,  1.71it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 31/36 [00:18<00:02,  1.68it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 32/36 [00:18<00:02,  1.67it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 33/36 [00:19<00:01,  1.66it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 34/36 [00:20<00:01,  1.65it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 35/36 [00:20<00:00,  1.65it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [00:20<00:00,  1.92it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [00:22<00:00,  1.92it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [00:22<00:00,  1.92it/s]2025-06-04 19:26:58,843 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [00:22<00:00,  1.60it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
{'loss': 0.0593, 'grad_norm': 0.34375396370887756, 'learning_rate': 1.4116733618581595e-05, 'epoch': 1.0}
{'loss': 0.0112, 'grad_norm': 0.2510259747505188, 'learning_rate': 9.411155745721064e-06, 'epoch': 2.0}
{'loss': 0.0071, 'grad_norm': 0.09385465085506439, 'learning_rate': 4.705577872860532e-06, 'epoch': 3.0}
{'loss': 0.006, 'grad_norm': 0.18716128170490265, 'learning_rate': 0.0, 'epoch': 4.0}
{'train_runtime': 22.5524, 'train_samples_per_second': 35.118, 'train_steps_per_second': 1.596, 'train_loss': 0.020882765141626198, 'epoch': 4.0}
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.34it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.68it/s]2025-06-04 19:27:03,008 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.29s/it]
2025-06-04 19:27:03,014 - INFO - Training time : 27.82131712185219
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.19it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.08it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.39it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.13it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.28it/s]2025-06-04 19:27:07,476 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.44it/s]
2025-06-04 19:27:07,480 - INFO - Evaluation time : 4.4661555991042405
2025-06-04 19:27:07,480 - INFO - Evaluation results on test set: {'eval_loss': 0.005939238239079714, 'eval_f1': 0.9948717948717949, 'eval_recall': 0.9897959183673469, 'eval_accuracy': 0.9924812030075187, 'eval_precision': 1.0, 'eval_optim_threshold': 0.4320392906665802, 'eval_AP': 1.0, 'eval_MCC': 0.9809697178310792, 'eval_NDCG': 1.0000000000000004, 'eval_kappa': 0.980788675429727, 'eval_runtime': 4.4616, 'eval_samples_per_second': 29.81, 'eval_steps_per_second': 1.345, 'epoch': 4.0}
2025-06-04 19:27:07,481 - INFO - Total updates (optimizer steps): 36
2025-06-04 19:27:07,481 - INFO - Avg time / step: 0.627s
2025-06-04 19:27:08,166 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_focaldmis-lab/biobert-v1.13trials_fold-1
2025-06-04 19:27:08,166 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.22it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.08it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.38it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.13it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.28it/s]2025-06-04 19:27:12,954 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.34it/s]
2025-06-04 19:27:12,958 - INFO - preds : [1 0 0 0 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 0 1 1 0 1 1 1 0 1 0 1 1 1 1 1 1
 1 1 1 0 0 1 0 1 1 0 1 1 1 1 0 0 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 0 0
 1 1 0 1 0 0 0 1 1 1 1 1 1 0 1 1 1 1 0 1 1 0 1 1 1 0 0 1 0 0 1 0 1 1 1 0 0
 0 1 1 1 1 1 0 1 0 1 1 1 1 1 1 1 0 1 1 1 1 0]
2025-06-04 19:27:12,959 - INFO - test_split["labels"] : [1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0]
2025-06-04 19:27:12,961 - INFO - Confusion matrix: TN=35, FP=0, FN=1, TP=97
2025-06-04 19:27:15,712 - INFO - Metrics: {'f1': 0.9948717948717949, 'recall': 0.9897959183673469, 'precision': 1.0, 'accuracy': 0.9924812030075187, 'AP': 1.0, 'MCC': 0.9809697178310792, 'NDCG': 1.0000000000000004, 'kappa': 0.980788675429727, 'TN': 35, 'FP': 0, 'FN': 1, 'TP': 97}
2025-06-04 19:27:15,831 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-04 19:27:15,930 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:27:15,930 - INFO - 
On test Set (optimal threshold of 0.7800584435462952 according to cross validation on the training set): 
2025-06-04 19:27:15,932 - INFO - Confusion matrix: TN=35, FP=0, FN=1, TP=97
2025-06-04 19:27:18,829 - INFO - Metrics: {'f1': 0.9948717948717949, 'recall': 0.9897959183673469, 'precision': 1.0, 'accuracy': 0.9924812030075187, 'AP': 1.0, 'MCC': 0.9809697178310792, 'NDCG': 1.0000000000000004, 'kappa': 0.980788675429727, 'TN': 35, 'FP': 0, 'FN': 1, 'TP': 97}
2025-06-04 19:27:18,929 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:27:18,929 - INFO - Results for fold 1 : [{'f1': 0.9948717948717949, 'recall': 0.9897959183673469, 'precision': 1.0, 'accuracy': 0.9924812030075187, 'AP': 1.0, 'MCC': 0.9809697178310792, 'NDCG': 1.0000000000000004, 'kappa': 0.980788675429727, 'TN': 35, 'FP': 0, 'FN': 1, 'TP': 97}]
2025-06-04 19:27:19,055 - INFO - Cleared CUDA cache. Memory allocated: 1.38 GB, Memory reserved: 1.76 GB
2025-06-04 19:27:19,055 - INFO - 
fold number 2 / 3
2025-06-04 19:27:19,061 - INFO - train split size : 198
2025-06-04 19:27:19,061 - INFO - dev split size : 67
2025-06-04 19:27:19,061 - INFO - test split size : 132
Map (num_proc=32):   0%|          | 0/198 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–Ž         | 7/198 [00:00<00:04, 38.76 examples/s]Map (num_proc=32):  21%|â–ˆâ–ˆ        | 42/198 [00:00<00:00, 174.61 examples/s]Map (num_proc=32):  36%|â–ˆâ–ˆâ–ˆâ–‹      | 72/198 [00:00<00:00, 215.42 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 102/198 [00:00<00:00, 233.95 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 132/198 [00:00<00:00, 247.98 examples/s]Map (num_proc=32):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 162/198 [00:00<00:00, 250.71 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 198/198 [00:00<00:00, 205.89 examples/s]
Map (num_proc=32):   0%|          | 0/67 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/67 [00:00<00:03, 17.46 examples/s]Map (num_proc=32):  25%|â–ˆâ–ˆâ–Œ       | 17/67 [00:00<00:00, 67.98 examples/s]Map (num_proc=32):  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 31/67 [00:00<00:00, 91.06 examples/s]Map (num_proc=32):  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 41/67 [00:00<00:00, 91.91 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 53/67 [00:00<00:00, 91.89 examples/s]Map (num_proc=32):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 63/67 [00:00<00:00, 94.04 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:00<00:00, 74.35 examples/s]
Map (num_proc=32):   0%|          | 0/132 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/132 [00:00<00:04, 29.63 examples/s]Map (num_proc=32):  24%|â–ˆâ–ˆâ–       | 32/132 [00:00<00:00, 134.55 examples/s]Map (num_proc=32):  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 56/132 [00:00<00:00, 164.45 examples/s]Map (num_proc=32):  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 80/132 [00:00<00:00, 182.90 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 104/132 [00:00<00:00, 193.84 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 128/132 [00:00<00:00, 206.65 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 132/132 [00:00<00:00, 152.89 examples/s]
2025-06-04 19:27:28,403 - INFO - 3 datasets tokenized successfully
2025-06-04 19:27:28,404 - INFO - Starting hyperparameter search for focal loss
[36m(train_hpo pid=3449956)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3449956)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3449956)[0m 2025-06-04 19:27:35,951 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.6252016107931255 and gamma=2.6992695521978884
[36m(train_hpo pid=3449956)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3449956)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3449956)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3449956)[0m   warnings.warn(
[36m(train_hpo pid=3450118)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3450118)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3450118)[0m 2025-06-04 19:27:42,605 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.970577641092792 and gamma=4.634102840173219
[36m(train_hpo pid=3450118)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3450118)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3450118)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3450118)[0m   warnings.warn(
[36m(train_hpo pid=3450399)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3450399)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3450399)[0m 2025-06-04 19:27:49,275 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.7811204413478371 and gamma=6.807074484302038
[36m(train_hpo pid=3450399)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3450399)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3450399)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3450399)[0m   warnings.warn(
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-04_19-27-28   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-27-28
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-04_18-54-36_274448_3393636/artifacts/2025-06-04_19-27-28/train_hpo_2025-06-04_19-27-28/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-04 19:27:28. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_852491d5   PENDING    0.625202   2.69927       1.88223e-05          0.13641                    4 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_852491d5 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_852491d5 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                                0.6252 â”‚
â”‚ gamma                               2.69927 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          4 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3449956)[0m [2025-06-04 19:27:36,186] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3449956)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=8, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_87d7cb53 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_87d7cb53 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.97058 â”‚
â”‚ gamma                                4.6341 â”‚
â”‚ learning_rate                         5e-05 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3450118)[0m [2025-06-04 19:27:42,972] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3449956)[0m {'loss': 0.036, 'grad_norm': 0.11574973165988922, 'learning_rate': 1.176394468215133e-05, 'epoch': 1.0}
[36m(train_hpo pid=3450118)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_d4544a53 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_d4544a53 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.78112 â”‚
â”‚ gamma                               6.80707 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          2 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3449956)[0m {'loss': 0.0301, 'grad_norm': 0.5116066336631775, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.0}
[36m(train_hpo pid=3450399)[0m [2025-06-04 19:27:49,491] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3450399)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=4, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3450118)[0m {'loss': 0.0115, 'grad_norm': 0.0204287301748991, 'learning_rate': 3.612785445936571e-05, 'epoch': 1.0}
[36m(train_hpo pid=3449956)[0m {'train_runtime': 16.2952, 'train_samples_per_second': 48.603, 'train_steps_per_second': 0.491, 'train_loss': 0.03273932822048664, 'epoch': 2.8}
[36m(train_hpo pid=3449956)[0m STATE at ending of training  :  TrainerState(epoch=2.8, global_step=8, max_steps=8, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=146288433303552.0, log_history=[{'loss': 0.036, 'grad_norm': 0.11574973165988922, 'learning_rate': 1.176394468215133e-05, 'epoch': 1.0, 'step': 3}, {'loss': 0.0301, 'grad_norm': 0.5116066336631775, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.0, 'step': 6}, {'loss': 0.0318, 'grad_norm': 0.8833678364753723, 'learning_rate': 0.0, 'epoch': 2.8, 'step': 8}, {'train_runtime': 16.2952, 'train_samples_per_second': 48.603, 'train_steps_per_second': 0.491, 'total_flos': 146288433303552.0, 'train_loss': 0.03273932822048664, 'epoch': 2.8, 'step': 8}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})2025-06-04 19:27:59,521 - INFO - Cleaning up trial 852491d5
2025-06-04 19:27:59,521 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-27-28/train_hpo_852491d5_1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364_2025-06-04_19-27-28
[36m(train_hpo pid=3449956)[0m 2025-06-04 19:27:59,455 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3449956)[0m 2025-06-04 19:27:59,461 - INFO - eval_result: {'eval_loss': 0.03101343847811222, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.6331940293312073, 'eval_AP': 0.998315957299116, 'eval_MCC': 0.0, 'eval_NDCG': 0.9997060166227101, 'eval_kappa': 0.0, 'eval_runtime': 3.8118, 'eval_samples_per_second': 17.577, 'eval_steps_per_second': 1.049, 'epoch': 2.8}
[36m(train_hpo pid=3449956)[0m 2025-06-04 19:27:59,494 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
2025-06-04 19:28:02,021 - INFO - Cleaning up trial d4544a53
2025-06-04 19:28:02,021 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-27-28/train_hpo_d4544a53_3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512_2025-06-04_19-27-41
2025-06-04 19:28:02,021 - INFO - Cleaning up trial 852491d5
2025-06-04 19:28:02,021 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-27-28/train_hpo_852491d5_1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364_2025-06-04_19-27-28


Trial status: 3 RUNNING
Current time: 2025-06-04 19:27:58. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_852491d5   RUNNING    0.625202   2.69927       1.88223e-05         0.13641                     4 â”‚
â”‚ train_hpo_87d7cb53   RUNNING    0.970578   4.6341        5.16112e-05         0.123031                    5 â”‚
â”‚ train_hpo_d4544a53   RUNNING    0.78112    6.80707       1.88581e-05         0.251217                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3450399)[0m STATE at ending of training  :  TrainerState(epoch=1.4, global_step=4, max_steps=4, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=73144216651776.0, log_history=[{'loss': 0.004, 'grad_norm': 0.05955413728952408, 'learning_rate': 4.714527732738613e-06, 'epoch': 1.0, 'step': 3}, {'loss': 0.0024, 'grad_norm': 0.07125502079725266, 'learning_rate': 0.0, 'epoch': 1.4, 'step': 4}, {'train_runtime': 5.8211, 'train_samples_per_second': 68.028, 'train_steps_per_second': 0.687, 'total_flos': 73144216651776.0, 'train_loss': 0.003630168386735022, 'epoch': 1.4, 'step': 4}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_852491d5 finished iteration 1 at 2025-06-04 19:27:59. Total running time: 31s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_852491d5 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    24.4174 â”‚
â”‚ time_total_s                        24.4174 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   2.8 â”‚
â”‚ eval_AP                             0.99832 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.99971 â”‚
â”‚ eval_accuracy                       0.73134 â”‚
â”‚ eval_f1                             0.84483 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           0.03101 â”‚
â”‚ eval_optim_threshold                0.63319 â”‚
â”‚ eval_precision                      0.73134 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.8118 â”‚
â”‚ eval_samples_per_second              17.577 â”‚
â”‚ eval_steps_per_second                 1.049 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_852491d5 completed after 1 iterations at 2025-06-04 19:27:59. Total running time: 31s
[36m(train_hpo pid=3449956)[0m {'eval_loss': 0.03101343847811222, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.6331940293312073, 'eval_AP': 0.998315957299116, 'eval_MCC': 0.0, 'eval_NDCG': 0.9997060166227101, 'eval_kappa': 0.0, 'eval_runtime': 3.8118, 'eval_samples_per_second': 17.577, 'eval_steps_per_second': 1.049, 'epoch': 2.8}
[36m(train_hpo pid=3450118)[0m {'loss': 0.0031, 'grad_norm': 0.04353194683790207, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.0}[32m [repeated 4x across cluster][0m
[36m(train_hpo pid=3450399)[0m {'train_runtime': 5.8211, 'train_samples_per_second': 68.028, 'train_steps_per_second': 0.687, 'train_loss': 0.003630168386735022, 'epoch': 1.4}

Trial train_hpo_d4544a53 finished iteration 1 at 2025-06-04 19:28:02. Total running time: 33s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_d4544a53 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    13.5644 â”‚
â”‚ time_total_s                        13.5644 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   1.4 â”‚
â”‚ eval_AP                             0.92262 â”‚
â”‚ eval_MCC                            0.20309 â”‚
â”‚ eval_NDCG                           0.98276 â”‚
â”‚ eval_accuracy                       0.74627 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                          0.07922 â”‚
â”‚ eval_loss                           0.00194 â”‚
â”‚ eval_optim_threshold                0.56141 â”‚
â”‚ eval_precision                      0.74242 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.3471 â”‚
â”‚ eval_samples_per_second              20.017 â”‚
â”‚ eval_steps_per_second                 1.195 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_d4544a53 completed after 1 iterations at 2025-06-04 19:28:02. Total running time: 33s
[36m(train_hpo pid=3450118)[0m {'train_runtime': 19.2232, 'train_samples_per_second': 51.5, 'train_steps_per_second': 0.52, 'train_loss': 0.0054906091652810575, 'epoch': 3.4}
[36m(train_hpo pid=3450118)[0m STATE at ending of training  :  TrainerState(epoch=3.4, global_step=10, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=177335259076608.0, log_history=[{'loss': 0.0115, 'grad_norm': 0.0204287301748991, 'learning_rate': 3.612785445936571e-05, 'epoch': 1.0, 'step': 3}, {'loss': 0.0031, 'grad_norm': 0.04353194683790207, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.0, 'step': 6}, {'loss': 0.0027, 'grad_norm': 0.05736034736037254, 'learning_rate': 5.161122065623674e-06, 'epoch': 3.0, 'step': 9}, {'loss': 0.0031, 'grad_norm': 0.06257037073373795, 'learning_rate': 0.0, 'epoch': 3.4, 'step': 10}, {'train_runtime': 19.2232, 'train_samples_per_second': 51.5, 'train_steps_per_second': 0.52, 'total_flos': 177335259076608.0, 'train_loss': 0.0054906091652810575, 'epoch': 3.4, 'step': 10}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3450399)[0m {'eval_loss': 0.0019432631088420749, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.5614131093025208, 'eval_AP': 0.9226211805640576, 'eval_MCC': 0.2030905986149808, 'eval_NDCG': 0.9827563499087371, 'eval_kappa': 0.0792239288601454, 'eval_runtime': 3.3471, 'eval_samples_per_second': 20.017, 'eval_steps_per_second': 1.195, 'epoch': 1.4}2025-06-04 19:28:09,235 - INFO - Cleaning up trial 87d7cb53
2025-06-04 19:28:09,235 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-27-28/train_hpo_87d7cb53_2_alpha=0.9706,gamma=4.6341,learning_rate=0.0001,num_train_epochs=5,weight_decay=0.1230_2025-06-04_19-27-35
2025-06-04 19:28:09,235 - INFO - Cleaning up trial 852491d5
2025-06-04 19:28:09,236 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-27-28/train_hpo_852491d5_1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364_2025-06-04_19-27-28
2025-06-04 19:28:09,236 - INFO - Current best: d4544a53 with eval_f1 : 0.8521739130434782 at iteration 1
2025-06-04 19:28:09,246	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-27-28' in 0.0085s.
2025-06-04 19:28:09,257 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x719ac4185550>
2025-06-04 19:28:09,259 - INFO - Best trial : train_hpo_d4544a53
2025-06-04 19:28:09,259 - INFO - Best config : {'alpha': 0.7811204413478371, 'gamma': 6.807074484302038, 'learning_rate': 1.8858110930954453e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 2}
2025-06-04 19:28:09,259 - INFO - Best trial after optimization: {'eval_loss': 0.0019432631088420749, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.5614131093025208, 'eval_AP': 0.9226211805640576, 'eval_MCC': 0.2030905986149808, 'eval_NDCG': 0.9827563499087371, 'eval_kappa': 0.0792239288601454, 'eval_runtime': 3.3471, 'eval_samples_per_second': 20.017, 'eval_steps_per_second': 1.195, 'epoch': 1.4, 'timestamp': 1749058082, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': 'd4544a53', 'date': '2025-06-04_19-28-02', 'time_this_iter_s': 13.564356088638306, 'time_total_s': 13.564356088638306, 'pid': 3450399, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'alpha': 0.7811204413478371, 'gamma': 6.807074484302038, 'learning_rate': 1.8858110930954453e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 2}, 'time_since_restore': 13.564356088638306, 'iterations_since_restore': 1, 'experiment_tag': '3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512'}
[36m(train_hpo pid=3450118)[0m 2025-06-04 19:28:09,162 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png[32m [repeated 2x across cluster][0m
2025-06-04 19:28:09,283 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   0.031013  0.844828  ...                        4  852491d5
1   0.002998  0.844828  ...                        5  87d7cb53
2   0.001943  0.852174  ...                        2  d4544a53

[3 rows x 33 columns]
[36m(train_hpo pid=3450118)[0m 2025-06-04 19:28:09,168 - INFO - eval_result: {'eval_loss': 0.0029982321429997683, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.7727121114730835, 'eval_AP': 0.9251384279164869, 'eval_MCC': 0.0, 'eval_NDCG': 0.9848486040382903, 'eval_kappa': 0.0, 'eval_runtime': 3.6927, 'eval_samples_per_second': 18.144, 'eval_steps_per_second': 1.083, 'epoch': 3.4}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3450118)[0m 2025-06-04 19:28:09,203 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB[32m [repeated 2x across cluster][0m
2025-06-04 19:28:09,454 - INFO - Trial comparison plot saved
2025-06-04 19:28:09,454 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-04 19:28:10,540 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.25 and gamma=2.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-04 19:28:10,635 - INFO - training size : 198
2025-06-04 19:28:10,636 - INFO - dev size : 67
2025-06-04 19:28:10,636 - INFO - test size : 132
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(


Trial train_hpo_87d7cb53 finished iteration 1 at 2025-06-04 19:28:09. Total running time: 40s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_87d7cb53 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    27.4633 â”‚
â”‚ time_total_s                        27.4633 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   3.4 â”‚
â”‚ eval_AP                             0.92514 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.98485 â”‚
â”‚ eval_accuracy                       0.73134 â”‚
â”‚ eval_f1                             0.84483 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                             0.003 â”‚
â”‚ eval_optim_threshold                0.77271 â”‚
â”‚ eval_precision                      0.73134 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.6927 â”‚
â”‚ eval_samples_per_second              18.144 â”‚
â”‚ eval_steps_per_second                 1.083 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_87d7cb53 completed after 1 iterations at 2025-06-04 19:28:09. Total running time: 40s

Trial status: 3 TERMINATED
Current time: 2025-06-04 19:28:09. Total running time: 40s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_852491d5   TERMINATED   0.625202   2.69927       1.88223e-05         0.13641                     4        1            24.4174    0.0310134     0.844828               1          0.731343 â”‚
â”‚ train_hpo_87d7cb53   TERMINATED   0.970578   4.6341        5.16112e-05         0.123031                    5        1            27.4633    0.00299823    0.844828               1          0.731343 â”‚
â”‚ train_hpo_d4544a53   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            13.5644    0.00194326    0.852174               1          0.746269 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

[36m(train_hpo pid=3450118)[0m {'eval_loss': 0.0029982321429997683, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.7727121114730835, 'eval_AP': 0.9251384279164869, 'eval_MCC': 0.0, 'eval_NDCG': 0.9848486040382903, 'eval_kappa': 0.0, 'eval_runtime': 3.6927, 'eval_samples_per_second': 18.144, 'eval_steps_per_second': 1.083, 'epoch': 3.4}
[36m(train_hpo pid=3450118)[0m {'loss': 0.0031, 'grad_norm': 0.06257037073373795, 'learning_rate': 0.0, 'epoch': 3.4}[32m [repeated 2x across cluster][0m
  0%|          | 0/18 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  6%|â–Œ         | 1/18 [00:00<00:11,  1.54it/s] 11%|â–ˆ         | 2/18 [00:01<00:10,  1.59it/s] 17%|â–ˆâ–‹        | 3/18 [00:01<00:09,  1.59it/s] 22%|â–ˆâ–ˆâ–       | 4/18 [00:02<00:08,  1.60it/s] 28%|â–ˆâ–ˆâ–Š       | 5/18 [00:03<00:08,  1.61it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 6/18 [00:03<00:07,  1.62it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 7/18 [00:04<00:06,  1.62it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 8/18 [00:04<00:06,  1.64it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 9/18 [00:05<00:04,  1.92it/s]                                               50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 9/18 [00:05<00:04,  1.92it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 10/18 [00:05<00:04,  1.80it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 11/18 [00:06<00:04,  1.74it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 12/18 [00:07<00:03,  1.70it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 13/18 [00:07<00:02,  1.68it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 14/18 [00:08<00:02,  1.66it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 15/18 [00:08<00:01,  1.65it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 16/18 [00:09<00:01,  1.64it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 17/18 [00:10<00:00,  1.65it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 18/18 [00:10<00:00,  1.92it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 18/18 [00:12<00:00,  1.92it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 18/18 [00:12<00:00,  1.92it/s]2025-06-04 19:28:23,332 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 18/18 [00:12<00:00,  1.48it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
{'loss': 0.002, 'grad_norm': 0.02192128822207451, 'learning_rate': 9.429055465477227e-06, 'epoch': 1.0}
{'loss': 0.0011, 'grad_norm': 0.07762856036424637, 'learning_rate': 0.0, 'epoch': 2.0}
{'train_runtime': 12.1752, 'train_samples_per_second': 32.525, 'train_steps_per_second': 1.478, 'train_loss': 0.0015451513851682346, 'epoch': 2.0}
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.27it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.44it/s]2025-06-04 19:28:27,150 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.17s/it]
2025-06-04 19:28:27,155 - INFO - Training time : 17.7011605668813
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.23it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.07it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.38it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.13it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.36it/s]2025-06-04 19:28:31,582 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.46it/s]
2025-06-04 19:28:31,587 - INFO - Evaluation time : 4.431700510904193
2025-06-04 19:28:31,587 - INFO - Evaluation results on test set: {'eval_loss': 0.0007087459089234471, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.6017187237739563, 'eval_AP': 1.0, 'eval_MCC': 0.0, 'eval_NDCG': 1.0000000000000004, 'eval_kappa': 0.0, 'eval_runtime': 4.427, 'eval_samples_per_second': 29.817, 'eval_steps_per_second': 1.355, 'epoch': 2.0}
2025-06-04 19:28:31,587 - INFO - Total updates (optimizer steps): 18
2025-06-04 19:28:31,587 - INFO - Avg time / step: 0.677s
2025-06-04 19:28:32,349 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_focaldmis-lab/biobert-v1.13trials_fold-2
2025-06-04 19:28:32,349 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.17it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.05it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.39it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.13it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.36it/s]2025-06-04 19:28:36,752 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.46it/s]
2025-06-04 19:28:36,756 - INFO - preds : [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
2025-06-04 19:28:36,757 - INFO - test_split["labels"] : [1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1]
2025-06-04 19:28:36,759 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:28:39,472 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': 1.0, 'MCC': 0.0, 'NDCG': 1.0000000000000004, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:28:39,590 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-04 19:28:39,691 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:28:39,692 - INFO - 
On test Set (optimal threshold of 0.6010411381721497 according to cross validation on the training set): 
2025-06-04 19:28:39,693 - INFO - Confusion matrix: TN=34, FP=0, FN=0, TP=98
2025-06-04 19:28:42,559 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 34, 'FP': 0, 'FN': 0, 'TP': 98}
2025-06-04 19:28:42,658 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:28:42,658 - INFO - Results for fold 2 : [{'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 34, 'FP': 0, 'FN': 0, 'TP': 98}]
2025-06-04 19:28:42,776 - INFO - Cleared CUDA cache. Memory allocated: 1.40 GB, Memory reserved: 1.90 GB
2025-06-04 19:28:42,776 - INFO - 
fold number 3 / 3
2025-06-04 19:28:42,782 - INFO - train split size : 198
2025-06-04 19:28:42,782 - INFO - dev split size : 67
2025-06-04 19:28:42,782 - INFO - test split size : 132
Map (num_proc=32):   0%|          | 0/198 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–Ž         | 7/198 [00:00<00:05, 35.79 examples/s]Map (num_proc=32):  21%|â–ˆâ–ˆ        | 42/198 [00:00<00:00, 161.78 examples/s]Map (num_proc=32):  36%|â–ˆâ–ˆâ–ˆâ–‹      | 72/198 [00:00<00:00, 203.05 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 102/198 [00:00<00:00, 230.64 examples/s]Map (num_proc=32):  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 138/198 [00:00<00:00, 257.84 examples/s]Map (num_proc=32):  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 168/198 [00:00<00:00, 260.00 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 198/198 [00:00<00:00, 247.80 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 198/198 [00:01<00:00, 193.80 examples/s]
Map (num_proc=32):   0%|          | 0/67 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/67 [00:00<00:04, 15.74 examples/s]Map (num_proc=32):  22%|â–ˆâ–ˆâ–       | 15/67 [00:00<00:00, 60.01 examples/s]Map (num_proc=32):  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 27/67 [00:00<00:00, 76.70 examples/s]Map (num_proc=32):  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 37/67 [00:00<00:00, 82.33 examples/s]Map (num_proc=32):  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 49/67 [00:00<00:00, 89.36 examples/s]Map (num_proc=32):  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 59/67 [00:00<00:00, 92.40 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:00<00:00, 70.89 examples/s]
Map (num_proc=32):   0%|          | 0/132 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/132 [00:00<00:04, 26.02 examples/s]Map (num_proc=32):  21%|â–ˆâ–ˆ        | 28/132 [00:00<00:00, 112.58 examples/s]Map (num_proc=32):  36%|â–ˆâ–ˆâ–ˆâ–‹      | 48/132 [00:00<00:00, 143.61 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 68/132 [00:00<00:00, 160.50 examples/s]Map (num_proc=32):  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 92/132 [00:00<00:00, 175.42 examples/s]Map (num_proc=32):  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 116/132 [00:00<00:00, 186.10 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 132/132 [00:00<00:00, 140.04 examples/s]
2025-06-04 19:28:52,103 - INFO - 3 datasets tokenized successfully
2025-06-04 19:28:52,107 - INFO - Starting hyperparameter search for focal loss
[36m(train_hpo pid=3452274)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3452274)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3452274)[0m 2025-06-04 19:29:00,187 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.6252016107931255 and gamma=2.6992695521978884
[36m(train_hpo pid=3452274)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3452274)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3452274)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3452274)[0m   warnings.warn(
[36m(train_hpo pid=3452506)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3452506)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3452506)[0m 2025-06-04 19:29:07,135 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.970577641092792 and gamma=4.634102840173219
[36m(train_hpo pid=3452506)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3452506)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3452506)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3452506)[0m   warnings.warn(
[36m(train_hpo pid=3452720)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3452720)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3452720)[0m 2025-06-04 19:29:13,885 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.7811204413478371 and gamma=6.807074484302038
[36m(train_hpo pid=3452720)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3452720)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3452720)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3452720)[0m   warnings.warn(
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-04_19-28-52   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-28-52
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-04_18-54-36_274448_3393636/artifacts/2025-06-04_19-28-52/train_hpo_2025-06-04_19-28-52/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-04 19:28:52. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_33d57123   PENDING    0.625202   2.69927       1.88223e-05          0.13641                    4 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_33d57123 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_33d57123 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                                0.6252 â”‚
â”‚ gamma                               2.69927 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          4 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3452274)[0m [2025-06-04 19:29:00,428] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3452274)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=8, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_23ab255a started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_23ab255a config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.97058 â”‚
â”‚ gamma                                4.6341 â”‚
â”‚ learning_rate                         5e-05 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3452506)[0m [2025-06-04 19:29:07,490] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3452274)[0m {'loss': 0.036, 'grad_norm': 0.14141486585140228, 'learning_rate': 1.176394468215133e-05, 'epoch': 1.0}
[36m(train_hpo pid=3452506)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_0e5d3703 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_0e5d3703 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.78112 â”‚
â”‚ gamma                               6.80707 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          2 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3452274)[0m {'loss': 0.03, 'grad_norm': 0.22741137444972992, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.0}
[36m(train_hpo pid=3452720)[0m [2025-06-04 19:29:14,110] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3452720)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=4, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3452506)[0m {'loss': 0.0025, 'grad_norm': 0.04399270564317703, 'learning_rate': 3.612785445936571e-05, 'epoch': 1.0}
[36m(train_hpo pid=3452274)[0m {'train_runtime': 16.3417, 'train_samples_per_second': 48.465, 'train_steps_per_second': 0.49, 'train_loss': 0.033043237403035164, 'epoch': 2.8}
[36m(train_hpo pid=3452274)[0m STATE at ending of training  :  TrainerState(epoch=2.8, global_step=8, max_steps=8, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=146288433303552.0, log_history=[{'loss': 0.036, 'grad_norm': 0.14141486585140228, 'learning_rate': 1.176394468215133e-05, 'epoch': 1.0, 'step': 3}, {'loss': 0.03, 'grad_norm': 0.22741137444972992, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.0, 'step': 6}, {'loss': 0.0331, 'grad_norm': 0.24780750274658203, 'learning_rate': 0.0, 'epoch': 2.8, 'step': 8}, {'train_runtime': 16.3417, 'train_samples_per_second': 48.465, 'train_steps_per_second': 0.49, 'total_flos': 146288433303552.0, 'train_loss': 0.033043237403035164, 'epoch': 2.8, 'step': 8}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})[36m(train_hpo pid=3452274)[0m 2025-06-04 19:29:24,304 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3452274)[0m 2025-06-04 19:29:24,310 - INFO - eval_result: {'eval_loss': 0.02970617450773716, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.6119607090950012, 'eval_AP': 0.9988307692307693, 'eval_MCC': 0.0, 'eval_NDCG': 0.9997983839371136, 'eval_kappa': 0.0, 'eval_runtime': 4.1222, 'eval_samples_per_second': 16.253, 'eval_steps_per_second': 0.97, 'epoch': 2.8}
2025-06-04 19:29:24,396 - INFO - Cleaning up trial 33d57123
2025-06-04 19:29:24,396 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-28-52/train_hpo_33d57123_1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364_2025-06-04_19-28-52
[36m(train_hpo pid=3452274)[0m 2025-06-04 19:29:24,371 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
2025-06-04 19:29:26,464 - INFO - Cleaning up trial 0e5d3703
2025-06-04 19:29:26,464 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-28-52/train_hpo_0e5d3703_3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512_2025-06-04_19-29-06
2025-06-04 19:29:26,464 - INFO - Current best: 33d57123 with eval_f1 : 0.8547008547008547 at iteration 1


Trial status: 3 RUNNING
Current time: 2025-06-04 19:29:22. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_33d57123   RUNNING    0.625202   2.69927       1.88223e-05         0.13641                     4 â”‚
â”‚ train_hpo_23ab255a   RUNNING    0.970578   4.6341        5.16112e-05         0.123031                    5 â”‚
â”‚ train_hpo_0e5d3703   RUNNING    0.78112    6.80707       1.88581e-05         0.251217                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3452720)[0m STATE at ending of training  :  TrainerState(epoch=1.4, global_step=4, max_steps=4, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=73144216651776.0, log_history=[{'loss': 0.0021, 'grad_norm': 0.03421924263238907, 'learning_rate': 4.714527732738613e-06, 'epoch': 1.0, 'step': 3}, {'loss': 0.0021, 'grad_norm': 0.057990141212940216, 'learning_rate': 0.0, 'epoch': 1.4, 'step': 4}, {'train_runtime': 5.8126, 'train_samples_per_second': 68.127, 'train_steps_per_second': 0.688, 'total_flos': 73144216651776.0, 'train_loss': 0.0021351093309931457, 'epoch': 1.4, 'step': 4}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3452274)[0m {'eval_loss': 0.02970617450773716, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.6119607090950012, 'eval_AP': 0.9988307692307693, 'eval_MCC': 0.0, 'eval_NDCG': 0.9997983839371136, 'eval_kappa': 0.0, 'eval_runtime': 4.1222, 'eval_samples_per_second': 16.253, 'eval_steps_per_second': 0.97, 'epoch': 2.8}

Trial train_hpo_33d57123 finished iteration 1 at 2025-06-04 19:29:24. Total running time: 32s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_33d57123 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    25.2281 â”‚
â”‚ time_total_s                        25.2281 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   2.8 â”‚
â”‚ eval_AP                             0.99883 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                            0.9998 â”‚
â”‚ eval_accuracy                       0.74627 â”‚
â”‚ eval_f1                              0.8547 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           0.02971 â”‚
â”‚ eval_optim_threshold                0.61196 â”‚
â”‚ eval_precision                      0.74627 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         4.1222 â”‚
â”‚ eval_samples_per_second              16.253 â”‚
â”‚ eval_steps_per_second                  0.97 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_33d57123 completed after 1 iterations at 2025-06-04 19:29:24. Total running time: 32s
[36m(train_hpo pid=3452506)[0m {'loss': 0.002, 'grad_norm': 0.02377241663634777, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.0}[32m [repeated 4x across cluster][0m
[36m(train_hpo pid=3452720)[0m {'train_runtime': 5.8126, 'train_samples_per_second': 68.127, 'train_steps_per_second': 0.688, 'train_loss': 0.0021351093309931457, 'epoch': 1.4}

Trial train_hpo_0e5d3703 finished iteration 1 at 2025-06-04 19:29:26. Total running time: 34s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_0e5d3703 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    13.6746 â”‚
â”‚ time_total_s                        13.6746 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   1.4 â”‚
â”‚ eval_AP                             0.99035 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.99826 â”‚
â”‚ eval_accuracy                       0.74627 â”‚
â”‚ eval_f1                              0.8547 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           0.00182 â”‚
â”‚ eval_optim_threshold                0.60749 â”‚
â”‚ eval_precision                      0.74627 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                          3.242 â”‚
â”‚ eval_samples_per_second              20.666 â”‚
â”‚ eval_steps_per_second                 1.234 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_0e5d3703 completed after 1 iterations at 2025-06-04 19:29:26. Total running time: 34s
[36m(train_hpo pid=3452506)[0m {'train_runtime': 19.1795, 'train_samples_per_second': 51.617, 'train_steps_per_second': 0.521, 'train_loss': 0.002129211788997054, 'epoch': 3.4}
[36m(train_hpo pid=3452506)[0m STATE at ending of training  :  TrainerState(epoch=3.4, global_step=10, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=177335259076608.0, log_history=[{'loss': 0.0025, 'grad_norm': 0.04399270564317703, 'learning_rate': 3.612785445936571e-05, 'epoch': 1.0, 'step': 3}, {'loss': 0.002, 'grad_norm': 0.02377241663634777, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.0, 'step': 6}, {'loss': 0.0019, 'grad_norm': 0.028683416545391083, 'learning_rate': 5.161122065623674e-06, 'epoch': 3.0, 'step': 9}, {'loss': 0.0019, 'grad_norm': 0.012463276274502277, 'learning_rate': 0.0, 'epoch': 3.4, 'step': 10}, {'train_runtime': 19.1795, 'train_samples_per_second': 51.617, 'train_steps_per_second': 0.521, 'total_flos': 177335259076608.0, 'train_loss': 0.002129211788997054, 'epoch': 3.4, 'step': 10}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3452720)[0m {'eval_loss': 0.0018181487685069442, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.6074933409690857, 'eval_AP': 0.9903535964645348, 'eval_MCC': 0.0, 'eval_NDCG': 0.9982617983244354, 'eval_kappa': 0.0, 'eval_runtime': 3.242, 'eval_samples_per_second': 20.666, 'eval_steps_per_second': 1.234, 'epoch': 1.4}2025-06-04 19:29:33,332 - INFO - Cleaning up trial 23ab255a
2025-06-04 19:29:33,332 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-28-52/train_hpo_23ab255a_2_alpha=0.9706,gamma=4.6341,learning_rate=0.0001,num_train_epochs=5,weight_decay=0.1230_2025-06-04_19-28-59
2025-06-04 19:29:33,332 - INFO - Current best: 33d57123 with eval_f1 : 0.8547008547008547 at iteration 1
2025-06-04 19:29:33,332 - INFO - Current best: 0e5d3703 with eval_f1 : 0.8547008547008547 at iteration 1
2025-06-04 19:29:33,339	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-28-52' in 0.0054s.
[36m(train_hpo pid=3452506)[0m 2025-06-04 19:29:33,265 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3452506)[0m 2025-06-04 19:29:33,271 - INFO - eval_result: {'eval_loss': 0.001734631136059761, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.6963839530944824, 'eval_AP': 0.9992307692307693, 'eval_MCC': 0.0, 'eval_NDCG': 0.9998675732874671, 'eval_kappa': 0.0, 'eval_runtime': 3.343, 'eval_samples_per_second': 20.042, 'eval_steps_per_second': 1.197, 'epoch': 3.4}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3452506)[0m 2025-06-04 19:29:33,307 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB[32m [repeated 2x across cluster][0m
2025-06-04 19:29:33,346 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x71a3ae7c8cd0>
2025-06-04 19:29:33,347 - INFO - Best trial : train_hpo_33d57123
2025-06-04 19:29:33,347 - INFO - Best config : {'alpha': 0.6252016107931255, 'gamma': 2.6992695521978884, 'learning_rate': 1.8822311491442127e-05, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 4}
2025-06-04 19:29:33,347 - INFO - Best trial after optimization: {'eval_loss': 0.02970617450773716, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.6119607090950012, 'eval_AP': 0.9988307692307693, 'eval_MCC': 0.0, 'eval_NDCG': 0.9997983839371136, 'eval_kappa': 0.0, 'eval_runtime': 4.1222, 'eval_samples_per_second': 16.253, 'eval_steps_per_second': 0.97, 'epoch': 2.8, 'timestamp': 1749058164, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '33d57123', 'date': '2025-06-04_19-29-24', 'time_this_iter_s': 25.22811484336853, 'time_total_s': 25.22811484336853, 'pid': 3452274, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'alpha': 0.6252016107931255, 'gamma': 2.6992695521978884, 'learning_rate': 1.8822311491442127e-05, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 4}, 'time_since_restore': 25.22811484336853, 'iterations_since_restore': 1, 'experiment_tag': '1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364'}
2025-06-04 19:29:33,368 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   0.029706  0.854701  ...                        4  33d57123
1   0.001735  0.854701  ...                        5  23ab255a
2   0.001818  0.854701  ...                        2  0e5d3703

[3 rows x 33 columns]
2025-06-04 19:29:33,516 - INFO - Trial comparison plot saved
2025-06-04 19:29:33,517 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-04 19:29:34,108 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.25 and gamma=2.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-04 19:29:34,201 - INFO - training size : 198
2025-06-04 19:29:34,202 - INFO - dev size : 67
2025-06-04 19:29:34,202 - INFO - test size : 132
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(


Trial train_hpo_23ab255a finished iteration 1 at 2025-06-04 19:29:33. Total running time: 41s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_23ab255a result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    27.3014 â”‚
â”‚ time_total_s                        27.3014 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   3.4 â”‚
â”‚ eval_AP                             0.99923 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.99987 â”‚
â”‚ eval_accuracy                       0.74627 â”‚
â”‚ eval_f1                              0.8547 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           0.00173 â”‚
â”‚ eval_optim_threshold                0.69638 â”‚
â”‚ eval_precision                      0.74627 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                          3.343 â”‚
â”‚ eval_samples_per_second              20.042 â”‚
â”‚ eval_steps_per_second                 1.197 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_23ab255a completed after 1 iterations at 2025-06-04 19:29:33. Total running time: 41s

Trial status: 3 TERMINATED
Current time: 2025-06-04 19:29:33. Total running time: 41s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_33d57123   TERMINATED   0.625202   2.69927       1.88223e-05         0.13641                     4        1            25.2281    0.0297062     0.854701               1          0.746269 â”‚
â”‚ train_hpo_23ab255a   TERMINATED   0.970578   4.6341        5.16112e-05         0.123031                    5        1            27.3014    0.00173463    0.854701               1          0.746269 â”‚
â”‚ train_hpo_0e5d3703   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            13.6746    0.00181815    0.854701               1          0.746269 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

[36m(train_hpo pid=3452506)[0m {'eval_loss': 0.001734631136059761, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.6963839530944824, 'eval_AP': 0.9992307692307693, 'eval_MCC': 0.0, 'eval_NDCG': 0.9998675732874671, 'eval_kappa': 0.0, 'eval_runtime': 3.343, 'eval_samples_per_second': 20.042, 'eval_steps_per_second': 1.197, 'epoch': 3.4}
[36m(train_hpo pid=3452506)[0m {'loss': 0.0019, 'grad_norm': 0.012463276274502277, 'learning_rate': 0.0, 'epoch': 3.4}[32m [repeated 2x across cluster][0m
  0%|          | 0/36 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  3%|â–Ž         | 1/36 [00:00<00:22,  1.55it/s]  6%|â–Œ         | 2/36 [00:01<00:21,  1.60it/s]  8%|â–Š         | 3/36 [00:01<00:20,  1.61it/s] 11%|â–ˆ         | 4/36 [00:02<00:19,  1.62it/s] 14%|â–ˆâ–        | 5/36 [00:03<00:19,  1.61it/s] 17%|â–ˆâ–‹        | 6/36 [00:03<00:18,  1.62it/s] 19%|â–ˆâ–‰        | 7/36 [00:04<00:17,  1.62it/s] 22%|â–ˆâ–ˆâ–       | 8/36 [00:04<00:17,  1.64it/s] 25%|â–ˆâ–ˆâ–Œ       | 9/36 [00:05<00:14,  1.92it/s]                                               25%|â–ˆâ–ˆâ–Œ       | 9/36 [00:05<00:14,  1.92it/s] 28%|â–ˆâ–ˆâ–Š       | 10/36 [00:05<00:14,  1.80it/s] 31%|â–ˆâ–ˆâ–ˆ       | 11/36 [00:06<00:14,  1.74it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 12/36 [00:07<00:14,  1.71it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 13/36 [00:07<00:13,  1.68it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 14/36 [00:08<00:13,  1.67it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 15/36 [00:08<00:12,  1.65it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 16/36 [00:09<00:12,  1.65it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 17/36 [00:10<00:11,  1.65it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 18/36 [00:10<00:09,  1.92it/s]                                                50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 18/36 [00:10<00:09,  1.92it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 19/36 [00:11<00:09,  1.80it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 20/36 [00:11<00:09,  1.75it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 21/36 [00:12<00:08,  1.71it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 22/36 [00:12<00:08,  1.68it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 23/36 [00:13<00:07,  1.67it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 24/36 [00:14<00:07,  1.66it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 25/36 [00:14<00:06,  1.65it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 26/36 [00:15<00:06,  1.65it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 27/36 [00:15<00:04,  1.93it/s]                                                75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 27/36 [00:15<00:04,  1.93it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 28/36 [00:16<00:04,  1.81it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 29/36 [00:16<00:04,  1.75it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 30/36 [00:17<00:03,  1.71it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 31/36 [00:18<00:02,  1.69it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 32/36 [00:18<00:02,  1.67it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 33/36 [00:19<00:01,  1.66it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 34/36 [00:20<00:01,  1.64it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 35/36 [00:20<00:00,  1.65it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [00:20<00:00,  1.92it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [00:22<00:00,  1.92it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [00:22<00:00,  1.92it/s]2025-06-04 19:29:57,366 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [00:22<00:00,  1.59it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
{'loss': 0.0389, 'grad_norm': 0.5469964146614075, 'learning_rate': 1.4116733618581595e-05, 'epoch': 1.0}
{'loss': 0.0209, 'grad_norm': 0.16627730429172516, 'learning_rate': 9.411155745721064e-06, 'epoch': 2.0}
{'loss': 0.0134, 'grad_norm': 0.37746623158454895, 'learning_rate': 4.705577872860532e-06, 'epoch': 3.0}
{'loss': 0.0078, 'grad_norm': 0.11012990772724152, 'learning_rate': 0.0, 'epoch': 4.0}
{'train_runtime': 22.6128, 'train_samples_per_second': 35.024, 'train_steps_per_second': 1.592, 'train_loss': 0.020262683224346902, 'epoch': 4.0}
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.30it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.45it/s]2025-06-04 19:30:01,007 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.11s/it]
2025-06-04 19:30:01,013 - INFO - Training time : 27.495270516956225
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.18it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.04it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.37it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.10it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.33it/s]2025-06-04 19:30:05,459 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.45it/s]
2025-06-04 19:30:05,464 - INFO - Evaluation time : 4.451798919122666
2025-06-04 19:30:05,464 - INFO - Evaluation results on test set: {'eval_loss': 0.008564413525164127, 'eval_f1': 0.9795918367346939, 'eval_recall': 0.9896907216494846, 'eval_accuracy': 0.9696969696969697, 'eval_precision': 0.9696969696969697, 'eval_optim_threshold': 0.6741942763328552, 'eval_AP': 0.9995917117484943, 'eval_MCC': 0.9215150488583784, 'eval_NDCG': 0.9999361711546718, 'eval_kappa': 0.9207920792079208, 'eval_runtime': 4.4472, 'eval_samples_per_second': 29.682, 'eval_steps_per_second': 1.349, 'epoch': 4.0}
2025-06-04 19:30:05,465 - INFO - Total updates (optimizer steps): 36
2025-06-04 19:30:05,465 - INFO - Avg time / step: 0.628s
2025-06-04 19:30:06,262 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_focaldmis-lab/biobert-v1.13trials_fold-3
2025-06-04 19:30:06,263 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  6.98it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  4.90it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.30it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.08it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.32it/s]2025-06-04 19:30:10,841 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.40it/s]
2025-06-04 19:30:10,850 - INFO - preds : [1 1 1 1 1 0 1 1 1 0 1 1 0 0 0 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 0 0 1 1 0 1
 1 0 1 1 1 1 0 1 1 0 1 1 1 0 1 0 1 0 1 1 1 1 0 1 1 1 1 1 0 1 0 1 1 1 1 0 0
 1 1 1 1 1 1 0 1 1 1 1 1 0 1 1 0 1 1 1 1 0 1 1 1 1 1 1 0 0 1 1 0 1 1 1 1 0
 0 1 1 1 1 1 1 1 1 0 1 1 1 0 0 1 1 0 1 1 1]
2025-06-04 19:30:10,851 - INFO - test_split["labels"] : [1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1]
2025-06-04 19:30:10,852 - INFO - Confusion matrix: TN=32, FP=3, FN=1, TP=96
2025-06-04 19:30:13,715 - INFO - Metrics: {'f1': 0.9795918367346939, 'recall': 0.9896907216494846, 'precision': 0.9696969696969697, 'accuracy': 0.9696969696969697, 'AP': 0.9995917117484943, 'MCC': 0.9215150488583784, 'NDCG': 0.9999361711546718, 'kappa': 0.9207920792079208, 'TN': 32, 'FP': 3, 'FN': 1, 'TP': 96}
2025-06-04 19:30:13,853 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-04 19:30:13,961 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:30:13,962 - INFO - 
On test Set (optimal threshold of 0.7605147957801819 according to cross validation on the training set): 
2025-06-04 19:30:13,964 - INFO - Confusion matrix: TN=35, FP=0, FN=4, TP=93
2025-06-04 19:30:17,235 - INFO - Metrics: {'f1': 0.9789473684210527, 'recall': 0.9587628865979382, 'precision': 1.0, 'accuracy': 0.9696969696969697, 'AP': 0.9995917117484943, 'MCC': 0.9275927077992, 'NDCG': 0.9999361711546718, 'kappa': 0.9249786871270247, 'TN': 35, 'FP': 0, 'FN': 4, 'TP': 93}
2025-06-04 19:30:17,342 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:30:17,343 - INFO - Results for fold 3 : [{'f1': 0.9789473684210527, 'recall': 0.9587628865979382, 'precision': 1.0, 'accuracy': 0.9696969696969697, 'AP': 0.9995917117484943, 'MCC': 0.9275927077992, 'NDCG': 0.9999361711546718, 'kappa': 0.9249786871270247, 'TN': 35, 'FP': 0, 'FN': 4, 'TP': 93}]
2025-06-04 19:30:17,463 - INFO - Cleared CUDA cache. Memory allocated: 1.40 GB, Memory reserved: 1.84 GB
2025-06-04 19:30:17,463 - INFO - Cleared CUDA cache. Memory allocated: 1.40 GB, Memory reserved: 1.84 GB
2025-06-04 19:30:17,512 - INFO - Cleared CUDA cache. Memory allocated: 0.02 GB, Memory reserved: 0.03 GB
2025-06-04 19:30:17,530 - INFO - Metrics for dmis-lab/biobert-v1.1:                model_name fold loss_type run  ...    TN    FP   FN    TP
18  dmis-lab/biobert-v1.1    1     focal   1  ...  35.0   0.0  0.0  98.0
19  dmis-lab/biobert-v1.1    2     focal   1  ...   1.0  33.0  0.0  98.0
20  dmis-lab/biobert-v1.1    3     focal   1  ...   0.0  35.0  0.0  97.0
0   dmis-lab/biobert-v1.1    1     focal   2  ...  35.0   0.0  1.0  97.0
0   dmis-lab/biobert-v1.1    2     focal   2  ...   0.0  34.0  0.0  98.0
0   dmis-lab/biobert-v1.1    3     focal   2  ...  32.0   3.0  1.0  96.0

[6 rows x 18 columns]
2025-06-04 19:30:17,530 - INFO - Training model 2/2: google-bert/bert-base-uncased
2025-06-04 19:30:17,900 - INFO - 
fold number 1 / 3
2025-06-04 19:30:17,915 - INFO - train split size : 198
2025-06-04 19:30:17,915 - INFO - dev split size : 66
2025-06-04 19:30:17,915 - INFO - test split size : 133
Map (num_proc=32):   0%|          | 0/198 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–Ž         | 7/198 [00:00<00:06, 31.74 examples/s]Map (num_proc=32):  21%|â–ˆâ–ˆ        | 42/198 [00:00<00:01, 151.93 examples/s]Map (num_proc=32):  36%|â–ˆâ–ˆâ–ˆâ–‹      | 72/198 [00:00<00:00, 191.41 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 102/198 [00:00<00:00, 213.34 examples/s]Map (num_proc=32):  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 126/198 [00:00<00:00, 216.24 examples/s]Map (num_proc=32):  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 150/198 [00:00<00:00, 216.01 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 180/198 [00:00<00:00, 232.48 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 198/198 [00:01<00:00, 180.41 examples/s]
Map (num_proc=32):   0%|          | 0/66 [00:00<?, ? examples/s]Map (num_proc=32):   5%|â–         | 3/66 [00:00<00:04, 14.71 examples/s]Map (num_proc=32):  21%|â–ˆâ–ˆ        | 14/66 [00:00<00:01, 46.64 examples/s]Map (num_proc=32):  36%|â–ˆâ–ˆâ–ˆâ–‹      | 24/66 [00:00<00:00, 63.22 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 34/66 [00:00<00:00, 71.02 examples/s]Map (num_proc=32):  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 42/66 [00:00<00:00, 73.64 examples/s]Map (num_proc=32):  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 50/66 [00:00<00:00, 72.96 examples/s]Map (num_proc=32):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 62/66 [00:00<00:00, 82.82 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 66/66 [00:01<00:00, 61.83 examples/s]
Map (num_proc=32):   0%|          | 0/133 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/133 [00:00<00:04, 25.84 examples/s]Map (num_proc=32):  22%|â–ˆâ–ˆâ–       | 29/133 [00:00<00:00, 106.55 examples/s]Map (num_proc=32):  37%|â–ˆâ–ˆâ–ˆâ–‹      | 49/133 [00:00<00:00, 134.75 examples/s]Map (num_proc=32):  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 65/133 [00:00<00:00, 137.48 examples/s]Map (num_proc=32):  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 81/133 [00:00<00:00, 141.27 examples/s]Map (num_proc=32):  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 101/133 [00:00<00:00, 151.73 examples/s]Map (num_proc=32):  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 117/133 [00:00<00:00, 151.06 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 133/133 [00:01<00:00, 123.26 examples/s]
2025-06-04 19:30:27,799 - INFO - 3 datasets tokenized successfully
2025-06-04 19:30:27,800 - INFO - Starting hyperparameter search for focal loss
[36m(train_hpo pid=3455196)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3455196)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3455196)[0m 2025-06-04 19:30:35,283 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.6252016107931255 and gamma=2.6992695521978884
[36m(train_hpo pid=3455196)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3455196)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3455196)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3455196)[0m   warnings.warn(
[36m(train_hpo pid=3455358)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3455358)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3455358)[0m 2025-06-04 19:30:41,996 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.970577641092792 and gamma=4.634102840173219
[36m(train_hpo pid=3455358)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3455358)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3455358)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3455358)[0m   warnings.warn(
[36m(train_hpo pid=3455638)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3455638)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3455638)[0m 2025-06-04 19:30:48,794 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.7811204413478371 and gamma=6.807074484302038
[36m(train_hpo pid=3455638)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3455638)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3455638)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3455638)[0m   warnings.warn(
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-04_19-30-27   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-30-27
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-04_18-54-36_274448_3393636/artifacts/2025-06-04_19-30-27/train_hpo_2025-06-04_19-30-27/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-04 19:30:28. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_999bec50   PENDING    0.625202   2.69927       1.88223e-05          0.13641                    4 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_999bec50 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_999bec50 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                                0.6252 â”‚
â”‚ gamma                               2.69927 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          4 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3455196)[0m [2025-06-04 19:30:35,546] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3455196)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=8, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_2eb9688d started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_2eb9688d config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.97058 â”‚
â”‚ gamma                                4.6341 â”‚
â”‚ learning_rate                         5e-05 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3455358)[0m [2025-06-04 19:30:42,390] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3455196)[0m {'loss': 0.0362, 'grad_norm': 0.19313094019889832, 'learning_rate': 1.176394468215133e-05, 'epoch': 1.0}
[36m(train_hpo pid=3455358)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3455196)[0m {'loss': 0.0326, 'grad_norm': 0.7381865382194519, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.0}

Trial train_hpo_8076c61f started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_8076c61f config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.78112 â”‚
â”‚ gamma                               6.80707 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          2 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3455638)[0m [2025-06-04 19:30:49,055] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3455638)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=4, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3455358)[0m {'loss': 0.0369, 'grad_norm': 0.7156780958175659, 'learning_rate': 3.612785445936571e-05, 'epoch': 1.0}
[36m(train_hpo pid=3455196)[0m {'train_runtime': 16.4531, 'train_samples_per_second': 48.137, 'train_steps_per_second': 0.486, 'train_loss': 0.034601788967847824, 'epoch': 2.8}
[36m(train_hpo pid=3455196)[0m STATE at ending of training  :  TrainerState(epoch=2.8, global_step=8, max_steps=8, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=146288433303552.0, log_history=[{'loss': 0.0362, 'grad_norm': 0.19313094019889832, 'learning_rate': 1.176394468215133e-05, 'epoch': 1.0, 'step': 3}, {'loss': 0.0326, 'grad_norm': 0.7381865382194519, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.0, 'step': 6}, {'loss': 0.0353, 'grad_norm': 0.6477035880088806, 'learning_rate': 0.0, 'epoch': 2.8, 'step': 8}, {'train_runtime': 16.4531, 'train_samples_per_second': 48.137, 'train_steps_per_second': 0.486, 'total_flos': 146288433303552.0, 'train_loss': 0.034601788967847824, 'epoch': 2.8, 'step': 8}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})[36m(train_hpo pid=3455196)[0m 2025-06-04 19:30:59,228 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3455196)[0m 2025-06-04 19:30:59,234 - INFO - eval_result: {'eval_loss': 0.03317668288946152, 'eval_f1': 0.8596491228070176, 'eval_recall': 1.0, 'eval_accuracy': 0.7575757575757576, 'eval_precision': 0.7538461538461538, 'eval_optim_threshold': 0.5836042761802673, 'eval_AP': 0.9846701234444123, 'eval_MCC': 0.2105798931586654, 'eval_NDCG': 0.9969868387669101, 'eval_kappa': 0.08492201039861347, 'eval_runtime': 3.9399, 'eval_samples_per_second': 16.752, 'eval_steps_per_second': 1.015, 'epoch': 2.8}
2025-06-04 19:30:59,298 - INFO - Cleaning up trial 999bec50
2025-06-04 19:30:59,300 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-30-27/train_hpo_999bec50_1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364_2025-06-04_19-30-27
[36m(train_hpo pid=3455196)[0m 2025-06-04 19:30:59,274 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
2025-06-04 19:31:01,638 - INFO - Cleaning up trial 8076c61f
2025-06-04 19:31:01,639 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-30-27/train_hpo_8076c61f_3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512_2025-06-04_19-30-41
2025-06-04 19:31:01,639 - INFO - Current best: 999bec50 with eval_f1 : 0.8596491228070176 at iteration 1


Trial status: 3 RUNNING
Current time: 2025-06-04 19:30:58. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_999bec50   RUNNING    0.625202   2.69927       1.88223e-05         0.13641                     4 â”‚
â”‚ train_hpo_2eb9688d   RUNNING    0.970578   4.6341        5.16112e-05         0.123031                    5 â”‚
â”‚ train_hpo_8076c61f   RUNNING    0.78112    6.80707       1.88581e-05         0.251217                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3455638)[0m STATE at ending of training  :  TrainerState(epoch=1.4, global_step=4, max_steps=4, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=73144216651776.0, log_history=[{'loss': 0.0032, 'grad_norm': 0.1355585902929306, 'learning_rate': 4.714527732738613e-06, 'epoch': 1.0, 'step': 3}, {'loss': 0.0035, 'grad_norm': 0.1760975569486618, 'learning_rate': 0.0, 'epoch': 1.4, 'step': 4}, {'train_runtime': 5.7791, 'train_samples_per_second': 68.523, 'train_steps_per_second': 0.692, 'total_flos': 73144216651776.0, 'train_loss': 0.003283609519712627, 'epoch': 1.4, 'step': 4}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3455196)[0m {'eval_loss': 0.03317668288946152, 'eval_f1': 0.8596491228070176, 'eval_recall': 1.0, 'eval_accuracy': 0.7575757575757576, 'eval_precision': 0.7538461538461538, 'eval_optim_threshold': 0.5836042761802673, 'eval_AP': 0.9846701234444123, 'eval_MCC': 0.2105798931586654, 'eval_NDCG': 0.9969868387669101, 'eval_kappa': 0.08492201039861347, 'eval_runtime': 3.9399, 'eval_samples_per_second': 16.752, 'eval_steps_per_second': 1.015, 'epoch': 2.8}

Trial train_hpo_999bec50 finished iteration 1 at 2025-06-04 19:30:59. Total running time: 31s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_999bec50 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    24.4577 â”‚
â”‚ time_total_s                        24.4577 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   2.8 â”‚
â”‚ eval_AP                             0.98467 â”‚
â”‚ eval_MCC                            0.21058 â”‚
â”‚ eval_NDCG                           0.99699 â”‚
â”‚ eval_accuracy                       0.75758 â”‚
â”‚ eval_f1                             0.85965 â”‚
â”‚ eval_kappa                          0.08492 â”‚
â”‚ eval_loss                           0.03318 â”‚
â”‚ eval_optim_threshold                 0.5836 â”‚
â”‚ eval_precision                      0.75385 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.9399 â”‚
â”‚ eval_samples_per_second              16.752 â”‚
â”‚ eval_steps_per_second                 1.015 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_999bec50 completed after 1 iterations at 2025-06-04 19:30:59. Total running time: 31s

Trial train_hpo_8076c61f finished iteration 1 at 2025-06-04 19:31:01. Total running time: 33s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_8076c61f result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    13.2489 â”‚
â”‚ time_total_s                        13.2489 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   1.4 â”‚
â”‚ eval_AP                             0.72105 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.87855 â”‚
â”‚ eval_accuracy                       0.74242 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           0.00242 â”‚
â”‚ eval_optim_threshold                0.53555 â”‚
â”‚ eval_precision                      0.74242 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.5044 â”‚
â”‚ eval_samples_per_second              18.833 â”‚
â”‚ eval_steps_per_second                 1.141 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3455358)[0m {'loss': 0.0024, 'grad_norm': 0.016089076176285744, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.0}[32m [repeated 4x across cluster][0m
[36m(train_hpo pid=3455638)[0m {'train_runtime': 5.7791, 'train_samples_per_second': 68.523, 'train_steps_per_second': 0.692, 'train_loss': 0.003283609519712627, 'epoch': 1.4}

Trial train_hpo_8076c61f completed after 1 iterations at 2025-06-04 19:31:01. Total running time: 33s
[36m(train_hpo pid=3455358)[0m {'train_runtime': 19.2453, 'train_samples_per_second': 51.441, 'train_steps_per_second': 0.52, 'train_loss': 0.012896329909563065, 'epoch': 3.4}
[36m(train_hpo pid=3455358)[0m STATE at ending of training  :  TrainerState(epoch=3.4, global_step=10, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=177335259076608.0, log_history=[{'loss': 0.0369, 'grad_norm': 0.7156780958175659, 'learning_rate': 3.612785445936571e-05, 'epoch': 1.0, 'step': 3}, {'loss': 0.0024, 'grad_norm': 0.016089076176285744, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.0, 'step': 6}, {'loss': 0.0025, 'grad_norm': 0.03594062477350235, 'learning_rate': 5.161122065623674e-06, 'epoch': 3.0, 'step': 9}, {'loss': 0.0033, 'grad_norm': 0.07808734476566315, 'learning_rate': 0.0, 'epoch': 3.4, 'step': 10}, {'train_runtime': 19.2453, 'train_samples_per_second': 51.441, 'train_steps_per_second': 0.52, 'total_flos': 177335259076608.0, 'train_loss': 0.012896329909563065, 'epoch': 3.4, 'step': 10}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3455638)[0m {'eval_loss': 0.0024220861960202456, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.5355530977249146, 'eval_AP': 0.7210506978314434, 'eval_MCC': 0.0, 'eval_NDCG': 0.8785549870951087, 'eval_kappa': 0.0, 'eval_runtime': 3.5044, 'eval_samples_per_second': 18.833, 'eval_steps_per_second': 1.141, 'epoch': 1.4}2025-06-04 19:31:08,323 - INFO - Cleaning up trial 2eb9688d
2025-06-04 19:31:08,324 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-30-27/train_hpo_2eb9688d_2_alpha=0.9706,gamma=4.6341,learning_rate=0.0001,num_train_epochs=5,weight_decay=0.1230_2025-06-04_19-30-34
2025-06-04 19:31:08,324 - INFO - Current best: 999bec50 with eval_f1 : 0.8596491228070176 at iteration 1
2025-06-04 19:31:08,324 - INFO - Cleaning up trial 8076c61f
2025-06-04 19:31:08,324 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-30-27/train_hpo_8076c61f_3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512_2025-06-04_19-30-41
2025-06-04 19:31:08,331	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-30-27' in 0.0054s.
2025-06-04 19:31:08,338 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x719abc10ccd0>
2025-06-04 19:31:08,339 - INFO - Best trial : train_hpo_999bec50
2025-06-04 19:31:08,339 - INFO - Best config : {'alpha': 0.6252016107931255, 'gamma': 2.6992695521978884, 'learning_rate': 1.8822311491442127e-05, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 4}
2025-06-04 19:31:08,339 - INFO - Best trial after optimization: {'eval_loss': 0.03317668288946152, 'eval_f1': 0.8596491228070176, 'eval_recall': 1.0, 'eval_accuracy': 0.7575757575757576, 'eval_precision': 0.7538461538461538, 'eval_optim_threshold': 0.5836042761802673, 'eval_AP': 0.9846701234444123, 'eval_MCC': 0.2105798931586654, 'eval_NDCG': 0.9969868387669101, 'eval_kappa': 0.08492201039861347, 'eval_runtime': 3.9399, 'eval_samples_per_second': 16.752, 'eval_steps_per_second': 1.015, 'epoch': 2.8, 'timestamp': 1749058259, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '999bec50', 'date': '2025-06-04_19-30-59', 'time_this_iter_s': 24.457710027694702, 'time_total_s': 24.457710027694702, 'pid': 3455196, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'alpha': 0.6252016107931255, 'gamma': 2.6992695521978884, 'learning_rate': 1.8822311491442127e-05, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 4}, 'time_since_restore': 24.457710027694702, 'iterations_since_restore': 1, 'experiment_tag': '1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364'}
2025-06-04 19:31:08,361 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   0.033177  0.859649  ...                        4  999bec50
1   0.002437  0.852174  ...                        5  2eb9688d
2   0.002422  0.852174  ...                        2  8076c61f

[3 rows x 33 columns]
[36m(train_hpo pid=3455358)[0m 2025-06-04 19:31:08,262 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3455358)[0m 2025-06-04 19:31:08,268 - INFO - eval_result: {'eval_loss': 0.0024365864228457212, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.7505080103874207, 'eval_AP': 0.9991753436068305, 'eval_MCC': 0.0, 'eval_NDCG': 0.9998575507973486, 'eval_kappa': 0.0, 'eval_runtime': 3.3139, 'eval_samples_per_second': 19.916, 'eval_steps_per_second': 1.207, 'epoch': 3.4}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3455358)[0m 2025-06-04 19:31:08,300 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB[32m [repeated 2x across cluster][0m
2025-06-04 19:31:08,552 - INFO - Trial comparison plot saved
2025-06-04 19:31:08,552 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-04 19:31:08,774 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.25 and gamma=2.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-04 19:31:08,885 - INFO - training size : 198
2025-06-04 19:31:08,886 - INFO - dev size : 66
2025-06-04 19:31:08,886 - INFO - test size : 133
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(


Trial train_hpo_2eb9688d finished iteration 1 at 2025-06-04 19:31:08. Total running time: 40s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_2eb9688d result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    26.7626 â”‚
â”‚ time_total_s                        26.7626 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   3.4 â”‚
â”‚ eval_AP                             0.99918 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.99986 â”‚
â”‚ eval_accuracy                       0.74242 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           0.00244 â”‚
â”‚ eval_optim_threshold                0.75051 â”‚
â”‚ eval_precision                      0.74242 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.3139 â”‚
â”‚ eval_samples_per_second              19.916 â”‚
â”‚ eval_steps_per_second                 1.207 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_2eb9688d completed after 1 iterations at 2025-06-04 19:31:08. Total running time: 40s

Trial status: 3 TERMINATED
Current time: 2025-06-04 19:31:08. Total running time: 40s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_999bec50   TERMINATED   0.625202   2.69927       1.88223e-05         0.13641                     4        1            24.4577    0.0331767     0.859649               1          0.757576 â”‚
â”‚ train_hpo_2eb9688d   TERMINATED   0.970578   4.6341        5.16112e-05         0.123031                    5        1            26.7626    0.00243659    0.852174               1          0.742424 â”‚
â”‚ train_hpo_8076c61f   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            13.2489    0.00242209    0.852174               1          0.742424 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

[36m(train_hpo pid=3455358)[0m {'eval_loss': 0.0024365864228457212, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.7505080103874207, 'eval_AP': 0.9991753436068305, 'eval_MCC': 0.0, 'eval_NDCG': 0.9998575507973486, 'eval_kappa': 0.0, 'eval_runtime': 3.3139, 'eval_samples_per_second': 19.916, 'eval_steps_per_second': 1.207, 'epoch': 3.4}
[36m(train_hpo pid=3455358)[0m {'loss': 0.0033, 'grad_norm': 0.07808734476566315, 'learning_rate': 0.0, 'epoch': 3.4}[32m [repeated 2x across cluster][0m
  0%|          | 0/36 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  3%|â–Ž         | 1/36 [00:00<00:22,  1.54it/s]  6%|â–Œ         | 2/36 [00:01<00:21,  1.59it/s]  8%|â–Š         | 3/36 [00:01<00:20,  1.60it/s] 11%|â–ˆ         | 4/36 [00:02<00:19,  1.61it/s] 14%|â–ˆâ–        | 5/36 [00:03<00:19,  1.62it/s] 17%|â–ˆâ–‹        | 6/36 [00:03<00:18,  1.62it/s] 19%|â–ˆâ–‰        | 7/36 [00:04<00:17,  1.62it/s] 22%|â–ˆâ–ˆâ–       | 8/36 [00:04<00:17,  1.63it/s] 25%|â–ˆâ–ˆâ–Œ       | 9/36 [00:05<00:14,  1.92it/s]                                               25%|â–ˆâ–ˆâ–Œ       | 9/36 [00:05<00:14,  1.92it/s] 28%|â–ˆâ–ˆâ–Š       | 10/36 [00:05<00:14,  1.80it/s] 31%|â–ˆâ–ˆâ–ˆ       | 11/36 [00:06<00:14,  1.74it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 12/36 [00:07<00:14,  1.69it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 13/36 [00:07<00:13,  1.67it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 14/36 [00:08<00:13,  1.65it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 15/36 [00:08<00:12,  1.64it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 16/36 [00:09<00:12,  1.64it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 17/36 [00:10<00:11,  1.65it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 18/36 [00:10<00:09,  1.91it/s]                                                50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 18/36 [00:10<00:09,  1.91it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 19/36 [00:11<00:09,  1.79it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 20/36 [00:11<00:09,  1.73it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 21/36 [00:12<00:08,  1.70it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 22/36 [00:13<00:08,  1.67it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 23/36 [00:13<00:07,  1.65it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 24/36 [00:14<00:07,  1.64it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 25/36 [00:14<00:06,  1.63it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 26/36 [00:15<00:06,  1.64it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 27/36 [00:15<00:04,  1.90it/s]                                                75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 27/36 [00:15<00:04,  1.90it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 28/36 [00:16<00:04,  1.78it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 29/36 [00:17<00:04,  1.73it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 30/36 [00:17<00:03,  1.70it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 31/36 [00:18<00:02,  1.67it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 32/36 [00:18<00:02,  1.66it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 33/36 [00:19<00:01,  1.64it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 34/36 [00:20<00:01,  1.64it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 35/36 [00:20<00:00,  1.65it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [00:21<00:00,  1.91it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [00:23<00:00,  1.91it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [00:23<00:00,  1.91it/s]2025-06-04 19:31:32,529 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [00:23<00:00,  1.55it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
{'loss': 0.0431, 'grad_norm': 0.9830662608146667, 'learning_rate': 1.4116733618581595e-05, 'epoch': 1.0}
{'loss': 0.0239, 'grad_norm': 0.927097499370575, 'learning_rate': 9.411155745721064e-06, 'epoch': 2.0}
{'loss': 0.0111, 'grad_norm': 0.5531432032585144, 'learning_rate': 4.705577872860532e-06, 'epoch': 3.0}
{'loss': 0.0094, 'grad_norm': 0.6702876091003418, 'learning_rate': 0.0, 'epoch': 4.0}
{'train_runtime': 23.1992, 'train_samples_per_second': 34.139, 'train_steps_per_second': 1.552, 'train_loss': 0.021863471095760662, 'epoch': 4.0}
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.27it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.63it/s]2025-06-04 19:31:36,526 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.23s/it]
2025-06-04 19:31:36,532 - INFO - Training time : 27.979310426861048
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.12it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.02it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.36it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.10it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.24it/s]2025-06-04 19:31:41,397 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.32it/s]
2025-06-04 19:31:41,403 - INFO - Evaluation time : 4.871202347101644
2025-06-04 19:31:41,403 - INFO - Evaluation results on test set: {'eval_loss': 0.00803352054208517, 'eval_f1': 0.9949238578680203, 'eval_recall': 1.0, 'eval_accuracy': 0.9924812030075187, 'eval_precision': 0.98989898989899, 'eval_optim_threshold': 0.6508146524429321, 'eval_AP': 0.9998969284683572, 'eval_MCC': 0.9806202943118002, 'eval_NDCG': 0.9999840486799633, 'eval_kappa': 0.98043254376931, 'eval_runtime': 4.8655, 'eval_samples_per_second': 27.335, 'eval_steps_per_second': 1.233, 'epoch': 4.0}
2025-06-04 19:31:41,403 - INFO - Total updates (optimizer steps): 36
2025-06-04 19:31:41,403 - INFO - Avg time / step: 0.644s
2025-06-04 19:31:42,257 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_focalgoogle-bert/bert-base-uncased3trials_fold-1
2025-06-04 19:31:42,257 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.18it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.05it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.35it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.09it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.24it/s]2025-06-04 19:31:46,784 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.42it/s]
2025-06-04 19:31:46,787 - INFO - preds : [1 0 0 0 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 0 1 1 1 0 1 0 1 1 1 1 1 1
 1 1 1 0 0 1 0 1 1 0 1 1 1 1 0 0 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 0 0
 1 1 0 1 0 0 0 1 1 1 1 1 1 0 1 1 1 1 0 1 1 0 1 1 1 0 0 1 0 0 1 1 1 1 1 0 0
 0 1 1 1 1 1 0 1 0 1 1 1 1 1 1 1 0 1 1 1 1 0]
2025-06-04 19:31:46,788 - INFO - test_split["labels"] : [1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0]
2025-06-04 19:31:46,790 - INFO - Confusion matrix: TN=34, FP=1, FN=0, TP=98
2025-06-04 19:31:49,661 - INFO - Metrics: {'f1': 0.9949238578680203, 'recall': 1.0, 'precision': 0.98989898989899, 'accuracy': 0.9924812030075187, 'AP': 0.9998969284683572, 'MCC': 0.9806202943118002, 'NDCG': 0.9999840486799633, 'kappa': 0.98043254376931, 'TN': 34, 'FP': 1, 'FN': 0, 'TP': 98}
2025-06-04 19:31:49,778 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-04 19:31:49,871 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:31:49,871 - INFO - 
On test Set (optimal threshold of 0.3387022316455841 according to cross validation on the training set): 
2025-06-04 19:31:49,872 - INFO - Confusion matrix: TN=34, FP=1, FN=0, TP=98
2025-06-04 19:31:52,824 - INFO - Metrics: {'f1': 0.9949238578680203, 'recall': 1.0, 'precision': 0.98989898989899, 'accuracy': 0.9924812030075187, 'AP': 0.9998969284683572, 'MCC': 0.9806202943118002, 'NDCG': 0.9999840486799633, 'kappa': 0.98043254376931, 'TN': 34, 'FP': 1, 'FN': 0, 'TP': 98}
2025-06-04 19:31:52,923 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:31:52,923 - INFO - Results for fold 1 : [{'f1': 0.9949238578680203, 'recall': 1.0, 'precision': 0.98989898989899, 'accuracy': 0.9924812030075187, 'AP': 0.9998969284683572, 'MCC': 0.9806202943118002, 'NDCG': 0.9999840486799633, 'kappa': 0.98043254376931, 'TN': 34, 'FP': 1, 'FN': 0, 'TP': 98}]
2025-06-04 19:31:53,045 - INFO - Cleared CUDA cache. Memory allocated: 1.40 GB, Memory reserved: 1.77 GB
2025-06-04 19:31:53,045 - INFO - 
fold number 2 / 3
2025-06-04 19:31:53,052 - INFO - train split size : 198
2025-06-04 19:31:53,052 - INFO - dev split size : 67
2025-06-04 19:31:53,052 - INFO - test split size : 132
Map (num_proc=32):   0%|          | 0/198 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–Ž         | 7/198 [00:00<00:05, 35.80 examples/s]Map (num_proc=32):  21%|â–ˆâ–ˆ        | 42/198 [00:00<00:00, 156.93 examples/s]Map (num_proc=32):  36%|â–ˆâ–ˆâ–ˆâ–‹      | 72/198 [00:00<00:00, 202.89 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 102/198 [00:00<00:00, 228.89 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 132/198 [00:00<00:00, 240.60 examples/s]Map (num_proc=32):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 162/198 [00:00<00:00, 249.62 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 192/198 [00:00<00:00, 263.59 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 198/198 [00:00<00:00, 198.96 examples/s]
Map (num_proc=32):   0%|          | 0/67 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/67 [00:00<00:03, 16.75 examples/s]Map (num_proc=32):  22%|â–ˆâ–ˆâ–       | 15/67 [00:00<00:00, 60.94 examples/s]Map (num_proc=32):  37%|â–ˆâ–ˆâ–ˆâ–‹      | 25/67 [00:00<00:00, 72.04 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 35/67 [00:00<00:00, 80.41 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 45/67 [00:00<00:00, 86.22 examples/s]Map (num_proc=32):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 55/67 [00:00<00:00, 88.54 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 65/67 [00:00<00:00, 88.06 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:00<00:00, 69.30 examples/s]
Map (num_proc=32):   0%|          | 0/132 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/132 [00:00<00:04, 28.02 examples/s]Map (num_proc=32):  21%|â–ˆâ–ˆ        | 28/132 [00:00<00:00, 107.17 examples/s]Map (num_proc=32):  36%|â–ˆâ–ˆâ–ˆâ–‹      | 48/132 [00:00<00:00, 140.09 examples/s]Map (num_proc=32):  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 64/132 [00:00<00:00, 145.98 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 88/132 [00:00<00:00, 167.21 examples/s]Map (num_proc=32):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 108/132 [00:00<00:00, 172.29 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 128/132 [00:00<00:00, 168.09 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 132/132 [00:01<00:00, 130.05 examples/s]
2025-06-04 19:32:02,643 - INFO - 3 datasets tokenized successfully
2025-06-04 19:32:02,647 - INFO - Starting hyperparameter search for focal loss
[36m(train_hpo pid=3457706)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3457706)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3457706)[0m 2025-06-04 19:32:10,161 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.6252016107931255 and gamma=2.6992695521978884
[36m(train_hpo pid=3457706)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3457706)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3457706)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3457706)[0m   warnings.warn(
[36m(train_hpo pid=3457938)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3457938)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3457938)[0m 2025-06-04 19:32:17,042 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.970577641092792 and gamma=4.634102840173219
[36m(train_hpo pid=3457938)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3457938)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3457938)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3457938)[0m   warnings.warn(
[36m(train_hpo pid=3458218)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3458218)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3458218)[0m 2025-06-04 19:32:23,773 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.7811204413478371 and gamma=6.807074484302038
[36m(train_hpo pid=3458218)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3458218)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3458218)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3458218)[0m   warnings.warn(
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-04_19-32-02   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-32-02
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-04_18-54-36_274448_3393636/artifacts/2025-06-04_19-32-02/train_hpo_2025-06-04_19-32-02/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-04 19:32:02. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_9d97cc5f   PENDING    0.625202   2.69927       1.88223e-05          0.13641                    4 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_9d97cc5f started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_9d97cc5f config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                                0.6252 â”‚
â”‚ gamma                               2.69927 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          4 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3457706)[0m [2025-06-04 19:32:10,414] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3457706)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=8, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_1a524f2f started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_1a524f2f config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.97058 â”‚
â”‚ gamma                                4.6341 â”‚
â”‚ learning_rate                         5e-05 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3457938)[0m [2025-06-04 19:32:17,404] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3457706)[0m {'loss': 0.0398, 'grad_norm': 0.2693656086921692, 'learning_rate': 1.176394468215133e-05, 'epoch': 1.0}
[36m(train_hpo pid=3457938)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3457706)[0m {'loss': 0.0361, 'grad_norm': 0.31079062819480896, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.0}

Trial train_hpo_29c3cb91 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_29c3cb91 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.78112 â”‚
â”‚ gamma                               6.80707 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          2 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3458218)[0m [2025-06-04 19:32:24,011] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3458218)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=4, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3457706)[0m {'loss': 0.0393, 'grad_norm': 0.23914338648319244, 'learning_rate': 0.0, 'epoch': 2.8}
[36m(train_hpo pid=3457706)[0m {'train_runtime': 16.3012, 'train_samples_per_second': 48.585, 'train_steps_per_second': 0.491, 'train_loss': 0.03828257694840431, 'epoch': 2.8}
[36m(train_hpo pid=3457706)[0m STATE at ending of training  :  TrainerState(epoch=2.8, global_step=8, max_steps=8, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=146288433303552.0, log_history=[{'loss': 0.0398, 'grad_norm': 0.2693656086921692, 'learning_rate': 1.176394468215133e-05, 'epoch': 1.0, 'step': 3}, {'loss': 0.0361, 'grad_norm': 0.31079062819480896, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.0, 'step': 6}, {'loss': 0.0393, 'grad_norm': 0.23914338648319244, 'learning_rate': 0.0, 'epoch': 2.8, 'step': 8}, {'train_runtime': 16.3012, 'train_samples_per_second': 48.585, 'train_steps_per_second': 0.491, 'total_flos': 146288433303552.0, 'train_loss': 0.03828257694840431, 'epoch': 2.8, 'step': 8}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})2025-06-04 19:32:33,961 - INFO - Cleaning up trial 9d97cc5f
2025-06-04 19:32:33,962 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-32-02/train_hpo_9d97cc5f_1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364_2025-06-04_19-32-02
[36m(train_hpo pid=3457706)[0m 2025-06-04 19:32:33,893 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3457706)[0m 2025-06-04 19:32:33,899 - INFO - eval_result: {'eval_loss': 0.03825495392084122, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.5976898670196533, 'eval_AP': 0.9767396992511144, 'eval_MCC': 0.0, 'eval_NDCG': 0.9957188480430099, 'eval_kappa': 0.0, 'eval_runtime': 3.8957, 'eval_samples_per_second': 17.199, 'eval_steps_per_second': 1.027, 'epoch': 2.8}
[36m(train_hpo pid=3457706)[0m 2025-06-04 19:32:33,934 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
2025-06-04 19:32:36,530 - INFO - Cleaning up trial 29c3cb91
2025-06-04 19:32:36,530 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-32-02/train_hpo_29c3cb91_3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512_2025-06-04_19-32-16
2025-06-04 19:32:36,530 - INFO - Current best: 9d97cc5f with eval_f1 : 0.8448275862068966 at iteration 1


Trial status: 3 RUNNING
Current time: 2025-06-04 19:32:32. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_9d97cc5f   RUNNING    0.625202   2.69927       1.88223e-05         0.13641                     4 â”‚
â”‚ train_hpo_1a524f2f   RUNNING    0.970578   4.6341        5.16112e-05         0.123031                    5 â”‚
â”‚ train_hpo_29c3cb91   RUNNING    0.78112    6.80707       1.88581e-05         0.251217                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3458218)[0m STATE at ending of training  :  TrainerState(epoch=1.4, global_step=4, max_steps=4, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=73144216651776.0, log_history=[{'loss': 0.0022, 'grad_norm': 0.02246289700269699, 'learning_rate': 4.714527732738613e-06, 'epoch': 1.0, 'step': 3}, {'loss': 0.0024, 'grad_norm': 0.016580797731876373, 'learning_rate': 0.0, 'epoch': 1.4, 'step': 4}, {'train_runtime': 5.8015, 'train_samples_per_second': 68.258, 'train_steps_per_second': 0.689, 'total_flos': 73144216651776.0, 'train_loss': 0.002275990613270551, 'epoch': 1.4, 'step': 4}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_9d97cc5f finished iteration 1 at 2025-06-04 19:32:33. Total running time: 31s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_9d97cc5f result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                     24.229 â”‚
â”‚ time_total_s                         24.229 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   2.8 â”‚
â”‚ eval_AP                             0.97674 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.99572 â”‚
â”‚ eval_accuracy                       0.73134 â”‚
â”‚ eval_f1                             0.84483 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           0.03825 â”‚
â”‚ eval_optim_threshold                0.59769 â”‚
â”‚ eval_precision                      0.73134 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.8957 â”‚
â”‚ eval_samples_per_second              17.199 â”‚
â”‚ eval_steps_per_second                 1.027 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_9d97cc5f completed after 1 iterations at 2025-06-04 19:32:33. Total running time: 31s
[36m(train_hpo pid=3457706)[0m {'eval_loss': 0.03825495392084122, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.5976898670196533, 'eval_AP': 0.9767396992511144, 'eval_MCC': 0.0, 'eval_NDCG': 0.9957188480430099, 'eval_kappa': 0.0, 'eval_runtime': 3.8957, 'eval_samples_per_second': 17.199, 'eval_steps_per_second': 1.027, 'epoch': 2.8}
[36m(train_hpo pid=3457938)[0m {'loss': 0.0039, 'grad_norm': 0.06449582427740097, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.0}[32m [repeated 4x across cluster][0m
[36m(train_hpo pid=3458218)[0m {'train_runtime': 5.8015, 'train_samples_per_second': 68.258, 'train_steps_per_second': 0.689, 'train_loss': 0.002275990613270551, 'epoch': 1.4}

Trial train_hpo_29c3cb91 finished iteration 1 at 2025-06-04 19:32:36. Total running time: 33s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_29c3cb91 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    13.1667 â”‚
â”‚ time_total_s                        13.1667 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   1.4 â”‚
â”‚ eval_AP                             0.93702 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.98731 â”‚
â”‚ eval_accuracy                       0.73134 â”‚
â”‚ eval_f1                             0.84483 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           0.00195 â”‚
â”‚ eval_optim_threshold                0.58344 â”‚
â”‚ eval_precision                      0.73134 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.4144 â”‚
â”‚ eval_samples_per_second              19.623 â”‚
â”‚ eval_steps_per_second                 1.172 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_29c3cb91 completed after 1 iterations at 2025-06-04 19:32:36. Total running time: 33s
[36m(train_hpo pid=3457938)[0m {'train_runtime': 19.1612, 'train_samples_per_second': 51.667, 'train_steps_per_second': 0.522, 'train_loss': 0.006171159259974956, 'epoch': 3.4}
[36m(train_hpo pid=3457938)[0m STATE at ending of training  :  TrainerState(epoch=3.4, global_step=10, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=177335259076608.0, log_history=[{'loss': 0.0132, 'grad_norm': 0.3032010793685913, 'learning_rate': 3.612785445936571e-05, 'epoch': 1.0, 'step': 3}, {'loss': 0.0039, 'grad_norm': 0.06449582427740097, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.0, 'step': 6}, {'loss': 0.0024, 'grad_norm': 0.007958759553730488, 'learning_rate': 5.161122065623674e-06, 'epoch': 3.0, 'step': 9}, {'loss': 0.0033, 'grad_norm': 0.045068707317113876, 'learning_rate': 0.0, 'epoch': 3.4, 'step': 10}, {'train_runtime': 19.1612, 'train_samples_per_second': 51.667, 'train_steps_per_second': 0.522, 'total_flos': 177335259076608.0, 'train_loss': 0.006171159259974956, 'epoch': 3.4, 'step': 10}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3458218)[0m {'eval_loss': 0.001953544793650508, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.5834367871284485, 'eval_AP': 0.9370179234369174, 'eval_MCC': 0.0, 'eval_NDCG': 0.9873095596491394, 'eval_kappa': 0.0, 'eval_runtime': 3.4144, 'eval_samples_per_second': 19.623, 'eval_steps_per_second': 1.172, 'epoch': 1.4}[36m(train_hpo pid=3457938)[0m 2025-06-04 19:32:43,065 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3457938)[0m 2025-06-04 19:32:43,071 - INFO - eval_result: {'eval_loss': 0.0027621802873909473, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.7209131121635437, 'eval_AP': 0.8852208359667914, 'eval_MCC': 0.0, 'eval_NDCG': 0.9647986162655942, 'eval_kappa': 0.0, 'eval_runtime': 3.2794, 'eval_samples_per_second': 20.43, 'eval_steps_per_second': 1.22, 'epoch': 3.4}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3457938)[0m 2025-06-04 19:32:43,103 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB[32m [repeated 2x across cluster][0m
2025-06-04 19:32:43,128 - INFO - Cleaning up trial 1a524f2f
2025-06-04 19:32:43,128 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-32-02/train_hpo_1a524f2f_2_alpha=0.9706,gamma=4.6341,learning_rate=0.0001,num_train_epochs=5,weight_decay=0.1230_2025-06-04_19-32-09
2025-06-04 19:32:43,129 - INFO - Current best: 9d97cc5f with eval_f1 : 0.8448275862068966 at iteration 1
2025-06-04 19:32:43,129 - INFO - Current best: 29c3cb91 with eval_f1 : 0.8448275862068966 at iteration 1
2025-06-04 19:32:43,136	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-32-02' in 0.0055s.
2025-06-04 19:32:43,143 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x719b466b4e10>
2025-06-04 19:32:43,143 - INFO - Best trial : train_hpo_9d97cc5f
2025-06-04 19:32:43,144 - INFO - Best config : {'alpha': 0.6252016107931255, 'gamma': 2.6992695521978884, 'learning_rate': 1.8822311491442127e-05, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 4}
2025-06-04 19:32:43,144 - INFO - Best trial after optimization: {'eval_loss': 0.03825495392084122, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.5976898670196533, 'eval_AP': 0.9767396992511144, 'eval_MCC': 0.0, 'eval_NDCG': 0.9957188480430099, 'eval_kappa': 0.0, 'eval_runtime': 3.8957, 'eval_samples_per_second': 17.199, 'eval_steps_per_second': 1.027, 'epoch': 2.8, 'timestamp': 1749058353, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '9d97cc5f', 'date': '2025-06-04_19-32-33', 'time_this_iter_s': 24.228965282440186, 'time_total_s': 24.228965282440186, 'pid': 3457706, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'alpha': 0.6252016107931255, 'gamma': 2.6992695521978884, 'learning_rate': 1.8822311491442127e-05, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 4}, 'time_since_restore': 24.228965282440186, 'iterations_since_restore': 1, 'experiment_tag': '1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364'}
2025-06-04 19:32:43,165 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   0.038255  0.844828  ...                        4  9d97cc5f
1   0.002762  0.844828  ...                        5  1a524f2f
2   0.001954  0.844828  ...                        2  29c3cb91

[3 rows x 33 columns]
2025-06-04 19:32:43,344 - INFO - Trial comparison plot saved
2025-06-04 19:32:43,344 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-04 19:32:43,574 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.25 and gamma=2.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-04 19:32:43,721 - INFO - training size : 198
2025-06-04 19:32:43,724 - INFO - dev size : 67
2025-06-04 19:32:43,724 - INFO - test size : 132
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(

[36m(train_hpo pid=3457938)[0m {'eval_loss': 0.0027621802873909473, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.7209131121635437, 'eval_AP': 0.8852208359667914, 'eval_MCC': 0.0, 'eval_NDCG': 0.9647986162655942, 'eval_kappa': 0.0, 'eval_runtime': 3.2794, 'eval_samples_per_second': 20.43, 'eval_steps_per_second': 1.22, 'epoch': 3.4}
[36m(train_hpo pid=3457938)[0m {'loss': 0.0033, 'grad_norm': 0.045068707317113876, 'learning_rate': 0.0, 'epoch': 3.4}[32m [repeated 2x across cluster][0m

Trial train_hpo_1a524f2f finished iteration 1 at 2025-06-04 19:32:43. Total running time: 40s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_1a524f2f result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    26.5033 â”‚
â”‚ time_total_s                        26.5033 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   3.4 â”‚
â”‚ eval_AP                             0.88522 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                            0.9648 â”‚
â”‚ eval_accuracy                       0.73134 â”‚
â”‚ eval_f1                             0.84483 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           0.00276 â”‚
â”‚ eval_optim_threshold                0.72091 â”‚
â”‚ eval_precision                      0.73134 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.2794 â”‚
â”‚ eval_samples_per_second               20.43 â”‚
â”‚ eval_steps_per_second                  1.22 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_1a524f2f completed after 1 iterations at 2025-06-04 19:32:43. Total running time: 40s

Trial status: 3 TERMINATED
Current time: 2025-06-04 19:32:43. Total running time: 40s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_9d97cc5f   TERMINATED   0.625202   2.69927       1.88223e-05         0.13641                     4        1            24.229     0.038255      0.844828               1          0.731343 â”‚
â”‚ train_hpo_1a524f2f   TERMINATED   0.970578   4.6341        5.16112e-05         0.123031                    5        1            26.5033    0.00276218    0.844828               1          0.731343 â”‚
â”‚ train_hpo_29c3cb91   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            13.1667    0.00195354    0.844828               1          0.731343 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

  0%|          | 0/36 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  3%|â–Ž         | 1/36 [00:00<00:22,  1.53it/s]  6%|â–Œ         | 2/36 [00:01<00:21,  1.59it/s]  8%|â–Š         | 3/36 [00:01<00:20,  1.60it/s] 11%|â–ˆ         | 4/36 [00:02<00:19,  1.61it/s] 14%|â–ˆâ–        | 5/36 [00:03<00:19,  1.62it/s] 17%|â–ˆâ–‹        | 6/36 [00:03<00:18,  1.62it/s] 19%|â–ˆâ–‰        | 7/36 [00:04<00:17,  1.62it/s] 22%|â–ˆâ–ˆâ–       | 8/36 [00:04<00:17,  1.63it/s] 25%|â–ˆâ–ˆâ–Œ       | 9/36 [00:05<00:14,  1.91it/s]                                               25%|â–ˆâ–ˆâ–Œ       | 9/36 [00:05<00:14,  1.91it/s] 28%|â–ˆâ–ˆâ–Š       | 10/36 [00:05<00:14,  1.79it/s] 31%|â–ˆâ–ˆâ–ˆ       | 11/36 [00:06<00:14,  1.73it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 12/36 [00:07<00:14,  1.70it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 13/36 [00:07<00:13,  1.67it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 14/36 [00:08<00:13,  1.66it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 15/36 [00:09<00:12,  1.64it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 16/36 [00:09<00:12,  1.63it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 17/36 [00:10<00:11,  1.64it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 18/36 [00:10<00:09,  1.91it/s]                                                50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 18/36 [00:10<00:09,  1.91it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 19/36 [00:11<00:09,  1.79it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 20/36 [00:11<00:09,  1.74it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 21/36 [00:12<00:08,  1.69it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 22/36 [00:13<00:08,  1.67it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 23/36 [00:13<00:07,  1.65it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 24/36 [00:14<00:07,  1.64it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 25/36 [00:14<00:06,  1.63it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 26/36 [00:15<00:06,  1.64it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 27/36 [00:15<00:04,  1.91it/s]                                                75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 27/36 [00:15<00:04,  1.91it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 28/36 [00:16<00:04,  1.79it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 29/36 [00:17<00:04,  1.73it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 30/36 [00:17<00:03,  1.69it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 31/36 [00:18<00:02,  1.67it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 32/36 [00:18<00:02,  1.66it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 33/36 [00:19<00:01,  1.65it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 34/36 [00:20<00:01,  1.63it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 35/36 [00:20<00:00,  1.64it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [00:21<00:00,  1.91it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [00:23<00:00,  1.91it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [00:23<00:00,  1.91it/s]2025-06-04 19:33:07,580 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [00:23<00:00,  1.55it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
{'loss': 0.0442, 'grad_norm': 1.478029489517212, 'learning_rate': 1.4116733618581595e-05, 'epoch': 1.0}
{'loss': 0.0252, 'grad_norm': 1.0383878946304321, 'learning_rate': 9.411155745721064e-06, 'epoch': 2.0}
{'loss': 0.012, 'grad_norm': 0.4701814651489258, 'learning_rate': 4.705577872860532e-06, 'epoch': 3.0}
{'loss': 0.009, 'grad_norm': 0.6665894389152527, 'learning_rate': 0.0, 'epoch': 4.0}
{'train_runtime': 23.2255, 'train_samples_per_second': 34.1, 'train_steps_per_second': 1.55, 'train_loss': 0.022584756629334554, 'epoch': 4.0}
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.20it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.39it/s]2025-06-04 19:33:11,294 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.14s/it]
2025-06-04 19:33:11,301 - INFO - Training time : 27.95625022985041
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.12it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.02it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.34it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.10it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.31it/s]2025-06-04 19:33:15,972 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.37it/s]
2025-06-04 19:33:15,977 - INFO - Evaluation time : 4.676338734105229
2025-06-04 19:33:15,977 - INFO - Evaluation results on test set: {'eval_loss': 0.008389011025428772, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.5081081986427307, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000004, 'eval_kappa': 1.0, 'eval_runtime': 4.6718, 'eval_samples_per_second': 28.255, 'eval_steps_per_second': 1.284, 'epoch': 4.0}
2025-06-04 19:33:15,977 - INFO - Total updates (optimizer steps): 36
2025-06-04 19:33:15,977 - INFO - Avg time / step: 0.645s
2025-06-04 19:33:16,803 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_focalgoogle-bert/bert-base-uncased3trials_fold-2
2025-06-04 19:33:16,803 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.14it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.02it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.36it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.10it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.32it/s]2025-06-04 19:33:21,399 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.40it/s]
2025-06-04 19:33:21,404 - INFO - preds : [1 1 0 1 0 0 1 1 1 1 1 0 1 0 1 0 0 0 1 1 1 0 1 1 1 1 1 0 1 1 1 0 1 0 1 1 1
 0 1 1 1 0 1 0 1 0 0 1 1 1 1 1 0 1 1 1 1 1 0 1 0 1 1 0 1 1 1 1 0 1 1 1 0 1
 1 1 1 1 0 1 1 0 0 1 0 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 0 1 0 1 1 1 0 1 1 1 1
 1 1 1 1 1 0 1 1 1 1 1 0 1 1 1 1 1 1 0 1 1]
2025-06-04 19:33:21,405 - INFO - test_split["labels"] : [1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1]
2025-06-04 19:33:21,406 - INFO - Confusion matrix: TN=34, FP=0, FN=0, TP=98
2025-06-04 19:33:24,314 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 34, 'FP': 0, 'FN': 0, 'TP': 98}
2025-06-04 19:33:24,429 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-04 19:33:24,522 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:33:24,522 - INFO - 
On test Set (optimal threshold of 0.4828525483608246 according to cross validation on the training set): 
2025-06-04 19:33:24,524 - INFO - Confusion matrix: TN=34, FP=0, FN=0, TP=98
2025-06-04 19:33:27,238 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 34, 'FP': 0, 'FN': 0, 'TP': 98}
2025-06-04 19:33:27,333 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:33:27,333 - INFO - Results for fold 2 : [{'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 34, 'FP': 0, 'FN': 0, 'TP': 98}]
2025-06-04 19:33:27,439 - INFO - Cleared CUDA cache. Memory allocated: 1.41 GB, Memory reserved: 1.82 GB
2025-06-04 19:33:27,439 - INFO - 
fold number 3 / 3
2025-06-04 19:33:27,445 - INFO - train split size : 198
2025-06-04 19:33:27,445 - INFO - dev split size : 67
2025-06-04 19:33:27,445 - INFO - test split size : 132
Map (num_proc=32):   0%|          | 0/198 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–Ž         | 7/198 [00:00<00:05, 32.67 examples/s]Map (num_proc=32):  21%|â–ˆâ–ˆ        | 42/198 [00:00<00:01, 149.95 examples/s]Map (num_proc=32):  36%|â–ˆâ–ˆâ–ˆâ–‹      | 72/198 [00:00<00:00, 196.84 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 102/198 [00:00<00:00, 218.44 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 132/198 [00:00<00:00, 234.66 examples/s]Map (num_proc=32):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 162/198 [00:00<00:00, 247.68 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 192/198 [00:00<00:00, 252.75 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 198/198 [00:01<00:00, 189.32 examples/s]
Map (num_proc=32):   0%|          | 0/67 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/67 [00:00<00:03, 16.58 examples/s]Map (num_proc=32):  25%|â–ˆâ–ˆâ–Œ       | 17/67 [00:00<00:00, 67.64 examples/s]Map (num_proc=32):  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 29/67 [00:00<00:00, 82.88 examples/s]Map (num_proc=32):  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 41/67 [00:00<00:00, 93.68 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 53/67 [00:00<00:00, 95.12 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 65/67 [00:00<00:00, 98.99 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:00<00:00, 75.27 examples/s]
Map (num_proc=32):   0%|          | 0/132 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/132 [00:00<00:04, 26.79 examples/s]Map (num_proc=32):  24%|â–ˆâ–ˆâ–       | 32/132 [00:00<00:00, 121.93 examples/s]Map (num_proc=32):  39%|â–ˆâ–ˆâ–ˆâ–‰      | 52/132 [00:00<00:00, 149.96 examples/s]Map (num_proc=32):  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 72/132 [00:00<00:00, 163.70 examples/s]Map (num_proc=32):  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 96/132 [00:00<00:00, 179.50 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 120/132 [00:00<00:00, 184.49 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 132/132 [00:00<00:00, 145.42 examples/s]
2025-06-04 19:33:37,049 - INFO - 3 datasets tokenized successfully
2025-06-04 19:33:37,052 - INFO - Starting hyperparameter search for focal loss
[36m(train_hpo pid=3460286)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3460286)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3460286)[0m 2025-06-04 19:33:44,621 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.6252016107931255 and gamma=2.6992695521978884
[36m(train_hpo pid=3460286)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3460286)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3460286)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3460286)[0m   warnings.warn(
[36m(train_hpo pid=3460447)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3460447)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3460447)[0m 2025-06-04 19:33:51,455 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.970577641092792 and gamma=4.634102840173219
[36m(train_hpo pid=3460447)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3460447)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3460447)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3460447)[0m   warnings.warn(
[36m(train_hpo pid=3460798)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3460798)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3460798)[0m 2025-06-04 19:33:58,334 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.7811204413478371 and gamma=6.807074484302038
[36m(train_hpo pid=3460798)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3460798)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3460798)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3460798)[0m   warnings.warn(
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-04_19-33-37   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-33-37
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-04_18-54-36_274448_3393636/artifacts/2025-06-04_19-33-37/train_hpo_2025-06-04_19-33-37/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-04 19:33:37. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_9c179927   PENDING    0.625202   2.69927       1.88223e-05          0.13641                    4 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_9c179927 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_9c179927 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                                0.6252 â”‚
â”‚ gamma                               2.69927 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          4 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3460286)[0m [2025-06-04 19:33:44,875] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3460286)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=8, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_e7010cec started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_e7010cec config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.97058 â”‚
â”‚ gamma                                4.6341 â”‚
â”‚ learning_rate                         5e-05 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3460447)[0m [2025-06-04 19:33:51,827] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3460286)[0m {'loss': 0.0399, 'grad_norm': 0.18209342658519745, 'learning_rate': 1.176394468215133e-05, 'epoch': 1.0}
[36m(train_hpo pid=3460447)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3460286)[0m {'loss': 0.0372, 'grad_norm': 0.3931044638156891, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.0}

Trial train_hpo_a2149ad4 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_a2149ad4 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.78112 â”‚
â”‚ gamma                               6.80707 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          2 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3460798)[0m [2025-06-04 19:33:58,577] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3460798)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=4, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3460447)[0m {'loss': 0.0522, 'grad_norm': 0.07616197317838669, 'learning_rate': 3.612785445936571e-05, 'epoch': 1.0}
[36m(train_hpo pid=3460286)[0m {'train_runtime': 16.3098, 'train_samples_per_second': 48.56, 'train_steps_per_second': 0.491, 'train_loss': 0.03960350714623928, 'epoch': 2.8}
[36m(train_hpo pid=3460286)[0m STATE at ending of training  :  TrainerState(epoch=2.8, global_step=8, max_steps=8, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=146288433303552.0, log_history=[{'loss': 0.0399, 'grad_norm': 0.18209342658519745, 'learning_rate': 1.176394468215133e-05, 'epoch': 1.0, 'step': 3}, {'loss': 0.0372, 'grad_norm': 0.3931044638156891, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.0, 'step': 6}, {'loss': 0.0429, 'grad_norm': 0.2330760657787323, 'learning_rate': 0.0, 'epoch': 2.8, 'step': 8}, {'train_runtime': 16.3098, 'train_samples_per_second': 48.56, 'train_steps_per_second': 0.491, 'total_flos': 146288433303552.0, 'train_loss': 0.03960350714623928, 'epoch': 2.8, 'step': 8}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})[36m(train_hpo pid=3460286)[0m 2025-06-04 19:34:08,384 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3460286)[0m 2025-06-04 19:34:08,392 - INFO - eval_result: {'eval_loss': 0.040316324681043625, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.6073570847511292, 'eval_AP': 0.9682540000740423, 'eval_MCC': 0.0, 'eval_NDCG': 0.9939969308286554, 'eval_kappa': 0.0, 'eval_runtime': 3.906, 'eval_samples_per_second': 17.153, 'eval_steps_per_second': 1.024, 'epoch': 2.8}
[36m(train_hpo pid=3460286)[0m 2025-06-04 19:34:08,430 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
2025-06-04 19:34:08,460 - INFO - Cleaning up trial 9c179927
2025-06-04 19:34:08,461 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-33-37/train_hpo_9c179927_1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364_2025-06-04_19-33-37
2025-06-04 19:34:11,139 - INFO - Cleaning up trial a2149ad4
2025-06-04 19:34:11,140 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-33-37/train_hpo_a2149ad4_3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512_2025-06-04_19-33-51
2025-06-04 19:34:11,140 - INFO - Current best: 9c179927 with eval_f1 : 0.8547008547008547 at iteration 1


Trial status: 3 RUNNING
Current time: 2025-06-04 19:34:07. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_9c179927   RUNNING    0.625202   2.69927       1.88223e-05         0.13641                     4 â”‚
â”‚ train_hpo_e7010cec   RUNNING    0.970578   4.6341        5.16112e-05         0.123031                    5 â”‚
â”‚ train_hpo_a2149ad4   RUNNING    0.78112    6.80707       1.88581e-05         0.251217                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3460798)[0m STATE at ending of training  :  TrainerState(epoch=1.4, global_step=4, max_steps=4, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=73144216651776.0, log_history=[{'loss': 0.002, 'grad_norm': 0.025307781994342804, 'learning_rate': 4.714527732738613e-06, 'epoch': 1.0, 'step': 3}, {'loss': 0.002, 'grad_norm': 0.015528147108852863, 'learning_rate': 0.0, 'epoch': 1.4, 'step': 4}, {'train_runtime': 5.806, 'train_samples_per_second': 68.205, 'train_steps_per_second': 0.689, 'total_flos': 73144216651776.0, 'train_loss': 0.002042067877482623, 'epoch': 1.4, 'step': 4}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3460286)[0m {'eval_loss': 0.040316324681043625, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.6073570847511292, 'eval_AP': 0.9682540000740423, 'eval_MCC': 0.0, 'eval_NDCG': 0.9939969308286554, 'eval_kappa': 0.0, 'eval_runtime': 3.906, 'eval_samples_per_second': 17.153, 'eval_steps_per_second': 1.024, 'epoch': 2.8}

Trial train_hpo_9c179927 finished iteration 1 at 2025-06-04 19:34:08. Total running time: 31s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_9c179927 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    24.2893 â”‚
â”‚ time_total_s                        24.2893 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   2.8 â”‚
â”‚ eval_AP                             0.96825 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                             0.994 â”‚
â”‚ eval_accuracy                       0.74627 â”‚
â”‚ eval_f1                              0.8547 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           0.04032 â”‚
â”‚ eval_optim_threshold                0.60736 â”‚
â”‚ eval_precision                      0.74627 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                          3.906 â”‚
â”‚ eval_samples_per_second              17.153 â”‚
â”‚ eval_steps_per_second                 1.024 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_9c179927 completed after 1 iterations at 2025-06-04 19:34:08. Total running time: 31s

Trial train_hpo_a2149ad4 finished iteration 1 at 2025-06-04 19:34:11. Total running time: 33s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_a2149ad4 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    13.2229 â”‚
â”‚ time_total_s                        13.2229 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   1.4 â”‚
â”‚ eval_AP                              0.9787 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.99604 â”‚
â”‚ eval_accuracy                       0.74627 â”‚
â”‚ eval_f1                              0.8547 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           0.00182 â”‚
â”‚ eval_optim_threshold                0.57604 â”‚
â”‚ eval_precision                      0.74627 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.4411 â”‚
â”‚ eval_samples_per_second              19.471 â”‚
â”‚ eval_steps_per_second                 1.162 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_a2149ad4 completed after 1 iterations at 2025-06-04 19:34:11. Total running time: 33s
[36m(train_hpo pid=3460447)[0m {'loss': 0.0025, 'grad_norm': 0.07134353369474411, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.0}[32m [repeated 4x across cluster][0m
[36m(train_hpo pid=3460798)[0m {'train_runtime': 5.806, 'train_samples_per_second': 68.205, 'train_steps_per_second': 0.689, 'train_loss': 0.002042067877482623, 'epoch': 1.4}
[36m(train_hpo pid=3460447)[0m {'train_runtime': 19.1618, 'train_samples_per_second': 51.665, 'train_steps_per_second': 0.522, 'train_loss': 0.017218751041218637, 'epoch': 3.4}
[36m(train_hpo pid=3460447)[0m STATE at ending of training  :  TrainerState(epoch=3.4, global_step=10, max_steps=10, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=177335259076608.0, log_history=[{'loss': 0.0522, 'grad_norm': 0.07616197317838669, 'learning_rate': 3.612785445936571e-05, 'epoch': 1.0, 'step': 3}, {'loss': 0.0025, 'grad_norm': 0.07134353369474411, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.0, 'step': 6}, {'loss': 0.0021, 'grad_norm': 0.055197082459926605, 'learning_rate': 5.161122065623674e-06, 'epoch': 3.0, 'step': 9}, {'loss': 0.0018, 'grad_norm': 0.07665219902992249, 'learning_rate': 0.0, 'epoch': 3.4, 'step': 10}, {'train_runtime': 19.1618, 'train_samples_per_second': 51.665, 'train_steps_per_second': 0.522, 'total_flos': 177335259076608.0, 'train_loss': 0.017218751041218637, 'epoch': 3.4, 'step': 10}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3460798)[0m {'eval_loss': 0.0018214917508885264, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.5760396122932434, 'eval_AP': 0.9786982183901607, 'eval_MCC': 0.0, 'eval_NDCG': 0.9960350847310917, 'eval_kappa': 0.0, 'eval_runtime': 3.4411, 'eval_samples_per_second': 19.471, 'eval_steps_per_second': 1.162, 'epoch': 1.4}[36m(train_hpo pid=3460447)[0m 2025-06-04 19:34:17,732 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3460447)[0m 2025-06-04 19:34:17,739 - INFO - eval_result: {'eval_loss': 0.0015506206545978785, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.6925855278968811, 'eval_AP': 1.0, 'eval_MCC': 0.0, 'eval_NDCG': 1.0, 'eval_kappa': 0.0, 'eval_runtime': 3.5002, 'eval_samples_per_second': 19.141, 'eval_steps_per_second': 1.143, 'epoch': 3.4}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3460447)[0m 2025-06-04 19:34:17,773 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB[32m [repeated 2x across cluster][0m
2025-06-04 19:34:17,805 - INFO - Cleaning up trial e7010cec
2025-06-04 19:34:17,805 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-33-37/train_hpo_e7010cec_2_alpha=0.9706,gamma=4.6341,learning_rate=0.0001,num_train_epochs=5,weight_decay=0.1230_2025-06-04_19-33-44
2025-06-04 19:34:17,805 - INFO - Current best: 9c179927 with eval_f1 : 0.8547008547008547 at iteration 1
2025-06-04 19:34:17,805 - INFO - Current best: a2149ad4 with eval_f1 : 0.8547008547008547 at iteration 1
2025-06-04 19:34:17,812	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-04_19-33-37' in 0.0055s.
2025-06-04 19:34:17,828 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x719abc377b50>
2025-06-04 19:34:17,828 - INFO - Best trial : train_hpo_9c179927
2025-06-04 19:34:17,828 - INFO - Best config : {'alpha': 0.6252016107931255, 'gamma': 2.6992695521978884, 'learning_rate': 1.8822311491442127e-05, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 4}
2025-06-04 19:34:17,828 - INFO - Best trial after optimization: {'eval_loss': 0.040316324681043625, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.6073570847511292, 'eval_AP': 0.9682540000740423, 'eval_MCC': 0.0, 'eval_NDCG': 0.9939969308286554, 'eval_kappa': 0.0, 'eval_runtime': 3.906, 'eval_samples_per_second': 17.153, 'eval_steps_per_second': 1.024, 'epoch': 2.8, 'timestamp': 1749058448, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '9c179927', 'date': '2025-06-04_19-34-08', 'time_this_iter_s': 24.289278745651245, 'time_total_s': 24.289278745651245, 'pid': 3460286, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'alpha': 0.6252016107931255, 'gamma': 2.6992695521978884, 'learning_rate': 1.8822311491442127e-05, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 4}, 'time_since_restore': 24.289278745651245, 'iterations_since_restore': 1, 'experiment_tag': '1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364'}
2025-06-04 19:34:17,855 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   0.040316  0.854701  ...                        4  9c179927
1   0.001551  0.854701  ...                        5  e7010cec
2   0.001821  0.854701  ...                        2  a2149ad4

[3 rows x 33 columns]
2025-06-04 19:34:18,036 - INFO - Trial comparison plot saved
2025-06-04 19:34:18,037 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-04 19:34:18,268 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.25 and gamma=2.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-04 19:34:18,419 - INFO - training size : 198
2025-06-04 19:34:18,420 - INFO - dev size : 67
2025-06-04 19:34:18,420 - INFO - test size : 132
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(


Trial train_hpo_e7010cec finished iteration 1 at 2025-06-04 19:34:17. Total running time: 40s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_e7010cec result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    26.7737 â”‚
â”‚ time_total_s                        26.7737 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                   3.4 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                       0.74627 â”‚
â”‚ eval_f1                              0.8547 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           0.00155 â”‚
â”‚ eval_optim_threshold                0.69259 â”‚
â”‚ eval_precision                      0.74627 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.5002 â”‚
â”‚ eval_samples_per_second              19.141 â”‚
â”‚ eval_steps_per_second                 1.143 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3460447)[0m {'eval_loss': 0.0015506206545978785, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.6925855278968811, 'eval_AP': 1.0, 'eval_MCC': 0.0, 'eval_NDCG': 1.0, 'eval_kappa': 0.0, 'eval_runtime': 3.5002, 'eval_samples_per_second': 19.141, 'eval_steps_per_second': 1.143, 'epoch': 3.4}
[36m(train_hpo pid=3460447)[0m {'loss': 0.0018, 'grad_norm': 0.07665219902992249, 'learning_rate': 0.0, 'epoch': 3.4}[32m [repeated 2x across cluster][0m

Trial train_hpo_e7010cec completed after 1 iterations at 2025-06-04 19:34:17. Total running time: 40s

Trial status: 3 TERMINATED
Current time: 2025-06-04 19:34:17. Total running time: 40s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_9c179927   TERMINATED   0.625202   2.69927       1.88223e-05         0.13641                     4        1            24.2893    0.0403163     0.854701               1          0.746269 â”‚
â”‚ train_hpo_e7010cec   TERMINATED   0.970578   4.6341        5.16112e-05         0.123031                    5        1            26.7738    0.00155062    0.854701               1          0.746269 â”‚
â”‚ train_hpo_a2149ad4   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            13.2229    0.00182149    0.854701               1          0.746269 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

  0%|          | 0/36 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  3%|â–Ž         | 1/36 [00:00<00:22,  1.53it/s]  6%|â–Œ         | 2/36 [00:01<00:21,  1.59it/s]  8%|â–Š         | 3/36 [00:01<00:20,  1.60it/s] 11%|â–ˆ         | 4/36 [00:02<00:19,  1.61it/s] 14%|â–ˆâ–        | 5/36 [00:03<00:19,  1.62it/s] 17%|â–ˆâ–‹        | 6/36 [00:03<00:18,  1.62it/s] 19%|â–ˆâ–‰        | 7/36 [00:04<00:17,  1.62it/s] 22%|â–ˆâ–ˆâ–       | 8/36 [00:04<00:17,  1.63it/s] 25%|â–ˆâ–ˆâ–Œ       | 9/36 [00:05<00:14,  1.91it/s]                                               25%|â–ˆâ–ˆâ–Œ       | 9/36 [00:05<00:14,  1.91it/s] 28%|â–ˆâ–ˆâ–Š       | 10/36 [00:05<00:14,  1.79it/s] 31%|â–ˆâ–ˆâ–ˆ       | 11/36 [00:06<00:14,  1.73it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 12/36 [00:07<00:14,  1.70it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 13/36 [00:07<00:13,  1.67it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 14/36 [00:08<00:13,  1.66it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 15/36 [00:08<00:12,  1.65it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 16/36 [00:09<00:12,  1.64it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 17/36 [00:10<00:11,  1.64it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 18/36 [00:10<00:09,  1.91it/s]                                                50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 18/36 [00:10<00:09,  1.91it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 19/36 [00:11<00:09,  1.79it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 20/36 [00:11<00:09,  1.74it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 21/36 [00:12<00:08,  1.70it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 22/36 [00:13<00:08,  1.68it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 23/36 [00:13<00:07,  1.64it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 24/36 [00:14<00:07,  1.64it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 25/36 [00:14<00:06,  1.63it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 26/36 [00:15<00:06,  1.64it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 27/36 [00:15<00:04,  1.91it/s]                                                75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 27/36 [00:15<00:04,  1.91it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 28/36 [00:16<00:04,  1.79it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 29/36 [00:17<00:04,  1.73it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 30/36 [00:17<00:03,  1.69it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 31/36 [00:18<00:02,  1.67it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 32/36 [00:18<00:02,  1.65it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 33/36 [00:19<00:01,  1.64it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 34/36 [00:20<00:01,  1.63it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 35/36 [00:20<00:00,  1.64it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [00:21<00:00,  1.91it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [00:22<00:00,  1.91it/s]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [00:22<00:00,  1.91it/s]2025-06-04 19:34:42,014 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [00:22<00:00,  1.57it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
{'loss': 0.0437, 'grad_norm': 1.2823944091796875, 'learning_rate': 1.4116733618581595e-05, 'epoch': 1.0}
{'loss': 0.0275, 'grad_norm': 0.9487777352333069, 'learning_rate': 9.411155745721064e-06, 'epoch': 2.0}
{'loss': 0.0126, 'grad_norm': 1.03128981590271, 'learning_rate': 4.705577872860532e-06, 'epoch': 3.0}
{'loss': 0.008, 'grad_norm': 0.6308157444000244, 'learning_rate': 0.0, 'epoch': 4.0}
{'train_runtime': 22.9884, 'train_samples_per_second': 34.452, 'train_steps_per_second': 1.566, 'train_loss': 0.022946497632397547, 'epoch': 4.0}
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  6.88it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.28it/s]2025-06-04 19:34:45,914 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.20s/it]
2025-06-04 19:34:45,920 - INFO - Training time : 27.883536112960428
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.02it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  4.94it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.33it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.08it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.31it/s]2025-06-04 19:34:50,600 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.37it/s]
2025-06-04 19:34:50,607 - INFO - Evaluation time : 4.686321018030867
2025-06-04 19:34:50,607 - INFO - Evaluation results on test set: {'eval_loss': 0.009066847153007984, 'eval_f1': 0.9846153846153847, 'eval_recall': 0.9896907216494846, 'eval_accuracy': 0.9772727272727273, 'eval_precision': 0.9795918367346939, 'eval_optim_threshold': 0.6951042413711548, 'eval_AP': 0.9995813383147697, 'eval_MCC': 0.9413226848786879, 'eval_NDCG': 0.9999347802522394, 'eval_kappa': 0.941141498216409, 'eval_runtime': 4.6819, 'eval_samples_per_second': 28.194, 'eval_steps_per_second': 1.282, 'epoch': 4.0}
2025-06-04 19:34:50,607 - INFO - Total updates (optimizer steps): 36
2025-06-04 19:34:50,607 - INFO - Avg time / step: 0.639s
2025-06-04 19:34:51,529 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_focalgoogle-bert/bert-base-uncased3trials_fold-3
2025-06-04 19:34:51,529 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.13it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.03it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.36it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.10it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.32it/s]2025-06-04 19:34:56,496 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.29it/s]
2025-06-04 19:34:56,503 - INFO - preds : [1 1 1 1 1 0 1 1 1 0 1 1 0 0 0 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 0 0 1 0 0 1
 1 0 1 1 1 1 0 1 1 0 1 1 1 0 1 0 1 0 1 1 1 1 0 1 1 1 1 1 0 1 0 1 1 1 1 0 1
 1 1 1 1 1 1 0 1 1 1 1 1 0 1 1 0 1 1 1 1 0 1 1 1 1 1 1 0 0 1 1 0 1 1 1 1 0
 0 1 1 1 1 0 1 1 0 0 1 1 1 1 0 1 1 0 1 1 1]
2025-06-04 19:34:56,504 - INFO - test_split["labels"] : [1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1]
2025-06-04 19:34:56,505 - INFO - Confusion matrix: TN=33, FP=2, FN=1, TP=96
2025-06-04 19:35:00,044 - INFO - Metrics: {'f1': 0.9846153846153847, 'recall': 0.9896907216494846, 'precision': 0.9795918367346939, 'accuracy': 0.9772727272727273, 'AP': 0.9995813383147697, 'MCC': 0.9413226848786879, 'NDCG': 0.9999347802522394, 'kappa': 0.941141498216409, 'TN': 33, 'FP': 2, 'FN': 1, 'TP': 96}
2025-06-04 19:35:00,165 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-04 19:35:00,265 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:35:00,265 - INFO - 
On test Set (optimal threshold of 0.6618947386741638 according to cross validation on the training set): 
2025-06-04 19:35:00,267 - INFO - Confusion matrix: TN=34, FP=1, FN=2, TP=95
2025-06-04 19:35:03,085 - INFO - Metrics: {'f1': 0.9844559585492227, 'recall': 0.979381443298969, 'precision': 0.9895833333333334, 'accuracy': 0.9772727272727273, 'AP': 0.9995813383147697, 'MCC': 0.9423815390513658, 'NDCG': 0.9999347802522394, 'kappa': 0.9422066549912435, 'TN': 34, 'FP': 1, 'FN': 2, 'TP': 95}
2025-06-04 19:35:03,183 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-04 19:35:03,183 - INFO - Results for fold 3 : [{'f1': 0.9844559585492227, 'recall': 0.979381443298969, 'precision': 0.9895833333333334, 'accuracy': 0.9772727272727273, 'AP': 0.9995813383147697, 'MCC': 0.9423815390513658, 'NDCG': 0.9999347802522394, 'kappa': 0.9422066549912435, 'TN': 34, 'FP': 1, 'FN': 2, 'TP': 95}]
2025-06-04 19:35:03,294 - INFO - Cleared CUDA cache. Memory allocated: 1.42 GB, Memory reserved: 1.76 GB
2025-06-04 19:35:03,295 - INFO - Cleared CUDA cache. Memory allocated: 1.42 GB, Memory reserved: 1.76 GB
2025-06-04 19:35:03,344 - INFO - Cleared CUDA cache. Memory allocated: 0.02 GB, Memory reserved: 0.03 GB
2025-06-04 19:35:03,362 - INFO - Metrics for google-bert/bert-base-uncased:                        model_name fold loss_type run  ...    TN    FP   FN    TP
21  google-bert/bert-base-uncased    1     focal   1  ...  34.0   1.0  0.0  98.0
22  google-bert/bert-base-uncased    2     focal   1  ...  34.0   0.0  0.0  98.0
23  google-bert/bert-base-uncased    3     focal   1  ...   0.0  35.0  0.0  97.0
0   google-bert/bert-base-uncased    1     focal   2  ...  34.0   1.0  0.0  98.0
0   google-bert/bert-base-uncased    2     focal   2  ...  34.0   0.0  0.0  98.0
0   google-bert/bert-base-uncased    3     focal   2  ...  33.0   2.0  1.0  96.0

[6 rows x 18 columns]
2025-06-04 19:35:03,362 - INFO - 
fold number 1 / 3
2025-06-04 19:35:03,370 - INFO - Confusion matrix: TN=34, FP=1, FN=0, TP=98
2025-06-04 19:35:06,164 - INFO - Metrics: {'f1': 0.9949238578680203, 'recall': 1.0, 'precision': 0.98989898989899, 'accuracy': 0.9924812030075187, 'AP': 1.0, 'MCC': 0.9806202943118002, 'NDCG': 1.0000000000000004, 'kappa': 0.98043254376931, 'TN': 34, 'FP': 1, 'FN': 0, 'TP': 98}
2025-06-04 19:35:06,167 - INFO - 
fold number 2 / 3
2025-06-04 19:35:06,172 - INFO - Confusion matrix: TN=34, FP=0, FN=0, TP=98
2025-06-04 19:35:09,083 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 34, 'FP': 0, 'FN': 0, 'TP': 98}
2025-06-04 19:35:09,084 - INFO - 
fold number 3 / 3
2025-06-04 19:35:09,089 - INFO - Confusion matrix: TN=33, FP=2, FN=1, TP=96
2025-06-04 19:35:12,004 - INFO - Metrics: {'f1': 0.9846153846153847, 'recall': 0.9896907216494846, 'precision': 0.9795918367346939, 'accuracy': 0.9772727272727273, 'AP': 0.9995917117484943, 'MCC': 0.9413226848786879, 'NDCG': 0.9999361711546718, 'kappa': 0.941141498216409, 'TN': 33, 'FP': 2, 'FN': 1, 'TP': 96}
2025-06-04 19:35:12,011 - INFO - fold indexes for run no.1: [[159, 206, 117, 82, 317, 330, 131, 380, 183, 158, 213, 260, 155, 332, 303, 269, 40, 232, 314, 244, 168, 218, 254, 100, 3, 235, 105, 243, 352, 394, 196, 223, 230, 307, 342, 289, 135, 7, 189, 134, 78, 133, 12, 375, 109, 46, 62, 393, 167, 151, 387, 374, 276, 323, 132, 319, 114, 176, 322, 263, 258, 266, 250, 329, 309, 367, 24, 229, 370, 211, 228, 346, 115, 392, 87, 88, 81, 343, 253, 278, 43, 333, 28, 80, 191, 10, 378, 388, 225, 363, 136, 104, 356, 8, 57, 162, 220, 391, 139, 386, 282, 70, 61, 170, 102, 296, 64, 35, 4, 251, 279, 44, 373, 129, 236, 327, 187, 68, 245, 215, 18, 42, 116, 212, 376, 148, 126, 27, 252, 173, 103, 336, 209, 199, 169, 283, 32, 246, 292, 210, 247, 141, 73, 194, 59, 385, 354, 51, 305, 200, 344, 179, 178, 355, 313, 112, 291, 23, 328, 130, 315, 181, 138, 94, 95, 121, 207, 175, 295, 321, 34, 300, 262, 33, 341, 54, 299, 48, 30, 204, 123, 331, 301, 150, 157, 265, 14, 53, 396, 242, 377, 366, 93, 214, 83, 52, 6, 188], [177, 268, 97, 248, 298, 320, 224, 137, 161, 145, 339, 98, 39, 66, 17, 325, 226, 91, 348, 67, 55, 237, 273, 353, 381, 261, 31, 2, 290, 107, 38, 113, 120, 1, 222, 84, 358, 202, 63, 337, 92, 99, 144, 256, 19, 171, 219, 285, 274, 174, 118, 233, 156, 324, 284, 190, 255, 357, 205, 111, 72, 384, 294, 71, 163, 217], array([  0,   5,   9,  11,  13,  15,  16,  20,  21,  22,  25,  26,  29,
        36,  37,  41,  45,  47,  49,  50,  56,  58,  60,  65,  69,  74,
        75,  76,  77,  79,  85,  86,  89,  90,  96, 101, 106, 108, 110,
       119, 122, 124, 125, 127, 128, 140, 142, 143, 146, 147, 149, 152,
       153, 154, 160, 164, 165, 166, 172, 180, 182, 184, 185, 186, 192,
       193, 195, 197, 198, 201, 203, 208, 216, 221, 227, 231, 234, 238,
       239, 240, 241, 249, 257, 259, 264, 267, 270, 271, 272, 275, 277,
       280, 281, 286, 287, 288, 293, 297, 302, 304, 306, 308, 310, 311,
       312, 316, 318, 326, 334, 335, 338, 340, 345, 347, 349, 350, 351,
       359, 360, 361, 362, 364, 365, 368, 369, 371, 372, 379, 382, 383,
       389, 390, 395])]
2025-06-04 19:35:12,011 - INFO - Run no 1/2
2025-06-04 19:35:12,011 - INFO - Kernel : linear
2025-06-04 19:35:12,011 - INFO - 
fold number 1 / 3
2025-06-04 19:35:12,017 - INFO - train split size : 198
2025-06-04 19:35:12,017 - INFO - dev split size : 66
2025-06-04 19:35:12,017 - INFO - test split size : 133
2025-06-04 19:35:12,232 - INFO - X shape : (198, 10000)
2025-06-04 19:35:12,233 - INFO - y shape : (198,)
2025-06-04 19:35:12,655 - INFO - Confusion matrix: TN=5, FP=30, FN=0, TP=98
2025-06-04 19:35:15,430 - INFO - Metrics: {'f1': 0.8672566371681416, 'recall': 1.0, 'precision': 0.765625, 'accuracy': 0.7744360902255639, 'AP': {}, 'MCC': 0.3307189138830738, 'NDCG': {}, 'kappa': 0.19718309859154926, 'TN': 5, 'FP': 30, 'FN': 0, 'TP': 98}
2025-06-04 19:35:15,430 - INFO - Concatenating...
2025-06-04 19:35:15,433 - INFO - 
fold number 2 / 3
2025-06-04 19:35:15,438 - INFO - train split size : 198
2025-06-04 19:35:15,438 - INFO - dev split size : 67
2025-06-04 19:35:15,438 - INFO - test split size : 132
2025-06-04 19:35:15,630 - INFO - X shape : (198, 10000)
2025-06-04 19:35:15,630 - INFO - y shape : (198,)
2025-06-04 19:35:16,046 - INFO - Confusion matrix: TN=7, FP=27, FN=1, TP=97
2025-06-04 19:35:18,830 - INFO - Metrics: {'f1': 0.8738738738738738, 'recall': 0.9897959183673469, 'precision': 0.782258064516129, 'accuracy': 0.7878787878787878, 'AP': {}, 'MCC': 0.3586239281867596, 'NDCG': {}, 'kappa': 0.2607999999999999, 'TN': 7, 'FP': 27, 'FN': 1, 'TP': 97}
2025-06-04 19:35:18,830 - INFO - Concatenating...
2025-06-04 19:35:18,833 - INFO - 
fold number 3 / 3
2025-06-04 19:35:18,838 - INFO - train split size : 198
2025-06-04 19:35:18,838 - INFO - dev split size : 67
2025-06-04 19:35:18,838 - INFO - test split size : 132
2025-06-04 19:35:19,044 - INFO - X shape : (198, 10000)
2025-06-04 19:35:19,044 - INFO - y shape : (198,)
2025-06-04 19:35:19,478 - INFO - Confusion matrix: TN=5, FP=30, FN=0, TP=97
2025-06-04 19:35:22,352 - INFO - Metrics: {'f1': 0.8660714285714286, 'recall': 1.0, 'precision': 0.7637795275590551, 'accuracy': 0.7727272727272727, 'AP': {}, 'MCC': 0.3303200888227433, 'NDCG': {}, 'kappa': 0.19675456389452328, 'TN': 5, 'FP': 30, 'FN': 0, 'TP': 97}
2025-06-04 19:35:22,353 - INFO - Concatenating...
2025-06-04 19:35:22,358 - INFO - fold indexes for run no.2: [[284, 266, 388, 393, 133, 13, 20, 176, 269, 308, 45, 193, 147, 19, 168, 230, 151, 384, 157, 153, 149, 327, 321, 381, 385, 330, 199, 72, 142, 10, 47, 270, 377, 73, 0, 118, 184, 65, 343, 219, 86, 357, 201, 226, 264, 223, 33, 114, 67, 268, 182, 310, 53, 246, 145, 76, 320, 373, 280, 95, 254, 113, 154, 160, 228, 306, 325, 99, 355, 356, 125, 166, 346, 286, 102, 354, 92, 336, 81, 159, 52, 304, 323, 111, 96, 274, 236, 41, 91, 32, 90, 367, 179, 130, 74, 334, 378, 208, 77, 396, 361, 6, 332, 238, 222, 277, 365, 36, 256, 21, 260, 38, 234, 341, 173, 124, 183, 31, 202, 203, 196, 119, 150, 263, 105, 126, 48, 143, 289, 231, 324, 352, 186, 155, 292, 217, 198, 316, 109, 287, 44, 49, 82, 15, 309, 83, 135, 218, 305, 283, 122, 127, 290, 35, 85, 98, 271, 141, 167, 295, 93, 27, 262, 229, 273, 9, 370, 89, 129, 197, 164, 205, 347, 171, 178, 70, 140, 372, 100, 314, 69, 4, 301, 265, 244, 101, 248, 358, 364, 94, 296, 87, 307, 239, 192, 50, 169, 39], [326, 210, 250, 319, 380, 279, 293, 288, 220, 253, 162, 43, 152, 8, 221, 235, 297, 339, 331, 61, 106, 181, 329, 243, 375, 88, 257, 194, 117, 104, 55, 349, 14, 108, 62, 281, 282, 2, 63, 240, 351, 107, 97, 187, 215, 54, 80, 232, 318, 241, 303, 252, 29, 139, 247, 362, 51, 390, 285, 392, 174, 298, 5, 335, 294, 28], array([  1,   3,   7,  11,  12,  16,  17,  18,  22,  23,  24,  25,  26,
        30,  34,  37,  40,  42,  46,  56,  57,  58,  59,  60,  64,  66,
        68,  71,  75,  78,  79,  84, 103, 110, 112, 115, 116, 120, 121,
       123, 128, 131, 132, 134, 136, 137, 138, 144, 146, 148, 156, 158,
       161, 163, 165, 170, 172, 175, 177, 180, 185, 188, 189, 190, 191,
       195, 200, 204, 206, 207, 209, 211, 212, 213, 214, 216, 224, 225,
       227, 233, 237, 242, 245, 249, 251, 255, 258, 259, 261, 267, 272,
       275, 276, 278, 291, 299, 300, 302, 311, 312, 313, 315, 317, 322,
       328, 333, 337, 338, 340, 342, 344, 345, 348, 350, 353, 359, 360,
       363, 366, 368, 369, 371, 374, 376, 379, 382, 383, 386, 387, 389,
       391, 394, 395])]
2025-06-04 19:35:22,358 - INFO - Run no 2/2
2025-06-04 19:35:22,358 - INFO - Kernel : linear
2025-06-04 19:35:22,358 - INFO - 
fold number 1 / 3
2025-06-04 19:35:22,364 - INFO - train split size : 198
2025-06-04 19:35:22,364 - INFO - dev split size : 66
2025-06-04 19:35:22,364 - INFO - test split size : 133
2025-06-04 19:35:22,573 - INFO - X shape : (198, 10000)
2025-06-04 19:35:22,574 - INFO - y shape : (198,)
2025-06-04 19:35:23,007 - INFO - Confusion matrix: TN=3, FP=32, FN=0, TP=98
2025-06-04 19:35:25,761 - INFO - Metrics: {'f1': 0.8596491228070176, 'recall': 1.0, 'precision': 0.7538461538461538, 'accuracy': 0.7593984962406015, 'AP': {}, 'MCC': 0.254195563720897, 'NDCG': {}, 'kappa': 0.12138728323699421, 'TN': 3, 'FP': 32, 'FN': 0, 'TP': 98}
2025-06-04 19:35:25,761 - INFO - Concatenating...
2025-06-04 19:35:25,764 - INFO - 
fold number 2 / 3
2025-06-04 19:35:25,769 - INFO - train split size : 198
2025-06-04 19:35:25,769 - INFO - dev split size : 67
2025-06-04 19:35:25,769 - INFO - test split size : 132
2025-06-04 19:35:25,967 - INFO - X shape : (198, 10000)
2025-06-04 19:35:25,967 - INFO - y shape : (198,)
2025-06-04 19:35:26,396 - INFO - Confusion matrix: TN=5, FP=29, FN=0, TP=98
2025-06-04 19:35:29,177 - INFO - Metrics: {'f1': 0.8711111111111111, 'recall': 1.0, 'precision': 0.7716535433070866, 'accuracy': 0.7803030303030303, 'AP': {}, 'MCC': 0.3368656442130039, 'NDCG': {}, 'kappa': 0.20382695507487514, 'TN': 5, 'FP': 29, 'FN': 0, 'TP': 98}
2025-06-04 19:35:29,177 - INFO - Concatenating...
2025-06-04 19:35:29,180 - INFO - 
fold number 3 / 3
2025-06-04 19:35:29,185 - INFO - train split size : 198
2025-06-04 19:35:29,185 - INFO - dev split size : 67
2025-06-04 19:35:29,185 - INFO - test split size : 132
2025-06-04 19:35:29,378 - INFO - X shape : (198, 10000)
2025-06-04 19:35:29,378 - INFO - y shape : (198,)
2025-06-04 19:35:29,798 - INFO - Confusion matrix: TN=3, FP=32, FN=2, TP=95
2025-06-04 19:35:32,526 - INFO - Metrics: {'f1': 0.8482142857142857, 'recall': 0.979381443298969, 'precision': 0.7480314960629921, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.15051698892747684, 'NDCG': {}, 'kappa': 0.08965517241379295, 'TN': 3, 'FP': 32, 'FN': 2, 'TP': 95}
2025-06-04 19:35:32,526 - INFO - Concatenating...
2025-06-04 19:35:32,531 - INFO - fold indexes for run no.1: [[159, 206, 117, 82, 317, 330, 131, 380, 183, 158, 213, 260, 155, 332, 303, 269, 40, 232, 314, 244, 168, 218, 254, 100, 3, 235, 105, 243, 352, 394, 196, 223, 230, 307, 342, 289, 135, 7, 189, 134, 78, 133, 12, 375, 109, 46, 62, 393, 167, 151, 387, 374, 276, 323, 132, 319, 114, 176, 322, 263, 258, 266, 250, 329, 309, 367, 24, 229, 370, 211, 228, 346, 115, 392, 87, 88, 81, 343, 253, 278, 43, 333, 28, 80, 191, 10, 378, 388, 225, 363, 136, 104, 356, 8, 57, 162, 220, 391, 139, 386, 282, 70, 61, 170, 102, 296, 64, 35, 4, 251, 279, 44, 373, 129, 236, 327, 187, 68, 245, 215, 18, 42, 116, 212, 376, 148, 126, 27, 252, 173, 103, 336, 209, 199, 169, 283, 32, 246, 292, 210, 247, 141, 73, 194, 59, 385, 354, 51, 305, 200, 344, 179, 178, 355, 313, 112, 291, 23, 328, 130, 315, 181, 138, 94, 95, 121, 207, 175, 295, 321, 34, 300, 262, 33, 341, 54, 299, 48, 30, 204, 123, 331, 301, 150, 157, 265, 14, 53, 396, 242, 377, 366, 93, 214, 83, 52, 6, 188], [177, 268, 97, 248, 298, 320, 224, 137, 161, 145, 339, 98, 39, 66, 17, 325, 226, 91, 348, 67, 55, 237, 273, 353, 381, 261, 31, 2, 290, 107, 38, 113, 120, 1, 222, 84, 358, 202, 63, 337, 92, 99, 144, 256, 19, 171, 219, 285, 274, 174, 118, 233, 156, 324, 284, 190, 255, 357, 205, 111, 72, 384, 294, 71, 163, 217], array([  0,   5,   9,  11,  13,  15,  16,  20,  21,  22,  25,  26,  29,
        36,  37,  41,  45,  47,  49,  50,  56,  58,  60,  65,  69,  74,
        75,  76,  77,  79,  85,  86,  89,  90,  96, 101, 106, 108, 110,
       119, 122, 124, 125, 127, 128, 140, 142, 143, 146, 147, 149, 152,
       153, 154, 160, 164, 165, 166, 172, 180, 182, 184, 185, 186, 192,
       193, 195, 197, 198, 201, 203, 208, 216, 221, 227, 231, 234, 238,
       239, 240, 241, 249, 257, 259, 264, 267, 270, 271, 272, 275, 277,
       280, 281, 286, 287, 288, 293, 297, 302, 304, 306, 308, 310, 311,
       312, 316, 318, 326, 334, 335, 338, 340, 345, 347, 349, 350, 351,
       359, 360, 361, 362, 364, 365, 368, 369, 371, 372, 379, 382, 383,
       389, 390, 395])]
2025-06-04 19:35:32,532 - INFO - Run no 1/2
2025-06-04 19:35:32,532 - INFO - Kernel : rbf
2025-06-04 19:35:32,532 - INFO - 
fold number 1 / 3
2025-06-04 19:35:32,537 - INFO - train split size : 198
2025-06-04 19:35:32,537 - INFO - dev split size : 66
2025-06-04 19:35:32,537 - INFO - test split size : 133
2025-06-04 19:35:32,725 - INFO - X shape : (198, 10000)
2025-06-04 19:35:32,725 - INFO - y shape : (198,)
2025-06-04 19:35:33,142 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:35:35,975 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:35:35,976 - INFO - Concatenating...
2025-06-04 19:35:35,979 - INFO - 
fold number 2 / 3
2025-06-04 19:35:35,984 - INFO - train split size : 198
2025-06-04 19:35:35,984 - INFO - dev split size : 67
2025-06-04 19:35:35,984 - INFO - test split size : 132
2025-06-04 19:35:36,182 - INFO - X shape : (198, 10000)
2025-06-04 19:35:36,182 - INFO - y shape : (198,)
2025-06-04 19:35:36,598 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:35:39,873 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:35:39,873 - INFO - Concatenating...
2025-06-04 19:35:39,876 - INFO - 
fold number 3 / 3
2025-06-04 19:35:39,881 - INFO - train split size : 198
2025-06-04 19:35:39,881 - INFO - dev split size : 67
2025-06-04 19:35:39,881 - INFO - test split size : 132
2025-06-04 19:35:40,080 - INFO - X shape : (198, 10000)
2025-06-04 19:35:40,080 - INFO - y shape : (198,)
2025-06-04 19:35:40,522 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:35:43,277 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:35:43,277 - INFO - Concatenating...
2025-06-04 19:35:43,283 - INFO - fold indexes for run no.2: [[284, 266, 388, 393, 133, 13, 20, 176, 269, 308, 45, 193, 147, 19, 168, 230, 151, 384, 157, 153, 149, 327, 321, 381, 385, 330, 199, 72, 142, 10, 47, 270, 377, 73, 0, 118, 184, 65, 343, 219, 86, 357, 201, 226, 264, 223, 33, 114, 67, 268, 182, 310, 53, 246, 145, 76, 320, 373, 280, 95, 254, 113, 154, 160, 228, 306, 325, 99, 355, 356, 125, 166, 346, 286, 102, 354, 92, 336, 81, 159, 52, 304, 323, 111, 96, 274, 236, 41, 91, 32, 90, 367, 179, 130, 74, 334, 378, 208, 77, 396, 361, 6, 332, 238, 222, 277, 365, 36, 256, 21, 260, 38, 234, 341, 173, 124, 183, 31, 202, 203, 196, 119, 150, 263, 105, 126, 48, 143, 289, 231, 324, 352, 186, 155, 292, 217, 198, 316, 109, 287, 44, 49, 82, 15, 309, 83, 135, 218, 305, 283, 122, 127, 290, 35, 85, 98, 271, 141, 167, 295, 93, 27, 262, 229, 273, 9, 370, 89, 129, 197, 164, 205, 347, 171, 178, 70, 140, 372, 100, 314, 69, 4, 301, 265, 244, 101, 248, 358, 364, 94, 296, 87, 307, 239, 192, 50, 169, 39], [326, 210, 250, 319, 380, 279, 293, 288, 220, 253, 162, 43, 152, 8, 221, 235, 297, 339, 331, 61, 106, 181, 329, 243, 375, 88, 257, 194, 117, 104, 55, 349, 14, 108, 62, 281, 282, 2, 63, 240, 351, 107, 97, 187, 215, 54, 80, 232, 318, 241, 303, 252, 29, 139, 247, 362, 51, 390, 285, 392, 174, 298, 5, 335, 294, 28], array([  1,   3,   7,  11,  12,  16,  17,  18,  22,  23,  24,  25,  26,
        30,  34,  37,  40,  42,  46,  56,  57,  58,  59,  60,  64,  66,
        68,  71,  75,  78,  79,  84, 103, 110, 112, 115, 116, 120, 121,
       123, 128, 131, 132, 134, 136, 137, 138, 144, 146, 148, 156, 158,
       161, 163, 165, 170, 172, 175, 177, 180, 185, 188, 189, 190, 191,
       195, 200, 204, 206, 207, 209, 211, 212, 213, 214, 216, 224, 225,
       227, 233, 237, 242, 245, 249, 251, 255, 258, 259, 261, 267, 272,
       275, 276, 278, 291, 299, 300, 302, 311, 312, 313, 315, 317, 322,
       328, 333, 337, 338, 340, 342, 344, 345, 348, 350, 353, 359, 360,
       363, 366, 368, 369, 371, 374, 376, 379, 382, 383, 386, 387, 389,
       391, 394, 395])]
2025-06-04 19:35:43,283 - INFO - Run no 2/2
2025-06-04 19:35:43,283 - INFO - Kernel : rbf
2025-06-04 19:35:43,283 - INFO - 
fold number 1 / 3
2025-06-04 19:35:43,288 - INFO - train split size : 198
2025-06-04 19:35:43,288 - INFO - dev split size : 66
2025-06-04 19:35:43,288 - INFO - test split size : 133
2025-06-04 19:35:43,490 - INFO - X shape : (198, 10000)
2025-06-04 19:35:43,490 - INFO - y shape : (198,)
2025-06-04 19:35:43,915 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:35:46,728 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:35:46,728 - INFO - Concatenating...
2025-06-04 19:35:46,733 - INFO - 
fold number 2 / 3
2025-06-04 19:35:46,738 - INFO - train split size : 198
2025-06-04 19:35:46,738 - INFO - dev split size : 67
2025-06-04 19:35:46,738 - INFO - test split size : 132
2025-06-04 19:35:46,930 - INFO - X shape : (198, 10000)
2025-06-04 19:35:46,930 - INFO - y shape : (198,)
2025-06-04 19:35:47,355 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:35:50,111 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:35:50,111 - INFO - Concatenating...
2025-06-04 19:35:50,114 - INFO - 
fold number 3 / 3
2025-06-04 19:35:50,119 - INFO - train split size : 198
2025-06-04 19:35:50,119 - INFO - dev split size : 67
2025-06-04 19:35:50,119 - INFO - test split size : 132
2025-06-04 19:35:50,310 - INFO - X shape : (198, 10000)
2025-06-04 19:35:50,310 - INFO - y shape : (198,)
2025-06-04 19:35:50,738 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:35:53,537 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:35:53,537 - INFO - Concatenating...
2025-06-04 19:35:53,543 - INFO - fold indexes for run no.1: [[159, 206, 117, 82, 317, 330, 131, 380, 183, 158, 213, 260, 155, 332, 303, 269, 40, 232, 314, 244, 168, 218, 254, 100, 3, 235, 105, 243, 352, 394, 196, 223, 230, 307, 342, 289, 135, 7, 189, 134, 78, 133, 12, 375, 109, 46, 62, 393, 167, 151, 387, 374, 276, 323, 132, 319, 114, 176, 322, 263, 258, 266, 250, 329, 309, 367, 24, 229, 370, 211, 228, 346, 115, 392, 87, 88, 81, 343, 253, 278, 43, 333, 28, 80, 191, 10, 378, 388, 225, 363, 136, 104, 356, 8, 57, 162, 220, 391, 139, 386, 282, 70, 61, 170, 102, 296, 64, 35, 4, 251, 279, 44, 373, 129, 236, 327, 187, 68, 245, 215, 18, 42, 116, 212, 376, 148, 126, 27, 252, 173, 103, 336, 209, 199, 169, 283, 32, 246, 292, 210, 247, 141, 73, 194, 59, 385, 354, 51, 305, 200, 344, 179, 178, 355, 313, 112, 291, 23, 328, 130, 315, 181, 138, 94, 95, 121, 207, 175, 295, 321, 34, 300, 262, 33, 341, 54, 299, 48, 30, 204, 123, 331, 301, 150, 157, 265, 14, 53, 396, 242, 377, 366, 93, 214, 83, 52, 6, 188], [177, 268, 97, 248, 298, 320, 224, 137, 161, 145, 339, 98, 39, 66, 17, 325, 226, 91, 348, 67, 55, 237, 273, 353, 381, 261, 31, 2, 290, 107, 38, 113, 120, 1, 222, 84, 358, 202, 63, 337, 92, 99, 144, 256, 19, 171, 219, 285, 274, 174, 118, 233, 156, 324, 284, 190, 255, 357, 205, 111, 72, 384, 294, 71, 163, 217], array([  0,   5,   9,  11,  13,  15,  16,  20,  21,  22,  25,  26,  29,
        36,  37,  41,  45,  47,  49,  50,  56,  58,  60,  65,  69,  74,
        75,  76,  77,  79,  85,  86,  89,  90,  96, 101, 106, 108, 110,
       119, 122, 124, 125, 127, 128, 140, 142, 143, 146, 147, 149, 152,
       153, 154, 160, 164, 165, 166, 172, 180, 182, 184, 185, 186, 192,
       193, 195, 197, 198, 201, 203, 208, 216, 221, 227, 231, 234, 238,
       239, 240, 241, 249, 257, 259, 264, 267, 270, 271, 272, 275, 277,
       280, 281, 286, 287, 288, 293, 297, 302, 304, 306, 308, 310, 311,
       312, 316, 318, 326, 334, 335, 338, 340, 345, 347, 349, 350, 351,
       359, 360, 361, 362, 364, 365, 368, 369, 371, 372, 379, 382, 383,
       389, 390, 395])]
2025-06-04 19:35:53,543 - INFO - Run no 1/2
2025-06-04 19:35:53,543 - INFO - Kernel : poly
2025-06-04 19:35:53,543 - INFO - 
fold number 1 / 3
2025-06-04 19:35:53,548 - INFO - train split size : 198
2025-06-04 19:35:53,548 - INFO - dev split size : 66
2025-06-04 19:35:53,548 - INFO - test split size : 133
2025-06-04 19:35:53,763 - INFO - X shape : (198, 10000)
2025-06-04 19:35:53,763 - INFO - y shape : (198,)
2025-06-04 19:35:54,200 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:35:56,978 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:35:56,978 - INFO - Concatenating...
2025-06-04 19:35:56,982 - INFO - 
fold number 2 / 3
2025-06-04 19:35:56,988 - INFO - train split size : 198
2025-06-04 19:35:56,988 - INFO - dev split size : 67
2025-06-04 19:35:56,988 - INFO - test split size : 132
2025-06-04 19:35:57,214 - INFO - X shape : (198, 10000)
2025-06-04 19:35:57,214 - INFO - y shape : (198,)
2025-06-04 19:35:57,660 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:36:00,640 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:36:00,640 - INFO - Concatenating...
2025-06-04 19:36:00,643 - INFO - 
fold number 3 / 3
2025-06-04 19:36:00,648 - INFO - train split size : 198
2025-06-04 19:36:00,648 - INFO - dev split size : 67
2025-06-04 19:36:00,648 - INFO - test split size : 132
2025-06-04 19:36:00,841 - INFO - X shape : (198, 10000)
2025-06-04 19:36:00,841 - INFO - y shape : (198,)
2025-06-04 19:36:01,287 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:36:04,071 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:36:04,071 - INFO - Concatenating...
2025-06-04 19:36:04,076 - INFO - fold indexes for run no.2: [[284, 266, 388, 393, 133, 13, 20, 176, 269, 308, 45, 193, 147, 19, 168, 230, 151, 384, 157, 153, 149, 327, 321, 381, 385, 330, 199, 72, 142, 10, 47, 270, 377, 73, 0, 118, 184, 65, 343, 219, 86, 357, 201, 226, 264, 223, 33, 114, 67, 268, 182, 310, 53, 246, 145, 76, 320, 373, 280, 95, 254, 113, 154, 160, 228, 306, 325, 99, 355, 356, 125, 166, 346, 286, 102, 354, 92, 336, 81, 159, 52, 304, 323, 111, 96, 274, 236, 41, 91, 32, 90, 367, 179, 130, 74, 334, 378, 208, 77, 396, 361, 6, 332, 238, 222, 277, 365, 36, 256, 21, 260, 38, 234, 341, 173, 124, 183, 31, 202, 203, 196, 119, 150, 263, 105, 126, 48, 143, 289, 231, 324, 352, 186, 155, 292, 217, 198, 316, 109, 287, 44, 49, 82, 15, 309, 83, 135, 218, 305, 283, 122, 127, 290, 35, 85, 98, 271, 141, 167, 295, 93, 27, 262, 229, 273, 9, 370, 89, 129, 197, 164, 205, 347, 171, 178, 70, 140, 372, 100, 314, 69, 4, 301, 265, 244, 101, 248, 358, 364, 94, 296, 87, 307, 239, 192, 50, 169, 39], [326, 210, 250, 319, 380, 279, 293, 288, 220, 253, 162, 43, 152, 8, 221, 235, 297, 339, 331, 61, 106, 181, 329, 243, 375, 88, 257, 194, 117, 104, 55, 349, 14, 108, 62, 281, 282, 2, 63, 240, 351, 107, 97, 187, 215, 54, 80, 232, 318, 241, 303, 252, 29, 139, 247, 362, 51, 390, 285, 392, 174, 298, 5, 335, 294, 28], array([  1,   3,   7,  11,  12,  16,  17,  18,  22,  23,  24,  25,  26,
        30,  34,  37,  40,  42,  46,  56,  57,  58,  59,  60,  64,  66,
        68,  71,  75,  78,  79,  84, 103, 110, 112, 115, 116, 120, 121,
       123, 128, 131, 132, 134, 136, 137, 138, 144, 146, 148, 156, 158,
       161, 163, 165, 170, 172, 175, 177, 180, 185, 188, 189, 190, 191,
       195, 200, 204, 206, 207, 209, 211, 212, 213, 214, 216, 224, 225,
       227, 233, 237, 242, 245, 249, 251, 255, 258, 259, 261, 267, 272,
       275, 276, 278, 291, 299, 300, 302, 311, 312, 313, 315, 317, 322,
       328, 333, 337, 338, 340, 342, 344, 345, 348, 350, 353, 359, 360,
       363, 366, 368, 369, 371, 374, 376, 379, 382, 383, 386, 387, 389,
       391, 394, 395])]
2025-06-04 19:36:04,076 - INFO - Run no 2/2
2025-06-04 19:36:04,076 - INFO - Kernel : poly
2025-06-04 19:36:04,076 - INFO - 
fold number 1 / 3
2025-06-04 19:36:04,081 - INFO - train split size : 198
2025-06-04 19:36:04,082 - INFO - dev split size : 66
2025-06-04 19:36:04,082 - INFO - test split size : 133
2025-06-04 19:36:04,277 - INFO - X shape : (198, 10000)
2025-06-04 19:36:04,277 - INFO - y shape : (198,)
2025-06-04 19:36:04,714 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:36:07,681 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:36:07,681 - INFO - Concatenating...
2025-06-04 19:36:07,684 - INFO - 
fold number 2 / 3
2025-06-04 19:36:07,689 - INFO - train split size : 198
2025-06-04 19:36:07,689 - INFO - dev split size : 67
2025-06-04 19:36:07,689 - INFO - test split size : 132
2025-06-04 19:36:07,897 - INFO - X shape : (198, 10000)
2025-06-04 19:36:07,897 - INFO - y shape : (198,)
2025-06-04 19:36:08,333 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:36:11,187 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:36:11,187 - INFO - Concatenating...
2025-06-04 19:36:11,190 - INFO - 
fold number 3 / 3
2025-06-04 19:36:11,195 - INFO - train split size : 198
2025-06-04 19:36:11,195 - INFO - dev split size : 67
2025-06-04 19:36:11,195 - INFO - test split size : 132
2025-06-04 19:36:11,391 - INFO - X shape : (198, 10000)
2025-06-04 19:36:11,392 - INFO - y shape : (198,)
2025-06-04 19:36:11,830 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:36:14,893 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:36:14,893 - INFO - Concatenating...
2025-06-04 19:36:14,898 - INFO - fold indexes for run no.1: [[159, 206, 117, 82, 317, 330, 131, 380, 183, 158, 213, 260, 155, 332, 303, 269, 40, 232, 314, 244, 168, 218, 254, 100, 3, 235, 105, 243, 352, 394, 196, 223, 230, 307, 342, 289, 135, 7, 189, 134, 78, 133, 12, 375, 109, 46, 62, 393, 167, 151, 387, 374, 276, 323, 132, 319, 114, 176, 322, 263, 258, 266, 250, 329, 309, 367, 24, 229, 370, 211, 228, 346, 115, 392, 87, 88, 81, 343, 253, 278, 43, 333, 28, 80, 191, 10, 378, 388, 225, 363, 136, 104, 356, 8, 57, 162, 220, 391, 139, 386, 282, 70, 61, 170, 102, 296, 64, 35, 4, 251, 279, 44, 373, 129, 236, 327, 187, 68, 245, 215, 18, 42, 116, 212, 376, 148, 126, 27, 252, 173, 103, 336, 209, 199, 169, 283, 32, 246, 292, 210, 247, 141, 73, 194, 59, 385, 354, 51, 305, 200, 344, 179, 178, 355, 313, 112, 291, 23, 328, 130, 315, 181, 138, 94, 95, 121, 207, 175, 295, 321, 34, 300, 262, 33, 341, 54, 299, 48, 30, 204, 123, 331, 301, 150, 157, 265, 14, 53, 396, 242, 377, 366, 93, 214, 83, 52, 6, 188], [177, 268, 97, 248, 298, 320, 224, 137, 161, 145, 339, 98, 39, 66, 17, 325, 226, 91, 348, 67, 55, 237, 273, 353, 381, 261, 31, 2, 290, 107, 38, 113, 120, 1, 222, 84, 358, 202, 63, 337, 92, 99, 144, 256, 19, 171, 219, 285, 274, 174, 118, 233, 156, 324, 284, 190, 255, 357, 205, 111, 72, 384, 294, 71, 163, 217], array([  0,   5,   9,  11,  13,  15,  16,  20,  21,  22,  25,  26,  29,
        36,  37,  41,  45,  47,  49,  50,  56,  58,  60,  65,  69,  74,
        75,  76,  77,  79,  85,  86,  89,  90,  96, 101, 106, 108, 110,
       119, 122, 124, 125, 127, 128, 140, 142, 143, 146, 147, 149, 152,
       153, 154, 160, 164, 165, 166, 172, 180, 182, 184, 185, 186, 192,
       193, 195, 197, 198, 201, 203, 208, 216, 221, 227, 231, 234, 238,
       239, 240, 241, 249, 257, 259, 264, 267, 270, 271, 272, 275, 277,
       280, 281, 286, 287, 288, 293, 297, 302, 304, 306, 308, 310, 311,
       312, 316, 318, 326, 334, 335, 338, 340, 345, 347, 349, 350, 351,
       359, 360, 361, 362, 364, 365, 368, 369, 371, 372, 379, 382, 383,
       389, 390, 395])]
2025-06-04 19:36:14,899 - INFO - Run no 1/2
2025-06-04 19:36:14,899 - INFO - Kernel : sigmoid
2025-06-04 19:36:14,899 - INFO - 
fold number 1 / 3
2025-06-04 19:36:14,904 - INFO - train split size : 198
2025-06-04 19:36:14,904 - INFO - dev split size : 66
2025-06-04 19:36:14,904 - INFO - test split size : 133
2025-06-04 19:36:15,117 - INFO - X shape : (198, 10000)
2025-06-04 19:36:15,117 - INFO - y shape : (198,)
2025-06-04 19:36:15,546 - INFO - Confusion matrix: TN=5, FP=30, FN=0, TP=98
2025-06-04 19:36:18,486 - INFO - Metrics: {'f1': 0.8672566371681416, 'recall': 1.0, 'precision': 0.765625, 'accuracy': 0.7744360902255639, 'AP': {}, 'MCC': 0.3307189138830738, 'NDCG': {}, 'kappa': 0.19718309859154926, 'TN': 5, 'FP': 30, 'FN': 0, 'TP': 98}
2025-06-04 19:36:18,486 - INFO - Concatenating...
2025-06-04 19:36:18,489 - INFO - 
fold number 2 / 3
2025-06-04 19:36:18,494 - INFO - train split size : 198
2025-06-04 19:36:18,494 - INFO - dev split size : 67
2025-06-04 19:36:18,494 - INFO - test split size : 132
2025-06-04 19:36:18,699 - INFO - X shape : (198, 10000)
2025-06-04 19:36:18,699 - INFO - y shape : (198,)
2025-06-04 19:36:19,133 - INFO - Confusion matrix: TN=7, FP=27, FN=0, TP=98
2025-06-04 19:36:21,924 - INFO - Metrics: {'f1': 0.8789237668161435, 'recall': 1.0, 'precision': 0.784, 'accuracy': 0.7954545454545454, 'AP': {}, 'MCC': 0.401760830228486, 'NDCG': {}, 'kappa': 0.27795786061588323, 'TN': 7, 'FP': 27, 'FN': 0, 'TP': 98}
2025-06-04 19:36:21,925 - INFO - Concatenating...
2025-06-04 19:36:21,928 - INFO - 
fold number 3 / 3
2025-06-04 19:36:21,933 - INFO - train split size : 198
2025-06-04 19:36:21,933 - INFO - dev split size : 67
2025-06-04 19:36:21,933 - INFO - test split size : 132
2025-06-04 19:36:22,137 - INFO - X shape : (198, 10000)
2025-06-04 19:36:22,137 - INFO - y shape : (198,)
2025-06-04 19:36:22,567 - INFO - Confusion matrix: TN=3, FP=32, FN=0, TP=97
2025-06-04 19:36:25,388 - INFO - Metrics: {'f1': 0.8584070796460177, 'recall': 1.0, 'precision': 0.751937984496124, 'accuracy': 0.7575757575757576, 'AP': {}, 'MCC': 0.2538736442455674, 'NDCG': {}, 'kappa': 0.12109862671660421, 'TN': 3, 'FP': 32, 'FN': 0, 'TP': 97}
2025-06-04 19:36:25,388 - INFO - Concatenating...
2025-06-04 19:36:25,393 - INFO - fold indexes for run no.2: [[284, 266, 388, 393, 133, 13, 20, 176, 269, 308, 45, 193, 147, 19, 168, 230, 151, 384, 157, 153, 149, 327, 321, 381, 385, 330, 199, 72, 142, 10, 47, 270, 377, 73, 0, 118, 184, 65, 343, 219, 86, 357, 201, 226, 264, 223, 33, 114, 67, 268, 182, 310, 53, 246, 145, 76, 320, 373, 280, 95, 254, 113, 154, 160, 228, 306, 325, 99, 355, 356, 125, 166, 346, 286, 102, 354, 92, 336, 81, 159, 52, 304, 323, 111, 96, 274, 236, 41, 91, 32, 90, 367, 179, 130, 74, 334, 378, 208, 77, 396, 361, 6, 332, 238, 222, 277, 365, 36, 256, 21, 260, 38, 234, 341, 173, 124, 183, 31, 202, 203, 196, 119, 150, 263, 105, 126, 48, 143, 289, 231, 324, 352, 186, 155, 292, 217, 198, 316, 109, 287, 44, 49, 82, 15, 309, 83, 135, 218, 305, 283, 122, 127, 290, 35, 85, 98, 271, 141, 167, 295, 93, 27, 262, 229, 273, 9, 370, 89, 129, 197, 164, 205, 347, 171, 178, 70, 140, 372, 100, 314, 69, 4, 301, 265, 244, 101, 248, 358, 364, 94, 296, 87, 307, 239, 192, 50, 169, 39], [326, 210, 250, 319, 380, 279, 293, 288, 220, 253, 162, 43, 152, 8, 221, 235, 297, 339, 331, 61, 106, 181, 329, 243, 375, 88, 257, 194, 117, 104, 55, 349, 14, 108, 62, 281, 282, 2, 63, 240, 351, 107, 97, 187, 215, 54, 80, 232, 318, 241, 303, 252, 29, 139, 247, 362, 51, 390, 285, 392, 174, 298, 5, 335, 294, 28], array([  1,   3,   7,  11,  12,  16,  17,  18,  22,  23,  24,  25,  26,
        30,  34,  37,  40,  42,  46,  56,  57,  58,  59,  60,  64,  66,
        68,  71,  75,  78,  79,  84, 103, 110, 112, 115, 116, 120, 121,
       123, 128, 131, 132, 134, 136, 137, 138, 144, 146, 148, 156, 158,
       161, 163, 165, 170, 172, 175, 177, 180, 185, 188, 189, 190, 191,
       195, 200, 204, 206, 207, 209, 211, 212, 213, 214, 216, 224, 225,
       227, 233, 237, 242, 245, 249, 251, 255, 258, 259, 261, 267, 272,
       275, 276, 278, 291, 299, 300, 302, 311, 312, 313, 315, 317, 322,
       328, 333, 337, 338, 340, 342, 344, 345, 348, 350, 353, 359, 360,
       363, 366, 368, 369, 371, 374, 376, 379, 382, 383, 386, 387, 389,
       391, 394, 395])]
2025-06-04 19:36:25,393 - INFO - Run no 2/2
2025-06-04 19:36:25,393 - INFO - Kernel : sigmoid
2025-06-04 19:36:25,393 - INFO - 
fold number 1 / 3
2025-06-04 19:36:25,397 - INFO - train split size : 198
2025-06-04 19:36:25,398 - INFO - dev split size : 66
2025-06-04 19:36:25,398 - INFO - test split size : 133
2025-06-04 19:36:25,590 - INFO - X shape : (198, 10000)
2025-06-04 19:36:25,591 - INFO - y shape : (198,)
2025-06-04 19:36:26,004 - INFO - Confusion matrix: TN=2, FP=33, FN=0, TP=98
2025-06-04 19:36:28,895 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.7518796992481203, 'AP': {}, 'MCC': 0.20675611624097953, 'NDCG': {}, 'kappa': 0.08199121522693997, 'TN': 2, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:36:28,895 - INFO - Concatenating...
2025-06-04 19:36:28,898 - INFO - 
fold number 2 / 3
2025-06-04 19:36:28,903 - INFO - train split size : 198
2025-06-04 19:36:28,903 - INFO - dev split size : 67
2025-06-04 19:36:28,903 - INFO - test split size : 132
2025-06-04 19:36:29,093 - INFO - X shape : (198, 10000)
2025-06-04 19:36:29,093 - INFO - y shape : (198,)
2025-06-04 19:36:29,503 - INFO - Confusion matrix: TN=4, FP=30, FN=0, TP=98
2025-06-04 19:36:36,203 - INFO - Metrics: {'f1': 0.8672566371681416, 'recall': 1.0, 'precision': 0.765625, 'accuracy': 0.7727272727272727, 'AP': {}, 'MCC': 0.3001225239993905, 'NDCG': {}, 'kappa': 0.16526138279932545, 'TN': 4, 'FP': 30, 'FN': 0, 'TP': 98}
2025-06-04 19:36:36,203 - INFO - Concatenating...
2025-06-04 19:36:36,206 - INFO - 
fold number 3 / 3
2025-06-04 19:36:36,211 - INFO - train split size : 198
2025-06-04 19:36:36,211 - INFO - dev split size : 67
2025-06-04 19:36:36,211 - INFO - test split size : 132
2025-06-04 19:36:36,404 - INFO - X shape : (198, 10000)
2025-06-04 19:36:36,404 - INFO - y shape : (198,)
2025-06-04 19:36:36,821 - INFO - Confusion matrix: TN=2, FP=33, FN=1, TP=96
2025-06-04 19:36:39,605 - INFO - Metrics: {'f1': 0.8495575221238938, 'recall': 0.9896907216494846, 'precision': 0.7441860465116279, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.13871446541252652, 'NDCG': {}, 'kappa': 0.06616729088639195, 'TN': 2, 'FP': 33, 'FN': 1, 'TP': 96}
2025-06-04 19:36:39,605 - INFO - Concatenating...
2025-06-04 19:36:39,614 - INFO - 
fold number 1 / 3
2025-06-04 19:36:39,620 - INFO - train split size : 198
2025-06-04 19:36:39,620 - INFO - dev split size : 66
2025-06-04 19:36:39,620 - INFO - test split size : 133
2025-06-04 19:36:39,818 - INFO - X shape : (198, 10000)
2025-06-04 19:36:39,818 - INFO - y shape : (198,)
2025-06-04 19:36:40,041 - INFO - Confusion matrix: TN=2, FP=33, FN=0, TP=98
2025-06-04 19:36:42,900 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.7518796992481203, 'AP': {}, 'MCC': 0.20675611624097953, 'NDCG': {}, 'kappa': 0.08199121522693997, 'TN': 2, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:36:42,903 - INFO - 
fold number 2 / 3
2025-06-04 19:36:42,908 - INFO - train split size : 198
2025-06-04 19:36:42,908 - INFO - dev split size : 67
2025-06-04 19:36:42,908 - INFO - test split size : 132
2025-06-04 19:36:43,119 - INFO - X shape : (198, 10000)
2025-06-04 19:36:43,119 - INFO - y shape : (198,)
2025-06-04 19:36:43,337 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:36:46,092 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:36:46,095 - INFO - 
fold number 3 / 3
2025-06-04 19:36:46,100 - INFO - train split size : 198
2025-06-04 19:36:46,100 - INFO - dev split size : 67
2025-06-04 19:36:46,100 - INFO - test split size : 132
2025-06-04 19:36:46,314 - INFO - X shape : (198, 10000)
2025-06-04 19:36:46,314 - INFO - y shape : (198,)
2025-06-04 19:36:46,545 - INFO - Confusion matrix: TN=1, FP=34, FN=0, TP=97
2025-06-04 19:36:49,720 - INFO - Metrics: {'f1': 0.8508771929824561, 'recall': 1.0, 'precision': 0.7404580152671756, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.14545082775064525, 'NDCG': {}, 'kappa': 0.04143528406663821, 'TN': 1, 'FP': 34, 'FN': 0, 'TP': 97}
2025-06-04 19:36:49,724 - INFO - 
fold number 1 / 3
2025-06-04 19:36:49,729 - INFO - train split size : 198
2025-06-04 19:36:49,729 - INFO - dev split size : 66
2025-06-04 19:36:49,729 - INFO - test split size : 133
2025-06-04 19:36:49,932 - INFO - X shape : (198, 10000)
2025-06-04 19:36:49,933 - INFO - y shape : (198,)
2025-06-04 19:36:50,143 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:36:53,454 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:36:53,458 - INFO - 
fold number 2 / 3
2025-06-04 19:36:53,463 - INFO - train split size : 198
2025-06-04 19:36:53,463 - INFO - dev split size : 67
2025-06-04 19:36:53,463 - INFO - test split size : 132
2025-06-04 19:36:53,657 - INFO - X shape : (198, 10000)
2025-06-04 19:36:53,658 - INFO - y shape : (198,)
2025-06-04 19:36:53,882 - INFO - Confusion matrix: TN=1, FP=33, FN=0, TP=98
2025-06-04 19:36:56,782 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.14833305163534516, 'NDCG': {}, 'kappa': 0.04305799648506148, 'TN': 1, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:36:56,786 - INFO - 
fold number 3 / 3
2025-06-04 19:36:56,791 - INFO - train split size : 198
2025-06-04 19:36:56,791 - INFO - dev split size : 67
2025-06-04 19:36:56,791 - INFO - test split size : 132
2025-06-04 19:36:56,979 - INFO - X shape : (198, 10000)
2025-06-04 19:36:56,979 - INFO - y shape : (198,)
2025-06-04 19:36:57,184 - INFO - Confusion matrix: TN=1, FP=34, FN=0, TP=97
2025-06-04 19:37:00,249 - INFO - Metrics: {'f1': 0.8508771929824561, 'recall': 1.0, 'precision': 0.7404580152671756, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.14545082775064525, 'NDCG': {}, 'kappa': 0.04143528406663821, 'TN': 1, 'FP': 34, 'FN': 0, 'TP': 97}
2025-06-04 19:37:00,257 - INFO - 
fold number 1 / 3
2025-06-04 19:37:00,262 - INFO - train split size : 198
2025-06-04 19:37:00,263 - INFO - dev split size : 66
2025-06-04 19:37:00,263 - INFO - test split size : 133
2025-06-04 19:37:00,466 - INFO - X shape : (198, 10000)
2025-06-04 19:37:00,466 - INFO - y shape : (198,)
2025-06-04 19:37:00,675 - INFO - Confusion matrix: TN=2, FP=33, FN=0, TP=98
2025-06-04 19:37:03,586 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.7518796992481203, 'AP': {}, 'MCC': 0.20675611624097953, 'NDCG': {}, 'kappa': 0.08199121522693997, 'TN': 2, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:37:03,595 - INFO - 
fold number 2 / 3
2025-06-04 19:37:03,600 - INFO - train split size : 198
2025-06-04 19:37:03,601 - INFO - dev split size : 67
2025-06-04 19:37:03,601 - INFO - test split size : 132
2025-06-04 19:37:03,814 - INFO - X shape : (198, 10000)
2025-06-04 19:37:03,814 - INFO - y shape : (198,)
2025-06-04 19:37:04,019 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:37:07,338 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:37:07,341 - INFO - 
fold number 3 / 3
2025-06-04 19:37:07,346 - INFO - train split size : 198
2025-06-04 19:37:07,346 - INFO - dev split size : 67
2025-06-04 19:37:07,346 - INFO - test split size : 132
2025-06-04 19:37:07,540 - INFO - X shape : (198, 10000)
2025-06-04 19:37:07,540 - INFO - y shape : (198,)
2025-06-04 19:37:07,755 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:37:10,483 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:37:10,487 - INFO - 
fold number 1 / 3
2025-06-04 19:37:10,492 - INFO - train split size : 198
2025-06-04 19:37:10,492 - INFO - dev split size : 66
2025-06-04 19:37:10,492 - INFO - test split size : 133
2025-06-04 19:37:10,687 - INFO - X shape : (198, 10000)
2025-06-04 19:37:10,688 - INFO - y shape : (198,)
2025-06-04 19:37:10,897 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:37:13,696 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:37:13,699 - INFO - 
fold number 2 / 3
2025-06-04 19:37:13,704 - INFO - train split size : 198
2025-06-04 19:37:13,704 - INFO - dev split size : 67
2025-06-04 19:37:13,704 - INFO - test split size : 132
2025-06-04 19:37:13,894 - INFO - X shape : (198, 10000)
2025-06-04 19:37:13,894 - INFO - y shape : (198,)
2025-06-04 19:37:14,111 - INFO - Confusion matrix: TN=1, FP=33, FN=0, TP=98
2025-06-04 19:37:17,100 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.14833305163534516, 'NDCG': {}, 'kappa': 0.04305799648506148, 'TN': 1, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:37:17,102 - INFO - 
fold number 3 / 3
2025-06-04 19:37:17,108 - INFO - train split size : 198
2025-06-04 19:37:17,108 - INFO - dev split size : 67
2025-06-04 19:37:17,108 - INFO - test split size : 132
2025-06-04 19:37:17,303 - INFO - X shape : (198, 10000)
2025-06-04 19:37:17,303 - INFO - y shape : (198,)
2025-06-04 19:37:17,514 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:37:20,821 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:37:20,826 - INFO - 
fold number 1 / 3
2025-06-04 19:37:20,831 - INFO - train split size : 198
2025-06-04 19:37:20,831 - INFO - dev split size : 66
2025-06-04 19:37:20,831 - INFO - test split size : 133
2025-06-04 19:37:21,030 - INFO - X shape : (198, 10000)
2025-06-04 19:37:21,030 - INFO - y shape : (198,)
2025-06-04 19:37:21,235 - INFO - Confusion matrix: TN=2, FP=33, FN=0, TP=98
2025-06-04 19:37:23,979 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.7518796992481203, 'AP': {}, 'MCC': 0.20675611624097953, 'NDCG': {}, 'kappa': 0.08199121522693997, 'TN': 2, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:37:23,982 - INFO - 
fold number 2 / 3
2025-06-04 19:37:23,987 - INFO - train split size : 198
2025-06-04 19:37:23,987 - INFO - dev split size : 67
2025-06-04 19:37:23,987 - INFO - test split size : 132
2025-06-04 19:37:24,196 - INFO - X shape : (198, 10000)
2025-06-04 19:37:24,196 - INFO - y shape : (198,)
2025-06-04 19:37:24,421 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:37:27,530 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:37:27,533 - INFO - 
fold number 3 / 3
2025-06-04 19:37:27,538 - INFO - train split size : 198
2025-06-04 19:37:27,538 - INFO - dev split size : 67
2025-06-04 19:37:27,538 - INFO - test split size : 132
2025-06-04 19:37:27,740 - INFO - X shape : (198, 10000)
2025-06-04 19:37:27,740 - INFO - y shape : (198,)
2025-06-04 19:37:27,954 - INFO - Confusion matrix: TN=1, FP=34, FN=0, TP=97
2025-06-04 19:37:30,729 - INFO - Metrics: {'f1': 0.8508771929824561, 'recall': 1.0, 'precision': 0.7404580152671756, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.14545082775064525, 'NDCG': {}, 'kappa': 0.04143528406663821, 'TN': 1, 'FP': 34, 'FN': 0, 'TP': 97}
2025-06-04 19:37:30,735 - INFO - 
fold number 1 / 3
2025-06-04 19:37:30,739 - INFO - train split size : 198
2025-06-04 19:37:30,739 - INFO - dev split size : 66
2025-06-04 19:37:30,739 - INFO - test split size : 133
2025-06-04 19:37:30,944 - INFO - X shape : (198, 10000)
2025-06-04 19:37:30,944 - INFO - y shape : (198,)
2025-06-04 19:37:31,167 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:37:34,732 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:37:34,734 - INFO - 
fold number 2 / 3
2025-06-04 19:37:34,739 - INFO - train split size : 198
2025-06-04 19:37:34,739 - INFO - dev split size : 67
2025-06-04 19:37:34,739 - INFO - test split size : 132
2025-06-04 19:37:34,936 - INFO - X shape : (198, 10000)
2025-06-04 19:37:34,936 - INFO - y shape : (198,)
2025-06-04 19:37:35,153 - INFO - Confusion matrix: TN=1, FP=33, FN=0, TP=98
2025-06-04 19:37:37,981 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.14833305163534516, 'NDCG': {}, 'kappa': 0.04305799648506148, 'TN': 1, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:37:37,983 - INFO - 
fold number 3 / 3
2025-06-04 19:37:37,989 - INFO - train split size : 198
2025-06-04 19:37:37,989 - INFO - dev split size : 67
2025-06-04 19:37:37,989 - INFO - test split size : 132
2025-06-04 19:37:38,194 - INFO - X shape : (198, 10000)
2025-06-04 19:37:38,194 - INFO - y shape : (198,)
2025-06-04 19:37:38,412 - INFO - Confusion matrix: TN=1, FP=34, FN=0, TP=97
2025-06-04 19:37:41,235 - INFO - Metrics: {'f1': 0.8508771929824561, 'recall': 1.0, 'precision': 0.7404580152671756, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.14545082775064525, 'NDCG': {}, 'kappa': 0.04143528406663821, 'TN': 1, 'FP': 34, 'FN': 0, 'TP': 97}
2025-06-04 19:37:41,242 - INFO - 
fold number 1 / 3
2025-06-04 19:37:41,248 - INFO - train split size : 198
2025-06-04 19:37:41,248 - INFO - dev split size : 66
2025-06-04 19:37:41,248 - INFO - test split size : 133
2025-06-04 19:37:41,456 - INFO - X shape : (198, 10000)
2025-06-04 19:37:41,456 - INFO - y shape : (198,)
2025-06-04 19:37:41,864 - INFO - Confusion matrix: TN=1, FP=34, FN=0, TP=98
2025-06-04 19:37:44,967 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7443609022556391, 'AP': {}, 'MCC': 0.14564381625088382, 'NDCG': {}, 'kappa': 0.041543026706231445, 'TN': 1, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:37:44,970 - INFO - 
fold number 2 / 3
2025-06-04 19:37:44,975 - INFO - train split size : 198
2025-06-04 19:37:44,975 - INFO - dev split size : 67
2025-06-04 19:37:44,975 - INFO - test split size : 132
2025-06-04 19:37:45,180 - INFO - X shape : (198, 10000)
2025-06-04 19:37:45,180 - INFO - y shape : (198,)
2025-06-04 19:37:45,576 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:37:48,316 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:37:48,318 - INFO - 
fold number 3 / 3
2025-06-04 19:37:48,323 - INFO - train split size : 198
2025-06-04 19:37:48,324 - INFO - dev split size : 67
2025-06-04 19:37:48,324 - INFO - test split size : 132
2025-06-04 19:37:48,533 - INFO - X shape : (198, 10000)
2025-06-04 19:37:48,533 - INFO - y shape : (198,)
2025-06-04 19:37:48,917 - INFO - Confusion matrix: TN=2, FP=33, FN=0, TP=97
2025-06-04 19:37:51,734 - INFO - Metrics: {'f1': 0.8546255506607929, 'recall': 1.0, 'precision': 0.7461538461538462, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.20648816585306443, 'NDCG': {}, 'kappa': 0.08178752107925802, 'TN': 2, 'FP': 33, 'FN': 0, 'TP': 97}
2025-06-04 19:37:51,739 - INFO - 
fold number 1 / 3
2025-06-04 19:37:51,744 - INFO - train split size : 198
2025-06-04 19:37:51,744 - INFO - dev split size : 66
2025-06-04 19:37:51,744 - INFO - test split size : 133
2025-06-04 19:37:51,956 - INFO - X shape : (198, 10000)
2025-06-04 19:37:51,956 - INFO - y shape : (198,)
2025-06-04 19:37:52,361 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:37:55,469 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:37:55,471 - INFO - 
fold number 2 / 3
2025-06-04 19:37:55,476 - INFO - train split size : 198
2025-06-04 19:37:55,476 - INFO - dev split size : 67
2025-06-04 19:37:55,476 - INFO - test split size : 132
2025-06-04 19:37:55,671 - INFO - X shape : (198, 10000)
2025-06-04 19:37:55,671 - INFO - y shape : (198,)
2025-06-04 19:37:56,074 - INFO - Confusion matrix: TN=2, FP=32, FN=0, TP=98
2025-06-04 19:37:58,814 - INFO - Metrics: {'f1': 0.8596491228070176, 'recall': 1.0, 'precision': 0.7538461538461538, 'accuracy': 0.7575757575757576, 'AP': {}, 'MCC': 0.2105798931586654, 'NDCG': {}, 'kappa': 0.08492201039861347, 'TN': 2, 'FP': 32, 'FN': 0, 'TP': 98}
2025-06-04 19:37:58,817 - INFO - 
fold number 3 / 3
2025-06-04 19:37:58,822 - INFO - train split size : 198
2025-06-04 19:37:58,822 - INFO - dev split size : 67
2025-06-04 19:37:58,822 - INFO - test split size : 132
2025-06-04 19:37:59,020 - INFO - X shape : (198, 10000)
2025-06-04 19:37:59,021 - INFO - y shape : (198,)
2025-06-04 19:37:59,423 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:38:02,244 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:38:02,252 - INFO - 
fold number 1 / 3
2025-06-04 19:38:02,258 - INFO - train split size : 198
2025-06-04 19:38:02,258 - INFO - dev split size : 66
2025-06-04 19:38:02,258 - INFO - test split size : 133
2025-06-04 19:38:02,487 - INFO - X shape : (198, 10000)
2025-06-04 19:38:02,487 - INFO - y shape : (198,)
2025-06-04 19:38:02,891 - INFO - Confusion matrix: TN=4, FP=31, FN=0, TP=98
2025-06-04 19:38:06,115 - INFO - Metrics: {'f1': 0.8634361233480177, 'recall': 1.0, 'precision': 0.7596899224806202, 'accuracy': 0.7669172932330827, 'AP': {}, 'MCC': 0.2946552314593389, 'NDCG': {}, 'kappa': 0.15977175463623383, 'TN': 4, 'FP': 31, 'FN': 0, 'TP': 98}
2025-06-04 19:38:06,117 - INFO - 
fold number 2 / 3
2025-06-04 19:38:06,122 - INFO - train split size : 198
2025-06-04 19:38:06,122 - INFO - dev split size : 67
2025-06-04 19:38:06,122 - INFO - test split size : 132
2025-06-04 19:38:06,325 - INFO - X shape : (198, 10000)
2025-06-04 19:38:06,325 - INFO - y shape : (198,)
2025-06-04 19:38:06,724 - INFO - Confusion matrix: TN=1, FP=33, FN=0, TP=98
2025-06-04 19:38:09,451 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.14833305163534516, 'NDCG': {}, 'kappa': 0.04305799648506148, 'TN': 1, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:38:09,454 - INFO - 
fold number 3 / 3
2025-06-04 19:38:09,459 - INFO - train split size : 198
2025-06-04 19:38:09,459 - INFO - dev split size : 67
2025-06-04 19:38:09,459 - INFO - test split size : 132
2025-06-04 19:38:09,656 - INFO - X shape : (198, 10000)
2025-06-04 19:38:09,657 - INFO - y shape : (198,)
2025-06-04 19:38:10,052 - INFO - Confusion matrix: TN=2, FP=33, FN=0, TP=97
2025-06-04 19:38:13,094 - INFO - Metrics: {'f1': 0.8546255506607929, 'recall': 1.0, 'precision': 0.7461538461538462, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.20648816585306443, 'NDCG': {}, 'kappa': 0.08178752107925802, 'TN': 2, 'FP': 33, 'FN': 0, 'TP': 97}
2025-06-04 19:38:13,099 - INFO - 
fold number 1 / 3
2025-06-04 19:38:13,104 - INFO - train split size : 198
2025-06-04 19:38:13,104 - INFO - dev split size : 66
2025-06-04 19:38:13,104 - INFO - test split size : 133
2025-06-04 19:38:13,324 - INFO - X shape : (198, 10000)
2025-06-04 19:38:13,324 - INFO - y shape : (198,)
2025-06-04 19:38:13,733 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:38:18,209 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:38:18,216 - INFO - 
fold number 2 / 3
2025-06-04 19:38:18,222 - INFO - train split size : 198
2025-06-04 19:38:18,222 - INFO - dev split size : 67
2025-06-04 19:38:18,222 - INFO - test split size : 132
2025-06-04 19:38:18,456 - INFO - X shape : (198, 10000)
2025-06-04 19:38:18,456 - INFO - y shape : (198,)
2025-06-04 19:38:18,879 - INFO - Confusion matrix: TN=1, FP=33, FN=0, TP=98
2025-06-04 19:38:21,726 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.14833305163534516, 'NDCG': {}, 'kappa': 0.04305799648506148, 'TN': 1, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:38:21,728 - INFO - 
fold number 3 / 3
2025-06-04 19:38:21,733 - INFO - train split size : 198
2025-06-04 19:38:21,733 - INFO - dev split size : 67
2025-06-04 19:38:21,733 - INFO - test split size : 132
2025-06-04 19:38:21,944 - INFO - X shape : (198, 10000)
2025-06-04 19:38:21,945 - INFO - y shape : (198,)
2025-06-04 19:38:22,351 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:38:25,617 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:38:25,622 - INFO - 
fold number 1 / 3
2025-06-04 19:38:25,628 - INFO - train split size : 198
2025-06-04 19:38:25,628 - INFO - dev split size : 66
2025-06-04 19:38:25,629 - INFO - test split size : 133
2025-06-04 19:38:25,843 - INFO - X shape : (198, 10000)
2025-06-04 19:38:25,844 - INFO - y shape : (198,)
2025-06-04 19:38:26,253 - INFO - Confusion matrix: TN=1, FP=34, FN=0, TP=98
2025-06-04 19:38:28,987 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7443609022556391, 'AP': {}, 'MCC': 0.14564381625088382, 'NDCG': {}, 'kappa': 0.041543026706231445, 'TN': 1, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:38:28,989 - INFO - 
fold number 2 / 3
2025-06-04 19:38:28,994 - INFO - train split size : 198
2025-06-04 19:38:28,994 - INFO - dev split size : 67
2025-06-04 19:38:28,994 - INFO - test split size : 132
2025-06-04 19:38:29,205 - INFO - X shape : (198, 10000)
2025-06-04 19:38:29,205 - INFO - y shape : (198,)
2025-06-04 19:38:29,617 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:38:33,185 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:38:33,188 - INFO - 
fold number 3 / 3
2025-06-04 19:38:33,193 - INFO - train split size : 198
2025-06-04 19:38:33,194 - INFO - dev split size : 67
2025-06-04 19:38:33,194 - INFO - test split size : 132
2025-06-04 19:38:33,414 - INFO - X shape : (198, 10000)
2025-06-04 19:38:33,414 - INFO - y shape : (198,)
2025-06-04 19:38:33,824 - INFO - Confusion matrix: TN=2, FP=33, FN=0, TP=97
2025-06-04 19:38:37,105 - INFO - Metrics: {'f1': 0.8546255506607929, 'recall': 1.0, 'precision': 0.7461538461538462, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.20648816585306443, 'NDCG': {}, 'kappa': 0.08178752107925802, 'TN': 2, 'FP': 33, 'FN': 0, 'TP': 97}
2025-06-04 19:38:37,111 - INFO - 
fold number 1 / 3
2025-06-04 19:38:37,116 - INFO - train split size : 198
2025-06-04 19:38:37,116 - INFO - dev split size : 66
2025-06-04 19:38:37,116 - INFO - test split size : 133
2025-06-04 19:38:37,355 - INFO - X shape : (198, 10000)
2025-06-04 19:38:37,355 - INFO - y shape : (198,)
2025-06-04 19:38:37,769 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:38:40,493 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:38:40,495 - INFO - 
fold number 2 / 3
2025-06-04 19:38:40,500 - INFO - train split size : 198
2025-06-04 19:38:40,500 - INFO - dev split size : 67
2025-06-04 19:38:40,501 - INFO - test split size : 132
2025-06-04 19:38:40,701 - INFO - X shape : (198, 10000)
2025-06-04 19:38:40,701 - INFO - y shape : (198,)
2025-06-04 19:38:41,122 - INFO - Confusion matrix: TN=2, FP=32, FN=0, TP=98
2025-06-04 19:38:44,274 - INFO - Metrics: {'f1': 0.8596491228070176, 'recall': 1.0, 'precision': 0.7538461538461538, 'accuracy': 0.7575757575757576, 'AP': {}, 'MCC': 0.2105798931586654, 'NDCG': {}, 'kappa': 0.08492201039861347, 'TN': 2, 'FP': 32, 'FN': 0, 'TP': 98}
2025-06-04 19:38:44,276 - INFO - 
fold number 3 / 3
2025-06-04 19:38:44,282 - INFO - train split size : 198
2025-06-04 19:38:44,282 - INFO - dev split size : 67
2025-06-04 19:38:44,282 - INFO - test split size : 132
2025-06-04 19:38:44,500 - INFO - X shape : (198, 10000)
2025-06-04 19:38:44,500 - INFO - y shape : (198,)
2025-06-04 19:38:44,900 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:38:47,764 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:38:47,772 - INFO - 
fold number 1 / 3
2025-06-04 19:38:47,776 - INFO - train split size : 198
2025-06-04 19:38:47,776 - INFO - dev split size : 66
2025-06-04 19:38:47,776 - INFO - test split size : 133
2025-06-04 19:38:47,980 - INFO - X shape : (198, 10000)
2025-06-04 19:38:47,980 - INFO - y shape : (198,)
2025-06-04 19:38:48,550 - INFO - Confusion matrix: TN=1, FP=34, FN=0, TP=98
2025-06-04 19:38:51,763 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7443609022556391, 'AP': {}, 'MCC': 0.14564381625088382, 'NDCG': {}, 'kappa': 0.041543026706231445, 'TN': 1, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:38:51,767 - INFO - 
fold number 2 / 3
2025-06-04 19:38:51,772 - INFO - train split size : 198
2025-06-04 19:38:51,772 - INFO - dev split size : 67
2025-06-04 19:38:51,772 - INFO - test split size : 132
2025-06-04 19:38:51,974 - INFO - X shape : (198, 10000)
2025-06-04 19:38:51,974 - INFO - y shape : (198,)
2025-06-04 19:38:52,556 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:38:55,607 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:38:55,616 - INFO - 
fold number 3 / 3
2025-06-04 19:38:55,622 - INFO - train split size : 198
2025-06-04 19:38:55,622 - INFO - dev split size : 67
2025-06-04 19:38:55,622 - INFO - test split size : 132
2025-06-04 19:38:55,836 - INFO - X shape : (198, 10000)
2025-06-04 19:38:55,836 - INFO - y shape : (198,)
2025-06-04 19:38:56,418 - INFO - Confusion matrix: TN=2, FP=33, FN=0, TP=97
2025-06-04 19:38:59,258 - INFO - Metrics: {'f1': 0.8546255506607929, 'recall': 1.0, 'precision': 0.7461538461538462, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.20648816585306443, 'NDCG': {}, 'kappa': 0.08178752107925802, 'TN': 2, 'FP': 33, 'FN': 0, 'TP': 97}
2025-06-04 19:38:59,263 - INFO - 
fold number 1 / 3
2025-06-04 19:38:59,269 - INFO - train split size : 198
2025-06-04 19:38:59,269 - INFO - dev split size : 66
2025-06-04 19:38:59,269 - INFO - test split size : 133
2025-06-04 19:38:59,478 - INFO - X shape : (198, 10000)
2025-06-04 19:38:59,478 - INFO - y shape : (198,)
2025-06-04 19:39:00,043 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:39:03,572 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:39:03,576 - INFO - 
fold number 2 / 3
2025-06-04 19:39:03,582 - INFO - train split size : 198
2025-06-04 19:39:03,582 - INFO - dev split size : 67
2025-06-04 19:39:03,582 - INFO - test split size : 132
2025-06-04 19:39:03,789 - INFO - X shape : (198, 10000)
2025-06-04 19:39:03,789 - INFO - y shape : (198,)
2025-06-04 19:39:04,355 - INFO - Confusion matrix: TN=1, FP=33, FN=0, TP=98
2025-06-04 19:39:08,214 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.14833305163534516, 'NDCG': {}, 'kappa': 0.04305799648506148, 'TN': 1, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:39:08,216 - INFO - 
fold number 3 / 3
2025-06-04 19:39:08,221 - INFO - train split size : 198
2025-06-04 19:39:08,221 - INFO - dev split size : 67
2025-06-04 19:39:08,221 - INFO - test split size : 132
2025-06-04 19:39:08,435 - INFO - X shape : (198, 10000)
2025-06-04 19:39:08,435 - INFO - y shape : (198,)
2025-06-04 19:39:09,005 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:39:12,099 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:39:12,104 - INFO - 
fold number 1 / 3
2025-06-04 19:39:12,109 - INFO - train split size : 198
2025-06-04 19:39:12,109 - INFO - dev split size : 66
2025-06-04 19:39:12,109 - INFO - test split size : 133
2025-06-04 19:39:12,337 - INFO - X shape : (198, 10000)
2025-06-04 19:39:12,337 - INFO - y shape : (198,)
2025-06-04 19:39:12,941 - INFO - Confusion matrix: TN=1, FP=34, FN=0, TP=98
2025-06-04 19:39:15,874 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7443609022556391, 'AP': {}, 'MCC': 0.14564381625088382, 'NDCG': {}, 'kappa': 0.041543026706231445, 'TN': 1, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:39:15,876 - INFO - 
fold number 2 / 3
2025-06-04 19:39:15,881 - INFO - train split size : 198
2025-06-04 19:39:15,882 - INFO - dev split size : 67
2025-06-04 19:39:15,882 - INFO - test split size : 132
2025-06-04 19:39:16,092 - INFO - X shape : (198, 10000)
2025-06-04 19:39:16,092 - INFO - y shape : (198,)
2025-06-04 19:39:16,678 - INFO - Confusion matrix: TN=1, FP=33, FN=0, TP=98
2025-06-04 19:39:19,561 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.14833305163534516, 'NDCG': {}, 'kappa': 0.04305799648506148, 'TN': 1, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:39:19,564 - INFO - 
fold number 3 / 3
2025-06-04 19:39:19,569 - INFO - train split size : 198
2025-06-04 19:39:19,569 - INFO - dev split size : 67
2025-06-04 19:39:19,569 - INFO - test split size : 132
2025-06-04 19:39:19,791 - INFO - X shape : (198, 10000)
2025-06-04 19:39:19,791 - INFO - y shape : (198,)
2025-06-04 19:39:20,364 - INFO - Confusion matrix: TN=2, FP=33, FN=0, TP=97
2025-06-04 19:39:23,304 - INFO - Metrics: {'f1': 0.8546255506607929, 'recall': 1.0, 'precision': 0.7461538461538462, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.20648816585306443, 'NDCG': {}, 'kappa': 0.08178752107925802, 'TN': 2, 'FP': 33, 'FN': 0, 'TP': 97}
2025-06-04 19:39:23,310 - INFO - 
fold number 1 / 3
2025-06-04 19:39:23,315 - INFO - train split size : 198
2025-06-04 19:39:23,315 - INFO - dev split size : 66
2025-06-04 19:39:23,315 - INFO - test split size : 133
2025-06-04 19:39:23,521 - INFO - X shape : (198, 10000)
2025-06-04 19:39:23,521 - INFO - y shape : (198,)
2025-06-04 19:39:24,087 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:39:26,968 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:39:26,971 - INFO - 
fold number 2 / 3
2025-06-04 19:39:26,976 - INFO - train split size : 198
2025-06-04 19:39:26,976 - INFO - dev split size : 67
2025-06-04 19:39:26,976 - INFO - test split size : 132
2025-06-04 19:39:27,165 - INFO - X shape : (198, 10000)
2025-06-04 19:39:27,165 - INFO - y shape : (198,)
2025-06-04 19:39:27,739 - INFO - Confusion matrix: TN=1, FP=33, FN=0, TP=98
2025-06-04 19:39:30,898 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.14833305163534516, 'NDCG': {}, 'kappa': 0.04305799648506148, 'TN': 1, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:39:30,901 - INFO - 
fold number 3 / 3
2025-06-04 19:39:30,906 - INFO - train split size : 198
2025-06-04 19:39:30,906 - INFO - dev split size : 67
2025-06-04 19:39:30,906 - INFO - test split size : 132
2025-06-04 19:39:31,114 - INFO - X shape : (198, 10000)
2025-06-04 19:39:31,115 - INFO - y shape : (198,)
2025-06-04 19:39:31,694 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:39:34,541 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:39:34,547 - INFO - 
fold number 1 / 3
2025-06-04 19:39:34,553 - INFO - train split size : 198
2025-06-04 19:39:34,553 - INFO - dev split size : 66
2025-06-04 19:39:34,553 - INFO - test split size : 133
2025-06-04 19:39:34,775 - INFO - X shape : (198, 10000)
2025-06-04 19:39:34,776 - INFO - y shape : (198,)
2025-06-04 19:39:35,350 - INFO - Confusion matrix: TN=1, FP=34, FN=0, TP=98
2025-06-04 19:39:38,286 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7443609022556391, 'AP': {}, 'MCC': 0.14564381625088382, 'NDCG': {}, 'kappa': 0.041543026706231445, 'TN': 1, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:39:38,289 - INFO - 
fold number 2 / 3
2025-06-04 19:39:38,294 - INFO - train split size : 198
2025-06-04 19:39:38,294 - INFO - dev split size : 67
2025-06-04 19:39:38,294 - INFO - test split size : 132
2025-06-04 19:39:38,520 - INFO - X shape : (198, 10000)
2025-06-04 19:39:38,522 - INFO - y shape : (198,)
2025-06-04 19:39:39,123 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:39:42,259 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:39:42,262 - INFO - 
fold number 3 / 3
2025-06-04 19:39:42,267 - INFO - train split size : 198
2025-06-04 19:39:42,267 - INFO - dev split size : 67
2025-06-04 19:39:42,267 - INFO - test split size : 132
2025-06-04 19:39:42,477 - INFO - X shape : (198, 10000)
2025-06-04 19:39:42,477 - INFO - y shape : (198,)
2025-06-04 19:39:43,051 - INFO - Confusion matrix: TN=2, FP=33, FN=0, TP=97
2025-06-04 19:39:45,926 - INFO - Metrics: {'f1': 0.8546255506607929, 'recall': 1.0, 'precision': 0.7461538461538462, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.20648816585306443, 'NDCG': {}, 'kappa': 0.08178752107925802, 'TN': 2, 'FP': 33, 'FN': 0, 'TP': 97}
2025-06-04 19:39:45,931 - INFO - 
fold number 1 / 3
2025-06-04 19:39:45,936 - INFO - train split size : 198
2025-06-04 19:39:45,936 - INFO - dev split size : 66
2025-06-04 19:39:45,936 - INFO - test split size : 133
2025-06-04 19:39:46,149 - INFO - X shape : (198, 10000)
2025-06-04 19:39:46,149 - INFO - y shape : (198,)
2025-06-04 19:39:46,724 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:39:49,385 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:39:49,388 - INFO - 
fold number 2 / 3
2025-06-04 19:39:49,393 - INFO - train split size : 198
2025-06-04 19:39:49,393 - INFO - dev split size : 67
2025-06-04 19:39:49,393 - INFO - test split size : 132
2025-06-04 19:39:49,594 - INFO - X shape : (198, 10000)
2025-06-04 19:39:49,594 - INFO - y shape : (198,)
2025-06-04 19:39:50,169 - INFO - Confusion matrix: TN=1, FP=33, FN=0, TP=98
2025-06-04 19:39:53,011 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.14833305163534516, 'NDCG': {}, 'kappa': 0.04305799648506148, 'TN': 1, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:39:53,014 - INFO - 
fold number 3 / 3
2025-06-04 19:39:53,019 - INFO - train split size : 198
2025-06-04 19:39:53,019 - INFO - dev split size : 67
2025-06-04 19:39:53,019 - INFO - test split size : 132
2025-06-04 19:39:53,225 - INFO - X shape : (198, 10000)
2025-06-04 19:39:53,225 - INFO - y shape : (198,)
2025-06-04 19:39:53,805 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:39:56,602 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:39:56,609 - INFO - 
fold number 1 / 3
2025-06-04 19:39:56,616 - INFO - train split size : 198
2025-06-04 19:39:56,616 - INFO - dev split size : 66
2025-06-04 19:39:56,616 - INFO - test split size : 133
2025-06-04 19:39:56,868 - INFO - X shape : (198, 10000)
2025-06-04 19:39:56,868 - INFO - y shape : (198,)
2025-06-04 19:39:57,631 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:40:00,857 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:40:00,859 - INFO - 
fold number 2 / 3
2025-06-04 19:40:00,864 - INFO - train split size : 198
2025-06-04 19:40:00,864 - INFO - dev split size : 67
2025-06-04 19:40:00,865 - INFO - test split size : 132
2025-06-04 19:40:01,072 - INFO - X shape : (198, 10000)
2025-06-04 19:40:01,072 - INFO - y shape : (198,)
2025-06-04 19:40:01,836 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:40:04,821 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:40:04,823 - INFO - 
fold number 3 / 3
2025-06-04 19:40:04,828 - INFO - train split size : 198
2025-06-04 19:40:04,829 - INFO - dev split size : 67
2025-06-04 19:40:04,829 - INFO - test split size : 132
2025-06-04 19:40:05,034 - INFO - X shape : (198, 10000)
2025-06-04 19:40:05,034 - INFO - y shape : (198,)
2025-06-04 19:40:05,788 - INFO - Confusion matrix: TN=2, FP=33, FN=0, TP=97
2025-06-04 19:40:08,756 - INFO - Metrics: {'f1': 0.8546255506607929, 'recall': 1.0, 'precision': 0.7461538461538462, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.20648816585306443, 'NDCG': {}, 'kappa': 0.08178752107925802, 'TN': 2, 'FP': 33, 'FN': 0, 'TP': 97}
2025-06-04 19:40:08,761 - INFO - 
fold number 1 / 3
2025-06-04 19:40:08,767 - INFO - train split size : 198
2025-06-04 19:40:08,767 - INFO - dev split size : 66
2025-06-04 19:40:08,767 - INFO - test split size : 133
2025-06-04 19:40:08,972 - INFO - X shape : (198, 10000)
2025-06-04 19:40:08,972 - INFO - y shape : (198,)
2025-06-04 19:40:09,728 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:40:12,652 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:40:12,654 - INFO - 
fold number 2 / 3
2025-06-04 19:40:12,659 - INFO - train split size : 198
2025-06-04 19:40:12,660 - INFO - dev split size : 67
2025-06-04 19:40:12,660 - INFO - test split size : 132
2025-06-04 19:40:12,855 - INFO - X shape : (198, 10000)
2025-06-04 19:40:12,856 - INFO - y shape : (198,)
2025-06-04 19:40:13,636 - INFO - Confusion matrix: TN=1, FP=33, FN=0, TP=98
2025-06-04 19:40:16,586 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.14833305163534516, 'NDCG': {}, 'kappa': 0.04305799648506148, 'TN': 1, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:40:16,589 - INFO - 
fold number 3 / 3
2025-06-04 19:40:16,594 - INFO - train split size : 198
2025-06-04 19:40:16,594 - INFO - dev split size : 67
2025-06-04 19:40:16,594 - INFO - test split size : 132
2025-06-04 19:40:16,790 - INFO - X shape : (198, 10000)
2025-06-04 19:40:16,790 - INFO - y shape : (198,)
2025-06-04 19:40:17,552 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:40:20,576 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:40:20,581 - INFO - 
fold number 1 / 3
2025-06-04 19:40:20,586 - INFO - train split size : 198
2025-06-04 19:40:20,587 - INFO - dev split size : 66
2025-06-04 19:40:20,587 - INFO - test split size : 133
2025-06-04 19:40:20,783 - INFO - X shape : (198, 10000)
2025-06-04 19:40:20,783 - INFO - y shape : (198,)
2025-06-04 19:40:21,562 - INFO - Confusion matrix: TN=1, FP=34, FN=0, TP=98
2025-06-04 19:40:24,399 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7443609022556391, 'AP': {}, 'MCC': 0.14564381625088382, 'NDCG': {}, 'kappa': 0.041543026706231445, 'TN': 1, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:40:24,401 - INFO - 
fold number 2 / 3
2025-06-04 19:40:24,406 - INFO - train split size : 198
2025-06-04 19:40:24,406 - INFO - dev split size : 67
2025-06-04 19:40:24,406 - INFO - test split size : 132
2025-06-04 19:40:25,073 - INFO - X shape : (198, 10000)
2025-06-04 19:40:25,074 - INFO - y shape : (198,)
2025-06-04 19:40:25,823 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:40:28,802 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:40:28,804 - INFO - 
fold number 3 / 3
2025-06-04 19:40:28,809 - INFO - train split size : 198
2025-06-04 19:40:28,810 - INFO - dev split size : 67
2025-06-04 19:40:28,810 - INFO - test split size : 132
2025-06-04 19:40:29,026 - INFO - X shape : (198, 10000)
2025-06-04 19:40:29,026 - INFO - y shape : (198,)
2025-06-04 19:40:29,778 - INFO - Confusion matrix: TN=2, FP=33, FN=0, TP=97
2025-06-04 19:40:32,508 - INFO - Metrics: {'f1': 0.8546255506607929, 'recall': 1.0, 'precision': 0.7461538461538462, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.20648816585306443, 'NDCG': {}, 'kappa': 0.08178752107925802, 'TN': 2, 'FP': 33, 'FN': 0, 'TP': 97}
2025-06-04 19:40:32,514 - INFO - 
fold number 1 / 3
2025-06-04 19:40:32,519 - INFO - train split size : 198
2025-06-04 19:40:32,519 - INFO - dev split size : 66
2025-06-04 19:40:32,519 - INFO - test split size : 133
2025-06-04 19:40:32,733 - INFO - X shape : (198, 10000)
2025-06-04 19:40:32,734 - INFO - y shape : (198,)
2025-06-04 19:40:33,493 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:40:36,270 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:40:36,273 - INFO - 
fold number 2 / 3
2025-06-04 19:40:36,279 - INFO - train split size : 198
2025-06-04 19:40:36,279 - INFO - dev split size : 67
2025-06-04 19:40:36,279 - INFO - test split size : 132
2025-06-04 19:40:36,488 - INFO - X shape : (198, 10000)
2025-06-04 19:40:36,488 - INFO - y shape : (198,)
2025-06-04 19:40:37,239 - INFO - Confusion matrix: TN=1, FP=33, FN=0, TP=98
2025-06-04 19:40:41,142 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.14833305163534516, 'NDCG': {}, 'kappa': 0.04305799648506148, 'TN': 1, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:40:41,144 - INFO - 
fold number 3 / 3
2025-06-04 19:40:41,150 - INFO - train split size : 198
2025-06-04 19:40:41,150 - INFO - dev split size : 67
2025-06-04 19:40:41,150 - INFO - test split size : 132
2025-06-04 19:40:41,353 - INFO - X shape : (198, 10000)
2025-06-04 19:40:41,353 - INFO - y shape : (198,)
2025-06-04 19:40:42,104 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:40:44,861 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:40:44,866 - INFO - 
fold number 1 / 3
2025-06-04 19:40:44,871 - INFO - train split size : 198
2025-06-04 19:40:44,871 - INFO - dev split size : 66
2025-06-04 19:40:44,871 - INFO - test split size : 133
2025-06-04 19:40:45,078 - INFO - X shape : (198, 10000)
2025-06-04 19:40:45,078 - INFO - y shape : (198,)
2025-06-04 19:40:45,842 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:40:48,806 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:40:48,809 - INFO - 
fold number 2 / 3
2025-06-04 19:40:48,814 - INFO - train split size : 198
2025-06-04 19:40:48,814 - INFO - dev split size : 67
2025-06-04 19:40:48,814 - INFO - test split size : 132
2025-06-04 19:40:49,017 - INFO - X shape : (198, 10000)
2025-06-04 19:40:49,017 - INFO - y shape : (198,)
2025-06-04 19:40:49,761 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:40:52,524 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:40:52,526 - INFO - 
fold number 3 / 3
2025-06-04 19:40:52,531 - INFO - train split size : 198
2025-06-04 19:40:52,531 - INFO - dev split size : 67
2025-06-04 19:40:52,531 - INFO - test split size : 132
2025-06-04 19:40:52,735 - INFO - X shape : (198, 10000)
2025-06-04 19:40:52,736 - INFO - y shape : (198,)
2025-06-04 19:40:53,497 - INFO - Confusion matrix: TN=2, FP=33, FN=0, TP=97
2025-06-04 19:40:56,265 - INFO - Metrics: {'f1': 0.8546255506607929, 'recall': 1.0, 'precision': 0.7461538461538462, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.20648816585306443, 'NDCG': {}, 'kappa': 0.08178752107925802, 'TN': 2, 'FP': 33, 'FN': 0, 'TP': 97}
2025-06-04 19:40:56,270 - INFO - 
fold number 1 / 3
2025-06-04 19:40:56,275 - INFO - train split size : 198
2025-06-04 19:40:56,275 - INFO - dev split size : 66
2025-06-04 19:40:56,275 - INFO - test split size : 133
2025-06-04 19:40:56,496 - INFO - X shape : (198, 10000)
2025-06-04 19:40:56,496 - INFO - y shape : (198,)
2025-06-04 19:40:57,229 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:41:00,090 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:41:00,093 - INFO - 
fold number 2 / 3
2025-06-04 19:41:00,098 - INFO - train split size : 198
2025-06-04 19:41:00,099 - INFO - dev split size : 67
2025-06-04 19:41:00,099 - INFO - test split size : 132
2025-06-04 19:41:00,299 - INFO - X shape : (198, 10000)
2025-06-04 19:41:00,299 - INFO - y shape : (198,)
2025-06-04 19:41:01,053 - INFO - Confusion matrix: TN=1, FP=33, FN=0, TP=98
2025-06-04 19:41:03,925 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.14833305163534516, 'NDCG': {}, 'kappa': 0.04305799648506148, 'TN': 1, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:41:03,928 - INFO - 
fold number 3 / 3
2025-06-04 19:41:03,933 - INFO - train split size : 198
2025-06-04 19:41:03,933 - INFO - dev split size : 67
2025-06-04 19:41:03,933 - INFO - test split size : 132
2025-06-04 19:41:04,155 - INFO - X shape : (198, 10000)
2025-06-04 19:41:04,155 - INFO - y shape : (198,)
2025-06-04 19:41:04,922 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:41:07,843 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:41:07,848 - INFO - 
fold number 1 / 3
2025-06-04 19:41:07,854 - INFO - train split size : 198
2025-06-04 19:41:07,854 - INFO - dev split size : 66
2025-06-04 19:41:07,854 - INFO - test split size : 133
2025-06-04 19:41:08,063 - INFO - X shape : (198, 10000)
2025-06-04 19:41:08,063 - INFO - y shape : (198,)
2025-06-04 19:41:08,999 - INFO - Confusion matrix: TN=1, FP=34, FN=0, TP=98
2025-06-04 19:41:11,740 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7443609022556391, 'AP': {}, 'MCC': 0.14564381625088382, 'NDCG': {}, 'kappa': 0.041543026706231445, 'TN': 1, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:41:11,743 - INFO - 
fold number 2 / 3
2025-06-04 19:41:11,748 - INFO - train split size : 198
2025-06-04 19:41:11,748 - INFO - dev split size : 67
2025-06-04 19:41:11,748 - INFO - test split size : 132
2025-06-04 19:41:11,956 - INFO - X shape : (198, 10000)
2025-06-04 19:41:11,956 - INFO - y shape : (198,)
2025-06-04 19:41:12,896 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:41:15,629 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:41:15,631 - INFO - 
fold number 3 / 3
2025-06-04 19:41:15,636 - INFO - train split size : 198
2025-06-04 19:41:15,636 - INFO - dev split size : 67
2025-06-04 19:41:15,636 - INFO - test split size : 132
2025-06-04 19:41:15,844 - INFO - X shape : (198, 10000)
2025-06-04 19:41:15,844 - INFO - y shape : (198,)
2025-06-04 19:41:16,737 - INFO - Confusion matrix: TN=2, FP=33, FN=0, TP=97
2025-06-04 19:41:19,730 - INFO - Metrics: {'f1': 0.8546255506607929, 'recall': 1.0, 'precision': 0.7461538461538462, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.20648816585306443, 'NDCG': {}, 'kappa': 0.08178752107925802, 'TN': 2, 'FP': 33, 'FN': 0, 'TP': 97}
2025-06-04 19:41:19,735 - INFO - 
fold number 1 / 3
2025-06-04 19:41:19,740 - INFO - train split size : 198
2025-06-04 19:41:19,740 - INFO - dev split size : 66
2025-06-04 19:41:19,740 - INFO - test split size : 133
2025-06-04 19:41:19,954 - INFO - X shape : (198, 10000)
2025-06-04 19:41:19,954 - INFO - y shape : (198,)
2025-06-04 19:41:20,903 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:41:24,223 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:41:24,225 - INFO - 
fold number 2 / 3
2025-06-04 19:41:24,230 - INFO - train split size : 198
2025-06-04 19:41:24,231 - INFO - dev split size : 67
2025-06-04 19:41:24,231 - INFO - test split size : 132
2025-06-04 19:41:24,435 - INFO - X shape : (198, 10000)
2025-06-04 19:41:24,435 - INFO - y shape : (198,)
2025-06-04 19:41:25,340 - INFO - Confusion matrix: TN=1, FP=33, FN=0, TP=98
2025-06-04 19:41:28,369 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.14833305163534516, 'NDCG': {}, 'kappa': 0.04305799648506148, 'TN': 1, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:41:28,372 - INFO - 
fold number 3 / 3
2025-06-04 19:41:28,376 - INFO - train split size : 198
2025-06-04 19:41:28,376 - INFO - dev split size : 67
2025-06-04 19:41:28,377 - INFO - test split size : 132
2025-06-04 19:41:28,569 - INFO - X shape : (198, 10000)
2025-06-04 19:41:28,569 - INFO - y shape : (198,)
2025-06-04 19:41:29,465 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:41:32,253 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:41:32,259 - INFO - 
fold number 1 / 3
2025-06-04 19:41:32,264 - INFO - train split size : 198
2025-06-04 19:41:32,264 - INFO - dev split size : 66
2025-06-04 19:41:32,264 - INFO - test split size : 133
2025-06-04 19:41:32,470 - INFO - X shape : (198, 10000)
2025-06-04 19:41:32,470 - INFO - y shape : (198,)
2025-06-04 19:41:33,402 - INFO - Confusion matrix: TN=1, FP=34, FN=0, TP=98
2025-06-04 19:41:37,706 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7443609022556391, 'AP': {}, 'MCC': 0.14564381625088382, 'NDCG': {}, 'kappa': 0.041543026706231445, 'TN': 1, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:41:37,709 - INFO - 
fold number 2 / 3
2025-06-04 19:41:37,714 - INFO - train split size : 198
2025-06-04 19:41:37,714 - INFO - dev split size : 67
2025-06-04 19:41:37,714 - INFO - test split size : 132
2025-06-04 19:41:37,921 - INFO - X shape : (198, 10000)
2025-06-04 19:41:37,921 - INFO - y shape : (198,)
2025-06-04 19:41:38,833 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:41:41,617 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:41:41,621 - INFO - 
fold number 3 / 3
2025-06-04 19:41:41,626 - INFO - train split size : 198
2025-06-04 19:41:41,626 - INFO - dev split size : 67
2025-06-04 19:41:41,626 - INFO - test split size : 132
2025-06-04 19:41:41,840 - INFO - X shape : (198, 10000)
2025-06-04 19:41:41,840 - INFO - y shape : (198,)
2025-06-04 19:41:42,751 - INFO - Confusion matrix: TN=2, FP=33, FN=0, TP=97
2025-06-04 19:41:45,939 - INFO - Metrics: {'f1': 0.8546255506607929, 'recall': 1.0, 'precision': 0.7461538461538462, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.20648816585306443, 'NDCG': {}, 'kappa': 0.08178752107925802, 'TN': 2, 'FP': 33, 'FN': 0, 'TP': 97}
2025-06-04 19:41:45,950 - INFO - 
fold number 1 / 3
2025-06-04 19:41:45,955 - INFO - train split size : 198
2025-06-04 19:41:45,955 - INFO - dev split size : 66
2025-06-04 19:41:45,955 - INFO - test split size : 133
2025-06-04 19:41:46,168 - INFO - X shape : (198, 10000)
2025-06-04 19:41:46,168 - INFO - y shape : (198,)
2025-06-04 19:41:47,088 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:41:50,026 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:41:50,030 - INFO - 
fold number 2 / 3
2025-06-04 19:41:50,036 - INFO - train split size : 198
2025-06-04 19:41:50,036 - INFO - dev split size : 67
2025-06-04 19:41:50,036 - INFO - test split size : 132
2025-06-04 19:41:50,245 - INFO - X shape : (198, 10000)
2025-06-04 19:41:50,245 - INFO - y shape : (198,)
2025-06-04 19:41:51,171 - INFO - Confusion matrix: TN=1, FP=33, FN=0, TP=98
2025-06-04 19:41:55,093 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.14833305163534516, 'NDCG': {}, 'kappa': 0.04305799648506148, 'TN': 1, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:41:55,095 - INFO - 
fold number 3 / 3
2025-06-04 19:41:55,100 - INFO - train split size : 198
2025-06-04 19:41:55,101 - INFO - dev split size : 67
2025-06-04 19:41:55,101 - INFO - test split size : 132
2025-06-04 19:41:55,304 - INFO - X shape : (198, 10000)
2025-06-04 19:41:55,304 - INFO - y shape : (198,)
2025-06-04 19:41:56,231 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:41:59,049 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:41:59,054 - INFO - 
fold number 1 / 3
2025-06-04 19:41:59,060 - INFO - train split size : 198
2025-06-04 19:41:59,060 - INFO - dev split size : 66
2025-06-04 19:41:59,060 - INFO - test split size : 133
2025-06-04 19:41:59,255 - INFO - X shape : (198, 10000)
2025-06-04 19:41:59,256 - INFO - y shape : (198,)
2025-06-04 19:42:00,152 - INFO - Confusion matrix: TN=1, FP=34, FN=0, TP=98
2025-06-04 19:42:04,070 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7443609022556391, 'AP': {}, 'MCC': 0.14564381625088382, 'NDCG': {}, 'kappa': 0.041543026706231445, 'TN': 1, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:42:04,072 - INFO - 
fold number 2 / 3
2025-06-04 19:42:04,079 - INFO - train split size : 198
2025-06-04 19:42:04,079 - INFO - dev split size : 67
2025-06-04 19:42:04,079 - INFO - test split size : 132
2025-06-04 19:42:04,293 - INFO - X shape : (198, 10000)
2025-06-04 19:42:04,293 - INFO - y shape : (198,)
2025-06-04 19:42:05,202 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:42:07,937 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:42:07,940 - INFO - 
fold number 3 / 3
2025-06-04 19:42:07,945 - INFO - train split size : 198
2025-06-04 19:42:07,945 - INFO - dev split size : 67
2025-06-04 19:42:07,945 - INFO - test split size : 132
2025-06-04 19:42:08,151 - INFO - X shape : (198, 10000)
2025-06-04 19:42:08,151 - INFO - y shape : (198,)
2025-06-04 19:42:09,095 - INFO - Confusion matrix: TN=2, FP=33, FN=0, TP=97
2025-06-04 19:42:12,044 - INFO - Metrics: {'f1': 0.8546255506607929, 'recall': 1.0, 'precision': 0.7461538461538462, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.20648816585306443, 'NDCG': {}, 'kappa': 0.08178752107925802, 'TN': 2, 'FP': 33, 'FN': 0, 'TP': 97}
2025-06-04 19:42:12,051 - INFO - 
fold number 1 / 3
2025-06-04 19:42:12,056 - INFO - train split size : 198
2025-06-04 19:42:12,056 - INFO - dev split size : 66
2025-06-04 19:42:12,056 - INFO - test split size : 133
2025-06-04 19:42:12,269 - INFO - X shape : (198, 10000)
2025-06-04 19:42:12,269 - INFO - y shape : (198,)
2025-06-04 19:42:13,199 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:42:16,220 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:42:16,223 - INFO - 
fold number 2 / 3
2025-06-04 19:42:16,228 - INFO - train split size : 198
2025-06-04 19:42:16,228 - INFO - dev split size : 67
2025-06-04 19:42:16,228 - INFO - test split size : 132
2025-06-04 19:42:16,419 - INFO - X shape : (198, 10000)
2025-06-04 19:42:16,419 - INFO - y shape : (198,)
2025-06-04 19:42:17,324 - INFO - Confusion matrix: TN=1, FP=33, FN=0, TP=98
2025-06-04 19:42:21,135 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.14833305163534516, 'NDCG': {}, 'kappa': 0.04305799648506148, 'TN': 1, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:42:21,138 - INFO - 
fold number 3 / 3
2025-06-04 19:42:21,143 - INFO - train split size : 198
2025-06-04 19:42:21,143 - INFO - dev split size : 67
2025-06-04 19:42:21,143 - INFO - test split size : 132
2025-06-04 19:42:21,360 - INFO - X shape : (198, 10000)
2025-06-04 19:42:21,360 - INFO - y shape : (198,)
2025-06-04 19:42:22,269 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:42:24,996 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:42:25,001 - INFO - 
fold number 1 / 3
2025-06-04 19:42:25,007 - INFO - train split size : 198
2025-06-04 19:42:25,007 - INFO - dev split size : 66
2025-06-04 19:42:25,007 - INFO - test split size : 133
2025-06-04 19:42:25,242 - INFO - X shape : (198, 10000)
2025-06-04 19:42:25,242 - INFO - y shape : (198,)
2025-06-04 19:42:26,391 - INFO - Confusion matrix: TN=1, FP=34, FN=0, TP=98
2025-06-04 19:42:29,163 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7443609022556391, 'AP': {}, 'MCC': 0.14564381625088382, 'NDCG': {}, 'kappa': 0.041543026706231445, 'TN': 1, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:42:29,166 - INFO - 
fold number 2 / 3
2025-06-04 19:42:29,172 - INFO - train split size : 198
2025-06-04 19:42:29,172 - INFO - dev split size : 67
2025-06-04 19:42:29,172 - INFO - test split size : 132
2025-06-04 19:42:29,382 - INFO - X shape : (198, 10000)
2025-06-04 19:42:29,382 - INFO - y shape : (198,)
2025-06-04 19:42:30,493 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:42:33,272 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:42:33,275 - INFO - 
fold number 3 / 3
2025-06-04 19:42:33,280 - INFO - train split size : 198
2025-06-04 19:42:33,280 - INFO - dev split size : 67
2025-06-04 19:42:33,280 - INFO - test split size : 132
2025-06-04 19:42:33,477 - INFO - X shape : (198, 10000)
2025-06-04 19:42:33,477 - INFO - y shape : (198,)
2025-06-04 19:42:34,562 - INFO - Confusion matrix: TN=2, FP=33, FN=0, TP=97
2025-06-04 19:42:37,298 - INFO - Metrics: {'f1': 0.8546255506607929, 'recall': 1.0, 'precision': 0.7461538461538462, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.20648816585306443, 'NDCG': {}, 'kappa': 0.08178752107925802, 'TN': 2, 'FP': 33, 'FN': 0, 'TP': 97}
2025-06-04 19:42:37,305 - INFO - 
fold number 1 / 3
2025-06-04 19:42:37,310 - INFO - train split size : 198
2025-06-04 19:42:37,310 - INFO - dev split size : 66
2025-06-04 19:42:37,310 - INFO - test split size : 133
2025-06-04 19:42:37,509 - INFO - X shape : (198, 10000)
2025-06-04 19:42:37,509 - INFO - y shape : (198,)
2025-06-04 19:42:38,627 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:42:41,376 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:42:41,380 - INFO - 
fold number 2 / 3
2025-06-04 19:42:41,384 - INFO - train split size : 198
2025-06-04 19:42:41,385 - INFO - dev split size : 67
2025-06-04 19:42:41,385 - INFO - test split size : 132
2025-06-04 19:42:41,576 - INFO - X shape : (198, 10000)
2025-06-04 19:42:41,576 - INFO - y shape : (198,)
2025-06-04 19:42:42,648 - INFO - Confusion matrix: TN=1, FP=33, FN=0, TP=98
2025-06-04 19:42:45,404 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.14833305163534516, 'NDCG': {}, 'kappa': 0.04305799648506148, 'TN': 1, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:42:45,406 - INFO - 
fold number 3 / 3
2025-06-04 19:42:45,412 - INFO - train split size : 198
2025-06-04 19:42:45,412 - INFO - dev split size : 67
2025-06-04 19:42:45,412 - INFO - test split size : 132
2025-06-04 19:42:45,613 - INFO - X shape : (198, 10000)
2025-06-04 19:42:45,613 - INFO - y shape : (198,)
2025-06-04 19:42:46,671 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:42:50,525 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:42:50,530 - INFO - 
fold number 1 / 3
2025-06-04 19:42:50,536 - INFO - train split size : 198
2025-06-04 19:42:50,536 - INFO - dev split size : 66
2025-06-04 19:42:50,536 - INFO - test split size : 133
2025-06-04 19:42:50,731 - INFO - X shape : (198, 10000)
2025-06-04 19:42:50,731 - INFO - y shape : (198,)
2025-06-04 19:42:51,810 - INFO - Confusion matrix: TN=1, FP=34, FN=0, TP=98
2025-06-04 19:42:54,667 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7443609022556391, 'AP': {}, 'MCC': 0.14564381625088382, 'NDCG': {}, 'kappa': 0.041543026706231445, 'TN': 1, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:42:54,672 - INFO - 
fold number 2 / 3
2025-06-04 19:42:54,677 - INFO - train split size : 198
2025-06-04 19:42:54,677 - INFO - dev split size : 67
2025-06-04 19:42:54,677 - INFO - test split size : 132
2025-06-04 19:42:54,900 - INFO - X shape : (198, 10000)
2025-06-04 19:42:54,901 - INFO - y shape : (198,)
2025-06-04 19:42:55,956 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:42:59,023 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:42:59,026 - INFO - 
fold number 3 / 3
2025-06-04 19:42:59,030 - INFO - train split size : 198
2025-06-04 19:42:59,030 - INFO - dev split size : 67
2025-06-04 19:42:59,030 - INFO - test split size : 132
2025-06-04 19:42:59,234 - INFO - X shape : (198, 10000)
2025-06-04 19:42:59,234 - INFO - y shape : (198,)
2025-06-04 19:43:00,275 - INFO - Confusion matrix: TN=2, FP=33, FN=0, TP=97
2025-06-04 19:43:03,050 - INFO - Metrics: {'f1': 0.8546255506607929, 'recall': 1.0, 'precision': 0.7461538461538462, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.20648816585306443, 'NDCG': {}, 'kappa': 0.08178752107925802, 'TN': 2, 'FP': 33, 'FN': 0, 'TP': 97}
2025-06-04 19:43:03,057 - INFO - 
fold number 1 / 3
2025-06-04 19:43:03,062 - INFO - train split size : 198
2025-06-04 19:43:03,062 - INFO - dev split size : 66
2025-06-04 19:43:03,062 - INFO - test split size : 133
2025-06-04 19:43:03,286 - INFO - X shape : (198, 10000)
2025-06-04 19:43:03,286 - INFO - y shape : (198,)
2025-06-04 19:43:04,360 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:43:07,495 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:43:07,499 - INFO - 
fold number 2 / 3
2025-06-04 19:43:07,504 - INFO - train split size : 198
2025-06-04 19:43:07,504 - INFO - dev split size : 67
2025-06-04 19:43:07,504 - INFO - test split size : 132
2025-06-04 19:43:07,715 - INFO - X shape : (198, 10000)
2025-06-04 19:43:07,715 - INFO - y shape : (198,)
2025-06-04 19:43:08,805 - INFO - Confusion matrix: TN=1, FP=33, FN=0, TP=98
2025-06-04 19:43:11,730 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.14833305163534516, 'NDCG': {}, 'kappa': 0.04305799648506148, 'TN': 1, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:43:11,732 - INFO - 
fold number 3 / 3
2025-06-04 19:43:11,737 - INFO - train split size : 198
2025-06-04 19:43:11,737 - INFO - dev split size : 67
2025-06-04 19:43:11,737 - INFO - test split size : 132
2025-06-04 19:43:11,933 - INFO - X shape : (198, 10000)
2025-06-04 19:43:11,933 - INFO - y shape : (198,)
2025-06-04 19:43:13,016 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:43:15,911 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:43:15,922 - INFO - 
fold number 1 / 3
2025-06-04 19:43:15,927 - INFO - train split size : 198
2025-06-04 19:43:15,927 - INFO - dev split size : 66
2025-06-04 19:43:15,927 - INFO - test split size : 133
2025-06-04 19:43:16,135 - INFO - X shape : (198, 10000)
2025-06-04 19:43:16,135 - INFO - y shape : (198,)
2025-06-04 19:43:17,179 - INFO - Confusion matrix: TN=1, FP=34, FN=0, TP=98
2025-06-04 19:43:20,067 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7443609022556391, 'AP': {}, 'MCC': 0.14564381625088382, 'NDCG': {}, 'kappa': 0.041543026706231445, 'TN': 1, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:43:20,072 - INFO - 
fold number 2 / 3
2025-06-04 19:43:20,077 - INFO - train split size : 198
2025-06-04 19:43:20,077 - INFO - dev split size : 67
2025-06-04 19:43:20,077 - INFO - test split size : 132
2025-06-04 19:43:20,289 - INFO - X shape : (198, 10000)
2025-06-04 19:43:20,289 - INFO - y shape : (198,)
2025-06-04 19:43:21,352 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:43:24,193 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:43:24,196 - INFO - 
fold number 3 / 3
2025-06-04 19:43:24,204 - INFO - train split size : 198
2025-06-04 19:43:24,205 - INFO - dev split size : 67
2025-06-04 19:43:24,205 - INFO - test split size : 132
2025-06-04 19:43:24,411 - INFO - X shape : (198, 10000)
2025-06-04 19:43:24,411 - INFO - y shape : (198,)
2025-06-04 19:43:25,482 - INFO - Confusion matrix: TN=2, FP=33, FN=0, TP=97
2025-06-04 19:43:28,314 - INFO - Metrics: {'f1': 0.8546255506607929, 'recall': 1.0, 'precision': 0.7461538461538462, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.20648816585306443, 'NDCG': {}, 'kappa': 0.08178752107925802, 'TN': 2, 'FP': 33, 'FN': 0, 'TP': 97}
2025-06-04 19:43:28,319 - INFO - 
fold number 1 / 3
2025-06-04 19:43:28,324 - INFO - train split size : 198
2025-06-04 19:43:28,325 - INFO - dev split size : 66
2025-06-04 19:43:28,325 - INFO - test split size : 133
2025-06-04 19:43:28,534 - INFO - X shape : (198, 10000)
2025-06-04 19:43:28,534 - INFO - y shape : (198,)
2025-06-04 19:43:29,613 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:43:32,424 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:43:32,428 - INFO - 
fold number 2 / 3
2025-06-04 19:43:32,433 - INFO - train split size : 198
2025-06-04 19:43:32,433 - INFO - dev split size : 67
2025-06-04 19:43:32,433 - INFO - test split size : 132
2025-06-04 19:43:32,646 - INFO - X shape : (198, 10000)
2025-06-04 19:43:32,646 - INFO - y shape : (198,)
2025-06-04 19:43:33,720 - INFO - Confusion matrix: TN=1, FP=33, FN=0, TP=98
2025-06-04 19:43:36,504 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.14833305163534516, 'NDCG': {}, 'kappa': 0.04305799648506148, 'TN': 1, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:43:36,507 - INFO - 
fold number 3 / 3
2025-06-04 19:43:36,512 - INFO - train split size : 198
2025-06-04 19:43:36,512 - INFO - dev split size : 67
2025-06-04 19:43:36,512 - INFO - test split size : 132
2025-06-04 19:43:36,715 - INFO - X shape : (198, 10000)
2025-06-04 19:43:36,716 - INFO - y shape : (198,)
2025-06-04 19:43:37,808 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:43:40,615 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:43:40,620 - INFO - 
fold number 1 / 3
2025-06-04 19:43:40,625 - INFO - train split size : 198
2025-06-04 19:43:40,625 - INFO - dev split size : 66
2025-06-04 19:43:40,625 - INFO - test split size : 133
2025-06-04 19:43:40,835 - INFO - X shape : (198, 10000)
2025-06-04 19:43:40,836 - INFO - y shape : (198,)
2025-06-04 19:43:42,065 - INFO - Confusion matrix: TN=1, FP=34, FN=0, TP=98
2025-06-04 19:43:44,960 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7443609022556391, 'AP': {}, 'MCC': 0.14564381625088382, 'NDCG': {}, 'kappa': 0.041543026706231445, 'TN': 1, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:43:44,962 - INFO - 
fold number 2 / 3
2025-06-04 19:43:44,967 - INFO - train split size : 198
2025-06-04 19:43:44,968 - INFO - dev split size : 67
2025-06-04 19:43:44,968 - INFO - test split size : 132
2025-06-04 19:43:45,172 - INFO - X shape : (198, 10000)
2025-06-04 19:43:45,172 - INFO - y shape : (198,)
2025-06-04 19:43:46,392 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:43:49,314 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:43:49,317 - INFO - 
fold number 3 / 3
2025-06-04 19:43:49,322 - INFO - train split size : 198
2025-06-04 19:43:49,322 - INFO - dev split size : 67
2025-06-04 19:43:49,322 - INFO - test split size : 132
2025-06-04 19:43:49,536 - INFO - X shape : (198, 10000)
2025-06-04 19:43:49,536 - INFO - y shape : (198,)
2025-06-04 19:43:50,775 - INFO - Confusion matrix: TN=2, FP=33, FN=0, TP=97
2025-06-04 19:43:53,565 - INFO - Metrics: {'f1': 0.8546255506607929, 'recall': 1.0, 'precision': 0.7461538461538462, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.20648816585306443, 'NDCG': {}, 'kappa': 0.08178752107925802, 'TN': 2, 'FP': 33, 'FN': 0, 'TP': 97}
2025-06-04 19:43:53,574 - INFO - 
fold number 1 / 3
2025-06-04 19:43:53,579 - INFO - train split size : 198
2025-06-04 19:43:53,579 - INFO - dev split size : 66
2025-06-04 19:43:53,579 - INFO - test split size : 133
2025-06-04 19:43:53,794 - INFO - X shape : (198, 10000)
2025-06-04 19:43:53,794 - INFO - y shape : (198,)
2025-06-04 19:43:55,033 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:43:58,064 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:43:58,068 - INFO - 
fold number 2 / 3
2025-06-04 19:43:58,073 - INFO - train split size : 198
2025-06-04 19:43:58,074 - INFO - dev split size : 67
2025-06-04 19:43:58,074 - INFO - test split size : 132
2025-06-04 19:43:58,283 - INFO - X shape : (198, 10000)
2025-06-04 19:43:58,283 - INFO - y shape : (198,)
2025-06-04 19:43:59,518 - INFO - Confusion matrix: TN=1, FP=33, FN=0, TP=98
2025-06-04 19:44:03,301 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.14833305163534516, 'NDCG': {}, 'kappa': 0.04305799648506148, 'TN': 1, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:44:03,304 - INFO - 
fold number 3 / 3
2025-06-04 19:44:03,309 - INFO - train split size : 198
2025-06-04 19:44:03,309 - INFO - dev split size : 67
2025-06-04 19:44:03,309 - INFO - test split size : 132
2025-06-04 19:44:03,515 - INFO - X shape : (198, 10000)
2025-06-04 19:44:03,516 - INFO - y shape : (198,)
2025-06-04 19:44:04,735 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:44:07,693 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:44:07,699 - INFO - 
fold number 1 / 3
2025-06-04 19:44:07,704 - INFO - train split size : 198
2025-06-04 19:44:07,704 - INFO - dev split size : 66
2025-06-04 19:44:07,705 - INFO - test split size : 133
2025-06-04 19:44:07,918 - INFO - X shape : (198, 10000)
2025-06-04 19:44:07,919 - INFO - y shape : (198,)
2025-06-04 19:44:09,191 - INFO - Confusion matrix: TN=1, FP=34, FN=0, TP=98
2025-06-04 19:44:12,684 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7443609022556391, 'AP': {}, 'MCC': 0.14564381625088382, 'NDCG': {}, 'kappa': 0.041543026706231445, 'TN': 1, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:44:12,687 - INFO - 
fold number 2 / 3
2025-06-04 19:44:12,692 - INFO - train split size : 198
2025-06-04 19:44:12,692 - INFO - dev split size : 67
2025-06-04 19:44:12,692 - INFO - test split size : 132
2025-06-04 19:44:12,911 - INFO - X shape : (198, 10000)
2025-06-04 19:44:12,911 - INFO - y shape : (198,)
2025-06-04 19:44:14,182 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:44:17,232 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:44:17,235 - INFO - 
fold number 3 / 3
2025-06-04 19:44:17,240 - INFO - train split size : 198
2025-06-04 19:44:17,240 - INFO - dev split size : 67
2025-06-04 19:44:17,240 - INFO - test split size : 132
2025-06-04 19:44:17,448 - INFO - X shape : (198, 10000)
2025-06-04 19:44:17,448 - INFO - y shape : (198,)
2025-06-04 19:44:18,700 - INFO - Confusion matrix: TN=2, FP=33, FN=0, TP=97
2025-06-04 19:44:21,460 - INFO - Metrics: {'f1': 0.8546255506607929, 'recall': 1.0, 'precision': 0.7461538461538462, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.20648816585306443, 'NDCG': {}, 'kappa': 0.08178752107925802, 'TN': 2, 'FP': 33, 'FN': 0, 'TP': 97}
2025-06-04 19:44:21,466 - INFO - 
fold number 1 / 3
2025-06-04 19:44:21,471 - INFO - train split size : 198
2025-06-04 19:44:21,471 - INFO - dev split size : 66
2025-06-04 19:44:21,471 - INFO - test split size : 133
2025-06-04 19:44:21,675 - INFO - X shape : (198, 10000)
2025-06-04 19:44:21,676 - INFO - y shape : (198,)
2025-06-04 19:44:22,933 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:44:25,752 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:44:25,756 - INFO - 
fold number 2 / 3
2025-06-04 19:44:25,765 - INFO - train split size : 198
2025-06-04 19:44:25,765 - INFO - dev split size : 67
2025-06-04 19:44:25,765 - INFO - test split size : 132
2025-06-04 19:44:26,036 - INFO - X shape : (198, 10000)
2025-06-04 19:44:26,037 - INFO - y shape : (198,)
2025-06-04 19:44:27,295 - INFO - Confusion matrix: TN=1, FP=33, FN=0, TP=98
2025-06-04 19:44:30,144 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.14833305163534516, 'NDCG': {}, 'kappa': 0.04305799648506148, 'TN': 1, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:44:30,147 - INFO - 
fold number 3 / 3
2025-06-04 19:44:30,152 - INFO - train split size : 198
2025-06-04 19:44:30,153 - INFO - dev split size : 67
2025-06-04 19:44:30,153 - INFO - test split size : 132
2025-06-04 19:44:30,394 - INFO - X shape : (198, 10000)
2025-06-04 19:44:30,394 - INFO - y shape : (198,)
2025-06-04 19:44:31,693 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:44:34,707 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:44:34,713 - INFO - 
fold number 1 / 3
2025-06-04 19:44:34,718 - INFO - train split size : 198
2025-06-04 19:44:34,718 - INFO - dev split size : 66
2025-06-04 19:44:34,718 - INFO - test split size : 133
2025-06-04 19:44:34,929 - INFO - X shape : (198, 10000)
2025-06-04 19:44:34,929 - INFO - y shape : (198,)
2025-06-04 19:44:36,190 - INFO - Confusion matrix: TN=1, FP=34, FN=0, TP=98
2025-06-04 19:44:38,996 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7443609022556391, 'AP': {}, 'MCC': 0.14564381625088382, 'NDCG': {}, 'kappa': 0.041543026706231445, 'TN': 1, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:44:38,999 - INFO - 
fold number 2 / 3
2025-06-04 19:44:39,004 - INFO - train split size : 198
2025-06-04 19:44:39,004 - INFO - dev split size : 67
2025-06-04 19:44:39,004 - INFO - test split size : 132
2025-06-04 19:44:39,214 - INFO - X shape : (198, 10000)
2025-06-04 19:44:39,214 - INFO - y shape : (198,)
2025-06-04 19:44:40,466 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:44:43,241 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:44:43,246 - INFO - 
fold number 3 / 3
2025-06-04 19:44:43,251 - INFO - train split size : 198
2025-06-04 19:44:43,251 - INFO - dev split size : 67
2025-06-04 19:44:43,251 - INFO - test split size : 132
2025-06-04 19:44:43,495 - INFO - X shape : (198, 10000)
2025-06-04 19:44:43,495 - INFO - y shape : (198,)
2025-06-04 19:44:44,771 - INFO - Confusion matrix: TN=2, FP=33, FN=0, TP=97
2025-06-04 19:44:47,501 - INFO - Metrics: {'f1': 0.8546255506607929, 'recall': 1.0, 'precision': 0.7461538461538462, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.20648816585306443, 'NDCG': {}, 'kappa': 0.08178752107925802, 'TN': 2, 'FP': 33, 'FN': 0, 'TP': 97}
2025-06-04 19:44:47,509 - INFO - 
fold number 1 / 3
2025-06-04 19:44:47,514 - INFO - train split size : 198
2025-06-04 19:44:47,514 - INFO - dev split size : 66
2025-06-04 19:44:47,514 - INFO - test split size : 133
2025-06-04 19:44:47,753 - INFO - X shape : (198, 10000)
2025-06-04 19:44:47,753 - INFO - y shape : (198,)
2025-06-04 19:44:49,008 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:44:52,263 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:44:52,269 - INFO - 
fold number 2 / 3
2025-06-04 19:44:52,274 - INFO - train split size : 198
2025-06-04 19:44:52,274 - INFO - dev split size : 67
2025-06-04 19:44:52,274 - INFO - test split size : 132
2025-06-04 19:44:52,476 - INFO - X shape : (198, 10000)
2025-06-04 19:44:52,476 - INFO - y shape : (198,)
2025-06-04 19:44:53,750 - INFO - Confusion matrix: TN=1, FP=33, FN=0, TP=98
2025-06-04 19:44:56,581 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.14833305163534516, 'NDCG': {}, 'kappa': 0.04305799648506148, 'TN': 1, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:44:56,586 - INFO - 
fold number 3 / 3
2025-06-04 19:44:56,591 - INFO - train split size : 198
2025-06-04 19:44:56,591 - INFO - dev split size : 67
2025-06-04 19:44:56,591 - INFO - test split size : 132
2025-06-04 19:44:56,794 - INFO - X shape : (198, 10000)
2025-06-04 19:44:56,794 - INFO - y shape : (198,)
2025-06-04 19:44:58,044 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:45:00,795 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:45:00,803 - INFO - 
fold number 1 / 3
2025-06-04 19:45:00,809 - INFO - train split size : 198
2025-06-04 19:45:00,809 - INFO - dev split size : 66
2025-06-04 19:45:00,809 - INFO - test split size : 133
2025-06-04 19:45:01,028 - INFO - X shape : (198, 10000)
2025-06-04 19:45:01,028 - INFO - y shape : (198,)
2025-06-04 19:45:02,532 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:45:05,857 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:45:05,859 - INFO - 
fold number 2 / 3
2025-06-04 19:45:05,864 - INFO - train split size : 198
2025-06-04 19:45:05,864 - INFO - dev split size : 67
2025-06-04 19:45:05,864 - INFO - test split size : 132
2025-06-04 19:45:06,068 - INFO - X shape : (198, 10000)
2025-06-04 19:45:06,068 - INFO - y shape : (198,)
2025-06-04 19:45:07,540 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:45:10,314 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:45:10,318 - INFO - 
fold number 3 / 3
2025-06-04 19:45:10,323 - INFO - train split size : 198
2025-06-04 19:45:10,323 - INFO - dev split size : 67
2025-06-04 19:45:10,323 - INFO - test split size : 132
2025-06-04 19:45:10,538 - INFO - X shape : (198, 10000)
2025-06-04 19:45:10,538 - INFO - y shape : (198,)
2025-06-04 19:45:12,015 - INFO - Confusion matrix: TN=1, FP=34, FN=0, TP=97
2025-06-04 19:45:14,974 - INFO - Metrics: {'f1': 0.8508771929824561, 'recall': 1.0, 'precision': 0.7404580152671756, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.14545082775064525, 'NDCG': {}, 'kappa': 0.04143528406663821, 'TN': 1, 'FP': 34, 'FN': 0, 'TP': 97}
2025-06-04 19:45:14,983 - INFO - 
fold number 1 / 3
2025-06-04 19:45:14,989 - INFO - train split size : 198
2025-06-04 19:45:14,989 - INFO - dev split size : 66
2025-06-04 19:45:14,989 - INFO - test split size : 133
2025-06-04 19:45:15,208 - INFO - X shape : (198, 10000)
2025-06-04 19:45:15,208 - INFO - y shape : (198,)
2025-06-04 19:45:16,675 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:45:19,411 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:45:19,414 - INFO - 
fold number 2 / 3
2025-06-04 19:45:19,419 - INFO - train split size : 198
2025-06-04 19:45:19,419 - INFO - dev split size : 67
2025-06-04 19:45:19,419 - INFO - test split size : 132
2025-06-04 19:45:19,617 - INFO - X shape : (198, 10000)
2025-06-04 19:45:19,617 - INFO - y shape : (198,)
2025-06-04 19:45:21,085 - INFO - Confusion matrix: TN=1, FP=33, FN=0, TP=98
2025-06-04 19:45:23,928 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.14833305163534516, 'NDCG': {}, 'kappa': 0.04305799648506148, 'TN': 1, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:45:23,931 - INFO - 
fold number 3 / 3
2025-06-04 19:45:23,936 - INFO - train split size : 198
2025-06-04 19:45:23,936 - INFO - dev split size : 67
2025-06-04 19:45:23,936 - INFO - test split size : 132
2025-06-04 19:45:24,148 - INFO - X shape : (198, 10000)
2025-06-04 19:45:24,148 - INFO - y shape : (198,)
2025-06-04 19:45:25,612 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:45:28,603 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:45:28,614 - INFO - 
fold number 1 / 3
2025-06-04 19:45:28,620 - INFO - train split size : 198
2025-06-04 19:45:28,620 - INFO - dev split size : 66
2025-06-04 19:45:28,620 - INFO - test split size : 133
2025-06-04 19:45:28,829 - INFO - X shape : (198, 10000)
2025-06-04 19:45:28,829 - INFO - y shape : (198,)
2025-06-04 19:45:31,121 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:45:34,547 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:45:34,554 - INFO - 
fold number 2 / 3
2025-06-04 19:45:34,560 - INFO - train split size : 198
2025-06-04 19:45:34,560 - INFO - dev split size : 67
2025-06-04 19:45:34,560 - INFO - test split size : 132
2025-06-04 19:45:34,766 - INFO - X shape : (198, 10000)
2025-06-04 19:45:34,766 - INFO - y shape : (198,)
2025-06-04 19:45:36,231 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:45:39,175 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:45:39,178 - INFO - 
fold number 3 / 3
2025-06-04 19:45:39,183 - INFO - train split size : 198
2025-06-04 19:45:39,183 - INFO - dev split size : 67
2025-06-04 19:45:39,183 - INFO - test split size : 132
2025-06-04 19:45:39,387 - INFO - X shape : (198, 10000)
2025-06-04 19:45:39,387 - INFO - y shape : (198,)
2025-06-04 19:45:40,824 - INFO - Confusion matrix: TN=2, FP=33, FN=0, TP=97
2025-06-04 19:45:43,544 - INFO - Metrics: {'f1': 0.8546255506607929, 'recall': 1.0, 'precision': 0.7461538461538462, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.20648816585306443, 'NDCG': {}, 'kappa': 0.08178752107925802, 'TN': 2, 'FP': 33, 'FN': 0, 'TP': 97}
2025-06-04 19:45:43,555 - INFO - 
fold number 1 / 3
2025-06-04 19:45:43,560 - INFO - train split size : 198
2025-06-04 19:45:43,560 - INFO - dev split size : 66
2025-06-04 19:45:43,560 - INFO - test split size : 133
2025-06-04 19:45:43,765 - INFO - X shape : (198, 10000)
2025-06-04 19:45:43,765 - INFO - y shape : (198,)
2025-06-04 19:45:45,232 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:45:48,440 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:45:48,447 - INFO - 
fold number 2 / 3
2025-06-04 19:45:48,452 - INFO - train split size : 198
2025-06-04 19:45:48,453 - INFO - dev split size : 67
2025-06-04 19:45:48,453 - INFO - test split size : 132
2025-06-04 19:45:48,655 - INFO - X shape : (198, 10000)
2025-06-04 19:45:48,655 - INFO - y shape : (198,)
2025-06-04 19:45:50,121 - INFO - Confusion matrix: TN=1, FP=33, FN=0, TP=98
2025-06-04 19:45:52,931 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.14833305163534516, 'NDCG': {}, 'kappa': 0.04305799648506148, 'TN': 1, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:45:52,934 - INFO - 
fold number 3 / 3
2025-06-04 19:45:52,940 - INFO - train split size : 198
2025-06-04 19:45:52,940 - INFO - dev split size : 67
2025-06-04 19:45:52,940 - INFO - test split size : 132
2025-06-04 19:45:53,148 - INFO - X shape : (198, 10000)
2025-06-04 19:45:53,148 - INFO - y shape : (198,)
2025-06-04 19:45:54,660 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:45:57,531 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:45:57,537 - INFO - 
fold number 1 / 3
2025-06-04 19:45:57,542 - INFO - train split size : 198
2025-06-04 19:45:57,543 - INFO - dev split size : 66
2025-06-04 19:45:57,543 - INFO - test split size : 133
2025-06-04 19:45:57,747 - INFO - X shape : (198, 10000)
2025-06-04 19:45:57,747 - INFO - y shape : (198,)
2025-06-04 19:45:59,202 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:46:02,173 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:46:02,177 - INFO - 
fold number 2 / 3
2025-06-04 19:46:02,182 - INFO - train split size : 198
2025-06-04 19:46:02,182 - INFO - dev split size : 67
2025-06-04 19:46:02,182 - INFO - test split size : 132
2025-06-04 19:46:02,411 - INFO - X shape : (198, 10000)
2025-06-04 19:46:02,412 - INFO - y shape : (198,)
2025-06-04 19:46:03,873 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:46:06,719 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:46:06,722 - INFO - 
fold number 3 / 3
2025-06-04 19:46:06,729 - INFO - train split size : 198
2025-06-04 19:46:06,729 - INFO - dev split size : 67
2025-06-04 19:46:06,729 - INFO - test split size : 132
2025-06-04 19:46:06,931 - INFO - X shape : (198, 10000)
2025-06-04 19:46:06,931 - INFO - y shape : (198,)
2025-06-04 19:46:08,389 - INFO - Confusion matrix: TN=1, FP=34, FN=0, TP=97
2025-06-04 19:46:11,377 - INFO - Metrics: {'f1': 0.8508771929824561, 'recall': 1.0, 'precision': 0.7404580152671756, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.14545082775064525, 'NDCG': {}, 'kappa': 0.04143528406663821, 'TN': 1, 'FP': 34, 'FN': 0, 'TP': 97}
2025-06-04 19:46:11,383 - INFO - 
fold number 1 / 3
2025-06-04 19:46:11,388 - INFO - train split size : 198
2025-06-04 19:46:11,388 - INFO - dev split size : 66
2025-06-04 19:46:11,388 - INFO - test split size : 133
2025-06-04 19:46:11,597 - INFO - X shape : (198, 10000)
2025-06-04 19:46:11,597 - INFO - y shape : (198,)
2025-06-04 19:46:13,023 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:46:15,801 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:46:15,803 - INFO - 
fold number 2 / 3
2025-06-04 19:46:15,810 - INFO - train split size : 198
2025-06-04 19:46:15,810 - INFO - dev split size : 67
2025-06-04 19:46:15,810 - INFO - test split size : 132
2025-06-04 19:46:16,010 - INFO - X shape : (198, 10000)
2025-06-04 19:46:16,010 - INFO - y shape : (198,)
2025-06-04 19:46:17,421 - INFO - Confusion matrix: TN=1, FP=33, FN=0, TP=98
2025-06-04 19:46:20,168 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.14833305163534516, 'NDCG': {}, 'kappa': 0.04305799648506148, 'TN': 1, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:46:20,170 - INFO - 
fold number 3 / 3
2025-06-04 19:46:20,175 - INFO - train split size : 198
2025-06-04 19:46:20,176 - INFO - dev split size : 67
2025-06-04 19:46:20,176 - INFO - test split size : 132
2025-06-04 19:46:20,382 - INFO - X shape : (198, 10000)
2025-06-04 19:46:20,382 - INFO - y shape : (198,)
2025-06-04 19:46:21,794 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:46:24,527 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:46:24,536 - INFO - 
fold number 1 / 3
2025-06-04 19:46:24,541 - INFO - train split size : 198
2025-06-04 19:46:24,541 - INFO - dev split size : 66
2025-06-04 19:46:24,541 - INFO - test split size : 133
2025-06-04 19:46:24,744 - INFO - X shape : (198, 10000)
2025-06-04 19:46:24,745 - INFO - y shape : (198,)
2025-06-04 19:46:26,315 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:46:29,162 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:46:29,166 - INFO - 
fold number 2 / 3
2025-06-04 19:46:29,171 - INFO - train split size : 198
2025-06-04 19:46:29,171 - INFO - dev split size : 67
2025-06-04 19:46:29,171 - INFO - test split size : 132
2025-06-04 19:46:29,393 - INFO - X shape : (198, 10000)
2025-06-04 19:46:29,394 - INFO - y shape : (198,)
2025-06-04 19:46:30,993 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:46:34,861 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:46:34,863 - INFO - 
fold number 3 / 3
2025-06-04 19:46:34,868 - INFO - train split size : 198
2025-06-04 19:46:34,868 - INFO - dev split size : 67
2025-06-04 19:46:34,868 - INFO - test split size : 132
2025-06-04 19:46:35,090 - INFO - X shape : (198, 10000)
2025-06-04 19:46:35,090 - INFO - y shape : (198,)
2025-06-04 19:46:36,671 - INFO - Confusion matrix: TN=1, FP=34, FN=0, TP=97
2025-06-04 19:46:39,772 - INFO - Metrics: {'f1': 0.8508771929824561, 'recall': 1.0, 'precision': 0.7404580152671756, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.14545082775064525, 'NDCG': {}, 'kappa': 0.04143528406663821, 'TN': 1, 'FP': 34, 'FN': 0, 'TP': 97}
2025-06-04 19:46:39,782 - INFO - 
fold number 1 / 3
2025-06-04 19:46:39,787 - INFO - train split size : 198
2025-06-04 19:46:39,787 - INFO - dev split size : 66
2025-06-04 19:46:39,787 - INFO - test split size : 133
2025-06-04 19:46:40,023 - INFO - X shape : (198, 10000)
2025-06-04 19:46:40,023 - INFO - y shape : (198,)
2025-06-04 19:46:41,636 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:46:44,701 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:46:44,706 - INFO - 
fold number 2 / 3
2025-06-04 19:46:44,712 - INFO - train split size : 198
2025-06-04 19:46:44,712 - INFO - dev split size : 67
2025-06-04 19:46:44,712 - INFO - test split size : 132
2025-06-04 19:46:44,917 - INFO - X shape : (198, 10000)
2025-06-04 19:46:44,918 - INFO - y shape : (198,)
2025-06-04 19:46:46,526 - INFO - Confusion matrix: TN=1, FP=33, FN=0, TP=98
2025-06-04 19:46:49,324 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.14833305163534516, 'NDCG': {}, 'kappa': 0.04305799648506148, 'TN': 1, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:46:49,328 - INFO - 
fold number 3 / 3
2025-06-04 19:46:49,333 - INFO - train split size : 198
2025-06-04 19:46:49,333 - INFO - dev split size : 67
2025-06-04 19:46:49,333 - INFO - test split size : 132
2025-06-04 19:46:49,543 - INFO - X shape : (198, 10000)
2025-06-04 19:46:49,543 - INFO - y shape : (198,)
2025-06-04 19:46:51,132 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:46:53,969 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:46:53,976 - INFO - 
fold number 1 / 3
2025-06-04 19:46:53,981 - INFO - train split size : 198
2025-06-04 19:46:53,981 - INFO - dev split size : 66
2025-06-04 19:46:53,981 - INFO - test split size : 133
2025-06-04 19:46:54,183 - INFO - X shape : (198, 10000)
2025-06-04 19:46:54,183 - INFO - y shape : (198,)
2025-06-04 19:46:55,743 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:46:58,494 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:46:58,496 - INFO - 
fold number 2 / 3
2025-06-04 19:46:58,501 - INFO - train split size : 198
2025-06-04 19:46:58,501 - INFO - dev split size : 67
2025-06-04 19:46:58,501 - INFO - test split size : 132
2025-06-04 19:46:58,710 - INFO - X shape : (198, 10000)
2025-06-04 19:46:58,711 - INFO - y shape : (198,)
2025-06-04 19:47:00,301 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:47:03,057 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:47:03,059 - INFO - 
fold number 3 / 3
2025-06-04 19:47:03,065 - INFO - train split size : 198
2025-06-04 19:47:03,065 - INFO - dev split size : 67
2025-06-04 19:47:03,065 - INFO - test split size : 132
2025-06-04 19:47:03,287 - INFO - X shape : (198, 10000)
2025-06-04 19:47:03,287 - INFO - y shape : (198,)
2025-06-04 19:47:04,899 - INFO - Confusion matrix: TN=2, FP=33, FN=0, TP=97
2025-06-04 19:47:07,678 - INFO - Metrics: {'f1': 0.8546255506607929, 'recall': 1.0, 'precision': 0.7461538461538462, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.20648816585306443, 'NDCG': {}, 'kappa': 0.08178752107925802, 'TN': 2, 'FP': 33, 'FN': 0, 'TP': 97}
2025-06-04 19:47:07,686 - INFO - 
fold number 1 / 3
2025-06-04 19:47:07,691 - INFO - train split size : 198
2025-06-04 19:47:07,691 - INFO - dev split size : 66
2025-06-04 19:47:07,691 - INFO - test split size : 133
2025-06-04 19:47:07,918 - INFO - X shape : (198, 10000)
2025-06-04 19:47:07,918 - INFO - y shape : (198,)
2025-06-04 19:47:09,509 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:47:12,493 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:47:12,496 - INFO - 
fold number 2 / 3
2025-06-04 19:47:12,501 - INFO - train split size : 198
2025-06-04 19:47:12,501 - INFO - dev split size : 67
2025-06-04 19:47:12,501 - INFO - test split size : 132
2025-06-04 19:47:12,708 - INFO - X shape : (198, 10000)
2025-06-04 19:47:12,708 - INFO - y shape : (198,)
2025-06-04 19:47:14,335 - INFO - Confusion matrix: TN=1, FP=33, FN=0, TP=98
2025-06-04 19:47:17,124 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.14833305163534516, 'NDCG': {}, 'kappa': 0.04305799648506148, 'TN': 1, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:47:17,131 - INFO - 
fold number 3 / 3
2025-06-04 19:47:17,136 - INFO - train split size : 198
2025-06-04 19:47:17,136 - INFO - dev split size : 67
2025-06-04 19:47:17,136 - INFO - test split size : 132
2025-06-04 19:47:17,350 - INFO - X shape : (198, 10000)
2025-06-04 19:47:17,350 - INFO - y shape : (198,)
2025-06-04 19:47:18,938 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:47:21,675 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:47:21,684 - INFO - 
fold number 1 / 3
2025-06-04 19:47:21,689 - INFO - train split size : 198
2025-06-04 19:47:21,689 - INFO - dev split size : 66
2025-06-04 19:47:21,689 - INFO - test split size : 133
2025-06-04 19:47:21,898 - INFO - X shape : (198, 10000)
2025-06-04 19:47:21,899 - INFO - y shape : (198,)
2025-06-04 19:47:23,503 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:47:27,007 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:47:27,010 - INFO - 
fold number 2 / 3
2025-06-04 19:47:27,015 - INFO - train split size : 198
2025-06-04 19:47:27,015 - INFO - dev split size : 67
2025-06-04 19:47:27,015 - INFO - test split size : 132
2025-06-04 19:47:27,211 - INFO - X shape : (198, 10000)
2025-06-04 19:47:27,211 - INFO - y shape : (198,)
2025-06-04 19:47:28,774 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:47:31,547 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:47:31,550 - INFO - 
fold number 3 / 3
2025-06-04 19:47:31,555 - INFO - train split size : 198
2025-06-04 19:47:31,555 - INFO - dev split size : 67
2025-06-04 19:47:31,555 - INFO - test split size : 132
2025-06-04 19:47:31,755 - INFO - X shape : (198, 10000)
2025-06-04 19:47:31,755 - INFO - y shape : (198,)
2025-06-04 19:47:33,346 - INFO - Confusion matrix: TN=1, FP=34, FN=0, TP=97
2025-06-04 19:47:36,099 - INFO - Metrics: {'f1': 0.8508771929824561, 'recall': 1.0, 'precision': 0.7404580152671756, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.14545082775064525, 'NDCG': {}, 'kappa': 0.04143528406663821, 'TN': 1, 'FP': 34, 'FN': 0, 'TP': 97}
2025-06-04 19:47:36,105 - INFO - 
fold number 1 / 3
2025-06-04 19:47:36,110 - INFO - train split size : 198
2025-06-04 19:47:36,110 - INFO - dev split size : 66
2025-06-04 19:47:36,110 - INFO - test split size : 133
2025-06-04 19:47:36,316 - INFO - X shape : (198, 10000)
2025-06-04 19:47:36,317 - INFO - y shape : (198,)
2025-06-04 19:47:37,889 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:47:40,645 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:47:40,647 - INFO - 
fold number 2 / 3
2025-06-04 19:47:40,653 - INFO - train split size : 198
2025-06-04 19:47:40,653 - INFO - dev split size : 67
2025-06-04 19:47:40,653 - INFO - test split size : 132
2025-06-04 19:47:40,866 - INFO - X shape : (198, 10000)
2025-06-04 19:47:40,866 - INFO - y shape : (198,)
2025-06-04 19:47:42,494 - INFO - Confusion matrix: TN=1, FP=33, FN=0, TP=98
2025-06-04 19:47:45,512 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.14833305163534516, 'NDCG': {}, 'kappa': 0.04305799648506148, 'TN': 1, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:47:45,514 - INFO - 
fold number 3 / 3
2025-06-04 19:47:45,519 - INFO - train split size : 198
2025-06-04 19:47:45,519 - INFO - dev split size : 67
2025-06-04 19:47:45,519 - INFO - test split size : 132
2025-06-04 19:47:45,716 - INFO - X shape : (198, 10000)
2025-06-04 19:47:45,716 - INFO - y shape : (198,)
2025-06-04 19:47:47,328 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:47:50,273 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:47:50,280 - INFO - 
fold number 1 / 3
2025-06-04 19:47:50,285 - INFO - train split size : 198
2025-06-04 19:47:50,285 - INFO - dev split size : 66
2025-06-04 19:47:50,285 - INFO - test split size : 133
2025-06-04 19:47:50,483 - INFO - X shape : (198, 10000)
2025-06-04 19:47:50,483 - INFO - y shape : (198,)
2025-06-04 19:47:53,006 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:47:55,796 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:47:55,798 - INFO - 
fold number 2 / 3
2025-06-04 19:47:55,804 - INFO - train split size : 198
2025-06-04 19:47:55,804 - INFO - dev split size : 67
2025-06-04 19:47:55,804 - INFO - test split size : 132
2025-06-04 19:47:56,016 - INFO - X shape : (198, 10000)
2025-06-04 19:47:56,016 - INFO - y shape : (198,)
2025-06-04 19:47:57,782 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:48:00,915 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:48:00,918 - INFO - 
fold number 3 / 3
2025-06-04 19:48:00,924 - INFO - train split size : 198
2025-06-04 19:48:00,924 - INFO - dev split size : 67
2025-06-04 19:48:00,924 - INFO - test split size : 132
2025-06-04 19:48:01,137 - INFO - X shape : (198, 10000)
2025-06-04 19:48:01,137 - INFO - y shape : (198,)
2025-06-04 19:48:02,879 - INFO - Confusion matrix: TN=1, FP=34, FN=0, TP=97
2025-06-04 19:48:05,634 - INFO - Metrics: {'f1': 0.8508771929824561, 'recall': 1.0, 'precision': 0.7404580152671756, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.14545082775064525, 'NDCG': {}, 'kappa': 0.04143528406663821, 'TN': 1, 'FP': 34, 'FN': 0, 'TP': 97}
2025-06-04 19:48:05,640 - INFO - 
fold number 1 / 3
2025-06-04 19:48:05,645 - INFO - train split size : 198
2025-06-04 19:48:05,645 - INFO - dev split size : 66
2025-06-04 19:48:05,645 - INFO - test split size : 133
2025-06-04 19:48:05,850 - INFO - X shape : (198, 10000)
2025-06-04 19:48:05,850 - INFO - y shape : (198,)
2025-06-04 19:48:07,616 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:48:10,448 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:48:10,450 - INFO - 
fold number 2 / 3
2025-06-04 19:48:10,455 - INFO - train split size : 198
2025-06-04 19:48:10,456 - INFO - dev split size : 67
2025-06-04 19:48:10,456 - INFO - test split size : 132
2025-06-04 19:48:10,649 - INFO - X shape : (198, 10000)
2025-06-04 19:48:10,650 - INFO - y shape : (198,)
2025-06-04 19:48:12,386 - INFO - Confusion matrix: TN=1, FP=33, FN=0, TP=98
2025-06-04 19:48:15,244 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.14833305163534516, 'NDCG': {}, 'kappa': 0.04305799648506148, 'TN': 1, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:48:15,247 - INFO - 
fold number 3 / 3
2025-06-04 19:48:15,253 - INFO - train split size : 198
2025-06-04 19:48:15,253 - INFO - dev split size : 67
2025-06-04 19:48:15,253 - INFO - test split size : 132
2025-06-04 19:48:15,457 - INFO - X shape : (198, 10000)
2025-06-04 19:48:15,457 - INFO - y shape : (198,)
2025-06-04 19:48:17,267 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:48:20,363 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:48:20,370 - INFO - 
fold number 1 / 3
2025-06-04 19:48:20,376 - INFO - train split size : 198
2025-06-04 19:48:20,376 - INFO - dev split size : 66
2025-06-04 19:48:20,376 - INFO - test split size : 133
2025-06-04 19:48:20,582 - INFO - X shape : (198, 10000)
2025-06-04 19:48:20,582 - INFO - y shape : (198,)
2025-06-04 19:48:22,360 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:48:25,256 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:48:25,259 - INFO - 
fold number 2 / 3
2025-06-04 19:48:25,264 - INFO - train split size : 198
2025-06-04 19:48:25,264 - INFO - dev split size : 67
2025-06-04 19:48:25,264 - INFO - test split size : 132
2025-06-04 19:48:25,502 - INFO - X shape : (198, 10000)
2025-06-04 19:48:25,502 - INFO - y shape : (198,)
2025-06-04 19:48:27,237 - INFO - Confusion matrix: TN=1, FP=33, FN=0, TP=98
2025-06-04 19:48:30,008 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.14833305163534516, 'NDCG': {}, 'kappa': 0.04305799648506148, 'TN': 1, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:48:30,012 - INFO - 
fold number 3 / 3
2025-06-04 19:48:30,020 - INFO - train split size : 198
2025-06-04 19:48:30,020 - INFO - dev split size : 67
2025-06-04 19:48:30,020 - INFO - test split size : 132
2025-06-04 19:48:30,239 - INFO - X shape : (198, 10000)
2025-06-04 19:48:30,240 - INFO - y shape : (198,)
2025-06-04 19:48:32,016 - INFO - Confusion matrix: TN=2, FP=33, FN=0, TP=97
2025-06-04 19:48:35,258 - INFO - Metrics: {'f1': 0.8546255506607929, 'recall': 1.0, 'precision': 0.7461538461538462, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.20648816585306443, 'NDCG': {}, 'kappa': 0.08178752107925802, 'TN': 2, 'FP': 33, 'FN': 0, 'TP': 97}
2025-06-04 19:48:35,264 - INFO - 
fold number 1 / 3
2025-06-04 19:48:35,269 - INFO - train split size : 198
2025-06-04 19:48:35,269 - INFO - dev split size : 66
2025-06-04 19:48:35,269 - INFO - test split size : 133
2025-06-04 19:48:35,510 - INFO - X shape : (198, 10000)
2025-06-04 19:48:35,510 - INFO - y shape : (198,)
2025-06-04 19:48:37,384 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:48:40,191 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:48:40,194 - INFO - 
fold number 2 / 3
2025-06-04 19:48:40,199 - INFO - train split size : 198
2025-06-04 19:48:40,199 - INFO - dev split size : 67
2025-06-04 19:48:40,199 - INFO - test split size : 132
2025-06-04 19:48:40,386 - INFO - X shape : (198, 10000)
2025-06-04 19:48:40,386 - INFO - y shape : (198,)
2025-06-04 19:48:42,191 - INFO - Confusion matrix: TN=1, FP=33, FN=0, TP=98
2025-06-04 19:48:45,046 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.14833305163534516, 'NDCG': {}, 'kappa': 0.04305799648506148, 'TN': 1, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:48:45,049 - INFO - 
fold number 3 / 3
2025-06-04 19:48:45,054 - INFO - train split size : 198
2025-06-04 19:48:45,054 - INFO - dev split size : 67
2025-06-04 19:48:45,054 - INFO - test split size : 132
2025-06-04 19:48:45,243 - INFO - X shape : (198, 10000)
2025-06-04 19:48:45,243 - INFO - y shape : (198,)
2025-06-04 19:48:46,984 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:48:49,671 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:48:49,677 - INFO - 
fold number 1 / 3
2025-06-04 19:48:49,682 - INFO - train split size : 198
2025-06-04 19:48:49,682 - INFO - dev split size : 66
2025-06-04 19:48:49,682 - INFO - test split size : 133
2025-06-04 19:48:49,873 - INFO - X shape : (198, 10000)
2025-06-04 19:48:49,873 - INFO - y shape : (198,)
2025-06-04 19:48:51,599 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:48:54,394 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:48:54,397 - INFO - 
fold number 2 / 3
2025-06-04 19:48:54,402 - INFO - train split size : 198
2025-06-04 19:48:54,402 - INFO - dev split size : 67
2025-06-04 19:48:54,402 - INFO - test split size : 132
2025-06-04 19:48:54,604 - INFO - X shape : (198, 10000)
2025-06-04 19:48:54,604 - INFO - y shape : (198,)
2025-06-04 19:48:56,376 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-04 19:48:59,416 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-04 19:48:59,418 - INFO - 
fold number 3 / 3
2025-06-04 19:48:59,424 - INFO - train split size : 198
2025-06-04 19:48:59,424 - INFO - dev split size : 67
2025-06-04 19:48:59,424 - INFO - test split size : 132
2025-06-04 19:48:59,641 - INFO - X shape : (198, 10000)
2025-06-04 19:48:59,641 - INFO - y shape : (198,)
2025-06-04 19:49:01,459 - INFO - Confusion matrix: TN=1, FP=34, FN=0, TP=97
2025-06-04 19:49:04,545 - INFO - Metrics: {'f1': 0.8508771929824561, 'recall': 1.0, 'precision': 0.7404580152671756, 'accuracy': 0.7424242424242424, 'AP': {}, 'MCC': 0.14545082775064525, 'NDCG': {}, 'kappa': 0.04143528406663821, 'TN': 1, 'FP': 34, 'FN': 0, 'TP': 97}
2025-06-04 19:49:04,552 - INFO - 
fold number 1 / 3
2025-06-04 19:49:04,557 - INFO - train split size : 198
2025-06-04 19:49:04,557 - INFO - dev split size : 66
2025-06-04 19:49:04,557 - INFO - test split size : 133
2025-06-04 19:49:04,773 - INFO - X shape : (198, 10000)
2025-06-04 19:49:04,773 - INFO - y shape : (198,)
2025-06-04 19:49:06,572 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-04 19:49:09,454 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-04 19:49:09,457 - INFO - 
fold number 2 / 3
2025-06-04 19:49:09,462 - INFO - train split size : 198
2025-06-04 19:49:09,462 - INFO - dev split size : 67
2025-06-04 19:49:09,462 - INFO - test split size : 132
2025-06-04 19:49:09,676 - INFO - X shape : (198, 10000)
2025-06-04 19:49:09,676 - INFO - y shape : (198,)
2025-06-04 19:49:11,457 - INFO - Confusion matrix: TN=1, FP=33, FN=0, TP=98
2025-06-04 19:49:14,217 - INFO - Metrics: {'f1': 0.8558951965065502, 'recall': 1.0, 'precision': 0.7480916030534351, 'accuracy': 0.75, 'AP': {}, 'MCC': 0.14833305163534516, 'NDCG': {}, 'kappa': 0.04305799648506148, 'TN': 1, 'FP': 33, 'FN': 0, 'TP': 98}
2025-06-04 19:49:14,220 - INFO - 
fold number 3 / 3
2025-06-04 19:49:14,225 - INFO - train split size : 198
2025-06-04 19:49:14,225 - INFO - dev split size : 67
2025-06-04 19:49:14,225 - INFO - test split size : 132
2025-06-04 19:49:14,426 - INFO - X shape : (198, 10000)
2025-06-04 19:49:14,426 - INFO - y shape : (198,)
2025-06-04 19:49:16,226 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-04 19:49:18,930 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': {}, 'MCC': 0.0, 'NDCG': {}, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-04 19:49:18,942 - INFO - Total running time : 3282.773089526221
2025-06-06 10:55:48,605	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
2025-06-06 10:55:49,288 - INFO - Random seeds set to 42
2025-06-06 10:55:49,393 - INFO - Optional negatives loaded from CSV with 5000 entries.
2025-06-06 10:55:49,393 - INFO - Loading original negatives...
2025-06-06 10:55:49,402 - INFO - Negatives column names: ['Article ID', 'Title', 'Author', 'Publication year', 'Title secondary', 'URL', 'DOI', 'Abstract', 'Criteria for exclusion A', ' Criteria for exclusion B', ' Criteria for exclusion C', 'labels', 'Keywords']
2025-06-06 10:55:49,402 - INFO - Loading original positives...
2025-06-06 10:55:49,420 - INFO - Positives column names: ['Article ID', 'Title', 'Author', 'Secondary authors', 'Keywords', 'title of unpublished reference', 'primary date', 'publication year', 'notes', 'reprint status', 'start page number', 'ending page number', 'periodical full name', 'periodical standard abbreviation', 'periodical in which article was published', 'periodical name - user abbreviation 1', 'periodical name - user abbreviation 2', 'volume number', 'issue number', 'title secondary', 'city of publication', 'publisher', 'user definable 1', 'user definable 5', 'title series', 'Abstract', 'ISSN/ISBN', 'availability', 'Misc. 1', 'Misc. 2', 'address', 'Web/URL', 'link to PDF', 'link to full-text', 'related records', 'images', 'DOI', 'labels']
2025-06-06 10:55:49,426 - INFO - Class balance:
labels
1    326
0    123
Name: count, dtype: int64
2025-06-06 10:55:49,426 - INFO -    Article ID  ...  Criteria for exclusion C
0       12959  ...                       NaN
1       13470  ...                       NaN
2        4686  ...                       NaN
3        2503  ...                       NaN
4        2951  ...                       NaN

[5 rows x 44 columns]
2025-06-06 10:55:49,450 - INFO - Original dataset size: 449
2025-06-06 10:55:49,450 - INFO - Optional negatives size: 5000
2025-06-06 10:55:49,455 - INFO - Optional negatives:                                                title  ... labels
0  Towards evidence-based conservation of subterr...  ...     -1
1                  Marine biodiversity conservation.  ...     -1
2  Climate teleconnections modulate global burned...  ...     -1
3  Integrating carbon sequestration and biodivers...  ...     -1
4  Principle, technique and application of grassl...  ...     -1

[5 rows x 7 columns]
2025-06-06 10:55:49,458 - INFO - Combined dataset size: 949
2025-06-06 10:55:49,463 - INFO -                                                title  ... labels
0  Feral pig (Sus scrofa) disturbance facilitates...  ...      1
1  Effects of woody plant diversity on abovegroun...  ...      1
2  Scaling species richness and endemism of tropi...  ...      1
3  Not as the crow flies: Assessing effective iso...  ...      0
4  Species-group concepts and biogeography of the...  ...      1

[5 rows x 5 columns]
2025-06-06 10:55:49,464 - INFO - title        0
abstract     0
Keywords     8
doi         37
labels       0
dtype: int64
2025-06-06 10:55:49,466 - INFO - Total duplicate abstracts: 0
2025-06-06 10:55:49,467 - INFO - Empty DataFrame
Columns: [abstract, labels, Keywords]
Index: []
2025-06-06 10:55:49,470 - INFO - Abstracts appearing in both classes: 0
2025-06-06 10:55:49,470 - INFO - Empty DataFrame
Columns: [title, labels]
Index: []
2025-06-06 10:55:49,473 - INFO - Total duplicate abstracts: 0
2025-06-06 10:55:49,474 - INFO - Empty DataFrame
Columns: [abstract, labels, Keywords]
Index: []
2025-06-06 10:55:49,482 - INFO - Abstracts appearing in both classes: 0
2025-06-06 10:55:49,482 - INFO - Empty DataFrame
Columns: [abstract, labels]
Index: []
2025-06-06 10:55:49,484 - INFO - Total duplicate abstracts: 18
2025-06-06 10:55:49,488 - INFO -                                               abstract  ...                                           Keywords
147  1. How could identical species appear in widel...  ...                                                   
253  Aims\r\n Developing plant conservation strateg...  ...  AFLP; genetic diversity; Indian Ocean; limited...
206  Aims Developing plant conservation strategies ...  ...  AFLP; Genetic diversity; Indian Ocean; Limited...
217  Coastal lagoons are considered one of the most...  ...                                                   
213  Coastal lagoons are considered one of the most...  ...                                                   
21   Distribution patterns of indigenous non-volant...  ...  Australian islands; Extreme-value function; Is...
300  Distribution patterns of indigenous non-volant...  ...  island mammals; Australian islands; species-ar...
197  Invasive plant species pose serious threats to...  ...                                                   
35   Island bat species are disproportionately at r...  ...  Hawaiian hoary bat; Hawai?i; Population geneti...
157  Island bat species are disproportionately at r...  ...  Bats; Endangered species; Hawai<sup>â€˜</sup>i; ...
126  Islands are hotspots of biodiversity and extin...  ...  Deforestation; Endemicity; Extinction; Island ...
276  Islands are hotspots of biodiversity and extin...  ...  Deforestation; Endemicity; Extinction; Island ...
364  KELLY, A. B. (Department of Environmental Scie...  ...                                                   
329  Summary o 1. How could identical species appea...  ...                                                   
278  The Galapagos Islands are recognized for their...  ...                                                   
149  The GalÃ¡pagos Islands are recognized for their...  ...                                                   
313  Working in the Galapagos Islands and surroundi...  ...                                                   
280  Working in the GalÃ¡pagos Islands and surroundi...  ...                                                   

[18 rows x 3 columns]
2025-06-06 10:55:49,491 - INFO - Abstracts appearing in both classes: 0
2025-06-06 10:55:49,491 - INFO - Empty DataFrame
Columns: [doi, labels]
Index: []
2025-06-06 10:55:49,765 - INFO - Cleaned dataset size: 896
2025-06-06 10:55:49,766 - INFO - Numnber of positives : 293
2025-06-06 10:55:49,766 - INFO - Numnber of negatives : 603
2025-06-06 10:55:49,767 - INFO - clean_og_df indices : Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       387, 388, 389, 390, 391, 392, 393, 394, 395, 396],
      dtype='int64', length=397)
2025-06-06 10:55:49,768 - INFO - opt_neg_df indices : Index([397, 398, 399, 400, 401, 402, 403, 404, 405, 406,
       ...
       886, 887, 888, 889, 890, 891, 892, 893, 894, 895],
      dtype='int64', length=499)
2025-06-06 10:55:49,773 - INFO - Fold 1:
2025-06-06 10:55:49,773 - INFO -   Train label distribution: {-1: 0.7159253945480631, 1: 0.20946915351506457, 0: 0.0746054519368723}
2025-06-06 10:55:49,773 - INFO -   Test label distribution: {1: 0.7368421052631579, 0: 0.2631578947368421}
2025-06-06 10:55:49,776 - INFO - Fold 2:
2025-06-06 10:55:49,776 - INFO -   Train label distribution: {-1: 0.7159253945480631, 1: 0.20946915351506457, 0: 0.0746054519368723}
2025-06-06 10:55:49,776 - INFO -   Test label distribution: {1: 0.7424242424242424, 0: 0.25757575757575757}
2025-06-06 10:55:49,779 - INFO - Fold 3:
2025-06-06 10:55:49,779 - INFO -   Train label distribution: {-1: 0.7159253945480631, 1: 0.20946915351506457, 0: 0.0746054519368723}
2025-06-06 10:55:49,779 - INFO -   Test label distribution: {1: 0.7348484848484849, 0: 0.26515151515151514}
2025-06-06 10:55:49,782 - INFO - Fold 1:
2025-06-06 10:55:49,783 - INFO -   Train label distribution: {-1: 0.7159253945480631, 1: 0.20946915351506457, 0: 0.0746054519368723}
2025-06-06 10:55:49,783 - INFO -   Test label distribution: {1: 0.7368421052631579, 0: 0.2631578947368421}
2025-06-06 10:55:49,785 - INFO - Fold 2:
2025-06-06 10:55:49,785 - INFO -   Train label distribution: {-1: 0.7159253945480631, 1: 0.20946915351506457, 0: 0.0746054519368723}
2025-06-06 10:55:49,785 - INFO -   Test label distribution: {1: 0.7424242424242424, 0: 0.25757575757575757}
2025-06-06 10:55:49,788 - INFO - Fold 3:
2025-06-06 10:55:49,788 - INFO -   Train label distribution: {-1: 0.7159253945480631, 1: 0.20946915351506457, 0: 0.0746054519368723}
2025-06-06 10:55:49,788 - INFO -   Test label distribution: {1: 0.7348484848484849, 0: 0.26515151515151514}
Stringifying the column:   0%|          | 0/896 [00:00<?, ? examples/s]Stringifying the column: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 896/896 [00:00<00:00, 119680.79 examples/s]
Casting to class labels:   0%|          | 0/896 [00:00<?, ? examples/s]Casting to class labels: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 896/896 [00:00<00:00, 147816.88 examples/s]
2025-06-06 10:55:49,830 - INFO - Number of positives : 293
2025-06-06 10:55:49,831 - INFO - Number of negatives : 603
2025-06-06 10:55:49,835 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-06 10:55:52,914 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': 0.7368421052631579, 'MCC': 0.0, 'NDCG': 0.9189307109272616, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-06 10:55:52,917 - INFO - Confusion matrix: TN=35, FP=0, FN=98, TP=0
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-06-06 10:55:55,585 - INFO - Metrics: {'f1': 0.0, 'recall': 0.0, 'precision': 0.0, 'accuracy': 0.2631578947368421, 'AP': 0.7368421052631579, 'MCC': 0.0, 'NDCG': 0.9189307109272616, 'kappa': 0.0, 'TN': 35, 'FP': 0, 'FN': 98, 'TP': 0}
2025-06-06 10:55:55,590 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-06 10:55:58,442 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': 0.7424242424242424, 'MCC': 0.0, 'NDCG': 0.9208012714375936, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-06 10:55:58,444 - INFO - Confusion matrix: TN=34, FP=0, FN=98, TP=0
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-06-06 10:56:01,423 - INFO - Metrics: {'f1': 0.0, 'recall': 0.0, 'precision': 0.0, 'accuracy': 0.25757575757575757, 'AP': 0.7424242424242424, 'MCC': 0.0, 'NDCG': 0.9208012714375936, 'kappa': 0.0, 'TN': 34, 'FP': 0, 'FN': 98, 'TP': 0}
2025-06-06 10:56:01,427 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-06 10:56:04,731 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': 0.7348484848484849, 'MCC': 0.0, 'NDCG': 0.9181159076123374, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-06 10:56:04,734 - INFO - Confusion matrix: TN=35, FP=0, FN=97, TP=0
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-06-06 10:56:07,729 - INFO - Metrics: {'f1': 0.0, 'recall': 0.0, 'precision': 0.0, 'accuracy': 0.26515151515151514, 'AP': 0.7348484848484849, 'MCC': 0.0, 'NDCG': 0.9181159076123374, 'kappa': 0.0, 'TN': 35, 'FP': 0, 'FN': 97, 'TP': 0}
2025-06-06 10:56:07,731 - INFO - Pipeline for loss type None and ensemble=True
2025-06-06 10:56:07,731 - INFO - with_title : True
2025-06-06 10:56:07,731 - INFO - with_keywords : True
2025-06-06 10:56:07,732 - INFO - fold indexes for run no.1: [[159, 206, 117, 82, 317, 330, 131, 380, 183, 158, 213, 260, 155, 332, 303, 269, 40, 232, 314, 244, 168, 218, 254, 100, 3, 235, 105, 243, 352, 394, 196, 223, 230, 307, 342, 289, 135, 7, 189, 134, 78, 133, 12, 375, 109, 46, 62, 393, 167, 151, 387, 374, 276, 323, 132, 319, 114, 176, 322, 263, 258, 266, 250, 329, 309, 367, 24, 229, 370, 211, 228, 346, 115, 392, 87, 88, 81, 343, 253, 278, 43, 333, 28, 80, 191, 10, 378, 388, 225, 363, 136, 104, 356, 8, 57, 162, 220, 391, 139, 386, 282, 70, 61, 170, 102, 296, 64, 35, 4, 251, 279, 44, 373, 129, 236, 327, 187, 68, 245, 215, 18, 42, 116, 212, 376, 148, 126, 27, 252, 173, 103, 336, 209, 199, 169, 283, 32, 246, 292, 210, 247, 141, 73, 194, 59, 385, 354, 51, 305, 200, 344, 179, 178, 355, 313, 112, 291, 23, 328, 130, 315, 181, 138, 94, 95, 121, 207, 175, 295, 321, 34, 300, 262, 33, 341, 54, 299, 48, 30, 204, 123, 331, 301, 150, 157, 265, 14, 53, 396, 242, 377, 366, 93, 214, 83, 52, 6, 188, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 532, 533, 534, 535, 536, 537, 538, 539, 540, 541, 542, 543, 544, 545, 546, 547, 548, 549, 550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 560, 561, 562, 563, 564, 565, 566, 567, 568, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582, 583, 584, 585, 586, 587, 588, 589, 590, 591, 592, 593, 594, 595, 596, 597, 598, 599, 600, 601, 602, 603, 604, 605, 606, 607, 608, 609, 610, 611, 612, 613, 614, 615, 616, 617, 618, 619, 620, 621, 622, 623, 624, 625, 626, 627, 628, 629, 630, 631, 632, 633, 634, 635, 636, 637, 638, 639, 640, 641, 642, 643, 644, 645, 646, 647, 648, 649, 650, 651, 652, 653, 654, 655, 656, 657, 658, 659, 660, 661, 662, 663, 664, 665, 666, 667, 668, 669, 670, 671, 672, 673, 674, 675, 676, 677, 678, 679, 680, 681, 682, 683, 684, 685, 686, 687, 688, 689, 690, 691, 692, 693, 694, 695, 696, 697, 698, 699, 700, 701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 714, 715, 716, 717, 718, 719, 720, 721, 722, 723, 724, 725, 726, 727, 728, 729, 730, 731, 732, 733, 734, 735, 736, 737, 738, 739, 740, 741, 742, 743, 744, 745, 746, 747, 748, 749, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764, 765, 766, 767, 768, 769, 770, 771, 772, 773, 774, 775, 776, 777, 778, 779, 780, 781, 782, 783, 784, 785, 786, 787, 788, 789, 790, 791, 792, 793, 794, 795, 796, 797, 798, 799, 800, 801, 802, 803, 804, 805, 806, 807, 808, 809, 810, 811, 812, 813, 814, 815, 816, 817, 818, 819, 820, 821, 822, 823, 824, 825, 826, 827, 828, 829, 830, 831, 832, 833, 834, 835, 836, 837, 838, 839, 840, 841, 842, 843, 844, 845, 846, 847, 848, 849, 850, 851, 852, 853, 854, 855, 856, 857, 858, 859, 860, 861, 862, 863, 864, 865, 866, 867, 868, 869, 870, 871, 872, 873, 874, 875, 876, 877, 878, 879, 880, 881, 882, 883, 884, 885, 886, 887, 888, 889, 890, 891, 892, 893, 894, 895], [177, 268, 97, 248, 298, 320, 224, 137, 161, 145, 339, 98, 39, 66, 17, 325, 226, 91, 348, 67, 55, 237, 273, 353, 381, 261, 31, 2, 290, 107, 38, 113, 120, 1, 222, 84, 358, 202, 63, 337, 92, 99, 144, 256, 19, 171, 219, 285, 274, 174, 118, 233, 156, 324, 284, 190, 255, 357, 205, 111, 72, 384, 294, 71, 163, 217], array([  0,   5,   9,  11,  13,  15,  16,  20,  21,  22,  25,  26,  29,
        36,  37,  41,  45,  47,  49,  50,  56,  58,  60,  65,  69,  74,
        75,  76,  77,  79,  85,  86,  89,  90,  96, 101, 106, 108, 110,
       119, 122, 124, 125, 127, 128, 140, 142, 143, 146, 147, 149, 152,
       153, 154, 160, 164, 165, 166, 172, 180, 182, 184, 185, 186, 192,
       193, 195, 197, 198, 201, 203, 208, 216, 221, 227, 231, 234, 238,
       239, 240, 241, 249, 257, 259, 264, 267, 270, 271, 272, 275, 277,
       280, 281, 286, 287, 288, 293, 297, 302, 304, 306, 308, 310, 311,
       312, 316, 318, 326, 334, 335, 338, 340, 345, 347, 349, 350, 351,
       359, 360, 361, 362, 364, 365, 368, 369, 371, 372, 379, 382, 383,
       389, 390, 395])]
2025-06-06 10:56:07,732 - INFO - Run no 1/2
2025-06-06 10:56:07,732 - INFO - Loss Type : BCE
2025-06-06 10:56:07,732 - INFO - Ensemble learning pipeline
2025-06-06 10:56:07,732 - INFO - Training model 1/2: dmis-lab/biobert-v1.1
2025-06-06 10:56:07,932 - INFO - 
fold number 1 / 3
2025-06-06 10:56:07,938 - INFO - train split size : 697
2025-06-06 10:56:07,939 - INFO - dev split size : 66
2025-06-06 10:56:07,939 - INFO - test split size : 133
Map (num_proc=32):   0%|          | 0/697 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 22/697 [00:00<00:04, 138.91 examples/s]Map (num_proc=32):  16%|â–ˆâ–Œ        | 110/697 [00:00<00:01, 440.96 examples/s]Map (num_proc=32):  28%|â–ˆâ–ˆâ–Š       | 198/697 [00:00<00:00, 584.11 examples/s]Map (num_proc=32):  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 308/697 [00:00<00:00, 715.73 examples/s]Map (num_proc=32):  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 396/697 [00:00<00:00, 732.67 examples/s]Map (num_proc=32):  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 484/697 [00:00<00:00, 730.89 examples/s]Map (num_proc=32):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 571/697 [00:00<00:00, 757.69 examples/s]Map (num_proc=32):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 655/697 [00:00<00:00, 752.77 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 697/697 [00:01<00:00, 628.10 examples/s]
Map (num_proc=32):   0%|          | 0/66 [00:00<?, ? examples/s]Map (num_proc=32):   5%|â–         | 3/66 [00:00<00:02, 27.22 examples/s]Map (num_proc=32):  18%|â–ˆâ–Š        | 12/66 [00:00<00:00, 58.05 examples/s]Map (num_proc=32):  30%|â–ˆâ–ˆâ–ˆ       | 20/66 [00:00<00:00, 67.17 examples/s]Map (num_proc=32):  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 28/66 [00:00<00:00, 69.53 examples/s]Map (num_proc=32):  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 38/66 [00:00<00:00, 76.40 examples/s]Map (num_proc=32):  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 46/66 [00:00<00:00, 75.36 examples/s]Map (num_proc=32):  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 56/66 [00:00<00:00, 78.09 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 64/66 [00:00<00:00, 76.00 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 66/66 [00:00<00:00, 66.23 examples/s]
Map (num_proc=32):   0%|          | 0/133 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/133 [00:00<00:03, 40.15 examples/s]Map (num_proc=32):  19%|â–ˆâ–‰        | 25/133 [00:00<00:00, 121.42 examples/s]Map (num_proc=32):  34%|â–ˆâ–ˆâ–ˆâ–      | 45/133 [00:00<00:00, 138.06 examples/s]Map (num_proc=32):  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 61/133 [00:00<00:00, 139.69 examples/s]Map (num_proc=32):  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 81/133 [00:00<00:00, 150.27 examples/s]Map (num_proc=32):  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 97/133 [00:00<00:00, 151.29 examples/s]Map (num_proc=32):  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 117/133 [00:00<00:00, 156.90 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 133/133 [00:00<00:00, 133.36 examples/s]
2025-06-06 10:56:12,757 - INFO - 3 datasets tokenized successfully
2025-06-06 10:56:12,759 - INFO - Starting hyperparameter search for BCE loss
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-06_10-56-12   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_10-56-12
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-06_10-55-47_424551_3536632/artifacts/2025-06-06_10-56-12/train_hpo_2025-06-06_10-56-12/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-06 10:56:14. Total running time: 0s
Logical resource usage: 0/32 CPUs, 0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_e4a2c81a   PENDING         8.49369       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_e4a2c81a started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_e4a2c81a config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          8.49369 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3540104)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3540104)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3540104)[0m 2025-06-06 10:56:21,875 - INFO - pos_weight value in TrainingArguments : 8.493688290834637
[36m(train_hpo pid=3540104)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3540104)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3540104)[0m [2025-06-06 10:56:22,133] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3540104)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3540104)[0m   warnings.warn(
[36m(train_hpo pid=3540104)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=48, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_379c96b8 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_379c96b8 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          7.54953 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3540268)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3540268)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3540268)[0m 2025-06-06 10:56:28,749 - INFO - pos_weight value in TrainingArguments : 7.549531688595925
[36m(train_hpo pid=3540268)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3540268)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3540268)[0m [2025-06-06 10:56:29,059] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3540268)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3540268)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3540268)[0m   warnings.warn(

Trial train_hpo_31b32c63 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_31b32c63 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          8.94984 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3540627)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3540627)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3540627)[0m 2025-06-06 10:56:35,553 - INFO - pos_weight value in TrainingArguments : 8.949837496427758
[36m(train_hpo pid=3540627)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3540627)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3540627)[0m [2025-06-06 10:56:35,789] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3540627)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=24, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3540627)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3540627)[0m   warnings.warn(

Trial status: 3 RUNNING
Current time: 2025-06-06 10:56:44. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_e4a2c81a   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_379c96b8   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_31b32c63   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3540104)[0m {'loss': 1.7178, 'grad_norm': 4.711155891418457, 'learning_rate': 1.246338876535363e-06, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3540627)[0m {'loss': 1.2504, 'grad_norm': 4.033951282501221, 'learning_rate': 5.325452975187489e-05, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3540268)[0m {'loss': 1.6113, 'grad_norm': 3.423140525817871, 'learning_rate': 3.6443132246884782e-06, 'epoch': 0.9142857142857143}
Trial status: 3 RUNNING
Current time: 2025-06-06 10:57:14. Total running time: 1min 0s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_e4a2c81a   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_379c96b8   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_31b32c63   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3540104)[0m {'loss': 1.69, 'grad_norm': 4.880397319793701, 'learning_rate': 9.970711012282902e-07, 'epoch': 1.9142857142857141}[32m [repeated 2x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(train_hpo pid=3540627)[0m {'train_runtime': 37.7978, 'train_samples_per_second': 55.321, 'train_steps_per_second': 0.635, 'train_loss': 0.5313023341198763, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3540627)[0m STATE at ending of training  :  TrainerState(epoch=2.914285714285714, global_step=24, max_steps=24, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=515096932631760.0, log_history=[{'loss': 1.2504, 'grad_norm': 4.033951282501221, 'learning_rate': 5.325452975187489e-05, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.2819, 'grad_norm': 1.7515134811401367, 'learning_rate': 2.6627264875937445e-05, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 0.0616, 'grad_norm': 0.9429211616516113, 'learning_rate': 0.0, 'epoch': 2.914285714285714, 'step': 24}, {'train_runtime': 37.7978, 'train_samples_per_second': 55.321, 'train_steps_per_second': 0.635, 'total_flos': 515096932631760.0, 'train_loss': 0.5313023341198763, 'epoch': 2.914285714285714, 'step': 24}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3540627)[0m {'eval_loss': 0.09766991436481476, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.929643452167511, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.535, 'eval_samples_per_second': 18.671, 'eval_steps_per_second': 1.132, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3540627)[0m 2025-06-06 10:57:20,341 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3540627)[0m 2025-06-06 10:57:20,347 - INFO - eval_result: {'eval_loss': 0.09766991436481476, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.929643452167511, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.535, 'eval_samples_per_second': 18.671, 'eval_steps_per_second': 1.132, 'epoch': 2.914285714285714}

Trial train_hpo_31b32c63 finished iteration 1 at 2025-06-06 10:57:20. Total running time: 1min 6s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_31b32c63 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    45.6818 â”‚
â”‚ time_total_s                        45.6818 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               2.91429 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                                  1 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                             1 â”‚
â”‚ eval_f1                                   1 â”‚
â”‚ eval_kappa                                1 â”‚
â”‚ eval_loss                           0.09767 â”‚
â”‚ eval_optim_threshold                0.92964 â”‚
â”‚ eval_precision                            1 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                          3.535 â”‚
â”‚ eval_samples_per_second              18.671 â”‚
â”‚ eval_steps_per_second                 1.132 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 10:57:20,405 - INFO - Cleaning up trial 31b32c63
2025-06-06 10:57:20,405 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_10-56-12/train_hpo_31b32c63_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512_2025-06-06_10-56-27

Trial train_hpo_31b32c63 completed after 1 iterations at 2025-06-06 10:57:20. Total running time: 1min 6s
[36m(train_hpo pid=3540627)[0m 2025-06-06 10:57:20,382 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3540268)[0m {'loss': 1.49, 'grad_norm': 2.904618978500366, 'learning_rate': 2.7332349185163582e-06, 'epoch': 1.9142857142857141}[32m [repeated 2x across cluster][0m

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 10:57:44. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_e4a2c81a   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_379c96b8   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_31b32c63   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.6818     0.0976699           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3540104)[0m {'loss': 1.6697, 'grad_norm': 3.082207202911377, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3540268)[0m {'loss': 1.4081, 'grad_norm': 7.212014675140381, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.914285714285714}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 10:58:14. Total running time: 2min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_e4a2c81a   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_379c96b8   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_31b32c63   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.6818     0.0976699           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3540104)[0m {'loss': 1.6428, 'grad_norm': 1.5216355323791504, 'learning_rate': 4.985355506141451e-07, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3540268)[0m {'loss': 1.3551, 'grad_norm': 6.769514083862305, 'learning_rate': 9.110783061721196e-07, 'epoch': 3.914285714285714}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 10:58:44. Total running time: 2min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_e4a2c81a   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_379c96b8   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_31b32c63   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.6818     0.0976699           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3540104)[0m {'loss': 1.6454, 'grad_norm': 10.38155746459961, 'learning_rate': 2.4926777530707256e-07, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3540268)[0m {'loss': 1.2704, 'grad_norm': 6.923252582550049, 'learning_rate': 0.0, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3540268)[0m {'train_runtime': 146.9348, 'train_samples_per_second': 23.718, 'train_steps_per_second': 0.272, 'train_loss': 1.4269941568374633, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3540268)[0m STATE at ending of training  :  TrainerState(epoch=4.914285714285715, global_step=40, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=862318185914640.0, log_history=[{'loss': 1.6113, 'grad_norm': 3.423140525817871, 'learning_rate': 3.6443132246884782e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 1.49, 'grad_norm': 2.904618978500366, 'learning_rate': 2.7332349185163582e-06, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 1.4081, 'grad_norm': 7.212014675140381, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 1.3551, 'grad_norm': 6.769514083862305, 'learning_rate': 9.110783061721196e-07, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 1.2704, 'grad_norm': 6.923252582550049, 'learning_rate': 0.0, 'epoch': 4.914285714285715, 'step': 40}, {'train_runtime': 146.9348, 'train_samples_per_second': 23.718, 'train_steps_per_second': 0.272, 'total_flos': 862318185914640.0, 'train_loss': 1.4269941568374633, 'epoch': 4.914285714285715, 'step': 40}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3540268)[0m 2025-06-06 10:59:03,174 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3540268)[0m 2025-06-06 10:59:03,180 - INFO - eval_result: {'eval_loss': 2.1694862842559814, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.6589074730873108, 'eval_AP': 0.9983159572991159, 'eval_MCC': 0.0, 'eval_NDCG': 0.9997060166227101, 'eval_kappa': 0.0, 'eval_runtime': 3.8876, 'eval_samples_per_second': 16.977, 'eval_steps_per_second': 1.029, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3540268)[0m {'eval_loss': 2.1694862842559814, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.6589074730873108, 'eval_AP': 0.9983159572991159, 'eval_MCC': 0.0, 'eval_NDCG': 0.9997060166227101, 'eval_kappa': 0.0, 'eval_runtime': 3.8876, 'eval_samples_per_second': 16.977, 'eval_steps_per_second': 1.029, 'epoch': 4.914285714285715}

Trial train_hpo_379c96b8 finished iteration 1 at 2025-06-06 10:59:03. Total running time: 2min 49s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_379c96b8 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    155.382 â”‚
â”‚ time_total_s                        155.382 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               4.91429 â”‚
â”‚ eval_AP                             0.99832 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.99971 â”‚
â”‚ eval_accuracy                       0.74242 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           2.16949 â”‚
â”‚ eval_optim_threshold                0.65891 â”‚
â”‚ eval_precision                      0.74242 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.8876 â”‚
â”‚ eval_samples_per_second              16.977 â”‚
â”‚ eval_steps_per_second                 1.029 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 10:59:03,241 - INFO - Cleaning up trial 379c96b8
2025-06-06 10:59:03,241 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_10-56-12/train_hpo_379c96b8_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-06_10-56-20
2025-06-06 10:59:03,241 - INFO - Current best: 31b32c63 with eval_f1 : 1.0 at iteration 1

Trial train_hpo_379c96b8 completed after 1 iterations at 2025-06-06 10:59:03. Total running time: 2min 49s
[36m(train_hpo pid=3540268)[0m 2025-06-06 10:59:03,220 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3540104)[0m STATE at ending of training  :  TrainerState(epoch=5.914285714285715, global_step=48, max_steps=48, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=1035969923289360.0, log_history=[{'loss': 1.7178, 'grad_norm': 4.711155891418457, 'learning_rate': 1.246338876535363e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 1.69, 'grad_norm': 4.880397319793701, 'learning_rate': 9.970711012282902e-07, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 1.6697, 'grad_norm': 3.082207202911377, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 1.6428, 'grad_norm': 1.5216355323791504, 'learning_rate': 4.985355506141451e-07, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 1.6454, 'grad_norm': 10.38155746459961, 'learning_rate': 2.4926777530707256e-07, 'epoch': 4.914285714285715, 'step': 40}, {'loss': 1.6023, 'grad_norm': 5.270816326141357, 'learning_rate': 0.0, 'epoch': 5.914285714285715, 'step': 48}, {'train_runtime': 160.5375, 'train_samples_per_second': 26.05, 'train_steps_per_second': 0.299, 'total_flos': 1035969923289360.0, 'train_loss': 1.6613269646962483, 'epoch': 5.914285714285715, 'step': 48}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3540104)[0m {'loss': 1.6023, 'grad_norm': 5.270816326141357, 'learning_rate': 0.0, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3540104)[0m {'train_runtime': 160.5375, 'train_samples_per_second': 26.05, 'train_steps_per_second': 0.299, 'train_loss': 1.6613269646962483, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3540104)[0m 2025-06-06 10:59:09,302 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png

Trial train_hpo_e4a2c81a finished iteration 1 at 2025-06-06 10:59:09. Total running time: 2min 55s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_e4a2c81a result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    168.379 â”‚
â”‚ time_total_s                        168.379 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               5.91429 â”‚
â”‚ eval_AP                             0.93066 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.98611 â”‚
â”‚ eval_accuracy                       0.74242 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           3.19622 â”‚
â”‚ eval_optim_threshold                0.62518 â”‚
â”‚ eval_precision                      0.74242 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                          3.301 â”‚
â”‚ eval_samples_per_second              19.994 â”‚
â”‚ eval_steps_per_second                 1.212 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 10:59:09,365 - INFO - Cleaning up trial e4a2c81a
2025-06-06 10:59:09,365 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_10-56-12/train_hpo_e4a2c81a_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-06_10-56-13
2025-06-06 10:59:09,365 - INFO - Cleaning up trial 379c96b8
2025-06-06 10:59:09,365 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_10-56-12/train_hpo_379c96b8_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-06_10-56-20
2025-06-06 10:59:09,366 - INFO - Current best: 31b32c63 with eval_f1 : 1.0 at iteration 1

Trial train_hpo_e4a2c81a completed after 1 iterations at 2025-06-06 10:59:09. Total running time: 2min 55s
2025-06-06 10:59:09,372	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_10-56-12' in 0.0051s.

Trial status: 3 TERMINATED
Current time: 2025-06-06 10:59:09. Total running time: 2min 55s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_e4a2c81a   TERMINATED        8.49369       1.49561e-06         0.13641                     6        1           168.379      3.19622      0.852174               1          0.742424 â”‚
â”‚ train_hpo_379c96b8   TERMINATED        7.54953       4.55539e-06         0.123031                    5        1           155.382      2.16949      0.852174               1          0.742424 â”‚
â”‚ train_hpo_31b32c63   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.6818     0.0976699    1                      1          1        â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

2025-06-06 10:59:09,379 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x7016c29f0290>
2025-06-06 10:59:09,379 - INFO - Best trial : train_hpo_31b32c63
2025-06-06 10:59:09,379 - INFO - Best config : {'pos_weight': 8.949837496427758, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-06 10:59:09,379 - INFO - Best trial after optimization: {'eval_loss': 0.09766991436481476, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.929643452167511, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.535, 'eval_samples_per_second': 18.671, 'eval_steps_per_second': 1.132, 'epoch': 2.914285714285714, 'timestamp': 1749200240, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '31b32c63', 'date': '2025-06-06_10-57-20', 'time_this_iter_s': 45.68178629875183, 'time_total_s': 45.68178629875183, 'pid': 3540627, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 8.949837496427758, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 45.68178629875183, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512'}
2025-06-06 10:59:09,401 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   3.196222  0.852174  ...                        6  e4a2c81a
1   2.169486  0.852174  ...                        5  379c96b8
2   0.097670  1.000000  ...                        3  31b32c63

[3 rows x 32 columns]
[36m(train_hpo pid=3540104)[0m 2025-06-06 10:59:09,308 - INFO - eval_result: {'eval_loss': 3.1962215900421143, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.6251780390739441, 'eval_AP': 0.9306586313292439, 'eval_MCC': 0.0, 'eval_NDCG': 0.9861108375722991, 'eval_kappa': 0.0, 'eval_runtime': 3.301, 'eval_samples_per_second': 19.994, 'eval_steps_per_second': 1.212, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3540104)[0m 2025-06-06 10:59:09,342 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3540104)[0m {'eval_loss': 3.1962215900421143, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.6251780390739441, 'eval_AP': 0.9306586313292439, 'eval_MCC': 0.0, 'eval_NDCG': 0.9861108375722991, 'eval_kappa': 0.0, 'eval_runtime': 3.301, 'eval_samples_per_second': 19.994, 'eval_steps_per_second': 1.212, 'epoch': 5.914285714285715}
2025-06-06 10:59:09,539 - INFO - Trial comparison plot saved
2025-06-06 10:59:09,539 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-06 10:59:10,564 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
[2025-06-06 10:59:10,801] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2025-06-06 10:59:12,308 - INFO - training size : 697
2025-06-06 10:59:12,308 - INFO - dev size : 66
2025-06-06 10:59:12,308 - INFO - test size : 133
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
  0%|          | 0/90 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  1%|          | 1/90 [00:01<02:43,  1.84s/it]  2%|â–         | 2/90 [00:02<01:38,  1.12s/it]  3%|â–Ž         | 3/90 [00:03<01:17,  1.12it/s]  4%|â–         | 4/90 [00:03<01:07,  1.28it/s]  6%|â–Œ         | 5/90 [00:04<01:01,  1.39it/s]  7%|â–‹         | 6/90 [00:04<00:57,  1.46it/s]  8%|â–Š         | 7/90 [00:05<00:54,  1.51it/s]  9%|â–‰         | 8/90 [00:06<00:52,  1.55it/s] 10%|â–ˆ         | 9/90 [00:06<00:51,  1.57it/s] 11%|â–ˆ         | 10/90 [00:07<00:50,  1.59it/s] 12%|â–ˆâ–        | 11/90 [00:07<00:49,  1.60it/s] 13%|â–ˆâ–Ž        | 12/90 [00:08<00:48,  1.61it/s] 14%|â–ˆâ–        | 13/90 [00:09<00:47,  1.61it/s] 16%|â–ˆâ–Œ        | 14/90 [00:09<00:47,  1.62it/s] 17%|â–ˆâ–‹        | 15/90 [00:10<00:46,  1.62it/s] 18%|â–ˆâ–Š        | 16/90 [00:11<00:45,  1.62it/s] 19%|â–ˆâ–‰        | 17/90 [00:11<00:44,  1.62it/s] 20%|â–ˆâ–ˆ        | 18/90 [00:12<00:44,  1.62it/s] 21%|â–ˆâ–ˆ        | 19/90 [00:12<00:43,  1.63it/s] 22%|â–ˆâ–ˆâ–       | 20/90 [00:13<00:43,  1.63it/s] 23%|â–ˆâ–ˆâ–Ž       | 21/90 [00:14<00:42,  1.63it/s] 24%|â–ˆâ–ˆâ–       | 22/90 [00:14<00:41,  1.63it/s] 26%|â–ˆâ–ˆâ–Œ       | 23/90 [00:15<00:41,  1.63it/s] 27%|â–ˆâ–ˆâ–‹       | 24/90 [00:15<00:40,  1.63it/s] 28%|â–ˆâ–ˆâ–Š       | 25/90 [00:16<00:39,  1.63it/s] 29%|â–ˆâ–ˆâ–‰       | 26/90 [00:17<00:39,  1.63it/s] 30%|â–ˆâ–ˆâ–ˆ       | 27/90 [00:17<00:38,  1.63it/s] 31%|â–ˆâ–ˆâ–ˆ       | 28/90 [00:18<00:38,  1.63it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 29/90 [00:19<00:37,  1.64it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 30/90 [00:19<00:27,  2.17it/s]                                               {'loss': 0.4684, 'grad_norm': 0.21828757226467133, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 30/90 [00:19<00:27,  2.17it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 31/90 [00:19<00:30,  1.95it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 32/90 [00:20<00:31,  1.84it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 33/90 [00:21<00:32,  1.77it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 34/90 [00:21<00:32,  1.72it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 35/90 [00:22<00:32,  1.69it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 36/90 [00:22<00:32,  1.67it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 37/90 [00:23<00:32,  1.66it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 38/90 [00:24<00:31,  1.65it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 39/90 [00:24<00:31,  1.64it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 40/90 [00:25<00:30,  1.65it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 41/90 [00:25<00:29,  1.64it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 42/90 [00:26<00:29,  1.64it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 43/90 [00:27<00:28,  1.64it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 44/90 [00:27<00:28,  1.63it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 45/90 [00:28<00:27,  1.63it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 46/90 [00:28<00:27,  1.63it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 47/90 [00:29<00:26,  1.63it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 48/90 [00:30<00:25,  1.63it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 49/90 [00:30<00:25,  1.63it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 50/90 [00:31<00:24,  1.63it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 51/90 [00:32<00:23,  1.63it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 52/90 [00:32<00:23,  1.63it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 53/90 [00:33<00:22,  1.63it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 54/90 [00:33<00:22,  1.63it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 55/90 [00:34<00:21,  1.63it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 56/90 [00:35<00:20,  1.63it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 57/90 [00:35<00:20,  1.63it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 58/90 [00:36<00:19,  1.63it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 59/90 [00:36<00:18,  1.64it/s]                                               {'loss': 0.0049, 'grad_norm': 0.08310385793447495, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 60/90 [00:36<00:18,  1.64it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 61/90 [00:37<00:14,  2.07it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 62/90 [00:38<00:14,  1.94it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 63/90 [00:38<00:14,  1.85it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 64/90 [00:39<00:14,  1.78it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 65/90 [00:40<00:14,  1.73it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 66/90 [00:40<00:14,  1.70it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 67/90 [00:41<00:13,  1.68it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 68/90 [00:41<00:13,  1.67it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 69/90 [00:42<00:12,  1.66it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 70/90 [00:43<00:12,  1.65it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 71/90 [00:43<00:11,  1.64it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 72/90 [00:44<00:11,  1.64it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 73/90 [00:44<00:10,  1.63it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 74/90 [00:45<00:09,  1.63it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 75/90 [00:46<00:09,  1.63it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 76/90 [00:46<00:08,  1.63it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 77/90 [00:47<00:07,  1.63it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 78/90 [00:48<00:07,  1.63it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 79/90 [00:48<00:06,  1.63it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 80/90 [00:49<00:06,  1.63it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 81/90 [00:49<00:05,  1.63it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 82/90 [00:50<00:04,  1.62it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 83/90 [00:51<00:04,  1.62it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 84/90 [00:51<00:03,  1.63it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 85/90 [00:52<00:03,  1.63it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 86/90 [00:52<00:02,  1.63it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 87/90 [00:53<00:01,  1.63it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 88/90 [00:54<00:01,  1.63it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 89/90 [00:54<00:00,  1.64it/s]                                               {'loss': 0.0026, 'grad_norm': 0.051675036549568176, 'learning_rate': 0.0, 'epoch': 3.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.64it/s]                                               {'train_runtime': 56.9598, 'train_samples_per_second': 36.71, 'train_steps_per_second': 1.58, 'train_loss': 0.15860760973559485, 'epoch': 3.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.64it/s]2025-06-06 11:00:09,659 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.58it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.32it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.65it/s]2025-06-06 11:00:13,183 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.07s/it]
2025-06-06 11:00:13,189 - INFO - Training time : 63.65013051102869
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.16it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.06it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.38it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.12it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.27it/s]2025-06-06 11:00:17,544 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.48it/s]
2025-06-06 11:00:17,549 - INFO - Evaluation time : 4.3593813930638134
2025-06-06 11:00:17,549 - INFO - Evaluation results on test set: {'eval_loss': 0.04410023242235184, 'eval_f1': 0.9949238578680203, 'eval_recall': 1.0, 'eval_accuracy': 0.9924812030075187, 'eval_precision': 0.98989898989899, 'eval_optim_threshold': 0.9997872710227966, 'eval_AP': 1.0, 'eval_MCC': 0.9806202943118002, 'eval_NDCG': 1.0000000000000004, 'eval_kappa': 0.98043254376931, 'eval_runtime': 4.355, 'eval_samples_per_second': 30.54, 'eval_steps_per_second': 1.378, 'epoch': 3.0}
2025-06-06 11:00:17,549 - INFO - Total updates (optimizer steps): 90
2025-06-06 11:00:17,549 - INFO - Avg time / step: 0.633s
2025-06-06 11:00:18,724 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCEdmis-lab/biobert-v1.13trials_fold-1
2025-06-06 11:00:18,724 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.15it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.06it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.39it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.13it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.27it/s]2025-06-06 11:00:23,110 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.47it/s]
2025-06-06 11:00:23,114 - INFO - preds : [1 1 1 0 0 1 1 1 1 1 1 1 0 0 1 0 1 0 1 1 1 0 1 1 0 0 1 0 0 0 0 1 1 1 1 1 1
 1 1 1 0 1 1 0 0 1 1 1 1 1 1 1 1 0 0 1 1 1 1 0 1 1 1 1 1 0 1 1 0 1 1 1 1 1
 0 1 0 1 0 0 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 0 0 1 0 1 1 1
 1 0 0 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 0]
2025-06-06 11:00:23,115 - INFO - test_split["labels"] : [1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0]
2025-06-06 11:00:23,116 - INFO - Confusion matrix: TN=34, FP=1, FN=0, TP=98
2025-06-06 11:00:25,909 - INFO - Metrics: {'f1': 0.9949238578680203, 'recall': 1.0, 'precision': 0.98989898989899, 'accuracy': 0.9924812030075187, 'AP': 1.0, 'MCC': 0.9806202943118002, 'NDCG': 1.0000000000000004, 'kappa': 0.98043254376931, 'TN': 34, 'FP': 1, 'FN': 0, 'TP': 98}
2025-06-06 11:00:26,038 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-06 11:00:26,138 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 11:00:26,138 - INFO - 
On test Set (optimal threshold of 0.999782145023346 according to cross validation on the training set): 
2025-06-06 11:00:26,140 - INFO - Confusion matrix: TN=35, FP=0, FN=0, TP=98
2025-06-06 11:00:28,946 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 35, 'FP': 0, 'FN': 0, 'TP': 98}
2025-06-06 11:00:29,039 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 11:00:29,039 - INFO - Results for fold 1 : [{'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 35, 'FP': 0, 'FN': 0, 'TP': 98}]
2025-06-06 11:00:29,150 - INFO - Cleared CUDA cache. Memory allocated: 1.39 GB, Memory reserved: 1.76 GB
2025-06-06 11:00:29,150 - INFO - 
fold number 2 / 3
2025-06-06 11:00:29,156 - INFO - train split size : 697
2025-06-06 11:00:29,156 - INFO - dev split size : 67
2025-06-06 11:00:29,156 - INFO - test split size : 132
Map (num_proc=32):   0%|          | 0/697 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 22/697 [00:00<00:05, 116.63 examples/s]Map (num_proc=32):  19%|â–ˆâ–‰        | 132/697 [00:00<00:01, 488.53 examples/s]Map (num_proc=32):  38%|â–ˆâ–ˆâ–ˆâ–Š      | 264/697 [00:00<00:00, 776.24 examples/s]Map (num_proc=32):  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 396/697 [00:00<00:00, 936.42 examples/s]Map (num_proc=32):  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 506/697 [00:00<00:00, 963.50 examples/s]Map (num_proc=32):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 655/697 [00:00<00:00, 1058.58 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 697/697 [00:00<00:00, 766.81 examples/s] 
Map (num_proc=32):   0%|          | 0/67 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/67 [00:00<00:04, 15.90 examples/s]Map (num_proc=32):  22%|â–ˆâ–ˆâ–       | 15/67 [00:00<00:00, 60.14 examples/s]Map (num_proc=32):  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 27/67 [00:00<00:00, 81.05 examples/s]Map (num_proc=32):  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 39/67 [00:00<00:00, 85.36 examples/s]Map (num_proc=32):  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 51/67 [00:00<00:00, 95.69 examples/s]Map (num_proc=32):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 63/67 [00:00<00:00, 97.84 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:00<00:00, 75.05 examples/s]
Map (num_proc=32):   0%|          | 0/132 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/132 [00:00<00:04, 26.58 examples/s]Map (num_proc=32):  24%|â–ˆâ–ˆâ–       | 32/132 [00:00<00:00, 124.60 examples/s]Map (num_proc=32):  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 56/132 [00:00<00:00, 162.39 examples/s]Map (num_proc=32):  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 80/132 [00:00<00:00, 180.14 examples/s]Map (num_proc=32):  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 100/132 [00:00<00:00, 184.16 examples/s]Map (num_proc=32):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 124/132 [00:00<00:00, 195.29 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 132/132 [00:00<00:00, 150.03 examples/s]
2025-06-06 11:00:36,740 - INFO - 3 datasets tokenized successfully
2025-06-06 11:00:36,742 - INFO - Starting hyperparameter search for BCE loss
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-06_11-00-36   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-00-36
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-06_10-55-47_424551_3536632/artifacts/2025-06-06_11-00-36/train_hpo_2025-06-06_11-00-36/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-06 11:00:36. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_e518530b   PENDING         8.49369       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_e518530b started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_e518530b config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          8.49369 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3545469)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3545469)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3545469)[0m 2025-06-06 11:00:44,679 - INFO - pos_weight value in TrainingArguments : 8.493688290834637
[36m(train_hpo pid=3545469)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3545469)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3545469)[0m [2025-06-06 11:00:44,917] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3545469)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3545469)[0m   warnings.warn(
[36m(train_hpo pid=3545469)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=48, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_b5f53ac1 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_b5f53ac1 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          7.54953 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3545701)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3545701)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3545701)[0m 2025-06-06 11:00:51,409 - INFO - pos_weight value in TrainingArguments : 7.549531688595925
[36m(train_hpo pid=3545701)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3545701)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3545701)[0m [2025-06-06 11:00:51,798] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3545701)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3545701)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3545701)[0m   warnings.warn(

Trial train_hpo_4c3478e1 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_4c3478e1 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          8.94984 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3545917)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3545917)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3545917)[0m 2025-06-06 11:00:58,118 - INFO - pos_weight value in TrainingArguments : 8.949837496427758
[36m(train_hpo pid=3545917)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3545917)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3545917)[0m [2025-06-06 11:00:58,348] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3545917)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=24, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3545917)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3545917)[0m   warnings.warn(

Trial status: 3 RUNNING
Current time: 2025-06-06 11:01:07. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_e518530b   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_b5f53ac1   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_4c3478e1   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3545469)[0m {'loss': 1.7588, 'grad_norm': 6.49442720413208, 'learning_rate': 1.246338876535363e-06, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3545917)[0m {'loss': 1.2064, 'grad_norm': 8.75601863861084, 'learning_rate': 5.325452975187489e-05, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3545701)[0m {'loss': 1.5589, 'grad_norm': 1.5160973072052002, 'learning_rate': 3.6443132246884782e-06, 'epoch': 0.9142857142857143}
Trial status: 3 RUNNING
Current time: 2025-06-06 11:01:37. Total running time: 1min 0s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_e518530b   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_b5f53ac1   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_4c3478e1   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3545469)[0m {'loss': 1.6904, 'grad_norm': 6.642016887664795, 'learning_rate': 9.970711012282902e-07, 'epoch': 1.9142857142857141}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3545917)[0m {'train_runtime': 37.9291, 'train_samples_per_second': 55.129, 'train_steps_per_second': 0.633, 'train_loss': 0.5362243900696436, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3545917)[0m STATE at ending of training  :  TrainerState(epoch=2.914285714285714, global_step=24, max_steps=24, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=515590261431120.0, log_history=[{'loss': 1.2064, 'grad_norm': 8.75601863861084, 'learning_rate': 5.325452975187489e-05, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.3048, 'grad_norm': 2.8221936225891113, 'learning_rate': 2.6627264875937445e-05, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 0.0974, 'grad_norm': 1.5103058815002441, 'learning_rate': 0.0, 'epoch': 2.914285714285714, 'step': 24}, {'train_runtime': 37.9291, 'train_samples_per_second': 55.129, 'train_steps_per_second': 0.633, 'total_flos': 515590261431120.0, 'train_loss': 0.5362243900696436, 'epoch': 2.914285714285714, 'step': 24}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3545917)[0m 2025-06-06 11:01:42,930 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3545917)[0m 2025-06-06 11:01:42,935 - INFO - eval_result: {'eval_loss': 0.12925028800964355, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9779971241950989, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.3828, 'eval_samples_per_second': 19.806, 'eval_steps_per_second': 1.182, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3545917)[0m {'eval_loss': 0.12925028800964355, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9779971241950989, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.3828, 'eval_samples_per_second': 19.806, 'eval_steps_per_second': 1.182, 'epoch': 2.914285714285714}

Trial train_hpo_4c3478e1 finished iteration 1 at 2025-06-06 11:01:42. Total running time: 1min 6s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_4c3478e1 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    45.7323 â”‚
â”‚ time_total_s                        45.7323 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               2.91429 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                                  1 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                             1 â”‚
â”‚ eval_f1                                   1 â”‚
â”‚ eval_kappa                                1 â”‚
â”‚ eval_loss                           0.12925 â”‚
â”‚ eval_optim_threshold                  0.978 â”‚
â”‚ eval_precision                            1 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.3828 â”‚
â”‚ eval_samples_per_second              19.806 â”‚
â”‚ eval_steps_per_second                 1.182 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:01:42,998 - INFO - Cleaning up trial 4c3478e1
2025-06-06 11:01:42,998 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-00-36/train_hpo_4c3478e1_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512_2025-06-06_11-00-50

Trial train_hpo_4c3478e1 completed after 1 iterations at 2025-06-06 11:01:42. Total running time: 1min 6s
[36m(train_hpo pid=3545917)[0m 2025-06-06 11:01:42,973 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3545701)[0m {'loss': 1.4964, 'grad_norm': 1.9661580324172974, 'learning_rate': 2.7332349185163582e-06, 'epoch': 1.9142857142857141}[32m [repeated 2x across cluster][0m

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:02:07. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_e518530b   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_b5f53ac1   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_4c3478e1   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.7323       0.12925           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3545469)[0m {'loss': 1.6597, 'grad_norm': 4.187003135681152, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3545701)[0m {'loss': 1.4421, 'grad_norm': 2.5958783626556396, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.914285714285714}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:02:37. Total running time: 2min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_e518530b   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_b5f53ac1   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_4c3478e1   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.7323       0.12925           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3545469)[0m {'loss': 1.6153, 'grad_norm': 2.344951868057251, 'learning_rate': 4.985355506141451e-07, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3545701)[0m {'loss': 1.3731, 'grad_norm': 3.9730827808380127, 'learning_rate': 9.110783061721196e-07, 'epoch': 3.914285714285714}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:03:07. Total running time: 2min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_e518530b   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_b5f53ac1   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_4c3478e1   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.7323       0.12925           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3545469)[0m {'loss': 1.6187, 'grad_norm': 10.537334442138672, 'learning_rate': 2.4926777530707256e-07, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3545701)[0m {'loss': 1.3062, 'grad_norm': 5.267052173614502, 'learning_rate': 0.0, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3545701)[0m {'train_runtime': 147.7098, 'train_samples_per_second': 23.594, 'train_steps_per_second': 0.271, 'train_loss': 1.4353350400924683, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3545701)[0m STATE at ending of training  :  TrainerState(epoch=4.914285714285715, global_step=40, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=862780681664040.0, log_history=[{'loss': 1.5589, 'grad_norm': 1.5160973072052002, 'learning_rate': 3.6443132246884782e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 1.4964, 'grad_norm': 1.9661580324172974, 'learning_rate': 2.7332349185163582e-06, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 1.4421, 'grad_norm': 2.5958783626556396, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 1.3731, 'grad_norm': 3.9730827808380127, 'learning_rate': 9.110783061721196e-07, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 1.3062, 'grad_norm': 5.267052173614502, 'learning_rate': 0.0, 'epoch': 4.914285714285715, 'step': 40}, {'train_runtime': 147.7098, 'train_samples_per_second': 23.594, 'train_steps_per_second': 0.271, 'total_flos': 862780681664040.0, 'train_loss': 1.4353350400924683, 'epoch': 4.914285714285715, 'step': 40}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_b5f53ac1 finished iteration 1 at 2025-06-06 11:03:26. Total running time: 2min 49s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_b5f53ac1 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    156.157 â”‚
â”‚ time_total_s                        156.157 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               4.91429 â”‚
â”‚ eval_AP                             0.99562 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.99923 â”‚
â”‚ eval_accuracy                       0.73134 â”‚
â”‚ eval_f1                             0.84483 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           2.12316 â”‚
â”‚ eval_optim_threshold                0.68743 â”‚
â”‚ eval_precision                      0.73134 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.9089 â”‚
â”‚ eval_samples_per_second               17.14 â”‚
â”‚ eval_steps_per_second                 1.023 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:03:26,712 - INFO - Cleaning up trial b5f53ac1
2025-06-06 11:03:26,712 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-00-36/train_hpo_b5f53ac1_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-06_11-00-43
2025-06-06 11:03:26,713 - INFO - Current best: 4c3478e1 with eval_f1 : 1.0 at iteration 1

Trial train_hpo_b5f53ac1 completed after 1 iterations at 2025-06-06 11:03:26. Total running time: 2min 49s
[36m(train_hpo pid=3545701)[0m 2025-06-06 11:03:26,636 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3545701)[0m 2025-06-06 11:03:26,641 - INFO - eval_result: {'eval_loss': 2.123163938522339, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.6874347925186157, 'eval_AP': 0.9956227000548659, 'eval_MCC': 0.0, 'eval_NDCG': 0.9992307359610082, 'eval_kappa': 0.0, 'eval_runtime': 3.9089, 'eval_samples_per_second': 17.14, 'eval_steps_per_second': 1.023, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3545701)[0m 2025-06-06 11:03:26,689 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3545701)[0m {'eval_loss': 2.123163938522339, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.6874347925186157, 'eval_AP': 0.9956227000548659, 'eval_MCC': 0.0, 'eval_NDCG': 0.9992307359610082, 'eval_kappa': 0.0, 'eval_runtime': 3.9089, 'eval_samples_per_second': 17.14, 'eval_steps_per_second': 1.023, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3545469)[0m STATE at ending of training  :  TrainerState(epoch=5.914285714285715, global_step=48, max_steps=48, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=1036432419038760.0, log_history=[{'loss': 1.7588, 'grad_norm': 6.49442720413208, 'learning_rate': 1.246338876535363e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 1.6904, 'grad_norm': 6.642016887664795, 'learning_rate': 9.970711012282902e-07, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 1.6597, 'grad_norm': 4.187003135681152, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 1.6153, 'grad_norm': 2.344951868057251, 'learning_rate': 4.985355506141451e-07, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 1.6187, 'grad_norm': 10.537334442138672, 'learning_rate': 2.4926777530707256e-07, 'epoch': 4.914285714285715, 'step': 40}, {'loss': 1.5875, 'grad_norm': 6.755363464355469, 'learning_rate': 0.0, 'epoch': 5.914285714285715, 'step': 48}, {'train_runtime': 161.2299, 'train_samples_per_second': 25.938, 'train_steps_per_second': 0.298, 'total_flos': 1036432419038760.0, 'train_loss': 1.6550828218460083, 'epoch': 5.914285714285715, 'step': 48}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3545469)[0m {'loss': 1.5875, 'grad_norm': 6.755363464355469, 'learning_rate': 0.0, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3545469)[0m {'train_runtime': 161.2299, 'train_samples_per_second': 25.938, 'train_steps_per_second': 0.298, 'train_loss': 1.6550828218460083, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3545469)[0m 2025-06-06 11:03:32,982 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3545469)[0m 2025-06-06 11:03:32,988 - INFO - eval_result: {'eval_loss': 3.2931389808654785, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.6019651293754578, 'eval_AP': 0.9779190165920358, 'eval_MCC': 0.0, 'eval_NDCG': 0.9959356442418683, 'eval_kappa': 0.0, 'eval_runtime': 3.4582, 'eval_samples_per_second': 19.374, 'eval_steps_per_second': 1.157, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3545469)[0m {'eval_loss': 3.2931389808654785, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.6019651293754578, 'eval_AP': 0.9779190165920358, 'eval_MCC': 0.0, 'eval_NDCG': 0.9959356442418683, 'eval_kappa': 0.0, 'eval_runtime': 3.4582, 'eval_samples_per_second': 19.374, 'eval_steps_per_second': 1.157, 'epoch': 5.914285714285715}

Trial train_hpo_e518530b finished iteration 1 at 2025-06-06 11:03:33. Total running time: 2min 56s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_e518530b result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    169.269 â”‚
â”‚ time_total_s                        169.269 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               5.91429 â”‚
â”‚ eval_AP                             0.97792 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.99594 â”‚
â”‚ eval_accuracy                       0.73134 â”‚
â”‚ eval_f1                             0.84483 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           3.29314 â”‚
â”‚ eval_optim_threshold                0.60197 â”‚
â”‚ eval_precision                      0.73134 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.4582 â”‚
â”‚ eval_samples_per_second              19.374 â”‚
â”‚ eval_steps_per_second                 1.157 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:03:33,048 - INFO - Cleaning up trial e518530b
2025-06-06 11:03:33,048 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-00-36/train_hpo_e518530b_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-06_11-00-36
2025-06-06 11:03:33,049 - INFO - Cleaning up trial b5f53ac1
2025-06-06 11:03:33,049 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-00-36/train_hpo_b5f53ac1_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-06_11-00-43
2025-06-06 11:03:33,049 - INFO - Current best: 4c3478e1 with eval_f1 : 1.0 at iteration 1

Trial train_hpo_e518530b completed after 1 iterations at 2025-06-06 11:03:33. Total running time: 2min 56s
2025-06-06 11:03:33,055	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-00-36' in 0.0048s.

Trial status: 3 TERMINATED
Current time: 2025-06-06 11:03:33. Total running time: 2min 56s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_e518530b   TERMINATED        8.49369       1.49561e-06         0.13641                     6        1           169.269        3.29314    0.844828               1          0.731343 â”‚
â”‚ train_hpo_b5f53ac1   TERMINATED        7.54953       4.55539e-06         0.123031                    5        1           156.157        2.12316    0.844828               1          0.731343 â”‚
â”‚ train_hpo_4c3478e1   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.7323       0.12925    1                      1          1        â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

2025-06-06 11:03:33,062 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x700d3bf80fd0>
2025-06-06 11:03:33,062 - INFO - Best trial : train_hpo_4c3478e1
2025-06-06 11:03:33,063 - INFO - Best config : {'pos_weight': 8.949837496427758, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-06 11:03:33,063 - INFO - Best trial after optimization: {'eval_loss': 0.12925028800964355, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9779971241950989, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.3828, 'eval_samples_per_second': 19.806, 'eval_steps_per_second': 1.182, 'epoch': 2.914285714285714, 'timestamp': 1749200502, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '4c3478e1', 'date': '2025-06-06_11-01-42', 'time_this_iter_s': 45.73229479789734, 'time_total_s': 45.73229479789734, 'pid': 3545917, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 8.949837496427758, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 45.73229479789734, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512'}
2025-06-06 11:03:33,084 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   3.293139  0.844828  ...                        6  e518530b
1   2.123164  0.844828  ...                        5  b5f53ac1
2   0.129250  1.000000  ...                        3  4c3478e1

[3 rows x 32 columns]
[36m(train_hpo pid=3545469)[0m 2025-06-06 11:03:33,024 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
2025-06-06 11:03:33,278 - INFO - Trial comparison plot saved
2025-06-06 11:03:33,278 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-06 11:03:33,994 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-06 11:03:34,086 - INFO - training size : 697
2025-06-06 11:03:34,087 - INFO - dev size : 67
2025-06-06 11:03:34,087 - INFO - test size : 132
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
  0%|          | 0/90 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  1%|          | 1/90 [00:00<00:57,  1.55it/s]  2%|â–         | 2/90 [00:01<00:55,  1.59it/s]  3%|â–Ž         | 3/90 [00:01<00:54,  1.61it/s]  4%|â–         | 4/90 [00:02<00:53,  1.61it/s]  6%|â–Œ         | 5/90 [00:03<00:52,  1.62it/s]  7%|â–‹         | 6/90 [00:03<00:51,  1.62it/s]  8%|â–Š         | 7/90 [00:04<00:51,  1.62it/s]  9%|â–‰         | 8/90 [00:04<00:50,  1.62it/s] 10%|â–ˆ         | 9/90 [00:05<00:49,  1.62it/s] 11%|â–ˆ         | 10/90 [00:06<00:49,  1.62it/s] 12%|â–ˆâ–        | 11/90 [00:06<00:48,  1.62it/s] 13%|â–ˆâ–Ž        | 12/90 [00:07<00:48,  1.62it/s] 14%|â–ˆâ–        | 13/90 [00:08<00:47,  1.62it/s] 16%|â–ˆâ–Œ        | 14/90 [00:08<00:46,  1.62it/s] 17%|â–ˆâ–‹        | 15/90 [00:09<00:46,  1.62it/s] 18%|â–ˆâ–Š        | 16/90 [00:09<00:45,  1.62it/s] 19%|â–ˆâ–‰        | 17/90 [00:10<00:44,  1.62it/s] 20%|â–ˆâ–ˆ        | 18/90 [00:11<00:44,  1.62it/s] 21%|â–ˆâ–ˆ        | 19/90 [00:11<00:43,  1.63it/s] 22%|â–ˆâ–ˆâ–       | 20/90 [00:12<00:43,  1.63it/s] 23%|â–ˆâ–ˆâ–Ž       | 21/90 [00:12<00:42,  1.63it/s] 24%|â–ˆâ–ˆâ–       | 22/90 [00:13<00:41,  1.63it/s] 26%|â–ˆâ–ˆâ–Œ       | 23/90 [00:14<00:41,  1.63it/s] 27%|â–ˆâ–ˆâ–‹       | 24/90 [00:14<00:40,  1.63it/s] 28%|â–ˆâ–ˆâ–Š       | 25/90 [00:15<00:39,  1.63it/s] 29%|â–ˆâ–ˆâ–‰       | 26/90 [00:16<00:39,  1.62it/s] 30%|â–ˆâ–ˆâ–ˆ       | 27/90 [00:16<00:38,  1.62it/s] 31%|â–ˆâ–ˆâ–ˆ       | 28/90 [00:17<00:38,  1.62it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 29/90 [00:17<00:37,  1.64it/s]                                               {'loss': 0.4511, 'grad_norm': 0.27728962898254395, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 30/90 [00:17<00:36,  1.64it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 31/90 [00:18<00:28,  2.04it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 32/90 [00:19<00:30,  1.92it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 33/90 [00:19<00:31,  1.83it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 34/90 [00:20<00:31,  1.77it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 35/90 [00:21<00:31,  1.73it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 36/90 [00:21<00:31,  1.69it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 37/90 [00:22<00:31,  1.67it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 38/90 [00:22<00:31,  1.65it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 39/90 [00:23<00:31,  1.65it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 40/90 [00:24<00:30,  1.64it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 41/90 [00:24<00:29,  1.63it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 42/90 [00:25<00:29,  1.63it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 43/90 [00:25<00:28,  1.63it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 44/90 [00:26<00:28,  1.62it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 45/90 [00:27<00:27,  1.63it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 46/90 [00:27<00:27,  1.63it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 47/90 [00:28<00:26,  1.62it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 48/90 [00:29<00:25,  1.63it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 49/90 [00:29<00:25,  1.62it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 50/90 [00:30<00:24,  1.62it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 51/90 [00:30<00:23,  1.63it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 52/90 [00:31<00:23,  1.62it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 53/90 [00:32<00:22,  1.63it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 54/90 [00:32<00:22,  1.62it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 55/90 [00:33<00:21,  1.62it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 56/90 [00:33<00:20,  1.62it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 57/90 [00:34<00:20,  1.62it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 58/90 [00:35<00:19,  1.63it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 59/90 [00:35<00:18,  1.64it/s]                                               {'loss': 0.0032, 'grad_norm': 0.019419435411691666, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 60/90 [00:35<00:18,  1.64it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 61/90 [00:36<00:14,  2.06it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 62/90 [00:37<00:14,  1.93it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 63/90 [00:37<00:14,  1.84it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 64/90 [00:38<00:14,  1.78it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 65/90 [00:38<00:14,  1.73it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 66/90 [00:39<00:14,  1.70it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 67/90 [00:40<00:13,  1.68it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 68/90 [00:40<00:13,  1.66it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 69/90 [00:41<00:12,  1.65it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 70/90 [00:42<00:12,  1.64it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 71/90 [00:42<00:11,  1.63it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 72/90 [00:43<00:11,  1.63it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 73/90 [00:43<00:10,  1.63it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 74/90 [00:44<00:09,  1.63it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 75/90 [00:45<00:09,  1.63it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 76/90 [00:45<00:08,  1.63it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 77/90 [00:46<00:07,  1.63it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 78/90 [00:46<00:07,  1.63it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 79/90 [00:47<00:06,  1.63it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 80/90 [00:48<00:06,  1.63it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 81/90 [00:48<00:05,  1.63it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 82/90 [00:49<00:04,  1.62it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 83/90 [00:50<00:04,  1.62it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 84/90 [00:50<00:03,  1.62it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 85/90 [00:51<00:03,  1.63it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 86/90 [00:51<00:02,  1.63it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 87/90 [00:52<00:01,  1.62it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 88/90 [00:53<00:01,  1.63it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 89/90 [00:53<00:00,  1.64it/s]                                               {'loss': 0.0009, 'grad_norm': 0.019350988790392876, 'learning_rate': 0.0, 'epoch': 3.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.64it/s]                                               {'train_runtime': 56.0409, 'train_samples_per_second': 37.312, 'train_steps_per_second': 1.606, 'train_loss': 0.1517223527861966, 'epoch': 3.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.64it/s]2025-06-06 11:04:30,565 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.61it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.28it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.44it/s]2025-06-06 11:04:34,168 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.10s/it]
2025-06-06 11:04:34,174 - INFO - Training time : 60.89555604197085
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.13it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.04it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.38it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.13it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.34it/s]2025-06-06 11:04:38,726 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.41it/s]
2025-06-06 11:04:38,731 - INFO - Evaluation time : 4.557835950981826
2025-06-06 11:04:38,732 - INFO - Evaluation results on test set: {'eval_loss': 0.0014142338186502457, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9993742108345032, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000004, 'eval_kappa': 1.0, 'eval_runtime': 4.5534, 'eval_samples_per_second': 28.989, 'eval_steps_per_second': 1.318, 'epoch': 3.0}
2025-06-06 11:04:38,732 - INFO - Total updates (optimizer steps): 90
2025-06-06 11:04:38,732 - INFO - Avg time / step: 0.623s
2025-06-06 11:04:39,514 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCEdmis-lab/biobert-v1.13trials_fold-2
2025-06-06 11:04:39,514 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.17it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.04it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.38it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.12it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.34it/s]2025-06-06 11:04:44,011 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.43it/s]
2025-06-06 11:04:44,015 - INFO - preds : [1 1 0 1 1 1 1 1 1 0 1 0 1 1 0 1 1 1 1 1 1 0 1 1 1 1 1 1 0 1 1 0 1 1 1 1 1
 1 1 1 1 1 0 0 1 0 1 0 0 1 0 0 1 1 1 1 0 0 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 1 0 1 1 1 1 1 1 0 1 0 1 1 1 1 1 0 1 1 1 0 1
 1 0 1 1 1 0 0 1 0 0 1 1 1 1 1 1 1 0 1 1 1]
2025-06-06 11:04:44,016 - INFO - test_split["labels"] : [1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1]
2025-06-06 11:04:44,018 - INFO - Confusion matrix: TN=34, FP=0, FN=0, TP=98
2025-06-06 11:04:47,151 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 34, 'FP': 0, 'FN': 0, 'TP': 98}
2025-06-06 11:04:47,265 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-06 11:04:47,356 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 11:04:47,356 - INFO - 
On test Set (optimal threshold of 0.9997970461845398 according to cross validation on the training set): 
2025-06-06 11:04:47,358 - INFO - Confusion matrix: TN=34, FP=0, FN=8, TP=90
2025-06-06 11:04:50,143 - INFO - Metrics: {'f1': 0.9574468085106383, 'recall': 0.9183673469387755, 'precision': 1.0, 'accuracy': 0.9393939393939394, 'AP': 1.0, 'MCC': 0.8622298030317391, 'NDCG': 1.0000000000000004, 'kappa': 0.8528428093645485, 'TN': 34, 'FP': 0, 'FN': 8, 'TP': 90}
2025-06-06 11:04:50,244 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 11:04:50,244 - INFO - Results for fold 2 : [{'f1': 0.9574468085106383, 'recall': 0.9183673469387755, 'precision': 1.0, 'accuracy': 0.9393939393939394, 'AP': 1.0, 'MCC': 0.8622298030317391, 'NDCG': 1.0000000000000004, 'kappa': 0.8528428093645485, 'TN': 34, 'FP': 0, 'FN': 8, 'TP': 90}]
2025-06-06 11:04:50,370 - INFO - Cleared CUDA cache. Memory allocated: 1.40 GB, Memory reserved: 1.78 GB
2025-06-06 11:04:50,370 - INFO - 
fold number 3 / 3
2025-06-06 11:04:50,376 - INFO - train split size : 697
2025-06-06 11:04:50,376 - INFO - dev split size : 67
2025-06-06 11:04:50,376 - INFO - test split size : 132
Map (num_proc=32):   0%|          | 0/697 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 22/697 [00:00<00:06, 104.54 examples/s]Map (num_proc=32):  19%|â–ˆâ–‰        | 132/697 [00:00<00:01, 455.54 examples/s]Map (num_proc=32):  35%|â–ˆâ–ˆâ–ˆâ–      | 242/697 [00:00<00:00, 609.94 examples/s]Map (num_proc=32):  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 352/697 [00:00<00:00, 703.38 examples/s]Map (num_proc=32):  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 440/697 [00:00<00:00, 726.37 examples/s]Map (num_proc=32):  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 528/697 [00:00<00:00, 757.72 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 634/697 [00:00<00:00, 811.11 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 697/697 [00:01<00:00, 609.86 examples/s]
Map (num_proc=32):   0%|          | 0/67 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/67 [00:00<00:03, 17.76 examples/s]Map (num_proc=32):  19%|â–ˆâ–‰        | 13/67 [00:00<00:00, 54.48 examples/s]Map (num_proc=32):  31%|â–ˆâ–ˆâ–ˆâ–      | 21/67 [00:00<00:00, 62.26 examples/s]Map (num_proc=32):  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 31/67 [00:00<00:00, 69.82 examples/s]Map (num_proc=32):  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 39/67 [00:00<00:00, 70.57 examples/s]Map (num_proc=32):  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 47/67 [00:00<00:00, 72.31 examples/s]Map (num_proc=32):  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 57/67 [00:00<00:00, 75.10 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:00<00:00, 80.31 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:01<00:00, 62.61 examples/s]
Map (num_proc=32):   0%|          | 0/132 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/132 [00:00<00:04, 28.51 examples/s]Map (num_proc=32):  18%|â–ˆâ–Š        | 24/132 [00:00<00:01, 99.00 examples/s]Map (num_proc=32):  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 44/132 [00:00<00:00, 127.57 examples/s]Map (num_proc=32):  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 64/132 [00:00<00:00, 144.90 examples/s]Map (num_proc=32):  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 84/132 [00:00<00:00, 151.12 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 104/132 [00:00<00:00, 153.33 examples/s]Map (num_proc=32):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 124/132 [00:00<00:00, 157.23 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 132/132 [00:01<00:00, 126.03 examples/s]
2025-06-06 11:04:59,580 - INFO - 3 datasets tokenized successfully
2025-06-06 11:04:59,582 - INFO - Starting hyperparameter search for BCE loss
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-06_11-04-59   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-04-59
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-06_10-55-47_424551_3536632/artifacts/2025-06-06_11-04-59/train_hpo_2025-06-06_11-04-59/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-06 11:04:59. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_af19d768   PENDING         8.49369       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_af19d768 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_af19d768 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          8.49369 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3550570)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3550570)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3550570)[0m 2025-06-06 11:05:07,435 - INFO - pos_weight value in TrainingArguments : 8.493688290834637
[36m(train_hpo pid=3550570)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3550570)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3550570)[0m [2025-06-06 11:05:07,675] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3550570)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3550570)[0m   warnings.warn(
[36m(train_hpo pid=3550570)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=48, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_f8437150 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_f8437150 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          7.54953 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3550804)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3550804)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3550804)[0m 2025-06-06 11:05:14,037 - INFO - pos_weight value in TrainingArguments : 7.549531688595925
[36m(train_hpo pid=3550804)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3550804)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3550804)[0m [2025-06-06 11:05:14,419] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3550804)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3550804)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3550804)[0m   warnings.warn(

Trial train_hpo_3465e35c started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_3465e35c config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          8.94984 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3551037)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3551037)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3551037)[0m 2025-06-06 11:05:20,960 - INFO - pos_weight value in TrainingArguments : 8.949837496427758
[36m(train_hpo pid=3551037)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3551037)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3551037)[0m [2025-06-06 11:05:21,188] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3551037)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3551037)[0m   warnings.warn(
[36m(train_hpo pid=3551037)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=24, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 3 RUNNING
Current time: 2025-06-06 11:05:29. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_af19d768   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_f8437150   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_3465e35c   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3550570)[0m {'loss': 1.7717, 'grad_norm': 6.524287223815918, 'learning_rate': 1.246338876535363e-06, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3551037)[0m {'loss': 1.194, 'grad_norm': 5.887320041656494, 'learning_rate': 5.325452975187489e-05, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3550804)[0m {'loss': 1.7692, 'grad_norm': 8.49009895324707, 'learning_rate': 3.6443132246884782e-06, 'epoch': 0.9142857142857143}
Trial status: 3 RUNNING
Current time: 2025-06-06 11:05:59. Total running time: 1min 0s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_af19d768   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_f8437150   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_3465e35c   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3550570)[0m {'loss': 1.7102, 'grad_norm': 6.704445838928223, 'learning_rate': 9.970711012282902e-07, 'epoch': 1.9142857142857141}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3551037)[0m {'train_runtime': 37.9345, 'train_samples_per_second': 55.121, 'train_steps_per_second': 0.633, 'train_loss': 0.4936751003066699, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3551037)[0m STATE at ending of training  :  TrainerState(epoch=2.914285714285714, global_step=24, max_steps=24, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=515014711165200.0, log_history=[{'loss': 1.194, 'grad_norm': 5.887320041656494, 'learning_rate': 5.325452975187489e-05, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.2339, 'grad_norm': 1.48703932762146, 'learning_rate': 2.6627264875937445e-05, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 0.0531, 'grad_norm': 0.6473516821861267, 'learning_rate': 0.0, 'epoch': 2.914285714285714, 'step': 24}, {'train_runtime': 37.9345, 'train_samples_per_second': 55.121, 'train_steps_per_second': 0.633, 'total_flos': 515014711165200.0, 'train_loss': 0.4936751003066699, 'epoch': 2.914285714285714, 'step': 24}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3551037)[0m 2025-06-06 11:06:05,569 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3551037)[0m 2025-06-06 11:06:05,575 - INFO - eval_result: {'eval_loss': 0.06567640602588654, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9415620565414429, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0, 'eval_kappa': 1.0, 'eval_runtime': 3.2707, 'eval_samples_per_second': 20.485, 'eval_steps_per_second': 1.223, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3551037)[0m {'eval_loss': 0.06567640602588654, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9415620565414429, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0, 'eval_kappa': 1.0, 'eval_runtime': 3.2707, 'eval_samples_per_second': 20.485, 'eval_steps_per_second': 1.223, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3551037)[0m 2025-06-06 11:06:05,610 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB

Trial train_hpo_3465e35c finished iteration 1 at 2025-06-06 11:06:05. Total running time: 1min 5s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_3465e35c result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    45.5135 â”‚
â”‚ time_total_s                        45.5135 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               2.91429 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                                  1 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                             1 â”‚
â”‚ eval_f1                                   1 â”‚
â”‚ eval_kappa                                1 â”‚
â”‚ eval_loss                           0.06568 â”‚
â”‚ eval_optim_threshold                0.94156 â”‚
â”‚ eval_precision                            1 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.2707 â”‚
â”‚ eval_samples_per_second              20.485 â”‚
â”‚ eval_steps_per_second                 1.223 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:06:05,635 - INFO - Cleaning up trial 3465e35c
2025-06-06 11:06:05,635 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-04-59/train_hpo_3465e35c_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512_2025-06-06_11-05-13

Trial train_hpo_3465e35c completed after 1 iterations at 2025-06-06 11:06:05. Total running time: 1min 5s
[36m(train_hpo pid=3550804)[0m {'loss': 1.613, 'grad_norm': 6.8147430419921875, 'learning_rate': 2.7332349185163582e-06, 'epoch': 1.9142857142857141}[32m [repeated 2x across cluster][0m

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:06:29. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_af19d768   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_f8437150   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_3465e35c   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.5135     0.0656764           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3550570)[0m {'loss': 1.6811, 'grad_norm': 4.560871601104736, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3550804)[0m {'loss': 1.5234, 'grad_norm': 4.062568187713623, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.914285714285714}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:07:00. Total running time: 2min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_af19d768   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_f8437150   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_3465e35c   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.5135     0.0656764           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3550570)[0m {'loss': 1.6566, 'grad_norm': 2.4829792976379395, 'learning_rate': 4.985355506141451e-07, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3550804)[0m {'loss': 1.4549, 'grad_norm': 2.3199472427368164, 'learning_rate': 9.110783061721196e-07, 'epoch': 3.914285714285714}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:07:30. Total running time: 2min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_af19d768   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_f8437150   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_3465e35c   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.5135     0.0656764           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3550570)[0m {'loss': 1.6251, 'grad_norm': 10.485681533813477, 'learning_rate': 2.4926777530707256e-07, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3550804)[0m {'loss': 1.3839, 'grad_norm': 9.08265495300293, 'learning_rate': 0.0, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3550804)[0m {'train_runtime': 148.9619, 'train_samples_per_second': 23.395, 'train_steps_per_second': 0.269, 'train_loss': 1.5488978147506713, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3550804)[0m STATE at ending of training  :  TrainerState(epoch=4.914285714285715, global_step=40, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=862318185914640.0, log_history=[{'loss': 1.7692, 'grad_norm': 8.49009895324707, 'learning_rate': 3.6443132246884782e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 1.613, 'grad_norm': 6.8147430419921875, 'learning_rate': 2.7332349185163582e-06, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 1.5234, 'grad_norm': 4.062568187713623, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 1.4549, 'grad_norm': 2.3199472427368164, 'learning_rate': 9.110783061721196e-07, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 1.3839, 'grad_norm': 9.08265495300293, 'learning_rate': 0.0, 'epoch': 4.914285714285715, 'step': 40}, {'train_runtime': 148.9619, 'train_samples_per_second': 23.395, 'train_steps_per_second': 0.269, 'total_flos': 862318185914640.0, 'train_loss': 1.5488978147506713, 'epoch': 4.914285714285715, 'step': 40}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3550804)[0m {'eval_loss': 2.804291248321533, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.6083670854568481, 'eval_AP': 0.9895838015744339, 'eval_MCC': 0.0, 'eval_NDCG': 0.9981199498716026, 'eval_kappa': 0.0, 'eval_runtime': 3.9742, 'eval_samples_per_second': 16.859, 'eval_steps_per_second': 1.006, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3550804)[0m 2025-06-06 11:07:50,538 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3550804)[0m 2025-06-06 11:07:50,544 - INFO - eval_result: {'eval_loss': 2.804291248321533, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.6083670854568481, 'eval_AP': 0.9895838015744339, 'eval_MCC': 0.0, 'eval_NDCG': 0.9981199498716026, 'eval_kappa': 0.0, 'eval_runtime': 3.9742, 'eval_samples_per_second': 16.859, 'eval_steps_per_second': 1.006, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3550804)[0m 2025-06-06 11:07:50,577 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB

Trial train_hpo_f8437150 finished iteration 1 at 2025-06-06 11:07:50. Total running time: 2min 50s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_f8437150 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    157.417 â”‚
â”‚ time_total_s                        157.417 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               4.91429 â”‚
â”‚ eval_AP                             0.98958 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.99812 â”‚
â”‚ eval_accuracy                       0.74627 â”‚
â”‚ eval_f1                              0.8547 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           2.80429 â”‚
â”‚ eval_optim_threshold                0.60837 â”‚
â”‚ eval_precision                      0.74627 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.9742 â”‚
â”‚ eval_samples_per_second              16.859 â”‚
â”‚ eval_steps_per_second                 1.006 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:07:50,599 - INFO - Cleaning up trial f8437150
2025-06-06 11:07:50,599 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-04-59/train_hpo_f8437150_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-06_11-05-06
2025-06-06 11:07:50,600 - INFO - Current best: 3465e35c with eval_f1 : 1.0 at iteration 1

Trial train_hpo_f8437150 completed after 1 iterations at 2025-06-06 11:07:50. Total running time: 2min 50s
[36m(train_hpo pid=3550570)[0m STATE at ending of training  :  TrainerState(epoch=5.914285714285715, global_step=48, max_steps=48, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=1035969923289360.0, log_history=[{'loss': 1.7717, 'grad_norm': 6.524287223815918, 'learning_rate': 1.246338876535363e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 1.7102, 'grad_norm': 6.704445838928223, 'learning_rate': 9.970711012282902e-07, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 1.6811, 'grad_norm': 4.560871601104736, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 1.6566, 'grad_norm': 2.4829792976379395, 'learning_rate': 4.985355506141451e-07, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 1.6251, 'grad_norm': 10.485681533813477, 'learning_rate': 2.4926777530707256e-07, 'epoch': 4.914285714285715, 'step': 40}, {'loss': 1.5794, 'grad_norm': 6.1385369300842285, 'learning_rate': 0.0, 'epoch': 5.914285714285715, 'step': 48}, {'train_runtime': 162.4159, 'train_samples_per_second': 25.749, 'train_steps_per_second': 0.296, 'total_flos': 1035969923289360.0, 'train_loss': 1.6707128882408142, 'epoch': 5.914285714285715, 'step': 48}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3550570)[0m {'loss': 1.5794, 'grad_norm': 6.1385369300842285, 'learning_rate': 0.0, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3550570)[0m {'train_runtime': 162.4159, 'train_samples_per_second': 25.749, 'train_steps_per_second': 0.296, 'train_loss': 1.6707128882408142, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3550570)[0m 2025-06-06 11:07:56,784 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3550570)[0m 2025-06-06 11:07:56,790 - INFO - eval_result: {'eval_loss': 3.3241686820983887, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.5917819738388062, 'eval_AP': 0.9759349243940221, 'eval_MCC': 0.0, 'eval_NDCG': 0.9955706255951814, 'eval_kappa': 0.0, 'eval_runtime': 3.4098, 'eval_samples_per_second': 19.649, 'eval_steps_per_second': 1.173, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3550570)[0m {'eval_loss': 3.3241686820983887, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.5917819738388062, 'eval_AP': 0.9759349243940221, 'eval_MCC': 0.0, 'eval_NDCG': 0.9955706255951814, 'eval_kappa': 0.0, 'eval_runtime': 3.4098, 'eval_samples_per_second': 19.649, 'eval_steps_per_second': 1.173, 'epoch': 5.914285714285715}

Trial train_hpo_af19d768 finished iteration 1 at 2025-06-06 11:07:56. Total running time: 2min 57s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_af19d768 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    170.423 â”‚
â”‚ time_total_s                        170.423 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               5.91429 â”‚
â”‚ eval_AP                             0.97593 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.99557 â”‚
â”‚ eval_accuracy                       0.74627 â”‚
â”‚ eval_f1                              0.8547 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           3.32417 â”‚
â”‚ eval_optim_threshold                0.59178 â”‚
â”‚ eval_precision                      0.74627 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.4098 â”‚
â”‚ eval_samples_per_second              19.649 â”‚
â”‚ eval_steps_per_second                 1.173 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:07:56,848 - INFO - Cleaning up trial af19d768
2025-06-06 11:07:56,848 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-04-59/train_hpo_af19d768_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-06_11-04-59
2025-06-06 11:07:56,848 - INFO - Cleaning up trial f8437150
2025-06-06 11:07:56,848 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-04-59/train_hpo_f8437150_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-06_11-05-06
2025-06-06 11:07:56,848 - INFO - Current best: 3465e35c with eval_f1 : 1.0 at iteration 1

Trial train_hpo_af19d768 completed after 1 iterations at 2025-06-06 11:07:56. Total running time: 2min 57s
2025-06-06 11:07:56,855	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-04-59' in 0.0052s.

Trial status: 3 TERMINATED
Current time: 2025-06-06 11:07:56. Total running time: 2min 57s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_af19d768   TERMINATED        8.49369       1.49561e-06         0.13641                     6        1           170.423      3.32417      0.854701               1          0.746269 â”‚
â”‚ train_hpo_f8437150   TERMINATED        7.54953       4.55539e-06         0.123031                    5        1           157.417      2.80429      0.854701               1          0.746269 â”‚
â”‚ train_hpo_3465e35c   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.5135     0.0656764    1                      1          1        â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

2025-06-06 11:07:56,862 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x700d3bf8ec10>
2025-06-06 11:07:56,862 - INFO - Best trial : train_hpo_3465e35c
2025-06-06 11:07:56,863 - INFO - Best config : {'pos_weight': 8.949837496427758, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-06 11:07:56,863 - INFO - Best trial after optimization: {'eval_loss': 0.06567640602588654, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9415620565414429, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0, 'eval_kappa': 1.0, 'eval_runtime': 3.2707, 'eval_samples_per_second': 20.485, 'eval_steps_per_second': 1.223, 'epoch': 2.914285714285714, 'timestamp': 1749200765, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '3465e35c', 'date': '2025-06-06_11-06-05', 'time_this_iter_s': 45.51346468925476, 'time_total_s': 45.51346468925476, 'pid': 3551037, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 8.949837496427758, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 45.51346468925476, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512'}
2025-06-06 11:07:56,884 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   3.324169  0.854701  ...                        6  af19d768
1   2.804291  0.854701  ...                        5  f8437150
2   0.065676  1.000000  ...                        3  3465e35c

[3 rows x 32 columns]
[36m(train_hpo pid=3550570)[0m 2025-06-06 11:07:56,825 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
2025-06-06 11:07:57,079 - INFO - Trial comparison plot saved
2025-06-06 11:07:57,079 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-06 11:07:57,692 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-06 11:07:57,785 - INFO - training size : 697
2025-06-06 11:07:57,785 - INFO - dev size : 67
2025-06-06 11:07:57,785 - INFO - test size : 132
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
  0%|          | 0/90 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  1%|          | 1/90 [00:00<00:57,  1.55it/s]  2%|â–         | 2/90 [00:01<00:55,  1.59it/s]  3%|â–Ž         | 3/90 [00:01<00:54,  1.60it/s]  4%|â–         | 4/90 [00:02<00:53,  1.61it/s]  6%|â–Œ         | 5/90 [00:03<00:52,  1.62it/s]  7%|â–‹         | 6/90 [00:03<00:52,  1.61it/s]  8%|â–Š         | 7/90 [00:04<00:51,  1.61it/s]  9%|â–‰         | 8/90 [00:04<00:50,  1.62it/s] 10%|â–ˆ         | 9/90 [00:05<00:50,  1.62it/s] 11%|â–ˆ         | 10/90 [00:06<00:49,  1.62it/s] 12%|â–ˆâ–        | 11/90 [00:06<00:48,  1.62it/s] 13%|â–ˆâ–Ž        | 12/90 [00:07<00:48,  1.62it/s] 14%|â–ˆâ–        | 13/90 [00:08<00:47,  1.62it/s] 16%|â–ˆâ–Œ        | 14/90 [00:08<00:46,  1.62it/s] 17%|â–ˆâ–‹        | 15/90 [00:09<00:46,  1.62it/s] 18%|â–ˆâ–Š        | 16/90 [00:09<00:45,  1.62it/s] 19%|â–ˆâ–‰        | 17/90 [00:10<00:45,  1.62it/s] 20%|â–ˆâ–ˆ        | 18/90 [00:11<00:44,  1.62it/s] 21%|â–ˆâ–ˆ        | 19/90 [00:11<00:43,  1.62it/s] 22%|â–ˆâ–ˆâ–       | 20/90 [00:12<00:43,  1.62it/s] 23%|â–ˆâ–ˆâ–Ž       | 21/90 [00:12<00:42,  1.62it/s] 24%|â–ˆâ–ˆâ–       | 22/90 [00:13<00:41,  1.63it/s] 26%|â–ˆâ–ˆâ–Œ       | 23/90 [00:14<00:41,  1.63it/s] 27%|â–ˆâ–ˆâ–‹       | 24/90 [00:14<00:40,  1.63it/s] 28%|â–ˆâ–ˆâ–Š       | 25/90 [00:15<00:39,  1.63it/s] 29%|â–ˆâ–ˆâ–‰       | 26/90 [00:16<00:39,  1.62it/s] 30%|â–ˆâ–ˆâ–ˆ       | 27/90 [00:16<00:38,  1.62it/s] 31%|â–ˆâ–ˆâ–ˆ       | 28/90 [00:17<00:38,  1.62it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 29/90 [00:17<00:37,  1.64it/s]                                               {'loss': 0.4204, 'grad_norm': 0.05038775876164436, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 30/90 [00:17<00:36,  1.64it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 31/90 [00:18<00:28,  2.04it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 32/90 [00:19<00:30,  1.92it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 33/90 [00:19<00:31,  1.83it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 34/90 [00:20<00:31,  1.77it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 35/90 [00:21<00:31,  1.73it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 36/90 [00:21<00:31,  1.70it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 37/90 [00:22<00:31,  1.67it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 38/90 [00:22<00:31,  1.66it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 39/90 [00:23<00:30,  1.66it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 40/90 [00:24<00:30,  1.65it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 41/90 [00:24<00:29,  1.64it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 42/90 [00:25<00:29,  1.64it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 43/90 [00:25<00:28,  1.63it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 44/90 [00:26<00:28,  1.63it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 45/90 [00:27<00:27,  1.63it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 46/90 [00:27<00:27,  1.63it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 47/90 [00:28<00:26,  1.63it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 48/90 [00:29<00:25,  1.62it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 49/90 [00:29<00:25,  1.62it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 50/90 [00:30<00:24,  1.62it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 51/90 [00:30<00:24,  1.62it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 52/90 [00:31<00:23,  1.62it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 53/90 [00:32<00:22,  1.62it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 54/90 [00:32<00:22,  1.62it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 55/90 [00:33<00:21,  1.62it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 56/90 [00:33<00:20,  1.62it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 57/90 [00:34<00:20,  1.62it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 58/90 [00:35<00:19,  1.62it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 59/90 [00:35<00:18,  1.64it/s]                                               {'loss': 0.0094, 'grad_norm': 0.008949012495577335, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 60/90 [00:35<00:18,  1.64it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 61/90 [00:36<00:14,  2.06it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 62/90 [00:37<00:14,  1.93it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 63/90 [00:37<00:14,  1.84it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 64/90 [00:38<00:14,  1.77it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 65/90 [00:38<00:14,  1.73it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 66/90 [00:39<00:14,  1.70it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 67/90 [00:40<00:13,  1.68it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 68/90 [00:40<00:13,  1.66it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 69/90 [00:41<00:12,  1.65it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 70/90 [00:42<00:12,  1.65it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 71/90 [00:42<00:11,  1.64it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 72/90 [00:43<00:10,  1.64it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 73/90 [00:43<00:10,  1.63it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 74/90 [00:44<00:09,  1.63it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 75/90 [00:45<00:09,  1.63it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 76/90 [00:45<00:08,  1.63it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 77/90 [00:46<00:07,  1.63it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 78/90 [00:46<00:07,  1.63it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 79/90 [00:47<00:06,  1.63it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 80/90 [00:48<00:06,  1.63it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 81/90 [00:48<00:05,  1.63it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 82/90 [00:49<00:04,  1.63it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 83/90 [00:50<00:04,  1.63it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 84/90 [00:50<00:03,  1.63it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 85/90 [00:51<00:03,  1.63it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 86/90 [00:51<00:02,  1.63it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 87/90 [00:52<00:01,  1.62it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 88/90 [00:53<00:01,  1.63it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 89/90 [00:53<00:00,  1.64it/s]                                               {'loss': 0.001, 'grad_norm': 0.01019015908241272, 'learning_rate': 0.0, 'epoch': 3.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.64it/s]                                               {'train_runtime': 56.2723, 'train_samples_per_second': 37.159, 'train_steps_per_second': 1.599, 'train_loss': 0.1436260834750202, 'epoch': 3.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.64it/s]2025-06-06 11:08:54,530 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.60it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.25it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.43it/s]2025-06-06 11:08:58,209 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.13s/it]
2025-06-06 11:08:58,216 - INFO - Training time : 61.13702292484231
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.16it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.07it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.40it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.14it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.37it/s]2025-06-06 11:09:02,603 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.47it/s]
2025-06-06 11:09:02,608 - INFO - Evaluation time : 4.392020897008479
2025-06-06 11:09:02,608 - INFO - Evaluation results on test set: {'eval_loss': 0.05389053374528885, 'eval_f1': 0.9948717948717949, 'eval_recall': 1.0, 'eval_accuracy': 0.9924242424242424, 'eval_precision': 0.9897959183673469, 'eval_optim_threshold': 0.9996656179428101, 'eval_AP': 0.9999999999999998, 'eval_MCC': 0.9805692402810843, 'eval_NDCG': 1.0000000000000004, 'eval_kappa': 0.9803804994054697, 'eval_runtime': 4.3877, 'eval_samples_per_second': 30.084, 'eval_steps_per_second': 1.367, 'epoch': 3.0}
2025-06-06 11:09:02,608 - INFO - Total updates (optimizer steps): 90
2025-06-06 11:09:02,608 - INFO - Avg time / step: 0.625s
2025-06-06 11:09:03,348 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCEdmis-lab/biobert-v1.13trials_fold-3
2025-06-06 11:09:03,348 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.22it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.06it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.38it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.13it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.37it/s]2025-06-06 11:09:07,711 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.48it/s]
2025-06-06 11:09:07,715 - INFO - preds : [1 0 1 0 1 0 1 1 1 1 1 0 1 1 0 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 0 0 1 0 1
 1 1 1 1 1 0 1 1 0 0 1 1 0 1 1 1 1 1 1 1 1 0 1 0 1 1 0 1 1 1 1 1 1 1 1 1 1
 1 0 0 1 0 1 1 1 1 1 0 1 1 1 0 1 0 0 1 1 1 1 0 1 1 1 1 0 0 1 1 0 1 0 0 1 0
 1 1 1 1 1 1 1 1 0 1 1 1 1 1 0 1 0 1 0 1 1]
2025-06-06 11:09:07,716 - INFO - test_split["labels"] : [1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1]
2025-06-06 11:09:07,717 - INFO - Confusion matrix: TN=34, FP=1, FN=0, TP=97
2025-06-06 11:09:10,440 - INFO - Metrics: {'f1': 0.9948717948717949, 'recall': 1.0, 'precision': 0.9897959183673469, 'accuracy': 0.9924242424242424, 'AP': 0.9999999999999998, 'MCC': 0.9805692402810843, 'NDCG': 1.0000000000000004, 'kappa': 0.9803804994054697, 'TN': 34, 'FP': 1, 'FN': 0, 'TP': 97}
2025-06-06 11:09:10,558 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-06 11:09:10,650 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 11:09:10,650 - INFO - 
On test Set (optimal threshold of 0.9994458556175232 according to cross validation on the training set): 
2025-06-06 11:09:10,651 - INFO - Confusion matrix: TN=35, FP=0, FN=0, TP=97
2025-06-06 11:09:13,360 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 0.9999999999999998, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 35, 'FP': 0, 'FN': 0, 'TP': 97}
2025-06-06 11:09:13,452 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 11:09:13,452 - INFO - Results for fold 3 : [{'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 0.9999999999999998, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 35, 'FP': 0, 'FN': 0, 'TP': 97}]
2025-06-06 11:09:13,581 - INFO - Cleared CUDA cache. Memory allocated: 1.41 GB, Memory reserved: 1.77 GB
2025-06-06 11:09:13,581 - INFO - Cleared CUDA cache. Memory allocated: 1.41 GB, Memory reserved: 1.77 GB
2025-06-06 11:09:13,595 - INFO - Cleared CUDA cache. Memory allocated: 0.97 GB, Memory reserved: 1.67 GB
2025-06-06 11:09:13,608 - INFO - Metrics for dmis-lab/biobert-v1.1:               model_name fold loss_type run  ...    TN   FP   FN    TP
0  dmis-lab/biobert-v1.1    1       BCE   1  ...  34.0  1.0  0.0  98.0
0  dmis-lab/biobert-v1.1    2       BCE   1  ...  34.0  0.0  0.0  98.0
0  dmis-lab/biobert-v1.1    3       BCE   1  ...  34.0  1.0  0.0  97.0

[3 rows x 18 columns]
2025-06-06 11:09:13,608 - INFO - Training model 2/2: google-bert/bert-base-uncased
2025-06-06 11:09:13,779 - INFO - 
fold number 1 / 3
2025-06-06 11:09:13,786 - INFO - train split size : 697
2025-06-06 11:09:13,786 - INFO - dev split size : 66
2025-06-06 11:09:13,786 - INFO - test split size : 133
Map (num_proc=32):   0%|          | 0/697 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 22/697 [00:00<00:07, 86.75 examples/s]Map (num_proc=32):  19%|â–ˆâ–‰        | 132/697 [00:00<00:01, 433.14 examples/s]Map (num_proc=32):  35%|â–ˆâ–ˆâ–ˆâ–      | 242/697 [00:00<00:00, 632.92 examples/s]Map (num_proc=32):  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 330/697 [00:00<00:00, 709.56 examples/s]Map (num_proc=32):  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 440/697 [00:00<00:00, 779.29 examples/s]Map (num_proc=32):  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 528/697 [00:00<00:00, 798.80 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 634/697 [00:00<00:00, 828.61 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 697/697 [00:01<00:00, 624.42 examples/s]
Map (num_proc=32):   0%|          | 0/66 [00:00<?, ? examples/s]Map (num_proc=32):   5%|â–         | 3/66 [00:00<00:04, 15.46 examples/s]Map (num_proc=32):  21%|â–ˆâ–ˆ        | 14/66 [00:00<00:01, 51.24 examples/s]Map (num_proc=32):  36%|â–ˆâ–ˆâ–ˆâ–‹      | 24/66 [00:00<00:00, 61.33 examples/s]Map (num_proc=32):  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 32/66 [00:00<00:00, 66.71 examples/s]Map (num_proc=32):  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 40/66 [00:00<00:00, 70.66 examples/s]Map (num_proc=32):  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 50/66 [00:00<00:00, 74.92 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 60/66 [00:00<00:00, 74.34 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 66/66 [00:01<00:00, 61.43 examples/s]
Map (num_proc=32):   0%|          | 0/133 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/133 [00:00<00:04, 26.76 examples/s]Map (num_proc=32):  22%|â–ˆâ–ˆâ–       | 29/133 [00:00<00:01, 97.75 examples/s]Map (num_proc=32):  37%|â–ˆâ–ˆâ–ˆâ–‹      | 49/133 [00:00<00:00, 130.77 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 69/133 [00:00<00:00, 147.09 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 89/133 [00:00<00:00, 155.97 examples/s]Map (num_proc=32):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 109/133 [00:00<00:00, 163.75 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 129/133 [00:00<00:00, 166.68 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 133/133 [00:01<00:00, 127.56 examples/s]
2025-06-06 11:09:22,796 - INFO - 3 datasets tokenized successfully
2025-06-06 11:09:22,798 - INFO - Starting hyperparameter search for BCE loss
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-06_11-09-22   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-09-22
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-06_10-55-47_424551_3536632/artifacts/2025-06-06_11-09-22/train_hpo_2025-06-06_11-09-22/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-06 11:09:22. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_8f03814c   PENDING         8.49369       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_8f03814c started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_8f03814c config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          8.49369 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3555670)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3555670)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3555670)[0m 2025-06-06 11:09:30,233 - INFO - pos_weight value in TrainingArguments : 8.493688290834637
[36m(train_hpo pid=3555670)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3555670)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3555670)[0m [2025-06-06 11:09:30,486] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3555670)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=48, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3555670)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3555670)[0m   warnings.warn(

Trial train_hpo_18f7cdd4 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_18f7cdd4 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          7.54953 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3555832)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3555832)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3555832)[0m 2025-06-06 11:09:37,032 - INFO - pos_weight value in TrainingArguments : 7.549531688595925
[36m(train_hpo pid=3555832)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3555832)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3555832)[0m [2025-06-06 11:09:37,333] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3555832)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3555832)[0m   warnings.warn(
[36m(train_hpo pid=3555832)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_6af2bf71 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_6af2bf71 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          8.94984 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3556112)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3556112)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3556112)[0m 2025-06-06 11:09:43,679 - INFO - pos_weight value in TrainingArguments : 8.949837496427758
[36m(train_hpo pid=3556112)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3556112)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3556112)[0m [2025-06-06 11:09:43,921] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3556112)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3556112)[0m   warnings.warn(
[36m(train_hpo pid=3556112)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=24, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 3 RUNNING
Current time: 2025-06-06 11:09:53. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_8f03814c   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_18f7cdd4   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_6af2bf71   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3555670)[0m {'loss': 1.9354, 'grad_norm': 13.710834503173828, 'learning_rate': 1.246338876535363e-06, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3556112)[0m {'loss': 1.2504, 'grad_norm': 7.916500091552734, 'learning_rate': 5.325452975187489e-05, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3555832)[0m {'loss': 2.11, 'grad_norm': 17.32444190979004, 'learning_rate': 3.6443132246884782e-06, 'epoch': 0.9142857142857143}
Trial status: 3 RUNNING
Current time: 2025-06-06 11:10:23. Total running time: 1min 0s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_8f03814c   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_18f7cdd4   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_6af2bf71   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3555670)[0m {'loss': 1.9288, 'grad_norm': 15.224225997924805, 'learning_rate': 9.970711012282902e-07, 'epoch': 1.9142857142857141}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3556112)[0m {'train_runtime': 37.792, 'train_samples_per_second': 55.329, 'train_steps_per_second': 0.635, 'train_loss': 0.5666362196207047, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3556112)[0m STATE at ending of training  :  TrainerState(epoch=2.914285714285714, global_step=24, max_steps=24, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=513997220516520.0, log_history=[{'loss': 1.2504, 'grad_norm': 7.916500091552734, 'learning_rate': 5.325452975187489e-05, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.3178, 'grad_norm': 3.797267198562622, 'learning_rate': 2.6627264875937445e-05, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 0.1317, 'grad_norm': 1.9220311641693115, 'learning_rate': 0.0, 'epoch': 2.914285714285714, 'step': 24}, {'train_runtime': 37.792, 'train_samples_per_second': 55.329, 'train_steps_per_second': 0.635, 'total_flos': 513997220516520.0, 'train_loss': 0.5666362196207047, 'epoch': 2.914285714285714, 'step': 24}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3556112)[0m 2025-06-06 11:10:28,442 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3556112)[0m 2025-06-06 11:10:28,448 - INFO - eval_result: {'eval_loss': 0.19802182912826538, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.964721143245697, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.4324, 'eval_samples_per_second': 19.228, 'eval_steps_per_second': 1.165, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3556112)[0m {'eval_loss': 0.19802182912826538, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.964721143245697, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.4324, 'eval_samples_per_second': 19.228, 'eval_steps_per_second': 1.165, 'epoch': 2.914285714285714}

Trial train_hpo_6af2bf71 finished iteration 1 at 2025-06-06 11:10:28. Total running time: 1min 5s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_6af2bf71 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    45.2453 â”‚
â”‚ time_total_s                        45.2453 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               2.91429 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                                  1 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                             1 â”‚
â”‚ eval_f1                                   1 â”‚
â”‚ eval_kappa                                1 â”‚
â”‚ eval_loss                           0.19802 â”‚
â”‚ eval_optim_threshold                0.96472 â”‚
â”‚ eval_precision                            1 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.4324 â”‚
â”‚ eval_samples_per_second              19.228 â”‚
â”‚ eval_steps_per_second                 1.165 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:10:28,511 - INFO - Cleaning up trial 6af2bf71
2025-06-06 11:10:28,511 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-09-22/train_hpo_6af2bf71_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512_2025-06-06_11-09-36

Trial train_hpo_6af2bf71 completed after 1 iterations at 2025-06-06 11:10:28. Total running time: 1min 5s
[36m(train_hpo pid=3556112)[0m 2025-06-06 11:10:28,486 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3555832)[0m {'loss': 1.7809, 'grad_norm': 12.306933403015137, 'learning_rate': 2.7332349185163582e-06, 'epoch': 1.9142857142857141}[32m [repeated 2x across cluster][0m

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:10:53. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_8f03814c   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_18f7cdd4   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_6af2bf71   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.2453      0.198022           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3555670)[0m {'loss': 1.9009, 'grad_norm': 12.790718078613281, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3555832)[0m {'loss': 1.4213, 'grad_norm': 11.014163970947266, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3555670)[0m {'loss': 1.8283, 'grad_norm': 8.823955535888672, 'learning_rate': 4.985355506141451e-07, 'epoch': 3.914285714285714}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:11:23. Total running time: 2min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_8f03814c   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_18f7cdd4   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_6af2bf71   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.2453      0.198022           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3555832)[0m {'loss': 1.1057, 'grad_norm': 13.978994369506836, 'learning_rate': 9.110783061721196e-07, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3555670)[0m {'loss': 1.8926, 'grad_norm': 24.49666976928711, 'learning_rate': 2.4926777530707256e-07, 'epoch': 4.914285714285715}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:11:53. Total running time: 2min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_8f03814c   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_18f7cdd4   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_6af2bf71   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.2453      0.198022           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3555832)[0m {'loss': 0.9986, 'grad_norm': 16.80344009399414, 'learning_rate': 0.0, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3555832)[0m {'train_runtime': 147.2161, 'train_samples_per_second': 23.673, 'train_steps_per_second': 0.272, 'train_loss': 1.4833065748214722, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3555832)[0m STATE at ending of training  :  TrainerState(epoch=4.914285714285715, global_step=40, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=860529869016960.0, log_history=[{'loss': 2.11, 'grad_norm': 17.32444190979004, 'learning_rate': 3.6443132246884782e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 1.7809, 'grad_norm': 12.306933403015137, 'learning_rate': 2.7332349185163582e-06, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 1.4213, 'grad_norm': 11.014163970947266, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 1.1057, 'grad_norm': 13.978994369506836, 'learning_rate': 9.110783061721196e-07, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 0.9986, 'grad_norm': 16.80344009399414, 'learning_rate': 0.0, 'epoch': 4.914285714285715, 'step': 40}, {'train_runtime': 147.2161, 'train_samples_per_second': 23.673, 'train_steps_per_second': 0.272, 'total_flos': 860529869016960.0, 'train_loss': 1.4833065748214722, 'epoch': 4.914285714285715, 'step': 40}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3555832)[0m 2025-06-06 11:12:11,711 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3555832)[0m 2025-06-06 11:12:11,717 - INFO - eval_result: {'eval_loss': 1.7332191467285156, 'eval_f1': 0.8828828828828829, 'eval_recall': 1.0, 'eval_accuracy': 0.803030303030303, 'eval_precision': 0.7903225806451613, 'eval_optim_threshold': 0.7312899231910706, 'eval_AP': 1.0, 'eval_MCC': 0.4312287725435882, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 0.3136, 'eval_runtime': 3.882, 'eval_samples_per_second': 17.002, 'eval_steps_per_second': 1.03, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3555832)[0m {'eval_loss': 1.7332191467285156, 'eval_f1': 0.8828828828828829, 'eval_recall': 1.0, 'eval_accuracy': 0.803030303030303, 'eval_precision': 0.7903225806451613, 'eval_optim_threshold': 0.7312899231910706, 'eval_AP': 1.0, 'eval_MCC': 0.4312287725435882, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 0.3136, 'eval_runtime': 3.882, 'eval_samples_per_second': 17.002, 'eval_steps_per_second': 1.03, 'epoch': 4.914285714285715}

Trial train_hpo_18f7cdd4 finished iteration 1 at 2025-06-06 11:12:11. Total running time: 2min 48s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_18f7cdd4 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    155.192 â”‚
â”‚ time_total_s                        155.192 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               4.91429 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                            0.43123 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                       0.80303 â”‚
â”‚ eval_f1                             0.88288 â”‚
â”‚ eval_kappa                           0.3136 â”‚
â”‚ eval_loss                           1.73322 â”‚
â”‚ eval_optim_threshold                0.73129 â”‚
â”‚ eval_precision                      0.79032 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                          3.882 â”‚
â”‚ eval_samples_per_second              17.002 â”‚
â”‚ eval_steps_per_second                  1.03 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:12:11,781 - INFO - Cleaning up trial 18f7cdd4
2025-06-06 11:12:11,781 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-09-22/train_hpo_18f7cdd4_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-06_11-09-29
2025-06-06 11:12:11,781 - INFO - Current best: 6af2bf71 with eval_f1 : 1.0 at iteration 1

Trial train_hpo_18f7cdd4 completed after 1 iterations at 2025-06-06 11:12:11. Total running time: 2min 48s
[36m(train_hpo pid=3555832)[0m 2025-06-06 11:12:11,757 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3555670)[0m STATE at ending of training  :  TrainerState(epoch=5.914285714285715, global_step=48, max_steps=48, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=1034181606391680.0, log_history=[{'loss': 1.9354, 'grad_norm': 13.710834503173828, 'learning_rate': 1.246338876535363e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 1.9288, 'grad_norm': 15.224225997924805, 'learning_rate': 9.970711012282902e-07, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 1.9009, 'grad_norm': 12.790718078613281, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 1.8283, 'grad_norm': 8.823955535888672, 'learning_rate': 4.985355506141451e-07, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 1.8926, 'grad_norm': 24.49666976928711, 'learning_rate': 2.4926777530707256e-07, 'epoch': 4.914285714285715, 'step': 40}, {'loss': 1.8275, 'grad_norm': 15.401496887207031, 'learning_rate': 0.0, 'epoch': 5.914285714285715, 'step': 48}, {'train_runtime': 160.7483, 'train_samples_per_second': 26.016, 'train_steps_per_second': 0.299, 'total_flos': 1034181606391680.0, 'train_loss': 1.8855838974316914, 'epoch': 5.914285714285715, 'step': 48}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3555670)[0m {'loss': 1.8275, 'grad_norm': 15.401496887207031, 'learning_rate': 0.0, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3555670)[0m {'train_runtime': 160.7483, 'train_samples_per_second': 26.016, 'train_steps_per_second': 0.299, 'train_loss': 1.8855838974316914, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3555670)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
[36m(train_hpo pid=3555670)[0m   _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
[36m(train_hpo pid=3555670)[0m 2025-06-06 11:12:17,911 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3555670)[0m 2025-06-06 11:12:17,917 - INFO - eval_result: {'eval_loss': 4.65402364730835, 'eval_f1': 0.0, 'eval_recall': 0.0, 'eval_accuracy': 0.25757575757575757, 'eval_precision': 0.0, 'eval_optim_threshold': 0.4885360896587372, 'eval_AP': 0.9015953008352899, 'eval_MCC': 0.0, 'eval_NDCG': 0.9767287571998032, 'eval_kappa': 0.0, 'eval_runtime': 3.4606, 'eval_samples_per_second': 19.072, 'eval_steps_per_second': 1.156, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3555670)[0m 2025-06-06 11:12:17,953 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3555670)[0m {'eval_loss': 4.65402364730835, 'eval_f1': 0.0, 'eval_recall': 0.0, 'eval_accuracy': 0.25757575757575757, 'eval_precision': 0.0, 'eval_optim_threshold': 0.4885360896587372, 'eval_AP': 0.9015953008352899, 'eval_MCC': 0.0, 'eval_NDCG': 0.9767287571998032, 'eval_kappa': 0.0, 'eval_runtime': 3.4606, 'eval_samples_per_second': 19.072, 'eval_steps_per_second': 1.156, 'epoch': 5.914285714285715}

Trial train_hpo_8f03814c finished iteration 1 at 2025-06-06 11:12:17. Total running time: 2min 55s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_8f03814c result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    168.179 â”‚
â”‚ time_total_s                        168.179 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               5.91429 â”‚
â”‚ eval_AP                              0.9016 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.97673 â”‚
â”‚ eval_accuracy                       0.25758 â”‚
â”‚ eval_f1                                   0 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           4.65402 â”‚
â”‚ eval_optim_threshold                0.48854 â”‚
â”‚ eval_precision                            0 â”‚
â”‚ eval_recall                               0 â”‚
â”‚ eval_runtime                         3.4606 â”‚
â”‚ eval_samples_per_second              19.072 â”‚
â”‚ eval_steps_per_second                 1.156 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:12:17,980 - INFO - Cleaning up trial 8f03814c
2025-06-06 11:12:17,980 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-09-22/train_hpo_8f03814c_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-06_11-09-22
2025-06-06 11:12:17,980 - INFO - Cleaning up trial 18f7cdd4
2025-06-06 11:12:17,980 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-09-22/train_hpo_18f7cdd4_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-06_11-09-29
2025-06-06 11:12:17,980 - INFO - Current best: 6af2bf71 with eval_f1 : 1.0 at iteration 1

Trial train_hpo_8f03814c completed after 1 iterations at 2025-06-06 11:12:17. Total running time: 2min 55s
2025-06-06 11:12:17,987	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-09-22' in 0.0053s.

Trial status: 3 TERMINATED
Current time: 2025-06-06 11:12:17. Total running time: 2min 55s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_8f03814c   TERMINATED        8.49369       1.49561e-06         0.13641                     6        1           168.179       4.65402     0                      0          0.257576 â”‚
â”‚ train_hpo_18f7cdd4   TERMINATED        7.54953       4.55539e-06         0.123031                    5        1           155.192       1.73322     0.882883               1          0.80303  â”‚
â”‚ train_hpo_6af2bf71   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.2453      0.198022    1                      1          1        â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

2025-06-06 11:12:17,994 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x700d3bff3090>
2025-06-06 11:12:17,994 - INFO - Best trial : train_hpo_6af2bf71
2025-06-06 11:12:17,995 - INFO - Best config : {'pos_weight': 8.949837496427758, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-06 11:12:17,995 - INFO - Best trial after optimization: {'eval_loss': 0.19802182912826538, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.964721143245697, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.4324, 'eval_samples_per_second': 19.228, 'eval_steps_per_second': 1.165, 'epoch': 2.914285714285714, 'timestamp': 1749201028, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '6af2bf71', 'date': '2025-06-06_11-10-28', 'time_this_iter_s': 45.24531149864197, 'time_total_s': 45.24531149864197, 'pid': 3556112, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 8.949837496427758, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 45.24531149864197, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512'}
2025-06-06 11:12:18,023 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   4.654024  0.000000  ...                        6  8f03814c
1   1.733219  0.882883  ...                        5  18f7cdd4
2   0.198022  1.000000  ...                        3  6af2bf71

[3 rows x 32 columns]
2025-06-06 11:12:18,201 - INFO - Trial comparison plot saved
2025-06-06 11:12:18,202 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-06 11:12:18,412 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-06 11:12:18,518 - INFO - training size : 697
2025-06-06 11:12:18,518 - INFO - dev size : 66
2025-06-06 11:12:18,518 - INFO - test size : 133
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
  0%|          | 0/90 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  1%|          | 1/90 [00:00<00:57,  1.54it/s]  2%|â–         | 2/90 [00:01<00:55,  1.58it/s]  3%|â–Ž         | 3/90 [00:01<00:54,  1.60it/s]  4%|â–         | 4/90 [00:02<00:53,  1.60it/s]  6%|â–Œ         | 5/90 [00:03<00:52,  1.61it/s]  7%|â–‹         | 6/90 [00:03<00:52,  1.61it/s]  8%|â–Š         | 7/90 [00:04<00:51,  1.61it/s]  9%|â–‰         | 8/90 [00:04<00:50,  1.61it/s] 10%|â–ˆ         | 9/90 [00:05<00:50,  1.61it/s] 11%|â–ˆ         | 10/90 [00:06<00:49,  1.61it/s] 12%|â–ˆâ–        | 11/90 [00:06<00:48,  1.61it/s] 13%|â–ˆâ–Ž        | 12/90 [00:07<00:48,  1.61it/s] 14%|â–ˆâ–        | 13/90 [00:08<00:47,  1.62it/s] 16%|â–ˆâ–Œ        | 14/90 [00:08<00:47,  1.61it/s] 17%|â–ˆâ–‹        | 15/90 [00:09<00:46,  1.61it/s] 18%|â–ˆâ–Š        | 16/90 [00:09<00:45,  1.61it/s] 19%|â–ˆâ–‰        | 17/90 [00:10<00:45,  1.61it/s] 20%|â–ˆâ–ˆ        | 18/90 [00:11<00:44,  1.61it/s] 21%|â–ˆâ–ˆ        | 19/90 [00:11<00:44,  1.61it/s] 22%|â–ˆâ–ˆâ–       | 20/90 [00:12<00:43,  1.61it/s] 23%|â–ˆâ–ˆâ–Ž       | 21/90 [00:13<00:42,  1.62it/s] 24%|â–ˆâ–ˆâ–       | 22/90 [00:13<00:42,  1.62it/s] 26%|â–ˆâ–ˆâ–Œ       | 23/90 [00:14<00:41,  1.62it/s] 27%|â–ˆâ–ˆâ–‹       | 24/90 [00:14<00:40,  1.62it/s] 28%|â–ˆâ–ˆâ–Š       | 25/90 [00:15<00:39,  1.63it/s] 29%|â–ˆâ–ˆâ–‰       | 26/90 [00:16<00:39,  1.62it/s] 30%|â–ˆâ–ˆâ–ˆ       | 27/90 [00:16<00:38,  1.62it/s] 31%|â–ˆâ–ˆâ–ˆ       | 28/90 [00:17<00:38,  1.62it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 29/90 [00:17<00:37,  1.63it/s]                                               {'loss': 0.7172, 'grad_norm': 0.1061667650938034, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 30/90 [00:18<00:36,  1.63it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 31/90 [00:18<00:28,  2.04it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 32/90 [00:19<00:30,  1.92it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 33/90 [00:19<00:31,  1.83it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 34/90 [00:20<00:31,  1.77it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 35/90 [00:21<00:31,  1.72it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 36/90 [00:21<00:31,  1.69it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 37/90 [00:22<00:31,  1.67it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 38/90 [00:22<00:31,  1.66it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 39/90 [00:23<00:30,  1.65it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 40/90 [00:24<00:30,  1.65it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 41/90 [00:24<00:29,  1.64it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 42/90 [00:25<00:29,  1.63it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 43/90 [00:26<00:28,  1.63it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 44/90 [00:26<00:28,  1.62it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 45/90 [00:27<00:27,  1.62it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 46/90 [00:27<00:27,  1.62it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 47/90 [00:28<00:26,  1.62it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 48/90 [00:29<00:25,  1.62it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 49/90 [00:29<00:25,  1.62it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 50/90 [00:30<00:24,  1.62it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 51/90 [00:30<00:24,  1.62it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 52/90 [00:31<00:23,  1.62it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 53/90 [00:32<00:22,  1.62it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 54/90 [00:32<00:22,  1.62it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 55/90 [00:33<00:21,  1.62it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 56/90 [00:34<00:21,  1.61it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 57/90 [00:34<00:20,  1.62it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 58/90 [00:35<00:19,  1.62it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 59/90 [00:35<00:19,  1.63it/s]                                               {'loss': 0.0134, 'grad_norm': 0.013037648051977158, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 60/90 [00:35<00:18,  1.63it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 61/90 [00:36<00:14,  2.05it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 62/90 [00:37<00:14,  1.92it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 63/90 [00:37<00:14,  1.83it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 64/90 [00:38<00:14,  1.77it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 65/90 [00:39<00:14,  1.73it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 66/90 [00:39<00:14,  1.69it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 67/90 [00:40<00:13,  1.67it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 68/90 [00:40<00:13,  1.66it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 69/90 [00:41<00:12,  1.65it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 70/90 [00:42<00:12,  1.64it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 71/90 [00:42<00:11,  1.63it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 72/90 [00:43<00:11,  1.63it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 73/90 [00:44<00:10,  1.62it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 74/90 [00:44<00:09,  1.62it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 75/90 [00:45<00:09,  1.62it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 76/90 [00:45<00:08,  1.62it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 77/90 [00:46<00:08,  1.62it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 78/90 [00:47<00:07,  1.61it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 79/90 [00:47<00:06,  1.62it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 80/90 [00:48<00:06,  1.62it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 81/90 [00:48<00:05,  1.63it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 82/90 [00:49<00:04,  1.62it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 83/90 [00:50<00:04,  1.62it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 84/90 [00:50<00:03,  1.62it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 85/90 [00:51<00:03,  1.62it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 86/90 [00:52<00:02,  1.62it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 87/90 [00:52<00:01,  1.62it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 88/90 [00:53<00:01,  1.62it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 89/90 [00:53<00:00,  1.63it/s]                                               {'loss': 0.012, 'grad_norm': 0.015375131741166115, 'learning_rate': 0.0, 'epoch': 3.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.63it/s]                                               {'train_runtime': 56.427, 'train_samples_per_second': 37.057, 'train_steps_per_second': 1.595, 'train_loss': 0.24752968317932553, 'epoch': 3.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.63it/s]2025-06-06 11:13:15,383 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.60it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.25it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.60it/s]2025-06-06 11:13:19,033 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.12s/it]
2025-06-06 11:13:19,041 - INFO - Training time : 60.8391102720052
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.14it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.04it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.36it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.10it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.24it/s]2025-06-06 11:13:23,423 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.47it/s]
2025-06-06 11:13:23,428 - INFO - Evaluation time : 4.387077901978046
2025-06-06 11:13:23,428 - INFO - Evaluation results on test set: {'eval_loss': 0.0033157744910568, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9994785189628601, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000004, 'eval_kappa': 1.0, 'eval_runtime': 4.3826, 'eval_samples_per_second': 30.347, 'eval_steps_per_second': 1.369, 'epoch': 3.0}
2025-06-06 11:13:23,428 - INFO - Total updates (optimizer steps): 90
2025-06-06 11:13:23,428 - INFO - Avg time / step: 0.627s
2025-06-06 11:13:24,164 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCEgoogle-bert/bert-base-uncased3trials_fold-1
2025-06-06 11:13:24,164 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.09it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.01it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.35it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.10it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.24it/s]2025-06-06 11:13:28,776 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.39it/s]
2025-06-06 11:13:28,781 - INFO - preds : [1 1 1 0 0 1 1 1 1 1 1 1 0 0 1 0 1 0 1 1 1 0 1 1 0 0 0 0 0 0 0 1 1 1 1 1 1
 1 1 1 0 1 1 0 0 1 1 1 1 1 1 1 1 0 0 1 1 1 1 0 1 1 1 1 1 0 1 1 0 1 1 1 1 1
 0 1 0 1 0 0 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 0 0 1 0 1 1 1
 1 0 0 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 0]
2025-06-06 11:13:28,782 - INFO - test_split["labels"] : [1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0]
2025-06-06 11:13:28,783 - INFO - Confusion matrix: TN=35, FP=0, FN=0, TP=98
2025-06-06 11:13:31,527 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 35, 'FP': 0, 'FN': 0, 'TP': 98}
2025-06-06 11:13:31,652 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-06 11:13:31,749 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 11:13:31,749 - INFO - 
On test Set (optimal threshold of 0.9994879961013794 according to cross validation on the training set): 
2025-06-06 11:13:31,751 - INFO - Confusion matrix: TN=35, FP=0, FN=2, TP=96
2025-06-06 11:13:34,569 - INFO - Metrics: {'f1': 0.9896907216494846, 'recall': 0.9795918367346939, 'precision': 1.0, 'accuracy': 0.9849624060150376, 'AP': 1.0, 'MCC': 0.962621902223779, 'NDCG': 1.0000000000000004, 'kappa': 0.9619238476953907, 'TN': 35, 'FP': 0, 'FN': 2, 'TP': 96}
2025-06-06 11:13:34,671 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 11:13:34,671 - INFO - Results for fold 1 : [{'f1': 0.9896907216494846, 'recall': 0.9795918367346939, 'precision': 1.0, 'accuracy': 0.9849624060150376, 'AP': 1.0, 'MCC': 0.962621902223779, 'NDCG': 1.0000000000000004, 'kappa': 0.9619238476953907, 'TN': 35, 'FP': 0, 'FN': 2, 'TP': 96}]
2025-06-06 11:13:34,793 - INFO - Cleared CUDA cache. Memory allocated: 1.43 GB, Memory reserved: 1.86 GB
2025-06-06 11:13:34,793 - INFO - 
fold number 2 / 3
2025-06-06 11:13:34,800 - INFO - train split size : 697
2025-06-06 11:13:34,800 - INFO - dev split size : 67
2025-06-06 11:13:34,800 - INFO - test split size : 132
Map (num_proc=32):   0%|          | 0/697 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 22/697 [00:00<00:06, 103.46 examples/s]Map (num_proc=32):  19%|â–ˆâ–‰        | 132/697 [00:00<00:01, 473.06 examples/s]Map (num_proc=32):  32%|â–ˆâ–ˆâ–ˆâ–      | 220/697 [00:00<00:00, 605.32 examples/s]Map (num_proc=32):  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 330/697 [00:00<00:00, 709.97 examples/s]Map (num_proc=32):  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 418/697 [00:00<00:00, 746.25 examples/s]Map (num_proc=32):  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 528/697 [00:00<00:00, 781.75 examples/s]Map (num_proc=32):  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 613/697 [00:00<00:00, 751.45 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 697/697 [00:01<00:00, 628.05 examples/s]
Map (num_proc=32):   0%|          | 0/67 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/67 [00:00<00:03, 18.04 examples/s]Map (num_proc=32):  22%|â–ˆâ–ˆâ–       | 15/67 [00:00<00:00, 60.17 examples/s]Map (num_proc=32):  34%|â–ˆâ–ˆâ–ˆâ–      | 23/67 [00:00<00:00, 67.41 examples/s]Map (num_proc=32):  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 33/67 [00:00<00:00, 73.33 examples/s]Map (num_proc=32):  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 43/67 [00:00<00:00, 77.28 examples/s]Map (num_proc=32):  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 51/67 [00:00<00:00, 77.64 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 61/67 [00:00<00:00, 79.21 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:01<00:00, 64.80 examples/s]
Map (num_proc=32):   0%|          | 0/132 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/132 [00:00<00:04, 27.69 examples/s]Map (num_proc=32):  18%|â–ˆâ–Š        | 24/132 [00:00<00:01, 92.04 examples/s]Map (num_proc=32):  36%|â–ˆâ–ˆâ–ˆâ–‹      | 48/132 [00:00<00:00, 138.09 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 68/132 [00:00<00:00, 147.55 examples/s]Map (num_proc=32):  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 84/132 [00:00<00:00, 151.32 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 104/132 [00:00<00:00, 155.80 examples/s]Map (num_proc=32):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 124/132 [00:00<00:00, 163.23 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 132/132 [00:01<00:00, 127.14 examples/s]
2025-06-06 11:13:43,401 - INFO - 3 datasets tokenized successfully
2025-06-06 11:13:43,403 - INFO - Starting hyperparameter search for BCE loss
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-06_11-13-43   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-13-43
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-06_10-55-47_424551_3536632/artifacts/2025-06-06_11-13-43/train_hpo_2025-06-06_11-13-43/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-06 11:13:43. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_ee3a54e9   PENDING         8.49369       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_ee3a54e9 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_ee3a54e9 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          8.49369 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3560747)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3560747)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3560747)[0m 2025-06-06 11:13:50,977 - INFO - pos_weight value in TrainingArguments : 8.493688290834637
[36m(train_hpo pid=3560747)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3560747)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3560747)[0m [2025-06-06 11:13:51,234] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3560747)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=48, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3560747)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3560747)[0m   warnings.warn(

Trial train_hpo_195d9457 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_195d9457 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          7.54953 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3560979)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3560979)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3560979)[0m 2025-06-06 11:13:57,495 - INFO - pos_weight value in TrainingArguments : 7.549531688595925
[36m(train_hpo pid=3560979)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3560979)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3560979)[0m [2025-06-06 11:13:57,890] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3560979)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3560979)[0m   warnings.warn(
[36m(train_hpo pid=3560979)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_f8cee8e7 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_f8cee8e7 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          8.94984 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3561259)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3561259)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3561259)[0m 2025-06-06 11:14:04,198 - INFO - pos_weight value in TrainingArguments : 8.949837496427758
[36m(train_hpo pid=3561259)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3561259)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3561259)[0m [2025-06-06 11:14:04,433] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3561259)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3561259)[0m   warnings.warn(
[36m(train_hpo pid=3561259)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=24, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 3 RUNNING
Current time: 2025-06-06 11:14:13. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_ee3a54e9   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_195d9457   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_f8cee8e7   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3560747)[0m {'loss': 2.5901, 'grad_norm': 25.22568702697754, 'learning_rate': 1.246338876535363e-06, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3561259)[0m {'loss': 1.3595, 'grad_norm': 10.199104309082031, 'learning_rate': 5.325452975187489e-05, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3560979)[0m {'loss': 1.8216, 'grad_norm': 11.12436580657959, 'learning_rate': 3.6443132246884782e-06, 'epoch': 0.9142857142857143}
Trial status: 3 RUNNING
Current time: 2025-06-06 11:14:43. Total running time: 1min 0s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_ee3a54e9   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_195d9457   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_f8cee8e7   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3560747)[0m {'loss': 2.5142, 'grad_norm': 25.871631622314453, 'learning_rate': 9.970711012282902e-07, 'epoch': 1.9142857142857141}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3561259)[0m {'train_runtime': 37.8351, 'train_samples_per_second': 55.266, 'train_steps_per_second': 0.634, 'train_loss': 0.7461668848991394, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3561259)[0m STATE at ending of training  :  TrainerState(epoch=2.914285714285714, global_step=24, max_steps=24, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=514737213715560.0, log_history=[{'loss': 1.3595, 'grad_norm': 10.199104309082031, 'learning_rate': 5.325452975187489e-05, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.5727, 'grad_norm': 7.039532661437988, 'learning_rate': 2.6627264875937445e-05, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 0.3063, 'grad_norm': 4.446402549743652, 'learning_rate': 0.0, 'epoch': 2.914285714285714, 'step': 24}, {'train_runtime': 37.8351, 'train_samples_per_second': 55.266, 'train_steps_per_second': 0.634, 'total_flos': 514737213715560.0, 'train_loss': 0.7461668848991394, 'epoch': 2.914285714285714, 'step': 24}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3561259)[0m 2025-06-06 11:14:48,989 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3561259)[0m 2025-06-06 11:14:48,995 - INFO - eval_result: {'eval_loss': 0.3002801835536957, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9538202881813049, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.397, 'eval_samples_per_second': 19.723, 'eval_steps_per_second': 1.178, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3561259)[0m 2025-06-06 11:14:49,031 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3561259)[0m {'eval_loss': 0.3002801835536957, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9538202881813049, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.397, 'eval_samples_per_second': 19.723, 'eval_steps_per_second': 1.178, 'epoch': 2.914285714285714}

Trial train_hpo_f8cee8e7 finished iteration 1 at 2025-06-06 11:14:49. Total running time: 1min 5s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_f8cee8e7 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    45.2747 â”‚
â”‚ time_total_s                        45.2747 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               2.91429 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                                  1 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                             1 â”‚
â”‚ eval_f1                                   1 â”‚
â”‚ eval_kappa                                1 â”‚
â”‚ eval_loss                           0.30028 â”‚
â”‚ eval_optim_threshold                0.95382 â”‚
â”‚ eval_precision                            1 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                          3.397 â”‚
â”‚ eval_samples_per_second              19.723 â”‚
â”‚ eval_steps_per_second                 1.178 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:14:49,056 - INFO - Cleaning up trial f8cee8e7
2025-06-06 11:14:49,056 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-13-43/train_hpo_f8cee8e7_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512_2025-06-06_11-13-57

Trial train_hpo_f8cee8e7 completed after 1 iterations at 2025-06-06 11:14:49. Total running time: 1min 5s
[36m(train_hpo pid=3560979)[0m {'loss': 1.6023, 'grad_norm': 7.492927074432373, 'learning_rate': 2.7332349185163582e-06, 'epoch': 1.9142857142857141}[32m [repeated 2x across cluster][0m

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:15:13. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_ee3a54e9   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_195d9457   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_f8cee8e7   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.2746       0.30028           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3560747)[0m {'loss': 2.4542, 'grad_norm': 21.8979434967041, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3560979)[0m {'loss': 1.4462, 'grad_norm': 6.383444309234619, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.914285714285714}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:15:43. Total running time: 2min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_ee3a54e9   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_195d9457   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_f8cee8e7   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.2746       0.30028           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3560747)[0m {'loss': 2.3257, 'grad_norm': 15.993820190429688, 'learning_rate': 4.985355506141451e-07, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3560979)[0m {'loss': 1.3493, 'grad_norm': 7.109828472137451, 'learning_rate': 9.110783061721196e-07, 'epoch': 3.914285714285714}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:16:13. Total running time: 2min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_ee3a54e9   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_195d9457   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_f8cee8e7   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.2746       0.30028           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3560747)[0m {'loss': 2.2489, 'grad_norm': 31.247310638427734, 'learning_rate': 2.4926777530707256e-07, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3560979)[0m {'loss': 1.2595, 'grad_norm': 9.422983169555664, 'learning_rate': 0.0, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3560979)[0m {'train_runtime': 148.1257, 'train_samples_per_second': 23.527, 'train_steps_per_second': 0.27, 'train_loss': 1.4957804679870605, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3560979)[0m STATE at ending of training  :  TrainerState(epoch=4.914285714285715, global_step=40, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=861454860515760.0, log_history=[{'loss': 1.8216, 'grad_norm': 11.12436580657959, 'learning_rate': 3.6443132246884782e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 1.6023, 'grad_norm': 7.492927074432373, 'learning_rate': 2.7332349185163582e-06, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 1.4462, 'grad_norm': 6.383444309234619, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 1.3493, 'grad_norm': 7.109828472137451, 'learning_rate': 9.110783061721196e-07, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 1.2595, 'grad_norm': 9.422983169555664, 'learning_rate': 0.0, 'epoch': 4.914285714285715, 'step': 40}, {'train_runtime': 148.1257, 'train_samples_per_second': 23.527, 'train_steps_per_second': 0.27, 'total_flos': 861454860515760.0, 'train_loss': 1.4957804679870605, 'epoch': 4.914285714285715, 'step': 40}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_195d9457 finished iteration 1 at 2025-06-06 11:16:33. Total running time: 2min 49s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_195d9457 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    156.211 â”‚
â”‚ time_total_s                        156.211 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               4.91429 â”‚
â”‚ eval_AP                             0.98903 â”‚
â”‚ eval_MCC                            0.41574 â”‚
â”‚ eval_NDCG                             0.998 â”‚
â”‚ eval_accuracy                       0.79104 â”‚
â”‚ eval_f1                               0.875 â”‚
â”‚ eval_kappa                          0.29474 â”‚
â”‚ eval_loss                           2.58363 â”‚
â”‚ eval_optim_threshold                0.59025 â”‚
â”‚ eval_precision                      0.77778 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.9074 â”‚
â”‚ eval_samples_per_second              17.147 â”‚
â”‚ eval_steps_per_second                 1.024 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:16:33,285 - INFO - Cleaning up trial 195d9457
2025-06-06 11:16:33,286 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-13-43/train_hpo_195d9457_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-06_11-13-50
2025-06-06 11:16:33,286 - INFO - Current best: f8cee8e7 with eval_f1 : 1.0 at iteration 1

Trial train_hpo_195d9457 completed after 1 iterations at 2025-06-06 11:16:33. Total running time: 2min 49s
[36m(train_hpo pid=3560979)[0m 2025-06-06 11:16:33,218 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3560979)[0m 2025-06-06 11:16:33,224 - INFO - eval_result: {'eval_loss': 2.5836284160614014, 'eval_f1': 0.875, 'eval_recall': 1.0, 'eval_accuracy': 0.7910447761194029, 'eval_precision': 0.7777777777777778, 'eval_optim_threshold': 0.590252697467804, 'eval_AP': 0.9890316254143645, 'eval_MCC': 0.41573970964154905, 'eval_NDCG': 0.9979987741398203, 'eval_kappa': 0.2947368421052631, 'eval_runtime': 3.9074, 'eval_samples_per_second': 17.147, 'eval_steps_per_second': 1.024, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3560979)[0m 2025-06-06 11:16:33,262 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3560979)[0m {'eval_loss': 2.5836284160614014, 'eval_f1': 0.875, 'eval_recall': 1.0, 'eval_accuracy': 0.7910447761194029, 'eval_precision': 0.7777777777777778, 'eval_optim_threshold': 0.590252697467804, 'eval_AP': 0.9890316254143645, 'eval_MCC': 0.41573970964154905, 'eval_NDCG': 0.9979987741398203, 'eval_kappa': 0.2947368421052631, 'eval_runtime': 3.9074, 'eval_samples_per_second': 17.147, 'eval_steps_per_second': 1.024, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3560747)[0m STATE at ending of training  :  TrainerState(epoch=5.914285714285715, global_step=48, max_steps=48, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=1035065487157200.0, log_history=[{'loss': 2.5901, 'grad_norm': 25.22568702697754, 'learning_rate': 1.246338876535363e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 2.5142, 'grad_norm': 25.871631622314453, 'learning_rate': 9.970711012282902e-07, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 2.4542, 'grad_norm': 21.8979434967041, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 2.3257, 'grad_norm': 15.993820190429688, 'learning_rate': 4.985355506141451e-07, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 2.2489, 'grad_norm': 31.247310638427734, 'learning_rate': 2.4926777530707256e-07, 'epoch': 4.914285714285715, 'step': 40}, {'loss': 2.1916, 'grad_norm': 22.808748245239258, 'learning_rate': 0.0, 'epoch': 5.914285714285715, 'step': 48}, {'train_runtime': 161.6322, 'train_samples_per_second': 25.874, 'train_steps_per_second': 0.297, 'total_flos': 1035065487157200.0, 'train_loss': 2.3874380191167197, 'epoch': 5.914285714285715, 'step': 48}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3560747)[0m {'loss': 2.1916, 'grad_norm': 22.808748245239258, 'learning_rate': 0.0, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3560747)[0m {'train_runtime': 161.6322, 'train_samples_per_second': 25.874, 'train_steps_per_second': 0.297, 'train_loss': 2.3874380191167197, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3560747)[0m {'eval_loss': 6.741910457611084, 'eval_f1': 0.0, 'eval_recall': 0.0, 'eval_accuracy': 0.2537313432835821, 'eval_precision': 0.0, 'eval_optim_threshold': 0.33117005228996277, 'eval_AP': 0.8127109017012306, 'eval_MCC': -0.2030905986149808, 'eval_NDCG': 0.9024816981763685, 'eval_kappa': -0.030135301353013677, 'eval_runtime': 3.3375, 'eval_samples_per_second': 20.075, 'eval_steps_per_second': 1.198, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3560747)[0m 2025-06-06 11:16:39,462 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3560747)[0m 2025-06-06 11:16:39,468 - INFO - eval_result: {'eval_loss': 6.741910457611084, 'eval_f1': 0.0, 'eval_recall': 0.0, 'eval_accuracy': 0.2537313432835821, 'eval_precision': 0.0, 'eval_optim_threshold': 0.33117005228996277, 'eval_AP': 0.8127109017012306, 'eval_MCC': -0.2030905986149808, 'eval_NDCG': 0.9024816981763685, 'eval_kappa': -0.030135301353013677, 'eval_runtime': 3.3375, 'eval_samples_per_second': 20.075, 'eval_steps_per_second': 1.198, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3560747)[0m 2025-06-06 11:16:39,505 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB

Trial train_hpo_ee3a54e9 finished iteration 1 at 2025-06-06 11:16:39. Total running time: 2min 56s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_ee3a54e9 result              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                          â”‚
â”‚ time_this_iter_s                     169.184 â”‚
â”‚ time_total_s                         169.184 â”‚
â”‚ training_iteration                         1 â”‚
â”‚ epoch                                5.91429 â”‚
â”‚ eval_AP                              0.81271 â”‚
â”‚ eval_MCC                            -0.20309 â”‚
â”‚ eval_NDCG                            0.90248 â”‚
â”‚ eval_accuracy                        0.25373 â”‚
â”‚ eval_f1                                    0 â”‚
â”‚ eval_kappa                          -0.03014 â”‚
â”‚ eval_loss                            6.74191 â”‚
â”‚ eval_optim_threshold                 0.33117 â”‚
â”‚ eval_precision                             0 â”‚
â”‚ eval_recall                                0 â”‚
â”‚ eval_runtime                          3.3375 â”‚
â”‚ eval_samples_per_second               20.075 â”‚
â”‚ eval_steps_per_second                  1.198 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:16:39,528 - INFO - Cleaning up trial ee3a54e9
2025-06-06 11:16:39,529 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-13-43/train_hpo_ee3a54e9_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-06_11-13-43
2025-06-06 11:16:39,529 - INFO - Cleaning up trial 195d9457
2025-06-06 11:16:39,529 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-13-43/train_hpo_195d9457_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-06_11-13-50
2025-06-06 11:16:39,529 - INFO - Current best: f8cee8e7 with eval_f1 : 1.0 at iteration 1

Trial train_hpo_ee3a54e9 completed after 1 iterations at 2025-06-06 11:16:39. Total running time: 2min 56s
2025-06-06 11:16:39,536	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-13-43' in 0.0055s.

Trial status: 3 TERMINATED
Current time: 2025-06-06 11:16:39. Total running time: 2min 56s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_ee3a54e9   TERMINATED        8.49369       1.49561e-06         0.13641                     6        1           169.184        6.74191       0                   0          0.253731 â”‚
â”‚ train_hpo_195d9457   TERMINATED        7.54953       4.55539e-06         0.123031                    5        1           156.211        2.58363       0.875               1          0.791045 â”‚
â”‚ train_hpo_f8cee8e7   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.2746       0.30028       1                   1          1        â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

2025-06-06 11:16:39,543 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x700d58206f90>
2025-06-06 11:16:39,544 - INFO - Best trial : train_hpo_f8cee8e7
2025-06-06 11:16:39,544 - INFO - Best config : {'pos_weight': 8.949837496427758, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-06 11:16:39,544 - INFO - Best trial after optimization: {'eval_loss': 0.3002801835536957, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9538202881813049, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.397, 'eval_samples_per_second': 19.723, 'eval_steps_per_second': 1.178, 'epoch': 2.914285714285714, 'timestamp': 1749201289, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': 'f8cee8e7', 'date': '2025-06-06_11-14-49', 'time_this_iter_s': 45.274649143218994, 'time_total_s': 45.274649143218994, 'pid': 3561259, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 8.949837496427758, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 45.274649143218994, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512'}
2025-06-06 11:16:39,565 - INFO - analysis dataframe :    eval_loss  eval_f1  ...  config/num_train_epochs    logdir
0   6.741910    0.000  ...                        6  ee3a54e9
1   2.583628    0.875  ...                        5  195d9457
2   0.300280    1.000  ...                        3  f8cee8e7

[3 rows x 32 columns]
2025-06-06 11:16:39,707 - INFO - Trial comparison plot saved
2025-06-06 11:16:39,707 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-06 11:16:39,950 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-06 11:16:40,063 - INFO - training size : 697
2025-06-06 11:16:40,063 - INFO - dev size : 67
2025-06-06 11:16:40,063 - INFO - test size : 132
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
  0%|          | 0/90 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  1%|          | 1/90 [00:00<00:57,  1.54it/s]  2%|â–         | 2/90 [00:01<00:55,  1.58it/s]  3%|â–Ž         | 3/90 [00:01<00:54,  1.60it/s]  4%|â–         | 4/90 [00:02<00:53,  1.60it/s]  6%|â–Œ         | 5/90 [00:03<00:52,  1.61it/s]  7%|â–‹         | 6/90 [00:03<00:52,  1.61it/s]  8%|â–Š         | 7/90 [00:04<00:51,  1.61it/s]  9%|â–‰         | 8/90 [00:04<00:50,  1.61it/s] 10%|â–ˆ         | 9/90 [00:05<00:50,  1.61it/s] 11%|â–ˆ         | 10/90 [00:06<00:49,  1.61it/s] 12%|â–ˆâ–        | 11/90 [00:06<00:48,  1.62it/s] 13%|â–ˆâ–Ž        | 12/90 [00:07<00:48,  1.62it/s] 14%|â–ˆâ–        | 13/90 [00:08<00:47,  1.62it/s] 16%|â–ˆâ–Œ        | 14/90 [00:08<00:47,  1.62it/s] 17%|â–ˆâ–‹        | 15/90 [00:09<00:46,  1.62it/s] 18%|â–ˆâ–Š        | 16/90 [00:09<00:45,  1.62it/s] 19%|â–ˆâ–‰        | 17/90 [00:10<00:45,  1.62it/s] 20%|â–ˆâ–ˆ        | 18/90 [00:11<00:44,  1.62it/s] 21%|â–ˆâ–ˆ        | 19/90 [00:11<00:43,  1.62it/s] 22%|â–ˆâ–ˆâ–       | 20/90 [00:12<00:43,  1.62it/s] 23%|â–ˆâ–ˆâ–Ž       | 21/90 [00:13<00:42,  1.62it/s] 24%|â–ˆâ–ˆâ–       | 22/90 [00:13<00:42,  1.62it/s] 26%|â–ˆâ–ˆâ–Œ       | 23/90 [00:14<00:41,  1.62it/s] 27%|â–ˆâ–ˆâ–‹       | 24/90 [00:14<00:40,  1.62it/s] 28%|â–ˆâ–ˆâ–Š       | 25/90 [00:15<00:40,  1.62it/s] 29%|â–ˆâ–ˆâ–‰       | 26/90 [00:16<00:39,  1.62it/s] 30%|â–ˆâ–ˆâ–ˆ       | 27/90 [00:16<00:38,  1.62it/s] 31%|â–ˆâ–ˆâ–ˆ       | 28/90 [00:17<00:38,  1.62it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 29/90 [00:17<00:37,  1.63it/s]                                               {'loss': 0.7089, 'grad_norm': 0.22053785622119904, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 30/90 [00:18<00:36,  1.63it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 31/90 [00:18<00:29,  2.03it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 32/90 [00:19<00:30,  1.91it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 33/90 [00:19<00:31,  1.82it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 34/90 [00:20<00:31,  1.76it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 35/90 [00:21<00:32,  1.72it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 36/90 [00:21<00:31,  1.69it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 37/90 [00:22<00:31,  1.67it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 38/90 [00:22<00:31,  1.65it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 39/90 [00:23<00:31,  1.64it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 40/90 [00:24<00:30,  1.63it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 41/90 [00:24<00:30,  1.63it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 42/90 [00:25<00:29,  1.64it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 43/90 [00:26<00:28,  1.63it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 44/90 [00:26<00:28,  1.62it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 45/90 [00:27<00:27,  1.62it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 46/90 [00:27<00:27,  1.62it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 47/90 [00:28<00:26,  1.62it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 48/90 [00:29<00:25,  1.62it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 49/90 [00:29<00:25,  1.62it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 50/90 [00:30<00:24,  1.62it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 51/90 [00:31<00:24,  1.62it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 52/90 [00:31<00:23,  1.62it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 53/90 [00:32<00:22,  1.62it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 54/90 [00:32<00:22,  1.62it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 55/90 [00:33<00:21,  1.61it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 56/90 [00:34<00:21,  1.62it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 57/90 [00:34<00:20,  1.62it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 58/90 [00:35<00:19,  1.62it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 59/90 [00:35<00:19,  1.63it/s]                                               {'loss': 0.004, 'grad_norm': 0.020405815914273262, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 60/90 [00:35<00:18,  1.63it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 61/90 [00:36<00:14,  2.05it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 62/90 [00:37<00:14,  1.93it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 63/90 [00:37<00:14,  1.83it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 64/90 [00:38<00:14,  1.77it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 65/90 [00:39<00:14,  1.72it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 66/90 [00:39<00:14,  1.69it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 67/90 [00:40<00:13,  1.67it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 68/90 [00:40<00:13,  1.65it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 69/90 [00:41<00:12,  1.64it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 70/90 [00:42<00:12,  1.63it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 71/90 [00:42<00:11,  1.63it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 72/90 [00:43<00:11,  1.62it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 73/90 [00:44<00:10,  1.62it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 74/90 [00:44<00:09,  1.62it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 75/90 [00:45<00:09,  1.61it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 76/90 [00:45<00:08,  1.62it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 77/90 [00:46<00:08,  1.62it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 78/90 [00:47<00:07,  1.62it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 79/90 [00:47<00:06,  1.61it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 80/90 [00:48<00:06,  1.62it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 81/90 [00:48<00:05,  1.63it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 82/90 [00:49<00:04,  1.62it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 83/90 [00:50<00:04,  1.62it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 84/90 [00:50<00:03,  1.62it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 85/90 [00:51<00:03,  1.62it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 86/90 [00:52<00:02,  1.62it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 87/90 [00:52<00:01,  1.62it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 88/90 [00:53<00:01,  1.62it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 89/90 [00:53<00:00,  1.63it/s]                                               {'loss': 0.0013, 'grad_norm': 0.00942209642380476, 'learning_rate': 0.0, 'epoch': 3.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.63it/s]                                               {'train_runtime': 56.465, 'train_samples_per_second': 37.032, 'train_steps_per_second': 1.594, 'train_loss': 0.23806714490056038, 'epoch': 3.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.63it/s]2025-06-06 11:17:36,965 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.59it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.19it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.37it/s]2025-06-06 11:17:40,687 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.14s/it]
2025-06-06 11:17:40,693 - INFO - Training time : 60.985827296972275
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.10it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.00it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.33it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.08it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.30it/s]2025-06-06 11:17:45,610 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.30it/s]
2025-06-06 11:17:45,615 - INFO - Evaluation time : 4.922287590103224
2025-06-06 11:17:45,615 - INFO - Evaluation results on test set: {'eval_loss': 0.0023035467602312565, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9994421601295471, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000004, 'eval_kappa': 1.0, 'eval_runtime': 4.918, 'eval_samples_per_second': 26.84, 'eval_steps_per_second': 1.22, 'epoch': 3.0}
2025-06-06 11:17:45,615 - INFO - Total updates (optimizer steps): 90
2025-06-06 11:17:45,615 - INFO - Avg time / step: 0.627s
2025-06-06 11:17:46,442 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCEgoogle-bert/bert-base-uncased3trials_fold-2
2025-06-06 11:17:46,443 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.14it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.02it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.34it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.08it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.31it/s]2025-06-06 11:17:50,839 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.47it/s]
2025-06-06 11:17:50,843 - INFO - preds : [1 1 0 1 1 1 1 1 1 0 1 0 1 1 0 1 1 1 1 1 1 0 1 1 1 1 1 1 0 1 1 0 1 1 1 1 1
 1 1 1 1 1 0 0 1 0 1 0 0 1 0 0 1 1 1 1 0 0 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 1 0 1 1 1 1 1 1 0 1 0 1 1 1 1 1 0 1 1 1 0 1
 1 0 1 1 1 0 0 1 0 0 1 1 1 1 1 1 1 0 1 1 1]
2025-06-06 11:17:50,844 - INFO - test_split["labels"] : [1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1]
2025-06-06 11:17:50,845 - INFO - Confusion matrix: TN=34, FP=0, FN=0, TP=98
2025-06-06 11:17:53,552 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 34, 'FP': 0, 'FN': 0, 'TP': 98}
2025-06-06 11:17:53,674 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-06 11:17:53,769 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 11:17:53,769 - INFO - 
On test Set (optimal threshold of 0.999650239944458 according to cross validation on the training set): 
2025-06-06 11:17:53,771 - INFO - Confusion matrix: TN=34, FP=0, FN=7, TP=91
2025-06-06 11:17:56,505 - INFO - Metrics: {'f1': 0.9629629629629629, 'recall': 0.9285714285714286, 'precision': 1.0, 'accuracy': 0.946969696969697, 'AP': 1.0, 'MCC': 0.8775162922735822, 'NDCG': 1.0000000000000004, 'kappa': 0.8700787401574803, 'TN': 34, 'FP': 0, 'FN': 7, 'TP': 91}
2025-06-06 11:17:56,606 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 11:17:56,606 - INFO - Results for fold 2 : [{'f1': 0.9629629629629629, 'recall': 0.9285714285714286, 'precision': 1.0, 'accuracy': 0.946969696969697, 'AP': 1.0, 'MCC': 0.8775162922735822, 'NDCG': 1.0000000000000004, 'kappa': 0.8700787401574803, 'TN': 34, 'FP': 0, 'FN': 7, 'TP': 91}]
2025-06-06 11:17:56,724 - INFO - Cleared CUDA cache. Memory allocated: 1.42 GB, Memory reserved: 1.90 GB
2025-06-06 11:17:56,725 - INFO - 
fold number 3 / 3
2025-06-06 11:17:56,731 - INFO - train split size : 697
2025-06-06 11:17:56,731 - INFO - dev split size : 67
2025-06-06 11:17:56,731 - INFO - test split size : 132
Map (num_proc=32):   0%|          | 0/697 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 22/697 [00:00<00:06, 98.71 examples/s]Map (num_proc=32):  19%|â–ˆâ–‰        | 132/697 [00:00<00:01, 426.78 examples/s]Map (num_proc=32):  38%|â–ˆâ–ˆâ–ˆâ–Š      | 264/697 [00:00<00:00, 679.39 examples/s]Map (num_proc=32):  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 374/697 [00:00<00:00, 752.57 examples/s]Map (num_proc=32):  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 462/697 [00:00<00:00, 775.74 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 550/697 [00:00<00:00, 804.08 examples/s]Map (num_proc=32):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 655/697 [00:00<00:00, 802.85 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 697/697 [00:01<00:00, 630.15 examples/s]
Map (num_proc=32):   0%|          | 0/67 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/67 [00:00<00:03, 16.79 examples/s]Map (num_proc=32):  19%|â–ˆâ–‰        | 13/67 [00:00<00:01, 49.92 examples/s]Map (num_proc=32):  34%|â–ˆâ–ˆâ–ˆâ–      | 23/67 [00:00<00:00, 66.37 examples/s]Map (num_proc=32):  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 31/67 [00:00<00:00, 67.02 examples/s]Map (num_proc=32):  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 41/67 [00:00<00:00, 74.69 examples/s]Map (num_proc=32):  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 51/67 [00:00<00:00, 78.10 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 61/67 [00:00<00:00, 80.19 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:01<00:00, 63.71 examples/s]
Map (num_proc=32):   0%|          | 0/132 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/132 [00:00<00:05, 23.62 examples/s]Map (num_proc=32):  18%|â–ˆâ–Š        | 24/132 [00:00<00:01, 88.04 examples/s]Map (num_proc=32):  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 44/132 [00:00<00:00, 127.71 examples/s]Map (num_proc=32):  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 60/132 [00:00<00:00, 138.57 examples/s]Map (num_proc=32):  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 80/132 [00:00<00:00, 148.42 examples/s]Map (num_proc=32):  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 100/132 [00:00<00:00, 148.39 examples/s]Map (num_proc=32):  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 116/132 [00:00<00:00, 142.28 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 132/132 [00:01<00:00, 122.12 examples/s]
2025-06-06 11:18:05,389 - INFO - 3 datasets tokenized successfully
2025-06-06 11:18:05,391 - INFO - Starting hyperparameter search for BCE loss
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-06_11-18-05   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-18-05
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-06_10-55-47_424551_3536632/artifacts/2025-06-06_11-18-05/train_hpo_2025-06-06_11-18-05/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-06 11:18:05. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_832de31a   PENDING         8.49369       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_832de31a started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_832de31a config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          8.49369 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3565711)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3565711)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3565711)[0m 2025-06-06 11:18:12,648 - INFO - pos_weight value in TrainingArguments : 8.493688290834637
[36m(train_hpo pid=3565711)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3565711)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3565711)[0m [2025-06-06 11:18:12,892] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3565711)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3565711)[0m   warnings.warn(
[36m(train_hpo pid=3565711)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=48, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_6bbd4680 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_6bbd4680 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          7.54953 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3565872)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3565872)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3565872)[0m 2025-06-06 11:18:19,405 - INFO - pos_weight value in TrainingArguments : 7.549531688595925
[36m(train_hpo pid=3565872)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3565872)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3565872)[0m [2025-06-06 11:18:19,774] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3565872)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3565872)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3565872)[0m   warnings.warn(

Trial train_hpo_90a9f772 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_90a9f772 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          8.94984 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3566222)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3566222)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3566222)[0m 2025-06-06 11:18:26,304 - INFO - pos_weight value in TrainingArguments : 8.949837496427758
[36m(train_hpo pid=3566222)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3566222)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3566222)[0m [2025-06-06 11:18:26,541] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3566222)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=24, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3566222)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3566222)[0m   warnings.warn(

Trial status: 3 RUNNING
Current time: 2025-06-06 11:18:35. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_832de31a   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_6bbd4680   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_90a9f772   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3565711)[0m {'loss': 1.725, 'grad_norm': 7.073610782623291, 'learning_rate': 1.246338876535363e-06, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3566222)[0m {'loss': 1.44, 'grad_norm': 10.254676818847656, 'learning_rate': 5.325452975187489e-05, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3565872)[0m {'loss': 1.7645, 'grad_norm': 11.063955307006836, 'learning_rate': 3.6443132246884782e-06, 'epoch': 0.9142857142857143}
Trial status: 3 RUNNING
Current time: 2025-06-06 11:19:05. Total running time: 1min 0s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_832de31a   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_6bbd4680   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_90a9f772   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3565711)[0m {'loss': 1.7001, 'grad_norm': 8.092192649841309, 'learning_rate': 9.970711012282902e-07, 'epoch': 1.9142857142857141}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3566222)[0m {'train_runtime': 37.7602, 'train_samples_per_second': 55.376, 'train_steps_per_second': 0.636, 'train_loss': 0.7048655351003011, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3566222)[0m STATE at ending of training  :  TrainerState(epoch=2.914285714285714, global_step=24, max_steps=24, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=513904721366640.0, log_history=[{'loss': 1.44, 'grad_norm': 10.254676818847656, 'learning_rate': 5.325452975187489e-05, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.5214, 'grad_norm': 4.394491195678711, 'learning_rate': 2.6627264875937445e-05, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 0.1531, 'grad_norm': 1.639971375465393, 'learning_rate': 0.0, 'epoch': 2.914285714285714, 'step': 24}, {'train_runtime': 37.7602, 'train_samples_per_second': 55.376, 'train_steps_per_second': 0.636, 'total_flos': 513904721366640.0, 'train_loss': 0.7048655351003011, 'epoch': 2.914285714285714, 'step': 24}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_90a9f772 finished iteration 1 at 2025-06-06 11:19:10. Total running time: 1min 5s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_90a9f772 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    44.9257 â”‚
â”‚ time_total_s                        44.9257 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               2.91429 â”‚
â”‚ eval_AP                             0.99538 â”‚
â”‚ eval_MCC                            0.96206 â”‚
â”‚ eval_NDCG                           0.99916 â”‚
â”‚ eval_accuracy                       0.98507 â”‚
â”‚ eval_f1                              0.9899 â”‚
â”‚ eval_kappa                          0.96134 â”‚
â”‚ eval_loss                           0.68219 â”‚
â”‚ eval_optim_threshold                0.83138 â”‚
â”‚ eval_precision                            1 â”‚
â”‚ eval_recall                            0.98 â”‚
â”‚ eval_runtime                         3.2943 â”‚
â”‚ eval_samples_per_second              20.338 â”‚
â”‚ eval_steps_per_second                 1.214 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:19:10,819 - INFO - Cleaning up trial 90a9f772
2025-06-06 11:19:10,819 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-18-05/train_hpo_90a9f772_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512_2025-06-06_11-18-18

Trial train_hpo_90a9f772 completed after 1 iterations at 2025-06-06 11:19:10. Total running time: 1min 5s
[36m(train_hpo pid=3566222)[0m {'eval_loss': 0.6821871995925903, 'eval_f1': 0.98989898989899, 'eval_recall': 0.98, 'eval_accuracy': 0.9850746268656716, 'eval_precision': 1.0, 'eval_optim_threshold': 0.8313842415809631, 'eval_AP': 0.9953846153846154, 'eval_MCC': 0.9620579793107875, 'eval_NDCG': 0.9991588536744717, 'eval_kappa': 0.96133871898442, 'eval_runtime': 3.2943, 'eval_samples_per_second': 20.338, 'eval_steps_per_second': 1.214, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3566222)[0m 2025-06-06 11:19:10,751 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3566222)[0m 2025-06-06 11:19:10,756 - INFO - eval_result: {'eval_loss': 0.6821871995925903, 'eval_f1': 0.98989898989899, 'eval_recall': 0.98, 'eval_accuracy': 0.9850746268656716, 'eval_precision': 1.0, 'eval_optim_threshold': 0.8313842415809631, 'eval_AP': 0.9953846153846154, 'eval_MCC': 0.9620579793107875, 'eval_NDCG': 0.9991588536744717, 'eval_kappa': 0.96133871898442, 'eval_runtime': 3.2943, 'eval_samples_per_second': 20.338, 'eval_steps_per_second': 1.214, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3566222)[0m 2025-06-06 11:19:10,794 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3565872)[0m {'loss': 1.6856, 'grad_norm': 8.446898460388184, 'learning_rate': 2.7332349185163582e-06, 'epoch': 1.9142857142857141}[32m [repeated 2x across cluster][0m

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:19:35. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_832de31a   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_6bbd4680   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_90a9f772   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            44.9257      0.682187    0.989899            0.98          0.985075 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3565711)[0m {'loss': 1.7184, 'grad_norm': 5.243696689605713, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3565872)[0m {'loss': 1.6016, 'grad_norm': 5.006882667541504, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3565711)[0m {'loss': 1.7107, 'grad_norm': 2.9511055946350098, 'learning_rate': 4.985355506141451e-07, 'epoch': 3.914285714285714}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:20:05. Total running time: 2min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_832de31a   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_6bbd4680   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_90a9f772   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            44.9257      0.682187    0.989899            0.98          0.985075 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3565872)[0m {'loss': 1.4453, 'grad_norm': 8.81900691986084, 'learning_rate': 9.110783061721196e-07, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3565711)[0m {'loss': 1.6865, 'grad_norm': 15.182605743408203, 'learning_rate': 2.4926777530707256e-07, 'epoch': 4.914285714285715}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:20:35. Total running time: 2min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_832de31a   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_6bbd4680   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_90a9f772   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            44.9257      0.682187    0.989899            0.98          0.985075 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3565872)[0m {'loss': 1.2945, 'grad_norm': 10.986433982849121, 'learning_rate': 0.0, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3565872)[0m {'train_runtime': 147.7292, 'train_samples_per_second': 23.59, 'train_steps_per_second': 0.271, 'train_loss': 1.5582908868789673, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3565872)[0m STATE at ending of training  :  TrainerState(epoch=4.914285714285715, global_step=40, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=861208196116080.0, log_history=[{'loss': 1.7645, 'grad_norm': 11.063955307006836, 'learning_rate': 3.6443132246884782e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 1.6856, 'grad_norm': 8.446898460388184, 'learning_rate': 2.7332349185163582e-06, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 1.6016, 'grad_norm': 5.006882667541504, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 1.4453, 'grad_norm': 8.81900691986084, 'learning_rate': 9.110783061721196e-07, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 1.2945, 'grad_norm': 10.986433982849121, 'learning_rate': 0.0, 'epoch': 4.914285714285715, 'step': 40}, {'train_runtime': 147.7292, 'train_samples_per_second': 23.59, 'train_steps_per_second': 0.271, 'total_flos': 861208196116080.0, 'train_loss': 1.5582908868789673, 'epoch': 4.914285714285715, 'step': 40}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3565872)[0m {'eval_loss': 2.7765986919403076, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.5554652810096741, 'eval_AP': 0.9926820569704629, 'eval_MCC': 0.0, 'eval_NDCG': 0.9986774333707245, 'eval_kappa': 0.0, 'eval_runtime': 4.0014, 'eval_samples_per_second': 16.744, 'eval_steps_per_second': 1.0, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3565872)[0m 2025-06-06 11:20:54,725 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3565872)[0m 2025-06-06 11:20:54,731 - INFO - eval_result: {'eval_loss': 2.7765986919403076, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.5554652810096741, 'eval_AP': 0.9926820569704629, 'eval_MCC': 0.0, 'eval_NDCG': 0.9986774333707245, 'eval_kappa': 0.0, 'eval_runtime': 4.0014, 'eval_samples_per_second': 16.744, 'eval_steps_per_second': 1.0, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3565872)[0m 2025-06-06 11:20:54,770 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB

Trial train_hpo_6bbd4680 finished iteration 1 at 2025-06-06 11:20:54. Total running time: 2min 49s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_6bbd4680 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                     155.82 â”‚
â”‚ time_total_s                         155.82 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               4.91429 â”‚
â”‚ eval_AP                             0.99268 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.99868 â”‚
â”‚ eval_accuracy                       0.74627 â”‚
â”‚ eval_f1                              0.8547 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                            2.7766 â”‚
â”‚ eval_optim_threshold                0.55547 â”‚
â”‚ eval_precision                      0.74627 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         4.0014 â”‚
â”‚ eval_samples_per_second              16.744 â”‚
â”‚ eval_steps_per_second                     1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:20:54,794 - INFO - Cleaning up trial 6bbd4680
2025-06-06 11:20:54,794 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-18-05/train_hpo_6bbd4680_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-06_11-18-12
2025-06-06 11:20:54,794 - INFO - Current best: 90a9f772 with eval_f1 : 0.98989898989899 at iteration 1

Trial train_hpo_6bbd4680 completed after 1 iterations at 2025-06-06 11:20:54. Total running time: 2min 49s
[36m(train_hpo pid=3565711)[0m STATE at ending of training  :  TrainerState(epoch=5.914285714285715, global_step=48, max_steps=48, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=1034469381524640.0, log_history=[{'loss': 1.725, 'grad_norm': 7.073610782623291, 'learning_rate': 1.246338876535363e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 1.7001, 'grad_norm': 8.092192649841309, 'learning_rate': 9.970711012282902e-07, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 1.7184, 'grad_norm': 5.243696689605713, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 1.7107, 'grad_norm': 2.9511055946350098, 'learning_rate': 4.985355506141451e-07, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 1.6865, 'grad_norm': 15.182605743408203, 'learning_rate': 2.4926777530707256e-07, 'epoch': 4.914285714285715, 'step': 40}, {'loss': 1.6524, 'grad_norm': 8.231986045837402, 'learning_rate': 0.0, 'epoch': 5.914285714285715, 'step': 48}, {'train_runtime': 161.0374, 'train_samples_per_second': 25.969, 'train_steps_per_second': 0.298, 'total_flos': 1034469381524640.0, 'train_loss': 1.6988444924354553, 'epoch': 5.914285714285715, 'step': 48}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3565711)[0m {'loss': 1.6524, 'grad_norm': 8.231986045837402, 'learning_rate': 0.0, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3565711)[0m {'train_runtime': 161.0374, 'train_samples_per_second': 25.969, 'train_steps_per_second': 0.298, 'train_loss': 1.6988444924354553, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3565711)[0m 2025-06-06 11:21:00,641 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3565711)[0m 2025-06-06 11:21:00,646 - INFO - eval_result: {'eval_loss': 3.5328736305236816, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.5932447910308838, 'eval_AP': 0.8677992573809864, 'eval_MCC': 0.0, 'eval_NDCG': 0.9573844622297731, 'eval_kappa': 0.0, 'eval_runtime': 3.4376, 'eval_samples_per_second': 19.491, 'eval_steps_per_second': 1.164, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3565711)[0m 2025-06-06 11:21:00,687 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3565711)[0m {'eval_loss': 3.5328736305236816, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.5932447910308838, 'eval_AP': 0.8677992573809864, 'eval_MCC': 0.0, 'eval_NDCG': 0.9573844622297731, 'eval_kappa': 0.0, 'eval_runtime': 3.4376, 'eval_samples_per_second': 19.491, 'eval_steps_per_second': 1.164, 'epoch': 5.914285714285715}

Trial train_hpo_832de31a finished iteration 1 at 2025-06-06 11:21:00. Total running time: 2min 55s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_832de31a result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    168.487 â”‚
â”‚ time_total_s                        168.487 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               5.91429 â”‚
â”‚ eval_AP                              0.8678 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.95738 â”‚
â”‚ eval_accuracy                       0.74627 â”‚
â”‚ eval_f1                              0.8547 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           3.53287 â”‚
â”‚ eval_optim_threshold                0.59324 â”‚
â”‚ eval_precision                      0.74627 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.4376 â”‚
â”‚ eval_samples_per_second              19.491 â”‚
â”‚ eval_steps_per_second                 1.164 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:21:00,711 - INFO - Cleaning up trial 832de31a
2025-06-06 11:21:00,711 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-18-05/train_hpo_832de31a_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-06_11-18-05
2025-06-06 11:21:00,711 - INFO - Cleaning up trial 6bbd4680
2025-06-06 11:21:00,711 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-18-05/train_hpo_6bbd4680_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-06_11-18-12
2025-06-06 11:21:00,712 - INFO - Current best: 90a9f772 with eval_f1 : 0.98989898989899 at iteration 1

Trial train_hpo_832de31a completed after 1 iterations at 2025-06-06 11:21:00. Total running time: 2min 55s
2025-06-06 11:21:00,719	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-18-05' in 0.0052s.

Trial status: 3 TERMINATED
Current time: 2025-06-06 11:21:00. Total running time: 2min 55s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_832de31a   TERMINATED        8.49369       1.49561e-06         0.13641                     6        1           168.487       3.53287     0.854701            1             0.746269 â”‚
â”‚ train_hpo_6bbd4680   TERMINATED        7.54953       4.55539e-06         0.123031                    5        1           155.82        2.7766      0.854701            1             0.746269 â”‚
â”‚ train_hpo_90a9f772   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            44.9257      0.682187    0.989899            0.98          0.985075 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

2025-06-06 11:21:00,726 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x700d4c27b010>
2025-06-06 11:21:00,726 - INFO - Best trial : train_hpo_90a9f772
2025-06-06 11:21:00,726 - INFO - Best config : {'pos_weight': 8.949837496427758, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-06 11:21:00,726 - INFO - Best trial after optimization: {'eval_loss': 0.6821871995925903, 'eval_f1': 0.98989898989899, 'eval_recall': 0.98, 'eval_accuracy': 0.9850746268656716, 'eval_precision': 1.0, 'eval_optim_threshold': 0.8313842415809631, 'eval_AP': 0.9953846153846154, 'eval_MCC': 0.9620579793107875, 'eval_NDCG': 0.9991588536744717, 'eval_kappa': 0.96133871898442, 'eval_runtime': 3.2943, 'eval_samples_per_second': 20.338, 'eval_steps_per_second': 1.214, 'epoch': 2.914285714285714, 'timestamp': 1749201550, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '90a9f772', 'date': '2025-06-06_11-19-10', 'time_this_iter_s': 44.925701379776, 'time_total_s': 44.925701379776, 'pid': 3566222, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 8.949837496427758, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 44.925701379776, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512'}
2025-06-06 11:21:00,746 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   3.532874  0.854701  ...                        6  832de31a
1   2.776599  0.854701  ...                        5  6bbd4680
2   0.682187  0.989899  ...                        3  90a9f772

[3 rows x 32 columns]
2025-06-06 11:21:00,933 - INFO - Trial comparison plot saved
2025-06-06 11:21:00,933 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-06 11:21:01,213 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-06 11:21:01,319 - INFO - training size : 697
2025-06-06 11:21:01,320 - INFO - dev size : 67
2025-06-06 11:21:01,320 - INFO - test size : 132
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
  0%|          | 0/90 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  1%|          | 1/90 [00:00<00:57,  1.54it/s]  2%|â–         | 2/90 [00:01<00:55,  1.58it/s]  3%|â–Ž         | 3/90 [00:01<00:54,  1.60it/s]  4%|â–         | 4/90 [00:02<00:53,  1.61it/s]  6%|â–Œ         | 5/90 [00:03<00:52,  1.61it/s]  7%|â–‹         | 6/90 [00:03<00:52,  1.61it/s]  8%|â–Š         | 7/90 [00:04<00:51,  1.61it/s]  9%|â–‰         | 8/90 [00:04<00:50,  1.61it/s] 10%|â–ˆ         | 9/90 [00:05<00:50,  1.61it/s] 11%|â–ˆ         | 10/90 [00:06<00:49,  1.61it/s] 12%|â–ˆâ–        | 11/90 [00:06<00:49,  1.60it/s] 13%|â–ˆâ–Ž        | 12/90 [00:07<00:48,  1.60it/s] 14%|â–ˆâ–        | 13/90 [00:08<00:47,  1.61it/s] 16%|â–ˆâ–Œ        | 14/90 [00:08<00:47,  1.61it/s] 17%|â–ˆâ–‹        | 15/90 [00:09<00:46,  1.61it/s] 18%|â–ˆâ–Š        | 16/90 [00:09<00:45,  1.61it/s] 19%|â–ˆâ–‰        | 17/90 [00:10<00:45,  1.61it/s] 20%|â–ˆâ–ˆ        | 18/90 [00:11<00:44,  1.61it/s] 21%|â–ˆâ–ˆ        | 19/90 [00:11<00:44,  1.61it/s] 22%|â–ˆâ–ˆâ–       | 20/90 [00:12<00:43,  1.61it/s] 23%|â–ˆâ–ˆâ–Ž       | 21/90 [00:13<00:42,  1.61it/s] 24%|â–ˆâ–ˆâ–       | 22/90 [00:13<00:42,  1.61it/s] 26%|â–ˆâ–ˆâ–Œ       | 23/90 [00:14<00:41,  1.61it/s] 27%|â–ˆâ–ˆâ–‹       | 24/90 [00:14<00:40,  1.61it/s] 28%|â–ˆâ–ˆâ–Š       | 25/90 [00:15<00:39,  1.63it/s] 29%|â–ˆâ–ˆâ–‰       | 26/90 [00:16<00:39,  1.62it/s] 30%|â–ˆâ–ˆâ–ˆ       | 27/90 [00:16<00:38,  1.62it/s] 31%|â–ˆâ–ˆâ–ˆ       | 28/90 [00:17<00:38,  1.62it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 29/90 [00:17<00:37,  1.63it/s]                                               {'loss': 0.6921, 'grad_norm': 0.38648495078086853, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 30/90 [00:18<00:36,  1.63it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 31/90 [00:18<00:29,  2.03it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 32/90 [00:19<00:30,  1.91it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 33/90 [00:19<00:31,  1.82it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 34/90 [00:20<00:32,  1.74it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 35/90 [00:21<00:32,  1.71it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 36/90 [00:21<00:32,  1.68it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 37/90 [00:22<00:31,  1.66it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 38/90 [00:23<00:31,  1.64it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 39/90 [00:23<00:30,  1.66it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 40/90 [00:24<00:30,  1.65it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 41/90 [00:24<00:29,  1.64it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 42/90 [00:25<00:29,  1.63it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 43/90 [00:26<00:28,  1.63it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 44/90 [00:26<00:28,  1.62it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 45/90 [00:27<00:27,  1.62it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 46/90 [00:27<00:27,  1.62it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 47/90 [00:28<00:26,  1.62it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 48/90 [00:29<00:25,  1.62it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 49/90 [00:29<00:25,  1.62it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 50/90 [00:30<00:24,  1.61it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 51/90 [00:31<00:24,  1.62it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 52/90 [00:31<00:23,  1.62it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 53/90 [00:32<00:22,  1.62it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 54/90 [00:32<00:22,  1.61it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 55/90 [00:33<00:21,  1.62it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 56/90 [00:34<00:21,  1.62it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 57/90 [00:34<00:20,  1.62it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 58/90 [00:35<00:19,  1.62it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 59/90 [00:35<00:19,  1.63it/s]                                               {'loss': 0.0046, 'grad_norm': 0.014187132008373737, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 60/90 [00:36<00:18,  1.63it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 61/90 [00:36<00:14,  2.05it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 62/90 [00:37<00:14,  1.92it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 63/90 [00:37<00:14,  1.83it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 64/90 [00:38<00:14,  1.77it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 65/90 [00:39<00:14,  1.72it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 66/90 [00:39<00:14,  1.69it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 67/90 [00:40<00:13,  1.67it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 68/90 [00:41<00:13,  1.65it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 69/90 [00:41<00:12,  1.65it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 70/90 [00:42<00:12,  1.66it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 71/90 [00:42<00:11,  1.65it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 72/90 [00:43<00:10,  1.64it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 73/90 [00:44<00:10,  1.63it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 74/90 [00:44<00:09,  1.62it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 75/90 [00:45<00:09,  1.62it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 76/90 [00:45<00:08,  1.62it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 77/90 [00:46<00:08,  1.62it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 78/90 [00:47<00:07,  1.62it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 79/90 [00:47<00:06,  1.62it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 80/90 [00:48<00:06,  1.62it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 81/90 [00:49<00:05,  1.62it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 82/90 [00:49<00:04,  1.62it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 83/90 [00:50<00:04,  1.62it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 84/90 [00:50<00:03,  1.62it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 85/90 [00:51<00:03,  1.62it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 86/90 [00:52<00:02,  1.62it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 87/90 [00:52<00:01,  1.62it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 88/90 [00:53<00:01,  1.62it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 89/90 [00:53<00:00,  1.63it/s]                                               {'loss': 0.0013, 'grad_norm': 0.009984788484871387, 'learning_rate': 0.0, 'epoch': 3.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.63it/s]                                               {'train_runtime': 56.7598, 'train_samples_per_second': 36.839, 'train_steps_per_second': 1.586, 'train_loss': 0.23266225229534837, 'epoch': 3.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.63it/s]2025-06-06 11:21:58,511 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.59it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.21it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.38it/s]2025-06-06 11:22:02,325 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.17s/it]
2025-06-06 11:22:02,331 - INFO - Training time : 61.397931582992896
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.10it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.00it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.35it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.10it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.31it/s]2025-06-06 11:22:06,919 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.40it/s]
2025-06-06 11:22:06,924 - INFO - Evaluation time : 4.593353177187964
2025-06-06 11:22:06,925 - INFO - Evaluation results on test set: {'eval_loss': 0.05953755974769592, 'eval_f1': 0.9948717948717949, 'eval_recall': 1.0, 'eval_accuracy': 0.9924242424242424, 'eval_precision': 0.9897959183673469, 'eval_optim_threshold': 0.9996218681335449, 'eval_AP': 1.0, 'eval_MCC': 0.9805692402810843, 'eval_NDCG': 1.0000000000000004, 'eval_kappa': 0.9803804994054697, 'eval_runtime': 4.5885, 'eval_samples_per_second': 28.767, 'eval_steps_per_second': 1.308, 'epoch': 3.0}
2025-06-06 11:22:06,925 - INFO - Total updates (optimizer steps): 90
2025-06-06 11:22:06,925 - INFO - Avg time / step: 0.631s
2025-06-06 11:22:07,744 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCEgoogle-bert/bert-base-uncased3trials_fold-3
2025-06-06 11:22:07,744 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.10it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.01it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.34it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.10it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.32it/s]2025-06-06 11:22:12,171 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.46it/s]
2025-06-06 11:22:12,176 - INFO - preds : [1 0 1 0 1 0 1 1 1 1 1 0 1 1 0 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 0 0 1 0 1
 1 1 1 1 1 0 1 1 0 0 1 1 0 1 1 1 1 1 1 1 1 0 1 0 1 1 0 1 1 1 1 1 1 1 1 1 1
 1 0 0 1 0 1 1 1 1 1 0 1 1 1 0 1 0 0 1 1 1 1 0 1 1 1 1 0 0 1 1 0 1 0 0 1 0
 1 1 1 1 1 1 1 1 0 1 1 1 1 1 0 1 0 1 0 1 1]
2025-06-06 11:22:12,176 - INFO - test_split["labels"] : [1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1]
2025-06-06 11:22:12,178 - INFO - Confusion matrix: TN=34, FP=1, FN=0, TP=97
2025-06-06 11:22:14,910 - INFO - Metrics: {'f1': 0.9948717948717949, 'recall': 1.0, 'precision': 0.9897959183673469, 'accuracy': 0.9924242424242424, 'AP': 1.0, 'MCC': 0.9805692402810843, 'NDCG': 1.0000000000000004, 'kappa': 0.9803804994054697, 'TN': 34, 'FP': 1, 'FN': 0, 'TP': 97}
2025-06-06 11:22:15,034 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-06 11:22:15,132 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 11:22:15,132 - INFO - 
On test Set (optimal threshold of 0.9995852112770081 according to cross validation on the training set): 
2025-06-06 11:22:15,134 - INFO - Confusion matrix: TN=35, FP=0, FN=0, TP=97
2025-06-06 11:22:17,898 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 35, 'FP': 0, 'FN': 0, 'TP': 97}
2025-06-06 11:22:17,992 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 11:22:17,992 - INFO - Results for fold 3 : [{'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 35, 'FP': 0, 'FN': 0, 'TP': 97}]
2025-06-06 11:22:18,119 - INFO - Cleared CUDA cache. Memory allocated: 1.43 GB, Memory reserved: 1.77 GB
2025-06-06 11:22:18,119 - INFO - Cleared CUDA cache. Memory allocated: 1.43 GB, Memory reserved: 1.77 GB
2025-06-06 11:22:18,133 - INFO - Cleared CUDA cache. Memory allocated: 0.98 GB, Memory reserved: 1.67 GB
2025-06-06 11:22:18,145 - INFO - Metrics for google-bert/bert-base-uncased:                       model_name fold loss_type run  ...    TN   FP   FN    TP
0  google-bert/bert-base-uncased    1       BCE   1  ...  35.0  0.0  0.0  98.0
0  google-bert/bert-base-uncased    2       BCE   1  ...  34.0  0.0  0.0  98.0
0  google-bert/bert-base-uncased    3       BCE   1  ...  34.0  1.0  0.0  97.0

[3 rows x 18 columns]
2025-06-06 11:22:18,145 - INFO - 
fold number 1 / 3
2025-06-06 11:22:18,150 - INFO - Confusion matrix: TN=35, FP=0, FN=0, TP=98
2025-06-06 11:22:20,901 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 35, 'FP': 0, 'FN': 0, 'TP': 98}
2025-06-06 11:22:20,902 - INFO - 
fold number 2 / 3
2025-06-06 11:22:20,906 - INFO - Confusion matrix: TN=34, FP=0, FN=0, TP=98
2025-06-06 11:22:23,743 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 34, 'FP': 0, 'FN': 0, 'TP': 98}
2025-06-06 11:22:23,744 - INFO - 
fold number 3 / 3
2025-06-06 11:22:23,748 - INFO - Confusion matrix: TN=34, FP=1, FN=0, TP=97
2025-06-06 11:22:26,548 - INFO - Metrics: {'f1': 0.9948717948717949, 'recall': 1.0, 'precision': 0.9897959183673469, 'accuracy': 0.9924242424242424, 'AP': 0.9999999999999999, 'MCC': 0.9805692402810843, 'NDCG': 1.0000000000000004, 'kappa': 0.9803804994054697, 'TN': 34, 'FP': 1, 'FN': 0, 'TP': 97}
2025-06-06 11:22:26,554 - INFO - fold indexes for run no.2: [[284, 266, 388, 393, 133, 13, 20, 176, 269, 308, 45, 193, 147, 19, 168, 230, 151, 384, 157, 153, 149, 327, 321, 381, 385, 330, 199, 72, 142, 10, 47, 270, 377, 73, 0, 118, 184, 65, 343, 219, 86, 357, 201, 226, 264, 223, 33, 114, 67, 268, 182, 310, 53, 246, 145, 76, 320, 373, 280, 95, 254, 113, 154, 160, 228, 306, 325, 99, 355, 356, 125, 166, 346, 286, 102, 354, 92, 336, 81, 159, 52, 304, 323, 111, 96, 274, 236, 41, 91, 32, 90, 367, 179, 130, 74, 334, 378, 208, 77, 396, 361, 6, 332, 238, 222, 277, 365, 36, 256, 21, 260, 38, 234, 341, 173, 124, 183, 31, 202, 203, 196, 119, 150, 263, 105, 126, 48, 143, 289, 231, 324, 352, 186, 155, 292, 217, 198, 316, 109, 287, 44, 49, 82, 15, 309, 83, 135, 218, 305, 283, 122, 127, 290, 35, 85, 98, 271, 141, 167, 295, 93, 27, 262, 229, 273, 9, 370, 89, 129, 197, 164, 205, 347, 171, 178, 70, 140, 372, 100, 314, 69, 4, 301, 265, 244, 101, 248, 358, 364, 94, 296, 87, 307, 239, 192, 50, 169, 39, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 532, 533, 534, 535, 536, 537, 538, 539, 540, 541, 542, 543, 544, 545, 546, 547, 548, 549, 550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 560, 561, 562, 563, 564, 565, 566, 567, 568, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582, 583, 584, 585, 586, 587, 588, 589, 590, 591, 592, 593, 594, 595, 596, 597, 598, 599, 600, 601, 602, 603, 604, 605, 606, 607, 608, 609, 610, 611, 612, 613, 614, 615, 616, 617, 618, 619, 620, 621, 622, 623, 624, 625, 626, 627, 628, 629, 630, 631, 632, 633, 634, 635, 636, 637, 638, 639, 640, 641, 642, 643, 644, 645, 646, 647, 648, 649, 650, 651, 652, 653, 654, 655, 656, 657, 658, 659, 660, 661, 662, 663, 664, 665, 666, 667, 668, 669, 670, 671, 672, 673, 674, 675, 676, 677, 678, 679, 680, 681, 682, 683, 684, 685, 686, 687, 688, 689, 690, 691, 692, 693, 694, 695, 696, 697, 698, 699, 700, 701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 714, 715, 716, 717, 718, 719, 720, 721, 722, 723, 724, 725, 726, 727, 728, 729, 730, 731, 732, 733, 734, 735, 736, 737, 738, 739, 740, 741, 742, 743, 744, 745, 746, 747, 748, 749, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764, 765, 766, 767, 768, 769, 770, 771, 772, 773, 774, 775, 776, 777, 778, 779, 780, 781, 782, 783, 784, 785, 786, 787, 788, 789, 790, 791, 792, 793, 794, 795, 796, 797, 798, 799, 800, 801, 802, 803, 804, 805, 806, 807, 808, 809, 810, 811, 812, 813, 814, 815, 816, 817, 818, 819, 820, 821, 822, 823, 824, 825, 826, 827, 828, 829, 830, 831, 832, 833, 834, 835, 836, 837, 838, 839, 840, 841, 842, 843, 844, 845, 846, 847, 848, 849, 850, 851, 852, 853, 854, 855, 856, 857, 858, 859, 860, 861, 862, 863, 864, 865, 866, 867, 868, 869, 870, 871, 872, 873, 874, 875, 876, 877, 878, 879, 880, 881, 882, 883, 884, 885, 886, 887, 888, 889, 890, 891, 892, 893, 894, 895], [326, 210, 250, 319, 380, 279, 293, 288, 220, 253, 162, 43, 152, 8, 221, 235, 297, 339, 331, 61, 106, 181, 329, 243, 375, 88, 257, 194, 117, 104, 55, 349, 14, 108, 62, 281, 282, 2, 63, 240, 351, 107, 97, 187, 215, 54, 80, 232, 318, 241, 303, 252, 29, 139, 247, 362, 51, 390, 285, 392, 174, 298, 5, 335, 294, 28], array([  1,   3,   7,  11,  12,  16,  17,  18,  22,  23,  24,  25,  26,
        30,  34,  37,  40,  42,  46,  56,  57,  58,  59,  60,  64,  66,
        68,  71,  75,  78,  79,  84, 103, 110, 112, 115, 116, 120, 121,
       123, 128, 131, 132, 134, 136, 137, 138, 144, 146, 148, 156, 158,
       161, 163, 165, 170, 172, 175, 177, 180, 185, 188, 189, 190, 191,
       195, 200, 204, 206, 207, 209, 211, 212, 213, 214, 216, 224, 225,
       227, 233, 237, 242, 245, 249, 251, 255, 258, 259, 261, 267, 272,
       275, 276, 278, 291, 299, 300, 302, 311, 312, 313, 315, 317, 322,
       328, 333, 337, 338, 340, 342, 344, 345, 348, 350, 353, 359, 360,
       363, 366, 368, 369, 371, 374, 376, 379, 382, 383, 386, 387, 389,
       391, 394, 395])]
2025-06-06 11:22:26,554 - INFO - Run no 2/2
2025-06-06 11:22:26,555 - INFO - Loss Type : BCE
2025-06-06 11:22:26,555 - INFO - Ensemble learning pipeline
2025-06-06 11:22:26,555 - INFO - Training model 1/2: dmis-lab/biobert-v1.1
2025-06-06 11:22:26,723 - INFO - 
fold number 1 / 3
2025-06-06 11:22:26,730 - INFO - train split size : 697
2025-06-06 11:22:26,730 - INFO - dev split size : 66
2025-06-06 11:22:26,730 - INFO - test split size : 133
Map (num_proc=32):   0%|          | 0/697 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 22/697 [00:00<00:06, 98.85 examples/s]Map (num_proc=32):  19%|â–ˆâ–‰        | 132/697 [00:00<00:01, 420.04 examples/s]Map (num_proc=32):  28%|â–ˆâ–ˆâ–Š       | 198/697 [00:00<00:01, 475.28 examples/s]Map (num_proc=32):  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 330/697 [00:00<00:00, 733.70 examples/s]Map (num_proc=32):  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 418/697 [00:00<00:00, 776.11 examples/s]Map (num_proc=32):  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 506/697 [00:00<00:00, 761.43 examples/s]Map (num_proc=32):  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 592/697 [00:00<00:00, 777.63 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 676/697 [00:01<00:00, 795.18 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 697/697 [00:01<00:00, 598.56 examples/s]
Map (num_proc=32):   0%|          | 0/66 [00:00<?, ? examples/s]Map (num_proc=32):   5%|â–         | 3/66 [00:00<00:03, 17.26 examples/s]Map (num_proc=32):  18%|â–ˆâ–Š        | 12/66 [00:00<00:01, 48.78 examples/s]Map (num_proc=32):  30%|â–ˆâ–ˆâ–ˆ       | 20/66 [00:00<00:00, 58.89 examples/s]Map (num_proc=32):  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 28/66 [00:00<00:00, 64.00 examples/s]Map (num_proc=32):  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 36/66 [00:00<00:00, 67.73 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 44/66 [00:00<00:00, 69.63 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 52/66 [00:00<00:00, 67.36 examples/s]Map (num_proc=32):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 62/66 [00:00<00:00, 72.98 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 66/66 [00:01<00:00, 59.05 examples/s]
Map (num_proc=32):   0%|          | 0/133 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/133 [00:00<00:04, 26.91 examples/s]Map (num_proc=32):  19%|â–ˆâ–‰        | 25/133 [00:00<00:01, 92.86 examples/s]Map (num_proc=32):  31%|â–ˆâ–ˆâ–ˆ       | 41/133 [00:00<00:00, 116.34 examples/s]Map (num_proc=32):  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 57/133 [00:00<00:00, 128.42 examples/s]Map (num_proc=32):  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 73/133 [00:00<00:00, 136.23 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 89/133 [00:00<00:00, 140.61 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 105/133 [00:00<00:00, 142.00 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 121/133 [00:00<00:00, 140.02 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 133/133 [00:01<00:00, 116.20 examples/s]
2025-06-06 11:22:35,891 - INFO - 3 datasets tokenized successfully
2025-06-06 11:22:35,892 - INFO - Starting hyperparameter search for BCE loss
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-06_11-22-35   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-22-35
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-06_10-55-47_424551_3536632/artifacts/2025-06-06_11-22-35/train_hpo_2025-06-06_11-22-35/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-06 11:22:36. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_49b64b10   PENDING         8.49369       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_49b64b10 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_49b64b10 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          8.49369 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3570889)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3570889)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3570889)[0m 2025-06-06 11:22:43,654 - INFO - pos_weight value in TrainingArguments : 8.493688290834637
[36m(train_hpo pid=3570889)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3570889)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3570889)[0m [2025-06-06 11:22:43,891] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3570889)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=48, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3570889)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3570889)[0m   warnings.warn(

Trial train_hpo_c2d0c154 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_c2d0c154 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          7.54953 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3571050)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3571050)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3571050)[0m 2025-06-06 11:22:50,515 - INFO - pos_weight value in TrainingArguments : 7.549531688595925
[36m(train_hpo pid=3571050)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3571050)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3571050)[0m [2025-06-06 11:22:50,826] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3571050)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3571050)[0m   warnings.warn(
[36m(train_hpo pid=3571050)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_04b12ae6 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_04b12ae6 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          8.94984 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3571331)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3571331)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3571331)[0m 2025-06-06 11:22:57,271 - INFO - pos_weight value in TrainingArguments : 8.949837496427758
[36m(train_hpo pid=3571331)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3571331)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3571331)[0m [2025-06-06 11:22:57,496] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3571331)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=24, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3571331)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3571331)[0m   warnings.warn(

Trial status: 3 RUNNING
Current time: 2025-06-06 11:23:06. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_49b64b10   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_c2d0c154   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_04b12ae6   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3570889)[0m {'loss': 1.7435, 'grad_norm': 2.7275290489196777, 'learning_rate': 1.246338876535363e-06, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3571331)[0m {'loss': 1.2261, 'grad_norm': 4.392622947692871, 'learning_rate': 5.325452975187489e-05, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3571050)[0m {'loss': 1.583, 'grad_norm': 1.5210049152374268, 'learning_rate': 3.6443132246884782e-06, 'epoch': 0.9142857142857143}
Trial status: 3 RUNNING
Current time: 2025-06-06 11:23:36. Total running time: 1min 0s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_49b64b10   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_c2d0c154   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_04b12ae6   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3570889)[0m {'loss': 1.7196, 'grad_norm': 7.44398307800293, 'learning_rate': 9.970711012282902e-07, 'epoch': 1.9142857142857141}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3571331)[0m {'train_runtime': 38.0058, 'train_samples_per_second': 55.018, 'train_steps_per_second': 0.631, 'train_loss': 0.5644302293658257, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3571331)[0m STATE at ending of training  :  TrainerState(epoch=2.914285714285714, global_step=24, max_steps=24, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=515364152398080.0, log_history=[{'loss': 1.2261, 'grad_norm': 4.392622947692871, 'learning_rate': 5.325452975187489e-05, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.3437, 'grad_norm': 3.325561046600342, 'learning_rate': 2.6627264875937445e-05, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 0.1234, 'grad_norm': 1.6090031862258911, 'learning_rate': 0.0, 'epoch': 2.914285714285714, 'step': 24}, {'train_runtime': 38.0058, 'train_samples_per_second': 55.018, 'train_steps_per_second': 0.631, 'total_flos': 515364152398080.0, 'train_loss': 0.5644302293658257, 'epoch': 2.914285714285714, 'step': 24}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3571331)[0m {'eval_loss': 0.14550206065177917, 'eval_f1': 0.98989898989899, 'eval_recall': 1.0, 'eval_accuracy': 0.9848484848484849, 'eval_precision': 0.98, 'eval_optim_threshold': 0.97798091173172, 'eval_AP': 1.0, 'eval_MCC': 0.9603920767980495, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 0.9596083231334149, 'eval_runtime': 3.3006, 'eval_samples_per_second': 19.996, 'eval_steps_per_second': 1.212, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3571331)[0m 2025-06-06 11:23:42,022 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3571331)[0m 2025-06-06 11:23:42,028 - INFO - eval_result: {'eval_loss': 0.14550206065177917, 'eval_f1': 0.98989898989899, 'eval_recall': 1.0, 'eval_accuracy': 0.9848484848484849, 'eval_precision': 0.98, 'eval_optim_threshold': 0.97798091173172, 'eval_AP': 1.0, 'eval_MCC': 0.9603920767980495, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 0.9596083231334149, 'eval_runtime': 3.3006, 'eval_samples_per_second': 19.996, 'eval_steps_per_second': 1.212, 'epoch': 2.914285714285714}

Trial train_hpo_04b12ae6 finished iteration 1 at 2025-06-06 11:23:42. Total running time: 1min 6s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_04b12ae6 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    45.6688 â”‚
â”‚ time_total_s                        45.6688 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               2.91429 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                            0.96039 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                       0.98485 â”‚
â”‚ eval_f1                              0.9899 â”‚
â”‚ eval_kappa                          0.95961 â”‚
â”‚ eval_loss                            0.1455 â”‚
â”‚ eval_optim_threshold                0.97798 â”‚
â”‚ eval_precision                         0.98 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.3006 â”‚
â”‚ eval_samples_per_second              19.996 â”‚
â”‚ eval_steps_per_second                 1.212 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:23:42,085 - INFO - Cleaning up trial 04b12ae6
2025-06-06 11:23:42,085 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-22-35/train_hpo_04b12ae6_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512_2025-06-06_11-22-49

Trial train_hpo_04b12ae6 completed after 1 iterations at 2025-06-06 11:23:42. Total running time: 1min 6s
[36m(train_hpo pid=3571331)[0m 2025-06-06 11:23:42,060 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3571050)[0m {'loss': 1.5257, 'grad_norm': 4.222116947174072, 'learning_rate': 2.7332349185163582e-06, 'epoch': 1.9142857142857141}[32m [repeated 2x across cluster][0m

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:24:06. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_49b64b10   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_c2d0c154   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_04b12ae6   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.6688      0.145502    0.989899               1          0.984848 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3570889)[0m {'loss': 1.6632, 'grad_norm': 3.499873399734497, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3571050)[0m {'loss': 1.4534, 'grad_norm': 2.146214485168457, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.914285714285714}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:24:36. Total running time: 2min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_49b64b10   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_c2d0c154   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_04b12ae6   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.6688      0.145502    0.989899               1          0.984848 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3570889)[0m {'loss': 1.648, 'grad_norm': 4.360960960388184, 'learning_rate': 4.985355506141451e-07, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3571050)[0m {'loss': 1.4109, 'grad_norm': 2.619021415710449, 'learning_rate': 9.110783061721196e-07, 'epoch': 3.914285714285714}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:25:06. Total running time: 2min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_49b64b10   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_c2d0c154   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_04b12ae6   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.6688      0.145502    0.989899               1          0.984848 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3570889)[0m {'loss': 1.5915, 'grad_norm': 9.359049797058105, 'learning_rate': 2.4926777530707256e-07, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3571050)[0m {'loss': 1.32, 'grad_norm': 5.839612007141113, 'learning_rate': 0.0, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3571050)[0m {'train_runtime': 147.596, 'train_samples_per_second': 23.612, 'train_steps_per_second': 0.271, 'train_loss': 1.4586039543151856, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3571050)[0m STATE at ending of training  :  TrainerState(epoch=4.914285714285715, global_step=40, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=862564850314320.0, log_history=[{'loss': 1.583, 'grad_norm': 1.5210049152374268, 'learning_rate': 3.6443132246884782e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 1.5257, 'grad_norm': 4.222116947174072, 'learning_rate': 2.7332349185163582e-06, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 1.4534, 'grad_norm': 2.146214485168457, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 1.4109, 'grad_norm': 2.619021415710449, 'learning_rate': 9.110783061721196e-07, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 1.32, 'grad_norm': 5.839612007141113, 'learning_rate': 0.0, 'epoch': 4.914285714285715, 'step': 40}, {'train_runtime': 147.596, 'train_samples_per_second': 23.612, 'train_steps_per_second': 0.271, 'total_flos': 862564850314320.0, 'train_loss': 1.4586039543151856, 'epoch': 4.914285714285715, 'step': 40}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3571050)[0m 2025-06-06 11:25:25,583 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3571050)[0m 2025-06-06 11:25:25,590 - INFO - eval_result: {'eval_loss': 2.3173677921295166, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.6573975086212158, 'eval_AP': 0.9939270253555967, 'eval_MCC': 0.0, 'eval_NDCG': 0.9988880880490574, 'eval_kappa': 0.0, 'eval_runtime': 3.8879, 'eval_samples_per_second': 16.976, 'eval_steps_per_second': 1.029, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3571050)[0m {'eval_loss': 2.3173677921295166, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.6573975086212158, 'eval_AP': 0.9939270253555967, 'eval_MCC': 0.0, 'eval_NDCG': 0.9988880880490574, 'eval_kappa': 0.0, 'eval_runtime': 3.8879, 'eval_samples_per_second': 16.976, 'eval_steps_per_second': 1.029, 'epoch': 4.914285714285715}

Trial train_hpo_c2d0c154 finished iteration 1 at 2025-06-06 11:25:25. Total running time: 2min 49s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_c2d0c154 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    156.043 â”‚
â”‚ time_total_s                        156.043 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               4.91429 â”‚
â”‚ eval_AP                             0.99393 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.99889 â”‚
â”‚ eval_accuracy                       0.74242 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           2.31737 â”‚
â”‚ eval_optim_threshold                 0.6574 â”‚
â”‚ eval_precision                      0.74242 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.8879 â”‚
â”‚ eval_samples_per_second              16.976 â”‚
â”‚ eval_steps_per_second                 1.029 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:25:25,651 - INFO - Cleaning up trial c2d0c154
2025-06-06 11:25:25,651 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-22-35/train_hpo_c2d0c154_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-06_11-22-42
2025-06-06 11:25:25,651 - INFO - Current best: 04b12ae6 with eval_f1 : 0.98989898989899 at iteration 1

Trial train_hpo_c2d0c154 completed after 1 iterations at 2025-06-06 11:25:25. Total running time: 2min 49s
[36m(train_hpo pid=3571050)[0m 2025-06-06 11:25:25,628 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3570889)[0m STATE at ending of training  :  TrainerState(epoch=5.914285714285715, global_step=48, max_steps=48, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=1036216587689040.0, log_history=[{'loss': 1.7435, 'grad_norm': 2.7275290489196777, 'learning_rate': 1.246338876535363e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 1.7196, 'grad_norm': 7.44398307800293, 'learning_rate': 9.970711012282902e-07, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 1.6632, 'grad_norm': 3.499873399734497, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 1.648, 'grad_norm': 4.360960960388184, 'learning_rate': 4.985355506141451e-07, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 1.5915, 'grad_norm': 9.359049797058105, 'learning_rate': 2.4926777530707256e-07, 'epoch': 4.914285714285715, 'step': 40}, {'loss': 1.5777, 'grad_norm': 6.166182518005371, 'learning_rate': 0.0, 'epoch': 5.914285714285715, 'step': 48}, {'train_runtime': 161.1856, 'train_samples_per_second': 25.945, 'train_steps_per_second': 0.298, 'total_flos': 1036216587689040.0, 'train_loss': 1.6572605570157368, 'epoch': 5.914285714285715, 'step': 48}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3570889)[0m {'loss': 1.5777, 'grad_norm': 6.166182518005371, 'learning_rate': 0.0, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3570889)[0m {'train_runtime': 161.1856, 'train_samples_per_second': 25.945, 'train_steps_per_second': 0.298, 'train_loss': 1.6572605570157368, 'epoch': 5.914285714285715}

Trial train_hpo_49b64b10 finished iteration 1 at 2025-06-06 11:25:31. Total running time: 2min 55s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_49b64b10 result              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                          â”‚
â”‚ time_this_iter_s                     169.058 â”‚
â”‚ time_total_s                         169.058 â”‚
â”‚ training_iteration                         1 â”‚
â”‚ epoch                                5.91429 â”‚
â”‚ eval_AP                              0.97275 â”‚
â”‚ eval_MCC                            -0.07306 â”‚
â”‚ eval_NDCG                            0.99484 â”‚
â”‚ eval_accuracy                        0.72727 â”‚
â”‚ eval_f1                              0.84211 â”‚
â”‚ eval_kappa                          -0.02946 â”‚
â”‚ eval_loss                            3.24562 â”‚
â”‚ eval_optim_threshold                 0.59972 â”‚
â”‚ eval_precision                       0.73846 â”‚
â”‚ eval_recall                          0.97959 â”‚
â”‚ eval_runtime                          3.3415 â”‚
â”‚ eval_samples_per_second               19.751 â”‚
â”‚ eval_steps_per_second                  1.197 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:25:31,815 - INFO - Cleaning up trial 49b64b10
2025-06-06 11:25:31,815 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-22-35/train_hpo_49b64b10_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-06_11-22-35
2025-06-06 11:25:31,815 - INFO - Cleaning up trial c2d0c154
2025-06-06 11:25:31,815 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-22-35/train_hpo_c2d0c154_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-06_11-22-42
2025-06-06 11:25:31,815 - INFO - Current best: 04b12ae6 with eval_f1 : 0.98989898989899 at iteration 1

Trial train_hpo_49b64b10 completed after 1 iterations at 2025-06-06 11:25:31. Total running time: 2min 55s
[36m(train_hpo pid=3570889)[0m {'eval_loss': 3.245619773864746, 'eval_f1': 0.8421052631578947, 'eval_recall': 0.9795918367346939, 'eval_accuracy': 0.7272727272727273, 'eval_precision': 0.7384615384615385, 'eval_optim_threshold': 0.599724292755127, 'eval_AP': 0.9727468681694684, 'eval_MCC': -0.07305833027953698, 'eval_NDCG': 0.9948386427601935, 'eval_kappa': -0.029462738301559765, 'eval_runtime': 3.3415, 'eval_samples_per_second': 19.751, 'eval_steps_per_second': 1.197, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3570889)[0m 2025-06-06 11:25:31,750 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3570889)[0m 2025-06-06 11:25:31,755 - INFO - eval_result: {'eval_loss': 3.245619773864746, 'eval_f1': 0.8421052631578947, 'eval_recall': 0.9795918367346939, 'eval_accuracy': 0.7272727272727273, 'eval_precision': 0.7384615384615385, 'eval_optim_threshold': 0.599724292755127, 'eval_AP': 0.9727468681694684, 'eval_MCC': -0.07305833027953698, 'eval_NDCG': 0.9948386427601935, 'eval_kappa': -0.029462738301559765, 'eval_runtime': 3.3415, 'eval_samples_per_second': 19.751, 'eval_steps_per_second': 1.197, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3570889)[0m 2025-06-06 11:25:31,793 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
2025-06-06 11:25:31,822	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-22-35' in 0.0054s.

Trial status: 3 TERMINATED
Current time: 2025-06-06 11:25:31. Total running time: 2min 55s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_49b64b10   TERMINATED        8.49369       1.49561e-06         0.13641                     6        1           169.058       3.24562     0.842105        0.979592          0.727273 â”‚
â”‚ train_hpo_c2d0c154   TERMINATED        7.54953       4.55539e-06         0.123031                    5        1           156.043       2.31737     0.852174        1                 0.742424 â”‚
â”‚ train_hpo_04b12ae6   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.6688      0.145502    0.989899        1                 0.984848 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

2025-06-06 11:25:31,829 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x700dcf2baf90>
2025-06-06 11:25:31,829 - INFO - Best trial : train_hpo_04b12ae6
2025-06-06 11:25:31,829 - INFO - Best config : {'pos_weight': 8.949837496427758, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-06 11:25:31,829 - INFO - Best trial after optimization: {'eval_loss': 0.14550206065177917, 'eval_f1': 0.98989898989899, 'eval_recall': 1.0, 'eval_accuracy': 0.9848484848484849, 'eval_precision': 0.98, 'eval_optim_threshold': 0.97798091173172, 'eval_AP': 1.0, 'eval_MCC': 0.9603920767980495, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 0.9596083231334149, 'eval_runtime': 3.3006, 'eval_samples_per_second': 19.996, 'eval_steps_per_second': 1.212, 'epoch': 2.914285714285714, 'timestamp': 1749201822, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '04b12ae6', 'date': '2025-06-06_11-23-42', 'time_this_iter_s': 45.668781995773315, 'time_total_s': 45.668781995773315, 'pid': 3571331, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 8.949837496427758, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 45.668781995773315, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512'}
2025-06-06 11:25:31,850 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   3.245620  0.842105  ...                        6  49b64b10
1   2.317368  0.852174  ...                        5  c2d0c154
2   0.145502  0.989899  ...                        3  04b12ae6

[3 rows x 32 columns]
2025-06-06 11:25:32,061 - INFO - Trial comparison plot saved
2025-06-06 11:25:32,062 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-06 11:25:32,655 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-06 11:25:32,734 - INFO - training size : 697
2025-06-06 11:25:32,735 - INFO - dev size : 66
2025-06-06 11:25:32,735 - INFO - test size : 133
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
  0%|          | 0/90 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  1%|          | 1/90 [00:00<00:57,  1.55it/s]  2%|â–         | 2/90 [00:01<00:55,  1.59it/s]  3%|â–Ž         | 3/90 [00:01<00:54,  1.60it/s]  4%|â–         | 4/90 [00:02<00:53,  1.61it/s]  6%|â–Œ         | 5/90 [00:03<00:52,  1.62it/s]  7%|â–‹         | 6/90 [00:03<00:51,  1.62it/s]  8%|â–Š         | 7/90 [00:04<00:51,  1.62it/s]  9%|â–‰         | 8/90 [00:04<00:50,  1.62it/s] 10%|â–ˆ         | 9/90 [00:05<00:50,  1.62it/s] 11%|â–ˆ         | 10/90 [00:06<00:49,  1.62it/s] 12%|â–ˆâ–        | 11/90 [00:06<00:48,  1.62it/s] 13%|â–ˆâ–Ž        | 12/90 [00:07<00:48,  1.62it/s] 14%|â–ˆâ–        | 13/90 [00:08<00:47,  1.62it/s] 16%|â–ˆâ–Œ        | 14/90 [00:08<00:46,  1.62it/s] 17%|â–ˆâ–‹        | 15/90 [00:09<00:46,  1.62it/s] 18%|â–ˆâ–Š        | 16/90 [00:09<00:45,  1.62it/s] 19%|â–ˆâ–‰        | 17/90 [00:10<00:45,  1.62it/s] 20%|â–ˆâ–ˆ        | 18/90 [00:11<00:44,  1.62it/s] 21%|â–ˆâ–ˆ        | 19/90 [00:11<00:43,  1.62it/s] 22%|â–ˆâ–ˆâ–       | 20/90 [00:12<00:43,  1.62it/s] 23%|â–ˆâ–ˆâ–Ž       | 21/90 [00:12<00:42,  1.62it/s] 24%|â–ˆâ–ˆâ–       | 22/90 [00:13<00:41,  1.62it/s] 26%|â–ˆâ–ˆâ–Œ       | 23/90 [00:14<00:41,  1.62it/s] 27%|â–ˆâ–ˆâ–‹       | 24/90 [00:14<00:40,  1.62it/s] 28%|â–ˆâ–ˆâ–Š       | 25/90 [00:15<00:40,  1.62it/s] 29%|â–ˆâ–ˆâ–‰       | 26/90 [00:16<00:39,  1.62it/s] 30%|â–ˆâ–ˆâ–ˆ       | 27/90 [00:16<00:38,  1.62it/s] 31%|â–ˆâ–ˆâ–ˆ       | 28/90 [00:17<00:38,  1.62it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 29/90 [00:17<00:37,  1.64it/s]                                               {'loss': 0.3677, 'grad_norm': 0.2303730547428131, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 30/90 [00:17<00:36,  1.64it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 31/90 [00:18<00:28,  2.04it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 32/90 [00:19<00:30,  1.92it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 33/90 [00:19<00:31,  1.83it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 34/90 [00:20<00:31,  1.77it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 35/90 [00:21<00:31,  1.72it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 36/90 [00:21<00:31,  1.69it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 37/90 [00:22<00:31,  1.67it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 38/90 [00:22<00:31,  1.66it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 39/90 [00:23<00:30,  1.65it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 40/90 [00:24<00:30,  1.64it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 41/90 [00:24<00:29,  1.64it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 42/90 [00:25<00:29,  1.63it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 43/90 [00:25<00:28,  1.63it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 44/90 [00:26<00:28,  1.63it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 45/90 [00:27<00:27,  1.63it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 46/90 [00:27<00:27,  1.63it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 47/90 [00:28<00:26,  1.63it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 48/90 [00:29<00:25,  1.63it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 49/90 [00:29<00:25,  1.63it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 50/90 [00:30<00:24,  1.62it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 51/90 [00:30<00:24,  1.62it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 52/90 [00:31<00:23,  1.62it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 53/90 [00:32<00:22,  1.62it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 54/90 [00:32<00:22,  1.62it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 55/90 [00:33<00:21,  1.62it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 56/90 [00:33<00:20,  1.62it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 57/90 [00:34<00:20,  1.62it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 58/90 [00:35<00:19,  1.62it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 59/90 [00:35<00:18,  1.64it/s]                                               {'loss': 0.0268, 'grad_norm': 0.012086455710232258, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 60/90 [00:35<00:18,  1.64it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 61/90 [00:36<00:14,  2.06it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 62/90 [00:37<00:14,  1.93it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 63/90 [00:37<00:14,  1.84it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 64/90 [00:38<00:14,  1.78it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 65/90 [00:38<00:14,  1.73it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 66/90 [00:39<00:14,  1.70it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 67/90 [00:40<00:13,  1.68it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 68/90 [00:40<00:13,  1.66it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 69/90 [00:41<00:12,  1.65it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 70/90 [00:42<00:12,  1.64it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 71/90 [00:42<00:11,  1.63it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 72/90 [00:43<00:11,  1.63it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 73/90 [00:43<00:10,  1.63it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 74/90 [00:44<00:09,  1.63it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 75/90 [00:45<00:09,  1.62it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 76/90 [00:45<00:08,  1.62it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 77/90 [00:46<00:08,  1.62it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 78/90 [00:46<00:07,  1.62it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 79/90 [00:47<00:06,  1.62it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 80/90 [00:48<00:06,  1.62it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 81/90 [00:48<00:05,  1.62it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 82/90 [00:49<00:04,  1.62it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 83/90 [00:50<00:04,  1.62it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 84/90 [00:50<00:03,  1.62it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 85/90 [00:51<00:03,  1.62it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 86/90 [00:51<00:02,  1.62it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 87/90 [00:52<00:01,  1.62it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 88/90 [00:53<00:01,  1.62it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 89/90 [00:53<00:00,  1.64it/s]                                               {'loss': 0.0014, 'grad_norm': 0.05095168948173523, 'learning_rate': 0.0, 'epoch': 3.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.64it/s]                                               {'train_runtime': 56.0075, 'train_samples_per_second': 37.334, 'train_steps_per_second': 1.607, 'train_loss': 0.13198870047926903, 'epoch': 3.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.64it/s]2025-06-06 11:26:29,185 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.61it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.32it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.66it/s]2025-06-06 11:26:32,894 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.14s/it]
2025-06-06 11:26:32,900 - INFO - Training time : 60.837929183850065
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.17it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.05it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.37it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.12it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.27it/s]2025-06-06 11:26:37,705 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.33it/s]
2025-06-06 11:26:37,710 - INFO - Evaluation time : 4.810365800978616
2025-06-06 11:26:37,710 - INFO - Evaluation results on test set: {'eval_loss': 0.0015789049211889505, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9991738200187683, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000004, 'eval_kappa': 1.0, 'eval_runtime': 4.8059, 'eval_samples_per_second': 27.674, 'eval_steps_per_second': 1.248, 'epoch': 3.0}
2025-06-06 11:26:37,710 - INFO - Total updates (optimizer steps): 90
2025-06-06 11:26:37,710 - INFO - Avg time / step: 0.622s
2025-06-06 11:26:38,429 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCEdmis-lab/biobert-v1.13trials_fold-1
2025-06-06 11:26:38,429 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.16it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.05it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.37it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.11it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.26it/s]2025-06-06 11:26:42,978 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.41it/s]
2025-06-06 11:26:42,982 - INFO - preds : [1 0 0 0 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 0 1 1 0 1 1 1 0 1 0 1 1 1 1 1 1
 1 1 1 0 0 1 0 1 1 0 1 1 1 1 0 0 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 0 0
 1 1 0 1 0 0 0 1 1 1 1 1 1 0 1 1 1 1 0 1 1 0 1 1 1 0 0 1 0 0 1 1 1 1 1 0 0
 0 1 1 1 1 1 0 1 0 1 1 1 1 1 1 1 0 1 1 1 1 0]
2025-06-06 11:26:42,983 - INFO - test_split["labels"] : [1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0]
2025-06-06 11:26:42,985 - INFO - Confusion matrix: TN=35, FP=0, FN=0, TP=98
2025-06-06 11:26:45,888 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 35, 'FP': 0, 'FN': 0, 'TP': 98}
2025-06-06 11:26:46,012 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-06 11:26:46,111 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 11:26:46,111 - INFO - 
On test Set (optimal threshold of 0.9997684359550476 according to cross validation on the training set): 
2025-06-06 11:26:46,113 - INFO - Confusion matrix: TN=35, FP=0, FN=10, TP=88
2025-06-06 11:26:48,870 - INFO - Metrics: {'f1': 0.946236559139785, 'recall': 0.8979591836734694, 'precision': 1.0, 'accuracy': 0.924812030075188, 'AP': 1.0, 'MCC': 0.835710894037345, 'NDCG': 1.0000000000000004, 'kappa': 0.822429906542056, 'TN': 35, 'FP': 0, 'FN': 10, 'TP': 88}
2025-06-06 11:26:48,972 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 11:26:48,972 - INFO - Results for fold 1 : [{'f1': 0.946236559139785, 'recall': 0.8979591836734694, 'precision': 1.0, 'accuracy': 0.924812030075188, 'AP': 1.0, 'MCC': 0.835710894037345, 'NDCG': 1.0000000000000004, 'kappa': 0.822429906542056, 'TN': 35, 'FP': 0, 'FN': 10, 'TP': 88}]
2025-06-06 11:26:49,093 - INFO - Cleared CUDA cache. Memory allocated: 1.41 GB, Memory reserved: 1.86 GB
2025-06-06 11:26:49,094 - INFO - 
fold number 2 / 3
2025-06-06 11:26:49,100 - INFO - train split size : 697
2025-06-06 11:26:49,100 - INFO - dev split size : 67
2025-06-06 11:26:49,100 - INFO - test split size : 132
Map (num_proc=32):   0%|          | 0/697 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 22/697 [00:00<00:07, 96.40 examples/s]Map (num_proc=32):  13%|â–ˆâ–Ž        | 88/697 [00:00<00:02, 289.76 examples/s]Map (num_proc=32):  22%|â–ˆâ–ˆâ–       | 154/697 [00:00<00:01, 381.43 examples/s]Map (num_proc=32):  35%|â–ˆâ–ˆâ–ˆâ–      | 242/697 [00:00<00:00, 522.63 examples/s]Map (num_proc=32):  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 308/697 [00:00<00:00, 492.24 examples/s]Map (num_proc=32):  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 396/697 [00:00<00:00, 587.96 examples/s]Map (num_proc=32):  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 462/697 [00:00<00:00, 594.29 examples/s]Map (num_proc=32):  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 528/697 [00:01<00:00, 596.40 examples/s]Map (num_proc=32):  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 592/697 [00:01<00:00, 604.94 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 676/697 [00:01<00:00, 606.84 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 697/697 [00:01<00:00, 480.49 examples/s]
Map (num_proc=32):   0%|          | 0/67 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/67 [00:00<00:04, 15.66 examples/s]Map (num_proc=32):  19%|â–ˆâ–‰        | 13/67 [00:00<00:01, 48.30 examples/s]Map (num_proc=32):  31%|â–ˆâ–ˆâ–ˆâ–      | 21/67 [00:00<00:00, 57.48 examples/s]Map (num_proc=32):  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 29/67 [00:00<00:00, 63.11 examples/s]Map (num_proc=32):  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 37/67 [00:00<00:00, 65.43 examples/s]Map (num_proc=32):  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 47/67 [00:00<00:00, 70.83 examples/s]Map (num_proc=32):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 55/67 [00:00<00:00, 69.85 examples/s]Map (num_proc=32):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 63/67 [00:00<00:00, 71.32 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:01<00:00, 57.67 examples/s]
Map (num_proc=32):   0%|          | 0/132 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/132 [00:00<00:04, 26.70 examples/s]Map (num_proc=32):  18%|â–ˆâ–Š        | 24/132 [00:00<00:01, 90.47 examples/s]Map (num_proc=32):  30%|â–ˆâ–ˆâ–ˆ       | 40/132 [00:00<00:00, 111.55 examples/s]Map (num_proc=32):  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 56/132 [00:00<00:00, 121.55 examples/s]Map (num_proc=32):  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 72/132 [00:00<00:00, 128.20 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 88/132 [00:00<00:00, 131.20 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 104/132 [00:00<00:00, 134.06 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 120/132 [00:00<00:00, 136.47 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 132/132 [00:01<00:00, 110.16 examples/s]
2025-06-06 11:26:59,245 - INFO - 3 datasets tokenized successfully
2025-06-06 11:26:59,247 - INFO - Starting hyperparameter search for BCE loss
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-06_11-26-59   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-26-59
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-06_10-55-47_424551_3536632/artifacts/2025-06-06_11-26-59/train_hpo_2025-06-06_11-26-59/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-06 11:26:59. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_f270c5a7   PENDING         8.49369       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_f270c5a7 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_f270c5a7 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          8.49369 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3575948)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3575948)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3575948)[0m 2025-06-06 11:27:06,953 - INFO - pos_weight value in TrainingArguments : 8.493688290834637
[36m(train_hpo pid=3575948)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3575948)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3575948)[0m [2025-06-06 11:27:07,190] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3575948)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3575948)[0m   warnings.warn(
[36m(train_hpo pid=3575948)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=48, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_60489884 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_60489884 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          7.54953 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3576110)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3576110)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3576110)[0m 2025-06-06 11:27:13,664 - INFO - pos_weight value in TrainingArguments : 7.549531688595925
[36m(train_hpo pid=3576110)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3576110)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3576110)[0m [2025-06-06 11:27:14,043] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3576110)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3576110)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3576110)[0m   warnings.warn(

Trial train_hpo_90d0435e started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_90d0435e config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          8.94984 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3576366)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3576366)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3576366)[0m 2025-06-06 11:27:20,398 - INFO - pos_weight value in TrainingArguments : 8.949837496427758
[36m(train_hpo pid=3576366)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3576366)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3576366)[0m [2025-06-06 11:27:20,621] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3576366)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=24, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3576366)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3576366)[0m   warnings.warn(

Trial status: 3 RUNNING
Current time: 2025-06-06 11:27:29. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_f270c5a7   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_60489884   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_90d0435e   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3575948)[0m {'loss': 1.6581, 'grad_norm': 1.856582522392273, 'learning_rate': 1.246338876535363e-06, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3576366)[0m {'loss': 1.2041, 'grad_norm': 9.938576698303223, 'learning_rate': 5.325452975187489e-05, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3576110)[0m {'loss': 1.6006, 'grad_norm': 3.3456828594207764, 'learning_rate': 3.6443132246884782e-06, 'epoch': 0.9142857142857143}
Trial status: 3 RUNNING
Current time: 2025-06-06 11:27:59. Total running time: 1min 0s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_f270c5a7   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_60489884   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_90d0435e   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3575948)[0m {'loss': 1.6269, 'grad_norm': 2.990652561187744, 'learning_rate': 9.970711012282902e-07, 'epoch': 1.9142857142857141}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3576366)[0m {'train_runtime': 38.037, 'train_samples_per_second': 54.973, 'train_steps_per_second': 0.631, 'train_loss': 0.5007927541931471, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3576366)[0m STATE at ending of training  :  TrainerState(epoch=2.914285714285714, global_step=24, max_steps=24, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=515518317647880.0, log_history=[{'loss': 1.2041, 'grad_norm': 9.938576698303223, 'learning_rate': 5.325452975187489e-05, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.2455, 'grad_norm': 1.5897173881530762, 'learning_rate': 2.6627264875937445e-05, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 0.0527, 'grad_norm': 0.6551141738891602, 'learning_rate': 0.0, 'epoch': 2.914285714285714, 'step': 24}, {'train_runtime': 38.037, 'train_samples_per_second': 54.973, 'train_steps_per_second': 0.631, 'total_flos': 515518317647880.0, 'train_loss': 0.5007927541931471, 'epoch': 2.914285714285714, 'step': 24}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3576366)[0m {'eval_loss': 0.32214581966400146, 'eval_f1': 0.9795918367346939, 'eval_recall': 0.9795918367346939, 'eval_accuracy': 0.9701492537313433, 'eval_precision': 0.9795918367346939, 'eval_optim_threshold': 0.9818529486656189, 'eval_AP': 0.9987831867440855, 'eval_MCC': 0.9240362811791383, 'eval_NDCG': 0.9997894476014363, 'eval_kappa': 0.9240362811791383, 'eval_runtime': 3.2438, 'eval_samples_per_second': 20.654, 'eval_steps_per_second': 1.233, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3576366)[0m 2025-06-06 11:28:05,159 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3576366)[0m 2025-06-06 11:28:05,165 - INFO - eval_result: {'eval_loss': 0.32214581966400146, 'eval_f1': 0.9795918367346939, 'eval_recall': 0.9795918367346939, 'eval_accuracy': 0.9701492537313433, 'eval_precision': 0.9795918367346939, 'eval_optim_threshold': 0.9818529486656189, 'eval_AP': 0.9987831867440855, 'eval_MCC': 0.9240362811791383, 'eval_NDCG': 0.9997894476014363, 'eval_kappa': 0.9240362811791383, 'eval_runtime': 3.2438, 'eval_samples_per_second': 20.654, 'eval_steps_per_second': 1.233, 'epoch': 2.914285714285714}

Trial train_hpo_90d0435e finished iteration 1 at 2025-06-06 11:28:05. Total running time: 1min 5s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_90d0435e result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    45.6473 â”‚
â”‚ time_total_s                        45.6473 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               2.91429 â”‚
â”‚ eval_AP                             0.99878 â”‚
â”‚ eval_MCC                            0.92404 â”‚
â”‚ eval_NDCG                           0.99979 â”‚
â”‚ eval_accuracy                       0.97015 â”‚
â”‚ eval_f1                             0.97959 â”‚
â”‚ eval_kappa                          0.92404 â”‚
â”‚ eval_loss                           0.32215 â”‚
â”‚ eval_optim_threshold                0.98185 â”‚
â”‚ eval_precision                      0.97959 â”‚
â”‚ eval_recall                         0.97959 â”‚
â”‚ eval_runtime                         3.2438 â”‚
â”‚ eval_samples_per_second              20.654 â”‚
â”‚ eval_steps_per_second                 1.233 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:28:05,226 - INFO - Cleaning up trial 90d0435e
2025-06-06 11:28:05,226 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-26-59/train_hpo_90d0435e_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512_2025-06-06_11-27-12

Trial train_hpo_90d0435e completed after 1 iterations at 2025-06-06 11:28:05. Total running time: 1min 5s
[36m(train_hpo pid=3576366)[0m 2025-06-06 11:28:05,200 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3576110)[0m {'loss': 1.4558, 'grad_norm': 3.8390116691589355, 'learning_rate': 2.7332349185163582e-06, 'epoch': 1.9142857142857141}[32m [repeated 2x across cluster][0m

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:28:29. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_f270c5a7   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_60489884   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_90d0435e   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.6473      0.322146    0.979592        0.979592          0.970149 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3575948)[0m {'loss': 1.6159, 'grad_norm': 2.0235607624053955, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3576110)[0m {'loss': 1.3786, 'grad_norm': 4.250880718231201, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.914285714285714}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:28:59. Total running time: 2min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_f270c5a7   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_60489884   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_90d0435e   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.6473      0.322146    0.979592        0.979592          0.970149 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3575948)[0m {'loss': 1.6016, 'grad_norm': 3.643385648727417, 'learning_rate': 4.985355506141451e-07, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3576110)[0m {'loss': 1.305, 'grad_norm': 6.2084150314331055, 'learning_rate': 9.110783061721196e-07, 'epoch': 3.914285714285714}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:29:29. Total running time: 2min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_f270c5a7   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_60489884   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_90d0435e   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.6473      0.322146    0.979592        0.979592          0.970149 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3575948)[0m {'loss': 1.588, 'grad_norm': 6.629246711730957, 'learning_rate': 2.4926777530707256e-07, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3576110)[0m {'loss': 1.2279, 'grad_norm': 5.948479175567627, 'learning_rate': 0.0, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3576110)[0m {'train_runtime': 147.6499, 'train_samples_per_second': 23.603, 'train_steps_per_second': 0.271, 'train_loss': 1.3935665607452392, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3576110)[0m STATE at ending of training  :  TrainerState(epoch=4.914285714285715, global_step=40, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=862821792397320.0, log_history=[{'loss': 1.6006, 'grad_norm': 3.3456828594207764, 'learning_rate': 3.6443132246884782e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 1.4558, 'grad_norm': 3.8390116691589355, 'learning_rate': 2.7332349185163582e-06, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 1.3786, 'grad_norm': 4.250880718231201, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 1.305, 'grad_norm': 6.2084150314331055, 'learning_rate': 9.110783061721196e-07, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 1.2279, 'grad_norm': 5.948479175567627, 'learning_rate': 0.0, 'epoch': 4.914285714285715, 'step': 40}, {'train_runtime': 147.6499, 'train_samples_per_second': 23.603, 'train_steps_per_second': 0.271, 'total_flos': 862821792397320.0, 'train_loss': 1.3935665607452392, 'epoch': 4.914285714285715, 'step': 40}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_60489884 finished iteration 1 at 2025-06-06 11:29:48. Total running time: 2min 49s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_60489884 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    155.993 â”‚
â”‚ time_total_s                        155.993 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               4.91429 â”‚
â”‚ eval_AP                             0.99882 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                            0.9998 â”‚
â”‚ eval_accuracy                       0.73134 â”‚
â”‚ eval_f1                             0.84483 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           2.09976 â”‚
â”‚ eval_optim_threshold                0.65103 â”‚
â”‚ eval_precision                      0.73134 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.7664 â”‚
â”‚ eval_samples_per_second              17.789 â”‚
â”‚ eval_steps_per_second                 1.062 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:29:48,785 - INFO - Cleaning up trial 60489884
2025-06-06 11:29:48,785 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-26-59/train_hpo_60489884_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-06_11-27-06
2025-06-06 11:29:48,785 - INFO - Current best: 90d0435e with eval_f1 : 0.9795918367346939 at iteration 1

Trial train_hpo_60489884 completed after 1 iterations at 2025-06-06 11:29:48. Total running time: 2min 49s
[36m(train_hpo pid=3576110)[0m {'eval_loss': 2.099764585494995, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.6510288119316101, 'eval_AP': 0.9988226059654631, 'eval_MCC': 0.0, 'eval_NDCG': 0.9997955899781452, 'eval_kappa': 0.0, 'eval_runtime': 3.7664, 'eval_samples_per_second': 17.789, 'eval_steps_per_second': 1.062, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3576110)[0m 2025-06-06 11:29:48,723 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3576110)[0m 2025-06-06 11:29:48,729 - INFO - eval_result: {'eval_loss': 2.099764585494995, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.6510288119316101, 'eval_AP': 0.9988226059654631, 'eval_MCC': 0.0, 'eval_NDCG': 0.9997955899781452, 'eval_kappa': 0.0, 'eval_runtime': 3.7664, 'eval_samples_per_second': 17.789, 'eval_steps_per_second': 1.062, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3576110)[0m 2025-06-06 11:29:48,763 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3575948)[0m STATE at ending of training  :  TrainerState(epoch=5.914285714285715, global_step=48, max_steps=48, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=1036473529772040.0, log_history=[{'loss': 1.6581, 'grad_norm': 1.856582522392273, 'learning_rate': 1.246338876535363e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 1.6269, 'grad_norm': 2.990652561187744, 'learning_rate': 9.970711012282902e-07, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 1.6159, 'grad_norm': 2.0235607624053955, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 1.6016, 'grad_norm': 3.643385648727417, 'learning_rate': 4.985355506141451e-07, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 1.588, 'grad_norm': 6.629246711730957, 'learning_rate': 2.4926777530707256e-07, 'epoch': 4.914285714285715, 'step': 40}, {'loss': 1.5672, 'grad_norm': 4.960045337677002, 'learning_rate': 0.0, 'epoch': 5.914285714285715, 'step': 48}, {'train_runtime': 161.2768, 'train_samples_per_second': 25.931, 'train_steps_per_second': 0.298, 'total_flos': 1036473529772040.0, 'train_loss': 1.6096021731694539, 'epoch': 5.914285714285715, 'step': 48}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3575948)[0m {'loss': 1.5672, 'grad_norm': 4.960045337677002, 'learning_rate': 0.0, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3575948)[0m {'train_runtime': 161.2768, 'train_samples_per_second': 25.931, 'train_steps_per_second': 0.298, 'train_loss': 1.6096021731694539, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3575948)[0m 2025-06-06 11:29:55,515 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3575948)[0m 2025-06-06 11:29:55,521 - INFO - eval_result: {'eval_loss': 2.6401596069335938, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.6797209978103638, 'eval_AP': 0.9611276312403437, 'eval_MCC': 0.2030905986149808, 'eval_NDCG': 0.9926498585275874, 'eval_kappa': 0.0792239288601454, 'eval_runtime': 3.7826, 'eval_samples_per_second': 17.713, 'eval_steps_per_second': 1.057, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3575948)[0m 2025-06-06 11:29:55,555 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3575948)[0m {'eval_loss': 2.6401596069335938, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.6797209978103638, 'eval_AP': 0.9611276312403437, 'eval_MCC': 0.2030905986149808, 'eval_NDCG': 0.9926498585275874, 'eval_kappa': 0.0792239288601454, 'eval_runtime': 3.7826, 'eval_samples_per_second': 17.713, 'eval_steps_per_second': 1.057, 'epoch': 5.914285714285715}

Trial train_hpo_f270c5a7 finished iteration 1 at 2025-06-06 11:29:55. Total running time: 2min 56s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_f270c5a7 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    169.512 â”‚
â”‚ time_total_s                        169.512 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               5.91429 â”‚
â”‚ eval_AP                             0.96113 â”‚
â”‚ eval_MCC                            0.20309 â”‚
â”‚ eval_NDCG                           0.99265 â”‚
â”‚ eval_accuracy                       0.74627 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                          0.07922 â”‚
â”‚ eval_loss                           2.64016 â”‚
â”‚ eval_optim_threshold                0.67972 â”‚
â”‚ eval_precision                      0.74242 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.7826 â”‚
â”‚ eval_samples_per_second              17.713 â”‚
â”‚ eval_steps_per_second                 1.057 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:29:55,577 - INFO - Cleaning up trial f270c5a7
2025-06-06 11:29:55,577 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-26-59/train_hpo_f270c5a7_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-06_11-26-59
2025-06-06 11:29:55,577 - INFO - Cleaning up trial 60489884
2025-06-06 11:29:55,577 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-26-59/train_hpo_60489884_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-06_11-27-06
2025-06-06 11:29:55,578 - INFO - Current best: 90d0435e with eval_f1 : 0.9795918367346939 at iteration 1

Trial train_hpo_f270c5a7 completed after 1 iterations at 2025-06-06 11:29:55. Total running time: 2min 56s
2025-06-06 11:29:55,585	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-26-59' in 0.0052s.

Trial status: 3 TERMINATED
Current time: 2025-06-06 11:29:55. Total running time: 2min 56s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_f270c5a7   TERMINATED        8.49369       1.49561e-06         0.13641                     6        1           169.512       2.64016     0.852174        1                 0.746269 â”‚
â”‚ train_hpo_60489884   TERMINATED        7.54953       4.55539e-06         0.123031                    5        1           155.993       2.09976     0.844828        1                 0.731343 â”‚
â”‚ train_hpo_90d0435e   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.6473      0.322146    0.979592        0.979592          0.970149 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

2025-06-06 11:29:55,591 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x700d4c2bd590>
2025-06-06 11:29:55,592 - INFO - Best trial : train_hpo_90d0435e
2025-06-06 11:29:55,592 - INFO - Best config : {'pos_weight': 8.949837496427758, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-06 11:29:55,592 - INFO - Best trial after optimization: {'eval_loss': 0.32214581966400146, 'eval_f1': 0.9795918367346939, 'eval_recall': 0.9795918367346939, 'eval_accuracy': 0.9701492537313433, 'eval_precision': 0.9795918367346939, 'eval_optim_threshold': 0.9818529486656189, 'eval_AP': 0.9987831867440855, 'eval_MCC': 0.9240362811791383, 'eval_NDCG': 0.9997894476014363, 'eval_kappa': 0.9240362811791383, 'eval_runtime': 3.2438, 'eval_samples_per_second': 20.654, 'eval_steps_per_second': 1.233, 'epoch': 2.914285714285714, 'timestamp': 1749202085, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '90d0435e', 'date': '2025-06-06_11-28-05', 'time_this_iter_s': 45.64732217788696, 'time_total_s': 45.64732217788696, 'pid': 3576366, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 8.949837496427758, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 45.64732217788696, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512'}
2025-06-06 11:29:55,612 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   2.640160  0.852174  ...                        6  f270c5a7
1   2.099765  0.844828  ...                        5  60489884
2   0.322146  0.979592  ...                        3  90d0435e

[3 rows x 32 columns]
2025-06-06 11:29:55,773 - INFO - Trial comparison plot saved
2025-06-06 11:29:55,774 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-06 11:29:56,368 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-06 11:29:56,454 - INFO - training size : 697
2025-06-06 11:29:56,454 - INFO - dev size : 67
2025-06-06 11:29:56,454 - INFO - test size : 132
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
  0%|          | 0/90 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  1%|          | 1/90 [00:00<00:57,  1.54it/s]  2%|â–         | 2/90 [00:01<00:55,  1.59it/s]  3%|â–Ž         | 3/90 [00:01<00:54,  1.61it/s]  4%|â–         | 4/90 [00:02<00:53,  1.61it/s]  6%|â–Œ         | 5/90 [00:03<00:52,  1.61it/s]  7%|â–‹         | 6/90 [00:03<00:52,  1.62it/s]  8%|â–Š         | 7/90 [00:04<00:51,  1.62it/s]  9%|â–‰         | 8/90 [00:04<00:50,  1.62it/s] 10%|â–ˆ         | 9/90 [00:05<00:50,  1.62it/s] 11%|â–ˆ         | 10/90 [00:06<00:49,  1.62it/s] 12%|â–ˆâ–        | 11/90 [00:06<00:48,  1.62it/s] 13%|â–ˆâ–Ž        | 12/90 [00:07<00:48,  1.62it/s] 14%|â–ˆâ–        | 13/90 [00:08<00:47,  1.62it/s] 16%|â–ˆâ–Œ        | 14/90 [00:08<00:46,  1.62it/s] 17%|â–ˆâ–‹        | 15/90 [00:09<00:46,  1.62it/s] 18%|â–ˆâ–Š        | 16/90 [00:09<00:45,  1.62it/s] 19%|â–ˆâ–‰        | 17/90 [00:10<00:45,  1.62it/s] 20%|â–ˆâ–ˆ        | 18/90 [00:11<00:44,  1.62it/s] 21%|â–ˆâ–ˆ        | 19/90 [00:11<00:43,  1.62it/s] 22%|â–ˆâ–ˆâ–       | 20/90 [00:12<00:43,  1.62it/s] 23%|â–ˆâ–ˆâ–Ž       | 21/90 [00:12<00:42,  1.62it/s] 24%|â–ˆâ–ˆâ–       | 22/90 [00:13<00:41,  1.62it/s] 26%|â–ˆâ–ˆâ–Œ       | 23/90 [00:14<00:41,  1.62it/s] 27%|â–ˆâ–ˆâ–‹       | 24/90 [00:14<00:40,  1.62it/s] 28%|â–ˆâ–ˆâ–Š       | 25/90 [00:15<00:39,  1.63it/s] 29%|â–ˆâ–ˆâ–‰       | 26/90 [00:16<00:39,  1.63it/s] 30%|â–ˆâ–ˆâ–ˆ       | 27/90 [00:16<00:38,  1.62it/s] 31%|â–ˆâ–ˆâ–ˆ       | 28/90 [00:17<00:38,  1.62it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 29/90 [00:17<00:37,  1.64it/s]                                               {'loss': 0.4684, 'grad_norm': 0.36202043294906616, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 30/90 [00:17<00:36,  1.64it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 31/90 [00:18<00:28,  2.04it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 32/90 [00:19<00:30,  1.92it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 33/90 [00:19<00:31,  1.83it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 34/90 [00:20<00:31,  1.77it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 35/90 [00:21<00:31,  1.73it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 36/90 [00:21<00:31,  1.70it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 37/90 [00:22<00:31,  1.67it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 38/90 [00:22<00:31,  1.66it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 39/90 [00:23<00:30,  1.65it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 40/90 [00:24<00:30,  1.64it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 41/90 [00:24<00:29,  1.64it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 42/90 [00:25<00:29,  1.63it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 43/90 [00:25<00:28,  1.63it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 44/90 [00:26<00:28,  1.63it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 45/90 [00:27<00:27,  1.63it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 46/90 [00:27<00:27,  1.63it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 47/90 [00:28<00:26,  1.63it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 48/90 [00:29<00:25,  1.62it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 49/90 [00:29<00:25,  1.62it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 50/90 [00:30<00:24,  1.62it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 51/90 [00:30<00:24,  1.62it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 52/90 [00:31<00:23,  1.62it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 53/90 [00:32<00:22,  1.62it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 54/90 [00:32<00:22,  1.62it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 55/90 [00:33<00:21,  1.62it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 56/90 [00:34<00:20,  1.62it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 57/90 [00:34<00:20,  1.62it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 58/90 [00:35<00:19,  1.62it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 59/90 [00:35<00:18,  1.64it/s]                                               {'loss': 0.0631, 'grad_norm': 0.02626904286444187, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 60/90 [00:35<00:18,  1.64it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 61/90 [00:36<00:14,  2.06it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 62/90 [00:37<00:14,  1.93it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 63/90 [00:37<00:14,  1.84it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 64/90 [00:38<00:14,  1.77it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 65/90 [00:38<00:14,  1.73it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 66/90 [00:39<00:14,  1.70it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 67/90 [00:40<00:13,  1.68it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 68/90 [00:40<00:13,  1.66it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 69/90 [00:41<00:12,  1.65it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 70/90 [00:42<00:12,  1.64it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 71/90 [00:42<00:11,  1.64it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 72/90 [00:43<00:11,  1.63it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 73/90 [00:43<00:10,  1.63it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 74/90 [00:44<00:09,  1.63it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 75/90 [00:45<00:09,  1.63it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 76/90 [00:45<00:08,  1.63it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 77/90 [00:46<00:07,  1.63it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 78/90 [00:46<00:07,  1.62it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 79/90 [00:47<00:06,  1.62it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 80/90 [00:48<00:06,  1.62it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 81/90 [00:48<00:05,  1.62it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 82/90 [00:49<00:04,  1.62it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 83/90 [00:50<00:04,  1.62it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 84/90 [00:50<00:03,  1.62it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 85/90 [00:51<00:03,  1.62it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 86/90 [00:51<00:02,  1.62it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 87/90 [00:52<00:01,  1.62it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 88/90 [00:53<00:01,  1.62it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 89/90 [00:53<00:00,  1.64it/s]                                               {'loss': 0.0013, 'grad_norm': 0.05659849941730499, 'learning_rate': 0.0, 'epoch': 3.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.64it/s]                                               {'train_runtime': 56.1494, 'train_samples_per_second': 37.24, 'train_steps_per_second': 1.603, 'train_loss': 0.17757610057791073, 'epoch': 3.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.64it/s]2025-06-06 11:30:53,063 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.60it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.29it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.43it/s]2025-06-06 11:30:56,731 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.12s/it]
2025-06-06 11:30:56,737 - INFO - Training time : 60.96348866587505
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.17it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.07it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.38it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.13it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.36it/s]2025-06-06 11:31:01,149 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.46it/s]
2025-06-06 11:31:01,154 - INFO - Evaluation time : 4.416981377173215
2025-06-06 11:31:01,154 - INFO - Evaluation results on test set: {'eval_loss': 0.002037954283878207, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9997192025184631, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000004, 'eval_kappa': 1.0, 'eval_runtime': 4.4124, 'eval_samples_per_second': 29.916, 'eval_steps_per_second': 1.36, 'epoch': 3.0}
2025-06-06 11:31:01,154 - INFO - Total updates (optimizer steps): 90
2025-06-06 11:31:01,154 - INFO - Avg time / step: 0.624s
2025-06-06 11:31:01,881 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCEdmis-lab/biobert-v1.13trials_fold-2
2025-06-06 11:31:01,882 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  6.66it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  4.90it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.30it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.08it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.32it/s]2025-06-06 11:31:06,697 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.33it/s]
2025-06-06 11:31:06,701 - INFO - preds : [1 1 0 1 0 0 1 1 1 1 1 0 1 0 1 0 0 0 1 1 1 0 1 1 1 1 1 0 1 1 1 0 1 0 1 1 1
 0 1 1 1 0 1 0 1 0 0 1 1 1 1 1 0 1 1 1 1 1 0 1 0 1 1 0 1 1 1 1 0 1 1 1 0 1
 1 1 1 1 0 1 1 0 0 1 0 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 0 1 0 1 1 1 0 1 1 1 1
 1 1 1 1 1 0 1 1 1 1 1 0 1 1 1 1 1 1 0 1 1]
2025-06-06 11:31:06,702 - INFO - test_split["labels"] : [1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1]
2025-06-06 11:31:06,703 - INFO - Confusion matrix: TN=34, FP=0, FN=0, TP=98
2025-06-06 11:31:09,632 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 34, 'FP': 0, 'FN': 0, 'TP': 98}
2025-06-06 11:31:09,757 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-06 11:31:09,854 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 11:31:09,854 - INFO - 
On test Set (optimal threshold of 0.9997240900993347 according to cross validation on the training set): 
2025-06-06 11:31:09,855 - INFO - Confusion matrix: TN=34, FP=0, FN=2, TP=96
2025-06-06 11:31:12,820 - INFO - Metrics: {'f1': 0.9896907216494846, 'recall': 0.9795918367346939, 'precision': 1.0, 'accuracy': 0.9848484848484849, 'AP': 1.0, 'MCC': 0.9618576131773406, 'NDCG': 1.0000000000000004, 'kappa': 0.9611307420494699, 'TN': 34, 'FP': 0, 'FN': 2, 'TP': 96}
2025-06-06 11:31:12,917 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 11:31:12,917 - INFO - Results for fold 2 : [{'f1': 0.9896907216494846, 'recall': 0.9795918367346939, 'precision': 1.0, 'accuracy': 0.9848484848484849, 'AP': 1.0, 'MCC': 0.9618576131773406, 'NDCG': 1.0000000000000004, 'kappa': 0.9611307420494699, 'TN': 34, 'FP': 0, 'FN': 2, 'TP': 96}]
2025-06-06 11:31:13,036 - INFO - Cleared CUDA cache. Memory allocated: 1.41 GB, Memory reserved: 1.80 GB
2025-06-06 11:31:13,036 - INFO - 
fold number 3 / 3
2025-06-06 11:31:13,042 - INFO - train split size : 697
2025-06-06 11:31:13,042 - INFO - dev split size : 67
2025-06-06 11:31:13,042 - INFO - test split size : 132
Map (num_proc=32):   0%|          | 0/697 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 22/697 [00:00<00:07, 95.12 examples/s]Map (num_proc=32):  19%|â–ˆâ–‰        | 132/697 [00:00<00:01, 456.27 examples/s]Map (num_proc=32):  35%|â–ˆâ–ˆâ–ˆâ–      | 242/697 [00:00<00:00, 672.25 examples/s]Map (num_proc=32):  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 352/697 [00:00<00:00, 775.35 examples/s]Map (num_proc=32):  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 440/697 [00:00<00:00, 777.28 examples/s]Map (num_proc=32):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 571/697 [00:00<00:00, 890.02 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 676/697 [00:00<00:00, 935.90 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 697/697 [00:01<00:00, 668.86 examples/s]
Map (num_proc=32):   0%|          | 0/67 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/67 [00:00<00:03, 16.57 examples/s]Map (num_proc=32):  22%|â–ˆâ–ˆâ–       | 15/67 [00:00<00:00, 56.71 examples/s]Map (num_proc=32):  34%|â–ˆâ–ˆâ–ˆâ–      | 23/67 [00:00<00:00, 64.71 examples/s]Map (num_proc=32):  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 31/67 [00:00<00:00, 69.26 examples/s]Map (num_proc=32):  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 41/67 [00:00<00:00, 74.30 examples/s]Map (num_proc=32):  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 49/67 [00:00<00:00, 74.88 examples/s]Map (num_proc=32):  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 57/67 [00:00<00:00, 76.34 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:00<00:00, 78.25 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:01<00:00, 61.70 examples/s]
Map (num_proc=32):   0%|          | 0/132 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/132 [00:00<00:04, 27.83 examples/s]Map (num_proc=32):  18%|â–ˆâ–Š        | 24/132 [00:00<00:01, 98.60 examples/s]Map (num_proc=32):  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 44/132 [00:00<00:00, 129.54 examples/s]Map (num_proc=32):  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 60/132 [00:00<00:00, 138.86 examples/s]Map (num_proc=32):  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 80/132 [00:00<00:00, 146.15 examples/s]Map (num_proc=32):  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 100/132 [00:00<00:00, 152.18 examples/s]Map (num_proc=32):  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 116/132 [00:00<00:00, 150.96 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 132/132 [00:01<00:00, 122.48 examples/s]
2025-06-06 11:31:22,298 - INFO - 3 datasets tokenized successfully
2025-06-06 11:31:22,300 - INFO - Starting hyperparameter search for BCE loss
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-06_11-31-22   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-31-22
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-06_10-55-47_424551_3536632/artifacts/2025-06-06_11-31-22/train_hpo_2025-06-06_11-31-22/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-06 11:31:22. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_9b28a3b5   PENDING         8.49369       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_9b28a3b5 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_9b28a3b5 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          8.49369 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3581256)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3581256)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3581256)[0m 2025-06-06 11:31:30,093 - INFO - pos_weight value in TrainingArguments : 8.493688290834637
[36m(train_hpo pid=3581256)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3581256)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3581256)[0m [2025-06-06 11:31:30,325] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3581256)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=48, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3581256)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3581256)[0m   warnings.warn(

Trial train_hpo_e083a91b started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_e083a91b config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          7.54953 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3581495)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3581495)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3581495)[0m 2025-06-06 11:31:36,643 - INFO - pos_weight value in TrainingArguments : 7.549531688595925
[36m(train_hpo pid=3581495)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3581495)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3581495)[0m [2025-06-06 11:31:37,025] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3581495)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3581495)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3581495)[0m   warnings.warn(

Trial train_hpo_ffc7be25 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_ffc7be25 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          8.94984 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3581718)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3581718)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3581718)[0m 2025-06-06 11:31:43,216 - INFO - pos_weight value in TrainingArguments : 8.949837496427758
[36m(train_hpo pid=3581718)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3581718)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3581718)[0m [2025-06-06 11:31:43,451] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3581718)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=24, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3581718)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3581718)[0m   warnings.warn(

Trial status: 3 RUNNING
Current time: 2025-06-06 11:31:52. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_9b28a3b5   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_e083a91b   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_ffc7be25   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3581256)[0m {'loss': 2.1465, 'grad_norm': 10.15967082977295, 'learning_rate': 1.246338876535363e-06, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3581495)[0m {'loss': 1.661, 'grad_norm': 3.5597939491271973, 'learning_rate': 3.6443132246884782e-06, 'epoch': 0.9142857142857143}[32m [repeated 2x across cluster][0m
Trial status: 3 RUNNING
Current time: 2025-06-06 11:32:22. Total running time: 1min 0s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_9b28a3b5   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_e083a91b   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_ffc7be25   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3581718)[0m {'train_runtime': 37.9416, 'train_samples_per_second': 55.111, 'train_steps_per_second': 0.633, 'train_loss': 0.47647135704755783, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3581718)[0m STATE at ending of training  :  TrainerState(epoch=2.914285714285714, global_step=24, max_steps=24, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=515518317647880.0, log_history=[{'loss': 1.1248, 'grad_norm': 7.095852851867676, 'learning_rate': 5.325452975187489e-05, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.2238, 'grad_norm': 2.648746967315674, 'learning_rate': 2.6627264875937445e-05, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 0.0808, 'grad_norm': 1.2362043857574463, 'learning_rate': 0.0, 'epoch': 2.914285714285714, 'step': 24}, {'train_runtime': 37.9416, 'train_samples_per_second': 55.111, 'train_steps_per_second': 0.633, 'total_flos': 515518317647880.0, 'train_loss': 0.47647135704755783, 'epoch': 2.914285714285714, 'step': 24}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3581718)[0m {'loss': 0.0808, 'grad_norm': 1.2362043857574463, 'learning_rate': 0.0, 'epoch': 2.914285714285714}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3581718)[0m {'eval_loss': 0.11782025545835495, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9796058535575867, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0, 'eval_kappa': 1.0, 'eval_runtime': 3.4585, 'eval_samples_per_second': 19.373, 'eval_steps_per_second': 1.157, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3581718)[0m 2025-06-06 11:32:28,035 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3581718)[0m 2025-06-06 11:32:28,041 - INFO - eval_result: {'eval_loss': 0.11782025545835495, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9796058535575867, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0, 'eval_kappa': 1.0, 'eval_runtime': 3.4585, 'eval_samples_per_second': 19.373, 'eval_steps_per_second': 1.157, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3581718)[0m 2025-06-06 11:32:28,078 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB

Trial train_hpo_ffc7be25 finished iteration 1 at 2025-06-06 11:32:28. Total running time: 1min 5s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_ffc7be25 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    45.7203 â”‚
â”‚ time_total_s                        45.7203 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               2.91429 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                                  1 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                             1 â”‚
â”‚ eval_f1                                   1 â”‚
â”‚ eval_kappa                                1 â”‚
â”‚ eval_loss                           0.11782 â”‚
â”‚ eval_optim_threshold                0.97961 â”‚
â”‚ eval_precision                            1 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.4585 â”‚
â”‚ eval_samples_per_second              19.373 â”‚
â”‚ eval_steps_per_second                 1.157 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:32:28,102 - INFO - Cleaning up trial ffc7be25
2025-06-06 11:32:28,102 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-31-22/train_hpo_ffc7be25_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512_2025-06-06_11-31-35

Trial train_hpo_ffc7be25 completed after 1 iterations at 2025-06-06 11:32:28. Total running time: 1min 5s
[36m(train_hpo pid=3581495)[0m {'loss': 1.4783, 'grad_norm': 6.897157192230225, 'learning_rate': 2.7332349185163582e-06, 'epoch': 1.9142857142857141}[32m [repeated 2x across cluster][0m

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:32:52. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_9b28a3b5   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_e083a91b   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_ffc7be25   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.7203       0.11782           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3581256)[0m {'loss': 1.9092, 'grad_norm': 9.743632316589355, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3581495)[0m {'loss': 1.3444, 'grad_norm': 5.014100551605225, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.914285714285714}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:33:22. Total running time: 2min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_9b28a3b5   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_e083a91b   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_ffc7be25   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.7203       0.11782           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3581256)[0m {'loss': 1.779, 'grad_norm': 7.787167549133301, 'learning_rate': 4.985355506141451e-07, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3581495)[0m {'loss': 1.2746, 'grad_norm': 6.283170223236084, 'learning_rate': 9.110783061721196e-07, 'epoch': 3.914285714285714}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:33:52. Total running time: 2min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_9b28a3b5   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_e083a91b   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_ffc7be25   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.7203       0.11782           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3581256)[0m {'loss': 1.6928, 'grad_norm': 18.12826919555664, 'learning_rate': 2.4926777530707256e-07, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3581495)[0m {'loss': 1.2015, 'grad_norm': 6.5751800537109375, 'learning_rate': 0.0, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3581495)[0m {'train_runtime': 148.8929, 'train_samples_per_second': 23.406, 'train_steps_per_second': 0.269, 'train_loss': 1.3919543027877808, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3581495)[0m STATE at ending of training  :  TrainerState(epoch=4.914285714285715, global_step=40, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=862616238730920.0, log_history=[{'loss': 1.661, 'grad_norm': 3.5597939491271973, 'learning_rate': 3.6443132246884782e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 1.4783, 'grad_norm': 6.897157192230225, 'learning_rate': 2.7332349185163582e-06, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 1.3444, 'grad_norm': 5.014100551605225, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 1.2746, 'grad_norm': 6.283170223236084, 'learning_rate': 9.110783061721196e-07, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 1.2015, 'grad_norm': 6.5751800537109375, 'learning_rate': 0.0, 'epoch': 4.914285714285715, 'step': 40}, {'train_runtime': 148.8929, 'train_samples_per_second': 23.406, 'train_steps_per_second': 0.269, 'total_flos': 862616238730920.0, 'train_loss': 1.3919543027877808, 'epoch': 4.914285714285715, 'step': 40}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3581495)[0m 2025-06-06 11:34:13,194 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3581495)[0m 2025-06-06 11:34:13,200 - INFO - eval_result: {'eval_loss': 2.0732181072235107, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.6572067737579346, 'eval_AP': 1.0, 'eval_MCC': 0.0, 'eval_NDCG': 1.0, 'eval_kappa': 0.0, 'eval_runtime': 4.0969, 'eval_samples_per_second': 16.354, 'eval_steps_per_second': 0.976, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3581495)[0m 2025-06-06 11:34:13,234 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3581495)[0m {'eval_loss': 2.0732181072235107, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.6572067737579346, 'eval_AP': 1.0, 'eval_MCC': 0.0, 'eval_NDCG': 1.0, 'eval_kappa': 0.0, 'eval_runtime': 4.0969, 'eval_samples_per_second': 16.354, 'eval_steps_per_second': 0.976, 'epoch': 4.914285714285715}

Trial train_hpo_e083a91b finished iteration 1 at 2025-06-06 11:34:13. Total running time: 2min 50s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_e083a91b result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    157.449 â”‚
â”‚ time_total_s                        157.449 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               4.91429 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                       0.74627 â”‚
â”‚ eval_f1                              0.8547 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           2.07322 â”‚
â”‚ eval_optim_threshold                0.65721 â”‚
â”‚ eval_precision                      0.74627 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         4.0969 â”‚
â”‚ eval_samples_per_second              16.354 â”‚
â”‚ eval_steps_per_second                 0.976 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:34:13,257 - INFO - Cleaning up trial e083a91b
2025-06-06 11:34:13,257 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-31-22/train_hpo_e083a91b_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-06_11-31-29
2025-06-06 11:34:13,257 - INFO - Current best: ffc7be25 with eval_f1 : 1.0 at iteration 1

Trial train_hpo_e083a91b completed after 1 iterations at 2025-06-06 11:34:13. Total running time: 2min 50s
[36m(train_hpo pid=3581256)[0m STATE at ending of training  :  TrainerState(epoch=5.914285714285715, global_step=48, max_steps=48, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=1036267976105640.0, log_history=[{'loss': 2.1465, 'grad_norm': 10.15967082977295, 'learning_rate': 1.246338876535363e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 2.0603, 'grad_norm': 18.8311710357666, 'learning_rate': 9.970711012282902e-07, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 1.9092, 'grad_norm': 9.743632316589355, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 1.779, 'grad_norm': 7.787167549133301, 'learning_rate': 4.985355506141451e-07, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 1.6928, 'grad_norm': 18.12826919555664, 'learning_rate': 2.4926777530707256e-07, 'epoch': 4.914285714285715, 'step': 40}, {'loss': 1.6056, 'grad_norm': 12.341642379760742, 'learning_rate': 0.0, 'epoch': 5.914285714285715, 'step': 48}, {'train_runtime': 162.3568, 'train_samples_per_second': 25.758, 'train_steps_per_second': 0.296, 'total_flos': 1036267976105640.0, 'train_loss': 1.865550935268402, 'epoch': 5.914285714285715, 'step': 48}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3581256)[0m {'loss': 1.6056, 'grad_norm': 12.341642379760742, 'learning_rate': 0.0, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3581256)[0m {'train_runtime': 162.3568, 'train_samples_per_second': 25.758, 'train_steps_per_second': 0.296, 'train_loss': 1.865550935268402, 'epoch': 5.914285714285715}

Trial train_hpo_9b28a3b5 finished iteration 1 at 2025-06-06 11:34:19. Total running time: 2min 57s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_9b28a3b5 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    170.673 â”‚
â”‚ time_total_s                        170.673 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               5.91429 â”‚
â”‚ eval_AP                             0.99691 â”‚
â”‚ eval_MCC                             0.8065 â”‚
â”‚ eval_NDCG                           0.99946 â”‚
â”‚ eval_accuracy                       0.91045 â”‚
â”‚ eval_f1                             0.93617 â”‚
â”‚ eval_kappa                           0.7882 â”‚
â”‚ eval_loss                           3.93281 â”‚
â”‚ eval_optim_threshold                0.48997 â”‚
â”‚ eval_precision                            1 â”‚
â”‚ eval_recall                            0.88 â”‚
â”‚ eval_runtime                         3.8829 â”‚
â”‚ eval_samples_per_second              17.255 â”‚
â”‚ eval_steps_per_second                  1.03 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:34:19,876 - INFO - Cleaning up trial 9b28a3b5
2025-06-06 11:34:19,877 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-31-22/train_hpo_9b28a3b5_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-06_11-31-22
2025-06-06 11:34:19,877 - INFO - Cleaning up trial e083a91b
2025-06-06 11:34:19,877 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-31-22/train_hpo_e083a91b_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-06_11-31-29
2025-06-06 11:34:19,877 - INFO - Current best: ffc7be25 with eval_f1 : 1.0 at iteration 1

Trial train_hpo_9b28a3b5 completed after 1 iterations at 2025-06-06 11:34:19. Total running time: 2min 57s
[36m(train_hpo pid=3581256)[0m {'eval_loss': 3.9328129291534424, 'eval_f1': 0.9361702127659575, 'eval_recall': 0.88, 'eval_accuracy': 0.9104477611940298, 'eval_precision': 1.0, 'eval_optim_threshold': 0.4899684190750122, 'eval_AP': 0.9969140783744557, 'eval_MCC': 0.8064953704818743, 'eval_NDCG': 0.9994620263165263, 'eval_kappa': 0.7881981032665963, 'eval_runtime': 3.8829, 'eval_samples_per_second': 17.255, 'eval_steps_per_second': 1.03, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3581256)[0m 2025-06-06 11:34:19,814 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3581256)[0m 2025-06-06 11:34:19,819 - INFO - eval_result: {'eval_loss': 3.9328129291534424, 'eval_f1': 0.9361702127659575, 'eval_recall': 0.88, 'eval_accuracy': 0.9104477611940298, 'eval_precision': 1.0, 'eval_optim_threshold': 0.4899684190750122, 'eval_AP': 0.9969140783744557, 'eval_MCC': 0.8064953704818743, 'eval_NDCG': 0.9994620263165263, 'eval_kappa': 0.7881981032665963, 'eval_runtime': 3.8829, 'eval_samples_per_second': 17.255, 'eval_steps_per_second': 1.03, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3581256)[0m 2025-06-06 11:34:19,854 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
2025-06-06 11:34:19,921	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-31-22' in 0.0055s.

Trial status: 3 TERMINATED
Current time: 2025-06-06 11:34:19. Total running time: 2min 57s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_9b28a3b5   TERMINATED        8.49369       1.49561e-06         0.13641                     6        1           170.673        3.93281    0.93617             0.88          0.910448 â”‚
â”‚ train_hpo_e083a91b   TERMINATED        7.54953       4.55539e-06         0.123031                    5        1           157.449        2.07322    0.854701            1             0.746269 â”‚
â”‚ train_hpo_ffc7be25   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.7203       0.11782    1                   1             1        â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

2025-06-06 11:34:19,928 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x700d4c3c1ed0>
2025-06-06 11:34:19,928 - INFO - Best trial : train_hpo_ffc7be25
2025-06-06 11:34:19,928 - INFO - Best config : {'pos_weight': 8.949837496427758, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-06 11:34:19,928 - INFO - Best trial after optimization: {'eval_loss': 0.11782025545835495, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9796058535575867, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0, 'eval_kappa': 1.0, 'eval_runtime': 3.4585, 'eval_samples_per_second': 19.373, 'eval_steps_per_second': 1.157, 'epoch': 2.914285714285714, 'timestamp': 1749202348, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': 'ffc7be25', 'date': '2025-06-06_11-32-28', 'time_this_iter_s': 45.72027087211609, 'time_total_s': 45.72027087211609, 'pid': 3581718, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 8.949837496427758, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 45.72027087211609, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512'}
2025-06-06 11:34:19,949 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   3.932813  0.936170  ...                        6  9b28a3b5
1   2.073218  0.854701  ...                        5  e083a91b
2   0.117820  1.000000  ...                        3  ffc7be25

[3 rows x 32 columns]
2025-06-06 11:34:20,065 - INFO - Trial comparison plot saved
2025-06-06 11:34:20,066 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-06 11:34:20,723 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-06 11:34:20,808 - INFO - training size : 697
2025-06-06 11:34:20,808 - INFO - dev size : 67
2025-06-06 11:34:20,808 - INFO - test size : 132
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
  0%|          | 0/90 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  1%|          | 1/90 [00:00<00:57,  1.55it/s]  2%|â–         | 2/90 [00:01<00:55,  1.59it/s]  3%|â–Ž         | 3/90 [00:01<00:54,  1.60it/s]  4%|â–         | 4/90 [00:02<00:53,  1.61it/s]  6%|â–Œ         | 5/90 [00:03<00:52,  1.61it/s]  7%|â–‹         | 6/90 [00:03<00:52,  1.61it/s]  8%|â–Š         | 7/90 [00:04<00:51,  1.62it/s]  9%|â–‰         | 8/90 [00:04<00:50,  1.62it/s] 10%|â–ˆ         | 9/90 [00:05<00:50,  1.62it/s] 11%|â–ˆ         | 10/90 [00:06<00:49,  1.62it/s] 12%|â–ˆâ–        | 11/90 [00:06<00:48,  1.62it/s] 13%|â–ˆâ–Ž        | 12/90 [00:07<00:48,  1.62it/s] 14%|â–ˆâ–        | 13/90 [00:08<00:47,  1.62it/s] 16%|â–ˆâ–Œ        | 14/90 [00:08<00:46,  1.62it/s] 17%|â–ˆâ–‹        | 15/90 [00:09<00:46,  1.62it/s] 18%|â–ˆâ–Š        | 16/90 [00:09<00:45,  1.62it/s] 19%|â–ˆâ–‰        | 17/90 [00:10<00:45,  1.62it/s] 20%|â–ˆâ–ˆ        | 18/90 [00:11<00:44,  1.62it/s] 21%|â–ˆâ–ˆ        | 19/90 [00:11<00:43,  1.62it/s] 22%|â–ˆâ–ˆâ–       | 20/90 [00:12<00:43,  1.62it/s] 23%|â–ˆâ–ˆâ–Ž       | 21/90 [00:12<00:42,  1.62it/s] 24%|â–ˆâ–ˆâ–       | 22/90 [00:13<00:41,  1.62it/s] 26%|â–ˆâ–ˆâ–Œ       | 23/90 [00:14<00:41,  1.62it/s] 27%|â–ˆâ–ˆâ–‹       | 24/90 [00:14<00:40,  1.62it/s] 28%|â–ˆâ–ˆâ–Š       | 25/90 [00:15<00:40,  1.62it/s] 29%|â–ˆâ–ˆâ–‰       | 26/90 [00:16<00:39,  1.62it/s] 30%|â–ˆâ–ˆâ–ˆ       | 27/90 [00:16<00:38,  1.62it/s] 31%|â–ˆâ–ˆâ–ˆ       | 28/90 [00:17<00:38,  1.62it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 29/90 [00:17<00:37,  1.64it/s]                                               {'loss': 0.4308, 'grad_norm': 0.13022209703922272, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 30/90 [00:17<00:36,  1.64it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 31/90 [00:18<00:28,  2.04it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 32/90 [00:19<00:30,  1.92it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 33/90 [00:19<00:31,  1.83it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 34/90 [00:20<00:31,  1.77it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 35/90 [00:21<00:31,  1.73it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 36/90 [00:21<00:31,  1.70it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 37/90 [00:22<00:31,  1.67it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 38/90 [00:22<00:31,  1.66it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 39/90 [00:23<00:30,  1.65it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 40/90 [00:24<00:30,  1.64it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 41/90 [00:24<00:29,  1.64it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 42/90 [00:25<00:29,  1.63it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 43/90 [00:25<00:28,  1.63it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 44/90 [00:26<00:28,  1.63it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 45/90 [00:27<00:27,  1.63it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 46/90 [00:27<00:27,  1.63it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 47/90 [00:28<00:26,  1.63it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 48/90 [00:29<00:25,  1.63it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 49/90 [00:29<00:25,  1.63it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 50/90 [00:30<00:24,  1.62it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 51/90 [00:30<00:24,  1.62it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 52/90 [00:31<00:23,  1.62it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 53/90 [00:32<00:22,  1.62it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 54/90 [00:32<00:22,  1.62it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 55/90 [00:33<00:21,  1.62it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 56/90 [00:34<00:20,  1.62it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 57/90 [00:34<00:20,  1.62it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 58/90 [00:35<00:19,  1.62it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 59/90 [00:35<00:18,  1.64it/s]                                               {'loss': 0.002, 'grad_norm': 0.01899046264588833, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 60/90 [00:35<00:18,  1.64it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 61/90 [00:36<00:14,  2.05it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 62/90 [00:37<00:14,  1.93it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 63/90 [00:37<00:14,  1.84it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 64/90 [00:38<00:14,  1.77it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 65/90 [00:38<00:14,  1.73it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 66/90 [00:39<00:14,  1.70it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 67/90 [00:40<00:13,  1.67it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 68/90 [00:40<00:13,  1.66it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 69/90 [00:41<00:12,  1.65it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 70/90 [00:42<00:12,  1.64it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 71/90 [00:42<00:11,  1.63it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 72/90 [00:43<00:11,  1.63it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 73/90 [00:43<00:10,  1.63it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 74/90 [00:44<00:09,  1.62it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 75/90 [00:45<00:09,  1.62it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 76/90 [00:45<00:08,  1.62it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 77/90 [00:46<00:08,  1.62it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 78/90 [00:47<00:07,  1.62it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 79/90 [00:47<00:06,  1.62it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 80/90 [00:48<00:06,  1.62it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 81/90 [00:48<00:05,  1.62it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 82/90 [00:49<00:04,  1.62it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 83/90 [00:50<00:04,  1.62it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 84/90 [00:50<00:03,  1.63it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 85/90 [00:51<00:03,  1.62it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 86/90 [00:51<00:02,  1.63it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 87/90 [00:52<00:01,  1.63it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 88/90 [00:53<00:01,  1.62it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 89/90 [00:53<00:00,  1.64it/s]                                               {'loss': 0.001, 'grad_norm': 0.056364282965660095, 'learning_rate': 0.0, 'epoch': 3.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.64it/s]                                               {'train_runtime': 56.0653, 'train_samples_per_second': 37.296, 'train_steps_per_second': 1.605, 'train_loss': 0.14458468593657017, 'epoch': 3.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.64it/s]2025-06-06 11:35:17,320 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.61it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.29it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.44it/s]2025-06-06 11:35:21,115 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.16s/it]
2025-06-06 11:35:21,121 - INFO - Training time : 61.05538239213638
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.23it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.09it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.40it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.14it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.36it/s]2025-06-06 11:35:25,523 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.46it/s]
2025-06-06 11:35:25,528 - INFO - Evaluation time : 4.406650886870921
2025-06-06 11:35:25,528 - INFO - Evaluation results on test set: {'eval_loss': 0.0016325851902365685, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9997128844261169, 'eval_AP': 0.9999999999999999, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000004, 'eval_kappa': 1.0, 'eval_runtime': 4.4021, 'eval_samples_per_second': 29.985, 'eval_steps_per_second': 1.363, 'epoch': 3.0}
2025-06-06 11:35:25,528 - INFO - Total updates (optimizer steps): 90
2025-06-06 11:35:25,528 - INFO - Avg time / step: 0.623s
2025-06-06 11:35:26,259 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCEdmis-lab/biobert-v1.13trials_fold-3
2025-06-06 11:35:26,259 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.16it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.05it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.39it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.13it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.35it/s]2025-06-06 11:35:30,618 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.48it/s]
2025-06-06 11:35:30,623 - INFO - preds : [1 1 1 1 1 0 1 1 1 0 1 1 1 0 0 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 0 0 1 0 0 1
 1 0 1 1 1 1 0 1 1 0 1 1 1 0 1 0 1 0 1 1 1 1 0 1 1 1 1 1 0 1 0 1 1 1 1 0 0
 1 1 1 1 1 1 0 1 1 1 1 1 0 1 1 0 1 1 1 1 0 1 1 1 1 1 1 0 0 1 1 0 1 1 1 1 0
 0 1 1 1 1 0 1 1 0 0 1 1 1 0 0 1 1 0 1 1 1]
2025-06-06 11:35:30,624 - INFO - test_split["labels"] : [1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1]
2025-06-06 11:35:30,626 - INFO - Confusion matrix: TN=35, FP=0, FN=0, TP=97
2025-06-06 11:35:33,360 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 0.9999999999999999, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 35, 'FP': 0, 'FN': 0, 'TP': 97}
2025-06-06 11:35:33,485 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-06 11:35:33,582 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 11:35:33,582 - INFO - 
On test Set (optimal threshold of 0.9997437596321106 according to cross validation on the training set): 
2025-06-06 11:35:33,583 - INFO - Confusion matrix: TN=35, FP=0, FN=3, TP=94
2025-06-06 11:35:36,370 - INFO - Metrics: {'f1': 0.9842931937172775, 'recall': 0.9690721649484536, 'precision': 1.0, 'accuracy': 0.9772727272727273, 'AP': 0.9999999999999999, 'MCC': 0.944757359175191, 'NDCG': 1.0000000000000004, 'kappa': 0.9432339449541285, 'TN': 35, 'FP': 0, 'FN': 3, 'TP': 94}
2025-06-06 11:35:36,468 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 11:35:36,468 - INFO - Results for fold 3 : [{'f1': 0.9842931937172775, 'recall': 0.9690721649484536, 'precision': 1.0, 'accuracy': 0.9772727272727273, 'AP': 0.9999999999999999, 'MCC': 0.944757359175191, 'NDCG': 1.0000000000000004, 'kappa': 0.9432339449541285, 'TN': 35, 'FP': 0, 'FN': 3, 'TP': 94}]
2025-06-06 11:35:36,581 - INFO - Cleared CUDA cache. Memory allocated: 1.41 GB, Memory reserved: 1.86 GB
2025-06-06 11:35:36,582 - INFO - Cleared CUDA cache. Memory allocated: 1.41 GB, Memory reserved: 1.86 GB
2025-06-06 11:35:36,595 - INFO - Cleared CUDA cache. Memory allocated: 0.97 GB, Memory reserved: 1.75 GB
2025-06-06 11:35:36,609 - INFO - Metrics for dmis-lab/biobert-v1.1:               model_name fold loss_type run  ...    TN   FP   FN    TP
0  dmis-lab/biobert-v1.1    1       BCE   1  ...  34.0  1.0  0.0  98.0
1  dmis-lab/biobert-v1.1    2       BCE   1  ...  34.0  0.0  0.0  98.0
2  dmis-lab/biobert-v1.1    3       BCE   1  ...  34.0  1.0  0.0  97.0
0  dmis-lab/biobert-v1.1    1       BCE   2  ...  35.0  0.0  0.0  98.0
0  dmis-lab/biobert-v1.1    2       BCE   2  ...  34.0  0.0  0.0  98.0
0  dmis-lab/biobert-v1.1    3       BCE   2  ...  35.0  0.0  0.0  97.0

[6 rows x 18 columns]
2025-06-06 11:35:36,609 - INFO - Training model 2/2: google-bert/bert-base-uncased
2025-06-06 11:35:36,774 - INFO - 
fold number 1 / 3
2025-06-06 11:35:36,781 - INFO - train split size : 697
2025-06-06 11:35:36,781 - INFO - dev split size : 66
2025-06-06 11:35:36,781 - INFO - test split size : 133
Map (num_proc=32):   0%|          | 0/697 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 22/697 [00:00<00:07, 91.58 examples/s]Map (num_proc=32):  16%|â–ˆâ–Œ        | 110/697 [00:00<00:01, 357.03 examples/s]Map (num_proc=32):  32%|â–ˆâ–ˆâ–ˆâ–      | 220/697 [00:00<00:00, 567.52 examples/s]Map (num_proc=32):  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 308/697 [00:00<00:00, 638.93 examples/s]Map (num_proc=32):  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 396/697 [00:00<00:00, 688.97 examples/s]Map (num_proc=32):  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 484/697 [00:00<00:00, 719.91 examples/s]Map (num_proc=32):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 571/697 [00:00<00:00, 739.04 examples/s]Map (num_proc=32):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 655/697 [00:01<00:00, 746.83 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 697/697 [00:01<00:00, 574.73 examples/s]
Map (num_proc=32):   0%|          | 0/66 [00:00<?, ? examples/s]Map (num_proc=32):   5%|â–         | 3/66 [00:00<00:03, 16.18 examples/s]Map (num_proc=32):  18%|â–ˆâ–Š        | 12/66 [00:00<00:01, 48.00 examples/s]Map (num_proc=32):  30%|â–ˆâ–ˆâ–ˆ       | 20/66 [00:00<00:00, 57.54 examples/s]Map (num_proc=32):  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 28/66 [00:00<00:00, 62.08 examples/s]Map (num_proc=32):  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 36/66 [00:00<00:00, 66.34 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 44/66 [00:00<00:00, 68.69 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 52/66 [00:00<00:00, 70.76 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 60/66 [00:00<00:00, 72.14 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 66/66 [00:01<00:00, 58.08 examples/s]
Map (num_proc=32):   0%|          | 0/133 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/133 [00:00<00:04, 26.35 examples/s]Map (num_proc=32):  15%|â–ˆâ–Œ        | 20/133 [00:00<00:01, 78.03 examples/s]Map (num_proc=32):  28%|â–ˆâ–ˆâ–Š       | 37/133 [00:00<00:00, 106.03 examples/s]Map (num_proc=32):  40%|â–ˆâ–ˆâ–ˆâ–‰      | 53/133 [00:00<00:00, 122.18 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 69/133 [00:00<00:00, 117.77 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 89/133 [00:00<00:00, 136.71 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 105/133 [00:00<00:00, 135.45 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 121/133 [00:01<00:00, 137.14 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 133/133 [00:01<00:00, 109.97 examples/s]
2025-06-06 11:35:46,379 - INFO - 3 datasets tokenized successfully
2025-06-06 11:35:46,381 - INFO - Starting hyperparameter search for BCE loss
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-06_11-35-46   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-35-46
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-06_10-55-47_424551_3536632/artifacts/2025-06-06_11-35-46/train_hpo_2025-06-06_11-35-46/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-06 11:35:46. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_dbc7df1c   PENDING         8.49369       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_dbc7df1c started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_dbc7df1c config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          8.49369 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3586499)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3586499)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3586499)[0m 2025-06-06 11:35:53,539 - INFO - pos_weight value in TrainingArguments : 8.493688290834637
[36m(train_hpo pid=3586499)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3586499)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3586499)[0m [2025-06-06 11:35:53,791] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3586499)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=48, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3586499)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3586499)[0m   warnings.warn(

Trial train_hpo_4ef73ceb started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_4ef73ceb config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          7.54953 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3586664)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3586664)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3586664)[0m 2025-06-06 11:36:00,306 - INFO - pos_weight value in TrainingArguments : 7.549531688595925
[36m(train_hpo pid=3586664)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3586664)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3586664)[0m [2025-06-06 11:36:00,674] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3586664)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3586664)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3586664)[0m   warnings.warn(

Trial train_hpo_d86a1e1d started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_d86a1e1d config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          8.94984 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3587018)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3587018)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3587018)[0m 2025-06-06 11:36:07,077 - INFO - pos_weight value in TrainingArguments : 8.949837496427758
[36m(train_hpo pid=3587018)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3587018)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3587018)[0m [2025-06-06 11:36:07,320] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3587018)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3587018)[0m   warnings.warn(
[36m(train_hpo pid=3587018)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=24, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 3 RUNNING
Current time: 2025-06-06 11:36:16. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_dbc7df1c   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_4ef73ceb   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_d86a1e1d   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3586499)[0m {'loss': 1.6507, 'grad_norm': 1.4302865266799927, 'learning_rate': 1.246338876535363e-06, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3587018)[0m {'loss': 1.5249, 'grad_norm': 11.85295581817627, 'learning_rate': 5.325452975187489e-05, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3586664)[0m {'loss': 1.5863, 'grad_norm': 1.572162389755249, 'learning_rate': 3.6443132246884782e-06, 'epoch': 0.9142857142857143}
Trial status: 3 RUNNING
Current time: 2025-06-06 11:36:46. Total running time: 1min 0s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_dbc7df1c   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_4ef73ceb   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_d86a1e1d   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3586499)[0m {'loss': 1.6793, 'grad_norm': 7.50558614730835, 'learning_rate': 9.970711012282902e-07, 'epoch': 1.9142857142857141}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3587018)[0m {'train_runtime': 37.863, 'train_samples_per_second': 55.225, 'train_steps_per_second': 0.634, 'train_loss': 0.8076554338137308, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3587018)[0m STATE at ending of training  :  TrainerState(epoch=2.914285714285714, global_step=24, max_steps=24, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=515127765681720.0, log_history=[{'loss': 1.5249, 'grad_norm': 11.85295581817627, 'learning_rate': 5.325452975187489e-05, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.6732, 'grad_norm': 5.221643447875977, 'learning_rate': 2.6627264875937445e-05, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 0.2249, 'grad_norm': 2.5406508445739746, 'learning_rate': 0.0, 'epoch': 2.914285714285714, 'step': 24}, {'train_runtime': 37.863, 'train_samples_per_second': 55.225, 'train_steps_per_second': 0.634, 'total_flos': 515127765681720.0, 'train_loss': 0.8076554338137308, 'epoch': 2.914285714285714, 'step': 24}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_d86a1e1d finished iteration 1 at 2025-06-06 11:36:51. Total running time: 1min 5s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_d86a1e1d result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    45.1234 â”‚
â”‚ time_total_s                        45.1234 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               2.91429 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                                  1 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                             1 â”‚
â”‚ eval_f1                                   1 â”‚
â”‚ eval_kappa                                1 â”‚
â”‚ eval_loss                           0.26092 â”‚
â”‚ eval_optim_threshold                0.95623 â”‚
â”‚ eval_precision                            1 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                          3.305 â”‚
â”‚ eval_samples_per_second               19.97 â”‚
â”‚ eval_steps_per_second                  1.21 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:36:51,782 - INFO - Cleaning up trial d86a1e1d
2025-06-06 11:36:51,782 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-35-46/train_hpo_d86a1e1d_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512_2025-06-06_11-35-59

Trial train_hpo_d86a1e1d completed after 1 iterations at 2025-06-06 11:36:51. Total running time: 1min 5s
[36m(train_hpo pid=3587018)[0m 2025-06-06 11:36:51,715 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3587018)[0m 2025-06-06 11:36:51,721 - INFO - eval_result: {'eval_loss': 0.26091545820236206, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.956230103969574, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.305, 'eval_samples_per_second': 19.97, 'eval_steps_per_second': 1.21, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3587018)[0m 2025-06-06 11:36:51,756 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3587018)[0m {'eval_loss': 0.26091545820236206, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.956230103969574, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.305, 'eval_samples_per_second': 19.97, 'eval_steps_per_second': 1.21, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3586664)[0m {'loss': 1.585, 'grad_norm': 6.578264236450195, 'learning_rate': 2.7332349185163582e-06, 'epoch': 1.9142857142857141}[32m [repeated 2x across cluster][0m

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:37:16. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_dbc7df1c   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_4ef73ceb   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_d86a1e1d   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.1233      0.260915           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3586499)[0m {'loss': 1.6459, 'grad_norm': 2.1240601539611816, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3586664)[0m {'loss': 1.5266, 'grad_norm': 2.319687843322754, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.914285714285714}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:37:46. Total running time: 2min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_dbc7df1c   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_4ef73ceb   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_d86a1e1d   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.1233      0.260915           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3586499)[0m {'loss': 1.6838, 'grad_norm': 4.7741618156433105, 'learning_rate': 4.985355506141451e-07, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3586664)[0m {'loss': 1.4835, 'grad_norm': 3.7174007892608643, 'learning_rate': 9.110783061721196e-07, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3586499)[0m {'loss': 1.6449, 'grad_norm': 12.837248802185059, 'learning_rate': 2.4926777530707256e-07, 'epoch': 4.914285714285715}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:38:16. Total running time: 2min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_dbc7df1c   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_4ef73ceb   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_d86a1e1d   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.1233      0.260915           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3586664)[0m {'loss': 1.3492, 'grad_norm': 9.034699440002441, 'learning_rate': 0.0, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3586664)[0m {'train_runtime': 147.5124, 'train_samples_per_second': 23.625, 'train_steps_per_second': 0.271, 'train_loss': 1.506125259399414, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3586664)[0m STATE at ending of training  :  TrainerState(epoch=4.914285714285715, global_step=40, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=861680969548800.0, log_history=[{'loss': 1.5863, 'grad_norm': 1.572162389755249, 'learning_rate': 3.6443132246884782e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 1.585, 'grad_norm': 6.578264236450195, 'learning_rate': 2.7332349185163582e-06, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 1.5266, 'grad_norm': 2.319687843322754, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 1.4835, 'grad_norm': 3.7174007892608643, 'learning_rate': 9.110783061721196e-07, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 1.3492, 'grad_norm': 9.034699440002441, 'learning_rate': 0.0, 'epoch': 4.914285714285715, 'step': 40}, {'train_runtime': 147.5124, 'train_samples_per_second': 23.625, 'train_steps_per_second': 0.271, 'total_flos': 861680969548800.0, 'train_loss': 1.506125259399414, 'epoch': 4.914285714285715, 'step': 40}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3586664)[0m {'eval_loss': 2.509141445159912, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.6299419403076172, 'eval_AP': 0.997693862125349, 'eval_MCC': 0.0, 'eval_NDCG': 0.9995964369916122, 'eval_kappa': 0.0, 'eval_runtime': 3.8421, 'eval_samples_per_second': 17.178, 'eval_steps_per_second': 1.041, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3586664)[0m 2025-06-06 11:38:35,241 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3586664)[0m 2025-06-06 11:38:35,246 - INFO - eval_result: {'eval_loss': 2.509141445159912, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.6299419403076172, 'eval_AP': 0.997693862125349, 'eval_MCC': 0.0, 'eval_NDCG': 0.9995964369916122, 'eval_kappa': 0.0, 'eval_runtime': 3.8421, 'eval_samples_per_second': 17.178, 'eval_steps_per_second': 1.041, 'epoch': 4.914285714285715}

Trial train_hpo_4ef73ceb finished iteration 1 at 2025-06-06 11:38:35. Total running time: 2min 48s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_4ef73ceb result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    155.444 â”‚
â”‚ time_total_s                        155.444 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               4.91429 â”‚
â”‚ eval_AP                             0.99769 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                            0.9996 â”‚
â”‚ eval_accuracy                       0.74242 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           2.50914 â”‚
â”‚ eval_optim_threshold                0.62994 â”‚
â”‚ eval_precision                      0.74242 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.8421 â”‚
â”‚ eval_samples_per_second              17.178 â”‚
â”‚ eval_steps_per_second                 1.041 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:38:35,313 - INFO - Cleaning up trial 4ef73ceb
2025-06-06 11:38:35,314 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-35-46/train_hpo_4ef73ceb_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-06_11-35-53
2025-06-06 11:38:35,314 - INFO - Current best: d86a1e1d with eval_f1 : 1.0 at iteration 1

Trial train_hpo_4ef73ceb completed after 1 iterations at 2025-06-06 11:38:35. Total running time: 2min 48s
[36m(train_hpo pid=3586664)[0m 2025-06-06 11:38:35,289 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3586499)[0m STATE at ending of training  :  TrainerState(epoch=5.914285714285715, global_step=48, max_steps=48, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=1035096320207160.0, log_history=[{'loss': 1.6507, 'grad_norm': 1.4302865266799927, 'learning_rate': 1.246338876535363e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 1.6793, 'grad_norm': 7.50558614730835, 'learning_rate': 9.970711012282902e-07, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 1.6459, 'grad_norm': 2.1240601539611816, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 1.6838, 'grad_norm': 4.7741618156433105, 'learning_rate': 4.985355506141451e-07, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 1.6449, 'grad_norm': 12.837248802185059, 'learning_rate': 2.4926777530707256e-07, 'epoch': 4.914285714285715, 'step': 40}, {'loss': 1.6297, 'grad_norm': 7.878320217132568, 'learning_rate': 0.0, 'epoch': 5.914285714285715, 'step': 48}, {'train_runtime': 161.0349, 'train_samples_per_second': 25.97, 'train_steps_per_second': 0.298, 'total_flos': 1035096320207160.0, 'train_loss': 1.6557080547014873, 'epoch': 5.914285714285715, 'step': 48}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3586499)[0m {'loss': 1.6297, 'grad_norm': 7.878320217132568, 'learning_rate': 0.0, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3586499)[0m {'train_runtime': 161.0349, 'train_samples_per_second': 25.97, 'train_steps_per_second': 0.298, 'train_loss': 1.6557080547014873, 'epoch': 5.914285714285715}

Trial train_hpo_dbc7df1c finished iteration 1 at 2025-06-06 11:38:41. Total running time: 2min 54s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_dbc7df1c result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    168.307 â”‚
â”‚ time_total_s                        168.307 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               5.91429 â”‚
â”‚ eval_AP                             0.94539 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.98925 â”‚
â”‚ eval_accuracy                       0.74242 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           3.28742 â”‚
â”‚ eval_optim_threshold                0.61702 â”‚
â”‚ eval_precision                      0.74242 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.2226 â”‚
â”‚ eval_samples_per_second              20.481 â”‚
â”‚ eval_steps_per_second                 1.241 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:38:41,387 - INFO - Cleaning up trial dbc7df1c
2025-06-06 11:38:41,387 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-35-46/train_hpo_dbc7df1c_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-06_11-35-46
2025-06-06 11:38:41,387 - INFO - Cleaning up trial 4ef73ceb
2025-06-06 11:38:41,388 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-35-46/train_hpo_4ef73ceb_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-06_11-35-53
2025-06-06 11:38:41,388 - INFO - Current best: d86a1e1d with eval_f1 : 1.0 at iteration 1

Trial train_hpo_dbc7df1c completed after 1 iterations at 2025-06-06 11:38:41. Total running time: 2min 54s
2025-06-06 11:38:41,395	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-35-46' in 0.0054s.

Trial status: 3 TERMINATED
Current time: 2025-06-06 11:38:41. Total running time: 2min 54s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_dbc7df1c   TERMINATED        8.49369       1.49561e-06         0.13641                     6        1           168.307       3.28742     0.852174               1          0.742424 â”‚
â”‚ train_hpo_4ef73ceb   TERMINATED        7.54953       4.55539e-06         0.123031                    5        1           155.444       2.50914     0.852174               1          0.742424 â”‚
â”‚ train_hpo_d86a1e1d   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.1233      0.260915    1                      1          1        â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

2025-06-06 11:38:41,401 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x700d3bf5ddd0>
2025-06-06 11:38:41,401 - INFO - Best trial : train_hpo_d86a1e1d
2025-06-06 11:38:41,401 - INFO - Best config : {'pos_weight': 8.949837496427758, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-06 11:38:41,401 - INFO - Best trial after optimization: {'eval_loss': 0.26091545820236206, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.956230103969574, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.305, 'eval_samples_per_second': 19.97, 'eval_steps_per_second': 1.21, 'epoch': 2.914285714285714, 'timestamp': 1749202611, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': 'd86a1e1d', 'date': '2025-06-06_11-36-51', 'time_this_iter_s': 45.12334871292114, 'time_total_s': 45.12334871292114, 'pid': 3587018, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 8.949837496427758, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 45.12334871292114, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512'}
2025-06-06 11:38:41,421 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   3.287420  0.852174  ...                        6  dbc7df1c
1   2.509141  0.852174  ...                        5  4ef73ceb
2   0.260915  1.000000  ...                        3  d86a1e1d

[3 rows x 32 columns]
[36m(train_hpo pid=3586499)[0m {'eval_loss': 3.2874200344085693, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.617021381855011, 'eval_AP': 0.9453941183257935, 'eval_MCC': 0.0, 'eval_NDCG': 0.9892518608864312, 'eval_kappa': 0.0, 'eval_runtime': 3.2226, 'eval_samples_per_second': 20.481, 'eval_steps_per_second': 1.241, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3586499)[0m 2025-06-06 11:38:41,323 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3586499)[0m 2025-06-06 11:38:41,328 - INFO - eval_result: {'eval_loss': 3.2874200344085693, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.617021381855011, 'eval_AP': 0.9453941183257935, 'eval_MCC': 0.0, 'eval_NDCG': 0.9892518608864312, 'eval_kappa': 0.0, 'eval_runtime': 3.2226, 'eval_samples_per_second': 20.481, 'eval_steps_per_second': 1.241, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3586499)[0m 2025-06-06 11:38:41,364 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
2025-06-06 11:38:41,598 - INFO - Trial comparison plot saved
2025-06-06 11:38:41,599 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-06 11:38:41,801 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-06 11:38:41,907 - INFO - training size : 697
2025-06-06 11:38:41,907 - INFO - dev size : 66
2025-06-06 11:38:41,907 - INFO - test size : 133
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
  0%|          | 0/90 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  1%|          | 1/90 [00:00<00:57,  1.55it/s]  2%|â–         | 2/90 [00:01<00:55,  1.58it/s]  3%|â–Ž         | 3/90 [00:01<00:54,  1.60it/s]  4%|â–         | 4/90 [00:02<00:53,  1.60it/s]  6%|â–Œ         | 5/90 [00:03<00:52,  1.61it/s]  7%|â–‹         | 6/90 [00:03<00:52,  1.61it/s]  8%|â–Š         | 7/90 [00:04<00:51,  1.61it/s]  9%|â–‰         | 8/90 [00:04<00:50,  1.61it/s] 10%|â–ˆ         | 9/90 [00:05<00:50,  1.61it/s] 11%|â–ˆ         | 10/90 [00:06<00:49,  1.61it/s] 12%|â–ˆâ–        | 11/90 [00:06<00:49,  1.61it/s] 13%|â–ˆâ–Ž        | 12/90 [00:07<00:48,  1.61it/s] 14%|â–ˆâ–        | 13/90 [00:08<00:47,  1.61it/s] 16%|â–ˆâ–Œ        | 14/90 [00:08<00:47,  1.61it/s] 17%|â–ˆâ–‹        | 15/90 [00:09<00:46,  1.61it/s] 18%|â–ˆâ–Š        | 16/90 [00:09<00:45,  1.61it/s] 19%|â–ˆâ–‰        | 17/90 [00:10<00:45,  1.61it/s] 20%|â–ˆâ–ˆ        | 18/90 [00:11<00:44,  1.61it/s] 21%|â–ˆâ–ˆ        | 19/90 [00:11<00:44,  1.61it/s] 22%|â–ˆâ–ˆâ–       | 20/90 [00:12<00:43,  1.61it/s] 23%|â–ˆâ–ˆâ–Ž       | 21/90 [00:13<00:42,  1.61it/s] 24%|â–ˆâ–ˆâ–       | 22/90 [00:13<00:42,  1.61it/s] 26%|â–ˆâ–ˆâ–Œ       | 23/90 [00:14<00:41,  1.61it/s] 27%|â–ˆâ–ˆâ–‹       | 24/90 [00:14<00:40,  1.61it/s] 28%|â–ˆâ–ˆâ–Š       | 25/90 [00:15<00:40,  1.61it/s] 29%|â–ˆâ–ˆâ–‰       | 26/90 [00:16<00:39,  1.61it/s] 30%|â–ˆâ–ˆâ–ˆ       | 27/90 [00:16<00:39,  1.61it/s] 31%|â–ˆâ–ˆâ–ˆ       | 28/90 [00:17<00:38,  1.61it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 29/90 [00:18<00:37,  1.62it/s]                                               {'loss': 0.6332, 'grad_norm': 1.950589656829834, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 30/90 [00:18<00:36,  1.62it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 31/90 [00:18<00:29,  2.02it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 32/90 [00:19<00:30,  1.90it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 33/90 [00:19<00:31,  1.82it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 34/90 [00:20<00:31,  1.76it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 35/90 [00:21<00:32,  1.72it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 36/90 [00:21<00:32,  1.69it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 37/90 [00:22<00:31,  1.66it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 38/90 [00:23<00:31,  1.65it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 39/90 [00:23<00:31,  1.64it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 40/90 [00:24<00:30,  1.64it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 41/90 [00:24<00:29,  1.64it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 42/90 [00:25<00:29,  1.64it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 43/90 [00:26<00:28,  1.63it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 44/90 [00:26<00:28,  1.63it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 45/90 [00:27<00:27,  1.63it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 46/90 [00:27<00:27,  1.62it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 47/90 [00:28<00:26,  1.62it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 48/90 [00:29<00:25,  1.62it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 49/90 [00:29<00:25,  1.62it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 50/90 [00:30<00:24,  1.62it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 51/90 [00:31<00:24,  1.62it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 52/90 [00:31<00:23,  1.62it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 53/90 [00:32<00:22,  1.62it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 54/90 [00:32<00:22,  1.62it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 55/90 [00:33<00:21,  1.61it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 56/90 [00:34<00:21,  1.61it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 57/90 [00:34<00:20,  1.61it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 58/90 [00:35<00:19,  1.62it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 59/90 [00:35<00:19,  1.63it/s]                                               {'loss': 0.0099, 'grad_norm': 0.019931863993406296, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 60/90 [00:36<00:18,  1.63it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 61/90 [00:36<00:14,  2.05it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 62/90 [00:37<00:14,  1.92it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 63/90 [00:37<00:14,  1.83it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 64/90 [00:38<00:14,  1.77it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 65/90 [00:39<00:14,  1.72it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 66/90 [00:39<00:14,  1.69it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 67/90 [00:40<00:13,  1.67it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 68/90 [00:41<00:13,  1.66it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 69/90 [00:41<00:12,  1.64it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 70/90 [00:42<00:12,  1.64it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 71/90 [00:42<00:11,  1.63it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 72/90 [00:43<00:11,  1.63it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 73/90 [00:44<00:10,  1.63it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 74/90 [00:44<00:09,  1.62it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 75/90 [00:45<00:09,  1.62it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 76/90 [00:45<00:08,  1.62it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 77/90 [00:46<00:08,  1.62it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 78/90 [00:47<00:07,  1.61it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 79/90 [00:47<00:06,  1.61it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 80/90 [00:48<00:06,  1.62it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 81/90 [00:49<00:05,  1.62it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 82/90 [00:49<00:04,  1.62it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 83/90 [00:50<00:04,  1.62it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 84/90 [00:50<00:03,  1.62it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 85/90 [00:51<00:03,  1.62it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 86/90 [00:52<00:02,  1.62it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 87/90 [00:52<00:01,  1.62it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 88/90 [00:53<00:01,  1.62it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 89/90 [00:53<00:00,  1.63it/s]                                               {'loss': 0.0013, 'grad_norm': 0.0639999657869339, 'learning_rate': 0.0, 'epoch': 3.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.63it/s]                                               {'train_runtime': 56.1499, 'train_samples_per_second': 37.24, 'train_steps_per_second': 1.603, 'train_loss': 0.2148112195233504, 'epoch': 3.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.63it/s]2025-06-06 11:39:38,496 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.60it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.26it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.61it/s]2025-06-06 11:39:42,335 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.18s/it]
2025-06-06 11:39:42,341 - INFO - Training time : 60.742234748089686
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.13it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.01it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.33it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.07it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.22it/s]2025-06-06 11:39:47,015 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.37it/s]
2025-06-06 11:39:47,020 - INFO - Evaluation time : 4.679172498872504
2025-06-06 11:39:47,020 - INFO - Evaluation results on test set: {'eval_loss': 0.002070849062874913, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.999680757522583, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000004, 'eval_kappa': 1.0, 'eval_runtime': 4.6748, 'eval_samples_per_second': 28.45, 'eval_steps_per_second': 1.283, 'epoch': 3.0}
2025-06-06 11:39:47,020 - INFO - Total updates (optimizer steps): 90
2025-06-06 11:39:47,020 - INFO - Avg time / step: 0.624s
2025-06-06 11:39:47,639 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCEgoogle-bert/bert-base-uncased3trials_fold-1
2025-06-06 11:39:47,639 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.12it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.02it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.34it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.09it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.23it/s]2025-06-06 11:39:52,248 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.39it/s]
2025-06-06 11:39:52,253 - INFO - preds : [1 0 0 0 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 0 1 1 0 1 1 1 0 1 0 1 1 1 1 1 1
 1 1 1 0 0 1 0 1 1 0 1 1 1 1 0 0 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 0 0
 1 1 0 1 0 0 0 1 1 1 1 1 1 0 1 1 1 1 0 1 1 0 1 1 1 0 0 1 0 0 1 1 1 1 1 0 0
 0 1 1 1 1 1 0 1 0 1 1 1 1 1 1 1 0 1 1 1 1 0]
2025-06-06 11:39:52,254 - INFO - test_split["labels"] : [1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0]
2025-06-06 11:39:52,255 - INFO - Confusion matrix: TN=35, FP=0, FN=0, TP=98
2025-06-06 11:39:54,984 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 35, 'FP': 0, 'FN': 0, 'TP': 98}
2025-06-06 11:39:55,114 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-06 11:39:55,216 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 11:39:55,216 - INFO - 
On test Set (optimal threshold of 0.9996901750564575 according to cross validation on the training set): 
2025-06-06 11:39:55,217 - INFO - Confusion matrix: TN=35, FP=0, FN=4, TP=94
2025-06-06 11:39:57,970 - INFO - Metrics: {'f1': 0.9791666666666666, 'recall': 0.9591836734693877, 'precision': 1.0, 'accuracy': 0.9699248120300752, 'AP': 1.0, 'MCC': 0.9277962388401134, 'NDCG': 1.0000000000000004, 'kappa': 0.9251968503937008, 'TN': 35, 'FP': 0, 'FN': 4, 'TP': 94}
2025-06-06 11:39:58,075 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 11:39:58,075 - INFO - Results for fold 1 : [{'f1': 0.9791666666666666, 'recall': 0.9591836734693877, 'precision': 1.0, 'accuracy': 0.9699248120300752, 'AP': 1.0, 'MCC': 0.9277962388401134, 'NDCG': 1.0000000000000004, 'kappa': 0.9251968503937008, 'TN': 35, 'FP': 0, 'FN': 4, 'TP': 94}]
2025-06-06 11:39:58,196 - INFO - Cleared CUDA cache. Memory allocated: 1.43 GB, Memory reserved: 1.87 GB
2025-06-06 11:39:58,196 - INFO - 
fold number 2 / 3
2025-06-06 11:39:58,203 - INFO - train split size : 697
2025-06-06 11:39:58,203 - INFO - dev split size : 67
2025-06-06 11:39:58,203 - INFO - test split size : 132
Map (num_proc=32):   0%|          | 0/697 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 22/697 [00:00<00:06, 100.71 examples/s]Map (num_proc=32):  16%|â–ˆâ–Œ        | 110/697 [00:00<00:01, 387.98 examples/s]Map (num_proc=32):  32%|â–ˆâ–ˆâ–ˆâ–      | 220/697 [00:00<00:00, 627.60 examples/s]Map (num_proc=32):  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 330/697 [00:00<00:00, 696.53 examples/s]Map (num_proc=32):  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 418/697 [00:00<00:00, 713.43 examples/s]Map (num_proc=32):  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 506/697 [00:00<00:00, 758.73 examples/s]Map (num_proc=32):  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 592/697 [00:00<00:00, 766.39 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 697/697 [00:01<00:00, 819.51 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 697/697 [00:01<00:00, 606.89 examples/s]
Map (num_proc=32):   0%|          | 0/67 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/67 [00:00<00:03, 16.94 examples/s]Map (num_proc=32):  19%|â–ˆâ–‰        | 13/67 [00:00<00:01, 53.17 examples/s]Map (num_proc=32):  31%|â–ˆâ–ˆâ–ˆâ–      | 21/67 [00:00<00:00, 63.07 examples/s]Map (num_proc=32):  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 29/67 [00:00<00:00, 63.04 examples/s]Map (num_proc=32):  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 39/67 [00:00<00:00, 72.23 examples/s]Map (num_proc=32):  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 47/67 [00:00<00:00, 73.54 examples/s]Map (num_proc=32):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 55/67 [00:00<00:00, 74.72 examples/s]Map (num_proc=32):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 63/67 [00:00<00:00, 75.62 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:01<00:00, 60.94 examples/s]
Map (num_proc=32):   0%|          | 0/132 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/132 [00:00<00:04, 26.58 examples/s]Map (num_proc=32):  18%|â–ˆâ–Š        | 24/132 [00:00<00:01, 93.22 examples/s]Map (num_proc=32):  30%|â–ˆâ–ˆâ–ˆ       | 40/132 [00:00<00:00, 115.48 examples/s]Map (num_proc=32):  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 56/132 [00:00<00:00, 126.45 examples/s]Map (num_proc=32):  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 72/132 [00:00<00:00, 136.91 examples/s]Map (num_proc=32):  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 92/132 [00:00<00:00, 145.91 examples/s]Map (num_proc=32):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 108/132 [00:00<00:00, 146.84 examples/s]Map (num_proc=32):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 124/132 [00:00<00:00, 150.09 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 132/132 [00:01<00:00, 117.89 examples/s]
2025-06-06 11:40:07,511 - INFO - 3 datasets tokenized successfully
2025-06-06 11:40:07,513 - INFO - Starting hyperparameter search for BCE loss
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-06_11-40-07   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-40-07
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-06_10-55-47_424551_3536632/artifacts/2025-06-06_11-40-07/train_hpo_2025-06-06_11-40-07/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-06 11:40:07. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_48acd5a8   PENDING         8.49369       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_48acd5a8 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_48acd5a8 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          8.49369 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3591542)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3591542)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3591542)[0m 2025-06-06 11:40:14,755 - INFO - pos_weight value in TrainingArguments : 8.493688290834637
[36m(train_hpo pid=3591542)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3591542)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3591542)[0m [2025-06-06 11:40:15,009] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3591542)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=48, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3591542)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3591542)[0m   warnings.warn(

Trial train_hpo_8e5b0231 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_8e5b0231 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          7.54953 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3591777)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3591777)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3591777)[0m 2025-06-06 11:40:21,516 - INFO - pos_weight value in TrainingArguments : 7.549531688595925
[36m(train_hpo pid=3591777)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3591777)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3591777)[0m [2025-06-06 11:40:21,836] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3591777)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3591777)[0m   warnings.warn(
[36m(train_hpo pid=3591777)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_2bb7764f started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_2bb7764f config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          8.94984 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3592059)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3592059)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3592059)[0m 2025-06-06 11:40:28,190 - INFO - pos_weight value in TrainingArguments : 8.949837496427758
[36m(train_hpo pid=3592059)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3592059)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3592059)[0m [2025-06-06 11:40:28,440] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3592059)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3592059)[0m   warnings.warn(
[36m(train_hpo pid=3592059)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=24, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 3 RUNNING
Current time: 2025-06-06 11:40:37. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_48acd5a8   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_8e5b0231   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_2bb7764f   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3591542)[0m {'loss': 1.675, 'grad_norm': 3.423583745956421, 'learning_rate': 1.246338876535363e-06, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3592059)[0m {'loss': 1.2186, 'grad_norm': 7.495275020599365, 'learning_rate': 5.325452975187489e-05, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3591777)[0m {'loss': 1.5809, 'grad_norm': 2.114103317260742, 'learning_rate': 3.6443132246884782e-06, 'epoch': 0.9142857142857143}
Trial status: 3 RUNNING
Current time: 2025-06-06 11:41:07. Total running time: 1min 0s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_48acd5a8   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_8e5b0231   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_2bb7764f   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3591542)[0m {'loss': 1.6643, 'grad_norm': 5.709364414215088, 'learning_rate': 9.970711012282902e-07, 'epoch': 1.9142857142857141}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3592059)[0m {'train_runtime': 37.9205, 'train_samples_per_second': 55.142, 'train_steps_per_second': 0.633, 'train_loss': 0.5341119840741158, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3592059)[0m STATE at ending of training  :  TrainerState(epoch=2.914285714285714, global_step=24, max_steps=24, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=515261375564880.0, log_history=[{'loss': 1.2186, 'grad_norm': 7.495275020599365, 'learning_rate': 5.325452975187489e-05, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.2793, 'grad_norm': 2.8780722618103027, 'learning_rate': 2.6627264875937445e-05, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 0.1045, 'grad_norm': 1.192940354347229, 'learning_rate': 0.0, 'epoch': 2.914285714285714, 'step': 24}, {'train_runtime': 37.9205, 'train_samples_per_second': 55.142, 'train_steps_per_second': 0.633, 'total_flos': 515261375564880.0, 'train_loss': 0.5341119840741158, 'epoch': 2.914285714285714, 'step': 24}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3592059)[0m 2025-06-06 11:41:13,138 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3592059)[0m 2025-06-06 11:41:13,143 - INFO - eval_result: {'eval_loss': 0.1575271189212799, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9738205671310425, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.5493, 'eval_samples_per_second': 18.877, 'eval_steps_per_second': 1.127, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3592059)[0m {'eval_loss': 0.1575271189212799, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9738205671310425, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.5493, 'eval_samples_per_second': 18.877, 'eval_steps_per_second': 1.127, 'epoch': 2.914285714285714}

Trial train_hpo_2bb7764f finished iteration 1 at 2025-06-06 11:41:13. Total running time: 1min 5s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_2bb7764f result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    45.4454 â”‚
â”‚ time_total_s                        45.4454 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               2.91429 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                                  1 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                             1 â”‚
â”‚ eval_f1                                   1 â”‚
â”‚ eval_kappa                                1 â”‚
â”‚ eval_loss                           0.15753 â”‚
â”‚ eval_optim_threshold                0.97382 â”‚
â”‚ eval_precision                            1 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.5493 â”‚
â”‚ eval_samples_per_second              18.877 â”‚
â”‚ eval_steps_per_second                 1.127 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:41:13,206 - INFO - Cleaning up trial 2bb7764f
2025-06-06 11:41:13,206 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-40-07/train_hpo_2bb7764f_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512_2025-06-06_11-40-21

Trial train_hpo_2bb7764f completed after 1 iterations at 2025-06-06 11:41:13. Total running time: 1min 5s
[36m(train_hpo pid=3592059)[0m 2025-06-06 11:41:13,181 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3591777)[0m {'loss': 1.5553, 'grad_norm': 4.903848171234131, 'learning_rate': 2.7332349185163582e-06, 'epoch': 1.9142857142857141}[32m [repeated 2x across cluster][0m

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:41:37. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_48acd5a8   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_8e5b0231   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_2bb7764f   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.4454      0.157527           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3591542)[0m {'loss': 1.6496, 'grad_norm': 1.7616455554962158, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3591777)[0m {'loss': 1.5369, 'grad_norm': 2.519897222518921, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.914285714285714}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:42:07. Total running time: 2min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_48acd5a8   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_8e5b0231   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_2bb7764f   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.4454      0.157527           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3591542)[0m {'loss': 1.6669, 'grad_norm': 2.364187479019165, 'learning_rate': 4.985355506141451e-07, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3591777)[0m {'loss': 1.49, 'grad_norm': 2.945283889770508, 'learning_rate': 9.110783061721196e-07, 'epoch': 3.914285714285714}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:42:38. Total running time: 2min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_48acd5a8   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_8e5b0231   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_2bb7764f   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.4454      0.157527           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3591542)[0m {'loss': 1.6334, 'grad_norm': 10.065144538879395, 'learning_rate': 2.4926777530707256e-07, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3591777)[0m {'loss': 1.3895, 'grad_norm': 10.741687774658203, 'learning_rate': 0.0, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3591777)[0m {'train_runtime': 147.6096, 'train_samples_per_second': 23.61, 'train_steps_per_second': 0.271, 'train_loss': 1.5104985237121582, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3591777)[0m STATE at ending of training  :  TrainerState(epoch=4.914285714285715, global_step=40, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=861609025765560.0, log_history=[{'loss': 1.5809, 'grad_norm': 2.114103317260742, 'learning_rate': 3.6443132246884782e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 1.5553, 'grad_norm': 4.903848171234131, 'learning_rate': 2.7332349185163582e-06, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 1.5369, 'grad_norm': 2.519897222518921, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 1.49, 'grad_norm': 2.945283889770508, 'learning_rate': 9.110783061721196e-07, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 1.3895, 'grad_norm': 10.741687774658203, 'learning_rate': 0.0, 'epoch': 4.914285714285715, 'step': 40}, {'train_runtime': 147.6096, 'train_samples_per_second': 23.61, 'train_steps_per_second': 0.271, 'total_flos': 861609025765560.0, 'train_loss': 1.5104985237121582, 'epoch': 4.914285714285715, 'step': 40}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3591777)[0m 2025-06-06 11:42:56,566 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3591777)[0m 2025-06-06 11:42:56,572 - INFO - eval_result: {'eval_loss': 2.753889322280884, 'eval_f1': 0.8347826086956521, 'eval_recall': 0.9795918367346939, 'eval_accuracy': 0.7164179104477612, 'eval_precision': 0.7272727272727273, 'eval_optim_threshold': 0.6211515069007874, 'eval_AP': 0.9855753362810689, 'eval_MCC': -0.07460470969529907, 'eval_NDCG': 0.9973431703842793, 'eval_kappa': -0.029102667744543398, 'eval_runtime': 3.9032, 'eval_samples_per_second': 17.166, 'eval_steps_per_second': 1.025, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3591777)[0m 2025-06-06 11:42:56,610 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3591777)[0m {'eval_loss': 2.753889322280884, 'eval_f1': 0.8347826086956521, 'eval_recall': 0.9795918367346939, 'eval_accuracy': 0.7164179104477612, 'eval_precision': 0.7272727272727273, 'eval_optim_threshold': 0.6211515069007874, 'eval_AP': 0.9855753362810689, 'eval_MCC': -0.07460470969529907, 'eval_NDCG': 0.9973431703842793, 'eval_kappa': -0.029102667744543398, 'eval_runtime': 3.9032, 'eval_samples_per_second': 17.166, 'eval_steps_per_second': 1.025, 'epoch': 4.914285714285715}

Trial train_hpo_8e5b0231 finished iteration 1 at 2025-06-06 11:42:56. Total running time: 2min 49s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_8e5b0231 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    155.545 â”‚
â”‚ time_total_s                        155.545 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               4.91429 â”‚
â”‚ eval_AP                             0.98558 â”‚
â”‚ eval_MCC                            -0.0746 â”‚
â”‚ eval_NDCG                           0.99734 â”‚
â”‚ eval_accuracy                       0.71642 â”‚
â”‚ eval_f1                             0.83478 â”‚
â”‚ eval_kappa                          -0.0291 â”‚
â”‚ eval_loss                           2.75389 â”‚
â”‚ eval_optim_threshold                0.62115 â”‚
â”‚ eval_precision                      0.72727 â”‚
â”‚ eval_recall                         0.97959 â”‚
â”‚ eval_runtime                         3.9032 â”‚
â”‚ eval_samples_per_second              17.166 â”‚
â”‚ eval_steps_per_second                 1.025 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:42:56,633 - INFO - Cleaning up trial 8e5b0231
2025-06-06 11:42:56,633 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-40-07/train_hpo_8e5b0231_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-06_11-40-14
2025-06-06 11:42:56,633 - INFO - Current best: 2bb7764f with eval_f1 : 1.0 at iteration 1

Trial train_hpo_8e5b0231 completed after 1 iterations at 2025-06-06 11:42:56. Total running time: 2min 49s
[36m(train_hpo pid=3591542)[0m STATE at ending of training  :  TrainerState(epoch=5.914285714285715, global_step=48, max_steps=48, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=1035188819357040.0, log_history=[{'loss': 1.675, 'grad_norm': 3.423583745956421, 'learning_rate': 1.246338876535363e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 1.6643, 'grad_norm': 5.709364414215088, 'learning_rate': 9.970711012282902e-07, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 1.6496, 'grad_norm': 1.7616455554962158, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 1.6669, 'grad_norm': 2.364187479019165, 'learning_rate': 4.985355506141451e-07, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 1.6334, 'grad_norm': 10.065144538879395, 'learning_rate': 2.4926777530707256e-07, 'epoch': 4.914285714285715, 'step': 40}, {'loss': 1.6496, 'grad_norm': 6.822864532470703, 'learning_rate': 0.0, 'epoch': 5.914285714285715, 'step': 48}, {'train_runtime': 161.2006, 'train_samples_per_second': 25.943, 'train_steps_per_second': 0.298, 'total_flos': 1035188819357040.0, 'train_loss': 1.6564773122469585, 'epoch': 5.914285714285715, 'step': 48}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3591542)[0m {'loss': 1.6496, 'grad_norm': 6.822864532470703, 'learning_rate': 0.0, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3591542)[0m {'train_runtime': 161.2006, 'train_samples_per_second': 25.943, 'train_steps_per_second': 0.298, 'train_loss': 1.6564773122469585, 'epoch': 5.914285714285715}

Trial train_hpo_48acd5a8 finished iteration 1 at 2025-06-06 11:43:02. Total running time: 2min 55s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_48acd5a8 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    168.473 â”‚
â”‚ time_total_s                        168.473 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               5.91429 â”‚
â”‚ eval_AP                             0.96736 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.99354 â”‚
â”‚ eval_accuracy                       0.73134 â”‚
â”‚ eval_f1                             0.84483 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                            2.9797 â”‚
â”‚ eval_optim_threshold                0.64394 â”‚
â”‚ eval_precision                      0.73134 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.2577 â”‚
â”‚ eval_samples_per_second              20.566 â”‚
â”‚ eval_steps_per_second                 1.228 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:43:02,741 - INFO - Cleaning up trial 48acd5a8
2025-06-06 11:43:02,741 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-40-07/train_hpo_48acd5a8_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-06_11-40-07
2025-06-06 11:43:02,741 - INFO - Cleaning up trial 8e5b0231
2025-06-06 11:43:02,741 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-40-07/train_hpo_8e5b0231_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-06_11-40-14
2025-06-06 11:43:02,742 - INFO - Current best: 2bb7764f with eval_f1 : 1.0 at iteration 1

Trial train_hpo_48acd5a8 completed after 1 iterations at 2025-06-06 11:43:02. Total running time: 2min 55s
2025-06-06 11:43:02,748	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-40-07' in 0.0052s.

Trial status: 3 TERMINATED
Current time: 2025-06-06 11:43:02. Total running time: 2min 55s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_48acd5a8   TERMINATED        8.49369       1.49561e-06         0.13641                     6        1           168.473       2.9797      0.844828        1                 0.731343 â”‚
â”‚ train_hpo_8e5b0231   TERMINATED        7.54953       4.55539e-06         0.123031                    5        1           155.545       2.75389     0.834783        0.979592          0.716418 â”‚
â”‚ train_hpo_2bb7764f   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.4454      0.157527    1               1                 1        â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

2025-06-06 11:43:02,756 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x700d4c11b010>
2025-06-06 11:43:02,756 - INFO - Best trial : train_hpo_2bb7764f
2025-06-06 11:43:02,756 - INFO - Best config : {'pos_weight': 8.949837496427758, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-06 11:43:02,756 - INFO - Best trial after optimization: {'eval_loss': 0.1575271189212799, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9738205671310425, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.5493, 'eval_samples_per_second': 18.877, 'eval_steps_per_second': 1.127, 'epoch': 2.914285714285714, 'timestamp': 1749202873, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '2bb7764f', 'date': '2025-06-06_11-41-13', 'time_this_iter_s': 45.44539976119995, 'time_total_s': 45.44539976119995, 'pid': 3592059, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 8.949837496427758, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 45.44539976119995, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512'}
2025-06-06 11:43:02,778 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   2.979703  0.844828  ...                        6  48acd5a8
1   2.753889  0.834783  ...                        5  8e5b0231
2   0.157527  1.000000  ...                        3  2bb7764f

[3 rows x 32 columns]
[36m(train_hpo pid=3591542)[0m {'eval_loss': 2.979703187942505, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.6439439058303833, 'eval_AP': 0.9673618637403871, 'eval_MCC': 0.0, 'eval_NDCG': 0.9935356324214534, 'eval_kappa': 0.0, 'eval_runtime': 3.2577, 'eval_samples_per_second': 20.566, 'eval_steps_per_second': 1.228, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3591542)[0m 2025-06-06 11:43:02,677 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3591542)[0m 2025-06-06 11:43:02,682 - INFO - eval_result: {'eval_loss': 2.979703187942505, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.6439439058303833, 'eval_AP': 0.9673618637403871, 'eval_MCC': 0.0, 'eval_NDCG': 0.9935356324214534, 'eval_kappa': 0.0, 'eval_runtime': 3.2577, 'eval_samples_per_second': 20.566, 'eval_steps_per_second': 1.228, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3591542)[0m 2025-06-06 11:43:02,717 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
2025-06-06 11:43:02,968 - INFO - Trial comparison plot saved
2025-06-06 11:43:02,968 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-06 11:43:03,246 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-06 11:43:03,356 - INFO - training size : 697
2025-06-06 11:43:03,357 - INFO - dev size : 67
2025-06-06 11:43:03,357 - INFO - test size : 132
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
  0%|          | 0/90 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  1%|          | 1/90 [00:00<00:57,  1.54it/s]  2%|â–         | 2/90 [00:01<00:55,  1.58it/s]  3%|â–Ž         | 3/90 [00:01<00:54,  1.60it/s]  4%|â–         | 4/90 [00:02<00:53,  1.60it/s]  6%|â–Œ         | 5/90 [00:03<00:53,  1.60it/s]  7%|â–‹         | 6/90 [00:03<00:52,  1.60it/s]  8%|â–Š         | 7/90 [00:04<00:51,  1.61it/s]  9%|â–‰         | 8/90 [00:04<00:51,  1.61it/s] 10%|â–ˆ         | 9/90 [00:05<00:50,  1.61it/s] 11%|â–ˆ         | 10/90 [00:06<00:49,  1.61it/s] 12%|â–ˆâ–        | 11/90 [00:06<00:49,  1.61it/s] 13%|â–ˆâ–Ž        | 12/90 [00:07<00:48,  1.61it/s] 14%|â–ˆâ–        | 13/90 [00:08<00:47,  1.61it/s] 16%|â–ˆâ–Œ        | 14/90 [00:08<00:47,  1.62it/s] 17%|â–ˆâ–‹        | 15/90 [00:09<00:46,  1.61it/s] 18%|â–ˆâ–Š        | 16/90 [00:09<00:45,  1.61it/s] 19%|â–ˆâ–‰        | 17/90 [00:10<00:45,  1.61it/s] 20%|â–ˆâ–ˆ        | 18/90 [00:11<00:44,  1.62it/s] 21%|â–ˆâ–ˆ        | 19/90 [00:11<00:43,  1.62it/s] 22%|â–ˆâ–ˆâ–       | 20/90 [00:12<00:43,  1.61it/s] 23%|â–ˆâ–ˆâ–Ž       | 21/90 [00:13<00:42,  1.61it/s] 24%|â–ˆâ–ˆâ–       | 22/90 [00:13<00:42,  1.62it/s] 26%|â–ˆâ–ˆâ–Œ       | 23/90 [00:14<00:41,  1.62it/s] 27%|â–ˆâ–ˆâ–‹       | 24/90 [00:14<00:40,  1.62it/s] 28%|â–ˆâ–ˆâ–Š       | 25/90 [00:15<00:40,  1.62it/s] 29%|â–ˆâ–ˆâ–‰       | 26/90 [00:16<00:39,  1.62it/s] 30%|â–ˆâ–ˆâ–ˆ       | 27/90 [00:16<00:38,  1.62it/s] 31%|â–ˆâ–ˆâ–ˆ       | 28/90 [00:17<00:38,  1.62it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 29/90 [00:17<00:37,  1.63it/s]                                               {'loss': 0.7226, 'grad_norm': 0.5563077330589294, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 30/90 [00:18<00:36,  1.63it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 31/90 [00:18<00:28,  2.04it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 32/90 [00:19<00:30,  1.92it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 33/90 [00:19<00:31,  1.83it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 34/90 [00:20<00:31,  1.77it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 35/90 [00:21<00:31,  1.72it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 36/90 [00:21<00:31,  1.69it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 37/90 [00:22<00:31,  1.67it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 38/90 [00:22<00:31,  1.65it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 39/90 [00:23<00:31,  1.64it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 40/90 [00:24<00:30,  1.64it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 41/90 [00:24<00:30,  1.63it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 42/90 [00:25<00:29,  1.64it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 43/90 [00:26<00:28,  1.63it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 44/90 [00:26<00:28,  1.62it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 45/90 [00:27<00:27,  1.62it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 46/90 [00:27<00:27,  1.62it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 47/90 [00:28<00:26,  1.62it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 48/90 [00:29<00:25,  1.62it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 49/90 [00:29<00:25,  1.62it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 50/90 [00:30<00:24,  1.62it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 51/90 [00:31<00:24,  1.61it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 52/90 [00:31<00:23,  1.62it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 53/90 [00:32<00:22,  1.61it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 54/90 [00:32<00:22,  1.61it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 55/90 [00:33<00:21,  1.61it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 56/90 [00:34<00:21,  1.61it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 57/90 [00:34<00:20,  1.61it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 58/90 [00:35<00:19,  1.61it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 59/90 [00:35<00:19,  1.63it/s]                                               {'loss': 0.0081, 'grad_norm': 0.016823716461658478, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 60/90 [00:36<00:18,  1.63it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 61/90 [00:36<00:14,  2.05it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 62/90 [00:37<00:14,  1.92it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 63/90 [00:37<00:14,  1.83it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 64/90 [00:38<00:14,  1.77it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 65/90 [00:39<00:14,  1.72it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 66/90 [00:39<00:14,  1.69it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 67/90 [00:40<00:13,  1.67it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 68/90 [00:40<00:13,  1.66it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 69/90 [00:41<00:12,  1.65it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 70/90 [00:42<00:12,  1.64it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 71/90 [00:42<00:11,  1.63it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 72/90 [00:43<00:11,  1.62it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 73/90 [00:44<00:10,  1.62it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 74/90 [00:44<00:09,  1.62it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 75/90 [00:45<00:09,  1.62it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 76/90 [00:45<00:08,  1.62it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 77/90 [00:46<00:08,  1.62it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 78/90 [00:47<00:07,  1.61it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 79/90 [00:47<00:06,  1.62it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 80/90 [00:48<00:06,  1.62it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 81/90 [00:49<00:05,  1.62it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 82/90 [00:49<00:04,  1.62it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 83/90 [00:50<00:04,  1.62it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 84/90 [00:50<00:03,  1.62it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 85/90 [00:51<00:03,  1.62it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 86/90 [00:52<00:02,  1.62it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 87/90 [00:52<00:01,  1.62it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 88/90 [00:53<00:01,  1.62it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 89/90 [00:53<00:00,  1.63it/s]                                               {'loss': 0.0019, 'grad_norm': 0.10191147029399872, 'learning_rate': 0.0, 'epoch': 3.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.63it/s]                                               {'train_runtime': 56.3556, 'train_samples_per_second': 37.104, 'train_steps_per_second': 1.597, 'train_loss': 0.24421720227433574, 'epoch': 3.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.63it/s]2025-06-06 11:44:00,184 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.60it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.18it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.36it/s]2025-06-06 11:44:04,155 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.22s/it]
2025-06-06 11:44:04,161 - INFO - Training time : 61.19297788105905
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.09it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.02it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.35it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.10it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.32it/s]2025-06-06 11:44:08,692 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.42it/s]
2025-06-06 11:44:08,697 - INFO - Evaluation time : 4.535910406848416
2025-06-06 11:44:08,697 - INFO - Evaluation results on test set: {'eval_loss': 0.002639876212924719, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9995496869087219, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000004, 'eval_kappa': 1.0, 'eval_runtime': 4.5317, 'eval_samples_per_second': 29.128, 'eval_steps_per_second': 1.324, 'epoch': 3.0}
2025-06-06 11:44:08,697 - INFO - Total updates (optimizer steps): 90
2025-06-06 11:44:08,697 - INFO - Avg time / step: 0.626s
2025-06-06 11:44:09,406 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCEgoogle-bert/bert-base-uncased3trials_fold-2
2025-06-06 11:44:09,406 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.16it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.03it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.37it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.11it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.33it/s]2025-06-06 11:44:14,028 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.39it/s]
2025-06-06 11:44:14,033 - INFO - preds : [1 1 0 1 0 0 1 1 1 1 1 0 1 0 1 0 0 0 1 1 1 0 1 1 1 1 1 0 1 1 1 0 1 0 1 1 1
 0 1 1 1 0 1 0 1 0 0 1 1 1 1 1 0 1 1 1 1 1 0 1 0 1 1 0 1 1 1 1 0 1 1 1 0 1
 1 1 1 1 0 1 1 0 0 1 0 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 0 1 0 1 1 1 0 1 1 1 1
 1 1 1 1 1 0 1 1 1 1 1 0 1 1 1 1 1 1 0 1 1]
2025-06-06 11:44:14,034 - INFO - test_split["labels"] : [1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1]
2025-06-06 11:44:14,035 - INFO - Confusion matrix: TN=34, FP=0, FN=0, TP=98
2025-06-06 11:44:16,752 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 34, 'FP': 0, 'FN': 0, 'TP': 98}
2025-06-06 11:44:16,871 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-06 11:44:16,968 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 11:44:16,968 - INFO - 
On test Set (optimal threshold of 0.9995988011360168 according to cross validation on the training set): 
2025-06-06 11:44:16,970 - INFO - Confusion matrix: TN=34, FP=0, FN=3, TP=95
2025-06-06 11:44:19,697 - INFO - Metrics: {'f1': 0.9844559585492227, 'recall': 0.9693877551020408, 'precision': 1.0, 'accuracy': 0.9772727272727273, 'AP': 1.0, 'MCC': 0.9438160561950645, 'NDCG': 1.0000000000000004, 'kappa': 0.9422403733955659, 'TN': 34, 'FP': 0, 'FN': 3, 'TP': 95}
2025-06-06 11:44:19,795 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 11:44:19,795 - INFO - Results for fold 2 : [{'f1': 0.9844559585492227, 'recall': 0.9693877551020408, 'precision': 1.0, 'accuracy': 0.9772727272727273, 'AP': 1.0, 'MCC': 0.9438160561950645, 'NDCG': 1.0000000000000004, 'kappa': 0.9422403733955659, 'TN': 34, 'FP': 0, 'FN': 3, 'TP': 95}]
2025-06-06 11:44:19,914 - INFO - Cleared CUDA cache. Memory allocated: 1.42 GB, Memory reserved: 1.82 GB
2025-06-06 11:44:19,914 - INFO - 
fold number 3 / 3
2025-06-06 11:44:19,921 - INFO - train split size : 697
2025-06-06 11:44:19,921 - INFO - dev split size : 67
2025-06-06 11:44:19,921 - INFO - test split size : 132
Map (num_proc=32):   0%|          | 0/697 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 22/697 [00:00<00:06, 103.31 examples/s]Map (num_proc=32):  19%|â–ˆâ–‰        | 132/697 [00:00<00:01, 468.27 examples/s]Map (num_proc=32):  32%|â–ˆâ–ˆâ–ˆâ–      | 220/697 [00:00<00:00, 610.14 examples/s]Map (num_proc=32):  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 352/697 [00:00<00:00, 774.42 examples/s]Map (num_proc=32):  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 440/697 [00:00<00:00, 787.89 examples/s]Map (num_proc=32):  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 528/697 [00:00<00:00, 803.71 examples/s]Map (num_proc=32):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 655/697 [00:00<00:00, 883.31 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 697/697 [00:01<00:00, 661.12 examples/s]
Map (num_proc=32):   0%|          | 0/67 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/67 [00:00<00:03, 16.39 examples/s]Map (num_proc=32):  22%|â–ˆâ–ˆâ–       | 15/67 [00:00<00:00, 56.60 examples/s]Map (num_proc=32):  34%|â–ˆâ–ˆâ–ˆâ–      | 23/67 [00:00<00:00, 62.88 examples/s]Map (num_proc=32):  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 31/67 [00:00<00:00, 66.21 examples/s]Map (num_proc=32):  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 39/67 [00:00<00:00, 68.87 examples/s]Map (num_proc=32):  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 49/67 [00:00<00:00, 73.67 examples/s]Map (num_proc=32):  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 57/67 [00:00<00:00, 73.73 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:00<00:00, 75.65 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:01<00:00, 60.54 examples/s]
Map (num_proc=32):   0%|          | 0/132 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/132 [00:00<00:04, 25.79 examples/s]Map (num_proc=32):  21%|â–ˆâ–ˆ        | 28/132 [00:00<00:01, 103.06 examples/s]Map (num_proc=32):  36%|â–ˆâ–ˆâ–ˆâ–‹      | 48/132 [00:00<00:00, 125.10 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 68/132 [00:00<00:00, 138.24 examples/s]Map (num_proc=32):  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 84/132 [00:00<00:00, 141.97 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 104/132 [00:00<00:00, 150.58 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 120/132 [00:00<00:00, 149.21 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 132/132 [00:01<00:00, 122.20 examples/s]
2025-06-06 11:44:28,889 - INFO - 3 datasets tokenized successfully
2025-06-06 11:44:28,891 - INFO - Starting hyperparameter search for BCE loss
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-06_11-44-28   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-44-28
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-06_10-55-47_424551_3536632/artifacts/2025-06-06_11-44-28/train_hpo_2025-06-06_11-44-28/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-06 11:44:29. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_8ff49e67   PENDING         8.49369       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_8ff49e67 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_8ff49e67 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          8.49369 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3596693)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3596693)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3596693)[0m 2025-06-06 11:44:36,160 - INFO - pos_weight value in TrainingArguments : 8.493688290834637
[36m(train_hpo pid=3596693)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3596693)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3596693)[0m [2025-06-06 11:44:36,410] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3596693)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=48, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3596693)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3596693)[0m   warnings.warn(

Trial train_hpo_b5777b79 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_b5777b79 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          7.54953 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3596924)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3596924)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3596924)[0m 2025-06-06 11:44:42,899 - INFO - pos_weight value in TrainingArguments : 7.549531688595925
[36m(train_hpo pid=3596924)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3596924)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3596924)[0m [2025-06-06 11:44:43,270] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3596924)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3596924)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3596924)[0m   warnings.warn(

Trial train_hpo_6f2a9c5e started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_6f2a9c5e config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          8.94984 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3597206)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3597206)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3597206)[0m 2025-06-06 11:44:49,709 - INFO - pos_weight value in TrainingArguments : 8.949837496427758
[36m(train_hpo pid=3597206)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3597206)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3597206)[0m [2025-06-06 11:44:49,949] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3597206)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3597206)[0m   warnings.warn(
[36m(train_hpo pid=3597206)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=24, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 3 RUNNING
Current time: 2025-06-06 11:44:59. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_8ff49e67   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_b5777b79   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_6f2a9c5e   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3596693)[0m {'loss': 1.7022, 'grad_norm': 2.4631686210632324, 'learning_rate': 1.246338876535363e-06, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3597206)[0m {'loss': 1.4467, 'grad_norm': 9.870356559753418, 'learning_rate': 5.325452975187489e-05, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3596924)[0m {'loss': 2.2224, 'grad_norm': 13.642354011535645, 'learning_rate': 3.6443132246884782e-06, 'epoch': 0.9142857142857143}
Trial status: 3 RUNNING
Current time: 2025-06-06 11:45:29. Total running time: 1min 0s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_8ff49e67   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_b5777b79   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_6f2a9c5e   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3596693)[0m {'loss': 1.7102, 'grad_norm': 11.446453094482422, 'learning_rate': 9.970711012282902e-07, 'epoch': 1.9142857142857141}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3597206)[0m {'train_runtime': 37.8982, 'train_samples_per_second': 55.174, 'train_steps_per_second': 0.633, 'train_loss': 0.8442861537138621, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3597206)[0m STATE at ending of training  :  TrainerState(epoch=2.914285714285714, global_step=24, max_steps=24, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=514881101282040.0, log_history=[{'loss': 1.4467, 'grad_norm': 9.870356559753418, 'learning_rate': 5.325452975187489e-05, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.6266, 'grad_norm': 8.645092010498047, 'learning_rate': 2.6627264875937445e-05, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 0.4596, 'grad_norm': 8.726105690002441, 'learning_rate': 0.0, 'epoch': 2.914285714285714, 'step': 24}, {'train_runtime': 37.8982, 'train_samples_per_second': 55.174, 'train_steps_per_second': 0.633, 'total_flos': 514881101282040.0, 'train_loss': 0.8442861537138621, 'epoch': 2.914285714285714, 'step': 24}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3597206)[0m 2025-06-06 11:45:34,403 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3597206)[0m 2025-06-06 11:45:34,409 - INFO - eval_result: {'eval_loss': 0.2584379315376282, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9761334657669067, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0, 'eval_kappa': 1.0, 'eval_runtime': 3.2826, 'eval_samples_per_second': 20.411, 'eval_steps_per_second': 1.219, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3597206)[0m {'eval_loss': 0.2584379315376282, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9761334657669067, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0, 'eval_kappa': 1.0, 'eval_runtime': 3.2826, 'eval_samples_per_second': 20.411, 'eval_steps_per_second': 1.219, 'epoch': 2.914285714285714}

Trial train_hpo_6f2a9c5e finished iteration 1 at 2025-06-06 11:45:34. Total running time: 1min 5s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_6f2a9c5e result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    45.2492 â”‚
â”‚ time_total_s                        45.2492 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               2.91429 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                                  1 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                             1 â”‚
â”‚ eval_f1                                   1 â”‚
â”‚ eval_kappa                                1 â”‚
â”‚ eval_loss                           0.25844 â”‚
â”‚ eval_optim_threshold                0.97613 â”‚
â”‚ eval_precision                            1 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.2826 â”‚
â”‚ eval_samples_per_second              20.411 â”‚
â”‚ eval_steps_per_second                 1.219 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:45:34,473 - INFO - Cleaning up trial 6f2a9c5e
2025-06-06 11:45:34,474 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-44-28/train_hpo_6f2a9c5e_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512_2025-06-06_11-44-42

Trial train_hpo_6f2a9c5e completed after 1 iterations at 2025-06-06 11:45:34. Total running time: 1min 5s
[36m(train_hpo pid=3597206)[0m 2025-06-06 11:45:34,448 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3596924)[0m {'loss': 2.008, 'grad_norm': 18.45854949951172, 'learning_rate': 2.7332349185163582e-06, 'epoch': 1.9142857142857141}[32m [repeated 2x across cluster][0m

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:45:59. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_8ff49e67   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_b5777b79   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_6f2a9c5e   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.2492      0.258438           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3596693)[0m {'loss': 1.6964, 'grad_norm': 2.450462579727173, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3596924)[0m {'loss': 1.7003, 'grad_norm': 7.969616413116455, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.914285714285714}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:46:29. Total running time: 2min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_8ff49e67   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_b5777b79   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_6f2a9c5e   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.2492      0.258438           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3596693)[0m {'loss': 1.6733, 'grad_norm': 1.5917472839355469, 'learning_rate': 4.985355506141451e-07, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3596924)[0m {'loss': 1.3894, 'grad_norm': 9.376420021057129, 'learning_rate': 9.110783061721196e-07, 'epoch': 3.914285714285714}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:46:59. Total running time: 2min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_8ff49e67   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_b5777b79   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_6f2a9c5e   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.2492      0.258438           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3596693)[0m {'loss': 1.7045, 'grad_norm': 15.45170783996582, 'learning_rate': 2.4926777530707256e-07, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3596924)[0m {'loss': 1.2243, 'grad_norm': 17.82494354248047, 'learning_rate': 0.0, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3596924)[0m {'train_runtime': 147.9319, 'train_samples_per_second': 23.558, 'train_steps_per_second': 0.27, 'train_loss': 1.7088674783706665, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3596924)[0m STATE at ending of training  :  TrainerState(epoch=4.914285714285715, global_step=40, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=861454860515760.0, log_history=[{'loss': 2.2224, 'grad_norm': 13.642354011535645, 'learning_rate': 3.6443132246884782e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 2.008, 'grad_norm': 18.45854949951172, 'learning_rate': 2.7332349185163582e-06, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 1.7003, 'grad_norm': 7.969616413116455, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 1.3894, 'grad_norm': 9.376420021057129, 'learning_rate': 9.110783061721196e-07, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 1.2243, 'grad_norm': 17.82494354248047, 'learning_rate': 0.0, 'epoch': 4.914285714285715, 'step': 40}, {'train_runtime': 147.9319, 'train_samples_per_second': 23.558, 'train_steps_per_second': 0.27, 'total_flos': 861454860515760.0, 'train_loss': 1.7088674783706665, 'epoch': 4.914285714285715, 'step': 40}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3596693)[0m STATE at ending of training  :  TrainerState(epoch=5.914285714285715, global_step=48, max_steps=48, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=1035106597890480.0, log_history=[{'loss': 1.7022, 'grad_norm': 2.4631686210632324, 'learning_rate': 1.246338876535363e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 1.7102, 'grad_norm': 11.446453094482422, 'learning_rate': 9.970711012282902e-07, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 1.6964, 'grad_norm': 2.450462579727173, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 1.6733, 'grad_norm': 1.5917472839355469, 'learning_rate': 4.985355506141451e-07, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 1.7045, 'grad_norm': 15.45170783996582, 'learning_rate': 2.4926777530707256e-07, 'epoch': 4.914285714285715, 'step': 40}, {'loss': 1.6601, 'grad_norm': 8.85449504852295, 'learning_rate': 0.0, 'epoch': 5.914285714285715, 'step': 48}, {'train_runtime': 161.4792, 'train_samples_per_second': 25.898, 'train_steps_per_second': 0.297, 'total_flos': 1035106597890480.0, 'train_loss': 1.6911105712254841, 'epoch': 5.914285714285715, 'step': 48}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3596693)[0m {'loss': 1.6601, 'grad_norm': 8.85449504852295, 'learning_rate': 0.0, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3596693)[0m {'train_runtime': 161.4792, 'train_samples_per_second': 25.898, 'train_steps_per_second': 0.297, 'train_loss': 1.6911105712254841, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3596924)[0m {'eval_loss': 2.831354856491089, 'eval_f1': 0.9514563106796117, 'eval_recall': 0.98, 'eval_accuracy': 0.9253731343283582, 'eval_precision': 0.9245283018867925, 'eval_optim_threshold': 0.5174401998519897, 'eval_AP': 0.9921552004498699, 'eval_MCC': 0.7970623485687589, 'eval_NDCG': 0.9985811191999422, 'eval_kappa': 0.7907557776389756, 'eval_runtime': 7.3012, 'eval_samples_per_second': 9.177, 'eval_steps_per_second': 0.548, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3596924)[0m 2025-06-06 11:47:21,781 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3596924)[0m 2025-06-06 11:47:21,787 - INFO - eval_result: {'eval_loss': 2.831354856491089, 'eval_f1': 0.9514563106796117, 'eval_recall': 0.98, 'eval_accuracy': 0.9253731343283582, 'eval_precision': 0.9245283018867925, 'eval_optim_threshold': 0.5174401998519897, 'eval_AP': 0.9921552004498699, 'eval_MCC': 0.7970623485687589, 'eval_NDCG': 0.9985811191999422, 'eval_kappa': 0.7907557776389756, 'eval_runtime': 7.3012, 'eval_samples_per_second': 9.177, 'eval_steps_per_second': 0.548, 'epoch': 4.914285714285715}

Trial train_hpo_b5777b79 finished iteration 1 at 2025-06-06 11:47:21. Total running time: 2min 52s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_b5777b79 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    159.378 â”‚
â”‚ time_total_s                        159.378 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               4.91429 â”‚
â”‚ eval_AP                             0.99216 â”‚
â”‚ eval_MCC                            0.79706 â”‚
â”‚ eval_NDCG                           0.99858 â”‚
â”‚ eval_accuracy                       0.92537 â”‚
â”‚ eval_f1                             0.95146 â”‚
â”‚ eval_kappa                          0.79076 â”‚
â”‚ eval_loss                           2.83135 â”‚
â”‚ eval_optim_threshold                0.51744 â”‚
â”‚ eval_precision                      0.92453 â”‚
â”‚ eval_recall                            0.98 â”‚
â”‚ eval_runtime                         7.3012 â”‚
â”‚ eval_samples_per_second               9.177 â”‚
â”‚ eval_steps_per_second                 0.548 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:47:21,846 - INFO - Cleaning up trial b5777b79
2025-06-06 11:47:21,847 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-44-28/train_hpo_b5777b79_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-06_11-44-35
2025-06-06 11:47:21,847 - INFO - Current best: 6f2a9c5e with eval_f1 : 1.0 at iteration 1

Trial train_hpo_b5777b79 completed after 1 iterations at 2025-06-06 11:47:21. Total running time: 2min 52s
[36m(train_hpo pid=3596924)[0m 2025-06-06 11:47:21,824 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3596693)[0m 2025-06-06 11:47:24,555 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3596693)[0m 2025-06-06 11:47:24,560 - INFO - eval_result: {'eval_loss': 3.454892873764038, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.6001768112182617, 'eval_AP': 0.9702730099239871, 'eval_MCC': 0.0, 'eval_NDCG': 0.9944820974521458, 'eval_kappa': 0.0, 'eval_runtime': 3.419, 'eval_samples_per_second': 19.596, 'eval_steps_per_second': 1.17, 'epoch': 5.914285714285715}

Trial train_hpo_8ff49e67 finished iteration 1 at 2025-06-06 11:47:24. Total running time: 2min 55s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_8ff49e67 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    168.897 â”‚
â”‚ time_total_s                        168.897 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               5.91429 â”‚
â”‚ eval_AP                             0.97027 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.99448 â”‚
â”‚ eval_accuracy                       0.74627 â”‚
â”‚ eval_f1                              0.8547 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           3.45489 â”‚
â”‚ eval_optim_threshold                0.60018 â”‚
â”‚ eval_precision                      0.74627 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                          3.419 â”‚
â”‚ eval_samples_per_second              19.596 â”‚
â”‚ eval_steps_per_second                  1.17 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:47:24,622 - INFO - Cleaning up trial 8ff49e67
2025-06-06 11:47:24,622 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-44-28/train_hpo_8ff49e67_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-06_11-44-28
2025-06-06 11:47:24,622 - INFO - Cleaning up trial b5777b79
2025-06-06 11:47:24,622 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-44-28/train_hpo_b5777b79_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-06_11-44-35
2025-06-06 11:47:24,622 - INFO - Current best: 6f2a9c5e with eval_f1 : 1.0 at iteration 1

Trial train_hpo_8ff49e67 completed after 1 iterations at 2025-06-06 11:47:24. Total running time: 2min 55s
2025-06-06 11:47:24,630	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-44-28' in 0.0069s.

Trial status: 3 TERMINATED
Current time: 2025-06-06 11:47:24. Total running time: 2min 55s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_8ff49e67   TERMINATED        8.49369       1.49561e-06         0.13641                     6        1           168.897       3.45489     0.854701            1             0.746269 â”‚
â”‚ train_hpo_b5777b79   TERMINATED        7.54953       4.55539e-06         0.123031                    5        1           159.378       2.83135     0.951456            0.98          0.925373 â”‚
â”‚ train_hpo_6f2a9c5e   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.2492      0.258438    1                   1             1        â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

2025-06-06 11:47:24,638 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x701638c81a50>
2025-06-06 11:47:24,638 - INFO - Best trial : train_hpo_6f2a9c5e
2025-06-06 11:47:24,639 - INFO - Best config : {'pos_weight': 8.949837496427758, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-06 11:47:24,639 - INFO - Best trial after optimization: {'eval_loss': 0.2584379315376282, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9761334657669067, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0, 'eval_kappa': 1.0, 'eval_runtime': 3.2826, 'eval_samples_per_second': 20.411, 'eval_steps_per_second': 1.219, 'epoch': 2.914285714285714, 'timestamp': 1749203134, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '6f2a9c5e', 'date': '2025-06-06_11-45-34', 'time_this_iter_s': 45.24922323226929, 'time_total_s': 45.24922323226929, 'pid': 3597206, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 8.949837496427758, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 45.24922323226929, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512'}
2025-06-06 11:47:24,659 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   3.454893  0.854701  ...                        6  8ff49e67
1   2.831355  0.951456  ...                        5  b5777b79
2   0.258438  1.000000  ...                        3  6f2a9c5e

[3 rows x 32 columns]
2025-06-06 11:47:24,851 - INFO - Trial comparison plot saved
2025-06-06 11:47:24,851 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-06 11:47:25,098 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-06 11:47:25,214 - INFO - training size : 697
2025-06-06 11:47:25,214 - INFO - dev size : 67
2025-06-06 11:47:25,214 - INFO - test size : 132
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
  0%|          | 0/90 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  1%|          | 1/90 [00:00<00:57,  1.54it/s]  2%|â–         | 2/90 [00:01<00:55,  1.58it/s]  3%|â–Ž         | 3/90 [00:01<00:54,  1.60it/s]  4%|â–         | 4/90 [00:02<00:53,  1.60it/s]  6%|â–Œ         | 5/90 [00:03<00:52,  1.61it/s]  7%|â–‹         | 6/90 [00:03<00:52,  1.61it/s]  8%|â–Š         | 7/90 [00:04<00:51,  1.61it/s]  9%|â–‰         | 8/90 [00:04<00:50,  1.61it/s] 10%|â–ˆ         | 9/90 [00:05<00:50,  1.61it/s] 11%|â–ˆ         | 10/90 [00:06<00:49,  1.61it/s] 12%|â–ˆâ–        | 11/90 [00:06<00:49,  1.61it/s] 13%|â–ˆâ–Ž        | 12/90 [00:07<00:48,  1.61it/s] 14%|â–ˆâ–        | 13/90 [00:08<00:47,  1.61it/s] 16%|â–ˆâ–Œ        | 14/90 [00:08<00:47,  1.61it/s] 17%|â–ˆâ–‹        | 15/90 [00:09<00:46,  1.61it/s] 18%|â–ˆâ–Š        | 16/90 [00:09<00:45,  1.61it/s] 19%|â–ˆâ–‰        | 17/90 [00:10<00:45,  1.61it/s] 20%|â–ˆâ–ˆ        | 18/90 [00:11<00:44,  1.61it/s] 21%|â–ˆâ–ˆ        | 19/90 [00:11<00:43,  1.61it/s] 22%|â–ˆâ–ˆâ–       | 20/90 [00:12<00:43,  1.61it/s] 23%|â–ˆâ–ˆâ–Ž       | 21/90 [00:13<00:42,  1.61it/s] 24%|â–ˆâ–ˆâ–       | 22/90 [00:13<00:42,  1.61it/s] 26%|â–ˆâ–ˆâ–Œ       | 23/90 [00:14<00:41,  1.62it/s] 27%|â–ˆâ–ˆâ–‹       | 24/90 [00:14<00:40,  1.62it/s] 28%|â–ˆâ–ˆâ–Š       | 25/90 [00:15<00:40,  1.62it/s] 29%|â–ˆâ–ˆâ–‰       | 26/90 [00:16<00:39,  1.62it/s] 30%|â–ˆâ–ˆâ–ˆ       | 27/90 [00:16<00:38,  1.62it/s] 31%|â–ˆâ–ˆâ–ˆ       | 28/90 [00:17<00:38,  1.62it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 29/90 [00:17<00:37,  1.63it/s]                                               {'loss': 0.7567, 'grad_norm': 0.4294285774230957, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 30/90 [00:18<00:36,  1.63it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 31/90 [00:18<00:29,  2.03it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 32/90 [00:19<00:30,  1.90it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 33/90 [00:19<00:31,  1.82it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 34/90 [00:20<00:31,  1.76it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 35/90 [00:21<00:32,  1.72it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 36/90 [00:21<00:32,  1.69it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 37/90 [00:22<00:31,  1.66it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 38/90 [00:23<00:31,  1.65it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 39/90 [00:23<00:31,  1.64it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 40/90 [00:24<00:30,  1.63it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 41/90 [00:24<00:30,  1.63it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 42/90 [00:25<00:29,  1.63it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 43/90 [00:26<00:28,  1.62it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 44/90 [00:26<00:28,  1.62it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 45/90 [00:27<00:27,  1.62it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 46/90 [00:27<00:27,  1.62it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 47/90 [00:28<00:26,  1.62it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 48/90 [00:29<00:25,  1.62it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 49/90 [00:29<00:25,  1.62it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 50/90 [00:30<00:24,  1.61it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 51/90 [00:31<00:24,  1.61it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 52/90 [00:31<00:23,  1.61it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 53/90 [00:32<00:22,  1.61it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 54/90 [00:32<00:22,  1.61it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 55/90 [00:33<00:21,  1.61it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 56/90 [00:34<00:21,  1.61it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 57/90 [00:34<00:20,  1.61it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 58/90 [00:35<00:19,  1.62it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 59/90 [00:36<00:18,  1.63it/s]                                               {'loss': 0.005, 'grad_norm': 0.015879599377512932, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 60/90 [00:36<00:18,  1.63it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 61/90 [00:36<00:14,  2.05it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 62/90 [00:37<00:14,  1.92it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 63/90 [00:37<00:14,  1.83it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 64/90 [00:38<00:14,  1.77it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 65/90 [00:39<00:14,  1.73it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 66/90 [00:39<00:14,  1.69it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 67/90 [00:40<00:13,  1.67it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 68/90 [00:41<00:13,  1.66it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 69/90 [00:41<00:12,  1.65it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 70/90 [00:42<00:12,  1.64it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 71/90 [00:42<00:11,  1.63it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 72/90 [00:43<00:11,  1.63it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 73/90 [00:44<00:10,  1.62it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 74/90 [00:44<00:09,  1.62it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 75/90 [00:45<00:09,  1.62it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 76/90 [00:45<00:08,  1.62it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 77/90 [00:46<00:08,  1.62it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 78/90 [00:47<00:07,  1.62it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 79/90 [00:47<00:06,  1.62it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 80/90 [00:48<00:06,  1.62it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 81/90 [00:49<00:05,  1.63it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 82/90 [00:49<00:04,  1.62it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 83/90 [00:50<00:04,  1.62it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 84/90 [00:50<00:03,  1.62it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 85/90 [00:51<00:03,  1.62it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 86/90 [00:52<00:02,  1.62it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 87/90 [00:52<00:01,  1.62it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 88/90 [00:53<00:01,  1.62it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 89/90 [00:53<00:00,  1.63it/s]                                               {'loss': 0.0016, 'grad_norm': 0.0929403305053711, 'learning_rate': 0.0, 'epoch': 3.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.63it/s]                                               {'train_runtime': 56.1851, 'train_samples_per_second': 37.216, 'train_steps_per_second': 1.602, 'train_loss': 0.254432299402025, 'epoch': 3.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.63it/s]2025-06-06 11:48:21,854 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.60it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.22it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.38it/s]2025-06-06 11:48:26,083 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.31s/it]
2025-06-06 11:48:26,089 - INFO - Training time : 61.237751548876986
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.05it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  4.99it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.32it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.08it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.31it/s]2025-06-06 11:48:30,860 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.34it/s]
2025-06-06 11:48:30,864 - INFO - Evaluation time : 4.7754568620584905
2025-06-06 11:48:30,865 - INFO - Evaluation results on test set: {'eval_loss': 0.060775987803936005, 'eval_f1': 0.9948717948717949, 'eval_recall': 1.0, 'eval_accuracy': 0.9924242424242424, 'eval_precision': 0.9897959183673469, 'eval_optim_threshold': 0.9996064305305481, 'eval_AP': 0.9998948032821375, 'eval_MCC': 0.9805692402810843, 'eval_NDCG': 0.9999836965723131, 'eval_kappa': 0.9803804994054697, 'eval_runtime': 4.771, 'eval_samples_per_second': 27.667, 'eval_steps_per_second': 1.258, 'epoch': 3.0}
2025-06-06 11:48:30,865 - INFO - Total updates (optimizer steps): 90
2025-06-06 11:48:30,865 - INFO - Avg time / step: 0.624s
2025-06-06 11:48:31,621 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCEgoogle-bert/bert-base-uncased3trials_fold-3
2025-06-06 11:48:31,621 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.01it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  4.97it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.33it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.08it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.30it/s]2025-06-06 11:48:36,122 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.43it/s]
2025-06-06 11:48:36,126 - INFO - preds : [1 1 1 1 1 0 1 1 1 0 1 1 1 0 0 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 0 0 1 0 0 1
 1 0 1 1 1 1 0 1 1 0 1 1 1 0 1 0 1 0 1 1 1 1 0 1 1 1 1 1 0 1 0 1 1 1 1 0 0
 1 1 1 1 1 1 0 1 1 1 1 1 0 1 1 0 1 1 1 1 0 1 1 1 1 1 1 0 0 1 1 0 1 1 1 1 0
 0 1 1 1 1 0 1 1 0 0 1 1 1 1 0 1 1 0 1 1 1]
2025-06-06 11:48:36,127 - INFO - test_split["labels"] : [1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1]
2025-06-06 11:48:36,128 - INFO - Confusion matrix: TN=34, FP=1, FN=0, TP=97
2025-06-06 11:48:38,824 - INFO - Metrics: {'f1': 0.9948717948717949, 'recall': 1.0, 'precision': 0.9897959183673469, 'accuracy': 0.9924242424242424, 'AP': 0.9998948032821375, 'MCC': 0.9805692402810843, 'NDCG': 0.9999836965723131, 'kappa': 0.9803804994054697, 'TN': 34, 'FP': 1, 'FN': 0, 'TP': 97}
2025-06-06 11:48:38,944 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-06 11:48:39,041 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 11:48:39,041 - INFO - 
On test Set (optimal threshold of 0.9996082186698914 according to cross validation on the training set): 
2025-06-06 11:48:39,043 - INFO - Confusion matrix: TN=35, FP=0, FN=3, TP=94
2025-06-06 11:48:41,949 - INFO - Metrics: {'f1': 0.9842931937172775, 'recall': 0.9690721649484536, 'precision': 1.0, 'accuracy': 0.9772727272727273, 'AP': 0.9998948032821375, 'MCC': 0.944757359175191, 'NDCG': 0.9999836965723131, 'kappa': 0.9432339449541285, 'TN': 35, 'FP': 0, 'FN': 3, 'TP': 94}
2025-06-06 11:48:42,047 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 11:48:42,047 - INFO - Results for fold 3 : [{'f1': 0.9842931937172775, 'recall': 0.9690721649484536, 'precision': 1.0, 'accuracy': 0.9772727272727273, 'AP': 0.9998948032821375, 'MCC': 0.944757359175191, 'NDCG': 0.9999836965723131, 'kappa': 0.9432339449541285, 'TN': 35, 'FP': 0, 'FN': 3, 'TP': 94}]
2025-06-06 11:48:42,162 - INFO - Cleared CUDA cache. Memory allocated: 1.43 GB, Memory reserved: 1.78 GB
2025-06-06 11:48:42,163 - INFO - Cleared CUDA cache. Memory allocated: 1.43 GB, Memory reserved: 1.78 GB
2025-06-06 11:48:42,177 - INFO - Cleared CUDA cache. Memory allocated: 0.98 GB, Memory reserved: 1.66 GB
2025-06-06 11:48:42,191 - INFO - Metrics for google-bert/bert-base-uncased:                       model_name fold loss_type run  ...    TN   FP   FN    TP
3  google-bert/bert-base-uncased    1       BCE   1  ...  35.0  0.0  0.0  98.0
4  google-bert/bert-base-uncased    2       BCE   1  ...  34.0  0.0  0.0  98.0
5  google-bert/bert-base-uncased    3       BCE   1  ...  34.0  1.0  0.0  97.0
0  google-bert/bert-base-uncased    1       BCE   2  ...  35.0  0.0  0.0  98.0
0  google-bert/bert-base-uncased    2       BCE   2  ...  34.0  0.0  0.0  98.0
0  google-bert/bert-base-uncased    3       BCE   2  ...  34.0  1.0  0.0  97.0

[6 rows x 18 columns]
2025-06-06 11:48:42,191 - INFO - 
fold number 1 / 3
2025-06-06 11:48:42,196 - INFO - Confusion matrix: TN=35, FP=0, FN=0, TP=98
2025-06-06 11:48:44,927 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 35, 'FP': 0, 'FN': 0, 'TP': 98}
2025-06-06 11:48:44,929 - INFO - 
fold number 2 / 3
2025-06-06 11:48:44,932 - INFO - Confusion matrix: TN=34, FP=0, FN=0, TP=98
2025-06-06 11:48:47,647 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 34, 'FP': 0, 'FN': 0, 'TP': 98}
2025-06-06 11:48:47,649 - INFO - 
fold number 3 / 3
2025-06-06 11:48:47,653 - INFO - Confusion matrix: TN=34, FP=1, FN=0, TP=97
2025-06-06 11:48:50,350 - INFO - Metrics: {'f1': 0.9948717948717949, 'recall': 1.0, 'precision': 0.9897959183673469, 'accuracy': 0.9924242424242424, 'AP': 0.9999999999999999, 'MCC': 0.9805692402810843, 'NDCG': 1.0000000000000004, 'kappa': 0.9803804994054697, 'TN': 34, 'FP': 1, 'FN': 0, 'TP': 97}
2025-06-06 11:48:50,357 - INFO - fold indexes for run no.1: [[159, 206, 117, 82, 317, 330, 131, 380, 183, 158, 213, 260, 155, 332, 303, 269, 40, 232, 314, 244, 168, 218, 254, 100, 3, 235, 105, 243, 352, 394, 196, 223, 230, 307, 342, 289, 135, 7, 189, 134, 78, 133, 12, 375, 109, 46, 62, 393, 167, 151, 387, 374, 276, 323, 132, 319, 114, 176, 322, 263, 258, 266, 250, 329, 309, 367, 24, 229, 370, 211, 228, 346, 115, 392, 87, 88, 81, 343, 253, 278, 43, 333, 28, 80, 191, 10, 378, 388, 225, 363, 136, 104, 356, 8, 57, 162, 220, 391, 139, 386, 282, 70, 61, 170, 102, 296, 64, 35, 4, 251, 279, 44, 373, 129, 236, 327, 187, 68, 245, 215, 18, 42, 116, 212, 376, 148, 126, 27, 252, 173, 103, 336, 209, 199, 169, 283, 32, 246, 292, 210, 247, 141, 73, 194, 59, 385, 354, 51, 305, 200, 344, 179, 178, 355, 313, 112, 291, 23, 328, 130, 315, 181, 138, 94, 95, 121, 207, 175, 295, 321, 34, 300, 262, 33, 341, 54, 299, 48, 30, 204, 123, 331, 301, 150, 157, 265, 14, 53, 396, 242, 377, 366, 93, 214, 83, 52, 6, 188, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 532, 533, 534, 535, 536, 537, 538, 539, 540, 541, 542, 543, 544, 545, 546, 547, 548, 549, 550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 560, 561, 562, 563, 564, 565, 566, 567, 568, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582, 583, 584, 585, 586, 587, 588, 589, 590, 591, 592, 593, 594, 595, 596, 597, 598, 599, 600, 601, 602, 603, 604, 605, 606, 607, 608, 609, 610, 611, 612, 613, 614, 615, 616, 617, 618, 619, 620, 621, 622, 623, 624, 625, 626, 627, 628, 629, 630, 631, 632, 633, 634, 635, 636, 637, 638, 639, 640, 641, 642, 643, 644, 645, 646, 647, 648, 649, 650, 651, 652, 653, 654, 655, 656, 657, 658, 659, 660, 661, 662, 663, 664, 665, 666, 667, 668, 669, 670, 671, 672, 673, 674, 675, 676, 677, 678, 679, 680, 681, 682, 683, 684, 685, 686, 687, 688, 689, 690, 691, 692, 693, 694, 695, 696, 697, 698, 699, 700, 701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 714, 715, 716, 717, 718, 719, 720, 721, 722, 723, 724, 725, 726, 727, 728, 729, 730, 731, 732, 733, 734, 735, 736, 737, 738, 739, 740, 741, 742, 743, 744, 745, 746, 747, 748, 749, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764, 765, 766, 767, 768, 769, 770, 771, 772, 773, 774, 775, 776, 777, 778, 779, 780, 781, 782, 783, 784, 785, 786, 787, 788, 789, 790, 791, 792, 793, 794, 795, 796, 797, 798, 799, 800, 801, 802, 803, 804, 805, 806, 807, 808, 809, 810, 811, 812, 813, 814, 815, 816, 817, 818, 819, 820, 821, 822, 823, 824, 825, 826, 827, 828, 829, 830, 831, 832, 833, 834, 835, 836, 837, 838, 839, 840, 841, 842, 843, 844, 845, 846, 847, 848, 849, 850, 851, 852, 853, 854, 855, 856, 857, 858, 859, 860, 861, 862, 863, 864, 865, 866, 867, 868, 869, 870, 871, 872, 873, 874, 875, 876, 877, 878, 879, 880, 881, 882, 883, 884, 885, 886, 887, 888, 889, 890, 891, 892, 893, 894, 895], [177, 268, 97, 248, 298, 320, 224, 137, 161, 145, 339, 98, 39, 66, 17, 325, 226, 91, 348, 67, 55, 237, 273, 353, 381, 261, 31, 2, 290, 107, 38, 113, 120, 1, 222, 84, 358, 202, 63, 337, 92, 99, 144, 256, 19, 171, 219, 285, 274, 174, 118, 233, 156, 324, 284, 190, 255, 357, 205, 111, 72, 384, 294, 71, 163, 217], array([  0,   5,   9,  11,  13,  15,  16,  20,  21,  22,  25,  26,  29,
        36,  37,  41,  45,  47,  49,  50,  56,  58,  60,  65,  69,  74,
        75,  76,  77,  79,  85,  86,  89,  90,  96, 101, 106, 108, 110,
       119, 122, 124, 125, 127, 128, 140, 142, 143, 146, 147, 149, 152,
       153, 154, 160, 164, 165, 166, 172, 180, 182, 184, 185, 186, 192,
       193, 195, 197, 198, 201, 203, 208, 216, 221, 227, 231, 234, 238,
       239, 240, 241, 249, 257, 259, 264, 267, 270, 271, 272, 275, 277,
       280, 281, 286, 287, 288, 293, 297, 302, 304, 306, 308, 310, 311,
       312, 316, 318, 326, 334, 335, 338, 340, 345, 347, 349, 350, 351,
       359, 360, 361, 362, 364, 365, 368, 369, 371, 372, 379, 382, 383,
       389, 390, 395])]
2025-06-06 11:48:50,357 - INFO - Run no 1/2
2025-06-06 11:48:50,357 - INFO - Loss Type : focal
2025-06-06 11:48:50,357 - INFO - Ensemble learning pipeline
2025-06-06 11:48:50,357 - INFO - Training model 1/2: dmis-lab/biobert-v1.1
2025-06-06 11:48:50,526 - INFO - 
fold number 1 / 3
2025-06-06 11:48:50,533 - INFO - train split size : 697
2025-06-06 11:48:50,533 - INFO - dev split size : 66
2025-06-06 11:48:50,533 - INFO - test split size : 133
Map (num_proc=32):   0%|          | 0/697 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 22/697 [00:00<00:06, 99.08 examples/s]Map (num_proc=32):  16%|â–ˆâ–Œ        | 110/697 [00:00<00:01, 404.32 examples/s]Map (num_proc=32):  32%|â–ˆâ–ˆâ–ˆâ–      | 220/697 [00:00<00:00, 605.42 examples/s]Map (num_proc=32):  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 330/697 [00:00<00:00, 762.05 examples/s]Map (num_proc=32):  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 418/697 [00:00<00:00, 798.14 examples/s]Map (num_proc=32):  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 528/697 [00:00<00:00, 860.75 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 634/697 [00:00<00:00, 850.47 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 697/697 [00:01<00:00, 658.97 examples/s]
Map (num_proc=32):   0%|          | 0/66 [00:00<?, ? examples/s]Map (num_proc=32):   5%|â–         | 3/66 [00:00<00:03, 15.99 examples/s]Map (num_proc=32):  18%|â–ˆâ–Š        | 12/66 [00:00<00:01, 46.02 examples/s]Map (num_proc=32):  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 22/66 [00:00<00:00, 64.30 examples/s]Map (num_proc=32):  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 30/66 [00:00<00:00, 68.24 examples/s]Map (num_proc=32):  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 40/66 [00:00<00:00, 76.92 examples/s]Map (num_proc=32):  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 50/66 [00:00<00:00, 81.16 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 60/66 [00:00<00:00, 84.85 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 66/66 [00:01<00:00, 64.66 examples/s]
Map (num_proc=32):   0%|          | 0/133 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/133 [00:00<00:04, 25.82 examples/s]Map (num_proc=32):  22%|â–ˆâ–ˆâ–       | 29/133 [00:00<00:00, 109.93 examples/s]Map (num_proc=32):  34%|â–ˆâ–ˆâ–ˆâ–      | 45/133 [00:00<00:00, 118.28 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 69/133 [00:00<00:00, 152.45 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 89/133 [00:00<00:00, 155.43 examples/s]Map (num_proc=32):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 109/133 [00:00<00:00, 158.69 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 133/133 [00:00<00:00, 172.56 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 133/133 [00:01<00:00, 127.59 examples/s]
2025-06-06 11:49:00,089 - INFO - 3 datasets tokenized successfully
2025-06-06 11:49:00,090 - INFO - Starting hyperparameter search for focal loss
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-06_11-49-00   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-49-00
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-06_10-55-47_424551_3536632/artifacts/2025-06-06_11-49-00/train_hpo_2025-06-06_11-49-00/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-06 11:49:00. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_dc879b73   PENDING    0.625202   2.69927       1.88223e-05          0.13641                    4 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_dc879b73 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_dc879b73 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                                0.6252 â”‚
â”‚ gamma                               2.69927 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          4 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3601888)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3601888)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3596693)[0m 2025-06-06 11:47:24,597 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3601888)[0m 2025-06-06 11:49:07,871 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.6252016107931255 and gamma=2.6992695521978884
[36m(train_hpo pid=3601888)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3601888)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3601888)[0m [2025-06-06 11:49:08,130] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3596693)[0m {'eval_loss': 3.454892873764038, 'eval_f1': 0.8547008547008547, 'eval_recall': 1.0, 'eval_accuracy': 0.746268656716418, 'eval_precision': 0.746268656716418, 'eval_optim_threshold': 0.6001768112182617, 'eval_AP': 0.9702730099239871, 'eval_MCC': 0.0, 'eval_NDCG': 0.9944820974521458, 'eval_kappa': 0.0, 'eval_runtime': 3.419, 'eval_samples_per_second': 19.596, 'eval_steps_per_second': 1.17, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3601888)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=32, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3601888)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3601888)[0m   warnings.warn(

Trial train_hpo_e85c12e3 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_e85c12e3 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.97058 â”‚
â”‚ gamma                                4.6341 â”‚
â”‚ learning_rate                         5e-05 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3602050)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3602050)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3602050)[0m 2025-06-06 11:49:14,297 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.970577641092792 and gamma=4.634102840173219
[36m(train_hpo pid=3602050)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3602050)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3602050)[0m [2025-06-06 11:49:14,673] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3602050)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3602050)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3602050)[0m   warnings.warn(

Trial train_hpo_92a27caa started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_92a27caa config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.78112 â”‚
â”‚ gamma                               6.80707 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          2 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3602334)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3602334)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3602334)[0m 2025-06-06 11:49:21,151 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.7811204413478371 and gamma=6.807074484302038
[36m(train_hpo pid=3602334)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3602334)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3602334)[0m [2025-06-06 11:49:21,363] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3602334)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=16, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3602334)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3602334)[0m   warnings.warn(

Trial status: 3 RUNNING
Current time: 2025-06-06 11:49:30. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_dc879b73   RUNNING    0.625202   2.69927       1.88223e-05         0.13641                     4 â”‚
â”‚ train_hpo_e85c12e3   RUNNING    0.970578   4.6341        5.16112e-05         0.123031                    5 â”‚
â”‚ train_hpo_92a27caa   RUNNING    0.78112    6.80707       1.88581e-05         0.251217                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3601888)[0m {'loss': 0.0307, 'grad_norm': 0.2529017925262451, 'learning_rate': 1.4116733618581595e-05, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3602050)[0m {'loss': 0.0036, 'grad_norm': 0.03471459820866585, 'learning_rate': 4.128897652498939e-05, 'epoch': 0.9142857142857143}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3602334)[0m {'train_runtime': 25.2025, 'train_samples_per_second': 55.312, 'train_steps_per_second': 0.635, 'train_loss': 0.001426972507033497, 'epoch': 1.9142857142857141}
[36m(train_hpo pid=3602334)[0m STATE at ending of training  :  TrainerState(epoch=1.9142857142857141, global_step=16, max_steps=16, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=341445195257040.0, log_history=[{'loss': 0.002, 'grad_norm': 0.017880288884043694, 'learning_rate': 9.429055465477227e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.0008, 'grad_norm': 0.02135593444108963, 'learning_rate': 0.0, 'epoch': 1.9142857142857141, 'step': 16}, {'train_runtime': 25.2025, 'train_samples_per_second': 55.312, 'train_steps_per_second': 0.635, 'total_flos': 341445195257040.0, 'train_loss': 0.001426972507033497, 'epoch': 1.9142857142857141, 'step': 16}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3602334)[0m 2025-06-06 11:49:53,324 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3602334)[0m 2025-06-06 11:49:53,330 - INFO - eval_result: {'eval_loss': 0.0009356364607810974, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.5092771053314209, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.6071, 'eval_samples_per_second': 18.297, 'eval_steps_per_second': 1.109, 'epoch': 1.9142857142857141}
[36m(train_hpo pid=3602334)[0m {'eval_loss': 0.0009356364607810974, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.5092771053314209, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.6071, 'eval_samples_per_second': 18.297, 'eval_steps_per_second': 1.109, 'epoch': 1.9142857142857141}
[36m(train_hpo pid=3602334)[0m {'loss': 0.0008, 'grad_norm': 0.02135593444108963, 'learning_rate': 0.0, 'epoch': 1.9142857142857141}

Trial train_hpo_92a27caa finished iteration 1 at 2025-06-06 11:49:53. Total running time: 53s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_92a27caa result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    33.0836 â”‚
â”‚ time_total_s                        33.0836 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               1.91429 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                                  1 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                             1 â”‚
â”‚ eval_f1                                   1 â”‚
â”‚ eval_kappa                                1 â”‚
â”‚ eval_loss                           0.00094 â”‚
â”‚ eval_optim_threshold                0.50928 â”‚
â”‚ eval_precision                            1 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.6071 â”‚
â”‚ eval_samples_per_second              18.297 â”‚
â”‚ eval_steps_per_second                 1.109 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:49:53,394 - INFO - Cleaning up trial 92a27caa
2025-06-06 11:49:53,394 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-49-00/train_hpo_92a27caa_3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512_2025-06-06_11-49-13

Trial train_hpo_92a27caa completed after 1 iterations at 2025-06-06 11:49:53. Total running time: 53s
[36m(train_hpo pid=3602334)[0m 2025-06-06 11:49:53,369 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:50:00. Total running time: 1min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_dc879b73   RUNNING      0.625202   2.69927       1.88223e-05         0.13641                     4                                                                                         â”‚
â”‚ train_hpo_e85c12e3   RUNNING      0.970578   4.6341        5.16112e-05         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_92a27caa   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            33.0836   0.000935636           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3601888)[0m {'loss': 0.0088, 'grad_norm': 0.16838249564170837, 'learning_rate': 9.411155745721064e-06, 'epoch': 1.9142857142857141}
[36m(train_hpo pid=3602050)[0m {'loss': 0.0011, 'grad_norm': 0.018936002627015114, 'learning_rate': 3.096673239374204e-05, 'epoch': 1.9142857142857141}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:50:30. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_dc879b73   RUNNING      0.625202   2.69927       1.88223e-05         0.13641                     4                                                                                         â”‚
â”‚ train_hpo_e85c12e3   RUNNING      0.970578   4.6341        5.16112e-05         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_92a27caa   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            33.0836   0.000935636           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3601888)[0m {'loss': 0.0032, 'grad_norm': 0.10255253314971924, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3602050)[0m {'loss': 0.0002, 'grad_norm': 0.007865583524107933, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.914285714285714}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:51:00. Total running time: 2min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_dc879b73   RUNNING      0.625202   2.69927       1.88223e-05         0.13641                     4                                                                                         â”‚
â”‚ train_hpo_e85c12e3   RUNNING      0.970578   4.6341        5.16112e-05         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_92a27caa   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            33.0836   0.000935636           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3601888)[0m {'loss': 0.0018, 'grad_norm': 0.05939820036292076, 'learning_rate': 0.0, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3601888)[0m {'train_runtime': 110.0545, 'train_samples_per_second': 25.333, 'train_steps_per_second': 0.291, 'train_loss': 0.011133788502775133, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3601888)[0m STATE at ending of training  :  TrainerState(epoch=3.914285714285714, global_step=32, max_steps=32, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=688666448539920.0, log_history=[{'loss': 0.0307, 'grad_norm': 0.2529017925262451, 'learning_rate': 1.4116733618581595e-05, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.0088, 'grad_norm': 0.16838249564170837, 'learning_rate': 9.411155745721064e-06, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 0.0032, 'grad_norm': 0.10255253314971924, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 0.0018, 'grad_norm': 0.05939820036292076, 'learning_rate': 0.0, 'epoch': 3.914285714285714, 'step': 32}, {'train_runtime': 110.0545, 'train_samples_per_second': 25.333, 'train_steps_per_second': 0.291, 'total_flos': 688666448539920.0, 'train_loss': 0.011133788502775133, 'epoch': 3.914285714285714, 'step': 32}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3601888)[0m {'eval_loss': 0.0028089489787817, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.5623250603675842, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.8685, 'eval_samples_per_second': 17.061, 'eval_steps_per_second': 1.034, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3601888)[0m 2025-06-06 11:51:05,271 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3601888)[0m 2025-06-06 11:51:05,277 - INFO - eval_result: {'eval_loss': 0.0028089489787817, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.5623250603675842, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.8685, 'eval_samples_per_second': 17.061, 'eval_steps_per_second': 1.034, 'epoch': 3.914285714285714}

Trial train_hpo_dc879b73 finished iteration 1 at 2025-06-06 11:51:05. Total running time: 2min 5s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_dc879b73 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    118.535 â”‚
â”‚ time_total_s                        118.535 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               3.91429 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                                  1 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                             1 â”‚
â”‚ eval_f1                                   1 â”‚
â”‚ eval_kappa                                1 â”‚
â”‚ eval_loss                           0.00281 â”‚
â”‚ eval_optim_threshold                0.56233 â”‚
â”‚ eval_precision                            1 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.8685 â”‚
â”‚ eval_samples_per_second              17.061 â”‚
â”‚ eval_steps_per_second                 1.034 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:51:05,337 - INFO - Cleaning up trial dc879b73
2025-06-06 11:51:05,337 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-49-00/train_hpo_dc879b73_1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364_2025-06-06_11-49-00
2025-06-06 11:51:05,338 - INFO - Current best: 92a27caa with eval_f1 : 1.0 at iteration 1

Trial train_hpo_dc879b73 completed after 1 iterations at 2025-06-06 11:51:05. Total running time: 2min 5s
[36m(train_hpo pid=3601888)[0m 2025-06-06 11:51:05,313 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3602050)[0m {'loss': 0.0001, 'grad_norm': 0.0023624824825674295, 'learning_rate': 1.0322244131247348e-05, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3602050)[0m {'loss': 0.0, 'grad_norm': 0.0032247595954686403, 'learning_rate': 0.0, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3602050)[0m {'train_runtime': 123.6774, 'train_samples_per_second': 28.178, 'train_steps_per_second': 0.323, 'train_loss': 0.00100105125529808, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3602050)[0m STATE at ending of training  :  TrainerState(epoch=4.914285714285715, global_step=40, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=862318185914640.0, log_history=[{'loss': 0.0036, 'grad_norm': 0.03471459820866585, 'learning_rate': 4.128897652498939e-05, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.0011, 'grad_norm': 0.018936002627015114, 'learning_rate': 3.096673239374204e-05, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 0.0002, 'grad_norm': 0.007865583524107933, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 0.0001, 'grad_norm': 0.0023624824825674295, 'learning_rate': 1.0322244131247348e-05, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 0.0, 'grad_norm': 0.0032247595954686403, 'learning_rate': 0.0, 'epoch': 4.914285714285715, 'step': 40}, {'train_runtime': 123.6774, 'train_samples_per_second': 28.178, 'train_steps_per_second': 0.323, 'total_flos': 862318185914640.0, 'train_loss': 0.00100105125529808, 'epoch': 4.914285714285715, 'step': 40}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3602050)[0m {'eval_loss': 5.562363003264181e-05, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.7338682413101196, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.3526, 'eval_samples_per_second': 19.686, 'eval_steps_per_second': 1.193, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3602050)[0m 2025-06-06 11:51:24,954 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3602050)[0m 2025-06-06 11:51:24,960 - INFO - eval_result: {'eval_loss': 5.562363003264181e-05, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.7338682413101196, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.3526, 'eval_samples_per_second': 19.686, 'eval_steps_per_second': 1.193, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3602050)[0m 2025-06-06 11:51:24,994 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB

Trial train_hpo_e85c12e3 finished iteration 1 at 2025-06-06 11:51:25. Total running time: 2min 24s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_e85c12e3 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    131.565 â”‚
â”‚ time_total_s                        131.565 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               4.91429 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                                  1 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                             1 â”‚
â”‚ eval_f1                                   1 â”‚
â”‚ eval_kappa                                1 â”‚
â”‚ eval_loss                             6e-05 â”‚
â”‚ eval_optim_threshold                0.73387 â”‚
â”‚ eval_precision                            1 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.3526 â”‚
â”‚ eval_samples_per_second              19.686 â”‚
â”‚ eval_steps_per_second                 1.193 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:51:25,018 - INFO - Cleaning up trial e85c12e3
2025-06-06 11:51:25,018 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-49-00/train_hpo_e85c12e3_2_alpha=0.9706,gamma=4.6341,learning_rate=0.0001,num_train_epochs=5,weight_decay=0.1230_2025-06-06_11-49-06
2025-06-06 11:51:25,018 - INFO - Current best: dc879b73 with eval_f1 : 1.0 at iteration 1
2025-06-06 11:51:25,018 - INFO - Current best: 92a27caa with eval_f1 : 1.0 at iteration 1

Trial train_hpo_e85c12e3 completed after 1 iterations at 2025-06-06 11:51:25. Total running time: 2min 24s
2025-06-06 11:51:25,026	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-49-00' in 0.0058s.

Trial status: 3 TERMINATED
Current time: 2025-06-06 11:51:25. Total running time: 2min 24s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_dc879b73   TERMINATED   0.625202   2.69927       1.88223e-05         0.13641                     4        1           118.535    0.00280895            1               1                 1 â”‚
â”‚ train_hpo_e85c12e3   TERMINATED   0.970578   4.6341        5.16112e-05         0.123031                    5        1           131.565    5.56236e-05           1               1                 1 â”‚
â”‚ train_hpo_92a27caa   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            33.0836   0.000935636           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

2025-06-06 11:51:25,033 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x7016c28cf3d0>
2025-06-06 11:51:25,033 - INFO - Best trial : train_hpo_dc879b73
2025-06-06 11:51:25,033 - INFO - Best config : {'alpha': 0.6252016107931255, 'gamma': 2.6992695521978884, 'learning_rate': 1.8822311491442127e-05, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 4}
2025-06-06 11:51:25,033 - INFO - Best trial after optimization: {'eval_loss': 0.0028089489787817, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.5623250603675842, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.8685, 'eval_samples_per_second': 17.061, 'eval_steps_per_second': 1.034, 'epoch': 3.914285714285714, 'timestamp': 1749203465, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': 'dc879b73', 'date': '2025-06-06_11-51-05', 'time_this_iter_s': 118.53489279747009, 'time_total_s': 118.53489279747009, 'pid': 3601888, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'alpha': 0.6252016107931255, 'gamma': 2.6992695521978884, 'learning_rate': 1.8822311491442127e-05, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 4}, 'time_since_restore': 118.53489279747009, 'iterations_since_restore': 1, 'experiment_tag': '1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364'}
2025-06-06 11:51:25,055 - INFO - analysis dataframe :    eval_loss  eval_f1  ...  config/num_train_epochs    logdir
0   0.002809      1.0  ...                        4  dc879b73
1   0.000056      1.0  ...                        5  e85c12e3
2   0.000936      1.0  ...                        2  92a27caa

[3 rows x 33 columns]
2025-06-06 11:51:25,229 - INFO - Trial comparison plot saved
2025-06-06 11:51:25,229 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-06 11:51:25,795 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.25 and gamma=2.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-06 11:51:25,876 - INFO - training size : 697
2025-06-06 11:51:25,876 - INFO - dev size : 66
2025-06-06 11:51:25,876 - INFO - test size : 133
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
  0%|          | 0/120 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  1%|          | 1/120 [00:00<01:17,  1.53it/s]  2%|â–         | 2/120 [00:01<01:14,  1.59it/s]  2%|â–Ž         | 3/120 [00:01<01:12,  1.61it/s]  3%|â–Ž         | 4/120 [00:02<01:11,  1.62it/s]  4%|â–         | 5/120 [00:03<01:10,  1.63it/s]  5%|â–Œ         | 6/120 [00:03<01:10,  1.63it/s]  6%|â–Œ         | 7/120 [00:04<01:09,  1.63it/s]  7%|â–‹         | 8/120 [00:04<01:08,  1.63it/s]  8%|â–Š         | 9/120 [00:05<01:08,  1.63it/s]  8%|â–Š         | 10/120 [00:06<01:07,  1.63it/s]  9%|â–‰         | 11/120 [00:06<01:06,  1.63it/s] 10%|â–ˆ         | 12/120 [00:07<01:06,  1.63it/s] 11%|â–ˆ         | 13/120 [00:08<01:05,  1.63it/s] 12%|â–ˆâ–        | 14/120 [00:08<01:04,  1.63it/s] 12%|â–ˆâ–Ž        | 15/120 [00:09<01:04,  1.63it/s] 13%|â–ˆâ–Ž        | 16/120 [00:09<01:03,  1.63it/s] 14%|â–ˆâ–        | 17/120 [00:10<01:03,  1.63it/s] 15%|â–ˆâ–Œ        | 18/120 [00:11<01:02,  1.63it/s] 16%|â–ˆâ–Œ        | 19/120 [00:11<01:01,  1.63it/s] 17%|â–ˆâ–‹        | 20/120 [00:12<01:01,  1.63it/s] 18%|â–ˆâ–Š        | 21/120 [00:12<01:00,  1.63it/s] 18%|â–ˆâ–Š        | 22/120 [00:13<00:59,  1.63it/s] 19%|â–ˆâ–‰        | 23/120 [00:14<00:59,  1.63it/s] 20%|â–ˆâ–ˆ        | 24/120 [00:14<00:58,  1.63it/s] 21%|â–ˆâ–ˆ        | 25/120 [00:15<00:58,  1.63it/s] 22%|â–ˆâ–ˆâ–       | 26/120 [00:15<00:57,  1.63it/s] 22%|â–ˆâ–ˆâ–Ž       | 27/120 [00:16<00:57,  1.63it/s] 23%|â–ˆâ–ˆâ–Ž       | 28/120 [00:17<00:56,  1.63it/s] 24%|â–ˆâ–ˆâ–       | 29/120 [00:17<00:55,  1.64it/s]                                                {'loss': 0.0263, 'grad_norm': 0.1369808465242386, 'learning_rate': 1.4116733618581595e-05, 'epoch': 1.0}
 25%|â–ˆâ–ˆâ–Œ       | 30/120 [00:17<00:54,  1.64it/s] 26%|â–ˆâ–ˆâ–Œ       | 31/120 [00:18<00:43,  2.05it/s] 27%|â–ˆâ–ˆâ–‹       | 32/120 [00:19<00:45,  1.93it/s] 28%|â–ˆâ–ˆâ–Š       | 33/120 [00:19<00:47,  1.84it/s] 28%|â–ˆâ–ˆâ–Š       | 34/120 [00:20<00:48,  1.78it/s] 29%|â–ˆâ–ˆâ–‰       | 35/120 [00:20<00:48,  1.74it/s] 30%|â–ˆâ–ˆâ–ˆ       | 36/120 [00:21<00:49,  1.71it/s] 31%|â–ˆâ–ˆâ–ˆ       | 37/120 [00:22<00:49,  1.69it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 38/120 [00:22<00:49,  1.67it/s] 32%|â–ˆâ–ˆâ–ˆâ–Ž      | 39/120 [00:23<00:48,  1.66it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 40/120 [00:23<00:48,  1.66it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 41/120 [00:24<00:47,  1.66it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 42/120 [00:25<00:47,  1.65it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 43/120 [00:25<00:46,  1.65it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 44/120 [00:26<00:46,  1.64it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 45/120 [00:27<00:45,  1.64it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 46/120 [00:27<00:45,  1.64it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 47/120 [00:28<00:44,  1.64it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 48/120 [00:28<00:44,  1.64it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 49/120 [00:29<00:43,  1.64it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 50/120 [00:30<00:42,  1.63it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 51/120 [00:30<00:42,  1.63it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 52/120 [00:31<00:41,  1.63it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 53/120 [00:31<00:41,  1.63it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 54/120 [00:32<00:40,  1.63it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 55/120 [00:33<00:39,  1.63it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 56/120 [00:33<00:39,  1.63it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 57/120 [00:34<00:38,  1.63it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 58/120 [00:34<00:37,  1.63it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 59/120 [00:35<00:36,  1.65it/s]                                                {'loss': 0.003, 'grad_norm': 0.013728868216276169, 'learning_rate': 9.411155745721064e-06, 'epoch': 2.0}
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 60/120 [00:35<00:36,  1.65it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 61/120 [00:36<00:28,  2.07it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 62/120 [00:36<00:29,  1.94it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 63/120 [00:37<00:30,  1.85it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 64/120 [00:38<00:31,  1.79it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 65/120 [00:38<00:31,  1.74it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 66/120 [00:39<00:31,  1.71it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 67/120 [00:39<00:31,  1.69it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 68/120 [00:40<00:31,  1.67it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 69/120 [00:41<00:30,  1.66it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 70/120 [00:41<00:30,  1.65it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 71/120 [00:42<00:29,  1.64it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 72/120 [00:42<00:29,  1.64it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 73/120 [00:43<00:28,  1.64it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 74/120 [00:44<00:28,  1.64it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 75/120 [00:44<00:27,  1.63it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 76/120 [00:45<00:26,  1.63it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 77/120 [00:46<00:26,  1.63it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 78/120 [00:46<00:25,  1.63it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 79/120 [00:47<00:25,  1.63it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 80/120 [00:47<00:24,  1.63it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 81/120 [00:48<00:23,  1.63it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 82/120 [00:49<00:23,  1.63it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 83/120 [00:49<00:22,  1.63it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 84/120 [00:50<00:22,  1.63it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 85/120 [00:50<00:21,  1.63it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 86/120 [00:51<00:20,  1.63it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 87/120 [00:52<00:20,  1.63it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 88/120 [00:52<00:19,  1.63it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 89/120 [00:53<00:18,  1.65it/s]                                                {'loss': 0.0009, 'grad_norm': 0.39422327280044556, 'learning_rate': 4.705577872860532e-06, 'epoch': 3.0}
 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 90/120 [00:53<00:18,  1.65it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 91/120 [00:54<00:14,  2.07it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 92/120 [00:54<00:14,  1.94it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 93/120 [00:55<00:14,  1.85it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 94/120 [00:55<00:14,  1.78it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 95/120 [00:56<00:14,  1.74it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 96/120 [00:57<00:14,  1.71it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 97/120 [00:57<00:13,  1.69it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 98/120 [00:58<00:13,  1.67it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 99/120 [00:58<00:12,  1.66it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 100/120 [00:59<00:12,  1.65it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 101/120 [01:00<00:11,  1.65it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 102/120 [01:00<00:10,  1.64it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 103/120 [01:01<00:10,  1.64it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 104/120 [01:02<00:09,  1.64it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 105/120 [01:02<00:09,  1.64it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 106/120 [01:03<00:08,  1.63it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 107/120 [01:03<00:07,  1.63it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 108/120 [01:04<00:07,  1.63it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 109/120 [01:05<00:06,  1.63it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 110/120 [01:05<00:06,  1.64it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 111/120 [01:06<00:05,  1.64it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 112/120 [01:06<00:04,  1.64it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 113/120 [01:07<00:04,  1.64it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 114/120 [01:08<00:03,  1.64it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 115/120 [01:08<00:03,  1.63it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 116/120 [01:09<00:02,  1.63it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 117/120 [01:09<00:01,  1.63it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 118/120 [01:10<00:01,  1.63it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 119/120 [01:11<00:00,  1.65it/s]                                                 {'loss': 0.0003, 'grad_norm': 0.004977629519999027, 'learning_rate': 0.0, 'epoch': 4.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120/120 [01:12<00:00,  1.65it/s]                                                 {'train_runtime': 72.9239, 'train_samples_per_second': 38.232, 'train_steps_per_second': 1.646, 'train_loss': 0.007623855195318659, 'epoch': 4.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120/120 [01:12<00:00,  1.65it/s]2025-06-06 11:52:39,275 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 120/120 [01:12<00:00,  1.65it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.32it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.66it/s]2025-06-06 11:52:42,904 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.11s/it]
2025-06-06 11:52:42,910 - INFO - Training time : 77.68088513915427
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.18it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.07it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.39it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.13it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.28it/s]2025-06-06 11:52:47,355 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.45it/s]
2025-06-06 11:52:47,360 - INFO - Evaluation time : 4.450344773009419
2025-06-06 11:52:47,360 - INFO - Evaluation results on test set: {'eval_loss': 0.0005420536617748439, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.8288740515708923, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000004, 'eval_kappa': 1.0, 'eval_runtime': 4.4459, 'eval_samples_per_second': 29.915, 'eval_steps_per_second': 1.35, 'epoch': 4.0}
2025-06-06 11:52:47,360 - INFO - Total updates (optimizer steps): 120
2025-06-06 11:52:47,360 - INFO - Avg time / step: 0.608s
2025-06-06 11:52:48,102 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_focaldmis-lab/biobert-v1.13trials_fold-1
2025-06-06 11:52:48,102 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.19it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.07it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.38it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.11it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.27it/s]2025-06-06 11:52:52,610 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.43it/s]
2025-06-06 11:52:52,614 - INFO - preds : [1 1 1 0 0 1 1 1 1 1 1 1 0 0 1 0 1 0 1 1 1 0 1 1 0 0 0 0 0 0 0 1 1 1 1 1 1
 1 1 1 0 1 1 0 0 1 1 1 1 1 1 1 1 0 0 1 1 1 1 0 1 1 1 1 1 0 1 1 0 1 1 1 1 1
 0 1 0 1 0 0 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 0 0 1 0 1 1 1
 1 0 0 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 0]
2025-06-06 11:52:52,615 - INFO - test_split["labels"] : [1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0]
2025-06-06 11:52:52,617 - INFO - Confusion matrix: TN=35, FP=0, FN=0, TP=98
2025-06-06 11:52:55,541 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 35, 'FP': 0, 'FN': 0, 'TP': 98}
2025-06-06 11:52:55,653 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-06 11:52:55,745 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 11:52:55,745 - INFO - 
On test Set (optimal threshold of 0.641383171081543 according to cross validation on the training set): 
2025-06-06 11:52:55,747 - INFO - Confusion matrix: TN=35, FP=0, FN=0, TP=98
2025-06-06 11:52:58,532 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 35, 'FP': 0, 'FN': 0, 'TP': 98}
2025-06-06 11:52:58,625 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 11:52:58,625 - INFO - Results for fold 1 : [{'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 35, 'FP': 0, 'FN': 0, 'TP': 98}]
2025-06-06 11:52:58,745 - INFO - Cleared CUDA cache. Memory allocated: 1.41 GB, Memory reserved: 1.85 GB
2025-06-06 11:52:58,746 - INFO - 
fold number 2 / 3
2025-06-06 11:52:58,752 - INFO - train split size : 697
2025-06-06 11:52:58,752 - INFO - dev split size : 67
2025-06-06 11:52:58,752 - INFO - test split size : 132
Map (num_proc=32):   0%|          | 0/697 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 22/697 [00:00<00:06, 98.55 examples/s]Map (num_proc=32):  19%|â–ˆâ–‰        | 132/697 [00:00<00:01, 438.08 examples/s]Map (num_proc=32):  38%|â–ˆâ–ˆâ–ˆâ–Š      | 264/697 [00:00<00:00, 676.22 examples/s]Map (num_proc=32):  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 374/697 [00:00<00:00, 776.02 examples/s]Map (num_proc=32):  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 484/697 [00:00<00:00, 826.51 examples/s]Map (num_proc=32):  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 592/697 [00:00<00:00, 841.30 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 697/697 [00:00<00:00, 883.82 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 697/697 [00:01<00:00, 651.12 examples/s]
Map (num_proc=32):   0%|          | 0/67 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/67 [00:00<00:03, 17.42 examples/s]Map (num_proc=32):  22%|â–ˆâ–ˆâ–       | 15/67 [00:00<00:00, 60.53 examples/s]Map (num_proc=32):  37%|â–ˆâ–ˆâ–ˆâ–‹      | 25/67 [00:00<00:00, 72.91 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 35/67 [00:00<00:00, 77.13 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 45/67 [00:00<00:00, 81.45 examples/s]Map (num_proc=32):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 55/67 [00:00<00:00, 82.98 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 65/67 [00:00<00:00, 84.18 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:01<00:00, 66.25 examples/s]
Map (num_proc=32):   0%|          | 0/132 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/132 [00:00<00:04, 25.69 examples/s]Map (num_proc=32):  18%|â–ˆâ–Š        | 24/132 [00:00<00:01, 93.07 examples/s]Map (num_proc=32):  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 44/132 [00:00<00:00, 124.01 examples/s]Map (num_proc=32):  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 60/132 [00:00<00:00, 130.31 examples/s]Map (num_proc=32):  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 80/132 [00:00<00:00, 142.62 examples/s]Map (num_proc=32):  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 100/132 [00:00<00:00, 151.45 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 120/132 [00:00<00:00, 151.66 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 132/132 [00:01<00:00, 120.96 examples/s]
2025-06-06 11:53:08,258 - INFO - 3 datasets tokenized successfully
2025-06-06 11:53:08,260 - INFO - Starting hyperparameter search for focal loss
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-06_11-53-08   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-53-08
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-06_10-55-47_424551_3536632/artifacts/2025-06-06_11-53-08/train_hpo_2025-06-06_11-53-08/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-06 11:53:08. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_8d07b64f   PENDING    0.625202   2.69927       1.88223e-05          0.13641                    4 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_8d07b64f started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_8d07b64f config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                                0.6252 â”‚
â”‚ gamma                               2.69927 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          4 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3606794)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3606794)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3606794)[0m 2025-06-06 11:53:16,432 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.6252016107931255 and gamma=2.6992695521978884
[36m(train_hpo pid=3606794)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3606794)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3606794)[0m [2025-06-06 11:53:16,693] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3606794)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3606794)[0m   warnings.warn(
[36m(train_hpo pid=3606794)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=32, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_9ea6ba76 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_9ea6ba76 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.97058 â”‚
â”‚ gamma                                4.6341 â”‚
â”‚ learning_rate                         5e-05 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3607025)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3607025)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3607025)[0m 2025-06-06 11:53:23,142 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.970577641092792 and gamma=4.634102840173219
[36m(train_hpo pid=3607025)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3607025)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3607025)[0m [2025-06-06 11:53:23,535] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3607025)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3607025)[0m   warnings.warn(
[36m(train_hpo pid=3607025)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_a350ecae started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_a350ecae config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.78112 â”‚
â”‚ gamma                               6.80707 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          2 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3607240)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3607240)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3607240)[0m 2025-06-06 11:53:30,201 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.7811204413478371 and gamma=6.807074484302038
[36m(train_hpo pid=3607240)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3607240)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3607240)[0m [2025-06-06 11:53:30,423] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3607240)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=16, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3607240)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3607240)[0m   warnings.warn(

Trial status: 3 RUNNING
Current time: 2025-06-06 11:53:38. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_8d07b64f   RUNNING    0.625202   2.69927       1.88223e-05         0.13641                     4 â”‚
â”‚ train_hpo_9ea6ba76   RUNNING    0.970578   4.6341        5.16112e-05         0.123031                    5 â”‚
â”‚ train_hpo_a350ecae   RUNNING    0.78112    6.80707       1.88581e-05         0.251217                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3606794)[0m {'loss': 0.0478, 'grad_norm': 0.5095211267471313, 'learning_rate': 1.4116733618581595e-05, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3607240)[0m {'loss': 0.0027, 'grad_norm': 0.05688539147377014, 'learning_rate': 9.429055465477227e-06, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3607025)[0m {'loss': 0.0088, 'grad_norm': 0.10217808187007904, 'learning_rate': 4.128897652498939e-05, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3607240)[0m {'train_runtime': 25.2182, 'train_samples_per_second': 55.278, 'train_steps_per_second': 0.634, 'train_loss': 0.002093147486448288, 'epoch': 1.9142857142857141}
[36m(train_hpo pid=3607240)[0m STATE at ending of training  :  TrainerState(epoch=1.9142857142857141, global_step=16, max_steps=16, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=342041300889600.0, log_history=[{'loss': 0.0027, 'grad_norm': 0.05688539147377014, 'learning_rate': 9.429055465477227e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.0015, 'grad_norm': 0.015432259999215603, 'learning_rate': 0.0, 'epoch': 1.9142857142857141, 'step': 16}, {'train_runtime': 25.2182, 'train_samples_per_second': 55.278, 'train_steps_per_second': 0.634, 'total_flos': 342041300889600.0, 'train_loss': 0.002093147486448288, 'epoch': 1.9142857142857141, 'step': 16}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3607240)[0m {'eval_loss': 0.0019255585502833128, 'eval_f1': 0.9411764705882353, 'eval_recall': 0.9795918367346939, 'eval_accuracy': 0.9104477611940298, 'eval_precision': 0.9056603773584906, 'eval_optim_threshold': 0.5238311290740967, 'eval_AP': 0.9970324864639735, 'eval_MCC': 0.7651637797430266, 'eval_NDCG': 0.9994763177504795, 'eval_kappa': 0.7548780487804878, 'eval_runtime': 3.326, 'eval_samples_per_second': 20.145, 'eval_steps_per_second': 1.203, 'epoch': 1.9142857142857141}
[36m(train_hpo pid=3607240)[0m {'loss': 0.0015, 'grad_norm': 0.015432259999215603, 'learning_rate': 0.0, 'epoch': 1.9142857142857141}
[36m(train_hpo pid=3607240)[0m 2025-06-06 11:54:02,141 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3607240)[0m 2025-06-06 11:54:02,147 - INFO - eval_result: {'eval_loss': 0.0019255585502833128, 'eval_f1': 0.9411764705882353, 'eval_recall': 0.9795918367346939, 'eval_accuracy': 0.9104477611940298, 'eval_precision': 0.9056603773584906, 'eval_optim_threshold': 0.5238311290740967, 'eval_AP': 0.9970324864639735, 'eval_MCC': 0.7651637797430266, 'eval_NDCG': 0.9994763177504795, 'eval_kappa': 0.7548780487804878, 'eval_runtime': 3.326, 'eval_samples_per_second': 20.145, 'eval_steps_per_second': 1.203, 'epoch': 1.9142857142857141}

Trial train_hpo_a350ecae finished iteration 1 at 2025-06-06 11:54:02. Total running time: 53s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_a350ecae result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    32.8854 â”‚
â”‚ time_total_s                        32.8854 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               1.91429 â”‚
â”‚ eval_AP                             0.99703 â”‚
â”‚ eval_MCC                            0.76516 â”‚
â”‚ eval_NDCG                           0.99948 â”‚
â”‚ eval_accuracy                       0.91045 â”‚
â”‚ eval_f1                             0.94118 â”‚
â”‚ eval_kappa                          0.75488 â”‚
â”‚ eval_loss                           0.00193 â”‚
â”‚ eval_optim_threshold                0.52383 â”‚
â”‚ eval_precision                      0.90566 â”‚
â”‚ eval_recall                         0.97959 â”‚
â”‚ eval_runtime                          3.326 â”‚
â”‚ eval_samples_per_second              20.145 â”‚
â”‚ eval_steps_per_second                 1.203 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:54:02,210 - INFO - Cleaning up trial a350ecae
2025-06-06 11:54:02,210 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-53-08/train_hpo_a350ecae_3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512_2025-06-06_11-53-22

Trial train_hpo_a350ecae completed after 1 iterations at 2025-06-06 11:54:02. Total running time: 53s
[36m(train_hpo pid=3607240)[0m 2025-06-06 11:54:02,184 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:54:09. Total running time: 1min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_8d07b64f   RUNNING      0.625202   2.69927       1.88223e-05         0.13641                     4                                                                                         â”‚
â”‚ train_hpo_9ea6ba76   RUNNING      0.970578   4.6341        5.16112e-05         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_a350ecae   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            32.8854    0.00192556    0.941176        0.979592          0.910448 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3606794)[0m {'loss': 0.015, 'grad_norm': 0.3048533499240875, 'learning_rate': 9.411155745721064e-06, 'epoch': 1.9142857142857141}
[36m(train_hpo pid=3607025)[0m {'loss': 0.001, 'grad_norm': 0.10447273403406143, 'learning_rate': 3.096673239374204e-05, 'epoch': 1.9142857142857141}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:54:39. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_8d07b64f   RUNNING      0.625202   2.69927       1.88223e-05         0.13641                     4                                                                                         â”‚
â”‚ train_hpo_9ea6ba76   RUNNING      0.970578   4.6341        5.16112e-05         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_a350ecae   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            32.8854    0.00192556    0.941176        0.979592          0.910448 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3606794)[0m {'loss': 0.0096, 'grad_norm': 0.2517677843570709, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3607025)[0m {'loss': 0.0004, 'grad_norm': 0.020582953467965126, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.914285714285714}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:55:09. Total running time: 2min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_8d07b64f   RUNNING      0.625202   2.69927       1.88223e-05         0.13641                     4                                                                                         â”‚
â”‚ train_hpo_9ea6ba76   RUNNING      0.970578   4.6341        5.16112e-05         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_a350ecae   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            32.8854    0.00192556    0.941176        0.979592          0.910448 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3606794)[0m {'loss': 0.0075, 'grad_norm': 0.21247005462646484, 'learning_rate': 0.0, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3606794)[0m {'train_runtime': 109.2079, 'train_samples_per_second': 25.529, 'train_steps_per_second': 0.293, 'train_loss': 0.019981592195108533, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3606794)[0m STATE at ending of training  :  TrainerState(epoch=3.914285714285714, global_step=32, max_steps=32, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=689241998805840.0, log_history=[{'loss': 0.0478, 'grad_norm': 0.5095211267471313, 'learning_rate': 1.4116733618581595e-05, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.015, 'grad_norm': 0.3048533499240875, 'learning_rate': 9.411155745721064e-06, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 0.0096, 'grad_norm': 0.2517677843570709, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 0.0075, 'grad_norm': 0.21247005462646484, 'learning_rate': 0.0, 'epoch': 3.914285714285714, 'step': 32}, {'train_runtime': 109.2079, 'train_samples_per_second': 25.529, 'train_steps_per_second': 0.293, 'total_flos': 689241998805840.0, 'train_loss': 0.019981592195108533, 'epoch': 3.914285714285714, 'step': 32}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_8d07b64f finished iteration 1 at 2025-06-06 11:55:13. Total running time: 2min 4s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_8d07b64f result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    117.626 â”‚
â”‚ time_total_s                        117.626 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               3.91429 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                            0.77067 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                       0.91045 â”‚
â”‚ eval_f1                             0.94231 â”‚
â”‚ eval_kappa                          0.74525 â”‚
â”‚ eval_loss                           0.02042 â”‚
â”‚ eval_optim_threshold                0.59603 â”‚
â”‚ eval_precision                      0.89091 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.9226 â”‚
â”‚ eval_samples_per_second              17.081 â”‚
â”‚ eval_steps_per_second                  1.02 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:55:13,174 - INFO - Cleaning up trial 8d07b64f
2025-06-06 11:55:13,174 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-53-08/train_hpo_8d07b64f_1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364_2025-06-06_11-53-08
2025-06-06 11:55:13,174 - INFO - Cleaning up trial a350ecae
2025-06-06 11:55:13,174 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-53-08/train_hpo_a350ecae_3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512_2025-06-06_11-53-22

Trial train_hpo_8d07b64f completed after 1 iterations at 2025-06-06 11:55:13. Total running time: 2min 4s
[36m(train_hpo pid=3606794)[0m 2025-06-06 11:55:13,109 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3606794)[0m 2025-06-06 11:55:13,115 - INFO - eval_result: {'eval_loss': 0.02041524089872837, 'eval_f1': 0.9423076923076923, 'eval_recall': 1.0, 'eval_accuracy': 0.9104477611940298, 'eval_precision': 0.8909090909090909, 'eval_optim_threshold': 0.5960251092910767, 'eval_AP': 1.0, 'eval_MCC': 0.7706746355884524, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 0.7452471482889733, 'eval_runtime': 3.9226, 'eval_samples_per_second': 17.081, 'eval_steps_per_second': 1.02, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3606794)[0m 2025-06-06 11:55:13,150 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3606794)[0m {'eval_loss': 0.02041524089872837, 'eval_f1': 0.9423076923076923, 'eval_recall': 1.0, 'eval_accuracy': 0.9104477611940298, 'eval_precision': 0.8909090909090909, 'eval_optim_threshold': 0.5960251092910767, 'eval_AP': 1.0, 'eval_MCC': 0.7706746355884524, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 0.7452471482889733, 'eval_runtime': 3.9226, 'eval_samples_per_second': 17.081, 'eval_steps_per_second': 1.02, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3607025)[0m {'loss': 0.0003, 'grad_norm': 0.008620407432317734, 'learning_rate': 1.0322244131247348e-05, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3607025)[0m {'loss': 0.0002, 'grad_norm': 0.01078126486390829, 'learning_rate': 0.0, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3607025)[0m {'train_runtime': 122.6258, 'train_samples_per_second': 28.42, 'train_steps_per_second': 0.326, 'train_loss': 0.0021346800174796956, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3607025)[0m STATE at ending of training  :  TrainerState(epoch=4.914285714285715, global_step=40, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=862780681664040.0, log_history=[{'loss': 0.0088, 'grad_norm': 0.10217808187007904, 'learning_rate': 4.128897652498939e-05, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.001, 'grad_norm': 0.10447273403406143, 'learning_rate': 3.096673239374204e-05, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 0.0004, 'grad_norm': 0.020582953467965126, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 0.0003, 'grad_norm': 0.008620407432317734, 'learning_rate': 1.0322244131247348e-05, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 0.0002, 'grad_norm': 0.01078126486390829, 'learning_rate': 0.0, 'epoch': 4.914285714285715, 'step': 40}, {'train_runtime': 122.6258, 'train_samples_per_second': 28.42, 'train_steps_per_second': 0.326, 'total_flos': 862780681664040.0, 'train_loss': 0.0021346800174796956, 'epoch': 4.914285714285715, 'step': 40}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_9ea6ba76 finished iteration 1 at 2025-06-06 11:55:32. Total running time: 2min 24s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_9ea6ba76 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    130.665 â”‚
â”‚ time_total_s                        130.665 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               4.91429 â”‚
â”‚ eval_AP                             0.99918 â”‚
â”‚ eval_MCC                            0.84798 â”‚
â”‚ eval_NDCG                           0.99986 â”‚
â”‚ eval_accuracy                        0.9403 â”‚
â”‚ eval_f1                             0.96078 â”‚
â”‚ eval_kappa                          0.83659 â”‚
â”‚ eval_loss                           0.00038 â”‚
â”‚ eval_optim_threshold                0.75801 â”‚
â”‚ eval_precision                      0.92453 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.4453 â”‚
â”‚ eval_samples_per_second              19.447 â”‚
â”‚ eval_steps_per_second                 1.161 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:55:32,965 - INFO - Cleaning up trial 9ea6ba76
2025-06-06 11:55:32,965 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-53-08/train_hpo_9ea6ba76_2_alpha=0.9706,gamma=4.6341,learning_rate=0.0001,num_train_epochs=5,weight_decay=0.1230_2025-06-06_11-53-15
2025-06-06 11:55:32,965 - INFO - Cleaning up trial 8d07b64f
2025-06-06 11:55:32,965 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-53-08/train_hpo_8d07b64f_1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364_2025-06-06_11-53-08
2025-06-06 11:55:32,965 - INFO - Cleaning up trial a350ecae
2025-06-06 11:55:32,966 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-53-08/train_hpo_a350ecae_3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512_2025-06-06_11-53-22

Trial train_hpo_9ea6ba76 completed after 1 iterations at 2025-06-06 11:55:32. Total running time: 2min 24s
2025-06-06 11:55:32,973	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-53-08' in 0.0055s.

Trial status: 3 TERMINATED
Current time: 2025-06-06 11:55:32. Total running time: 2min 24s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_8d07b64f   TERMINATED   0.625202   2.69927       1.88223e-05         0.13641                     4        1           117.626    0.0204152      0.942308        1                 0.910448 â”‚
â”‚ train_hpo_9ea6ba76   TERMINATED   0.970578   4.6341        5.16112e-05         0.123031                    5        1           130.665    0.000384411    0.960784        1                 0.940299 â”‚
â”‚ train_hpo_a350ecae   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            32.8854   0.00192556     0.941176        0.979592          0.910448 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

2025-06-06 11:55:32,980 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x700d582b9a50>
2025-06-06 11:55:32,980 - INFO - Best trial : train_hpo_9ea6ba76
2025-06-06 11:55:32,980 - INFO - Best config : {'alpha': 0.970577641092792, 'gamma': 4.634102840173219, 'learning_rate': 5.1611220656236736e-05, 'weight_decay': 0.12303118765599412, 'num_train_epochs': 5}
2025-06-06 11:55:32,980 - INFO - Best trial after optimization: {'eval_loss': 0.0003844109596684575, 'eval_f1': 0.9607843137254902, 'eval_recall': 1.0, 'eval_accuracy': 0.9402985074626866, 'eval_precision': 0.9245283018867925, 'eval_optim_threshold': 0.7580111622810364, 'eval_AP': 0.9991753436068306, 'eval_MCC': 0.8479844150302362, 'eval_NDCG': 0.9998575507973486, 'eval_kappa': 0.8365853658536586, 'eval_runtime': 3.4453, 'eval_samples_per_second': 19.447, 'eval_steps_per_second': 1.161, 'epoch': 4.914285714285715, 'timestamp': 1749203732, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '9ea6ba76', 'date': '2025-06-06_11-55-32', 'time_this_iter_s': 130.66498160362244, 'time_total_s': 130.66498160362244, 'pid': 3607025, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'alpha': 0.970577641092792, 'gamma': 4.634102840173219, 'learning_rate': 5.1611220656236736e-05, 'weight_decay': 0.12303118765599412, 'num_train_epochs': 5}, 'time_since_restore': 130.66498160362244, 'iterations_since_restore': 1, 'experiment_tag': '2_alpha=0.9706,gamma=4.6341,learning_rate=0.0001,num_train_epochs=5,weight_decay=0.1230'}
2025-06-06 11:55:33,000 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   0.020415  0.942308  ...                        4  8d07b64f
1   0.000384  0.960784  ...                        5  9ea6ba76
2   0.001926  0.941176  ...                        2  a350ecae

[3 rows x 33 columns]
[36m(train_hpo pid=3607025)[0m 2025-06-06 11:55:32,902 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3607025)[0m 2025-06-06 11:55:32,908 - INFO - eval_result: {'eval_loss': 0.0003844109596684575, 'eval_f1': 0.9607843137254902, 'eval_recall': 1.0, 'eval_accuracy': 0.9402985074626866, 'eval_precision': 0.9245283018867925, 'eval_optim_threshold': 0.7580111622810364, 'eval_AP': 0.9991753436068306, 'eval_MCC': 0.8479844150302362, 'eval_NDCG': 0.9998575507973486, 'eval_kappa': 0.8365853658536586, 'eval_runtime': 3.4453, 'eval_samples_per_second': 19.447, 'eval_steps_per_second': 1.161, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3607025)[0m 2025-06-06 11:55:32,941 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3607025)[0m {'eval_loss': 0.0003844109596684575, 'eval_f1': 0.9607843137254902, 'eval_recall': 1.0, 'eval_accuracy': 0.9402985074626866, 'eval_precision': 0.9245283018867925, 'eval_optim_threshold': 0.7580111622810364, 'eval_AP': 0.9991753436068306, 'eval_MCC': 0.8479844150302362, 'eval_NDCG': 0.9998575507973486, 'eval_kappa': 0.8365853658536586, 'eval_runtime': 3.4453, 'eval_samples_per_second': 19.447, 'eval_steps_per_second': 1.161, 'epoch': 4.914285714285715}
2025-06-06 11:55:33,185 - INFO - Trial comparison plot saved
2025-06-06 11:55:33,186 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-06 11:55:33,849 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.25 and gamma=2.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-06 11:55:33,938 - INFO - training size : 697
2025-06-06 11:55:33,939 - INFO - dev size : 67
2025-06-06 11:55:33,939 - INFO - test size : 132
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
  0%|          | 0/150 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  1%|          | 1/150 [00:00<01:35,  1.56it/s]  1%|â–         | 2/150 [00:01<01:32,  1.60it/s]  2%|â–         | 3/150 [00:01<01:31,  1.61it/s]  3%|â–Ž         | 4/150 [00:02<01:30,  1.62it/s]  3%|â–Ž         | 5/150 [00:03<01:29,  1.62it/s]  4%|â–         | 6/150 [00:03<01:28,  1.63it/s]  5%|â–         | 7/150 [00:04<01:27,  1.63it/s]  5%|â–Œ         | 8/150 [00:04<01:27,  1.63it/s]  6%|â–Œ         | 9/150 [00:05<01:26,  1.63it/s]  7%|â–‹         | 10/150 [00:06<01:25,  1.63it/s]  7%|â–‹         | 11/150 [00:06<01:25,  1.63it/s]  8%|â–Š         | 12/150 [00:07<01:24,  1.63it/s]  9%|â–Š         | 13/150 [00:07<01:23,  1.63it/s]  9%|â–‰         | 14/150 [00:08<01:23,  1.63it/s] 10%|â–ˆ         | 15/150 [00:09<01:22,  1.63it/s] 11%|â–ˆ         | 16/150 [00:09<01:22,  1.63it/s] 11%|â–ˆâ–        | 17/150 [00:10<01:21,  1.63it/s] 12%|â–ˆâ–        | 18/150 [00:11<01:20,  1.63it/s] 13%|â–ˆâ–Ž        | 19/150 [00:11<01:20,  1.63it/s] 13%|â–ˆâ–Ž        | 20/150 [00:12<01:19,  1.63it/s] 14%|â–ˆâ–        | 21/150 [00:12<01:19,  1.63it/s] 15%|â–ˆâ–        | 22/150 [00:13<01:18,  1.63it/s] 15%|â–ˆâ–Œ        | 23/150 [00:14<01:17,  1.63it/s] 16%|â–ˆâ–Œ        | 24/150 [00:14<01:17,  1.63it/s] 17%|â–ˆâ–‹        | 25/150 [00:15<01:16,  1.64it/s] 17%|â–ˆâ–‹        | 26/150 [00:15<01:15,  1.63it/s] 18%|â–ˆâ–Š        | 27/150 [00:16<01:15,  1.63it/s] 19%|â–ˆâ–Š        | 28/150 [00:17<01:14,  1.63it/s] 19%|â–ˆâ–‰        | 29/150 [00:17<01:13,  1.64it/s]                                                {'loss': 0.0015, 'grad_norm': 0.011623905040323734, 'learning_rate': 4.128897652498939e-05, 'epoch': 1.0}
 20%|â–ˆâ–ˆ        | 30/150 [00:17<01:13,  1.64it/s] 21%|â–ˆâ–ˆ        | 31/150 [00:18<00:58,  2.04it/s] 21%|â–ˆâ–ˆâ–       | 32/150 [00:19<01:01,  1.92it/s] 22%|â–ˆâ–ˆâ–       | 33/150 [00:19<01:03,  1.84it/s] 23%|â–ˆâ–ˆâ–Ž       | 34/150 [00:20<01:05,  1.77it/s] 23%|â–ˆâ–ˆâ–Ž       | 35/150 [00:20<01:06,  1.73it/s] 24%|â–ˆâ–ˆâ–       | 36/150 [00:21<01:06,  1.70it/s] 25%|â–ˆâ–ˆâ–       | 37/150 [00:22<01:07,  1.68it/s] 25%|â–ˆâ–ˆâ–Œ       | 38/150 [00:22<01:07,  1.67it/s] 26%|â–ˆâ–ˆâ–Œ       | 39/150 [00:23<01:07,  1.66it/s] 27%|â–ˆâ–ˆâ–‹       | 40/150 [00:24<01:06,  1.65it/s] 27%|â–ˆâ–ˆâ–‹       | 41/150 [00:24<01:06,  1.64it/s] 28%|â–ˆâ–ˆâ–Š       | 42/150 [00:25<01:05,  1.64it/s] 29%|â–ˆâ–ˆâ–Š       | 43/150 [00:25<01:05,  1.64it/s] 29%|â–ˆâ–ˆâ–‰       | 44/150 [00:26<01:04,  1.64it/s] 30%|â–ˆâ–ˆâ–ˆ       | 45/150 [00:27<01:04,  1.63it/s] 31%|â–ˆâ–ˆâ–ˆ       | 46/150 [00:27<01:03,  1.63it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 47/150 [00:28<01:02,  1.64it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 48/150 [00:28<01:02,  1.63it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 49/150 [00:29<01:01,  1.63it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 50/150 [00:30<01:01,  1.63it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 51/150 [00:30<01:00,  1.63it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 52/150 [00:31<01:00,  1.63it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 53/150 [00:31<00:59,  1.63it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 54/150 [00:32<00:58,  1.63it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 55/150 [00:33<00:58,  1.63it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 56/150 [00:33<00:57,  1.63it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 57/150 [00:34<00:56,  1.63it/s] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 58/150 [00:35<00:56,  1.63it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 59/150 [00:35<00:55,  1.65it/s]                                                {'loss': 0.0001, 'grad_norm': 0.000396531744627282, 'learning_rate': 3.096673239374204e-05, 'epoch': 2.0}
 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 60/150 [00:35<00:54,  1.65it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 61/150 [00:36<00:43,  2.07it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 62/150 [00:36<00:45,  1.94it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 63/150 [00:37<00:47,  1.85it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 64/150 [00:38<00:48,  1.78it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 65/150 [00:38<00:48,  1.74it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 66/150 [00:39<00:49,  1.71it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 67/150 [00:39<00:49,  1.69it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 68/150 [00:40<00:49,  1.67it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 69/150 [00:41<00:48,  1.66it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 70/150 [00:41<00:48,  1.65it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 71/150 [00:42<00:48,  1.64it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 72/150 [00:43<00:47,  1.64it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 73/150 [00:43<00:47,  1.64it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 74/150 [00:44<00:46,  1.64it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 75/150 [00:44<00:45,  1.63it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 76/150 [00:45<00:45,  1.63it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 77/150 [00:46<00:44,  1.63it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 78/150 [00:46<00:44,  1.63it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 79/150 [00:47<00:43,  1.63it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 80/150 [00:47<00:42,  1.63it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 81/150 [00:48<00:42,  1.63it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 82/150 [00:49<00:41,  1.63it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 83/150 [00:49<00:41,  1.63it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 84/150 [00:50<00:40,  1.63it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 85/150 [00:51<00:39,  1.63it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 86/150 [00:51<00:39,  1.63it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 87/150 [00:52<00:38,  1.63it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 88/150 [00:52<00:37,  1.63it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 89/150 [00:53<00:37,  1.65it/s]                                                {'loss': 0.0, 'grad_norm': 0.0022029585670679808, 'learning_rate': 2.0644488262494696e-05, 'epoch': 3.0}
 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 90/150 [00:53<00:36,  1.65it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 91/150 [00:54<00:28,  2.07it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 92/150 [00:54<00:29,  1.94it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 93/150 [00:55<00:30,  1.84it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 94/150 [00:55<00:31,  1.78it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 95/150 [00:56<00:31,  1.74it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 96/150 [00:57<00:31,  1.70it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 97/150 [00:57<00:31,  1.68it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 98/150 [00:58<00:31,  1.67it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 99/150 [00:59<00:30,  1.66it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 100/150 [00:59<00:30,  1.65it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 101/150 [01:00<00:29,  1.65it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 102/150 [01:00<00:29,  1.64it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 103/150 [01:01<00:28,  1.64it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 104/150 [01:02<00:28,  1.64it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 105/150 [01:02<00:27,  1.63it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 106/150 [01:03<00:26,  1.63it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 107/150 [01:03<00:26,  1.63it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 108/150 [01:04<00:25,  1.63it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 109/150 [01:05<00:25,  1.63it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 110/150 [01:05<00:24,  1.64it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 111/150 [01:06<00:23,  1.64it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 112/150 [01:06<00:23,  1.64it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 113/150 [01:07<00:22,  1.64it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 114/150 [01:08<00:22,  1.63it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 115/150 [01:08<00:21,  1.63it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 116/150 [01:09<00:20,  1.63it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 117/150 [01:10<00:20,  1.63it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 118/150 [01:10<00:19,  1.63it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 119/150 [01:11<00:18,  1.65it/s]                                                 {'loss': 0.0, 'grad_norm': 0.00011978895054198802, 'learning_rate': 1.0322244131247348e-05, 'epoch': 4.0}
 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 120/150 [01:11<00:18,  1.65it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 121/150 [01:11<00:14,  2.07it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 122/150 [01:12<00:14,  1.94it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 123/150 [01:13<00:14,  1.85it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 124/150 [01:13<00:14,  1.78it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 125/150 [01:14<00:14,  1.74it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 126/150 [01:15<00:14,  1.71it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 127/150 [01:15<00:13,  1.69it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 128/150 [01:16<00:13,  1.67it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 129/150 [01:16<00:12,  1.66it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 130/150 [01:17<00:12,  1.65it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 131/150 [01:18<00:11,  1.65it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 132/150 [01:18<00:10,  1.64it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 133/150 [01:19<00:10,  1.64it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 134/150 [01:19<00:09,  1.64it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 135/150 [01:20<00:09,  1.64it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 136/150 [01:21<00:08,  1.63it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 137/150 [01:21<00:07,  1.63it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 138/150 [01:22<00:07,  1.63it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 139/150 [01:22<00:06,  1.63it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 140/150 [01:23<00:06,  1.63it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 141/150 [01:24<00:05,  1.63it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 142/150 [01:24<00:04,  1.63it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 143/150 [01:25<00:04,  1.63it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 144/150 [01:26<00:03,  1.63it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 145/150 [01:26<00:03,  1.63it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 146/150 [01:27<00:02,  1.63it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 147/150 [01:27<00:01,  1.63it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 148/150 [01:28<00:01,  1.63it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 149/150 [01:29<00:00,  1.65it/s]                                                 {'loss': 0.0, 'grad_norm': 0.00014480689424090087, 'learning_rate': 0.0, 'epoch': 5.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150/150 [01:30<00:00,  1.65it/s]                                                 {'train_runtime': 90.7792, 'train_samples_per_second': 38.39, 'train_steps_per_second': 1.652, 'train_loss': 0.0003288271396498506, 'epoch': 5.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150/150 [01:30<00:00,  1.65it/s]2025-06-06 11:57:05,122 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150/150 [01:30<00:00,  1.65it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.25it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.43it/s]2025-06-06 11:57:09,239 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.27s/it]
2025-06-06 11:57:09,246 - INFO - Training time : 96.06004854408093
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.20it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.07it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.38it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.12it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.35it/s]2025-06-06 11:57:13,655 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.46it/s]
2025-06-06 11:57:13,661 - INFO - Evaluation time : 4.41526189702563
2025-06-06 11:57:13,661 - INFO - Evaluation results on test set: {'eval_loss': 8.90684805199271e-06, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.7425756454467773, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000004, 'eval_kappa': 1.0, 'eval_runtime': 4.4103, 'eval_samples_per_second': 29.93, 'eval_steps_per_second': 1.36, 'epoch': 5.0}
2025-06-06 11:57:13,661 - INFO - Total updates (optimizer steps): 150
2025-06-06 11:57:13,661 - INFO - Avg time / step: 0.605s
2025-06-06 11:57:14,357 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_focaldmis-lab/biobert-v1.13trials_fold-2
2025-06-06 11:57:14,357 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.16it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.03it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:01<00:00,  3.09it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  3.28it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  3.69it/s]2025-06-06 11:57:19,074 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.36it/s]
2025-06-06 11:57:19,078 - INFO - preds : [1 1 0 1 1 1 1 1 1 0 1 0 1 1 0 1 1 1 1 1 1 0 1 1 1 1 1 1 0 1 1 0 1 1 1 1 1
 1 1 1 1 1 0 0 1 0 1 0 0 1 0 0 1 1 1 1 0 0 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 1 0 1 1 1 1 1 1 0 1 0 1 1 1 1 1 0 1 1 1 0 1
 1 0 1 1 1 0 0 1 0 0 1 1 1 1 1 1 1 0 1 1 1]
2025-06-06 11:57:19,079 - INFO - test_split["labels"] : [1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1]
2025-06-06 11:57:19,080 - INFO - Confusion matrix: TN=34, FP=0, FN=0, TP=98
2025-06-06 11:57:21,775 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 34, 'FP': 0, 'FN': 0, 'TP': 98}
2025-06-06 11:57:21,893 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-06 11:57:21,993 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 11:57:21,994 - INFO - 
On test Set (optimal threshold of 0.8725122809410095 according to cross validation on the training set): 
2025-06-06 11:57:21,995 - INFO - Confusion matrix: TN=34, FP=0, FN=3, TP=95
2025-06-06 11:57:24,720 - INFO - Metrics: {'f1': 0.9844559585492227, 'recall': 0.9693877551020408, 'precision': 1.0, 'accuracy': 0.9772727272727273, 'AP': 1.0, 'MCC': 0.9438160561950645, 'NDCG': 1.0000000000000004, 'kappa': 0.9422403733955659, 'TN': 34, 'FP': 0, 'FN': 3, 'TP': 95}
2025-06-06 11:57:24,822 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 11:57:24,823 - INFO - Results for fold 2 : [{'f1': 0.9844559585492227, 'recall': 0.9693877551020408, 'precision': 1.0, 'accuracy': 0.9772727272727273, 'AP': 1.0, 'MCC': 0.9438160561950645, 'NDCG': 1.0000000000000004, 'kappa': 0.9422403733955659, 'TN': 34, 'FP': 0, 'FN': 3, 'TP': 95}]
2025-06-06 11:57:24,950 - INFO - Cleared CUDA cache. Memory allocated: 1.41 GB, Memory reserved: 1.81 GB
2025-06-06 11:57:24,950 - INFO - 
fold number 3 / 3
2025-06-06 11:57:24,957 - INFO - train split size : 697
2025-06-06 11:57:24,957 - INFO - dev split size : 67
2025-06-06 11:57:24,957 - INFO - test split size : 132
Map (num_proc=32):   0%|          | 0/697 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 22/697 [00:00<00:06, 101.26 examples/s]Map (num_proc=32):  19%|â–ˆâ–‰        | 132/697 [00:00<00:01, 491.99 examples/s]Map (num_proc=32):  35%|â–ˆâ–ˆâ–ˆâ–      | 242/697 [00:00<00:00, 678.89 examples/s]Map (num_proc=32):  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 352/697 [00:00<00:00, 793.74 examples/s]Map (num_proc=32):  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 462/697 [00:00<00:00, 816.13 examples/s]Map (num_proc=32):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 571/697 [00:00<00:00, 860.02 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 676/697 [00:00<00:00, 867.12 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 697/697 [00:01<00:00, 656.99 examples/s]
Map (num_proc=32):   0%|          | 0/67 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/67 [00:00<00:04, 15.82 examples/s]Map (num_proc=32):  22%|â–ˆâ–ˆâ–       | 15/67 [00:00<00:00, 52.35 examples/s]Map (num_proc=32):  34%|â–ˆâ–ˆâ–ˆâ–      | 23/67 [00:00<00:00, 61.76 examples/s]Map (num_proc=32):  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 33/67 [00:00<00:00, 73.71 examples/s]Map (num_proc=32):  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 43/67 [00:00<00:00, 80.60 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 53/67 [00:00<00:00, 82.82 examples/s]Map (num_proc=32):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 63/67 [00:00<00:00, 84.11 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:01<00:00, 64.50 examples/s]
Map (num_proc=32):   0%|          | 0/132 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/132 [00:00<00:04, 28.35 examples/s]Map (num_proc=32):  18%|â–ˆâ–Š        | 24/132 [00:00<00:01, 97.34 examples/s]Map (num_proc=32):  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 44/132 [00:00<00:00, 126.90 examples/s]Map (num_proc=32):  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 60/132 [00:00<00:00, 128.27 examples/s]Map (num_proc=32):  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 84/132 [00:00<00:00, 159.64 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 104/132 [00:00<00:00, 158.44 examples/s]Map (num_proc=32):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 124/132 [00:00<00:00, 166.18 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 132/132 [00:01<00:00, 127.37 examples/s]
2025-06-06 11:57:33,671 - INFO - 3 datasets tokenized successfully
2025-06-06 11:57:33,673 - INFO - Starting hyperparameter search for focal loss
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-06_11-57-33   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-57-33
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-06_10-55-47_424551_3536632/artifacts/2025-06-06_11-57-33/train_hpo_2025-06-06_11-57-33/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-06 11:57:33. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_8d987f89   PENDING    0.625202   2.69927       1.88223e-05          0.13641                    4 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_8d987f89 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_8d987f89 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                                0.6252 â”‚
â”‚ gamma                               2.69927 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          4 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3612068)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3612068)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3612068)[0m 2025-06-06 11:57:41,426 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.6252016107931255 and gamma=2.6992695521978884
[36m(train_hpo pid=3612068)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3612068)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3612068)[0m [2025-06-06 11:57:41,669] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3612068)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3612068)[0m   warnings.warn(
[36m(train_hpo pid=3612068)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=32, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_723d6666 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_723d6666 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.97058 â”‚
â”‚ gamma                                4.6341 â”‚
â”‚ learning_rate                         5e-05 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3612229)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3612229)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3612229)[0m 2025-06-06 11:57:48,321 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.970577641092792 and gamma=4.634102840173219
[36m(train_hpo pid=3612229)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3612229)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3612229)[0m [2025-06-06 11:57:48,637] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3612229)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3612229)[0m   warnings.warn(
[36m(train_hpo pid=3612229)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_bf765df1 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_bf765df1 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.78112 â”‚
â”‚ gamma                               6.80707 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          2 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3612511)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3612511)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3612511)[0m 2025-06-06 11:57:55,137 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.7811204413478371 and gamma=6.807074484302038
[36m(train_hpo pid=3612511)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3612511)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3612511)[0m [2025-06-06 11:57:55,356] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3612511)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3612511)[0m   warnings.warn(
[36m(train_hpo pid=3612511)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=16, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 3 RUNNING
Current time: 2025-06-06 11:58:03. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_8d987f89   RUNNING    0.625202   2.69927       1.88223e-05         0.13641                     4 â”‚
â”‚ train_hpo_723d6666   RUNNING    0.970578   4.6341        5.16112e-05         0.123031                    5 â”‚
â”‚ train_hpo_bf765df1   RUNNING    0.78112    6.80707       1.88581e-05         0.251217                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3612068)[0m {'loss': 0.0341, 'grad_norm': 0.7020237445831299, 'learning_rate': 1.4116733618581595e-05, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3612511)[0m {'loss': 0.0023, 'grad_norm': 0.040024563670158386, 'learning_rate': 9.429055465477227e-06, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3612229)[0m {'loss': 0.0025, 'grad_norm': 0.026321064680814743, 'learning_rate': 4.128897652498939e-05, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3612511)[0m {'train_runtime': 25.2291, 'train_samples_per_second': 55.254, 'train_steps_per_second': 0.634, 'train_loss': 0.0016939484048634768, 'epoch': 1.9142857142857141}
[36m(train_hpo pid=3612511)[0m STATE at ending of training  :  TrainerState(epoch=1.9142857142857141, global_step=16, max_steps=16, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=341476028307000.0, log_history=[{'loss': 0.0023, 'grad_norm': 0.040024563670158386, 'learning_rate': 9.429055465477227e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.0011, 'grad_norm': 0.01350942999124527, 'learning_rate': 0.0, 'epoch': 1.9142857142857141, 'step': 16}, {'train_runtime': 25.2291, 'train_samples_per_second': 55.254, 'train_steps_per_second': 0.634, 'total_flos': 341476028307000.0, 'train_loss': 0.0016939484048634768, 'epoch': 1.9142857142857141, 'step': 16}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3612511)[0m 2025-06-06 11:58:27,469 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3612511)[0m 2025-06-06 11:58:27,475 - INFO - eval_result: {'eval_loss': 0.0016583503456786275, 'eval_f1': 0.9690721649484536, 'eval_recall': 0.94, 'eval_accuracy': 0.9552238805970149, 'eval_precision': 1.0, 'eval_optim_threshold': 0.5122460126876831, 'eval_AP': 0.9965646723646724, 'eval_MCC': 0.8938679992034617, 'eval_NDCG': 0.9994003369913748, 'eval_kappa': 0.8882712618121178, 'eval_runtime': 3.7053, 'eval_samples_per_second': 18.082, 'eval_steps_per_second': 1.08, 'epoch': 1.9142857142857141}
[36m(train_hpo pid=3612511)[0m {'eval_loss': 0.0016583503456786275, 'eval_f1': 0.9690721649484536, 'eval_recall': 0.94, 'eval_accuracy': 0.9552238805970149, 'eval_precision': 1.0, 'eval_optim_threshold': 0.5122460126876831, 'eval_AP': 0.9965646723646724, 'eval_MCC': 0.8938679992034617, 'eval_NDCG': 0.9994003369913748, 'eval_kappa': 0.8882712618121178, 'eval_runtime': 3.7053, 'eval_samples_per_second': 18.082, 'eval_steps_per_second': 1.08, 'epoch': 1.9142857142857141}
[36m(train_hpo pid=3612511)[0m {'loss': 0.0011, 'grad_norm': 0.01350942999124527, 'learning_rate': 0.0, 'epoch': 1.9142857142857141}
[36m(train_hpo pid=3612511)[0m 2025-06-06 11:58:27,509 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB

Trial train_hpo_bf765df1 finished iteration 1 at 2025-06-06 11:58:27. Total running time: 53s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_bf765df1 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    33.2199 â”‚
â”‚ time_total_s                        33.2199 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               1.91429 â”‚
â”‚ eval_AP                             0.99656 â”‚
â”‚ eval_MCC                            0.89387 â”‚
â”‚ eval_NDCG                            0.9994 â”‚
â”‚ eval_accuracy                       0.95522 â”‚
â”‚ eval_f1                             0.96907 â”‚
â”‚ eval_kappa                          0.88827 â”‚
â”‚ eval_loss                           0.00166 â”‚
â”‚ eval_optim_threshold                0.51225 â”‚
â”‚ eval_precision                            1 â”‚
â”‚ eval_recall                            0.94 â”‚
â”‚ eval_runtime                         3.7053 â”‚
â”‚ eval_samples_per_second              18.082 â”‚
â”‚ eval_steps_per_second                  1.08 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:58:27,535 - INFO - Cleaning up trial bf765df1
2025-06-06 11:58:27,535 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-57-33/train_hpo_bf765df1_3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512_2025-06-06_11-57-47

Trial train_hpo_bf765df1 completed after 1 iterations at 2025-06-06 11:58:27. Total running time: 53s

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:58:33. Total running time: 1min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_8d987f89   RUNNING      0.625202   2.69927       1.88223e-05         0.13641                     4                                                                                         â”‚
â”‚ train_hpo_723d6666   RUNNING      0.970578   4.6341        5.16112e-05         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_bf765df1   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            33.2199    0.00165835    0.969072            0.94          0.955224 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3612068)[0m {'loss': 0.0106, 'grad_norm': 0.3269445300102234, 'learning_rate': 9.411155745721064e-06, 'epoch': 1.9142857142857141}
[36m(train_hpo pid=3612229)[0m {'loss': 0.0002, 'grad_norm': 0.003220918355509639, 'learning_rate': 3.096673239374204e-05, 'epoch': 1.9142857142857141}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:59:04. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_8d987f89   RUNNING      0.625202   2.69927       1.88223e-05         0.13641                     4                                                                                         â”‚
â”‚ train_hpo_723d6666   RUNNING      0.970578   4.6341        5.16112e-05         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_bf765df1   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            33.2199    0.00165835    0.969072            0.94          0.955224 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3612068)[0m {'loss': 0.004, 'grad_norm': 0.16532008349895477, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3612229)[0m {'loss': 0.0, 'grad_norm': 0.0012495734263211489, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3612068)[0m {'loss': 0.0024, 'grad_norm': 0.12143285572528839, 'learning_rate': 0.0, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3612068)[0m {'train_runtime': 108.9064, 'train_samples_per_second': 25.6, 'train_steps_per_second': 0.294, 'train_loss': 0.01281268522143364, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3612068)[0m STATE at ending of training  :  TrainerState(epoch=3.914285714285714, global_step=32, max_steps=32, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=688666448539920.0, log_history=[{'loss': 0.0341, 'grad_norm': 0.7020237445831299, 'learning_rate': 1.4116733618581595e-05, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.0106, 'grad_norm': 0.3269445300102234, 'learning_rate': 9.411155745721064e-06, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 0.004, 'grad_norm': 0.16532008349895477, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 0.0024, 'grad_norm': 0.12143285572528839, 'learning_rate': 0.0, 'epoch': 3.914285714285714, 'step': 32}, {'train_runtime': 108.9064, 'train_samples_per_second': 25.6, 'train_steps_per_second': 0.294, 'total_flos': 688666448539920.0, 'train_loss': 0.01281268522143364, 'epoch': 3.914285714285714, 'step': 32}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 11:59:34. Total running time: 2min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_8d987f89   RUNNING      0.625202   2.69927       1.88223e-05         0.13641                     4                                                                                         â”‚
â”‚ train_hpo_723d6666   RUNNING      0.970578   4.6341        5.16112e-05         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_bf765df1   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            33.2199    0.00165835    0.969072            0.94          0.955224 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3612068)[0m 2025-06-06 11:59:37,786 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3612068)[0m 2025-06-06 11:59:37,792 - INFO - eval_result: {'eval_loss': 0.008369117975234985, 'eval_f1': 0.98989898989899, 'eval_recall': 0.98, 'eval_accuracy': 0.9850746268656716, 'eval_precision': 1.0, 'eval_optim_threshold': 0.6593697667121887, 'eval_AP': 0.9996078431372549, 'eval_MCC': 0.9620579793107875, 'eval_NDCG': 0.9999328276661524, 'eval_kappa': 0.96133871898442, 'eval_runtime': 3.9812, 'eval_samples_per_second': 16.829, 'eval_steps_per_second': 1.005, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3612068)[0m {'eval_loss': 0.008369117975234985, 'eval_f1': 0.98989898989899, 'eval_recall': 0.98, 'eval_accuracy': 0.9850746268656716, 'eval_precision': 1.0, 'eval_optim_threshold': 0.6593697667121887, 'eval_AP': 0.9996078431372549, 'eval_MCC': 0.9620579793107875, 'eval_NDCG': 0.9999328276661524, 'eval_kappa': 0.96133871898442, 'eval_runtime': 3.9812, 'eval_samples_per_second': 16.829, 'eval_steps_per_second': 1.005, 'epoch': 3.914285714285714}

Trial train_hpo_8d987f89 finished iteration 1 at 2025-06-06 11:59:37. Total running time: 2min 4s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_8d987f89 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                      117.3 â”‚
â”‚ time_total_s                          117.3 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               3.91429 â”‚
â”‚ eval_AP                             0.99961 â”‚
â”‚ eval_MCC                            0.96206 â”‚
â”‚ eval_NDCG                           0.99993 â”‚
â”‚ eval_accuracy                       0.98507 â”‚
â”‚ eval_f1                              0.9899 â”‚
â”‚ eval_kappa                          0.96134 â”‚
â”‚ eval_loss                           0.00837 â”‚
â”‚ eval_optim_threshold                0.65937 â”‚
â”‚ eval_precision                            1 â”‚
â”‚ eval_recall                            0.98 â”‚
â”‚ eval_runtime                         3.9812 â”‚
â”‚ eval_samples_per_second              16.829 â”‚
â”‚ eval_steps_per_second                 1.005 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:59:37,856 - INFO - Cleaning up trial 8d987f89
2025-06-06 11:59:37,856 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-57-33/train_hpo_8d987f89_1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364_2025-06-06_11-57-33
2025-06-06 11:59:37,856 - INFO - Cleaning up trial bf765df1
2025-06-06 11:59:37,857 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-57-33/train_hpo_bf765df1_3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512_2025-06-06_11-57-47

Trial train_hpo_8d987f89 completed after 1 iterations at 2025-06-06 11:59:37. Total running time: 2min 4s
[36m(train_hpo pid=3612068)[0m 2025-06-06 11:59:37,830 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3612229)[0m {'loss': 0.0, 'grad_norm': 0.000335740449372679, 'learning_rate': 1.0322244131247348e-05, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3612229)[0m {'loss': 0.0, 'grad_norm': 0.0003065869677811861, 'learning_rate': 0.0, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3612229)[0m {'train_runtime': 122.4531, 'train_samples_per_second': 28.46, 'train_steps_per_second': 0.327, 'train_loss': 0.0005584336769061338, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3612229)[0m STATE at ending of training  :  TrainerState(epoch=4.914285714285715, global_step=40, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=862318185914640.0, log_history=[{'loss': 0.0025, 'grad_norm': 0.026321064680814743, 'learning_rate': 4.128897652498939e-05, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.0002, 'grad_norm': 0.003220918355509639, 'learning_rate': 3.096673239374204e-05, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 0.0, 'grad_norm': 0.0012495734263211489, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 0.0, 'grad_norm': 0.000335740449372679, 'learning_rate': 1.0322244131247348e-05, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 0.0, 'grad_norm': 0.0003065869677811861, 'learning_rate': 0.0, 'epoch': 4.914285714285715, 'step': 40}, {'train_runtime': 122.4531, 'train_samples_per_second': 28.46, 'train_steps_per_second': 0.327, 'total_flos': 862318185914640.0, 'train_loss': 0.0005584336769061338, 'epoch': 4.914285714285715, 'step': 40}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3612229)[0m 2025-06-06 11:59:58,008 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3612229)[0m 2025-06-06 11:59:58,014 - INFO - eval_result: {'eval_loss': 1.0161492355109658e-05, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.8561303019523621, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0, 'eval_kappa': 1.0, 'eval_runtime': 3.5805, 'eval_samples_per_second': 18.712, 'eval_steps_per_second': 1.117, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3612229)[0m {'eval_loss': 1.0161492355109658e-05, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.8561303019523621, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0, 'eval_kappa': 1.0, 'eval_runtime': 3.5805, 'eval_samples_per_second': 18.712, 'eval_steps_per_second': 1.117, 'epoch': 4.914285714285715}

Trial train_hpo_723d6666 finished iteration 1 at 2025-06-06 11:59:58. Total running time: 2min 24s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_723d6666 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    130.614 â”‚
â”‚ time_total_s                        130.614 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               4.91429 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                                  1 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                             1 â”‚
â”‚ eval_f1                                   1 â”‚
â”‚ eval_kappa                                1 â”‚
â”‚ eval_loss                             1e-05 â”‚
â”‚ eval_optim_threshold                0.85613 â”‚
â”‚ eval_precision                            1 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.5805 â”‚
â”‚ eval_samples_per_second              18.712 â”‚
â”‚ eval_steps_per_second                 1.117 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 11:59:58,073 - INFO - Cleaning up trial 723d6666
2025-06-06 11:59:58,073 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-57-33/train_hpo_723d6666_2_alpha=0.9706,gamma=4.6341,learning_rate=0.0001,num_train_epochs=5,weight_decay=0.1230_2025-06-06_11-57-40
2025-06-06 11:59:58,073 - INFO - Cleaning up trial 8d987f89
2025-06-06 11:59:58,073 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-57-33/train_hpo_8d987f89_1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364_2025-06-06_11-57-33
2025-06-06 11:59:58,073 - INFO - Cleaning up trial bf765df1
2025-06-06 11:59:58,073 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-57-33/train_hpo_bf765df1_3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512_2025-06-06_11-57-47

Trial train_hpo_723d6666 completed after 1 iterations at 2025-06-06 11:59:58. Total running time: 2min 24s
2025-06-06 11:59:58,081	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_11-57-33' in 0.0055s.

Trial status: 3 TERMINATED
Current time: 2025-06-06 11:59:58. Total running time: 2min 24s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_8d987f89   TERMINATED   0.625202   2.69927       1.88223e-05         0.13641                     4        1           117.3      0.00836912     0.989899            0.98          0.985075 â”‚
â”‚ train_hpo_723d6666   TERMINATED   0.970578   4.6341        5.16112e-05         0.123031                    5        1           130.614    1.01615e-05    1                   1             1        â”‚
â”‚ train_hpo_bf765df1   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            33.2199   0.00165835     0.969072            0.94          0.955224 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

2025-06-06 11:59:58,087 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x700d4c241990>
2025-06-06 11:59:58,088 - INFO - Best trial : train_hpo_723d6666
2025-06-06 11:59:58,088 - INFO - Best config : {'alpha': 0.970577641092792, 'gamma': 4.634102840173219, 'learning_rate': 5.1611220656236736e-05, 'weight_decay': 0.12303118765599412, 'num_train_epochs': 5}
2025-06-06 11:59:58,088 - INFO - Best trial after optimization: {'eval_loss': 1.0161492355109658e-05, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.8561303019523621, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0, 'eval_kappa': 1.0, 'eval_runtime': 3.5805, 'eval_samples_per_second': 18.712, 'eval_steps_per_second': 1.117, 'epoch': 4.914285714285715, 'timestamp': 1749203998, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '723d6666', 'date': '2025-06-06_11-59-58', 'time_this_iter_s': 130.6141231060028, 'time_total_s': 130.6141231060028, 'pid': 3612229, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'alpha': 0.970577641092792, 'gamma': 4.634102840173219, 'learning_rate': 5.1611220656236736e-05, 'weight_decay': 0.12303118765599412, 'num_train_epochs': 5}, 'time_since_restore': 130.6141231060028, 'iterations_since_restore': 1, 'experiment_tag': '2_alpha=0.9706,gamma=4.6341,learning_rate=0.0001,num_train_epochs=5,weight_decay=0.1230'}
2025-06-06 11:59:58,109 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   0.008369  0.989899  ...                        4  8d987f89
1   0.000010  1.000000  ...                        5  723d6666
2   0.001658  0.969072  ...                        2  bf765df1

[3 rows x 33 columns]
[36m(train_hpo pid=3612229)[0m 2025-06-06 11:59:58,049 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
2025-06-06 11:59:58,259 - INFO - Trial comparison plot saved
2025-06-06 11:59:58,259 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-06 11:59:58,864 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.25 and gamma=2.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-06 11:59:58,958 - INFO - training size : 697
2025-06-06 11:59:58,958 - INFO - dev size : 67
2025-06-06 11:59:58,958 - INFO - test size : 132
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
  0%|          | 0/150 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  1%|          | 1/150 [00:00<01:35,  1.56it/s]  1%|â–         | 2/150 [00:01<01:32,  1.60it/s]  2%|â–         | 3/150 [00:01<01:31,  1.61it/s]  3%|â–Ž         | 4/150 [00:02<01:30,  1.62it/s]  3%|â–Ž         | 5/150 [00:03<01:29,  1.62it/s]  4%|â–         | 6/150 [00:03<01:28,  1.62it/s]  5%|â–         | 7/150 [00:04<01:27,  1.63it/s]  5%|â–Œ         | 8/150 [00:04<01:27,  1.63it/s]  6%|â–Œ         | 9/150 [00:05<01:26,  1.63it/s]  7%|â–‹         | 10/150 [00:06<01:25,  1.63it/s]  7%|â–‹         | 11/150 [00:06<01:25,  1.63it/s]  8%|â–Š         | 12/150 [00:07<01:24,  1.63it/s]  9%|â–Š         | 13/150 [00:08<01:23,  1.63it/s]  9%|â–‰         | 14/150 [00:08<01:23,  1.63it/s] 10%|â–ˆ         | 15/150 [00:09<01:22,  1.63it/s] 11%|â–ˆ         | 16/150 [00:09<01:22,  1.63it/s] 11%|â–ˆâ–        | 17/150 [00:10<01:21,  1.63it/s] 12%|â–ˆâ–        | 18/150 [00:11<01:20,  1.63it/s] 13%|â–ˆâ–Ž        | 19/150 [00:11<01:20,  1.63it/s] 13%|â–ˆâ–Ž        | 20/150 [00:12<01:19,  1.63it/s] 14%|â–ˆâ–        | 21/150 [00:12<01:19,  1.63it/s] 15%|â–ˆâ–        | 22/150 [00:13<01:18,  1.63it/s] 15%|â–ˆâ–Œ        | 23/150 [00:14<01:17,  1.63it/s] 16%|â–ˆâ–Œ        | 24/150 [00:14<01:17,  1.63it/s] 17%|â–ˆâ–‹        | 25/150 [00:15<01:16,  1.63it/s] 17%|â–ˆâ–‹        | 26/150 [00:15<01:15,  1.63it/s] 18%|â–ˆâ–Š        | 27/150 [00:16<01:15,  1.63it/s] 19%|â–ˆâ–Š        | 28/150 [00:17<01:14,  1.63it/s] 19%|â–ˆâ–‰        | 29/150 [00:17<01:13,  1.65it/s]                                                {'loss': 0.0025, 'grad_norm': 0.00703800655901432, 'learning_rate': 4.128897652498939e-05, 'epoch': 1.0}
 20%|â–ˆâ–ˆ        | 30/150 [00:17<01:12,  1.65it/s] 21%|â–ˆâ–ˆ        | 31/150 [00:18<00:58,  2.04it/s] 21%|â–ˆâ–ˆâ–       | 32/150 [00:19<01:01,  1.92it/s] 22%|â–ˆâ–ˆâ–       | 33/150 [00:19<01:03,  1.83it/s] 23%|â–ˆâ–ˆâ–Ž       | 34/150 [00:20<01:05,  1.77it/s] 23%|â–ˆâ–ˆâ–Ž       | 35/150 [00:20<01:06,  1.73it/s] 24%|â–ˆâ–ˆâ–       | 36/150 [00:21<01:06,  1.70it/s] 25%|â–ˆâ–ˆâ–       | 37/150 [00:22<01:07,  1.68it/s] 25%|â–ˆâ–ˆâ–Œ       | 38/150 [00:22<01:07,  1.67it/s] 26%|â–ˆâ–ˆâ–Œ       | 39/150 [00:23<01:06,  1.67it/s] 27%|â–ˆâ–ˆâ–‹       | 40/150 [00:23<01:06,  1.66it/s] 27%|â–ˆâ–ˆâ–‹       | 41/150 [00:24<01:06,  1.65it/s] 28%|â–ˆâ–ˆâ–Š       | 42/150 [00:25<01:05,  1.65it/s] 29%|â–ˆâ–ˆâ–Š       | 43/150 [00:25<01:05,  1.64it/s] 29%|â–ˆâ–ˆâ–‰       | 44/150 [00:26<01:04,  1.64it/s] 30%|â–ˆâ–ˆâ–ˆ       | 45/150 [00:27<01:04,  1.63it/s] 31%|â–ˆâ–ˆâ–ˆ       | 46/150 [00:27<01:03,  1.63it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 47/150 [00:28<01:03,  1.63it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 48/150 [00:28<01:02,  1.63it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 49/150 [00:29<01:01,  1.63it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 50/150 [00:30<01:01,  1.63it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 51/150 [00:30<01:00,  1.63it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 52/150 [00:31<01:00,  1.63it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 53/150 [00:31<00:59,  1.63it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 54/150 [00:32<00:58,  1.63it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 55/150 [00:33<00:58,  1.63it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 56/150 [00:33<00:57,  1.63it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 57/150 [00:34<00:56,  1.63it/s] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 58/150 [00:35<00:56,  1.63it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 59/150 [00:35<00:55,  1.65it/s]                                                {'loss': 0.0001, 'grad_norm': 0.001817811280488968, 'learning_rate': 3.096673239374204e-05, 'epoch': 2.0}
 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 60/150 [00:35<00:54,  1.65it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 61/150 [00:36<00:43,  2.06it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 62/150 [00:36<00:45,  1.94it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 63/150 [00:37<00:47,  1.85it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 64/150 [00:38<00:48,  1.78it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 65/150 [00:38<00:48,  1.74it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 66/150 [00:39<00:49,  1.71it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 67/150 [00:39<00:49,  1.68it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 68/150 [00:40<00:49,  1.67it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 69/150 [00:41<00:48,  1.66it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 70/150 [00:41<00:48,  1.66it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 71/150 [00:42<00:47,  1.65it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 72/150 [00:43<00:47,  1.64it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 73/150 [00:43<00:47,  1.64it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 74/150 [00:44<00:46,  1.63it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 75/150 [00:44<00:46,  1.63it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 76/150 [00:45<00:45,  1.63it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 77/150 [00:46<00:44,  1.63it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 78/150 [00:46<00:44,  1.63it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 79/150 [00:47<00:43,  1.63it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 80/150 [00:47<00:42,  1.63it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 81/150 [00:48<00:42,  1.63it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 82/150 [00:49<00:41,  1.63it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 83/150 [00:49<00:41,  1.63it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 84/150 [00:50<00:40,  1.63it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 85/150 [00:51<00:39,  1.63it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 86/150 [00:51<00:39,  1.63it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 87/150 [00:52<00:38,  1.63it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 88/150 [00:52<00:37,  1.63it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 89/150 [00:53<00:36,  1.65it/s]                                                {'loss': 0.0, 'grad_norm': 0.0007031441200524569, 'learning_rate': 2.0644488262494696e-05, 'epoch': 3.0}
 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 90/150 [00:53<00:36,  1.65it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 91/150 [00:54<00:28,  2.06it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 92/150 [00:54<00:29,  1.94it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 93/150 [00:55<00:30,  1.85it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 94/150 [00:55<00:31,  1.78it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 95/150 [00:56<00:31,  1.74it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 96/150 [00:57<00:31,  1.71it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 97/150 [00:57<00:31,  1.69it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 98/150 [00:58<00:31,  1.67it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 99/150 [00:59<00:30,  1.66it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 100/150 [00:59<00:30,  1.65it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 101/150 [01:00<00:29,  1.65it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 102/150 [01:00<00:29,  1.64it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 103/150 [01:01<00:28,  1.64it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 104/150 [01:02<00:28,  1.64it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 105/150 [01:02<00:27,  1.63it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 106/150 [01:03<00:26,  1.63it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 107/150 [01:03<00:26,  1.63it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 108/150 [01:04<00:25,  1.63it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 109/150 [01:05<00:25,  1.63it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 110/150 [01:05<00:24,  1.63it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 111/150 [01:06<00:23,  1.63it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 112/150 [01:07<00:23,  1.63it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 113/150 [01:07<00:22,  1.63it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 114/150 [01:08<00:22,  1.63it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 115/150 [01:08<00:21,  1.63it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 116/150 [01:09<00:20,  1.63it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 117/150 [01:10<00:20,  1.63it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 118/150 [01:10<00:19,  1.63it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 119/150 [01:11<00:18,  1.65it/s]                                                 {'loss': 0.0, 'grad_norm': 0.000526494171936065, 'learning_rate': 1.0322244131247348e-05, 'epoch': 4.0}
 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 120/150 [01:11<00:18,  1.65it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 121/150 [01:11<00:14,  2.07it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 122/150 [01:12<00:14,  1.94it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 123/150 [01:13<00:14,  1.85it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 124/150 [01:13<00:14,  1.78it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 125/150 [01:14<00:14,  1.73it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 126/150 [01:15<00:14,  1.70it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 127/150 [01:15<00:13,  1.68it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 128/150 [01:16<00:13,  1.67it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 129/150 [01:16<00:12,  1.66it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 130/150 [01:17<00:12,  1.65it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 131/150 [01:18<00:11,  1.64it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 132/150 [01:18<00:10,  1.64it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 133/150 [01:19<00:10,  1.64it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 134/150 [01:19<00:09,  1.63it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 135/150 [01:20<00:09,  1.63it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 136/150 [01:21<00:08,  1.63it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 137/150 [01:21<00:07,  1.63it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 138/150 [01:22<00:07,  1.63it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 139/150 [01:23<00:06,  1.63it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 140/150 [01:23<00:06,  1.63it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 141/150 [01:24<00:05,  1.64it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 142/150 [01:24<00:04,  1.63it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 143/150 [01:25<00:04,  1.63it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 144/150 [01:26<00:03,  1.63it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 145/150 [01:26<00:03,  1.63it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 146/150 [01:27<00:02,  1.63it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 147/150 [01:27<00:01,  1.63it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 148/150 [01:28<00:01,  1.63it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 149/150 [01:29<00:00,  1.65it/s]                                                 {'loss': 0.0, 'grad_norm': 0.0007819635793566704, 'learning_rate': 0.0, 'epoch': 5.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150/150 [01:31<00:00,  1.65it/s]                                                 {'train_runtime': 91.3527, 'train_samples_per_second': 38.149, 'train_steps_per_second': 1.642, 'train_loss': 0.0005206505393531794, 'epoch': 5.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150/150 [01:31<00:00,  1.65it/s]2025-06-06 12:01:30,762 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150/150 [01:31<00:00,  1.64it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.30it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.44it/s]2025-06-06 12:01:34,484 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.14s/it]
2025-06-06 12:01:34,491 - INFO - Training time : 96.23195390496403
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.16it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.06it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.39it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.13it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.36it/s]2025-06-06 12:01:39,028 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.42it/s]
2025-06-06 12:01:39,033 - INFO - Evaluation time : 4.542019732063636
2025-06-06 12:01:39,033 - INFO - Evaluation results on test set: {'eval_loss': 3.920732706319541e-05, 'eval_f1': 0.9948717948717949, 'eval_recall': 1.0, 'eval_accuracy': 0.9924242424242424, 'eval_precision': 0.9897959183673469, 'eval_optim_threshold': 0.7805124521255493, 'eval_AP': 0.9999999999999999, 'eval_MCC': 0.9805692402810843, 'eval_NDCG': 1.0000000000000004, 'eval_kappa': 0.9803804994054697, 'eval_runtime': 4.5374, 'eval_samples_per_second': 29.091, 'eval_steps_per_second': 1.322, 'epoch': 5.0}
2025-06-06 12:01:39,033 - INFO - Total updates (optimizer steps): 150
2025-06-06 12:01:39,033 - INFO - Avg time / step: 0.609s
2025-06-06 12:01:39,730 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_focaldmis-lab/biobert-v1.13trials_fold-3
2025-06-06 12:01:39,730 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.19it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.06it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:01<00:00,  3.01it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  3.23it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  3.64it/s]2025-06-06 12:01:44,525 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.34it/s]
2025-06-06 12:01:44,529 - INFO - preds : [1 0 1 0 1 0 1 1 1 1 1 0 1 1 0 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 0 0 1 0 1
 1 1 1 1 1 0 1 1 1 0 1 1 0 1 1 1 1 1 1 1 1 0 1 0 1 1 0 1 1 1 1 1 1 1 1 1 1
 1 0 0 1 0 1 1 1 1 1 0 1 1 1 0 1 0 0 1 1 1 1 0 1 1 1 1 0 0 1 1 0 1 0 0 1 0
 1 1 1 1 1 1 1 1 0 1 1 1 1 0 0 1 0 1 0 1 1]
2025-06-06 12:01:44,530 - INFO - test_split["labels"] : [1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1]
2025-06-06 12:01:44,531 - INFO - Confusion matrix: TN=34, FP=1, FN=0, TP=97
2025-06-06 12:01:47,625 - INFO - Metrics: {'f1': 0.9948717948717949, 'recall': 1.0, 'precision': 0.9897959183673469, 'accuracy': 0.9924242424242424, 'AP': 0.9999999999999999, 'MCC': 0.9805692402810843, 'NDCG': 1.0000000000000004, 'kappa': 0.9803804994054697, 'TN': 34, 'FP': 1, 'FN': 0, 'TP': 97}
2025-06-06 12:01:47,741 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-06 12:01:47,839 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 12:01:47,839 - INFO - 
On test Set (optimal threshold of 0.7090229392051697 according to cross validation on the training set): 
2025-06-06 12:01:47,841 - INFO - Confusion matrix: TN=35, FP=0, FN=0, TP=97
2025-06-06 12:01:50,594 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 0.9999999999999999, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 35, 'FP': 0, 'FN': 0, 'TP': 97}
2025-06-06 12:01:50,689 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 12:01:50,689 - INFO - Results for fold 3 : [{'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 0.9999999999999999, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 35, 'FP': 0, 'FN': 0, 'TP': 97}]
2025-06-06 12:01:50,815 - INFO - Cleared CUDA cache. Memory allocated: 1.41 GB, Memory reserved: 1.85 GB
2025-06-06 12:01:50,815 - INFO - Cleared CUDA cache. Memory allocated: 1.41 GB, Memory reserved: 1.85 GB
2025-06-06 12:01:50,861 - INFO - Cleared CUDA cache. Memory allocated: 0.03 GB, Memory reserved: 0.05 GB
2025-06-06 12:01:50,873 - INFO - Metrics for dmis-lab/biobert-v1.1:               model_name fold loss_type run  ...    TN   FP   FN    TP
0  dmis-lab/biobert-v1.1    1     focal   1  ...  35.0  0.0  0.0  98.0
0  dmis-lab/biobert-v1.1    2     focal   1  ...  34.0  0.0  0.0  98.0
0  dmis-lab/biobert-v1.1    3     focal   1  ...  34.0  1.0  0.0  97.0

[3 rows x 18 columns]
2025-06-06 12:01:50,873 - INFO - Training model 2/2: google-bert/bert-base-uncased
2025-06-06 12:01:51,045 - INFO - 
fold number 1 / 3
2025-06-06 12:01:51,052 - INFO - train split size : 697
2025-06-06 12:01:51,052 - INFO - dev split size : 66
2025-06-06 12:01:51,052 - INFO - test split size : 133
Map (num_proc=32):   0%|          | 0/697 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 22/697 [00:00<00:07, 95.05 examples/s]Map (num_proc=32):  16%|â–ˆâ–Œ        | 110/697 [00:00<00:01, 362.94 examples/s]Map (num_proc=32):  28%|â–ˆâ–ˆâ–Š       | 198/697 [00:00<00:00, 514.97 examples/s]Map (num_proc=32):  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 286/697 [00:00<00:00, 627.71 examples/s]Map (num_proc=32):  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 374/697 [00:00<00:00, 657.58 examples/s]Map (num_proc=32):  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 462/697 [00:00<00:00, 682.26 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 550/697 [00:00<00:00, 705.15 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 634/697 [00:01<00:00, 713.51 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 697/697 [00:01<00:00, 554.26 examples/s]
Map (num_proc=32):   0%|          | 0/66 [00:00<?, ? examples/s]Map (num_proc=32):   5%|â–         | 3/66 [00:00<00:03, 16.16 examples/s]Map (num_proc=32):  18%|â–ˆâ–Š        | 12/66 [00:00<00:01, 44.68 examples/s]Map (num_proc=32):  30%|â–ˆâ–ˆâ–ˆ       | 20/66 [00:00<00:00, 52.32 examples/s]Map (num_proc=32):  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 28/66 [00:00<00:00, 57.53 examples/s]Map (num_proc=32):  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 36/66 [00:00<00:00, 60.91 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 44/66 [00:00<00:00, 62.83 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 52/66 [00:00<00:00, 64.99 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 60/66 [00:01<00:00, 65.13 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 66/66 [00:01<00:00, 53.09 examples/s]
Map (num_proc=32):   0%|          | 0/133 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/133 [00:00<00:04, 25.87 examples/s]Map (num_proc=32):  15%|â–ˆâ–Œ        | 20/133 [00:00<00:01, 75.33 examples/s]Map (num_proc=32):  28%|â–ˆâ–ˆâ–Š       | 37/133 [00:00<00:00, 107.49 examples/s]Map (num_proc=32):  40%|â–ˆâ–ˆâ–ˆâ–‰      | 53/133 [00:00<00:00, 121.24 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 69/133 [00:00<00:00, 125.55 examples/s]Map (num_proc=32):  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 85/133 [00:00<00:00, 126.44 examples/s]Map (num_proc=32):  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 101/133 [00:00<00:00, 127.98 examples/s]Map (num_proc=32):  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 117/133 [00:01<00:00, 126.34 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 133/133 [00:01<00:00, 132.19 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 133/133 [00:01<00:00, 106.90 examples/s]
2025-06-06 12:02:00,640 - INFO - 3 datasets tokenized successfully
2025-06-06 12:02:00,641 - INFO - Starting hyperparameter search for focal loss
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-06_12-02-00   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_12-02-00
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-06_10-55-47_424551_3536632/artifacts/2025-06-06_12-02-00/train_hpo_2025-06-06_12-02-00/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-06 12:02:00. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_9cf2fa89   PENDING    0.625202   2.69927       1.88223e-05          0.13641                    4 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_9cf2fa89 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_9cf2fa89 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                                0.6252 â”‚
â”‚ gamma                               2.69927 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          4 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3617600)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3617600)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3617600)[0m 2025-06-06 12:02:07,904 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.6252016107931255 and gamma=2.6992695521978884
[36m(train_hpo pid=3617600)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3617600)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3617600)[0m [2025-06-06 12:02:08,155] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3617600)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3617600)[0m   warnings.warn(
[36m(train_hpo pid=3617600)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=32, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_04e9ebef started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_04e9ebef config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.97058 â”‚
â”‚ gamma                                4.6341 â”‚
â”‚ learning_rate                         5e-05 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3617762)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3617762)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3617762)[0m 2025-06-06 12:02:14,616 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.970577641092792 and gamma=4.634102840173219
[36m(train_hpo pid=3617762)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3617762)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3617762)[0m [2025-06-06 12:02:14,975] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3617762)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3617762)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3617762)[0m   warnings.warn(

Trial train_hpo_33eb4fc8 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_33eb4fc8 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.78112 â”‚
â”‚ gamma                               6.80707 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          2 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3618042)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3618042)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3618042)[0m 2025-06-06 12:02:21,293 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.7811204413478371 and gamma=6.807074484302038
[36m(train_hpo pid=3618042)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3618042)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3618042)[0m [2025-06-06 12:02:21,524] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3618042)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3618042)[0m   warnings.warn(
[36m(train_hpo pid=3618042)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=16, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 3 RUNNING
Current time: 2025-06-06 12:02:30. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_9cf2fa89   RUNNING    0.625202   2.69927       1.88223e-05         0.13641                     4 â”‚
â”‚ train_hpo_04e9ebef   RUNNING    0.970578   4.6341        5.16112e-05         0.123031                    5 â”‚
â”‚ train_hpo_33eb4fc8   RUNNING    0.78112    6.80707       1.88581e-05         0.251217                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3617600)[0m {'loss': 0.037, 'grad_norm': 0.5260011553764343, 'learning_rate': 1.4116733618581595e-05, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3618042)[0m {'loss': 0.0129, 'grad_norm': 0.08637882024049759, 'learning_rate': 9.429055465477227e-06, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3617762)[0m {'loss': 0.0039, 'grad_norm': 0.06420151144266129, 'learning_rate': 4.128897652498939e-05, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3618042)[0m {'train_runtime': 25.0974, 'train_samples_per_second': 55.544, 'train_steps_per_second': 0.638, 'train_loss': 0.007571613299660385, 'epoch': 1.9142857142857141}
[36m(train_hpo pid=3618042)[0m STATE at ending of training  :  TrainerState(epoch=1.9142857142857141, global_step=16, max_steps=16, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=340499648391600.0, log_history=[{'loss': 0.0129, 'grad_norm': 0.08637882024049759, 'learning_rate': 9.429055465477227e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.0022, 'grad_norm': 0.0291447676718235, 'learning_rate': 0.0, 'epoch': 1.9142857142857141, 'step': 16}, {'train_runtime': 25.0974, 'train_samples_per_second': 55.544, 'train_steps_per_second': 0.638, 'total_flos': 340499648391600.0, 'train_loss': 0.007571613299660385, 'epoch': 1.9142857142857141, 'step': 16}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3618042)[0m 2025-06-06 12:02:53,230 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png

Trial train_hpo_33eb4fc8 finished iteration 1 at 2025-06-06 12:02:53. Total running time: 52s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_33eb4fc8 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    32.4142 â”‚
â”‚ time_total_s                        32.4142 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               1.91429 â”‚
â”‚ eval_AP                             0.85702 â”‚
â”‚ eval_MCC                            0.20821 â”‚
â”‚ eval_NDCG                           0.95493 â”‚
â”‚ eval_accuracy                       0.54545 â”‚
â”‚ eval_f1                             0.60526 â”‚
â”‚ eval_kappa                          0.16456 â”‚
â”‚ eval_loss                           0.00452 â”‚
â”‚ eval_optim_threshold                0.48562 â”‚
â”‚ eval_precision                      0.85185 â”‚
â”‚ eval_recall                         0.46939 â”‚
â”‚ eval_runtime                         3.4494 â”‚
â”‚ eval_samples_per_second              19.134 â”‚
â”‚ eval_steps_per_second                  1.16 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 12:02:53,296 - INFO - Cleaning up trial 33eb4fc8
2025-06-06 12:02:53,296 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_12-02-00/train_hpo_33eb4fc8_3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512_2025-06-06_12-02-14

Trial train_hpo_33eb4fc8 completed after 1 iterations at 2025-06-06 12:02:53. Total running time: 52s
[36m(train_hpo pid=3618042)[0m 2025-06-06 12:02:53,236 - INFO - eval_result: {'eval_loss': 0.004518607165664434, 'eval_f1': 0.6052631578947368, 'eval_recall': 0.46938775510204084, 'eval_accuracy': 0.5454545454545454, 'eval_precision': 0.8518518518518519, 'eval_optim_threshold': 0.48561710119247437, 'eval_AP': 0.8570179954275866, 'eval_MCC': 0.20820824576076338, 'eval_NDCG': 0.9549286842710121, 'eval_kappa': 0.16455696202531644, 'eval_runtime': 3.4494, 'eval_samples_per_second': 19.134, 'eval_steps_per_second': 1.16, 'epoch': 1.9142857142857141}
[36m(train_hpo pid=3618042)[0m 2025-06-06 12:02:53,271 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3618042)[0m {'eval_loss': 0.004518607165664434, 'eval_f1': 0.6052631578947368, 'eval_recall': 0.46938775510204084, 'eval_accuracy': 0.5454545454545454, 'eval_precision': 0.8518518518518519, 'eval_optim_threshold': 0.48561710119247437, 'eval_AP': 0.8570179954275866, 'eval_MCC': 0.20820824576076338, 'eval_NDCG': 0.9549286842710121, 'eval_kappa': 0.16455696202531644, 'eval_runtime': 3.4494, 'eval_samples_per_second': 19.134, 'eval_steps_per_second': 1.16, 'epoch': 1.9142857142857141}
[36m(train_hpo pid=3618042)[0m {'loss': 0.0022, 'grad_norm': 0.0291447676718235, 'learning_rate': 0.0, 'epoch': 1.9142857142857141}

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 12:03:00. Total running time: 1min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_9cf2fa89   RUNNING      0.625202   2.69927       1.88223e-05         0.13641                     4                                                                                         â”‚
â”‚ train_hpo_04e9ebef   RUNNING      0.970578   4.6341        5.16112e-05         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_33eb4fc8   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            32.4142    0.00451861    0.605263        0.469388          0.545455 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3617600)[0m {'loss': 0.017, 'grad_norm': 0.39638328552246094, 'learning_rate': 9.411155745721064e-06, 'epoch': 1.9142857142857141}
[36m(train_hpo pid=3617762)[0m {'loss': 0.0005, 'grad_norm': 0.0037120606284588575, 'learning_rate': 3.096673239374204e-05, 'epoch': 1.9142857142857141}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 12:03:31. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_9cf2fa89   RUNNING      0.625202   2.69927       1.88223e-05         0.13641                     4                                                                                         â”‚
â”‚ train_hpo_04e9ebef   RUNNING      0.970578   4.6341        5.16112e-05         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_33eb4fc8   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            32.4142    0.00451861    0.605263        0.469388          0.545455 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3617600)[0m {'loss': 0.0092, 'grad_norm': 0.27818357944488525, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3617762)[0m {'loss': 0.0, 'grad_norm': 0.01002921536564827, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3617600)[0m {'loss': 0.0046, 'grad_norm': 0.12891702353954315, 'learning_rate': 0.0, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3617600)[0m {'train_runtime': 108.6151, 'train_samples_per_second': 25.669, 'train_steps_per_second': 0.295, 'train_loss': 0.016946837073192, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3617600)[0m STATE at ending of training  :  TrainerState(epoch=3.914285714285714, global_step=32, max_steps=32, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=687104240675280.0, log_history=[{'loss': 0.037, 'grad_norm': 0.5260011553764343, 'learning_rate': 1.4116733618581595e-05, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.017, 'grad_norm': 0.39638328552246094, 'learning_rate': 9.411155745721064e-06, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 0.0092, 'grad_norm': 0.27818357944488525, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 0.0046, 'grad_norm': 0.12891702353954315, 'learning_rate': 0.0, 'epoch': 3.914285714285714, 'step': 32}, {'train_runtime': 108.6151, 'train_samples_per_second': 25.669, 'train_steps_per_second': 0.295, 'total_flos': 687104240675280.0, 'train_loss': 0.016946837073192, 'epoch': 3.914285714285714, 'step': 32}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 12:04:01. Total running time: 2min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_9cf2fa89   RUNNING      0.625202   2.69927       1.88223e-05         0.13641                     4                                                                                         â”‚
â”‚ train_hpo_04e9ebef   RUNNING      0.970578   4.6341        5.16112e-05         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_33eb4fc8   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            32.4142    0.00451861    0.605263        0.469388          0.545455 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3617600)[0m 2025-06-06 12:04:03,949 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3617600)[0m 2025-06-06 12:04:03,955 - INFO - eval_result: {'eval_loss': 0.010957309976220131, 'eval_f1': 0.9896907216494846, 'eval_recall': 0.9795918367346939, 'eval_accuracy': 0.9848484848484849, 'eval_precision': 1.0, 'eval_optim_threshold': 0.6460214853286743, 'eval_AP': 0.9995918367346939, 'eval_MCC': 0.9618576131773406, 'eval_NDCG': 0.9999298518361316, 'eval_kappa': 0.9611307420494699, 'eval_runtime': 3.9819, 'eval_samples_per_second': 16.575, 'eval_steps_per_second': 1.005, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3617600)[0m 2025-06-06 12:04:03,994 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3617600)[0m {'eval_loss': 0.010957309976220131, 'eval_f1': 0.9896907216494846, 'eval_recall': 0.9795918367346939, 'eval_accuracy': 0.9848484848484849, 'eval_precision': 1.0, 'eval_optim_threshold': 0.6460214853286743, 'eval_AP': 0.9995918367346939, 'eval_MCC': 0.9618576131773406, 'eval_NDCG': 0.9999298518361316, 'eval_kappa': 0.9611307420494699, 'eval_runtime': 3.9819, 'eval_samples_per_second': 16.575, 'eval_steps_per_second': 1.005, 'epoch': 3.914285714285714}

Trial train_hpo_9cf2fa89 finished iteration 1 at 2025-06-06 12:04:04. Total running time: 2min 3s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_9cf2fa89 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    116.564 â”‚
â”‚ time_total_s                        116.564 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               3.91429 â”‚
â”‚ eval_AP                             0.99959 â”‚
â”‚ eval_MCC                            0.96186 â”‚
â”‚ eval_NDCG                           0.99993 â”‚
â”‚ eval_accuracy                       0.98485 â”‚
â”‚ eval_f1                             0.98969 â”‚
â”‚ eval_kappa                          0.96113 â”‚
â”‚ eval_loss                           0.01096 â”‚
â”‚ eval_optim_threshold                0.64602 â”‚
â”‚ eval_precision                            1 â”‚
â”‚ eval_recall                         0.97959 â”‚
â”‚ eval_runtime                         3.9819 â”‚
â”‚ eval_samples_per_second              16.575 â”‚
â”‚ eval_steps_per_second                 1.005 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 12:04:04,018 - INFO - Cleaning up trial 9cf2fa89
2025-06-06 12:04:04,018 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_12-02-00/train_hpo_9cf2fa89_1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364_2025-06-06_12-02-00
2025-06-06 12:04:04,019 - INFO - Cleaning up trial 33eb4fc8
2025-06-06 12:04:04,019 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_12-02-00/train_hpo_33eb4fc8_3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512_2025-06-06_12-02-14

Trial train_hpo_9cf2fa89 completed after 1 iterations at 2025-06-06 12:04:04. Total running time: 2min 3s
[36m(train_hpo pid=3617762)[0m {'loss': 0.0, 'grad_norm': 0.00045180824236012995, 'learning_rate': 1.0322244131247348e-05, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3617762)[0m {'loss': 0.0, 'grad_norm': 0.0010096189798787236, 'learning_rate': 0.0, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3617762)[0m {'train_runtime': 122.1124, 'train_samples_per_second': 28.539, 'train_steps_per_second': 0.328, 'train_loss': 0.0008924588891204621, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3617762)[0m STATE at ending of training  :  TrainerState(epoch=4.914285714285715, global_step=40, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=860529869016960.0, log_history=[{'loss': 0.0039, 'grad_norm': 0.06420151144266129, 'learning_rate': 4.128897652498939e-05, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.0005, 'grad_norm': 0.0037120606284588575, 'learning_rate': 3.096673239374204e-05, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 0.0, 'grad_norm': 0.01002921536564827, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 0.0, 'grad_norm': 0.00045180824236012995, 'learning_rate': 1.0322244131247348e-05, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 0.0, 'grad_norm': 0.0010096189798787236, 'learning_rate': 0.0, 'epoch': 4.914285714285715, 'step': 40}, {'train_runtime': 122.1124, 'train_samples_per_second': 28.539, 'train_steps_per_second': 0.328, 'total_flos': 860529869016960.0, 'train_loss': 0.0008924588891204621, 'epoch': 4.914285714285715, 'step': 40}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_04e9ebef finished iteration 1 at 2025-06-06 12:04:23. Total running time: 2min 23s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_04e9ebef result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    129.583 â”‚
â”‚ time_total_s                        129.583 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               4.91429 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                                  1 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                             1 â”‚
â”‚ eval_f1                                   1 â”‚
â”‚ eval_kappa                                1 â”‚
â”‚ eval_loss                                 0 â”‚
â”‚ eval_optim_threshold                0.83552 â”‚
â”‚ eval_precision                            1 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.3413 â”‚
â”‚ eval_samples_per_second              19.753 â”‚
â”‚ eval_steps_per_second                 1.197 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 12:04:23,757 - INFO - Cleaning up trial 04e9ebef
2025-06-06 12:04:23,758 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_12-02-00/train_hpo_04e9ebef_2_alpha=0.9706,gamma=4.6341,learning_rate=0.0001,num_train_epochs=5,weight_decay=0.1230_2025-06-06_12-02-07
2025-06-06 12:04:23,758 - INFO - Cleaning up trial 9cf2fa89
2025-06-06 12:04:23,758 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_12-02-00/train_hpo_9cf2fa89_1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364_2025-06-06_12-02-00
2025-06-06 12:04:23,758 - INFO - Cleaning up trial 33eb4fc8
2025-06-06 12:04:23,758 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_12-02-00/train_hpo_33eb4fc8_3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512_2025-06-06_12-02-14

Trial train_hpo_04e9ebef completed after 1 iterations at 2025-06-06 12:04:23. Total running time: 2min 23s
[36m(train_hpo pid=3617762)[0m {'eval_loss': 4.5977030822541565e-06, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.8355164527893066, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.3413, 'eval_samples_per_second': 19.753, 'eval_steps_per_second': 1.197, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3617762)[0m 2025-06-06 12:04:23,691 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3617762)[0m 2025-06-06 12:04:23,697 - INFO - eval_result: {'eval_loss': 4.5977030822541565e-06, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.8355164527893066, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.3413, 'eval_samples_per_second': 19.753, 'eval_steps_per_second': 1.197, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3617762)[0m 2025-06-06 12:04:23,732 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
2025-06-06 12:04:23,765	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_12-02-00' in 0.0058s.

Trial status: 3 TERMINATED
Current time: 2025-06-06 12:04:23. Total running time: 2min 23s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_9cf2fa89   TERMINATED   0.625202   2.69927       1.88223e-05         0.13641                     4        1           116.564     0.0109573     0.989691        0.979592          0.984848 â”‚
â”‚ train_hpo_04e9ebef   TERMINATED   0.970578   4.6341        5.16112e-05         0.123031                    5        1           129.583     4.5977e-06    1               1                 1        â”‚
â”‚ train_hpo_33eb4fc8   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            32.4142    0.00451861    0.605263        0.469388          0.545455 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

2025-06-06 12:04:23,772 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x700d581bcf50>
2025-06-06 12:04:23,772 - INFO - Best trial : train_hpo_04e9ebef
2025-06-06 12:04:23,772 - INFO - Best config : {'alpha': 0.970577641092792, 'gamma': 4.634102840173219, 'learning_rate': 5.1611220656236736e-05, 'weight_decay': 0.12303118765599412, 'num_train_epochs': 5}
2025-06-06 12:04:23,772 - INFO - Best trial after optimization: {'eval_loss': 4.5977030822541565e-06, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.8355164527893066, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.3413, 'eval_samples_per_second': 19.753, 'eval_steps_per_second': 1.197, 'epoch': 4.914285714285715, 'timestamp': 1749204263, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '04e9ebef', 'date': '2025-06-06_12-04-23', 'time_this_iter_s': 129.58289647102356, 'time_total_s': 129.58289647102356, 'pid': 3617762, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'alpha': 0.970577641092792, 'gamma': 4.634102840173219, 'learning_rate': 5.1611220656236736e-05, 'weight_decay': 0.12303118765599412, 'num_train_epochs': 5}, 'time_since_restore': 129.58289647102356, 'iterations_since_restore': 1, 'experiment_tag': '2_alpha=0.9706,gamma=4.6341,learning_rate=0.0001,num_train_epochs=5,weight_decay=0.1230'}
2025-06-06 12:04:23,794 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   0.010957  0.989691  ...                        4  9cf2fa89
1   0.000005  1.000000  ...                        5  04e9ebef
2   0.004519  0.605263  ...                        2  33eb4fc8

[3 rows x 33 columns]
2025-06-06 12:04:23,947 - INFO - Trial comparison plot saved
2025-06-06 12:04:23,948 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-06 12:04:24,169 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.25 and gamma=2.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-06 12:04:24,285 - INFO - training size : 697
2025-06-06 12:04:24,285 - INFO - dev size : 66
2025-06-06 12:04:24,285 - INFO - test size : 133
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
  0%|          | 0/150 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  1%|          | 1/150 [00:00<01:35,  1.55it/s]  1%|â–         | 2/150 [00:01<01:32,  1.60it/s]  2%|â–         | 3/150 [00:01<01:31,  1.61it/s]  3%|â–Ž         | 4/150 [00:02<01:30,  1.61it/s]  3%|â–Ž         | 5/150 [00:03<01:29,  1.62it/s]  4%|â–         | 6/150 [00:03<01:28,  1.62it/s]  5%|â–         | 7/150 [00:04<01:28,  1.62it/s]  5%|â–Œ         | 8/150 [00:04<01:27,  1.62it/s]  6%|â–Œ         | 9/150 [00:05<01:26,  1.62it/s]  7%|â–‹         | 10/150 [00:06<01:26,  1.62it/s]  7%|â–‹         | 11/150 [00:06<01:25,  1.62it/s]  8%|â–Š         | 12/150 [00:07<01:25,  1.62it/s]  9%|â–Š         | 13/150 [00:08<01:24,  1.62it/s]  9%|â–‰         | 14/150 [00:08<01:23,  1.62it/s] 10%|â–ˆ         | 15/150 [00:09<01:23,  1.62it/s] 11%|â–ˆ         | 16/150 [00:09<01:22,  1.62it/s] 11%|â–ˆâ–        | 17/150 [00:10<01:21,  1.63it/s] 12%|â–ˆâ–        | 18/150 [00:11<01:21,  1.62it/s] 13%|â–ˆâ–Ž        | 19/150 [00:11<01:20,  1.63it/s] 13%|â–ˆâ–Ž        | 20/150 [00:12<01:19,  1.63it/s] 14%|â–ˆâ–        | 21/150 [00:12<01:19,  1.63it/s] 15%|â–ˆâ–        | 22/150 [00:13<01:18,  1.63it/s] 15%|â–ˆâ–Œ        | 23/150 [00:14<01:18,  1.63it/s] 16%|â–ˆâ–Œ        | 24/150 [00:14<01:17,  1.63it/s] 17%|â–ˆâ–‹        | 25/150 [00:15<01:16,  1.64it/s] 17%|â–ˆâ–‹        | 26/150 [00:16<01:15,  1.64it/s] 18%|â–ˆâ–Š        | 27/150 [00:16<01:15,  1.63it/s] 19%|â–ˆâ–Š        | 28/150 [00:17<01:14,  1.63it/s] 19%|â–ˆâ–‰        | 29/150 [00:17<01:13,  1.64it/s]                                                {'loss': 0.0007, 'grad_norm': 1.2089995834685396e-05, 'learning_rate': 4.128897652498939e-05, 'epoch': 1.0}
 20%|â–ˆâ–ˆ        | 30/150 [00:17<01:13,  1.64it/s] 21%|â–ˆâ–ˆ        | 31/150 [00:18<00:58,  2.04it/s] 21%|â–ˆâ–ˆâ–       | 32/150 [00:19<01:01,  1.92it/s] 22%|â–ˆâ–ˆâ–       | 33/150 [00:19<01:03,  1.84it/s] 23%|â–ˆâ–ˆâ–Ž       | 34/150 [00:20<01:05,  1.77it/s] 23%|â–ˆâ–ˆâ–Ž       | 35/150 [00:20<01:06,  1.73it/s] 24%|â–ˆâ–ˆâ–       | 36/150 [00:21<01:07,  1.70it/s] 25%|â–ˆâ–ˆâ–       | 37/150 [00:22<01:07,  1.68it/s] 25%|â–ˆâ–ˆâ–Œ       | 38/150 [00:22<01:07,  1.66it/s] 26%|â–ˆâ–ˆâ–Œ       | 39/150 [00:23<01:07,  1.65it/s] 27%|â–ˆâ–ˆâ–‹       | 40/150 [00:24<01:06,  1.66it/s] 27%|â–ˆâ–ˆâ–‹       | 41/150 [00:24<01:06,  1.65it/s] 28%|â–ˆâ–ˆâ–Š       | 42/150 [00:25<01:05,  1.64it/s] 29%|â–ˆâ–ˆâ–Š       | 43/150 [00:25<01:05,  1.64it/s] 29%|â–ˆâ–ˆâ–‰       | 44/150 [00:26<01:04,  1.63it/s] 30%|â–ˆâ–ˆâ–ˆ       | 45/150 [00:27<01:04,  1.63it/s] 31%|â–ˆâ–ˆâ–ˆ       | 46/150 [00:27<01:03,  1.63it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 47/150 [00:28<01:03,  1.63it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 48/150 [00:28<01:02,  1.63it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 49/150 [00:29<01:01,  1.63it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 50/150 [00:30<01:01,  1.63it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 51/150 [00:30<01:00,  1.63it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 52/150 [00:31<01:00,  1.63it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 53/150 [00:32<00:59,  1.62it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 54/150 [00:32<00:59,  1.63it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 55/150 [00:33<00:58,  1.62it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 56/150 [00:33<00:57,  1.63it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 57/150 [00:34<00:57,  1.63it/s] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 58/150 [00:35<00:56,  1.63it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 59/150 [00:35<00:55,  1.64it/s]                                                {'loss': 0.0, 'grad_norm': 3.209853821317665e-05, 'learning_rate': 3.096673239374204e-05, 'epoch': 2.0}
 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 60/150 [00:35<00:54,  1.64it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 61/150 [00:36<00:43,  2.06it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 62/150 [00:37<00:45,  1.94it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 63/150 [00:37<00:47,  1.85it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 64/150 [00:38<00:48,  1.78it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 65/150 [00:38<00:49,  1.73it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 66/150 [00:39<00:49,  1.70it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 67/150 [00:40<00:49,  1.68it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 68/150 [00:40<00:49,  1.67it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 69/150 [00:41<00:48,  1.66it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 70/150 [00:41<00:48,  1.65it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 71/150 [00:42<00:48,  1.64it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 72/150 [00:43<00:47,  1.64it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 73/150 [00:43<00:47,  1.64it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 74/150 [00:44<00:46,  1.63it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 75/150 [00:44<00:45,  1.63it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 76/150 [00:45<00:45,  1.63it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 77/150 [00:46<00:44,  1.63it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 78/150 [00:46<00:44,  1.63it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 79/150 [00:47<00:43,  1.63it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 80/150 [00:48<00:42,  1.63it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 81/150 [00:48<00:42,  1.64it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 82/150 [00:49<00:41,  1.64it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 83/150 [00:49<00:40,  1.63it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 84/150 [00:50<00:40,  1.63it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 85/150 [00:51<00:39,  1.63it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 86/150 [00:51<00:39,  1.63it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 87/150 [00:52<00:38,  1.63it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 88/150 [00:52<00:38,  1.63it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 89/150 [00:53<00:37,  1.64it/s]                                                {'loss': 0.0, 'grad_norm': 2.6519421226112172e-05, 'learning_rate': 2.0644488262494696e-05, 'epoch': 3.0}
 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 90/150 [00:53<00:36,  1.64it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 91/150 [00:54<00:28,  2.07it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 92/150 [00:54<00:30,  1.93it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 93/150 [00:55<00:30,  1.84it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 94/150 [00:56<00:31,  1.78it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 95/150 [00:56<00:31,  1.73it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 96/150 [00:57<00:31,  1.70it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 97/150 [00:57<00:31,  1.68it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 98/150 [00:58<00:31,  1.67it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 99/150 [00:59<00:30,  1.66it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 100/150 [00:59<00:30,  1.65it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 101/150 [01:00<00:29,  1.64it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 102/150 [01:00<00:29,  1.64it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 103/150 [01:01<00:28,  1.63it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 104/150 [01:02<00:28,  1.63it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 105/150 [01:02<00:27,  1.63it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 106/150 [01:03<00:27,  1.63it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 107/150 [01:04<00:26,  1.63it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 108/150 [01:04<00:25,  1.63it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 109/150 [01:05<00:25,  1.63it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 110/150 [01:05<00:24,  1.63it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 111/150 [01:06<00:23,  1.63it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 112/150 [01:07<00:23,  1.63it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 113/150 [01:07<00:22,  1.63it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 114/150 [01:08<00:22,  1.63it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 115/150 [01:08<00:21,  1.63it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 116/150 [01:09<00:20,  1.63it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 117/150 [01:10<00:20,  1.63it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 118/150 [01:10<00:19,  1.63it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 119/150 [01:11<00:18,  1.64it/s]                                                 {'loss': 0.0, 'grad_norm': 5.030654392612632e-06, 'learning_rate': 1.0322244131247348e-05, 'epoch': 4.0}
 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 120/150 [01:11<00:18,  1.64it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 121/150 [01:12<00:14,  2.06it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 122/150 [01:12<00:14,  1.93it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 123/150 [01:13<00:14,  1.84it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 124/150 [01:13<00:14,  1.78it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 125/150 [01:14<00:14,  1.73it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 126/150 [01:15<00:14,  1.70it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 127/150 [01:15<00:13,  1.68it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 128/150 [01:16<00:13,  1.67it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 129/150 [01:17<00:12,  1.66it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 130/150 [01:17<00:12,  1.65it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 131/150 [01:18<00:11,  1.64it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 132/150 [01:18<00:10,  1.64it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 133/150 [01:19<00:10,  1.64it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 134/150 [01:20<00:09,  1.64it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 135/150 [01:20<00:09,  1.63it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 136/150 [01:21<00:08,  1.63it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 137/150 [01:21<00:07,  1.63it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 138/150 [01:22<00:07,  1.63it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 139/150 [01:23<00:06,  1.63it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 140/150 [01:23<00:06,  1.63it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 141/150 [01:24<00:05,  1.63it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 142/150 [01:24<00:04,  1.63it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 143/150 [01:25<00:04,  1.63it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 144/150 [01:26<00:03,  1.62it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 145/150 [01:26<00:03,  1.62it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 146/150 [01:27<00:02,  1.62it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 147/150 [01:28<00:01,  1.63it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 148/150 [01:28<00:01,  1.63it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 149/150 [01:29<00:00,  1.64it/s]                                                 {'loss': 0.0, 'grad_norm': 7.4080426202272065e-06, 'learning_rate': 0.0, 'epoch': 5.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150/150 [01:31<00:00,  1.64it/s]                                                 {'train_runtime': 91.8057, 'train_samples_per_second': 37.961, 'train_steps_per_second': 1.634, 'train_loss': 0.0001456978901084464, 'epoch': 5.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150/150 [01:31<00:00,  1.64it/s]2025-06-06 12:05:56,508 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150/150 [01:31<00:00,  1.63it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.23it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.60it/s]2025-06-06 12:06:00,089 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.09s/it]
2025-06-06 12:06:00,094 - INFO - Training time : 96.1467714800965
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.09it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.02it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.35it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.09it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.24it/s]2025-06-06 12:06:04,667 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.41it/s]
2025-06-06 12:06:04,672 - INFO - Evaluation time : 4.577934558968991
2025-06-06 12:06:04,672 - INFO - Evaluation results on test set: {'eval_loss': 0.0002986421750392765, 'eval_f1': 0.98989898989899, 'eval_recall': 1.0, 'eval_accuracy': 0.9849624060150376, 'eval_precision': 0.98, 'eval_optim_threshold': 0.9354790449142456, 'eval_AP': 1.0, 'eval_MCC': 0.9612491872558332, 'eval_NDCG': 1.0000000000000004, 'eval_kappa': 0.9604989604989604, 'eval_runtime': 4.5733, 'eval_samples_per_second': 29.082, 'eval_steps_per_second': 1.312, 'epoch': 5.0}
2025-06-06 12:06:04,673 - INFO - Total updates (optimizer steps): 150
2025-06-06 12:06:04,673 - INFO - Avg time / step: 0.612s
2025-06-06 12:06:05,384 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_focalgoogle-bert/bert-base-uncased3trials_fold-1
2025-06-06 12:06:05,384 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.13it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.02it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:01<00:00,  3.12it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  3.29it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  3.63it/s]2025-06-06 12:06:10,220 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.32it/s]
2025-06-06 12:06:10,224 - INFO - preds : [1 1 1 0 0 1 1 1 1 1 1 1 0 0 1 0 1 0 1 1 1 0 1 1 0 0 1 0 0 0 0 1 1 1 1 1 1
 1 1 1 0 1 1 0 0 1 1 1 1 1 1 1 1 0 0 1 1 1 1 0 1 1 1 1 1 0 1 1 0 1 1 1 1 1
 1 1 0 1 0 0 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 0 0 1 0 1 1 1
 1 0 0 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1 1 1 0]
2025-06-06 12:06:10,225 - INFO - test_split["labels"] : [1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0]
2025-06-06 12:06:10,227 - INFO - Confusion matrix: TN=33, FP=2, FN=0, TP=98
2025-06-06 12:06:13,145 - INFO - Metrics: {'f1': 0.98989898989899, 'recall': 1.0, 'precision': 0.98, 'accuracy': 0.9849624060150376, 'AP': 1.0, 'MCC': 0.9612491872558332, 'NDCG': 1.0000000000000004, 'kappa': 0.9604989604989604, 'TN': 33, 'FP': 2, 'FN': 0, 'TP': 98}
2025-06-06 12:06:13,270 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-06 12:06:13,371 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 12:06:13,371 - INFO - 
On test Set (optimal threshold of 0.9314864277839661 according to cross validation on the training set): 
2025-06-06 12:06:13,373 - INFO - Confusion matrix: TN=35, FP=0, FN=0, TP=98
2025-06-06 12:06:16,148 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 35, 'FP': 0, 'FN': 0, 'TP': 98}
2025-06-06 12:06:16,242 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 12:06:16,242 - INFO - Results for fold 1 : [{'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 35, 'FP': 0, 'FN': 0, 'TP': 98}]
2025-06-06 12:06:16,357 - INFO - Cleared CUDA cache. Memory allocated: 1.41 GB, Memory reserved: 1.79 GB
2025-06-06 12:06:16,357 - INFO - 
fold number 2 / 3
2025-06-06 12:06:16,364 - INFO - train split size : 697
2025-06-06 12:06:16,364 - INFO - dev split size : 67
2025-06-06 12:06:16,364 - INFO - test split size : 132
Map (num_proc=32):   0%|          | 0/697 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 22/697 [00:00<00:07, 94.34 examples/s]Map (num_proc=32):  16%|â–ˆâ–Œ        | 110/697 [00:00<00:01, 374.57 examples/s]Map (num_proc=32):  28%|â–ˆâ–ˆâ–Š       | 198/697 [00:00<00:00, 513.53 examples/s]Map (num_proc=32):  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 286/697 [00:00<00:00, 626.48 examples/s]Map (num_proc=32):  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 374/697 [00:00<00:00, 648.63 examples/s]Map (num_proc=32):  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 462/697 [00:00<00:00, 651.42 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 550/697 [00:00<00:00, 699.80 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 634/697 [00:01<00:00, 697.96 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 697/697 [00:01<00:00, 553.92 examples/s]
Map (num_proc=32):   0%|          | 0/67 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/67 [00:00<00:03, 16.05 examples/s]Map (num_proc=32):  19%|â–ˆâ–‰        | 13/67 [00:00<00:01, 50.46 examples/s]Map (num_proc=32):  31%|â–ˆâ–ˆâ–ˆâ–      | 21/67 [00:00<00:00, 59.06 examples/s]Map (num_proc=32):  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 29/67 [00:00<00:00, 64.71 examples/s]Map (num_proc=32):  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 37/67 [00:00<00:00, 67.54 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 45/67 [00:00<00:00, 69.64 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 53/67 [00:00<00:00, 70.73 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 61/67 [00:00<00:00, 71.06 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:01<00:00, 58.43 examples/s]
Map (num_proc=32):   0%|          | 0/132 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/132 [00:00<00:04, 26.62 examples/s]Map (num_proc=32):  18%|â–ˆâ–Š        | 24/132 [00:00<00:01, 90.84 examples/s]Map (num_proc=32):  30%|â–ˆâ–ˆâ–ˆ       | 40/132 [00:00<00:00, 111.36 examples/s]Map (num_proc=32):  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 56/132 [00:00<00:00, 123.23 examples/s]Map (num_proc=32):  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 72/132 [00:00<00:00, 128.36 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 88/132 [00:00<00:00, 133.73 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 104/132 [00:00<00:00, 136.03 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 120/132 [00:00<00:00, 139.09 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 132/132 [00:01<00:00, 112.82 examples/s]
2025-06-06 12:06:25,866 - INFO - 3 datasets tokenized successfully
2025-06-06 12:06:25,868 - INFO - Starting hyperparameter search for focal loss
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-06_12-06-25   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_12-06-25
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-06_10-55-47_424551_3536632/artifacts/2025-06-06_12-06-25/train_hpo_2025-06-06_12-06-25/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-06 12:06:26. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_4154932a   PENDING    0.625202   2.69927       1.88223e-05          0.13641                    4 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_4154932a started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_4154932a config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                                0.6252 â”‚
â”‚ gamma                               2.69927 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          4 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3622728)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3622728)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3622728)[0m 2025-06-06 12:06:33,115 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.6252016107931255 and gamma=2.6992695521978884
[36m(train_hpo pid=3622728)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3622728)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3622728)[0m [2025-06-06 12:06:33,367] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3622728)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=32, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3622728)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3622728)[0m   warnings.warn(

Trial train_hpo_5c2c1346 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_5c2c1346 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.97058 â”‚
â”‚ gamma                                4.6341 â”‚
â”‚ learning_rate                         5e-05 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3622890)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3622890)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3622890)[0m 2025-06-06 12:06:39,975 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.970577641092792 and gamma=4.634102840173219
[36m(train_hpo pid=3622890)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3622890)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3622890)[0m [2025-06-06 12:06:40,270] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3622890)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3622890)[0m   warnings.warn(
[36m(train_hpo pid=3622890)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_b56b060b started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_b56b060b config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.78112 â”‚
â”‚ gamma                               6.80707 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          2 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3623170)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3623170)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3623170)[0m 2025-06-06 12:06:46,883 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.7811204413478371 and gamma=6.807074484302038
[36m(train_hpo pid=3623170)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3623170)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3623170)[0m [2025-06-06 12:06:47,132] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3623170)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3623170)[0m   warnings.warn(
[36m(train_hpo pid=3623170)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=16, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 3 RUNNING
Current time: 2025-06-06 12:06:56. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_4154932a   RUNNING    0.625202   2.69927       1.88223e-05         0.13641                     4 â”‚
â”‚ train_hpo_5c2c1346   RUNNING    0.970578   4.6341        5.16112e-05         0.123031                    5 â”‚
â”‚ train_hpo_b56b060b   RUNNING    0.78112    6.80707       1.88581e-05         0.251217                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3622728)[0m {'loss': 0.0646, 'grad_norm': 0.21509411931037903, 'learning_rate': 1.4116733618581595e-05, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3623170)[0m {'loss': 0.0028, 'grad_norm': 0.1394190937280655, 'learning_rate': 9.429055465477227e-06, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3622890)[0m {'loss': 0.0042, 'grad_norm': 0.05746649578213692, 'learning_rate': 4.128897652498939e-05, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3623170)[0m {'train_runtime': 25.1838, 'train_samples_per_second': 55.353, 'train_steps_per_second': 0.635, 'train_loss': 0.0019068274414166808, 'epoch': 1.9142857142857141}
[36m(train_hpo pid=3623170)[0m STATE at ending of training  :  TrainerState(epoch=1.9142857142857141, global_step=16, max_steps=16, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=341578805140200.0, log_history=[{'loss': 0.0028, 'grad_norm': 0.1394190937280655, 'learning_rate': 9.429055465477227e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.001, 'grad_norm': 0.07233496755361557, 'learning_rate': 0.0, 'epoch': 1.9142857142857141, 'step': 16}, {'train_runtime': 25.1838, 'train_samples_per_second': 55.353, 'train_steps_per_second': 0.635, 'total_flos': 341578805140200.0, 'train_loss': 0.0019068274414166808, 'epoch': 1.9142857142857141, 'step': 16}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3623170)[0m 2025-06-06 12:07:19,137 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3623170)[0m 2025-06-06 12:07:19,143 - INFO - eval_result: {'eval_loss': 0.0009558117599226534, 'eval_f1': 0.9690721649484536, 'eval_recall': 0.9591836734693877, 'eval_accuracy': 0.9552238805970149, 'eval_precision': 0.9791666666666666, 'eval_optim_threshold': 0.5158244967460632, 'eval_AP': 0.9963403927015102, 'eval_MCC': 0.8886415378935835, 'eval_NDCG': 0.9993578054967592, 'eval_kappa': 0.8880222841225627, 'eval_runtime': 3.57, 'eval_samples_per_second': 18.768, 'eval_steps_per_second': 1.12, 'epoch': 1.9142857142857141}
[36m(train_hpo pid=3623170)[0m {'eval_loss': 0.0009558117599226534, 'eval_f1': 0.9690721649484536, 'eval_recall': 0.9591836734693877, 'eval_accuracy': 0.9552238805970149, 'eval_precision': 0.9791666666666666, 'eval_optim_threshold': 0.5158244967460632, 'eval_AP': 0.9963403927015102, 'eval_MCC': 0.8886415378935835, 'eval_NDCG': 0.9993578054967592, 'eval_kappa': 0.8880222841225627, 'eval_runtime': 3.57, 'eval_samples_per_second': 18.768, 'eval_steps_per_second': 1.12, 'epoch': 1.9142857142857141}
[36m(train_hpo pid=3623170)[0m {'loss': 0.001, 'grad_norm': 0.07233496755361557, 'learning_rate': 0.0, 'epoch': 1.9142857142857141}

Trial train_hpo_b56b060b finished iteration 1 at 2025-06-06 12:07:19. Total running time: 53s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_b56b060b result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    32.7366 â”‚
â”‚ time_total_s                        32.7366 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               1.91429 â”‚
â”‚ eval_AP                             0.99634 â”‚
â”‚ eval_MCC                            0.88864 â”‚
â”‚ eval_NDCG                           0.99936 â”‚
â”‚ eval_accuracy                       0.95522 â”‚
â”‚ eval_f1                             0.96907 â”‚
â”‚ eval_kappa                          0.88802 â”‚
â”‚ eval_loss                           0.00096 â”‚
â”‚ eval_optim_threshold                0.51582 â”‚
â”‚ eval_precision                      0.97917 â”‚
â”‚ eval_recall                         0.95918 â”‚
â”‚ eval_runtime                           3.57 â”‚
â”‚ eval_samples_per_second              18.768 â”‚
â”‚ eval_steps_per_second                  1.12 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 12:07:19,199 - INFO - Cleaning up trial b56b060b
2025-06-06 12:07:19,199 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_12-06-25/train_hpo_b56b060b_3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512_2025-06-06_12-06-39

Trial train_hpo_b56b060b completed after 1 iterations at 2025-06-06 12:07:19. Total running time: 53s
[36m(train_hpo pid=3623170)[0m 2025-06-06 12:07:19,175 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 12:07:26. Total running time: 1min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_4154932a   RUNNING      0.625202   2.69927       1.88223e-05         0.13641                     4                                                                                         â”‚
â”‚ train_hpo_5c2c1346   RUNNING      0.970578   4.6341        5.16112e-05         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_b56b060b   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            32.7366   0.000955812    0.969072        0.959184          0.955224 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3622728)[0m {'loss': 0.028, 'grad_norm': 0.5160390138626099, 'learning_rate': 9.411155745721064e-06, 'epoch': 1.9142857142857141}
[36m(train_hpo pid=3622890)[0m {'loss': 0.0006, 'grad_norm': 0.016191795468330383, 'learning_rate': 3.096673239374204e-05, 'epoch': 1.9142857142857141}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 12:07:56. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_4154932a   RUNNING      0.625202   2.69927       1.88223e-05         0.13641                     4                                                                                         â”‚
â”‚ train_hpo_5c2c1346   RUNNING      0.970578   4.6341        5.16112e-05         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_b56b060b   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            32.7366   0.000955812    0.969072        0.959184          0.955224 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3622728)[0m {'loss': 0.016, 'grad_norm': 0.4318476617336273, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3622890)[0m {'loss': 0.0002, 'grad_norm': 0.008016725070774555, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3622728)[0m {'loss': 0.0122, 'grad_norm': 0.29652395844459534, 'learning_rate': 0.0, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3622728)[0m {'train_runtime': 108.81, 'train_samples_per_second': 25.623, 'train_steps_per_second': 0.294, 'train_loss': 0.03021316323429346, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3622728)[0m STATE at ending of training  :  TrainerState(epoch=3.914285714285714, global_step=32, max_steps=32, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=688152564373920.0, log_history=[{'loss': 0.0646, 'grad_norm': 0.21509411931037903, 'learning_rate': 1.4116733618581595e-05, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.028, 'grad_norm': 0.5160390138626099, 'learning_rate': 9.411155745721064e-06, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 0.016, 'grad_norm': 0.4318476617336273, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 0.0122, 'grad_norm': 0.29652395844459534, 'learning_rate': 0.0, 'epoch': 3.914285714285714, 'step': 32}, {'train_runtime': 108.81, 'train_samples_per_second': 25.623, 'train_steps_per_second': 0.294, 'total_flos': 688152564373920.0, 'train_loss': 0.03021316323429346, 'epoch': 3.914285714285714, 'step': 32}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 12:08:26. Total running time: 2min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_4154932a   RUNNING      0.625202   2.69927       1.88223e-05         0.13641                     4                                                                                         â”‚
â”‚ train_hpo_5c2c1346   RUNNING      0.970578   4.6341        5.16112e-05         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_b56b060b   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            32.7366   0.000955812    0.969072        0.959184          0.955224 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3622728)[0m 2025-06-06 12:08:29,683 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png

Trial train_hpo_4154932a finished iteration 1 at 2025-06-06 12:08:29. Total running time: 2min 3s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_4154932a result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    117.064 â”‚
â”‚ time_total_s                        117.064 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               3.91429 â”‚
â”‚ eval_AP                             0.99878 â”‚
â”‚ eval_MCC                            0.88615 â”‚
â”‚ eval_NDCG                           0.99979 â”‚
â”‚ eval_accuracy                       0.95522 â”‚
â”‚ eval_f1                              0.9703 â”‚
â”‚ eval_kappa                          0.87971 â”‚
â”‚ eval_loss                           0.03114 â”‚
â”‚ eval_optim_threshold                0.56327 â”‚
â”‚ eval_precision                      0.94231 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         4.2414 â”‚
â”‚ eval_samples_per_second              15.797 â”‚
â”‚ eval_steps_per_second                 0.943 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 12:08:29,760 - INFO - Cleaning up trial 4154932a
2025-06-06 12:08:29,760 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_12-06-25/train_hpo_4154932a_1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364_2025-06-06_12-06-25
2025-06-06 12:08:29,760 - INFO - Cleaning up trial b56b060b
2025-06-06 12:08:29,760 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_12-06-25/train_hpo_b56b060b_3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512_2025-06-06_12-06-39

Trial train_hpo_4154932a completed after 1 iterations at 2025-06-06 12:08:29. Total running time: 2min 3s
[36m(train_hpo pid=3622728)[0m {'eval_loss': 0.031140390783548355, 'eval_f1': 0.9702970297029703, 'eval_recall': 1.0, 'eval_accuracy': 0.9552238805970149, 'eval_precision': 0.9423076923076923, 'eval_optim_threshold': 0.5632672309875488, 'eval_AP': 0.9987831867440855, 'eval_MCC': 0.8861469461982082, 'eval_NDCG': 0.9997894476014363, 'eval_kappa': 0.8797127468581688, 'eval_runtime': 4.2414, 'eval_samples_per_second': 15.797, 'eval_steps_per_second': 0.943, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3622728)[0m 2025-06-06 12:08:29,689 - INFO - eval_result: {'eval_loss': 0.031140390783548355, 'eval_f1': 0.9702970297029703, 'eval_recall': 1.0, 'eval_accuracy': 0.9552238805970149, 'eval_precision': 0.9423076923076923, 'eval_optim_threshold': 0.5632672309875488, 'eval_AP': 0.9987831867440855, 'eval_MCC': 0.8861469461982082, 'eval_NDCG': 0.9997894476014363, 'eval_kappa': 0.8797127468581688, 'eval_runtime': 4.2414, 'eval_samples_per_second': 15.797, 'eval_steps_per_second': 0.943, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3622728)[0m 2025-06-06 12:08:29,732 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3622890)[0m {'loss': 0.0001, 'grad_norm': 0.03945358842611313, 'learning_rate': 1.0322244131247348e-05, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3622890)[0m {'loss': 0.0001, 'grad_norm': 0.004536852240562439, 'learning_rate': 0.0, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3622890)[0m {'train_runtime': 122.4109, 'train_samples_per_second': 28.47, 'train_steps_per_second': 0.327, 'train_loss': 0.001029365554859396, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3622890)[0m STATE at ending of training  :  TrainerState(epoch=4.914285714285715, global_step=40, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=861454860515760.0, log_history=[{'loss': 0.0042, 'grad_norm': 0.05746649578213692, 'learning_rate': 4.128897652498939e-05, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.0006, 'grad_norm': 0.016191795468330383, 'learning_rate': 3.096673239374204e-05, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 0.0002, 'grad_norm': 0.008016725070774555, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 0.0001, 'grad_norm': 0.03945358842611313, 'learning_rate': 1.0322244131247348e-05, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 0.0001, 'grad_norm': 0.004536852240562439, 'learning_rate': 0.0, 'epoch': 4.914285714285715, 'step': 40}, {'train_runtime': 122.4109, 'train_samples_per_second': 28.47, 'train_steps_per_second': 0.327, 'total_flos': 861454860515760.0, 'train_loss': 0.001029365554859396, 'epoch': 4.914285714285715, 'step': 40}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3622890)[0m 2025-06-06 12:08:49,505 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3622890)[0m 2025-06-06 12:08:49,511 - INFO - eval_result: {'eval_loss': 3.3656458981567994e-05, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.8372925519943237, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.5852, 'eval_samples_per_second': 18.688, 'eval_steps_per_second': 1.116, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3622890)[0m 2025-06-06 12:08:49,550 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3622890)[0m {'eval_loss': 3.3656458981567994e-05, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.8372925519943237, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.5852, 'eval_samples_per_second': 18.688, 'eval_steps_per_second': 1.116, 'epoch': 4.914285714285715}

Trial train_hpo_5c2c1346 finished iteration 1 at 2025-06-06 12:08:49. Total running time: 2min 23s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_5c2c1346 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    130.028 â”‚
â”‚ time_total_s                        130.028 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               4.91429 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                                  1 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                             1 â”‚
â”‚ eval_f1                                   1 â”‚
â”‚ eval_kappa                                1 â”‚
â”‚ eval_loss                             3e-05 â”‚
â”‚ eval_optim_threshold                0.83729 â”‚
â”‚ eval_precision                            1 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.5852 â”‚
â”‚ eval_samples_per_second              18.688 â”‚
â”‚ eval_steps_per_second                 1.116 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 12:08:49,575 - INFO - Cleaning up trial 5c2c1346
2025-06-06 12:08:49,575 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_12-06-25/train_hpo_5c2c1346_2_alpha=0.9706,gamma=4.6341,learning_rate=0.0001,num_train_epochs=5,weight_decay=0.1230_2025-06-06_12-06-32
2025-06-06 12:08:49,575 - INFO - Cleaning up trial 4154932a
2025-06-06 12:08:49,575 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_12-06-25/train_hpo_4154932a_1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364_2025-06-06_12-06-25
2025-06-06 12:08:49,575 - INFO - Cleaning up trial b56b060b
2025-06-06 12:08:49,576 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_12-06-25/train_hpo_b56b060b_3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512_2025-06-06_12-06-39

Trial train_hpo_5c2c1346 completed after 1 iterations at 2025-06-06 12:08:49. Total running time: 2min 23s
2025-06-06 12:08:49,583	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_12-06-25' in 0.0053s.

Trial status: 3 TERMINATED
Current time: 2025-06-06 12:08:49. Total running time: 2min 23s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_4154932a   TERMINATED   0.625202   2.69927       1.88223e-05         0.13641                     4        1           117.064    0.0311404      0.970297        1                 0.955224 â”‚
â”‚ train_hpo_5c2c1346   TERMINATED   0.970578   4.6341        5.16112e-05         0.123031                    5        1           130.028    3.36565e-05    1               1                 1        â”‚
â”‚ train_hpo_b56b060b   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            32.7366   0.000955812    0.969072        0.959184          0.955224 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

2025-06-06 12:08:49,590 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x700d3bf96bd0>
2025-06-06 12:08:49,590 - INFO - Best trial : train_hpo_5c2c1346
2025-06-06 12:08:49,590 - INFO - Best config : {'alpha': 0.970577641092792, 'gamma': 4.634102840173219, 'learning_rate': 5.1611220656236736e-05, 'weight_decay': 0.12303118765599412, 'num_train_epochs': 5}
2025-06-06 12:08:49,590 - INFO - Best trial after optimization: {'eval_loss': 3.3656458981567994e-05, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.8372925519943237, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.5852, 'eval_samples_per_second': 18.688, 'eval_steps_per_second': 1.116, 'epoch': 4.914285714285715, 'timestamp': 1749204529, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '5c2c1346', 'date': '2025-06-06_12-08-49', 'time_this_iter_s': 130.02783942222595, 'time_total_s': 130.02783942222595, 'pid': 3622890, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'alpha': 0.970577641092792, 'gamma': 4.634102840173219, 'learning_rate': 5.1611220656236736e-05, 'weight_decay': 0.12303118765599412, 'num_train_epochs': 5}, 'time_since_restore': 130.02783942222595, 'iterations_since_restore': 1, 'experiment_tag': '2_alpha=0.9706,gamma=4.6341,learning_rate=0.0001,num_train_epochs=5,weight_decay=0.1230'}
2025-06-06 12:08:49,611 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   0.031140  0.970297  ...                        4  4154932a
1   0.000034  1.000000  ...                        5  5c2c1346
2   0.000956  0.969072  ...                        2  b56b060b

[3 rows x 33 columns]
2025-06-06 12:08:49,795 - INFO - Trial comparison plot saved
2025-06-06 12:08:49,795 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-06 12:08:50,036 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.25 and gamma=2.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-06 12:08:50,151 - INFO - training size : 697
2025-06-06 12:08:50,152 - INFO - dev size : 67
2025-06-06 12:08:50,152 - INFO - test size : 132
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
  0%|          | 0/150 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  1%|          | 1/150 [00:00<01:36,  1.55it/s]  1%|â–         | 2/150 [00:01<01:32,  1.59it/s]  2%|â–         | 3/150 [00:01<01:31,  1.61it/s]  3%|â–Ž         | 4/150 [00:02<01:30,  1.61it/s]  3%|â–Ž         | 5/150 [00:03<01:29,  1.62it/s]  4%|â–         | 6/150 [00:03<01:28,  1.62it/s]  5%|â–         | 7/150 [00:04<01:28,  1.62it/s]  5%|â–Œ         | 8/150 [00:04<01:27,  1.62it/s]  6%|â–Œ         | 9/150 [00:05<01:26,  1.62it/s]  7%|â–‹         | 10/150 [00:06<01:26,  1.62it/s]  7%|â–‹         | 11/150 [00:06<01:25,  1.62it/s]  8%|â–Š         | 12/150 [00:07<01:25,  1.62it/s]  9%|â–Š         | 13/150 [00:08<01:24,  1.62it/s]  9%|â–‰         | 14/150 [00:08<01:23,  1.62it/s] 10%|â–ˆ         | 15/150 [00:09<01:23,  1.62it/s] 11%|â–ˆ         | 16/150 [00:09<01:22,  1.62it/s] 11%|â–ˆâ–        | 17/150 [00:10<01:21,  1.62it/s] 12%|â–ˆâ–        | 18/150 [00:11<01:21,  1.62it/s] 13%|â–ˆâ–Ž        | 19/150 [00:11<01:20,  1.63it/s] 13%|â–ˆâ–Ž        | 20/150 [00:12<01:19,  1.63it/s] 14%|â–ˆâ–        | 21/150 [00:12<01:19,  1.63it/s] 15%|â–ˆâ–        | 22/150 [00:13<01:18,  1.63it/s] 15%|â–ˆâ–Œ        | 23/150 [00:14<01:18,  1.63it/s] 16%|â–ˆâ–Œ        | 24/150 [00:14<01:17,  1.63it/s] 17%|â–ˆâ–‹        | 25/150 [00:15<01:16,  1.63it/s] 17%|â–ˆâ–‹        | 26/150 [00:16<01:16,  1.63it/s] 18%|â–ˆâ–Š        | 27/150 [00:16<01:15,  1.63it/s] 19%|â–ˆâ–Š        | 28/150 [00:17<01:14,  1.63it/s] 19%|â–ˆâ–‰        | 29/150 [00:17<01:13,  1.64it/s]                                                {'loss': 0.0008, 'grad_norm': 4.772854663315229e-05, 'learning_rate': 4.128897652498939e-05, 'epoch': 1.0}
 20%|â–ˆâ–ˆ        | 30/150 [00:17<01:13,  1.64it/s] 21%|â–ˆâ–ˆ        | 31/150 [00:18<00:58,  2.05it/s] 21%|â–ˆâ–ˆâ–       | 32/150 [00:19<01:01,  1.92it/s] 22%|â–ˆâ–ˆâ–       | 33/150 [00:19<01:03,  1.84it/s] 23%|â–ˆâ–ˆâ–Ž       | 34/150 [00:20<01:05,  1.77it/s] 23%|â–ˆâ–ˆâ–Ž       | 35/150 [00:21<01:06,  1.73it/s] 24%|â–ˆâ–ˆâ–       | 36/150 [00:21<01:07,  1.70it/s] 25%|â–ˆâ–ˆâ–       | 37/150 [00:22<01:07,  1.68it/s] 25%|â–ˆâ–ˆâ–Œ       | 38/150 [00:22<01:07,  1.66it/s] 26%|â–ˆâ–ˆâ–Œ       | 39/150 [00:23<01:07,  1.65it/s] 27%|â–ˆâ–ˆâ–‹       | 40/150 [00:24<01:07,  1.64it/s] 27%|â–ˆâ–ˆâ–‹       | 41/150 [00:24<01:06,  1.64it/s] 28%|â–ˆâ–ˆâ–Š       | 42/150 [00:25<01:05,  1.65it/s] 29%|â–ˆâ–ˆâ–Š       | 43/150 [00:25<01:05,  1.64it/s] 29%|â–ˆâ–ˆâ–‰       | 44/150 [00:26<01:04,  1.64it/s] 30%|â–ˆâ–ˆâ–ˆ       | 45/150 [00:27<01:04,  1.63it/s] 31%|â–ˆâ–ˆâ–ˆ       | 46/150 [00:27<01:03,  1.63it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 47/150 [00:28<01:03,  1.63it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 48/150 [00:28<01:02,  1.63it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 49/150 [00:29<01:02,  1.63it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 50/150 [00:30<01:01,  1.63it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 51/150 [00:30<01:00,  1.63it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 52/150 [00:31<01:00,  1.63it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 53/150 [00:32<00:59,  1.62it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 54/150 [00:32<00:59,  1.62it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 55/150 [00:33<00:58,  1.62it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 56/150 [00:33<00:57,  1.62it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 57/150 [00:34<00:57,  1.63it/s] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 58/150 [00:35<00:56,  1.63it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 59/150 [00:35<00:55,  1.64it/s]                                                {'loss': 0.0, 'grad_norm': 5.839653567818459e-06, 'learning_rate': 3.096673239374204e-05, 'epoch': 2.0}
 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 60/150 [00:35<00:54,  1.64it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 61/150 [00:36<00:43,  2.06it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 62/150 [00:37<00:45,  1.93it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 63/150 [00:37<00:47,  1.85it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 64/150 [00:38<00:48,  1.78it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 65/150 [00:38<00:48,  1.74it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 66/150 [00:39<00:49,  1.71it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 67/150 [00:40<00:49,  1.68it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 68/150 [00:40<00:49,  1.67it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 69/150 [00:41<00:48,  1.66it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 70/150 [00:41<00:48,  1.65it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 71/150 [00:42<00:48,  1.64it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 72/150 [00:43<00:47,  1.63it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 73/150 [00:43<00:47,  1.63it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 74/150 [00:44<00:46,  1.63it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 75/150 [00:45<00:46,  1.63it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 76/150 [00:45<00:45,  1.63it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 77/150 [00:46<00:44,  1.63it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 78/150 [00:46<00:44,  1.63it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 79/150 [00:47<00:43,  1.63it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 80/150 [00:48<00:43,  1.63it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 81/150 [00:48<00:42,  1.64it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 82/150 [00:49<00:41,  1.63it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 83/150 [00:49<00:41,  1.63it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 84/150 [00:50<00:40,  1.63it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 85/150 [00:51<00:39,  1.63it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 86/150 [00:51<00:39,  1.63it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 87/150 [00:52<00:38,  1.63it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 88/150 [00:52<00:38,  1.63it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 89/150 [00:53<00:37,  1.64it/s]                                                {'loss': 0.0, 'grad_norm': 2.917685378633905e-06, 'learning_rate': 2.0644488262494696e-05, 'epoch': 3.0}
 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 90/150 [00:53<00:36,  1.64it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 91/150 [00:54<00:28,  2.06it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 92/150 [00:54<00:29,  1.94it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 93/150 [00:55<00:30,  1.84it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 94/150 [00:56<00:31,  1.78it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 95/150 [00:56<00:31,  1.74it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 96/150 [00:57<00:31,  1.70it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 97/150 [00:57<00:31,  1.68it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 98/150 [00:58<00:31,  1.68it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 99/150 [00:59<00:30,  1.66it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 100/150 [00:59<00:30,  1.65it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 101/150 [01:00<00:29,  1.64it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 102/150 [01:01<00:29,  1.64it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 103/150 [01:01<00:28,  1.63it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 104/150 [01:02<00:28,  1.63it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 105/150 [01:02<00:27,  1.63it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 106/150 [01:03<00:27,  1.63it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 107/150 [01:04<00:26,  1.63it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 108/150 [01:04<00:25,  1.63it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 109/150 [01:05<00:25,  1.63it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 110/150 [01:05<00:24,  1.64it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 111/150 [01:06<00:23,  1.63it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 112/150 [01:07<00:23,  1.63it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 113/150 [01:07<00:22,  1.63it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 114/150 [01:08<00:22,  1.63it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 115/150 [01:08<00:21,  1.63it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 116/150 [01:09<00:20,  1.63it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 117/150 [01:10<00:20,  1.63it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 118/150 [01:10<00:19,  1.63it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 119/150 [01:11<00:18,  1.64it/s]                                                 {'loss': 0.0, 'grad_norm': 1.543574580864515e-05, 'learning_rate': 1.0322244131247348e-05, 'epoch': 4.0}
 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 120/150 [01:11<00:18,  1.64it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 121/150 [01:12<00:14,  2.06it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 122/150 [01:12<00:14,  1.93it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 123/150 [01:13<00:14,  1.84it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 124/150 [01:13<00:14,  1.78it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 125/150 [01:14<00:14,  1.73it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 126/150 [01:15<00:14,  1.70it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 127/150 [01:15<00:13,  1.68it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 128/150 [01:16<00:13,  1.66it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 129/150 [01:17<00:12,  1.65it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 130/150 [01:17<00:12,  1.64it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 131/150 [01:18<00:11,  1.64it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 132/150 [01:18<00:10,  1.64it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 133/150 [01:19<00:10,  1.64it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 134/150 [01:20<00:09,  1.63it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 135/150 [01:20<00:09,  1.63it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 136/150 [01:21<00:08,  1.63it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 137/150 [01:21<00:07,  1.63it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 138/150 [01:22<00:07,  1.63it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 139/150 [01:23<00:06,  1.63it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 140/150 [01:23<00:06,  1.63it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 141/150 [01:24<00:05,  1.63it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 142/150 [01:25<00:04,  1.63it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 143/150 [01:25<00:04,  1.63it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 144/150 [01:26<00:03,  1.63it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 145/150 [01:26<00:03,  1.63it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 146/150 [01:27<00:02,  1.63it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 147/150 [01:28<00:01,  1.63it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 148/150 [01:28<00:01,  1.63it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 149/150 [01:29<00:00,  1.64it/s]                                                 {'loss': 0.0, 'grad_norm': 1.7209194993483834e-05, 'learning_rate': 0.0, 'epoch': 5.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150/150 [01:32<00:00,  1.64it/s]                                                 {'train_runtime': 92.0621, 'train_samples_per_second': 37.855, 'train_steps_per_second': 1.629, 'train_loss': 0.00016827932484981525, 'epoch': 5.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150/150 [01:32<00:00,  1.64it/s]2025-06-06 12:10:22,641 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150/150 [01:32<00:00,  1.63it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.19it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.38it/s]2025-06-06 12:10:26,449 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.17s/it]
2025-06-06 12:10:26,455 - INFO - Training time : 96.66032324288972
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.10it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  4.96it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.33it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.08it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.31it/s]2025-06-06 12:10:30,846 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.47it/s]
2025-06-06 12:10:30,851 - INFO - Evaluation time : 4.395537804113701
2025-06-06 12:10:30,851 - INFO - Evaluation results on test set: {'eval_loss': 0.00240022549405694, 'eval_f1': 0.9948717948717949, 'eval_recall': 0.9897959183673469, 'eval_accuracy': 0.9924242424242424, 'eval_precision': 1.0, 'eval_optim_threshold': 0.2624285817146301, 'eval_AP': 1.0, 'eval_MCC': 0.9805692402810843, 'eval_NDCG': 1.0000000000000004, 'eval_kappa': 0.9803804994054697, 'eval_runtime': 4.3913, 'eval_samples_per_second': 30.059, 'eval_steps_per_second': 1.366, 'epoch': 5.0}
2025-06-06 12:10:30,851 - INFO - Total updates (optimizer steps): 150
2025-06-06 12:10:30,851 - INFO - Avg time / step: 0.614s
2025-06-06 12:10:31,542 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_focalgoogle-bert/bert-base-uncased3trials_fold-2
2025-06-06 12:10:31,543 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.14it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.02it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:01<00:00,  3.02it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  3.22it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  3.62it/s]2025-06-06 12:10:36,513 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.29it/s]
2025-06-06 12:10:36,517 - INFO - preds : [1 1 0 1 1 1 1 1 1 0 1 0 1 1 0 1 1 1 1 1 1 0 1 0 1 1 1 1 0 1 1 0 1 1 1 1 1
 1 1 1 1 1 0 0 1 0 1 0 0 1 0 0 1 1 1 1 0 0 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 1 0 1 1 1 1 1 1 0 1 0 1 1 1 1 1 0 1 1 1 0 1
 1 0 1 1 1 0 0 1 0 0 1 1 1 1 1 1 1 0 1 1 1]
2025-06-06 12:10:36,518 - INFO - test_split["labels"] : [1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1]
2025-06-06 12:10:36,519 - INFO - Confusion matrix: TN=34, FP=0, FN=1, TP=97
2025-06-06 12:10:39,549 - INFO - Metrics: {'f1': 0.9948717948717949, 'recall': 0.9897959183673469, 'precision': 1.0, 'accuracy': 0.9924242424242424, 'AP': 1.0, 'MCC': 0.9805692402810843, 'NDCG': 1.0000000000000004, 'kappa': 0.9803804994054697, 'TN': 34, 'FP': 0, 'FN': 1, 'TP': 97}
2025-06-06 12:10:39,659 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-06 12:10:39,756 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 12:10:39,756 - INFO - 
On test Set (optimal threshold of 0.9313121438026428 according to cross validation on the training set): 
2025-06-06 12:10:39,757 - INFO - Confusion matrix: TN=34, FP=0, FN=6, TP=92
2025-06-06 12:10:42,631 - INFO - Metrics: {'f1': 0.968421052631579, 'recall': 0.9387755102040817, 'precision': 1.0, 'accuracy': 0.9545454545454546, 'AP': 1.0, 'MCC': 0.8932856114779132, 'NDCG': 1.0000000000000004, 'kappa': 0.887627695800227, 'TN': 34, 'FP': 0, 'FN': 6, 'TP': 92}
2025-06-06 12:10:42,729 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 12:10:42,729 - INFO - Results for fold 2 : [{'f1': 0.968421052631579, 'recall': 0.9387755102040817, 'precision': 1.0, 'accuracy': 0.9545454545454546, 'AP': 1.0, 'MCC': 0.8932856114779132, 'NDCG': 1.0000000000000004, 'kappa': 0.887627695800227, 'TN': 34, 'FP': 0, 'FN': 6, 'TP': 92}]
2025-06-06 12:10:42,854 - INFO - Cleared CUDA cache. Memory allocated: 1.42 GB, Memory reserved: 1.84 GB
2025-06-06 12:10:42,854 - INFO - 
fold number 3 / 3
2025-06-06 12:10:42,860 - INFO - train split size : 697
2025-06-06 12:10:42,860 - INFO - dev split size : 67
2025-06-06 12:10:42,860 - INFO - test split size : 132
Map (num_proc=32):   0%|          | 0/697 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 22/697 [00:00<00:07, 91.16 examples/s]Map (num_proc=32):  16%|â–ˆâ–Œ        | 110/697 [00:00<00:01, 363.88 examples/s]Map (num_proc=32):  28%|â–ˆâ–ˆâ–Š       | 198/697 [00:00<00:00, 529.87 examples/s]Map (num_proc=32):  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 308/697 [00:00<00:00, 673.13 examples/s]Map (num_proc=32):  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 396/697 [00:00<00:00, 717.47 examples/s]Map (num_proc=32):  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 484/697 [00:00<00:00, 742.03 examples/s]Map (num_proc=32):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 571/697 [00:00<00:00, 772.60 examples/s]Map (num_proc=32):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 655/697 [00:01<00:00, 782.36 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 697/697 [00:01<00:00, 592.69 examples/s]
Map (num_proc=32):   0%|          | 0/67 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/67 [00:00<00:03, 16.35 examples/s]Map (num_proc=32):  19%|â–ˆâ–‰        | 13/67 [00:00<00:01, 51.74 examples/s]Map (num_proc=32):  31%|â–ˆâ–ˆâ–ˆâ–      | 21/67 [00:00<00:00, 60.78 examples/s]Map (num_proc=32):  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 29/67 [00:00<00:00, 66.33 examples/s]Map (num_proc=32):  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 37/67 [00:00<00:00, 68.62 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 45/67 [00:00<00:00, 71.01 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 53/67 [00:00<00:00, 71.70 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 61/67 [00:00<00:00, 72.86 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:01<00:00, 58.88 examples/s]
Map (num_proc=32):   0%|          | 0/132 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/132 [00:00<00:05, 25.29 examples/s]Map (num_proc=32):  18%|â–ˆâ–Š        | 24/132 [00:00<00:01, 92.55 examples/s]Map (num_proc=32):  30%|â–ˆâ–ˆâ–ˆ       | 40/132 [00:00<00:00, 114.19 examples/s]Map (num_proc=32):  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 56/132 [00:00<00:00, 120.69 examples/s]Map (num_proc=32):  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 72/132 [00:00<00:00, 129.77 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 88/132 [00:00<00:00, 135.02 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 104/132 [00:00<00:00, 140.45 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 120/132 [00:00<00:00, 144.24 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 132/132 [00:01<00:00, 114.30 examples/s]
2025-06-06 12:10:52,828 - INFO - 3 datasets tokenized successfully
2025-06-06 12:10:52,830 - INFO - Starting hyperparameter search for focal loss
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-06_12-10-52   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_12-10-52
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-06_10-55-47_424551_3536632/artifacts/2025-06-06_12-10-52/train_hpo_2025-06-06_12-10-52/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-06 12:10:53. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_a63b9833   PENDING    0.625202   2.69927       1.88223e-05          0.13641                    4 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_a63b9833 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_a63b9833 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                                0.6252 â”‚
â”‚ gamma                               2.69927 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          4 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3627926)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3627926)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3627926)[0m 2025-06-06 12:11:00,151 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.6252016107931255 and gamma=2.6992695521978884
[36m(train_hpo pid=3627926)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3627926)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3627926)[0m [2025-06-06 12:11:00,415] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3627926)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3627926)[0m   warnings.warn(
[36m(train_hpo pid=3627926)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=32, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_41b462e5 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_41b462e5 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.97058 â”‚
â”‚ gamma                                4.6341 â”‚
â”‚ learning_rate                         5e-05 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3628157)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3628157)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3628157)[0m 2025-06-06 12:11:06,820 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.970577641092792 and gamma=4.634102840173219
[36m(train_hpo pid=3628157)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3628157)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3628157)[0m [2025-06-06 12:11:07,210] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3628157)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3628157)[0m   warnings.warn(
[36m(train_hpo pid=3628157)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_a8cd2637 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_a8cd2637 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.78112 â”‚
â”‚ gamma                               6.80707 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          2 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3628437)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3628437)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3628437)[0m 2025-06-06 12:11:13,783 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.7811204413478371 and gamma=6.807074484302038
[36m(train_hpo pid=3628437)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3628437)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3628437)[0m [2025-06-06 12:11:14,033] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3628437)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3628437)[0m   warnings.warn(
[36m(train_hpo pid=3628437)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=16, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 3 RUNNING
Current time: 2025-06-06 12:11:23. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_a63b9833   RUNNING    0.625202   2.69927       1.88223e-05         0.13641                     4 â”‚
â”‚ train_hpo_41b462e5   RUNNING    0.970578   4.6341        5.16112e-05         0.123031                    5 â”‚
â”‚ train_hpo_a8cd2637   RUNNING    0.78112    6.80707       1.88581e-05         0.251217                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3627926)[0m {'loss': 0.0429, 'grad_norm': 1.1656372547149658, 'learning_rate': 1.4116733618581595e-05, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3628437)[0m {'loss': 0.0061, 'grad_norm': 0.08307923376560211, 'learning_rate': 9.429055465477227e-06, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3628157)[0m {'loss': 0.0096, 'grad_norm': 0.03810420259833336, 'learning_rate': 4.128897652498939e-05, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3628437)[0m {'train_runtime': 25.1407, 'train_samples_per_second': 55.448, 'train_steps_per_second': 0.636, 'train_loss': 0.0038332119584083557, 'epoch': 1.9142857142857141}
[36m(train_hpo pid=3628437)[0m STATE at ending of training  :  TrainerState(epoch=1.9142857142857141, global_step=16, max_steps=16, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=340941588774360.0, log_history=[{'loss': 0.0061, 'grad_norm': 0.08307923376560211, 'learning_rate': 9.429055465477227e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.0016, 'grad_norm': 0.03969046100974083, 'learning_rate': 0.0, 'epoch': 1.9142857142857141, 'step': 16}, {'train_runtime': 25.1407, 'train_samples_per_second': 55.448, 'train_steps_per_second': 0.636, 'total_flos': 340941588774360.0, 'train_loss': 0.0038332119584083557, 'epoch': 1.9142857142857141, 'step': 16}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3628437)[0m 2025-06-06 12:11:45,756 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3628437)[0m 2025-06-06 12:11:45,763 - INFO - eval_result: {'eval_loss': 0.0034100355114787817, 'eval_f1': 0.8539325842696629, 'eval_recall': 0.76, 'eval_accuracy': 0.8059701492537313, 'eval_precision': 0.9743589743589743, 'eval_optim_threshold': 0.4801648259162903, 'eval_AP': 0.9664792850736345, 'eval_MCC': 0.6186221666302674, 'eval_NDCG': 0.9931722137655383, 'eval_kappa': 0.577799321376636, 'eval_runtime': 3.3287, 'eval_samples_per_second': 20.128, 'eval_steps_per_second': 1.202, 'epoch': 1.9142857142857141}
[36m(train_hpo pid=3628437)[0m 2025-06-06 12:11:45,802 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3628437)[0m {'eval_loss': 0.0034100355114787817, 'eval_f1': 0.8539325842696629, 'eval_recall': 0.76, 'eval_accuracy': 0.8059701492537313, 'eval_precision': 0.9743589743589743, 'eval_optim_threshold': 0.4801648259162903, 'eval_AP': 0.9664792850736345, 'eval_MCC': 0.6186221666302674, 'eval_NDCG': 0.9931722137655383, 'eval_kappa': 0.577799321376636, 'eval_runtime': 3.3287, 'eval_samples_per_second': 20.128, 'eval_steps_per_second': 1.202, 'epoch': 1.9142857142857141}
[36m(train_hpo pid=3628437)[0m {'loss': 0.0016, 'grad_norm': 0.03969046100974083, 'learning_rate': 0.0, 'epoch': 1.9142857142857141}

Trial train_hpo_a8cd2637 finished iteration 1 at 2025-06-06 12:11:45. Total running time: 52s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_a8cd2637 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    32.6492 â”‚
â”‚ time_total_s                        32.6492 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               1.91429 â”‚
â”‚ eval_AP                             0.96648 â”‚
â”‚ eval_MCC                            0.61862 â”‚
â”‚ eval_NDCG                           0.99317 â”‚
â”‚ eval_accuracy                       0.80597 â”‚
â”‚ eval_f1                             0.85393 â”‚
â”‚ eval_kappa                           0.5778 â”‚
â”‚ eval_loss                           0.00341 â”‚
â”‚ eval_optim_threshold                0.48016 â”‚
â”‚ eval_precision                      0.97436 â”‚
â”‚ eval_recall                            0.76 â”‚
â”‚ eval_runtime                         3.3287 â”‚
â”‚ eval_samples_per_second              20.128 â”‚
â”‚ eval_steps_per_second                 1.202 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 12:11:45,828 - INFO - Cleaning up trial a8cd2637
2025-06-06 12:11:45,828 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_12-10-52/train_hpo_a8cd2637_3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512_2025-06-06_12-11-06

Trial train_hpo_a8cd2637 completed after 1 iterations at 2025-06-06 12:11:45. Total running time: 52s

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 12:11:53. Total running time: 1min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_a63b9833   RUNNING      0.625202   2.69927       1.88223e-05         0.13641                     4                                                                                         â”‚
â”‚ train_hpo_41b462e5   RUNNING      0.970578   4.6341        5.16112e-05         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_a8cd2637   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            32.6492    0.00341004    0.853933            0.76           0.80597 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3627926)[0m {'loss': 0.0165, 'grad_norm': 0.5338476896286011, 'learning_rate': 9.411155745721064e-06, 'epoch': 1.9142857142857141}
[36m(train_hpo pid=3628157)[0m {'loss': 0.0013, 'grad_norm': 0.027638716623187065, 'learning_rate': 3.096673239374204e-05, 'epoch': 1.9142857142857141}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 12:12:23. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_a63b9833   RUNNING      0.625202   2.69927       1.88223e-05         0.13641                     4                                                                                         â”‚
â”‚ train_hpo_41b462e5   RUNNING      0.970578   4.6341        5.16112e-05         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_a8cd2637   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            32.6492    0.00341004    0.853933            0.76           0.80597 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3627926)[0m {'loss': 0.01, 'grad_norm': 0.4996938407421112, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3628157)[0m {'loss': 0.0003, 'grad_norm': 0.007399670779705048, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3627926)[0m {'loss': 0.0079, 'grad_norm': 0.47900065779685974, 'learning_rate': 0.0, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3627926)[0m {'train_runtime': 108.8202, 'train_samples_per_second': 25.62, 'train_steps_per_second': 0.294, 'train_loss': 0.019319141283631325, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3627926)[0m STATE at ending of training  :  TrainerState(epoch=3.914285714285714, global_step=32, max_steps=32, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=687556458741360.0, log_history=[{'loss': 0.0429, 'grad_norm': 1.1656372547149658, 'learning_rate': 1.4116733618581595e-05, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.0165, 'grad_norm': 0.5338476896286011, 'learning_rate': 9.411155745721064e-06, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 0.01, 'grad_norm': 0.4996938407421112, 'learning_rate': 4.705577872860532e-06, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 0.0079, 'grad_norm': 0.47900065779685974, 'learning_rate': 0.0, 'epoch': 3.914285714285714, 'step': 32}, {'train_runtime': 108.8202, 'train_samples_per_second': 25.62, 'train_steps_per_second': 0.294, 'total_flos': 687556458741360.0, 'train_loss': 0.019319141283631325, 'epoch': 3.914285714285714, 'step': 32}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 12:12:53. Total running time: 2min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_a63b9833   RUNNING      0.625202   2.69927       1.88223e-05         0.13641                     4                                                                                         â”‚
â”‚ train_hpo_41b462e5   RUNNING      0.970578   4.6341        5.16112e-05         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_a8cd2637   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            32.6492    0.00341004    0.853933            0.76           0.80597 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3627926)[0m 2025-06-06 12:12:56,569 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3627926)[0m 2025-06-06 12:12:56,575 - INFO - eval_result: {'eval_loss': 0.008231601677834988, 'eval_f1': 0.9795918367346939, 'eval_recall': 0.96, 'eval_accuracy': 0.9701492537313433, 'eval_precision': 1.0, 'eval_optim_threshold': 0.46299493312835693, 'eval_AP': 1.0, 'eval_MCC': 0.9267941348654796, 'eval_NDCG': 1.0, 'eval_kappa': 0.9241223103057757, 'eval_runtime': 4.0268, 'eval_samples_per_second': 16.638, 'eval_steps_per_second': 0.993, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3627926)[0m {'eval_loss': 0.008231601677834988, 'eval_f1': 0.9795918367346939, 'eval_recall': 0.96, 'eval_accuracy': 0.9701492537313433, 'eval_precision': 1.0, 'eval_optim_threshold': 0.46299493312835693, 'eval_AP': 1.0, 'eval_MCC': 0.9267941348654796, 'eval_NDCG': 1.0, 'eval_kappa': 0.9241223103057757, 'eval_runtime': 4.0268, 'eval_samples_per_second': 16.638, 'eval_steps_per_second': 0.993, 'epoch': 3.914285714285714}

Trial train_hpo_a63b9833 finished iteration 1 at 2025-06-06 12:12:56. Total running time: 2min 3s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_a63b9833 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    116.961 â”‚
â”‚ time_total_s                        116.961 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               3.91429 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                            0.92679 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                       0.97015 â”‚
â”‚ eval_f1                             0.97959 â”‚
â”‚ eval_kappa                          0.92412 â”‚
â”‚ eval_loss                           0.00823 â”‚
â”‚ eval_optim_threshold                0.46299 â”‚
â”‚ eval_precision                            1 â”‚
â”‚ eval_recall                            0.96 â”‚
â”‚ eval_runtime                         4.0268 â”‚
â”‚ eval_samples_per_second              16.638 â”‚
â”‚ eval_steps_per_second                 0.993 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 12:12:56,677 - INFO - Cleaning up trial a63b9833
2025-06-06 12:12:56,677 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_12-10-52/train_hpo_a63b9833_1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364_2025-06-06_12-10-52
2025-06-06 12:12:56,677 - INFO - Cleaning up trial a8cd2637
2025-06-06 12:12:56,677 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_12-10-52/train_hpo_a8cd2637_3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512_2025-06-06_12-11-06

Trial train_hpo_a63b9833 completed after 1 iterations at 2025-06-06 12:12:56. Total running time: 2min 3s
[36m(train_hpo pid=3627926)[0m 2025-06-06 12:12:56,615 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3628157)[0m {'loss': 0.0001, 'grad_norm': 0.0019432349363341928, 'learning_rate': 1.0322244131247348e-05, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3628157)[0m {'loss': 0.0001, 'grad_norm': 0.0014477143995463848, 'learning_rate': 0.0, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3628157)[0m {'train_runtime': 122.3083, 'train_samples_per_second': 28.494, 'train_steps_per_second': 0.327, 'train_loss': 0.0022664499621896537, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3628157)[0m STATE at ending of training  :  TrainerState(epoch=4.914285714285715, global_step=40, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=861208196116080.0, log_history=[{'loss': 0.0096, 'grad_norm': 0.03810420259833336, 'learning_rate': 4.128897652498939e-05, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.0013, 'grad_norm': 0.027638716623187065, 'learning_rate': 3.096673239374204e-05, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 0.0003, 'grad_norm': 0.007399670779705048, 'learning_rate': 2.0644488262494696e-05, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 0.0001, 'grad_norm': 0.0019432349363341928, 'learning_rate': 1.0322244131247348e-05, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 0.0001, 'grad_norm': 0.0014477143995463848, 'learning_rate': 0.0, 'epoch': 4.914285714285715, 'step': 40}, {'train_runtime': 122.3083, 'train_samples_per_second': 28.494, 'train_steps_per_second': 0.327, 'total_flos': 861208196116080.0, 'train_loss': 0.0022664499621896537, 'epoch': 4.914285714285715, 'step': 40}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3628157)[0m 2025-06-06 12:13:16,064 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3628157)[0m 2025-06-06 12:13:16,071 - INFO - eval_result: {'eval_loss': 0.0011716143926605582, 'eval_f1': 0.98989898989899, 'eval_recall': 0.98, 'eval_accuracy': 0.9850746268656716, 'eval_precision': 1.0, 'eval_optim_threshold': 0.40745267271995544, 'eval_AP': 1.0, 'eval_MCC': 0.9620579793107875, 'eval_NDCG': 1.0, 'eval_kappa': 0.96133871898442, 'eval_runtime': 3.2799, 'eval_samples_per_second': 20.427, 'eval_steps_per_second': 1.22, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3628157)[0m {'eval_loss': 0.0011716143926605582, 'eval_f1': 0.98989898989899, 'eval_recall': 0.98, 'eval_accuracy': 0.9850746268656716, 'eval_precision': 1.0, 'eval_optim_threshold': 0.40745267271995544, 'eval_AP': 1.0, 'eval_MCC': 0.9620579793107875, 'eval_NDCG': 1.0, 'eval_kappa': 0.96133871898442, 'eval_runtime': 3.2799, 'eval_samples_per_second': 20.427, 'eval_steps_per_second': 1.22, 'epoch': 4.914285714285715}

Trial train_hpo_41b462e5 finished iteration 1 at 2025-06-06 12:13:16. Total running time: 2min 23s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_41b462e5 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    129.741 â”‚
â”‚ time_total_s                        129.741 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               4.91429 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                            0.96206 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                       0.98507 â”‚
â”‚ eval_f1                              0.9899 â”‚
â”‚ eval_kappa                          0.96134 â”‚
â”‚ eval_loss                           0.00117 â”‚
â”‚ eval_optim_threshold                0.40745 â”‚
â”‚ eval_precision                            1 â”‚
â”‚ eval_recall                            0.98 â”‚
â”‚ eval_runtime                         3.2799 â”‚
â”‚ eval_samples_per_second              20.427 â”‚
â”‚ eval_steps_per_second                  1.22 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 12:13:16,142 - INFO - Cleaning up trial 41b462e5
2025-06-06 12:13:16,142 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_12-10-52/train_hpo_41b462e5_2_alpha=0.9706,gamma=4.6341,learning_rate=0.0001,num_train_epochs=5,weight_decay=0.1230_2025-06-06_12-10-59
2025-06-06 12:13:16,142 - INFO - Cleaning up trial a63b9833
2025-06-06 12:13:16,142 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_12-10-52/train_hpo_a63b9833_1_alpha=0.6252,gamma=2.6993,learning_rate=0.0000,num_train_epochs=4,weight_decay=0.1364_2025-06-06_12-10-52
2025-06-06 12:13:16,142 - INFO - Cleaning up trial a8cd2637
2025-06-06 12:13:16,143 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_12-10-52/train_hpo_a8cd2637_3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512_2025-06-06_12-11-06

Trial train_hpo_41b462e5 completed after 1 iterations at 2025-06-06 12:13:16. Total running time: 2min 23s
2025-06-06 12:13:16,150	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_12-10-52' in 0.0055s.

Trial status: 3 TERMINATED
Current time: 2025-06-06 12:13:16. Total running time: 2min 23s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_a63b9833   TERMINATED   0.625202   2.69927       1.88223e-05         0.13641                     4        1           116.961     0.0082316     0.979592            0.96          0.970149 â”‚
â”‚ train_hpo_41b462e5   TERMINATED   0.970578   4.6341        5.16112e-05         0.123031                    5        1           129.741     0.00117161    0.989899            0.98          0.985075 â”‚
â”‚ train_hpo_a8cd2637   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            32.6492    0.00341004    0.853933            0.76          0.80597  â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

2025-06-06 12:13:16,157 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x700d4c2507d0>
2025-06-06 12:13:16,157 - INFO - Best trial : train_hpo_41b462e5
2025-06-06 12:13:16,157 - INFO - Best config : {'alpha': 0.970577641092792, 'gamma': 4.634102840173219, 'learning_rate': 5.1611220656236736e-05, 'weight_decay': 0.12303118765599412, 'num_train_epochs': 5}
2025-06-06 12:13:16,157 - INFO - Best trial after optimization: {'eval_loss': 0.0011716143926605582, 'eval_f1': 0.98989898989899, 'eval_recall': 0.98, 'eval_accuracy': 0.9850746268656716, 'eval_precision': 1.0, 'eval_optim_threshold': 0.40745267271995544, 'eval_AP': 1.0, 'eval_MCC': 0.9620579793107875, 'eval_NDCG': 1.0, 'eval_kappa': 0.96133871898442, 'eval_runtime': 3.2799, 'eval_samples_per_second': 20.427, 'eval_steps_per_second': 1.22, 'epoch': 4.914285714285715, 'timestamp': 1749204796, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '41b462e5', 'date': '2025-06-06_12-13-16', 'time_this_iter_s': 129.74053382873535, 'time_total_s': 129.74053382873535, 'pid': 3628157, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'alpha': 0.970577641092792, 'gamma': 4.634102840173219, 'learning_rate': 5.1611220656236736e-05, 'weight_decay': 0.12303118765599412, 'num_train_epochs': 5}, 'time_since_restore': 129.74053382873535, 'iterations_since_restore': 1, 'experiment_tag': '2_alpha=0.9706,gamma=4.6341,learning_rate=0.0001,num_train_epochs=5,weight_decay=0.1230'}
2025-06-06 12:13:16,178 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   0.008232  0.979592  ...                        4  a63b9833
1   0.001172  0.989899  ...                        5  41b462e5
2   0.003410  0.853933  ...                        2  a8cd2637

[3 rows x 33 columns]
[36m(train_hpo pid=3628157)[0m 2025-06-06 12:13:16,114 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
2025-06-06 12:13:16,352 - INFO - Trial comparison plot saved
2025-06-06 12:13:16,352 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-06 12:13:16,598 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.25 and gamma=2.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-06 12:13:16,710 - INFO - training size : 697
2025-06-06 12:13:16,710 - INFO - dev size : 67
2025-06-06 12:13:16,710 - INFO - test size : 132
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
  0%|          | 0/150 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  1%|          | 1/150 [00:00<01:36,  1.55it/s]  1%|â–         | 2/150 [00:01<01:32,  1.59it/s]  2%|â–         | 3/150 [00:01<01:31,  1.61it/s]  3%|â–Ž         | 4/150 [00:02<01:30,  1.61it/s]  3%|â–Ž         | 5/150 [00:03<01:29,  1.62it/s]  4%|â–         | 6/150 [00:03<01:29,  1.62it/s]  5%|â–         | 7/150 [00:04<01:28,  1.62it/s]  5%|â–Œ         | 8/150 [00:04<01:27,  1.62it/s]  6%|â–Œ         | 9/150 [00:05<01:26,  1.62it/s]  7%|â–‹         | 10/150 [00:06<01:26,  1.62it/s]  7%|â–‹         | 11/150 [00:06<01:25,  1.62it/s]  8%|â–Š         | 12/150 [00:07<01:25,  1.62it/s]  9%|â–Š         | 13/150 [00:08<01:24,  1.62it/s]  9%|â–‰         | 14/150 [00:08<01:23,  1.62it/s] 10%|â–ˆ         | 15/150 [00:09<01:23,  1.62it/s] 11%|â–ˆ         | 16/150 [00:09<01:22,  1.62it/s] 11%|â–ˆâ–        | 17/150 [00:10<01:21,  1.62it/s] 12%|â–ˆâ–        | 18/150 [00:11<01:21,  1.62it/s] 13%|â–ˆâ–Ž        | 19/150 [00:11<01:20,  1.62it/s] 13%|â–ˆâ–Ž        | 20/150 [00:12<01:20,  1.62it/s] 14%|â–ˆâ–        | 21/150 [00:12<01:19,  1.63it/s] 15%|â–ˆâ–        | 22/150 [00:13<01:18,  1.63it/s] 15%|â–ˆâ–Œ        | 23/150 [00:14<01:18,  1.63it/s] 16%|â–ˆâ–Œ        | 24/150 [00:14<01:17,  1.63it/s] 17%|â–ˆâ–‹        | 25/150 [00:15<01:16,  1.64it/s] 17%|â–ˆâ–‹        | 26/150 [00:16<01:16,  1.63it/s] 18%|â–ˆâ–Š        | 27/150 [00:16<01:15,  1.63it/s] 19%|â–ˆâ–Š        | 28/150 [00:17<01:15,  1.62it/s] 19%|â–ˆâ–‰        | 29/150 [00:17<01:13,  1.64it/s]                                                {'loss': 0.0006, 'grad_norm': 4.077146513736807e-05, 'learning_rate': 4.128897652498939e-05, 'epoch': 1.0}
 20%|â–ˆâ–ˆ        | 30/150 [00:17<01:13,  1.64it/s] 21%|â–ˆâ–ˆ        | 31/150 [00:18<00:58,  2.04it/s] 21%|â–ˆâ–ˆâ–       | 32/150 [00:19<01:01,  1.92it/s] 22%|â–ˆâ–ˆâ–       | 33/150 [00:19<01:03,  1.83it/s] 23%|â–ˆâ–ˆâ–Ž       | 34/150 [00:20<01:05,  1.77it/s] 23%|â–ˆâ–ˆâ–Ž       | 35/150 [00:21<01:06,  1.73it/s] 24%|â–ˆâ–ˆâ–       | 36/150 [00:21<01:07,  1.70it/s] 25%|â–ˆâ–ˆâ–       | 37/150 [00:22<01:07,  1.67it/s] 25%|â–ˆâ–ˆâ–Œ       | 38/150 [00:22<01:07,  1.66it/s] 26%|â–ˆâ–ˆâ–Œ       | 39/150 [00:23<01:06,  1.68it/s] 27%|â–ˆâ–ˆâ–‹       | 40/150 [00:24<01:06,  1.66it/s] 27%|â–ˆâ–ˆâ–‹       | 41/150 [00:24<01:06,  1.65it/s] 28%|â–ˆâ–ˆâ–Š       | 42/150 [00:25<01:05,  1.65it/s] 29%|â–ˆâ–ˆâ–Š       | 43/150 [00:25<01:05,  1.64it/s] 29%|â–ˆâ–ˆâ–‰       | 44/150 [00:26<01:04,  1.63it/s] 30%|â–ˆâ–ˆâ–ˆ       | 45/150 [00:27<01:04,  1.63it/s] 31%|â–ˆâ–ˆâ–ˆ       | 46/150 [00:27<01:03,  1.63it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 47/150 [00:28<01:03,  1.63it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 48/150 [00:28<01:02,  1.63it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 49/150 [00:29<01:02,  1.63it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 50/150 [00:30<01:01,  1.63it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 51/150 [00:30<01:00,  1.63it/s] 35%|â–ˆâ–ˆâ–ˆâ–      | 52/150 [00:31<01:00,  1.63it/s] 35%|â–ˆâ–ˆâ–ˆâ–Œ      | 53/150 [00:32<00:59,  1.62it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 54/150 [00:32<00:59,  1.62it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 55/150 [00:33<00:58,  1.62it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 56/150 [00:33<00:57,  1.63it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 57/150 [00:34<00:57,  1.63it/s] 39%|â–ˆâ–ˆâ–ˆâ–Š      | 58/150 [00:35<00:56,  1.63it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 59/150 [00:35<00:55,  1.64it/s]                                                {'loss': 0.0, 'grad_norm': 3.007767372764647e-05, 'learning_rate': 3.096673239374204e-05, 'epoch': 2.0}
 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 60/150 [00:35<00:54,  1.64it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 61/150 [00:36<00:43,  2.06it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 62/150 [00:37<00:45,  1.93it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 63/150 [00:37<00:47,  1.84it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 64/150 [00:38<00:48,  1.78it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 65/150 [00:38<00:49,  1.73it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 66/150 [00:39<00:49,  1.70it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 67/150 [00:40<00:49,  1.68it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 68/150 [00:40<00:49,  1.67it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 69/150 [00:41<00:48,  1.66it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 70/150 [00:41<00:47,  1.67it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 71/150 [00:42<00:47,  1.66it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 72/150 [00:43<00:47,  1.65it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 73/150 [00:43<00:46,  1.64it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 74/150 [00:44<00:46,  1.64it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 75/150 [00:44<00:45,  1.63it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 76/150 [00:45<00:45,  1.63it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 77/150 [00:46<00:44,  1.63it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 78/150 [00:46<00:44,  1.63it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 79/150 [00:47<00:43,  1.63it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 80/150 [00:48<00:43,  1.63it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 81/150 [00:48<00:42,  1.64it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 82/150 [00:49<00:41,  1.63it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 83/150 [00:49<00:41,  1.62it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 84/150 [00:50<00:40,  1.62it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 85/150 [00:51<00:40,  1.62it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 86/150 [00:51<00:39,  1.62it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 87/150 [00:52<00:38,  1.62it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 88/150 [00:52<00:38,  1.62it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 89/150 [00:53<00:37,  1.64it/s]                                                {'loss': 0.0, 'grad_norm': 6.737586318195099e-06, 'learning_rate': 2.0644488262494696e-05, 'epoch': 3.0}
 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 90/150 [00:53<00:36,  1.64it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 91/150 [00:54<00:28,  2.06it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 92/150 [00:54<00:30,  1.93it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 93/150 [00:55<00:30,  1.84it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 94/150 [00:56<00:31,  1.78it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 95/150 [00:56<00:31,  1.73it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 96/150 [00:57<00:31,  1.70it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 97/150 [00:57<00:31,  1.68it/s] 65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 98/150 [00:58<00:31,  1.66it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 99/150 [00:59<00:30,  1.65it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 100/150 [00:59<00:30,  1.65it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 101/150 [01:00<00:29,  1.64it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 102/150 [01:01<00:29,  1.64it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 103/150 [01:01<00:28,  1.63it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 104/150 [01:02<00:28,  1.63it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 105/150 [01:02<00:27,  1.63it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 106/150 [01:03<00:27,  1.63it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 107/150 [01:04<00:26,  1.63it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 108/150 [01:04<00:25,  1.63it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 109/150 [01:05<00:25,  1.63it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 110/150 [01:05<00:24,  1.63it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 111/150 [01:06<00:23,  1.63it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 112/150 [01:07<00:23,  1.63it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 113/150 [01:07<00:22,  1.63it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 114/150 [01:08<00:22,  1.63it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 115/150 [01:09<00:21,  1.63it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 116/150 [01:09<00:20,  1.63it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 117/150 [01:10<00:20,  1.63it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 118/150 [01:10<00:19,  1.63it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 119/150 [01:11<00:18,  1.64it/s]                                                 {'loss': 0.0, 'grad_norm': 3.0518385756295174e-05, 'learning_rate': 1.0322244131247348e-05, 'epoch': 4.0}
 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 120/150 [01:11<00:18,  1.64it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 121/150 [01:12<00:14,  2.07it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 122/150 [01:12<00:14,  1.94it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 123/150 [01:13<00:14,  1.85it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 124/150 [01:13<00:14,  1.78it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 125/150 [01:14<00:14,  1.74it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 126/150 [01:15<00:14,  1.70it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 127/150 [01:15<00:13,  1.68it/s] 85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 128/150 [01:16<00:13,  1.67it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 129/150 [01:17<00:12,  1.65it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 130/150 [01:17<00:12,  1.65it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 131/150 [01:18<00:11,  1.64it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 132/150 [01:18<00:10,  1.64it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 133/150 [01:19<00:10,  1.63it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 134/150 [01:20<00:09,  1.63it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 135/150 [01:20<00:09,  1.63it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 136/150 [01:21<00:08,  1.63it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 137/150 [01:21<00:07,  1.63it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 138/150 [01:22<00:07,  1.63it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 139/150 [01:23<00:06,  1.63it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 140/150 [01:23<00:06,  1.63it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 141/150 [01:24<00:05,  1.63it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 142/150 [01:25<00:04,  1.63it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 143/150 [01:25<00:04,  1.63it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 144/150 [01:26<00:03,  1.63it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 145/150 [01:26<00:03,  1.63it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 146/150 [01:27<00:02,  1.63it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 147/150 [01:28<00:01,  1.63it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 148/150 [01:28<00:01,  1.63it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 149/150 [01:29<00:00,  1.64it/s]                                                 {'loss': 0.0, 'grad_norm': 5.37969663128024e-06, 'learning_rate': 0.0, 'epoch': 5.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150/150 [01:31<00:00,  1.64it/s]                                                 {'train_runtime': 91.7989, 'train_samples_per_second': 37.963, 'train_steps_per_second': 1.634, 'train_loss': 0.00012518561354378713, 'epoch': 5.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150/150 [01:31<00:00,  1.64it/s]2025-06-06 12:14:48,957 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 150/150 [01:31<00:00,  1.63it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.21it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.38it/s]2025-06-06 12:14:52,996 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.25s/it]
2025-06-06 12:14:53,001 - INFO - Training time : 96.64919019420631
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.12it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.03it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.36it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.10it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.31it/s]2025-06-06 12:14:57,465 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.44it/s]
2025-06-06 12:14:57,470 - INFO - Evaluation time : 4.46864192886278
2025-06-06 12:14:57,470 - INFO - Evaluation results on test set: {'eval_loss': 9.785809851337035e-08, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9372265934944153, 'eval_AP': 0.9999999999999999, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000004, 'eval_kappa': 1.0, 'eval_runtime': 4.4638, 'eval_samples_per_second': 29.571, 'eval_steps_per_second': 1.344, 'epoch': 5.0}
2025-06-06 12:14:57,470 - INFO - Total updates (optimizer steps): 150
2025-06-06 12:14:57,470 - INFO - Avg time / step: 0.612s
2025-06-06 12:14:58,245 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_focalgoogle-bert/bert-base-uncased3trials_fold-3
2025-06-06 12:14:58,245 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.11it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.03it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:01<00:00,  3.04it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  3.25it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  3.65it/s]2025-06-06 12:15:02,933 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.37it/s]
2025-06-06 12:15:02,938 - INFO - preds : [1 0 1 0 1 0 1 1 1 1 1 0 1 1 0 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 0 0 1 0 1
 1 1 1 1 1 0 1 1 0 0 1 1 0 1 1 1 1 1 1 1 1 0 1 0 1 1 0 1 1 1 1 1 1 1 1 1 1
 1 0 0 1 0 1 1 1 1 1 0 1 1 1 0 1 0 0 1 1 1 1 0 1 1 1 1 0 0 1 1 0 1 0 0 1 0
 1 1 1 1 1 1 1 1 0 1 1 1 1 0 0 1 0 1 0 1 1]
2025-06-06 12:15:02,939 - INFO - test_split["labels"] : [1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1]
2025-06-06 12:15:02,940 - INFO - Confusion matrix: TN=35, FP=0, FN=0, TP=97
2025-06-06 12:15:05,881 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 0.9999999999999999, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 35, 'FP': 0, 'FN': 0, 'TP': 97}
2025-06-06 12:15:05,999 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-06 12:15:06,096 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 12:15:06,096 - INFO - 
On test Set (optimal threshold of 0.44545456767082214 according to cross validation on the training set): 
2025-06-06 12:15:06,098 - INFO - Confusion matrix: TN=35, FP=0, FN=0, TP=97
2025-06-06 12:15:08,866 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 0.9999999999999999, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 35, 'FP': 0, 'FN': 0, 'TP': 97}
2025-06-06 12:15:08,964 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 12:15:08,964 - INFO - Results for fold 3 : [{'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 0.9999999999999999, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 35, 'FP': 0, 'FN': 0, 'TP': 97}]
2025-06-06 12:15:09,083 - INFO - Cleared CUDA cache. Memory allocated: 1.43 GB, Memory reserved: 1.76 GB
2025-06-06 12:15:09,083 - INFO - Cleared CUDA cache. Memory allocated: 1.43 GB, Memory reserved: 1.76 GB
2025-06-06 12:15:09,124 - INFO - Cleared CUDA cache. Memory allocated: 0.03 GB, Memory reserved: 0.05 GB
2025-06-06 12:15:09,137 - INFO - Metrics for google-bert/bert-base-uncased:                       model_name fold loss_type run  ...    TN   FP   FN    TP
0  google-bert/bert-base-uncased    1     focal   1  ...  33.0  2.0  0.0  98.0
0  google-bert/bert-base-uncased    2     focal   1  ...  34.0  0.0  1.0  97.0
0  google-bert/bert-base-uncased    3     focal   1  ...  35.0  0.0  0.0  97.0

[3 rows x 18 columns]
2025-06-06 12:15:09,137 - INFO - 
fold number 1 / 3
2025-06-06 12:15:09,142 - INFO - Confusion matrix: TN=33, FP=2, FN=0, TP=98
2025-06-06 12:15:11,813 - INFO - Metrics: {'f1': 0.98989898989899, 'recall': 1.0, 'precision': 0.98, 'accuracy': 0.9849624060150376, 'AP': 1.0, 'MCC': 0.9612491872558332, 'NDCG': 1.0000000000000004, 'kappa': 0.9604989604989604, 'TN': 33, 'FP': 2, 'FN': 0, 'TP': 98}
2025-06-06 12:15:11,814 - INFO - 
fold number 2 / 3
2025-06-06 12:15:11,818 - INFO - Confusion matrix: TN=34, FP=0, FN=0, TP=98
2025-06-06 12:15:14,638 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 34, 'FP': 0, 'FN': 0, 'TP': 98}
2025-06-06 12:15:14,639 - INFO - 
fold number 3 / 3
2025-06-06 12:15:14,643 - INFO - Confusion matrix: TN=35, FP=0, FN=0, TP=97
2025-06-06 12:15:17,456 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 0.9999999999999999, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 35, 'FP': 0, 'FN': 0, 'TP': 97}
2025-06-06 12:15:17,463 - INFO - fold indexes for run no.2: [[284, 266, 388, 393, 133, 13, 20, 176, 269, 308, 45, 193, 147, 19, 168, 230, 151, 384, 157, 153, 149, 327, 321, 381, 385, 330, 199, 72, 142, 10, 47, 270, 377, 73, 0, 118, 184, 65, 343, 219, 86, 357, 201, 226, 264, 223, 33, 114, 67, 268, 182, 310, 53, 246, 145, 76, 320, 373, 280, 95, 254, 113, 154, 160, 228, 306, 325, 99, 355, 356, 125, 166, 346, 286, 102, 354, 92, 336, 81, 159, 52, 304, 323, 111, 96, 274, 236, 41, 91, 32, 90, 367, 179, 130, 74, 334, 378, 208, 77, 396, 361, 6, 332, 238, 222, 277, 365, 36, 256, 21, 260, 38, 234, 341, 173, 124, 183, 31, 202, 203, 196, 119, 150, 263, 105, 126, 48, 143, 289, 231, 324, 352, 186, 155, 292, 217, 198, 316, 109, 287, 44, 49, 82, 15, 309, 83, 135, 218, 305, 283, 122, 127, 290, 35, 85, 98, 271, 141, 167, 295, 93, 27, 262, 229, 273, 9, 370, 89, 129, 197, 164, 205, 347, 171, 178, 70, 140, 372, 100, 314, 69, 4, 301, 265, 244, 101, 248, 358, 364, 94, 296, 87, 307, 239, 192, 50, 169, 39, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 532, 533, 534, 535, 536, 537, 538, 539, 540, 541, 542, 543, 544, 545, 546, 547, 548, 549, 550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 560, 561, 562, 563, 564, 565, 566, 567, 568, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582, 583, 584, 585, 586, 587, 588, 589, 590, 591, 592, 593, 594, 595, 596, 597, 598, 599, 600, 601, 602, 603, 604, 605, 606, 607, 608, 609, 610, 611, 612, 613, 614, 615, 616, 617, 618, 619, 620, 621, 622, 623, 624, 625, 626, 627, 628, 629, 630, 631, 632, 633, 634, 635, 636, 637, 638, 639, 640, 641, 642, 643, 644, 645, 646, 647, 648, 649, 650, 651, 652, 653, 654, 655, 656, 657, 658, 659, 660, 661, 662, 663, 664, 665, 666, 667, 668, 669, 670, 671, 672, 673, 674, 675, 676, 677, 678, 679, 680, 681, 682, 683, 684, 685, 686, 687, 688, 689, 690, 691, 692, 693, 694, 695, 696, 697, 698, 699, 700, 701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 714, 715, 716, 717, 718, 719, 720, 721, 722, 723, 724, 725, 726, 727, 728, 729, 730, 731, 732, 733, 734, 735, 736, 737, 738, 739, 740, 741, 742, 743, 744, 745, 746, 747, 748, 749, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764, 765, 766, 767, 768, 769, 770, 771, 772, 773, 774, 775, 776, 777, 778, 779, 780, 781, 782, 783, 784, 785, 786, 787, 788, 789, 790, 791, 792, 793, 794, 795, 796, 797, 798, 799, 800, 801, 802, 803, 804, 805, 806, 807, 808, 809, 810, 811, 812, 813, 814, 815, 816, 817, 818, 819, 820, 821, 822, 823, 824, 825, 826, 827, 828, 829, 830, 831, 832, 833, 834, 835, 836, 837, 838, 839, 840, 841, 842, 843, 844, 845, 846, 847, 848, 849, 850, 851, 852, 853, 854, 855, 856, 857, 858, 859, 860, 861, 862, 863, 864, 865, 866, 867, 868, 869, 870, 871, 872, 873, 874, 875, 876, 877, 878, 879, 880, 881, 882, 883, 884, 885, 886, 887, 888, 889, 890, 891, 892, 893, 894, 895], [326, 210, 250, 319, 380, 279, 293, 288, 220, 253, 162, 43, 152, 8, 221, 235, 297, 339, 331, 61, 106, 181, 329, 243, 375, 88, 257, 194, 117, 104, 55, 349, 14, 108, 62, 281, 282, 2, 63, 240, 351, 107, 97, 187, 215, 54, 80, 232, 318, 241, 303, 252, 29, 139, 247, 362, 51, 390, 285, 392, 174, 298, 5, 335, 294, 28], array([  1,   3,   7,  11,  12,  16,  17,  18,  22,  23,  24,  25,  26,
        30,  34,  37,  40,  42,  46,  56,  57,  58,  59,  60,  64,  66,
        68,  71,  75,  78,  79,  84, 103, 110, 112, 115, 116, 120, 121,
       123, 128, 131, 132, 134, 136, 137, 138, 144, 146, 148, 156, 158,
       161, 163, 165, 170, 172, 175, 177, 180, 185, 188, 189, 190, 191,
       195, 200, 204, 206, 207, 209, 211, 212, 213, 214, 216, 224, 225,
       227, 233, 237, 242, 245, 249, 251, 255, 258, 259, 261, 267, 272,
       275, 276, 278, 291, 299, 300, 302, 311, 312, 313, 315, 317, 322,
       328, 333, 337, 338, 340, 342, 344, 345, 348, 350, 353, 359, 360,
       363, 366, 368, 369, 371, 374, 376, 379, 382, 383, 386, 387, 389,
       391, 394, 395])]
2025-06-06 12:15:17,463 - INFO - Run no 2/2
2025-06-06 12:15:17,463 - INFO - Loss Type : focal
2025-06-06 12:15:17,463 - INFO - Ensemble learning pipeline
2025-06-06 12:15:17,463 - INFO - Training model 1/2: dmis-lab/biobert-v1.1
2025-06-06 12:15:17,822 - INFO - 
fold number 1 / 3
2025-06-06 12:15:17,828 - INFO - train split size : 697
2025-06-06 12:15:17,828 - INFO - dev split size : 66
2025-06-06 12:15:17,828 - INFO - test split size : 133
Map (num_proc=32):   0%|          | 0/697 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 22/697 [00:00<00:07, 92.39 examples/s]Map (num_proc=32):  16%|â–ˆâ–Œ        | 110/697 [00:00<00:01, 382.83 examples/s]Map (num_proc=32):  25%|â–ˆâ–ˆâ–Œ       | 176/697 [00:00<00:01, 473.07 examples/s]Map (num_proc=32):  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 286/697 [00:00<00:00, 667.33 examples/s]Map (num_proc=32):  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 396/697 [00:00<00:00, 751.42 examples/s]Map (num_proc=32):  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 484/697 [00:00<00:00, 761.26 examples/s]Map (num_proc=32):  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 592/697 [00:00<00:00, 809.07 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 676/697 [00:01<00:00, 814.63 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 697/697 [00:01<00:00, 606.71 examples/s]
Map (num_proc=32):   0%|          | 0/66 [00:00<?, ? examples/s]Map (num_proc=32):   5%|â–         | 3/66 [00:00<00:03, 15.97 examples/s]Map (num_proc=32):  21%|â–ˆâ–ˆ        | 14/66 [00:00<00:01, 48.03 examples/s]Map (num_proc=32):  39%|â–ˆâ–ˆâ–ˆâ–‰      | 26/66 [00:00<00:00, 69.87 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 34/66 [00:00<00:00, 72.71 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 44/66 [00:00<00:00, 77.16 examples/s]Map (num_proc=32):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 54/66 [00:00<00:00, 80.08 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 64/66 [00:00<00:00, 81.63 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 66/66 [00:01<00:00, 63.73 examples/s]
Map (num_proc=32):   0%|          | 0/133 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/133 [00:00<00:04, 26.72 examples/s]Map (num_proc=32):  19%|â–ˆâ–‰        | 25/133 [00:00<00:01, 99.61 examples/s]Map (num_proc=32):  34%|â–ˆâ–ˆâ–ˆâ–      | 45/133 [00:00<00:00, 128.79 examples/s]Map (num_proc=32):  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 61/133 [00:00<00:00, 135.30 examples/s]Map (num_proc=32):  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 81/133 [00:00<00:00, 146.61 examples/s]Map (num_proc=32):  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 101/133 [00:00<00:00, 157.85 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 121/133 [00:00<00:00, 158.53 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 133/133 [00:01<00:00, 126.18 examples/s]
2025-06-06 12:15:27,181 - INFO - 3 datasets tokenized successfully
2025-06-06 12:15:27,182 - INFO - Starting hyperparameter search for focal loss
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-06_12-15-27   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_12-15-27
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-06_10-55-47_424551_3536632/artifacts/2025-06-06_12-15-27/train_hpo_2025-06-06_12-15-27/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-06 12:15:27. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_98034605   PENDING    0.625202   2.69927       1.88223e-05          0.13641                    4 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_98034605 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_98034605 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                                0.6252 â”‚
â”‚ gamma                               2.69927 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          4 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3633610)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3633610)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3633610)[0m 2025-06-06 12:15:35,663 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.6252016107931255 and gamma=2.6992695521978884
[36m(train_hpo pid=3633610)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3633610)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3633610)[0m [2025-06-06 12:15:35,903] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3633610)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=32, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=4, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3633610)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3633610)[0m   warnings.warn(

Trial train_hpo_13894f99 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_13894f99 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.97058 â”‚
â”‚ gamma                                4.6341 â”‚
â”‚ learning_rate                         5e-05 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3633841)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3633841)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3633841)[0m 2025-06-06 12:15:41,903 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.970577641092792 and gamma=4.634102840173219
[36m(train_hpo pid=3633841)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3633841)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3633841)[0m [2025-06-06 12:15:42,303] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3633841)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3633841)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3633841)[0m   warnings.warn(

Trial train_hpo_fa02a5a5 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_fa02a5a5 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ alpha                               0.78112 â”‚
â”‚ gamma                               6.80707 â”‚
â”‚ learning_rate                         2e-05 â”‚
â”‚ num_train_epochs                          2 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3634056)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3634056)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3634056)[0m 2025-06-06 12:15:48,685 - INFO - Alpha and gamma values before training (in TrainingArguments): -> alpha=0.7811204413478371 and gamma=6.807074484302038
[36m(train_hpo pid=3634056)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3634056)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3634056)[0m [2025-06-06 12:15:48,907] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3634056)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=16, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3634056)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3634056)[0m   warnings.warn(

Trial status: 3 RUNNING
Current time: 2025-06-06 12:15:57. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status        alpha     gamma     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_98034605   RUNNING    0.625202   2.69927       1.88223e-05         0.13641                     4 â”‚
â”‚ train_hpo_13894f99   RUNNING    0.970578   4.6341        5.16112e-05         0.123031                    5 â”‚
â”‚ train_hpo_fa02a5a5   RUNNING    0.78112    6.80707       1.88581e-05         0.251217                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3633610)[0m {'loss': 0.0369, 'grad_norm': 0.25066524744033813, 'learning_rate': 1.4116733618581595e-05, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3633841)[0m {'loss': 0.0023, 'grad_norm': 0.023815380409359932, 'learning_rate': 4.128897652498939e-05, 'epoch': 0.9142857142857143}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3634056)[0m {'train_runtime': 25.2008, 'train_samples_per_second': 55.316, 'train_steps_per_second': 0.635, 'train_loss': 0.0010783053294289857, 'epoch': 1.9142857142857141}
[36m(train_hpo pid=3634056)[0m STATE at ending of training  :  TrainerState(epoch=1.9142857142857141, global_step=16, max_steps=16, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=2, num_input_tokens_seen=0, total_flos=341712415023360.0, log_history=[{'loss': 0.0016, 'grad_norm': 0.03358623757958412, 'learning_rate': 9.429055465477227e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.0005, 'grad_norm': 0.015868140384554863, 'learning_rate': 0.0, 'epoch': 1.9142857142857141, 'step': 16}, {'train_runtime': 25.2008, 'train_samples_per_second': 55.316, 'train_steps_per_second': 0.635, 'total_flos': 341712415023360.0, 'train_loss': 0.0010783053294289857, 'epoch': 1.9142857142857141, 'step': 16}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_fa02a5a5 finished iteration 1 at 2025-06-06 12:16:20. Total running time: 53s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_fa02a5a5 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    32.9738 â”‚
â”‚ time_total_s                        32.9738 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               1.91429 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                                  1 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                             1 â”‚
â”‚ eval_f1                                   1 â”‚
â”‚ eval_kappa                                1 â”‚
â”‚ eval_loss                            0.0005 â”‚
â”‚ eval_optim_threshold                0.56332 â”‚
â”‚ eval_precision                            1 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.3046 â”‚
â”‚ eval_samples_per_second              19.972 â”‚
â”‚ eval_steps_per_second                  1.21 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 12:16:20,682 - INFO - Cleaning up trial fa02a5a5
2025-06-06 12:16:20,682 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_12-15-27/train_hpo_fa02a5a5_3_alpha=0.7811,gamma=6.8071,learning_rate=0.0000,num_train_epochs=2,weight_decay=0.2512_2025-06-06_12-15-41

Trial train_hpo_fa02a5a5 completed after 1 iterations at 2025-06-06 12:16:20. Total running time: 53s
[36m(train_hpo pid=3634056)[0m {'eval_loss': 0.0005047903396189213, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.5633231401443481, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.3046, 'eval_samples_per_second': 19.972, 'eval_steps_per_second': 1.21, 'epoch': 1.9142857142857141}
[36m(train_hpo pid=3634056)[0m {'loss': 0.0005, 'grad_norm': 0.015868140384554863, 'learning_rate': 0.0, 'epoch': 1.9142857142857141}
[36m(train_hpo pid=3634056)[0m 2025-06-06 12:16:20,619 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3634056)[0m 2025-06-06 12:16:20,624 - INFO - eval_result: {'eval_loss': 0.0005047903396189213, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.5633231401443481, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.3046, 'eval_samples_per_second': 19.972, 'eval_steps_per_second': 1.21, 'epoch': 1.9142857142857141}
[36m(train_hpo pid=3634056)[0m 2025-06-06 12:16:20,658 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 12:16:27. Total running time: 1min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status          alpha     gamma     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_98034605   RUNNING      0.625202   2.69927       1.88223e-05         0.13641                     4                                                                                         â”‚
â”‚ train_hpo_13894f99   RUNNING      0.970578   4.6341        5.16112e-05         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_fa02a5a5   TERMINATED   0.78112    6.80707       1.88581e-05         0.251217                    2        1            32.9738    0.00050479           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3633610)[0m {'loss': 0.0159, 'grad_norm': 0.18243257701396942, 'learning_rate': 9.411155745721064e-06, 'epoch': 1.9142857142857141}
[36m(train_hpo pid=3633841)[0m {'loss': 0.0003, 'grad_norm': 0.009103730320930481, 'learning_rate': 3.096673239374204e-05, 'epoch': 1.9142857142857141}
*** SIGTERM received at time=1749205009 on cpu 15 ***
PC: @     0x7017c0498d71  (unknown)  (unknown)
    @     0x7017c0445330  484444096  (unknown)
    @     0x7017c049bc8e        224  pthread_cond_timedwait
    @     0x7016ab01f41f       1184  ray::core::GetRequest::Wait()
    @     0x7016ab0216a7       1424  ray::core::CoreWorkerMemoryStore::GetImpl()
    @     0x7016ab0229e7       1360  ray::core::CoreWorkerMemoryStore::Wait()
    @     0x7016aaf42640       1776  ray::core::CoreWorker::Wait()
    @     0x7016aae3367b        352  __pyx_pw_3ray_7_raylet_10CoreWorker_61wait()
    @     0x7017c0beab77  (unknown)  _PyEval_EvalFrameDefault
[2025-06-06 12:16:49,255 E 3536632 3536632] logging.cc:497: *** SIGTERM received at time=1749205009 on cpu 15 ***
[2025-06-06 12:16:49,256 E 3536632 3536632] logging.cc:497: PC: @     0x7017c0498d71  (unknown)  (unknown)
[2025-06-06 12:16:49,256 E 3536632 3536632] logging.cc:497:     @     0x7017c0445330  484444096  (unknown)
[2025-06-06 12:16:49,256 E 3536632 3536632] logging.cc:497:     @     0x7017c049bc8e        224  pthread_cond_timedwait
[2025-06-06 12:16:49,256 E 3536632 3536632] logging.cc:497:     @     0x7016ab01f41f       1184  ray::core::GetRequest::Wait()
[2025-06-06 12:16:49,256 E 3536632 3536632] logging.cc:497:     @     0x7016ab0216a7       1424  ray::core::CoreWorkerMemoryStore::GetImpl()
[2025-06-06 12:16:49,256 E 3536632 3536632] logging.cc:497:     @     0x7016ab0229e7       1360  ray::core::CoreWorkerMemoryStore::Wait()
[2025-06-06 12:16:49,256 E 3536632 3536632] logging.cc:497:     @     0x7016aaf42640       1776  ray::core::CoreWorker::Wait()
[2025-06-06 12:16:49,256 E 3536632 3536632] logging.cc:497:     @     0x7016aae3367b        352  __pyx_pw_3ray_7_raylet_10CoreWorker_61wait()
[2025-06-06 12:16:49,256 E 3536632 3536632] logging.cc:497:     @     0x7017c0beab77  (unknown)  _PyEval_EvalFrameDefault
2025-06-06 12:46:31,148	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
2025-06-06 12:46:31,823 - INFO - Random seeds set to 42
2025-06-06 12:46:31,931 - INFO - Optional negatives loaded from CSV with 5000 entries.
2025-06-06 12:46:31,931 - INFO - Loading original negatives...
2025-06-06 12:46:31,941 - INFO - Negatives column names: ['Article ID', 'Title', 'Author', 'Publication year', 'Title secondary', 'URL', 'DOI', 'Abstract', 'Criteria for exclusion A', ' Criteria for exclusion B', ' Criteria for exclusion C', 'labels', 'Keywords']
2025-06-06 12:46:31,942 - INFO - Loading original positives...
2025-06-06 12:46:31,960 - INFO - Positives column names: ['Article ID', 'Title', 'Author', 'Secondary authors', 'Keywords', 'title of unpublished reference', 'primary date', 'publication year', 'notes', 'reprint status', 'start page number', 'ending page number', 'periodical full name', 'periodical standard abbreviation', 'periodical in which article was published', 'periodical name - user abbreviation 1', 'periodical name - user abbreviation 2', 'volume number', 'issue number', 'title secondary', 'city of publication', 'publisher', 'user definable 1', 'user definable 5', 'title series', 'Abstract', 'ISSN/ISBN', 'availability', 'Misc. 1', 'Misc. 2', 'address', 'Web/URL', 'link to PDF', 'link to full-text', 'related records', 'images', 'DOI', 'labels']
2025-06-06 12:46:31,966 - INFO - Class balance:
labels
1    326
0    123
Name: count, dtype: int64
2025-06-06 12:46:31,966 - INFO -    Article ID  ...  Criteria for exclusion C
0       12959  ...                       NaN
1       13470  ...                       NaN
2        4686  ...                       NaN
3        2503  ...                       NaN
4        2951  ...                       NaN

[5 rows x 44 columns]
2025-06-06 12:46:31,992 - INFO - Original dataset size: 449
2025-06-06 12:46:31,992 - INFO - Optional negatives size: 5000
2025-06-06 12:46:31,998 - INFO - Optional negatives:                                                title  ... labels
0  Towards evidence-based conservation of subterr...  ...     -1
1                  Marine biodiversity conservation.  ...     -1
2  Climate teleconnections modulate global burned...  ...     -1
3  Integrating carbon sequestration and biodivers...  ...     -1
4  Principle, technique and application of grassl...  ...     -1

[5 rows x 7 columns]
2025-06-06 12:46:32,001 - INFO - Combined dataset size: 949
2025-06-06 12:46:32,006 - INFO -                                                title  ... labels
0  Feral pig (Sus scrofa) disturbance facilitates...  ...      1
1  Effects of woody plant diversity on abovegroun...  ...      1
2  Scaling species richness and endemism of tropi...  ...      1
3  Not as the crow flies: Assessing effective iso...  ...      0
4  Species-group concepts and biogeography of the...  ...      1

[5 rows x 5 columns]
2025-06-06 12:46:32,007 - INFO - title        0
abstract     0
Keywords     8
doi         37
labels       0
dtype: int64
2025-06-06 12:46:32,010 - INFO - Total duplicate abstracts: 0
2025-06-06 12:46:32,011 - INFO - Empty DataFrame
Columns: [abstract, labels, Keywords]
Index: []
2025-06-06 12:46:32,014 - INFO - Abstracts appearing in both classes: 0
2025-06-06 12:46:32,015 - INFO - Empty DataFrame
Columns: [title, labels]
Index: []
2025-06-06 12:46:32,017 - INFO - Total duplicate abstracts: 0
2025-06-06 12:46:32,018 - INFO - Empty DataFrame
Columns: [abstract, labels, Keywords]
Index: []
2025-06-06 12:46:32,027 - INFO - Abstracts appearing in both classes: 0
2025-06-06 12:46:32,027 - INFO - Empty DataFrame
Columns: [abstract, labels]
Index: []
2025-06-06 12:46:32,029 - INFO - Total duplicate abstracts: 18
2025-06-06 12:46:32,034 - INFO -                                               abstract  ...                                           Keywords
147  1. How could identical species appear in widel...  ...                                                   
253  Aims\r\n Developing plant conservation strateg...  ...  AFLP; genetic diversity; Indian Ocean; limited...
206  Aims Developing plant conservation strategies ...  ...  AFLP; Genetic diversity; Indian Ocean; Limited...
217  Coastal lagoons are considered one of the most...  ...                                                   
213  Coastal lagoons are considered one of the most...  ...                                                   
21   Distribution patterns of indigenous non-volant...  ...  Australian islands; Extreme-value function; Is...
300  Distribution patterns of indigenous non-volant...  ...  island mammals; Australian islands; species-ar...
197  Invasive plant species pose serious threats to...  ...                                                   
35   Island bat species are disproportionately at r...  ...  Hawaiian hoary bat; Hawai?i; Population geneti...
157  Island bat species are disproportionately at r...  ...  Bats; Endangered species; Hawai<sup>â€˜</sup>i; ...
126  Islands are hotspots of biodiversity and extin...  ...  Deforestation; Endemicity; Extinction; Island ...
276  Islands are hotspots of biodiversity and extin...  ...  Deforestation; Endemicity; Extinction; Island ...
364  KELLY, A. B. (Department of Environmental Scie...  ...                                                   
329  Summary o 1. How could identical species appea...  ...                                                   
278  The Galapagos Islands are recognized for their...  ...                                                   
149  The GalÃ¡pagos Islands are recognized for their...  ...                                                   
313  Working in the Galapagos Islands and surroundi...  ...                                                   
280  Working in the GalÃ¡pagos Islands and surroundi...  ...                                                   

[18 rows x 3 columns]
2025-06-06 12:46:32,036 - INFO - Abstracts appearing in both classes: 0
2025-06-06 12:46:32,037 - INFO - Empty DataFrame
Columns: [doi, labels]
Index: []
2025-06-06 12:46:32,327 - INFO - Cleaned dataset size: 896
2025-06-06 12:46:32,327 - INFO - Numnber of positives : 293
2025-06-06 12:46:32,328 - INFO - Numnber of negatives : 603
2025-06-06 12:46:32,328 - INFO - clean_og_df size : 397
2025-06-06 12:46:32,328 - INFO - opt_neg_df size : 499
2025-06-06 12:46:32,333 - INFO - Fold 1:
2025-06-06 12:46:32,334 - INFO -   Train label distribution: {-1: 0.7159253945480631, 1: 0.20946915351506457, 0: 0.0746054519368723}
2025-06-06 12:46:32,334 - INFO -   Test label distribution: {1: 0.7368421052631579, 0: 0.2631578947368421}
2025-06-06 12:46:32,337 - INFO - Fold 2:
2025-06-06 12:46:32,337 - INFO -   Train label distribution: {-1: 0.7159253945480631, 1: 0.20946915351506457, 0: 0.0746054519368723}
2025-06-06 12:46:32,337 - INFO -   Test label distribution: {1: 0.7424242424242424, 0: 0.25757575757575757}
2025-06-06 12:46:32,340 - INFO - Fold 3:
2025-06-06 12:46:32,340 - INFO -   Train label distribution: {-1: 0.7159253945480631, 1: 0.20946915351506457, 0: 0.0746054519368723}
2025-06-06 12:46:32,340 - INFO -   Test label distribution: {1: 0.7348484848484849, 0: 0.26515151515151514}
2025-06-06 12:46:32,344 - INFO - Fold 1:
2025-06-06 12:46:32,344 - INFO -   Train label distribution: {-1: 0.7159253945480631, 1: 0.20946915351506457, 0: 0.0746054519368723}
2025-06-06 12:46:32,344 - INFO -   Test label distribution: {1: 0.7368421052631579, 0: 0.2631578947368421}
2025-06-06 12:46:32,347 - INFO - Fold 2:
2025-06-06 12:46:32,347 - INFO -   Train label distribution: {-1: 0.7159253945480631, 1: 0.20946915351506457, 0: 0.0746054519368723}
2025-06-06 12:46:32,347 - INFO -   Test label distribution: {1: 0.7424242424242424, 0: 0.25757575757575757}
2025-06-06 12:46:32,350 - INFO - Fold 3:
2025-06-06 12:46:32,350 - INFO -   Train label distribution: {-1: 0.7159253945480631, 1: 0.20946915351506457, 0: 0.0746054519368723}
2025-06-06 12:46:32,350 - INFO -   Test label distribution: {1: 0.7348484848484849, 0: 0.26515151515151514}
Stringifying the column:   0%|          | 0/896 [00:00<?, ? examples/s]Stringifying the column: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 896/896 [00:00<00:00, 112158.55 examples/s]
Casting to class labels:   0%|          | 0/896 [00:00<?, ? examples/s]Casting to class labels: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 896/896 [00:00<00:00, 133261.10 examples/s]
2025-06-06 12:46:32,393 - INFO - Number of positives : 293
2025-06-06 12:46:32,394 - INFO - Number of negatives : 603
2025-06-06 12:46:32,399 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-06 12:46:35,378 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': 0.7368421052631579, 'MCC': 0.0, 'NDCG': 0.9189307109272616, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-06 12:46:35,380 - INFO - Confusion matrix: TN=35, FP=0, FN=98, TP=0
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-06-06 12:46:38,897 - INFO - Metrics: {'f1': 0.0, 'recall': 0.0, 'precision': 0.0, 'accuracy': 0.2631578947368421, 'AP': 0.7368421052631579, 'MCC': 0.0, 'NDCG': 0.9189307109272616, 'kappa': 0.0, 'TN': 35, 'FP': 0, 'FN': 98, 'TP': 0}
2025-06-06 12:46:38,901 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-06 12:46:41,883 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': 0.7424242424242424, 'MCC': 0.0, 'NDCG': 0.9208012714375936, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-06 12:46:41,885 - INFO - Confusion matrix: TN=34, FP=0, FN=98, TP=0
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-06-06 12:46:44,618 - INFO - Metrics: {'f1': 0.0, 'recall': 0.0, 'precision': 0.0, 'accuracy': 0.25757575757575757, 'AP': 0.7424242424242424, 'MCC': 0.0, 'NDCG': 0.9208012714375936, 'kappa': 0.0, 'TN': 34, 'FP': 0, 'FN': 98, 'TP': 0}
2025-06-06 12:46:44,623 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-06 12:46:47,366 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': 0.7348484848484849, 'MCC': 0.0, 'NDCG': 0.9181159076123374, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-06 12:46:47,370 - INFO - Confusion matrix: TN=35, FP=0, FN=97, TP=0
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-06-06 12:46:50,206 - INFO - Metrics: {'f1': 0.0, 'recall': 0.0, 'precision': 0.0, 'accuracy': 0.26515151515151514, 'AP': 0.7348484848484849, 'MCC': 0.0, 'NDCG': 0.9181159076123374, 'kappa': 0.0, 'TN': 35, 'FP': 0, 'FN': 97, 'TP': 0}
2025-06-06 12:46:50,208 - INFO - Pipeline for loss type None and ensemble=True
2025-06-06 12:46:50,209 - INFO - with_title : True
2025-06-06 12:46:50,209 - INFO - with_keywords : True
2025-06-06 12:46:50,209 - INFO - fold indexes for run no.1: [[159, 206, 117, 82, 317, 330, 131, 380, 183, 158, 213, 260, 155, 332, 303, 269, 40, 232, 314, 244, 168, 218, 254, 100, 3, 235, 105, 243, 352, 394, 196, 223, 230, 307, 342, 289, 135, 7, 189, 134, 78, 133, 12, 375, 109, 46, 62, 393, 167, 151, 387, 374, 276, 323, 132, 319, 114, 176, 322, 263, 258, 266, 250, 329, 309, 367, 24, 229, 370, 211, 228, 346, 115, 392, 87, 88, 81, 343, 253, 278, 43, 333, 28, 80, 191, 10, 378, 388, 225, 363, 136, 104, 356, 8, 57, 162, 220, 391, 139, 386, 282, 70, 61, 170, 102, 296, 64, 35, 4, 251, 279, 44, 373, 129, 236, 327, 187, 68, 245, 215, 18, 42, 116, 212, 376, 148, 126, 27, 252, 173, 103, 336, 209, 199, 169, 283, 32, 246, 292, 210, 247, 141, 73, 194, 59, 385, 354, 51, 305, 200, 344, 179, 178, 355, 313, 112, 291, 23, 328, 130, 315, 181, 138, 94, 95, 121, 207, 175, 295, 321, 34, 300, 262, 33, 341, 54, 299, 48, 30, 204, 123, 331, 301, 150, 157, 265, 14, 53, 396, 242, 377, 366, 93, 214, 83, 52, 6, 188, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 532, 533, 534, 535, 536, 537, 538, 539, 540, 541, 542, 543, 544, 545, 546, 547, 548, 549, 550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 560, 561, 562, 563, 564, 565, 566, 567, 568, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582, 583, 584, 585, 586, 587, 588, 589, 590, 591, 592, 593, 594, 595, 596, 597, 598, 599, 600, 601, 602, 603, 604, 605, 606, 607, 608, 609, 610, 611, 612, 613, 614, 615, 616, 617, 618, 619, 620, 621, 622, 623, 624, 625, 626, 627, 628, 629, 630, 631, 632, 633, 634, 635, 636, 637, 638, 639, 640, 641, 642, 643, 644, 645, 646, 647, 648, 649, 650, 651, 652, 653, 654, 655, 656, 657, 658, 659, 660, 661, 662, 663, 664, 665, 666, 667, 668, 669, 670, 671, 672, 673, 674, 675, 676, 677, 678, 679, 680, 681, 682, 683, 684, 685, 686, 687, 688, 689, 690, 691, 692, 693, 694, 695, 696, 697, 698, 699, 700, 701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 714, 715, 716, 717, 718, 719, 720, 721, 722, 723, 724, 725, 726, 727, 728, 729, 730, 731, 732, 733, 734, 735, 736, 737, 738, 739, 740, 741, 742, 743, 744, 745, 746, 747, 748, 749, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764, 765, 766, 767, 768, 769, 770, 771, 772, 773, 774, 775, 776, 777, 778, 779, 780, 781, 782, 783, 784, 785, 786, 787, 788, 789, 790, 791, 792, 793, 794, 795, 796, 797, 798, 799, 800, 801, 802, 803, 804, 805, 806, 807, 808, 809, 810, 811, 812, 813, 814, 815, 816, 817, 818, 819, 820, 821, 822, 823, 824, 825, 826, 827, 828, 829, 830, 831, 832, 833, 834, 835, 836, 837, 838, 839, 840, 841, 842, 843, 844, 845, 846, 847, 848, 849, 850, 851, 852, 853, 854, 855, 856, 857, 858, 859, 860, 861, 862, 863, 864, 865, 866, 867, 868, 869, 870, 871, 872, 873, 874, 875, 876, 877, 878, 879, 880, 881, 882, 883, 884, 885, 886, 887, 888, 889, 890, 891, 892, 893, 894, 895], [177, 268, 97, 248, 298, 320, 224, 137, 161, 145, 339, 98, 39, 66, 17, 325, 226, 91, 348, 67, 55, 237, 273, 353, 381, 261, 31, 2, 290, 107, 38, 113, 120, 1, 222, 84, 358, 202, 63, 337, 92, 99, 144, 256, 19, 171, 219, 285, 274, 174, 118, 233, 156, 324, 284, 190, 255, 357, 205, 111, 72, 384, 294, 71, 163, 217], array([  0,   5,   9,  11,  13,  15,  16,  20,  21,  22,  25,  26,  29,
        36,  37,  41,  45,  47,  49,  50,  56,  58,  60,  65,  69,  74,
        75,  76,  77,  79,  85,  86,  89,  90,  96, 101, 106, 108, 110,
       119, 122, 124, 125, 127, 128, 140, 142, 143, 146, 147, 149, 152,
       153, 154, 160, 164, 165, 166, 172, 180, 182, 184, 185, 186, 192,
       193, 195, 197, 198, 201, 203, 208, 216, 221, 227, 231, 234, 238,
       239, 240, 241, 249, 257, 259, 264, 267, 270, 271, 272, 275, 277,
       280, 281, 286, 287, 288, 293, 297, 302, 304, 306, 308, 310, 311,
       312, 316, 318, 326, 334, 335, 338, 340, 345, 347, 349, 350, 351,
       359, 360, 361, 362, 364, 365, 368, 369, 371, 372, 379, 382, 383,
       389, 390, 395])]
2025-06-06 12:46:50,209 - INFO - Run no 1/2
2025-06-06 12:46:50,209 - INFO - Loss Type : BCE
2025-06-06 12:46:50,209 - INFO - Ensemble learning pipeline
2025-06-06 12:46:50,209 - INFO - Training model 1/2: dmis-lab/biobert-v1.1
2025-06-06 12:46:50,415 - INFO - 
fold number 1 / 3
2025-06-06 12:46:50,422 - INFO - train split size : 697
2025-06-06 12:46:50,422 - INFO - dev split size : 66
2025-06-06 12:46:50,422 - INFO - test split size : 133
Map (num_proc=32):   0%|          | 0/697 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 22/697 [00:00<00:04, 136.66 examples/s]Map (num_proc=32):  16%|â–ˆâ–Œ        | 110/697 [00:00<00:01, 432.74 examples/s]Map (num_proc=32):  28%|â–ˆâ–ˆâ–Š       | 198/697 [00:00<00:00, 578.29 examples/s]Map (num_proc=32):  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 308/697 [00:00<00:00, 698.91 examples/s]Map (num_proc=32):  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 396/697 [00:00<00:00, 722.56 examples/s]Map (num_proc=32):  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 484/697 [00:00<00:00, 734.87 examples/s]Map (num_proc=32):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 571/697 [00:00<00:00, 738.03 examples/s]Map (num_proc=32):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 655/697 [00:00<00:00, 728.68 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 697/697 [00:01<00:00, 619.35 examples/s]
Map (num_proc=32):   0%|          | 0/66 [00:00<?, ? examples/s]Map (num_proc=32):   5%|â–         | 3/66 [00:00<00:02, 26.66 examples/s]Map (num_proc=32):  18%|â–ˆâ–Š        | 12/66 [00:00<00:00, 56.38 examples/s]Map (num_proc=32):  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 22/66 [00:00<00:00, 67.36 examples/s]Map (num_proc=32):  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 32/66 [00:00<00:00, 72.66 examples/s]Map (num_proc=32):  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 40/66 [00:00<00:00, 74.38 examples/s]Map (num_proc=32):  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 48/66 [00:00<00:00, 74.44 examples/s]Map (num_proc=32):  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 58/66 [00:00<00:00, 79.24 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 66/66 [00:00<00:00, 66.70 examples/s]
Map (num_proc=32):   0%|          | 0/133 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/133 [00:00<00:03, 42.24 examples/s]Map (num_proc=32):  19%|â–ˆâ–‰        | 25/133 [00:00<00:00, 127.33 examples/s]Map (num_proc=32):  31%|â–ˆâ–ˆâ–ˆ       | 41/133 [00:00<00:00, 141.30 examples/s]Map (num_proc=32):  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 61/133 [00:00<00:00, 147.21 examples/s]Map (num_proc=32):  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 77/133 [00:00<00:00, 151.15 examples/s]Map (num_proc=32):  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 93/133 [00:00<00:00, 152.80 examples/s]Map (num_proc=32):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 109/133 [00:00<00:00, 142.53 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 129/133 [00:00<00:00, 150.27 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 133/133 [00:01<00:00, 131.59 examples/s]
2025-06-06 12:46:55,347 - INFO - 3 datasets tokenized successfully
2025-06-06 12:46:55,349 - INFO - Starting hyperparameter search for BCE loss
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-06_12-46-55   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_12-46-55
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-06_12-46-29_854291_3636665/artifacts/2025-06-06_12-46-55/train_hpo_2025-06-06_12-46-55/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-06 12:46:56. Total running time: 0s
Logical resource usage: 0/32 CPUs, 0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_22562041   PENDING         8.49369       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_22562041 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_22562041 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          8.49369 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3640125)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3640125)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3640125)[0m 2025-06-06 12:47:04,559 - INFO - pos_weight value in TrainingArguments : 8.493688290834637
[36m(train_hpo pid=3640125)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3640125)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3640125)[0m [2025-06-06 12:47:04,807] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3640125)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=48, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3640125)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3640125)[0m   warnings.warn(

Trial train_hpo_5c8c34aa started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_5c8c34aa config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          7.54953 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3640359)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3640359)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3640359)[0m 2025-06-06 12:47:11,409 - INFO - pos_weight value in TrainingArguments : 7.549531688595925
[36m(train_hpo pid=3640359)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3640359)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3640359)[0m [2025-06-06 12:47:11,748] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3640359)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=40, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3640359)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3640359)[0m   warnings.warn(

Trial train_hpo_85008bbe started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_85008bbe config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          8.94984 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3640641)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3640641)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3640641)[0m 2025-06-06 12:47:18,279 - INFO - pos_weight value in TrainingArguments : 8.949837496427758
[36m(train_hpo pid=3640641)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3640641)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3640641)[0m [2025-06-06 12:47:18,513] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3640641)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=24, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3640641)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3640641)[0m   warnings.warn(

Trial status: 3 RUNNING
Current time: 2025-06-06 12:47:26. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_22562041   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_5c8c34aa   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_85008bbe   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3640125)[0m {'loss': 1.7223, 'grad_norm': 5.341615676879883, 'learning_rate': 1.246338876535363e-06, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3640641)[0m {'loss': 1.2957, 'grad_norm': 4.273141860961914, 'learning_rate': 5.325452975187489e-05, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3640359)[0m {'loss': 1.8265, 'grad_norm': 7.811829090118408, 'learning_rate': 3.6443132246884782e-06, 'epoch': 0.9142857142857143}
Trial status: 3 RUNNING
Current time: 2025-06-06 12:47:56. Total running time: 1min 0s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_22562041   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_5c8c34aa   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_85008bbe   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3640125)[0m {'loss': 1.6489, 'grad_norm': 4.468963146209717, 'learning_rate': 9.970711012282902e-07, 'epoch': 1.9142857142857141}[32m [repeated 2x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(train_hpo pid=3640641)[0m {'train_runtime': 37.8329, 'train_samples_per_second': 55.269, 'train_steps_per_second': 0.634, 'train_loss': 0.5750477239489555, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3640641)[0m STATE at ending of training  :  TrainerState(epoch=2.914285714285714, global_step=24, max_steps=24, logging_steps=500, eval_steps=500, save_steps=inf, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=515096932631760.0, log_history=[{'loss': 1.2957, 'grad_norm': 4.273141860961914, 'learning_rate': 5.325452975187489e-05, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.3152, 'grad_norm': 1.9125515222549438, 'learning_rate': 2.6627264875937445e-05, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 0.1142, 'grad_norm': 1.9746755361557007, 'learning_rate': 0.0, 'epoch': 2.914285714285714, 'step': 24}, {'train_runtime': 37.8329, 'train_samples_per_second': 55.269, 'train_steps_per_second': 0.634, 'total_flos': 515096932631760.0, 'train_loss': 0.5750477239489555, 'epoch': 2.914285714285714, 'step': 24}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3640641)[0m {'eval_loss': 0.12358126789331436, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9736211895942688, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.2564, 'eval_samples_per_second': 20.267, 'eval_steps_per_second': 1.228, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3640641)[0m 2025-06-06 12:48:02,895 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3640641)[0m 2025-06-06 12:48:02,900 - INFO - eval_result: {'eval_loss': 0.12358126789331436, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9736211895942688, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.2564, 'eval_samples_per_second': 20.267, 'eval_steps_per_second': 1.228, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3640641)[0m 2025-06-06 12:48:02,935 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB

Trial train_hpo_85008bbe finished iteration 1 at 2025-06-06 12:48:02. Total running time: 1min 6s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_85008bbe result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    45.5279 â”‚
â”‚ time_total_s                        45.5279 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               2.91429 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                                  1 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                             1 â”‚
â”‚ eval_f1                                   1 â”‚
â”‚ eval_kappa                                1 â”‚
â”‚ eval_loss                           0.12358 â”‚
â”‚ eval_optim_threshold                0.97362 â”‚
â”‚ eval_precision                            1 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.2564 â”‚
â”‚ eval_samples_per_second              20.267 â”‚
â”‚ eval_steps_per_second                 1.228 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 12:48:02,960 - INFO - Cleaning up trial 85008bbe
2025-06-06 12:48:02,960 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_12-46-55/train_hpo_85008bbe_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512_2025-06-06_12-47-10

Trial train_hpo_85008bbe completed after 1 iterations at 2025-06-06 12:48:02. Total running time: 1min 6s
[36m(train_hpo pid=3640359)[0m {'loss': 1.4649, 'grad_norm': 12.06215763092041, 'learning_rate': 2.7332349185163582e-06, 'epoch': 1.9142857142857141}[32m [repeated 2x across cluster][0m

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 12:48:26. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_22562041   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_5c8c34aa   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_85008bbe   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.5279      0.123581           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3640125)[0m {'loss': 1.6146, 'grad_norm': 4.047775745391846, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3640359)[0m {'loss': 1.263, 'grad_norm': 13.459153175354004, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.914285714285714}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 12:48:56. Total running time: 2min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_22562041   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_5c8c34aa   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_85008bbe   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.5279      0.123581           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3640125)[0m {'loss': 1.5876, 'grad_norm': 3.17292857170105, 'learning_rate': 4.985355506141451e-07, 'epoch': 3.914285714285714}
*** SIGTERM received at time=1749206940 on cpu 25 ***
PC: @     0x79c084698d71  (unknown)  (unknown)
    @     0x79c084645330  1547996208  (unknown)
    @     0x79c08469bc8e        224  pthread_cond_timedwait
    @     0x79bf6ee1f41f       1184  ray::core::GetRequest::Wait()
    @     0x79bf6ee216a7       1424  ray::core::CoreWorkerMemoryStore::GetImpl()
    @     0x79bf6ee229e7       1360  ray::core::CoreWorkerMemoryStore::Wait()
    @     0x79bf6ed42640       1776  ray::core::CoreWorker::Wait()
    @     0x79bf6ec3367b        352  __pyx_pw_3ray_7_raylet_10CoreWorker_61wait()
    @     0x79c084deab77  (unknown)  _PyEval_EvalFrameDefault
[2025-06-06 12:49:00,974 E 3636665 3636665] logging.cc:497: *** SIGTERM received at time=1749206940 on cpu 25 ***
[2025-06-06 12:49:00,974 E 3636665 3636665] logging.cc:497: PC: @     0x79c084698d71  (unknown)  (unknown)
[2025-06-06 12:49:00,974 E 3636665 3636665] logging.cc:497:     @     0x79c084645330  1547996208  (unknown)
[2025-06-06 12:49:00,974 E 3636665 3636665] logging.cc:497:     @     0x79c08469bc8e        224  pthread_cond_timedwait
[2025-06-06 12:49:00,974 E 3636665 3636665] logging.cc:497:     @     0x79bf6ee1f41f       1184  ray::core::GetRequest::Wait()
[2025-06-06 12:49:00,974 E 3636665 3636665] logging.cc:497:     @     0x79bf6ee216a7       1424  ray::core::CoreWorkerMemoryStore::GetImpl()
[2025-06-06 12:49:00,974 E 3636665 3636665] logging.cc:497:     @     0x79bf6ee229e7       1360  ray::core::CoreWorkerMemoryStore::Wait()
[2025-06-06 12:49:00,974 E 3636665 3636665] logging.cc:497:     @     0x79bf6ed42640       1776  ray::core::CoreWorker::Wait()
[2025-06-06 12:49:00,974 E 3636665 3636665] logging.cc:497:     @     0x79bf6ec3367b        352  __pyx_pw_3ray_7_raylet_10CoreWorker_61wait()
[2025-06-06 12:49:00,974 E 3636665 3636665] logging.cc:497:     @     0x79c084deab77  (unknown)  _PyEval_EvalFrameDefault
