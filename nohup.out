2025-06-02 11:02:01,161	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
2025-06-02 11:02:01,936 - INFO - Random seeds set to 42
2025-06-02 11:02:02,043 - INFO - Optional negatives loaded from CSV with 5000 entries.
2025-06-02 11:02:02,043 - INFO - Loading original negatives...
2025-06-02 11:02:02,053 - INFO - Negatives column names: ['Article ID', 'Title', 'Author', 'Publication year', 'Title secondary', 'URL', 'DOI', 'Abstract', 'Criteria for exclusion', 'labels']
2025-06-02 11:02:02,053 - INFO - Loading original positives...
2025-06-02 11:02:02,071 - INFO - Positives column names: ['Article ID', 'Title', 'Author', 'Secondary authors', 'Keywords', 'title of unpublished reference', 'primary date', 'publication year', 'notes', 'reprint status', 'start page number', 'ending page number', 'periodical full name', 'periodical standard abbreviation', 'periodical in which article was published', 'periodical name - user abbreviation 1', 'periodical name - user abbreviation 2', 'volume number', 'issue number', 'title secondary', 'city of publication', 'publisher', 'user definable 1', 'user definable 5', 'title series', 'Abstract', 'ISSN/ISBN', 'availability', 'Misc. 1', 'Misc. 2', 'address', 'Web/URL', 'link to PDF', 'link to full-text', 'related records', 'images', 'DOI', 'labels']
2025-06-02 11:02:02,077 - INFO - Class balance:
labels
1    326
0    123
Name: count, dtype: int64
2025-06-02 11:02:02,078 - INFO -     Article ID  ... Criteria for exclusion
0        12959  ...                    NaN
1        13470  ...                    NaN
2         4686  ...                    NaN
3  Diver, K.C.  ...                    NaN
4         2951  ...                    NaN

[5 rows x 42 columns]
2025-06-02 11:02:02,105 - INFO - Original dataset size: 449
2025-06-02 11:02:02,105 - INFO - Optional negatives size: 5000
2025-06-02 11:02:02,110 - INFO - Optional negatives:                                                title  ... labels
0  Towards evidence-based conservation of subterr...  ...     -1
1                  Marine biodiversity conservation.  ...     -1
2  Climate teleconnections modulate global burned...  ...     -1
3  Integrating carbon sequestration and biodivers...  ...     -1
4  Principle, technique and application of grassl...  ...     -1

[5 rows x 7 columns]
2025-06-02 11:02:02,113 - INFO - Combined dataset size: 5449
2025-06-02 11:02:02,117 - INFO -                                                title  ... labels
0  Feral pig (Sus scrofa) disturbance facilitates...  ...      1
1  Effects of woody plant diversity on abovegroun...  ...      1
2  Scaling species richness and endemism of tropi...  ...      1
3                                               2008  ...      0
4  Species-group concepts and biogeography of the...  ...      1

[5 rows x 5 columns]
2025-06-02 11:02:02,119 - INFO - title         0
abstract     49
Keywords    131
doi         112
labels        0
dtype: int64
2025-06-02 11:02:02,153 - INFO - Total duplicate abstracts: 0
2025-06-02 11:02:02,155 - INFO - Empty DataFrame
Columns: [abstract, labels, Keywords]
Index: []
2025-06-02 11:02:02,188 - INFO - Abstracts appearing in both classes: 0
2025-06-02 11:02:02,188 - INFO - Empty DataFrame
Columns: [doi, labels]
Index: []
2025-06-02 11:02:02,458 - INFO - Cleaned dataset size: 5318
2025-06-02 11:02:02,462 - INFO - Fold 1:
2025-06-02 11:02:02,463 - INFO -   Train label distribution: {-1: 0.9402030838661151, 1: 0.05979691613388492}
2025-06-02 11:02:02,463 - INFO -   Test label distribution: {-1: 0.9402030838661151, 1: 0.05979691613388492}
2025-06-02 11:02:02,464 - INFO - Fold 2:
2025-06-02 11:02:02,464 - INFO -   Train label distribution: {-1: 0.9402030838661151, 1: 0.05979691613388492}
2025-06-02 11:02:02,464 - INFO -   Test label distribution: {-1: 0.9402030838661151, 1: 0.05979691613388492}
Stringifying the column:   0%|          | 0/5318 [00:00<?, ? examples/s]Stringifying the column: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5318/5318 [00:00<00:00, 192627.56 examples/s]
Casting to class labels:   0%|          | 0/5318 [00:00<?, ? examples/s]Casting to class labels: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5318/5318 [00:00<00:00, 198285.27 examples/s]
2025-06-02 11:02:02,598 - INFO - Pipeline for loss type None and ensemble=True
2025-06-02 11:02:02,598 - INFO - with_title : True
2025-06-02 11:02:02,598 - INFO - with_keywords : True
2025-06-02 11:02:02,598 - INFO - Run no 1/1
2025-06-02 11:02:02,598 - INFO - Kernel : linear
2025-06-02 11:02:02,599 - INFO - 
fold number 1 / 2
2025-06-02 11:02:02,603 - INFO - train+dev split size : 2659
2025-06-02 11:02:02,603 - INFO - test split size : 2659
2025-06-02 11:02:04,559 - INFO - X shape : (2127, 10000)
2025-06-02 11:02:04,559 - INFO - y shape : (2127,)
2025-06-02 11:02:12,870 - INFO - Confusion matrix: TN=2499, FP=1, FN=30, TP=129
2025-06-02 11:02:15,735 - INFO - Metrics: {'f1': 0.8927335640138409, 'recall': 0.8113207547169812, 'precision': 0.9923076923076923, 'accuracy': 0.9883414817600602}
2025-06-02 11:02:15,735 - INFO - Concatenating...
2025-06-02 11:02:15,738 - INFO - 
fold number 2 / 2
2025-06-02 11:02:15,743 - INFO - train+dev split size : 2659
2025-06-02 11:02:15,743 - INFO - test split size : 2659
2025-06-02 11:02:17,678 - INFO - X shape : (2127, 10000)
2025-06-02 11:02:17,678 - INFO - y shape : (2127,)
2025-06-02 11:02:25,831 - INFO - Confusion matrix: TN=2500, FP=0, FN=20, TP=139
2025-06-02 11:02:28,702 - INFO - Metrics: {'f1': 0.9328859060402684, 'recall': 0.8742138364779874, 'precision': 1.0, 'accuracy': 0.9924783753290711}
2025-06-02 11:02:28,702 - INFO - Concatenating...
2025-06-02 11:02:28,710 - INFO - Run no 1/1
2025-06-02 11:02:28,710 - INFO - Kernel : rbf
2025-06-02 11:02:28,710 - INFO - 
fold number 1 / 2
2025-06-02 11:02:28,715 - INFO - train+dev split size : 2659
2025-06-02 11:02:28,715 - INFO - test split size : 2659
2025-06-02 11:02:30,697 - INFO - X shape : (2127, 10000)
2025-06-02 11:02:30,697 - INFO - y shape : (2127,)
2025-06-02 11:02:49,155 - INFO - Confusion matrix: TN=2500, FP=0, FN=46, TP=113
2025-06-02 11:02:52,094 - INFO - Metrics: {'f1': 0.8308823529411765, 'recall': 0.710691823899371, 'precision': 1.0, 'accuracy': 0.9827002632568634}
2025-06-02 11:02:52,094 - INFO - Concatenating...
2025-06-02 11:02:52,097 - INFO - 
fold number 2 / 2
2025-06-02 11:02:52,102 - INFO - train+dev split size : 2659
2025-06-02 11:02:52,102 - INFO - test split size : 2659
2025-06-02 11:02:54,061 - INFO - X shape : (2127, 10000)
2025-06-02 11:02:54,061 - INFO - y shape : (2127,)
2025-06-02 11:03:10,730 - INFO - Confusion matrix: TN=2500, FP=0, FN=40, TP=119
2025-06-02 11:03:13,815 - INFO - Metrics: {'f1': 0.8561151079136691, 'recall': 0.7484276729559748, 'precision': 1.0, 'accuracy': 0.9849567506581421}
2025-06-02 11:03:13,816 - INFO - Concatenating...
2025-06-02 11:03:13,823 - INFO - Run no 1/1
2025-06-02 11:03:13,824 - INFO - Kernel : poly
2025-06-02 11:03:13,824 - INFO - 
fold number 1 / 2
2025-06-02 11:03:13,828 - INFO - train+dev split size : 2659
2025-06-02 11:03:13,829 - INFO - test split size : 2659
2025-06-02 11:03:15,796 - INFO - X shape : (2127, 10000)
2025-06-02 11:03:15,796 - INFO - y shape : (2127,)
2025-06-02 11:03:53,770 - INFO - Confusion matrix: TN=2500, FP=0, FN=140, TP=19
2025-06-02 11:03:56,629 - INFO - Metrics: {'f1': 0.21348314606741572, 'recall': 0.11949685534591195, 'precision': 1.0, 'accuracy': 0.9473486273034976}
2025-06-02 11:03:56,629 - INFO - Concatenating...
2025-06-02 11:03:56,632 - INFO - 
fold number 2 / 2
2025-06-02 11:03:56,637 - INFO - train+dev split size : 2659
2025-06-02 11:03:56,637 - INFO - test split size : 2659
2025-06-02 11:03:58,643 - INFO - X shape : (2127, 10000)
2025-06-02 11:03:58,643 - INFO - y shape : (2127,)
2025-06-02 11:04:36,335 - INFO - Confusion matrix: TN=2500, FP=0, FN=145, TP=14
2025-06-02 11:04:39,154 - INFO - Metrics: {'f1': 0.16184971098265896, 'recall': 0.0880503144654088, 'precision': 1.0, 'accuracy': 0.9454682211357653}
2025-06-02 11:04:39,154 - INFO - Concatenating...
2025-06-02 11:04:39,162 - INFO - Run no 1/1
2025-06-02 11:04:39,162 - INFO - Kernel : sigmoid
2025-06-02 11:04:39,162 - INFO - 
fold number 1 / 2
2025-06-02 11:04:39,167 - INFO - train+dev split size : 2659
2025-06-02 11:04:39,167 - INFO - test split size : 2659
2025-06-02 11:04:41,177 - INFO - X shape : (2127, 10000)
2025-06-02 11:04:41,177 - INFO - y shape : (2127,)
2025-06-02 11:04:47,992 - INFO - Confusion matrix: TN=2499, FP=1, FN=32, TP=127
2025-06-02 11:04:50,843 - INFO - Metrics: {'f1': 0.8850174216027874, 'recall': 0.7987421383647799, 'precision': 0.9921875, 'accuracy': 0.9875893192929672}
2025-06-02 11:04:50,843 - INFO - Concatenating...
2025-06-02 11:04:50,845 - INFO - 
fold number 2 / 2
2025-06-02 11:04:50,850 - INFO - train+dev split size : 2659
2025-06-02 11:04:50,850 - INFO - test split size : 2659
2025-06-02 11:04:52,787 - INFO - X shape : (2127, 10000)
2025-06-02 11:04:52,787 - INFO - y shape : (2127,)
2025-06-02 11:04:59,562 - INFO - Confusion matrix: TN=2500, FP=0, FN=21, TP=138
2025-06-02 11:05:02,792 - INFO - Metrics: {'f1': 0.9292929292929293, 'recall': 0.8679245283018868, 'precision': 1.0, 'accuracy': 0.9921022940955246}
2025-06-02 11:05:02,792 - INFO - Concatenating...
2025-06-02 11:05:02,803 - INFO - 
fold number 1 / 2
2025-06-02 11:05:02,808 - INFO - train+dev split size : 2659
2025-06-02 11:05:02,808 - INFO - test split size : 2659
Traceback (most recent call last):
  File "/home/leandre/Projects/BioMoQA_Playground/experiments/biomoqa.py", line 54, in <module>
    main()
  File "/home/leandre/Projects/BioMoQA_Playground/experiments/biomoqa.py", line 38, in main
    pipeline.random_forest()
  File "/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/binary_pipeline.py", line 517, in random_forest
    x_train = (x_train_df["title"].astype(str) + " " + x_train_df["abstract"].astype(str)+ " " + x_train_df["Keywords"].astype(str)).values
               ~~~~~~~~~~^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/pandas/core/indexes/range.py", line 417, in get_loc
    raise KeyError(key)
KeyError: 'title'
