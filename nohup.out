adding 100 optional negatives
Traceback (most recent call last):
  File "/home/leandre/Projects/BioMoQA_Playground/src/data_pipeline/biomoqa/preprocess_biomoqa.py", line 14, in <module>
    from src.data_pipeline.biomoqa.create_raw import *
  File "/home/leandre/Projects/BioMoQA_Playground/src/__init__.py", line 1, in <module>
    from .models import biomoqa
  File "/home/leandre/Projects/BioMoQA_Playground/src/models/__init__.py", line 1, in <module>
    from .biomoqa import *
  File "/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/__init__.py", line 2, in <module>
    from HPO_callbacks import *
ModuleNotFoundError: No module named 'HPO_callbacks'
Loss function: BCE
Fold number: 0
Run number: 0
Model: microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract
2025-06-17 22:40:02,288 - INFO - Namespace(config='configs/hpo.yaml', fold=0, run=0, gpu=None, model_name='microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract', nb_opt_negs=100, n_trials=3, hpo_metric=None, direction=None, loss='BCE', with_title=True, with_keywords=False)
2025-06-17 22:40:02,289 - INFO - {'model_name': 'google-bert/bert-base-uncased', 'num_trials': 20, 'fold': 0, 'hpo_metric': 'eval_kappa', 'direction': 'max', 'loss_type': 'BCE', 'with_title': True, 'with_keywords': False, 'nb_optional_negs': 100}
2025-06-17 22:40:02,715 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
2025-06-17 22:40:02,715 - INFO - 
fold number 1 | run no. 1
2025-06-17 22:40:03,319 - INFO - train split size : 337
2025-06-17 22:40:03,319 - INFO - dev split size : 80
2025-06-17 22:40:03,319 - INFO - test split size : 80
2025-06-17 22:40:03,570 - INFO - 3 datasets tokenized successfully
2025-06-17 22:40:03,631 - INFO - Fold 1 max seq len = 512
2025-06-17 22:40:03,631 - INFO - Starting hyperparameter search for BCE loss
2025-06-17 22:40:04,982	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
2025-06-17 22:40:05,715	INFO tune.py:253 -- Initializing Ray automatically. For cluster usage or custom Ray initialization, call `ray.init(...)` before `tune.run(...)`.
[36m(trainable pid=119455)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=119455)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=119455)[0m 2025-06-17 22:40:14,267 - INFO - pos_weight value in TrainingArguments : 6.828424226204718
[36m(trainable pid=119455)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=119455)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=119657)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=119657)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=119657)[0m 2025-06-17 22:40:20,723 - INFO - pos_weight value in TrainingArguments : 6.094080202241274
[36m(trainable pid=119657)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=119657)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=120048)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=120048)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=120048)[0m 2025-06-17 22:40:27,335 - INFO - pos_weight value in TrainingArguments : 7.183206941666034
[36m(trainable pid=120048)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=120048)[0m   super().__init__(*args, **kwargs)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     trainable_2025-06-17_22-40-05   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-40-05
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-17_22-40-03_653150_117001/artifacts/2025-06-17_22-40-05/trainable_2025-06-17_22-40-05/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-17 22:40:06. Total running time: 0s
Logical resource usage: 0/32 CPUs, 0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_cf42a889   PENDING         6.82842       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_cf42a889 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_cf42a889 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          6.82842 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=119455)[0m [2025-06-17 22:40:14,540] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=119455)[0m [2025-06-17 22:40:17,520] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=119455)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial trainable_24a625d1 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_24a625d1 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          6.09408 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=119657)[0m [2025-06-17 22:40:21,138] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=119657)[0m [2025-06-17 22:40:23,983] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=119657)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=119455)[0m {'loss': 2.0442, 'grad_norm': 27.312023162841797, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}

Trial trainable_b3713e77 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_b3713e77 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          7.18321 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=120048)[0m [2025-06-17 22:40:27,553] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=120048)[0m [2025-06-17 22:40:30,404] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=120048)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 3 RUNNING
Current time: 2025-06-17 22:40:37. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_cf42a889   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ trainable_24a625d1   RUNNING         6.09408       4.55539e-06         0.123031                    5 â”‚
â”‚ trainable_b3713e77   RUNNING         7.18321       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=120048)[0m 2025-06-17 22:40:53,998 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=120048)[0m 2025-06-17 22:40:54,003 - INFO - eval_result: {'eval_loss': 0.8033722043037415, 'eval_f1': 0.8805970149253731, 'eval_accuracy': 0.8, 'eval_kappa': 0.31550802139037437, 'eval_precision': 0.7866666666666666, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9804468154907227, 'eval_AP': 0.8271991873998914, 'eval_MCC': 0.43278353400006714, 'eval_NDCG': 0.9135719313347781, 'eval_runtime': 3.3033, 'eval_samples_per_second': 24.218, 'eval_steps_per_second': 1.211, 'epoch': 3.0}
2025-06-17 22:40:54,348 - INFO - Cleaning up trial b3713e77
2025-06-17 22:40:54,348 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-40-05/trainable_b3713e77_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512_2025-06-17_22-40-19
[36m(trainable pid=120048)[0m 2025-06-17 22:40:54,326 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB

[36m(trainable pid=120048)[0m {'loss': 1.3315, 'grad_norm': 145.2803955078125, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
[36m(trainable pid=120048)[0m {'loss': 1.1094, 'grad_norm': 93.46280670166016, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}[32m [repeated 3x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(trainable pid=120048)[0m {'train_runtime': 19.825, 'train_samples_per_second': 50.996, 'train_steps_per_second': 2.573, 'train_loss': 1.022493325027765, 'epoch': 3.0}
[36m(trainable pid=120048)[0m STATE at ending of training  :  TrainerState(epoch=3.0, global_step=51, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=265725391165272.0, log_history=[{'loss': 1.3315, 'grad_norm': 145.2803955078125, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0, 'step': 17}, {'loss': 1.1094, 'grad_norm': 93.46280670166016, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0, 'step': 34}, {'loss': 0.6265, 'grad_norm': 18.331777572631836, 'learning_rate': 0.0, 'epoch': 3.0, 'step': 51}, {'train_runtime': 19.825, 'train_samples_per_second': 50.996, 'train_steps_per_second': 2.573, 'total_flos': 265725391165272.0, 'train_loss': 1.022493325027765, 'epoch': 3.0, 'step': 51}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=120048)[0m {'loss': 0.6265, 'grad_norm': 18.331777572631836, 'learning_rate': 0.0, 'epoch': 3.0}
[36m(trainable pid=120048)[0m {'eval_loss': 0.8033722043037415, 'eval_f1': 0.8805970149253731, 'eval_accuracy': 0.8, 'eval_kappa': 0.31550802139037437, 'eval_precision': 0.7866666666666666, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9804468154907227, 'eval_AP': 0.8271991873998914, 'eval_MCC': 0.43278353400006714, 'eval_NDCG': 0.9135719313347781, 'eval_runtime': 3.3033, 'eval_samples_per_second': 24.218, 'eval_steps_per_second': 1.211, 'epoch': 3.0}

Trial trainable_b3713e77 finished iteration 1 at 2025-06-17 22:40:54. Total running time: 47s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_b3713e77 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    27.9479 â”‚
â”‚ time_total_s                        27.9479 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     3 â”‚
â”‚ eval_AP                              0.8272 â”‚
â”‚ eval_MCC                            0.43278 â”‚
â”‚ eval_NDCG                           0.91357 â”‚
â”‚ eval_accuracy                           0.8 â”‚
â”‚ eval_f1                              0.8806 â”‚
â”‚ eval_kappa                          0.31551 â”‚
â”‚ eval_loss                           0.80337 â”‚
â”‚ eval_optim_threshold                0.98045 â”‚
â”‚ eval_precision                      0.78667 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.3033 â”‚
â”‚ eval_samples_per_second              24.218 â”‚
â”‚ eval_steps_per_second                 1.211 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_b3713e77 completed after 1 iterations at 2025-06-17 22:40:54. Total running time: 47s
[36m(trainable pid=119657)[0m {'loss': 1.3362, 'grad_norm': 8.547239303588867, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0}

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 22:41:07. Total running time: 1min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_cf42a889   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_24a625d1   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_b3713e77   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.9479      0.803372    0.880597               0.8       0.315508 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=119657)[0m {'loss': 1.2493, 'grad_norm': 12.562725067138672, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0}[32m [repeated 2x across cluster][0m
[36m(trainable pid=119657)[0m {'loss': 1.1828, 'grad_norm': 9.440814018249512, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0}[32m [repeated 2x across cluster][0m
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 22:41:37. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_cf42a889   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_24a625d1   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_b3713e77   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.9479      0.803372    0.880597               0.8       0.315508 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=119657)[0m 2025-06-17 22:41:44,397 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=119657)[0m 2025-06-17 22:41:44,403 - INFO - eval_result: {'eval_loss': 1.0952997207641602, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8766156435012817, 'eval_AP': 0.8324947224168495, 'eval_MCC': 0.0, 'eval_NDCG': 0.9553778335038086, 'eval_runtime': 4.0018, 'eval_samples_per_second': 19.991, 'eval_steps_per_second': 1.0, 'epoch': 5.0}
[36m(trainable pid=119455)[0m 2025-06-17 22:41:44,487 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=119455)[0m 2025-06-17 22:41:44,493 - INFO - eval_result: {'eval_loss': 1.2145328521728516, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8507022261619568, 'eval_AP': 0.7763030778309867, 'eval_MCC': 0.0, 'eval_NDCG': 0.9332897828575102, 'eval_runtime': 3.7165, 'eval_samples_per_second': 21.526, 'eval_steps_per_second': 1.076, 'epoch': 6.0}
2025-06-17 22:41:44,868 - INFO - Cleaning up trial cf42a889
2025-06-17 22:41:44,869 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-40-05/trainable_cf42a889_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-17_22-40-06
2025-06-17 22:41:44,869 - INFO - Current best: b3713e77 with eval_kappa : 0.31550802139037437 at iteration 1
2025-06-17 22:41:44,884 - INFO - Cleaning up trial 24a625d1
2025-06-17 22:41:44,884 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-40-05/trainable_24a625d1_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-17_22-40-13
2025-06-17 22:41:44,884 - INFO - Cleaning up trial cf42a889
2025-06-17 22:41:44,885 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-40-05/trainable_cf42a889_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-17_22-40-06
2025-06-17 22:41:44,885 - INFO - Current best: b3713e77 with eval_kappa : 0.31550802139037437 at iteration 1
2025-06-17 22:41:44,893	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-40-05' in 0.0064s.

[36m(trainable pid=119657)[0m {'train_runtime': 75.8977, 'train_samples_per_second': 22.201, 'train_steps_per_second': 1.12, 'train_loss': 1.3182529898250803, 'epoch': 5.0}
[36m(trainable pid=119657)[0m STATE at ending of training  :  TrainerState(epoch=5.0, global_step=85, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=443060650241880.0, log_history=[{'loss': 1.6762, 'grad_norm': 8.024697303771973, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0, 'step': 17}, {'loss': 1.3362, 'grad_norm': 8.547239303588867, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0, 'step': 34}, {'loss': 1.2493, 'grad_norm': 12.562725067138672, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0, 'step': 51}, {'loss': 1.1828, 'grad_norm': 9.440814018249512, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0, 'step': 68}, {'loss': 1.1467, 'grad_norm': 12.490870475769043, 'learning_rate': 0.0, 'epoch': 5.0, 'step': 85}, {'train_runtime': 75.8977, 'train_samples_per_second': 22.201, 'train_steps_per_second': 1.12, 'total_flos': 443060650241880.0, 'train_loss': 1.3182529898250803, 'epoch': 5.0, 'step': 85}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=119657)[0m {'loss': 1.1467, 'grad_norm': 12.490870475769043, 'learning_rate': 0.0, 'epoch': 5.0}[32m [repeated 2x across cluster][0m
[36m(trainable pid=119455)[0m STATE at ending of training  :  TrainerState(epoch=6.0, global_step=102, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=531728279780184.0, log_history=[{'loss': 2.0442, 'grad_norm': 27.312023162841797, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0, 'step': 17}, {'loss': 1.5964, 'grad_norm': 11.5800199508667, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0, 'step': 34}, {'loss': 1.4359, 'grad_norm': 9.625068664550781, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0, 'step': 51}, {'loss': 1.3674, 'grad_norm': 9.723105430603027, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0, 'step': 68}, {'loss': 1.3527, 'grad_norm': 12.586043357849121, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0, 'step': 85}, {'loss': 1.3281, 'grad_norm': 9.546479225158691, 'learning_rate': 0.0, 'epoch': 6.0, 'step': 102}, {'train_runtime': 82.7706, 'train_samples_per_second': 24.429, 'train_steps_per_second': 1.232, 'total_flos': 531728279780184.0, 'train_loss': 1.5207771413466509, 'epoch': 6.0, 'step': 102}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=119657)[0m {'eval_loss': 1.0952997207641602, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8766156435012817, 'eval_AP': 0.8324947224168495, 'eval_MCC': 0.0, 'eval_NDCG': 0.9553778335038086, 'eval_runtime': 4.0018, 'eval_samples_per_second': 19.991, 'eval_steps_per_second': 1.0, 'epoch': 5.0}

Trial trainable_cf42a889 finished iteration 1 at 2025-06-17 22:41:44. Total running time: 1min 38s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_cf42a889 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    91.4737 â”‚
â”‚ time_total_s                        91.4737 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     6 â”‚
â”‚ eval_AP                              0.7763 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.93329 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.21453 â”‚
â”‚ eval_optim_threshold                 0.8507 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.7165 â”‚
â”‚ eval_samples_per_second              21.526 â”‚
â”‚ eval_steps_per_second                 1.076 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_cf42a889 completed after 1 iterations at 2025-06-17 22:41:44. Total running time: 1min 38s

Trial trainable_24a625d1 finished iteration 1 at 2025-06-17 22:41:44. Total running time: 1min 38s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_24a625d1 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    85.0384 â”‚
â”‚ time_total_s                        85.0384 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     5 â”‚
â”‚ eval_AP                             0.83249 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.95538 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                            1.0953 â”‚
â”‚ eval_optim_threshold                0.87662 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         4.0018 â”‚
â”‚ eval_samples_per_second              19.991 â”‚
â”‚ eval_steps_per_second                     1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_24a625d1 completed after 1 iterations at 2025-06-17 22:41:44. Total running time: 1min 38s

Trial status: 3 TERMINATED
Current time: 2025-06-17 22:41:44. Total running time: 1min 38s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_cf42a889   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1            91.4737      1.21453     0.848921            0.7375       0        â”‚
â”‚ trainable_24a625d1   TERMINATED        6.09408       4.55539e-06         0.123031                    5        1            85.0384      1.0953      0.848921            0.7375       0        â”‚
â”‚ trainable_b3713e77   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.9479      0.803372    0.880597            0.8          0.315508 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯2025-06-17 22:41:44,899 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x7695264747d0>
2025-06-17 22:41:44,900 - INFO - Best trial : trainable_b3713e77
2025-06-17 22:41:44,900 - INFO - Best config : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-17 22:41:44,900 - INFO - Best trial after optimization: {'eval_loss': 0.8033722043037415, 'eval_f1': 0.8805970149253731, 'eval_accuracy': 0.8, 'eval_kappa': 0.31550802139037437, 'eval_precision': 0.7866666666666666, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9804468154907227, 'eval_AP': 0.8271991873998914, 'eval_MCC': 0.43278353400006714, 'eval_NDCG': 0.9135719313347781, 'eval_runtime': 3.3033, 'eval_samples_per_second': 24.218, 'eval_steps_per_second': 1.211, 'epoch': 3.0, 'timestamp': 1750192854, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': 'b3713e77', 'date': '2025-06-17_22-40-54', 'time_this_iter_s': 27.94789695739746, 'time_total_s': 27.94789695739746, 'pid': 120048, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 27.94789695739746, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512'}
2025-06-17 22:41:44,922 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   1.214533  0.848921  ...                        6  cf42a889
1   1.095300  0.848921  ...                        5  24a625d1
2   0.803372  0.880597  ...                        3  b3713e77

[3 rows x 32 columns]
[36m(trainable pid=119455)[0m 2025-06-17 22:41:44,847 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
2025-06-17 22:41:45,080 - INFO - Trial comparison plot saved
2025-06-17 22:41:45,090 - INFO - Best Hyperparameters after HPO : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}


[36m(trainable pid=119657)[0m 2025-06-17 22:41:44,861 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(trainable pid=119455)[0m {'train_runtime': 82.7706, 'train_samples_per_second': 24.429, 'train_steps_per_second': 1.232, 'train_loss': 1.5207771413466509, 'epoch': 6.0}
[36m(trainable pid=119455)[0m {'loss': 1.3281, 'grad_norm': 9.546479225158691, 'learning_rate': 0.0, 'epoch': 6.0}
[36m(trainable pid=119455)[0m {'eval_loss': 1.2145328521728516, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8507022261619568, 'eval_AP': 0.7763030778309867, 'eval_MCC': 0.0, 'eval_NDCG': 0.9332897828575102, 'eval_runtime': 3.7165, 'eval_samples_per_second': 21.526, 'eval_steps_per_second': 1.076, 'epoch': 6.0}
2025-06-17 22:41:54,103 - INFO - Namespace(config='configs/train.yaml', hp_config='configs/best_hpo.yaml', fold=0, run=0, gpu='2', model_name='microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract', nb_opt_negs=100, loss='BCE', with_title=True, with_keywords=False, best_metric=None)
2025-06-17 22:41:54,105 - INFO - {'model_name': 'bert-base-uncased', 'fold': 0, 'run': 0, 'output_dir': 'outputs/checkpoints', 'best_metric': 'eval_kappa', 'loss_type': 'BCE', 'nb_optional_negs': 100, 'with_title': True, 'with_keywords': False, 'default_hyperparameters': {'learning_rate': 'None', 'num_train_epochs': 'None', 'pos_weight': 'None', 'weight_decay': 'None'}}
2025-06-17 22:41:54,911 - INFO - train split size : 337
2025-06-17 22:41:54,911 - INFO - dev split size : 80
2025-06-17 22:41:54,911 - INFO - test split size : 80
2025-06-17 22:41:55,158 - INFO - 3 datasets tokenized successfully
2025-06-17 22:41:55,158 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-17 22:41:55,901 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
[2025-06-17 22:41:56,136] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-06-17 22:41:58,863] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
2025-06-17 22:41:58,900 - INFO - training size : 337
2025-06-17 22:41:58,900 - INFO - dev size : 80
2025-06-17 22:41:58,900 - INFO - test size : 80
  0%|          | 0/12 [00:00<?, ?it/s]  8%|â–Š         | 1/12 [00:02<00:25,  2.34s/it] 17%|â–ˆâ–‹        | 2/12 [00:04<00:20,  2.04s/it] 25%|â–ˆâ–ˆâ–Œ       | 3/12 [00:05<00:17,  1.92s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [00:06<00:11,  1.43s/it]                                               33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [00:06<00:11,  1.43s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 5/12 [00:08<00:11,  1.60s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 6/12 [00:10<00:10,  1.67s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 7/12 [00:12<00:08,  1.71s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [00:12<00:05,  1.38s/it]                                               67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [00:12<00:05,  1.38s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 9/12 [00:14<00:04,  1.54s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 10/12 [00:16<00:03,  1.63s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 11/12 [00:18<00:01,  1.68s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:18<00:00,  1.37s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:20<00:00,  1.37s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:20<00:00,  1.37s/it]2025-06-17 22:42:19,899 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:20<00:00,  1.73s/it]
{'loss': 2.3885, 'grad_norm': 6.667657375335693, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
{'loss': 1.2439, 'grad_norm': 13.872511863708496, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
{'loss': 0.9387, 'grad_norm': 10.350007057189941, 'learning_rate': 0.0, 'epoch': 3.0}
{'train_runtime': 20.7081, 'train_samples_per_second': 48.821, 'train_steps_per_second': 0.579, 'train_loss': 1.5236792763074238, 'epoch': 3.0}
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 22:42:24,917 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:04<00:00,  4.51s/it]
2025-06-17 22:42:24,923 - INFO - Training time : 29.765084789018147
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 22:42:28,482 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:03<00:00,  3.04s/it]
2025-06-17 22:42:28,487 - INFO - Evaluation time : 3.5632793999975547
2025-06-17 22:42:28,487 - INFO - Evaluation results on test set: {'eval_loss': 1.1087473630905151, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.94613116979599, 'eval_AP': 0.8502966651454931, 'eval_MCC': 0.0, 'eval_NDCG': 0.9629562161346663, 'eval_runtime': 3.5504, 'eval_samples_per_second': 22.533, 'eval_steps_per_second': 0.282, 'epoch': 3.0}
2025-06-17 22:42:28,487 - INFO - Total updates (optimizer steps): 12
2025-06-17 22:42:28,487 - INFO - Avg time / step: 1.727s
2025-06-17 22:42:29,222 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCE_BiomedBERT-abs_fold-1
2025-06-17 22:42:29,222 - INFO - On test Set (with threshold 0.5) : 
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 22:42:32,914 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:03<00:00,  3.18s/it]
2025-06-17 22:42:32,918 - INFO - Raw predictions shape: (80, 1)
2025-06-17 22:42:32,918 - INFO - Raw predictions: [[3.107226 ]
 [3.0904822]
 [2.1704507]
 [2.8996935]
 [3.2630455]
 [3.3536246]
 [3.0249772]
 [2.6577065]
 [2.814008 ]
 [1.849908 ]]
2025-06-17 22:42:32,919 - INFO - Scores shape: (80,)
2025-06-17 22:42:32,919 - INFO - Scores: [0.95718986 0.95649844 0.8975644  0.9478313  0.96313906 0.96622336
 0.9536898  0.93448436 0.9434281  0.8641163 ]
2025-06-17 22:42:32,919 - INFO - Preds shape: (80,)
2025-06-17 22:42:32,919 - INFO - Preds: [1 1 1 1 1 1 1 1 1 1]
2025-06-17 22:42:32,919 - INFO - Test labels shape: (80,)
2025-06-17 22:42:32,919 - INFO - Test labels: [1, 1, 0, 0, 1, 1, 1, 1, 0, 0]
2025-06-17 22:42:32,919 - INFO - Test split: Dataset({
    features: ['Unnamed: 0', 'title', 'abstract', 'Keywords', 'doi', 'labels'],
    num_rows: 80
})
2025-06-17 22:42:32,919 - INFO - Unique values in predictions: [1]
2025-06-17 22:42:32,920 - INFO - Unique values in labels: [0 1]
2025-06-17 22:42:32,921 - INFO - Confusion matrix:
[[ 0 21]
 [ 0 59]]
2025-06-17 22:42:32,922 - INFO - Confusion matrix: TN=0, FP=21, FN=0, TP=59
2025-06-17 22:42:35,716 - INFO - Metrics: {'f1': 0.8489208633093526, 'recall': 1.0, 'precision': 0.7375, 'accuracy': 0.7375, 'AP': 0.8502966651454931, 'MCC': 0.0, 'NDCG': 0.9629562161346663, 'kappa': 0.0, 'TN': 0, 'FP': 21, 'FN': 0, 'TP': 59}
2025-06-17 22:42:35,829 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-17 22:42:35,920 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 22:42:35,920 - INFO - 
On test Set (optimal threshold of 0.830915093421936 according to cross validation on the training set): 
2025-06-17 22:42:35,921 - INFO - Confusion matrix: TN=3, FP=18, FN=5, TP=54
2025-06-17 22:42:38,633 - INFO - Metrics: {'f1': 0.8244274809160306, 'recall': 0.9152542372881356, 'precision': 0.75, 'accuracy': 0.7125, 'AP': 0.8502966651454931, 'MCC': 0.08522864845907041, 'NDCG': 0.9629562161346663, 'kappa': 0.07258064516129026, 'TN': 3, 'FP': 18, 'FN': 5, 'TP': 54}
2025-06-17 22:42:38,728 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 22:42:38,728 - INFO - Results for fold 1 : [{'f1': 0.8244274809160306, 'recall': 0.9152542372881356, 'precision': 0.75, 'accuracy': 0.7125, 'AP': 0.8502966651454931, 'MCC': 0.08522864845907041, 'NDCG': 0.9629562161346663, 'kappa': 0.07258064516129026, 'TN': 3, 'FP': 18, 'FN': 5, 'TP': 54}]
2025-06-17 22:42:39,050 - INFO - Cleared CUDA cache. Memory allocated: 1.33 GB, Memory reserved: 1.63 GB
2025-06-17 22:42:39,056 - INFO - Metrics stored successfully at /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/metrics/binary_metrics.csv
Model: microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext
2025-06-17 22:42:46,396 - INFO - Namespace(config='configs/hpo.yaml', fold=0, run=0, gpu=None, model_name='microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext', nb_opt_negs=100, n_trials=3, hpo_metric=None, direction=None, loss='BCE', with_title=True, with_keywords=False)
2025-06-17 22:42:46,397 - INFO - {'model_name': 'google-bert/bert-base-uncased', 'num_trials': 20, 'fold': 0, 'hpo_metric': 'eval_kappa', 'direction': 'max', 'loss_type': 'BCE', 'with_title': True, 'with_keywords': False, 'nb_optional_negs': 100}
2025-06-17 22:42:46,897 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
2025-06-17 22:42:46,897 - INFO - 
fold number 1 | run no. 1
2025-06-17 22:42:47,509 - INFO - train split size : 337
2025-06-17 22:42:47,509 - INFO - dev split size : 80
2025-06-17 22:42:47,509 - INFO - test split size : 80
2025-06-17 22:42:47,755 - INFO - 3 datasets tokenized successfully
2025-06-17 22:42:47,815 - INFO - Fold 1 max seq len = 512
2025-06-17 22:42:47,815 - INFO - Starting hyperparameter search for BCE loss
2025-06-17 22:42:49,189	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
2025-06-17 22:42:49,896	INFO tune.py:253 -- Initializing Ray automatically. For cluster usage or custom Ray initialization, call `ray.init(...)` before `tune.run(...)`.
[36m(trainable pid=124538)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=124538)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=124538)[0m 2025-06-17 22:42:58,388 - INFO - pos_weight value in TrainingArguments : 6.828424226204718
[36m(trainable pid=124538)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=124538)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=124740)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=124740)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=124740)[0m 2025-06-17 22:43:04,837 - INFO - pos_weight value in TrainingArguments : 6.094080202241274
[36m(trainable pid=124740)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=124740)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=125133)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=125133)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=125133)[0m 2025-06-17 22:43:11,092 - INFO - pos_weight value in TrainingArguments : 7.183206941666034
[36m(trainable pid=125133)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=125133)[0m   super().__init__(*args, **kwargs)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     trainable_2025-06-17_22-42-49   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-42-49
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-17_22-42-47_837200_122090/artifacts/2025-06-17_22-42-49/trainable_2025-06-17_22-42-49/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-17 22:42:51. Total running time: 0s
Logical resource usage: 0/32 CPUs, 0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_a21a2597   PENDING         6.82842       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_a21a2597 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_a21a2597 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          6.82842 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=124538)[0m [2025-06-17 22:42:58,645] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=124538)[0m [2025-06-17 22:43:01,551] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=124538)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial trainable_910bd266 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_910bd266 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          6.09408 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=124740)[0m [2025-06-17 22:43:05,226] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=124740)[0m [2025-06-17 22:43:07,817] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=124740)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=124538)[0m {'loss': 2.3761, 'grad_norm': 20.01381492614746, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}

Trial trainable_ccb1ad12 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_ccb1ad12 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          7.18321 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=125133)[0m [2025-06-17 22:43:11,340] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=125133)[0m [2025-06-17 22:43:14,212] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=125133)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 3 RUNNING
Current time: 2025-06-17 22:43:21. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_a21a2597   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ trainable_910bd266   RUNNING         6.09408       4.55539e-06         0.123031                    5 â”‚
â”‚ trainable_ccb1ad12   RUNNING         7.18321       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=125133)[0m 2025-06-17 22:43:37,746 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=125133)[0m 2025-06-17 22:43:37,751 - INFO - eval_result: {'eval_loss': 0.9277929067611694, 'eval_f1': 0.8613138686131386, 'eval_accuracy': 0.7625, 'eval_kappa': 0.13439635535307526, 'eval_precision': 0.7564102564102564, 'eval_recall': 1.0, 'eval_optim_threshold': 0.984454333782196, 'eval_AP': 0.8192761581517203, 'eval_MCC': 0.26840095387139007, 'eval_NDCG': 0.9098899303569317, 'eval_runtime': 3.3839, 'eval_samples_per_second': 23.642, 'eval_steps_per_second': 1.182, 'epoch': 3.0}
2025-06-17 22:43:38,078 - INFO - Cleaning up trial ccb1ad12
2025-06-17 22:43:38,078 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-42-49/trainable_ccb1ad12_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512_2025-06-17_22-43-03
[36m(trainable pid=125133)[0m 2025-06-17 22:43:38,057 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB

[36m(trainable pid=125133)[0m {'loss': 1.4747, 'grad_norm': 21.139705657958984, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
[36m(trainable pid=124740)[0m {'loss': 1.6178, 'grad_norm': 6.72487735748291, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0}
[36m(trainable pid=125133)[0m {'train_runtime': 19.8114, 'train_samples_per_second': 51.031, 'train_steps_per_second': 2.574, 'train_loss': 0.914977840348786, 'epoch': 3.0}
[36m(trainable pid=125133)[0m STATE at ending of training  :  TrainerState(epoch=3.0, global_step=51, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=265776779581872.0, log_history=[{'loss': 1.4747, 'grad_norm': 21.139705657958984, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0, 'step': 17}, {'loss': 0.7639, 'grad_norm': 8.48964786529541, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0, 'step': 34}, {'loss': 0.5064, 'grad_norm': 7.465668678283691, 'learning_rate': 0.0, 'epoch': 3.0, 'step': 51}, {'train_runtime': 19.8114, 'train_samples_per_second': 51.031, 'train_steps_per_second': 2.574, 'total_flos': 265776779581872.0, 'train_loss': 0.914977840348786, 'epoch': 3.0, 'step': 51}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=125133)[0m {'loss': 0.5064, 'grad_norm': 7.465668678283691, 'learning_rate': 0.0, 'epoch': 3.0}[32m [repeated 3x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(trainable pid=125133)[0m {'eval_loss': 0.9277929067611694, 'eval_f1': 0.8613138686131386, 'eval_accuracy': 0.7625, 'eval_kappa': 0.13439635535307526, 'eval_precision': 0.7564102564102564, 'eval_recall': 1.0, 'eval_optim_threshold': 0.984454333782196, 'eval_AP': 0.8192761581517203, 'eval_MCC': 0.26840095387139007, 'eval_NDCG': 0.9098899303569317, 'eval_runtime': 3.3839, 'eval_samples_per_second': 23.642, 'eval_steps_per_second': 1.182, 'epoch': 3.0}

Trial trainable_ccb1ad12 finished iteration 1 at 2025-06-17 22:43:38. Total running time: 47s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_ccb1ad12 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    27.8714 â”‚
â”‚ time_total_s                        27.8714 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     3 â”‚
â”‚ eval_AP                             0.81928 â”‚
â”‚ eval_MCC                             0.2684 â”‚
â”‚ eval_NDCG                           0.90989 â”‚
â”‚ eval_accuracy                        0.7625 â”‚
â”‚ eval_f1                             0.86131 â”‚
â”‚ eval_kappa                           0.1344 â”‚
â”‚ eval_loss                           0.92779 â”‚
â”‚ eval_optim_threshold                0.98445 â”‚
â”‚ eval_precision                      0.75641 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.3839 â”‚
â”‚ eval_samples_per_second              23.642 â”‚
â”‚ eval_steps_per_second                 1.182 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_ccb1ad12 completed after 1 iterations at 2025-06-17 22:43:38. Total running time: 47s
[36m(trainable pid=124538)[0m {'loss': 1.6255, 'grad_norm': 6.047595500946045, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0}[32m [repeated 2x across cluster][0m

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 22:43:51. Total running time: 1min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_a21a2597   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_910bd266   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_ccb1ad12   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.8714      0.927793    0.861314            0.7625       0.134396 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=124740)[0m {'loss': 1.2575, 'grad_norm': 8.995421409606934, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0}
[36m(trainable pid=124538)[0m {'loss': 1.5537, 'grad_norm': 6.956624507904053, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0}
[36m(trainable pid=124740)[0m {'loss': 1.212, 'grad_norm': 5.706791877746582, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0}
[36m(trainable pid=124538)[0m {'loss': 1.5092, 'grad_norm': 12.563606262207031, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 22:44:21. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_a21a2597   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_910bd266   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_ccb1ad12   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.8714      0.927793    0.861314            0.7625       0.134396 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=124740)[0m 2025-06-17 22:44:28,244 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=124740)[0m 2025-06-17 22:44:28,250 - INFO - eval_result: {'eval_loss': 1.0895644426345825, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9143107533454895, 'eval_AP': 0.7972930620750831, 'eval_MCC': 0.0, 'eval_NDCG': 0.9469471817624291, 'eval_runtime': 4.0056, 'eval_samples_per_second': 19.972, 'eval_steps_per_second': 0.999, 'epoch': 5.0}
2025-06-17 22:44:28,712 - INFO - Cleaning up trial 910bd266
2025-06-17 22:44:28,713 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-42-49/trainable_910bd266_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-17_22-42-57
2025-06-17 22:44:28,713 - INFO - Current best: ccb1ad12 with eval_kappa : 0.13439635535307526 at iteration 1
[36m(trainable pid=124538)[0m 2025-06-17 22:44:28,709 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=124538)[0m 2025-06-17 22:44:28,715 - INFO - eval_result: {'eval_loss': 1.374396562576294, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8408451676368713, 'eval_AP': 0.7678556251368784, 'eval_MCC': 0.0, 'eval_NDCG': 0.9312407309096694, 'eval_runtime': 3.3191, 'eval_samples_per_second': 24.103, 'eval_steps_per_second': 1.205, 'epoch': 6.0}
[36m(trainable pid=124740)[0m 2025-06-17 22:44:28,688 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
2025-06-17 22:44:29,063 - INFO - Cleaning up trial a21a2597
2025-06-17 22:44:29,063 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-42-49/trainable_a21a2597_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-17_22-42-51
2025-06-17 22:44:29,063 - INFO - Cleaning up trial 910bd266
2025-06-17 22:44:29,063 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-42-49/trainable_910bd266_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-17_22-42-57
2025-06-17 22:44:29,063 - INFO - Current best: ccb1ad12 with eval_kappa : 0.13439635535307526 at iteration 1
2025-06-17 22:44:29,071	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-42-49' in 0.0061s.

[36m(trainable pid=124740)[0m {'train_runtime': 76.0811, 'train_samples_per_second': 22.147, 'train_steps_per_second': 1.117, 'train_loss': 1.3252305199118222, 'epoch': 5.0}
[36m(trainable pid=124740)[0m STATE at ending of training  :  TrainerState(epoch=5.0, global_step=85, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=443112038658480.0, log_history=[{'loss': 1.6178, 'grad_norm': 6.72487735748291, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0, 'step': 17}, {'loss': 1.3433, 'grad_norm': 5.745023727416992, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0, 'step': 34}, {'loss': 1.2575, 'grad_norm': 8.995421409606934, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0, 'step': 51}, {'loss': 1.212, 'grad_norm': 5.706791877746582, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0, 'step': 68}, {'loss': 1.1955, 'grad_norm': 8.666642189025879, 'learning_rate': 0.0, 'epoch': 5.0, 'step': 85}, {'train_runtime': 76.0811, 'train_samples_per_second': 22.147, 'train_steps_per_second': 1.117, 'total_flos': 443112038658480.0, 'train_loss': 1.3252305199118222, 'epoch': 5.0, 'step': 85}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=124740)[0m {'loss': 1.1955, 'grad_norm': 8.666642189025879, 'learning_rate': 0.0, 'epoch': 5.0}
[36m(trainable pid=124538)[0m {'loss': 1.4799, 'grad_norm': 6.279058933258057, 'learning_rate': 0.0, 'epoch': 6.0}
[36m(trainable pid=124538)[0m STATE at ending of training  :  TrainerState(epoch=6.0, global_step=102, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=531779668196784.0, log_history=[{'loss': 2.3761, 'grad_norm': 20.01381492614746, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0, 'step': 17}, {'loss': 1.8548, 'grad_norm': 15.289421081542969, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0, 'step': 34}, {'loss': 1.6255, 'grad_norm': 6.047595500946045, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0, 'step': 51}, {'loss': 1.5537, 'grad_norm': 6.956624507904053, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0, 'step': 68}, {'loss': 1.5092, 'grad_norm': 12.563606262207031, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0, 'step': 85}, {'loss': 1.4799, 'grad_norm': 6.279058933258057, 'learning_rate': 0.0, 'epoch': 6.0, 'step': 102}, {'train_runtime': 83.3339, 'train_samples_per_second': 24.264, 'train_steps_per_second': 1.224, 'total_flos': 531779668196784.0, 'train_loss': 1.7332132002886604, 'epoch': 6.0, 'step': 102}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=124740)[0m {'eval_loss': 1.0895644426345825, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9143107533454895, 'eval_AP': 0.7972930620750831, 'eval_MCC': 0.0, 'eval_NDCG': 0.9469471817624291, 'eval_runtime': 4.0056, 'eval_samples_per_second': 19.972, 'eval_steps_per_second': 0.999, 'epoch': 5.0}

Trial trainable_910bd266 finished iteration 1 at 2025-06-17 22:44:28. Total running time: 1min 37s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_910bd266 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    84.7285 â”‚
â”‚ time_total_s                        84.7285 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     5 â”‚
â”‚ eval_AP                             0.79729 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.94695 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.08956 â”‚
â”‚ eval_optim_threshold                0.91431 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         4.0056 â”‚
â”‚ eval_samples_per_second              19.972 â”‚
â”‚ eval_steps_per_second                 0.999 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_910bd266 completed after 1 iterations at 2025-06-17 22:44:28. Total running time: 1min 37s

Trial trainable_a21a2597 finished iteration 1 at 2025-06-17 22:44:29. Total running time: 1min 38s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_a21a2597 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    91.5955 â”‚
â”‚ time_total_s                        91.5955 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     6 â”‚
â”‚ eval_AP                             0.76786 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.93124 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                            1.3744 â”‚
â”‚ eval_optim_threshold                0.84085 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.3191 â”‚
â”‚ eval_samples_per_second              24.103 â”‚
â”‚ eval_steps_per_second                 1.205 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_a21a2597 completed after 1 iterations at 2025-06-17 22:44:29. Total running time: 1min 38s

Trial status: 3 TERMINATED
Current time: 2025-06-17 22:44:29. Total running time: 1min 38s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_a21a2597   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1            91.5955      1.3744      0.848921            0.7375       0        â”‚
â”‚ trainable_910bd266   TERMINATED        6.09408       4.55539e-06         0.123031                    5        1            84.7285      1.08956     0.848921            0.7375       0        â”‚
â”‚ trainable_ccb1ad12   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.8714      0.927793    0.861314            0.7625       0.134396 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯2025-06-17 22:44:29,078 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x76b289e34310>
2025-06-17 22:44:29,078 - INFO - Best trial : trainable_ccb1ad12
2025-06-17 22:44:29,078 - INFO - Best config : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-17 22:44:29,078 - INFO - Best trial after optimization: {'eval_loss': 0.9277929067611694, 'eval_f1': 0.8613138686131386, 'eval_accuracy': 0.7625, 'eval_kappa': 0.13439635535307526, 'eval_precision': 0.7564102564102564, 'eval_recall': 1.0, 'eval_optim_threshold': 0.984454333782196, 'eval_AP': 0.8192761581517203, 'eval_MCC': 0.26840095387139007, 'eval_NDCG': 0.9098899303569317, 'eval_runtime': 3.3839, 'eval_samples_per_second': 23.642, 'eval_steps_per_second': 1.182, 'epoch': 3.0, 'timestamp': 1750193018, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': 'ccb1ad12', 'date': '2025-06-17_22-43-38', 'time_this_iter_s': 27.871413946151733, 'time_total_s': 27.871413946151733, 'pid': 125133, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 27.871413946151733, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512'}
2025-06-17 22:44:29,102 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   1.374397  0.848921  ...                        6  a21a2597
1   1.089564  0.848921  ...                        5  910bd266
2   0.927793  0.861314  ...                        3  ccb1ad12

[3 rows x 32 columns]
[36m(trainable pid=124740)[0m /home/leandre/.local/share/uv/python/cpython-3.11.11-linux-x86_64-gnu/lib/python3.11/multiprocessing/resource_tracker.py:123: UserWarning: resource_tracker: process died unexpectedly, relaunching.  Some resources might leak.
[36m(trainable pid=124740)[0m   warnings.warn('resource_tracker: process died unexpectedly, '
[36m(trainable pid=124740)[0m Traceback (most recent call last):
[36m(trainable pid=124740)[0m   File "/home/leandre/.local/share/uv/python/cpython-3.11.11-linux-x86_64-gnu/lib/python3.11/multiprocessing/resource_tracker.py", line 239, in main
[36m(trainable pid=124740)[0m     cache[rtype].remove(name)
[36m(trainable pid=124740)[0m KeyError: '/loky-124740-5tftiiop'
2025-06-17 22:44:29,322 - INFO - Trial comparison plot saved
2025-06-17 22:44:29,332 - INFO - Best Hyperparameters after HPO : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}


[36m(trainable pid=124538)[0m 2025-06-17 22:44:29,043 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(trainable pid=124538)[0m {'train_runtime': 83.3339, 'train_samples_per_second': 24.264, 'train_steps_per_second': 1.224, 'train_loss': 1.7332132002886604, 'epoch': 6.0}
[36m(trainable pid=124538)[0m {'eval_loss': 1.374396562576294, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8408451676368713, 'eval_AP': 0.7678556251368784, 'eval_MCC': 0.0, 'eval_NDCG': 0.9312407309096694, 'eval_runtime': 3.3191, 'eval_samples_per_second': 24.103, 'eval_steps_per_second': 1.205, 'epoch': 6.0}
2025-06-17 22:44:38,563 - INFO - Namespace(config='configs/train.yaml', hp_config='configs/best_hpo.yaml', fold=0, run=0, gpu='2', model_name='microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext', nb_opt_negs=100, loss='BCE', with_title=True, with_keywords=False, best_metric=None)
2025-06-17 22:44:38,565 - INFO - {'model_name': 'bert-base-uncased', 'fold': 0, 'run': 0, 'output_dir': 'outputs/checkpoints', 'best_metric': 'eval_kappa', 'loss_type': 'BCE', 'nb_optional_negs': 100, 'with_title': True, 'with_keywords': False, 'default_hyperparameters': {'learning_rate': 'None', 'num_train_epochs': 'None', 'pos_weight': 'None', 'weight_decay': 'None'}}
2025-06-17 22:44:39,367 - INFO - train split size : 337
2025-06-17 22:44:39,367 - INFO - dev split size : 80
2025-06-17 22:44:39,367 - INFO - test split size : 80
2025-06-17 22:44:39,615 - INFO - 3 datasets tokenized successfully
2025-06-17 22:44:39,615 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-17 22:44:40,370 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
[2025-06-17 22:44:40,591] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-06-17 22:44:43,374] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
2025-06-17 22:44:43,411 - INFO - training size : 337
2025-06-17 22:44:43,411 - INFO - dev size : 80
2025-06-17 22:44:43,411 - INFO - test size : 80
  0%|          | 0/12 [00:00<?, ?it/s]  8%|â–Š         | 1/12 [00:02<00:26,  2.37s/it] 17%|â–ˆâ–‹        | 2/12 [00:04<00:20,  2.05s/it] 25%|â–ˆâ–ˆâ–Œ       | 3/12 [00:05<00:17,  1.93s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [00:06<00:11,  1.43s/it]                                               33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [00:06<00:11,  1.43s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 5/12 [00:08<00:11,  1.60s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 6/12 [00:10<00:10,  1.68s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 7/12 [00:12<00:08,  1.71s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [00:12<00:05,  1.38s/it]                                               67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [00:12<00:05,  1.38s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 9/12 [00:14<00:04,  1.54s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 10/12 [00:16<00:03,  1.63s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 11/12 [00:18<00:01,  1.68s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:19<00:00,  1.37s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:21<00:00,  1.37s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:21<00:00,  1.37s/it]2025-06-17 22:45:05,093 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:21<00:00,  1.78s/it]
{'loss': 2.1252, 'grad_norm': 4.565028190612793, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
{'loss': 1.3105, 'grad_norm': 7.035609245300293, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
{'loss': 1.053, 'grad_norm': 5.918652534484863, 'learning_rate': 0.0, 'epoch': 3.0}
{'train_runtime': 21.4008, 'train_samples_per_second': 47.241, 'train_steps_per_second': 0.561, 'train_loss': 1.4962023496627808, 'epoch': 3.0}
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 22:45:08,408 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.81s/it]
2025-06-17 22:45:08,415 - INFO - Training time : 28.79910717101302
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 22:45:11,948 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:03<00:00,  3.02s/it]
2025-06-17 22:45:11,953 - INFO - Evaluation time : 3.537969625904225
2025-06-17 22:45:11,953 - INFO - Evaluation results on test set: {'eval_loss': 1.0429325103759766, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9412997961044312, 'eval_AP': 0.8044933653485962, 'eval_MCC': 0.0, 'eval_NDCG': 0.946802953362431, 'eval_runtime': 3.5254, 'eval_samples_per_second': 22.693, 'eval_steps_per_second': 0.284, 'epoch': 3.0}
2025-06-17 22:45:11,953 - INFO - Total updates (optimizer steps): 12
2025-06-17 22:45:11,953 - INFO - Avg time / step: 1.783s
2025-06-17 22:45:12,680 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCE_BiomedBERT-abs-ft_fold-1
2025-06-17 22:45:12,680 - INFO - On test Set (with threshold 0.5) : 
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 22:45:16,071 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.88s/it]
2025-06-17 22:45:16,074 - INFO - Raw predictions shape: (80, 1)
2025-06-17 22:45:16,075 - INFO - Raw predictions: [[3.0770183]
 [2.95157  ]
 [2.6799567]
 [3.2569218]
 [3.1007187]
 [3.2981443]
 [2.8920507]
 [2.8600836]
 [3.1833453]
 [2.5331855]]
2025-06-17 22:45:16,075 - INFO - Scores shape: (80,)
2025-06-17 22:45:16,075 - INFO - Scores: [0.9559348  0.9503377  0.9358336  0.962921   0.95692235 0.9643651
 0.94745207 0.94583756 0.9602027  0.92643577]
2025-06-17 22:45:16,075 - INFO - Preds shape: (80,)
2025-06-17 22:45:16,075 - INFO - Preds: [1 1 1 1 1 1 1 1 1 1]
2025-06-17 22:45:16,075 - INFO - Test labels shape: (80,)
2025-06-17 22:45:16,075 - INFO - Test labels: [1, 1, 0, 0, 1, 1, 1, 1, 0, 0]
2025-06-17 22:45:16,075 - INFO - Test split: Dataset({
    features: ['Unnamed: 0', 'title', 'abstract', 'Keywords', 'doi', 'labels'],
    num_rows: 80
})
2025-06-17 22:45:16,075 - INFO - Unique values in predictions: [1]
2025-06-17 22:45:16,076 - INFO - Unique values in labels: [0 1]
2025-06-17 22:45:16,077 - INFO - Confusion matrix:
[[ 0 21]
 [ 0 59]]
2025-06-17 22:45:16,077 - INFO - Confusion matrix: TN=0, FP=21, FN=0, TP=59
2025-06-17 22:45:19,058 - INFO - Metrics: {'f1': 0.8489208633093526, 'recall': 1.0, 'precision': 0.7375, 'accuracy': 0.7375, 'AP': 0.8044933653485962, 'MCC': 0.0, 'NDCG': 0.946802953362431, 'kappa': 0.0, 'TN': 0, 'FP': 21, 'FN': 0, 'TP': 59}
2025-06-17 22:45:19,176 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-17 22:45:19,271 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 22:45:19,271 - INFO - 
On test Set (optimal threshold of 0.9257602691650391 according to cross validation on the training set): 
2025-06-17 22:45:19,272 - INFO - Confusion matrix: TN=5, FP=16, FN=6, TP=53
2025-06-17 22:45:21,985 - INFO - Metrics: {'f1': 0.828125, 'recall': 0.8983050847457628, 'precision': 0.7681159420289855, 'accuracy': 0.725, 'AP': 0.8044933653485962, 'MCC': 0.17427302251634283, 'NDCG': 0.946802953362431, 'kappa': 0.16110581506196386, 'TN': 5, 'FP': 16, 'FN': 6, 'TP': 53}
2025-06-17 22:45:22,079 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 22:45:22,079 - INFO - Results for fold 1 : [{'f1': 0.828125, 'recall': 0.8983050847457628, 'precision': 0.7681159420289855, 'accuracy': 0.725, 'AP': 0.8044933653485962, 'MCC': 0.17427302251634283, 'NDCG': 0.946802953362431, 'kappa': 0.16110581506196386, 'TN': 5, 'FP': 16, 'FN': 6, 'TP': 53}]
2025-06-17 22:45:22,402 - INFO - Cleared CUDA cache. Memory allocated: 1.33 GB, Memory reserved: 1.63 GB
2025-06-17 22:45:22,407 - INFO - Metrics stored successfully at /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/metrics/binary_metrics.csv
Model: FacebookAI/roberta-base
2025-06-17 22:45:29,685 - INFO - Namespace(config='configs/hpo.yaml', fold=0, run=0, gpu=None, model_name='FacebookAI/roberta-base', nb_opt_negs=100, n_trials=3, hpo_metric=None, direction=None, loss='BCE', with_title=True, with_keywords=False)
2025-06-17 22:45:29,686 - INFO - {'model_name': 'google-bert/bert-base-uncased', 'num_trials': 20, 'fold': 0, 'hpo_metric': 'eval_kappa', 'direction': 'max', 'loss_type': 'BCE', 'with_title': True, 'with_keywords': False, 'nb_optional_negs': 100}
2025-06-17 22:45:30,189 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
2025-06-17 22:45:30,189 - INFO - 
fold number 1 | run no. 1
2025-06-17 22:45:30,795 - INFO - train split size : 337
2025-06-17 22:45:30,795 - INFO - dev split size : 80
2025-06-17 22:45:30,796 - INFO - test split size : 80
2025-06-17 22:45:31,085 - INFO - 3 datasets tokenized successfully
2025-06-17 22:45:31,148 - INFO - Fold 1 max seq len = 512
2025-06-17 22:45:31,148 - INFO - Starting hyperparameter search for BCE loss
2025-06-17 22:45:32,521	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
2025-06-17 22:45:33,269	INFO tune.py:253 -- Initializing Ray automatically. For cluster usage or custom Ray initialization, call `ray.init(...)` before `tune.run(...)`.
[36m(trainable pid=129724)[0m Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at FacebookAI/roberta-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
[36m(trainable pid=129724)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=129724)[0m 2025-06-17 22:45:41,612 - INFO - pos_weight value in TrainingArguments : 6.828424226204718
[36m(trainable pid=129724)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=129724)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=129926)[0m Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at FacebookAI/roberta-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
[36m(trainable pid=129926)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=129926)[0m 2025-06-17 22:45:48,251 - INFO - pos_weight value in TrainingArguments : 6.094080202241274
[36m(trainable pid=129926)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=129926)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=130384)[0m Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at FacebookAI/roberta-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
[36m(trainable pid=130384)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=130384)[0m 2025-06-17 22:45:54,942 - INFO - pos_weight value in TrainingArguments : 7.183206941666034
[36m(trainable pid=130384)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=130384)[0m   super().__init__(*args, **kwargs)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     trainable_2025-06-17_22-45-33   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-45-33
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-17_22-45-31_169785_127275/artifacts/2025-06-17_22-45-33/trainable_2025-06-17_22-45-33/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-17 22:45:34. Total running time: 0s
Logical resource usage: 0/32 CPUs, 0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_69449904   PENDING         6.82842       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_69449904 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_69449904 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          6.82842 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=129724)[0m [2025-06-17 22:45:41,869] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=129724)[0m [2025-06-17 22:45:44,514] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=129724)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial trainable_97732186 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_97732186 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          6.09408 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=129926)[0m [2025-06-17 22:45:48,667] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=129926)[0m [2025-06-17 22:45:51,406] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=129724)[0m {'loss': 2.6714, 'grad_norm': 15.08804702758789, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}
[36m(trainable pid=129926)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial trainable_43536163 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_43536163 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          7.18321 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=130384)[0m [2025-06-17 22:45:55,207] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=130384)[0m [2025-06-17 22:45:57,870] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=130384)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 3 RUNNING
Current time: 2025-06-17 22:46:04. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_69449904   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ trainable_97732186   RUNNING         6.09408       4.55539e-06         0.123031                    5 â”‚
â”‚ trainable_43536163   RUNNING         7.18321       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=130384)[0m 2025-06-17 22:46:21,196 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=130384)[0m 2025-06-17 22:46:21,201 - INFO - eval_result: {'eval_loss': 0.9083151817321777, 'eval_f1': 0.8923076923076924, 'eval_accuracy': 0.825, 'eval_kappa': 0.4460929772502472, 'eval_precision': 0.8169014084507042, 'eval_recall': 0.9830508474576272, 'eval_optim_threshold': 0.9338665008544922, 'eval_AP': 0.8783985045914158, 'eval_MCC': 0.5068628481276483, 'eval_NDCG': 0.9677008395501939, 'eval_runtime': 3.3124, 'eval_samples_per_second': 24.152, 'eval_steps_per_second': 1.208, 'epoch': 3.0}
[36m(trainable pid=130384)[0m 2025-06-17 22:46:21,506 - INFO - Cleared CUDA cache. Memory allocated: 1.54 GB, Memory reserved: 1.71 GB
2025-06-17 22:46:21,538 - INFO - Cleaning up trial 43536163
2025-06-17 22:46:21,538 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-45-33/trainable_43536163_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512_2025-06-17_22-45-47

[36m(trainable pid=130384)[0m {'loss': 1.7116, 'grad_norm': 7.839216709136963, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
[36m(trainable pid=130384)[0m {'loss': 1.1997, 'grad_norm': 5.9677228927612305, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}[32m [repeated 3x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(trainable pid=130384)[0m {'train_runtime': 19.6815, 'train_samples_per_second': 51.368, 'train_steps_per_second': 2.591, 'train_loss': 1.2485967897901349, 'epoch': 3.0}
[36m(trainable pid=130384)[0m STATE at ending of training  :  TrainerState(epoch=3.0, global_step=51, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=265951500198312.0, log_history=[{'loss': 1.7116, 'grad_norm': 7.839216709136963, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0, 'step': 17}, {'loss': 1.1997, 'grad_norm': 5.9677228927612305, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0, 'step': 34}, {'loss': 0.8346, 'grad_norm': 12.628083229064941, 'learning_rate': 0.0, 'epoch': 3.0, 'step': 51}, {'train_runtime': 19.6815, 'train_samples_per_second': 51.368, 'train_steps_per_second': 2.591, 'total_flos': 265951500198312.0, 'train_loss': 1.2485967897901349, 'epoch': 3.0, 'step': 51}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=130384)[0m {'loss': 0.8346, 'grad_norm': 12.628083229064941, 'learning_rate': 0.0, 'epoch': 3.0}
[36m(trainable pid=130384)[0m {'eval_loss': 0.9083151817321777, 'eval_f1': 0.8923076923076924, 'eval_accuracy': 0.825, 'eval_kappa': 0.4460929772502472, 'eval_precision': 0.8169014084507042, 'eval_recall': 0.9830508474576272, 'eval_optim_threshold': 0.9338665008544922, 'eval_AP': 0.8783985045914158, 'eval_MCC': 0.5068628481276483, 'eval_NDCG': 0.9677008395501939, 'eval_runtime': 3.3124, 'eval_samples_per_second': 24.152, 'eval_steps_per_second': 1.208, 'epoch': 3.0}
[36m(trainable pid=129724)[0m {'loss': 2.3716, 'grad_norm': 8.594364166259766, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0}

Trial trainable_43536163 finished iteration 1 at 2025-06-17 22:46:21. Total running time: 47s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_43536163 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    27.2034 â”‚
â”‚ time_total_s                        27.2034 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     3 â”‚
â”‚ eval_AP                              0.8784 â”‚
â”‚ eval_MCC                            0.50686 â”‚
â”‚ eval_NDCG                            0.9677 â”‚
â”‚ eval_accuracy                         0.825 â”‚
â”‚ eval_f1                             0.89231 â”‚
â”‚ eval_kappa                          0.44609 â”‚
â”‚ eval_loss                           0.90832 â”‚
â”‚ eval_optim_threshold                0.93387 â”‚
â”‚ eval_precision                       0.8169 â”‚
â”‚ eval_recall                         0.98305 â”‚
â”‚ eval_runtime                         3.3124 â”‚
â”‚ eval_samples_per_second              24.152 â”‚
â”‚ eval_steps_per_second                 1.208 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_43536163 completed after 1 iterations at 2025-06-17 22:46:21. Total running time: 47s

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 22:46:34. Total running time: 1min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_69449904   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_97732186   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_43536163   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.2034      0.908315    0.892308             0.825       0.446093 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=129724)[0m {'loss': 2.2629, 'grad_norm': 14.992868423461914, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0}[32m [repeated 2x across cluster][0m
[36m(trainable pid=129724)[0m {'loss': 2.13, 'grad_norm': 21.1624813079834, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0}[32m [repeated 2x across cluster][0m
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 22:47:04. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_69449904   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_97732186   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_43536163   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.2034      0.908315    0.892308             0.825       0.446093 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=129724)[0m 2025-06-17 22:47:11,299 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=129724)[0m 2025-06-17 22:47:11,304 - INFO - eval_result: {'eval_loss': 2.532104015350342, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.634418785572052, 'eval_AP': 0.7324006777189755, 'eval_MCC': 0.0, 'eval_NDCG': 0.8939726510473104, 'eval_runtime': 4.0091, 'eval_samples_per_second': 19.954, 'eval_steps_per_second': 0.998, 'epoch': 6.0}
2025-06-17 22:47:11,646 - INFO - Cleaning up trial 69449904
2025-06-17 22:47:11,646 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-45-33/trainable_69449904_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-17_22-45-34
2025-06-17 22:47:11,646 - INFO - Current best: 43536163 with eval_kappa : 0.4460929772502472 at iteration 1
[36m(trainable pid=129724)[0m 2025-06-17 22:47:11,616 - INFO - Cleared CUDA cache. Memory allocated: 1.54 GB, Memory reserved: 1.71 GB
[36m(trainable pid=129926)[0m 2025-06-17 22:47:11,803 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=129926)[0m 2025-06-17 22:47:11,809 - INFO - eval_result: {'eval_loss': 1.0891444683074951, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8645580410957336, 'eval_AP': 0.8355604674345383, 'eval_MCC': 0.0, 'eval_NDCG': 0.9544978938539117, 'eval_runtime': 3.2533, 'eval_samples_per_second': 24.59, 'eval_steps_per_second': 1.23, 'epoch': 5.0}
2025-06-17 22:47:12,289 - INFO - Cleaning up trial 97732186
2025-06-17 22:47:12,289 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-45-33/trainable_97732186_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-17_22-45-41
2025-06-17 22:47:12,289 - INFO - Cleaning up trial 69449904
2025-06-17 22:47:12,290 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-45-33/trainable_69449904_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-17_22-45-34
2025-06-17 22:47:12,290 - INFO - Current best: 43536163 with eval_kappa : 0.4460929772502472 at iteration 1
2025-06-17 22:47:12,298	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-45-33' in 0.0063s.

[36m(trainable pid=129724)[0m {'train_runtime': 82.4361, 'train_samples_per_second': 24.528, 'train_steps_per_second': 1.237, 'train_loss': 2.341534558464499, 'epoch': 6.0}
[36m(trainable pid=129724)[0m STATE at ending of training  :  TrainerState(epoch=6.0, global_step=102, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=531954388813224.0, log_history=[{'loss': 2.6714, 'grad_norm': 15.08804702758789, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0, 'step': 17}, {'loss': 2.5548, 'grad_norm': 10.825754165649414, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0, 'step': 34}, {'loss': 2.3716, 'grad_norm': 8.594364166259766, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0, 'step': 51}, {'loss': 2.2629, 'grad_norm': 14.992868423461914, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0, 'step': 68}, {'loss': 2.13, 'grad_norm': 21.1624813079834, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0, 'step': 85}, {'loss': 2.0585, 'grad_norm': 12.32446002960205, 'learning_rate': 0.0, 'epoch': 6.0, 'step': 102}, {'train_runtime': 82.4361, 'train_samples_per_second': 24.528, 'train_steps_per_second': 1.237, 'total_flos': 531954388813224.0, 'train_loss': 2.341534558464499, 'epoch': 6.0, 'step': 102}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=129724)[0m {'loss': 2.0585, 'grad_norm': 12.32446002960205, 'learning_rate': 0.0, 'epoch': 6.0}[32m [repeated 2x across cluster][0m
[36m(trainable pid=129926)[0m STATE at ending of training  :  TrainerState(epoch=5.0, global_step=85, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=443286759274920.0, log_history=[{'loss': 2.5053, 'grad_norm': 15.90577507019043, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0, 'step': 17}, {'loss': 1.9368, 'grad_norm': 12.01742172241211, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0, 'step': 34}, {'loss': 1.4292, 'grad_norm': 8.361722946166992, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0, 'step': 51}, {'loss': 1.3474, 'grad_norm': 8.040102005004883, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0, 'step': 68}, {'loss': 1.3245, 'grad_norm': 8.79053783416748, 'learning_rate': 0.0, 'epoch': 5.0, 'step': 85}, {'train_runtime': 76.6628, 'train_samples_per_second': 21.979, 'train_steps_per_second': 1.109, 'total_flos': 443286759274920.0, 'train_loss': 1.7086354648365694, 'epoch': 5.0, 'step': 85}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=129724)[0m {'eval_loss': 2.532104015350342, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.634418785572052, 'eval_AP': 0.7324006777189755, 'eval_MCC': 0.0, 'eval_NDCG': 0.8939726510473104, 'eval_runtime': 4.0091, 'eval_samples_per_second': 19.954, 'eval_steps_per_second': 0.998, 'epoch': 6.0}

Trial trainable_69449904 finished iteration 1 at 2025-06-17 22:47:11. Total running time: 1min 37s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_69449904 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    90.6418 â”‚
â”‚ time_total_s                        90.6418 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     6 â”‚
â”‚ eval_AP                              0.7324 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.89397 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                            2.5321 â”‚
â”‚ eval_optim_threshold                0.63442 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         4.0091 â”‚
â”‚ eval_samples_per_second              19.954 â”‚
â”‚ eval_steps_per_second                 0.998 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_69449904 completed after 1 iterations at 2025-06-17 22:47:11. Total running time: 1min 37s

Trial trainable_97732186 finished iteration 1 at 2025-06-17 22:47:12. Total running time: 1min 37s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_97732186 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    84.6692 â”‚
â”‚ time_total_s                        84.6692 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     5 â”‚
â”‚ eval_AP                             0.83556 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                            0.9545 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.08914 â”‚
â”‚ eval_optim_threshold                0.86456 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.2533 â”‚
â”‚ eval_samples_per_second               24.59 â”‚
â”‚ eval_steps_per_second                  1.23 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_97732186 completed after 1 iterations at 2025-06-17 22:47:12. Total running time: 1min 37s

Trial status: 3 TERMINATED
Current time: 2025-06-17 22:47:12. Total running time: 1min 37s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_69449904   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1            90.6418      2.5321      0.848921            0.7375       0        â”‚
â”‚ trainable_97732186   TERMINATED        6.09408       4.55539e-06         0.123031                    5        1            84.6691      1.08914     0.848921            0.7375       0        â”‚
â”‚ trainable_43536163   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.2034      0.908315    0.892308            0.825        0.446093 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯2025-06-17 22:47:12,305 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x717acdbbca50>
2025-06-17 22:47:12,305 - INFO - Best trial : trainable_43536163
2025-06-17 22:47:12,305 - INFO - Best config : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-17 22:47:12,305 - INFO - Best trial after optimization: {'eval_loss': 0.9083151817321777, 'eval_f1': 0.8923076923076924, 'eval_accuracy': 0.825, 'eval_kappa': 0.4460929772502472, 'eval_precision': 0.8169014084507042, 'eval_recall': 0.9830508474576272, 'eval_optim_threshold': 0.9338665008544922, 'eval_AP': 0.8783985045914158, 'eval_MCC': 0.5068628481276483, 'eval_NDCG': 0.9677008395501939, 'eval_runtime': 3.3124, 'eval_samples_per_second': 24.152, 'eval_steps_per_second': 1.208, 'epoch': 3.0, 'timestamp': 1750193181, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '43536163', 'date': '2025-06-17_22-46-21', 'time_this_iter_s': 27.203444719314575, 'time_total_s': 27.203444719314575, 'pid': 130384, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 27.203444719314575, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512'}
2025-06-17 22:47:12,329 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   2.532104  0.848921  ...                        6  69449904
1   1.089144  0.848921  ...                        5  97732186
2   0.908315  0.892308  ...                        3  43536163

[3 rows x 32 columns]
2025-06-17 22:47:12,449 - INFO - Trial comparison plot saved
2025-06-17 22:47:12,466 - INFO - Best Hyperparameters after HPO : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}


[36m(trainable pid=129926)[0m 2025-06-17 22:47:12,256 - INFO - Cleared CUDA cache. Memory allocated: 1.54 GB, Memory reserved: 1.71 GB
[36m(trainable pid=129926)[0m {'train_runtime': 76.6628, 'train_samples_per_second': 21.979, 'train_steps_per_second': 1.109, 'train_loss': 1.7086354648365694, 'epoch': 5.0}
[36m(trainable pid=129926)[0m {'loss': 1.3245, 'grad_norm': 8.79053783416748, 'learning_rate': 0.0, 'epoch': 5.0}
[36m(trainable pid=129926)[0m {'eval_loss': 1.0891444683074951, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8645580410957336, 'eval_AP': 0.8355604674345383, 'eval_MCC': 0.0, 'eval_NDCG': 0.9544978938539117, 'eval_runtime': 3.2533, 'eval_samples_per_second': 24.59, 'eval_steps_per_second': 1.23, 'epoch': 5.0}
2025-06-17 22:47:21,354 - INFO - Namespace(config='configs/train.yaml', hp_config='configs/best_hpo.yaml', fold=0, run=0, gpu='2', model_name='FacebookAI/roberta-base', nb_opt_negs=100, loss='BCE', with_title=True, with_keywords=False, best_metric=None)
2025-06-17 22:47:21,355 - INFO - {'model_name': 'bert-base-uncased', 'fold': 0, 'run': 0, 'output_dir': 'outputs/checkpoints', 'best_metric': 'eval_kappa', 'loss_type': 'BCE', 'nb_optional_negs': 100, 'with_title': True, 'with_keywords': False, 'default_hyperparameters': {'learning_rate': 'None', 'num_train_epochs': 'None', 'pos_weight': 'None', 'weight_decay': 'None'}}
2025-06-17 22:47:22,259 - INFO - train split size : 337
2025-06-17 22:47:22,259 - INFO - dev split size : 80
2025-06-17 22:47:22,259 - INFO - test split size : 80
2025-06-17 22:47:22,550 - INFO - 3 datasets tokenized successfully
2025-06-17 22:47:22,550 - INFO - Final training...
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at FacebookAI/roberta-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-17 22:47:22,888 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
[2025-06-17 22:47:23,144] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-06-17 22:47:25,813] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
2025-06-17 22:47:25,850 - INFO - training size : 337
2025-06-17 22:47:25,850 - INFO - dev size : 80
2025-06-17 22:47:25,850 - INFO - test size : 80
  0%|          | 0/12 [00:00<?, ?it/s]  8%|â–Š         | 1/12 [00:02<00:25,  2.31s/it] 17%|â–ˆâ–‹        | 2/12 [00:04<00:20,  2.01s/it] 25%|â–ˆâ–ˆâ–Œ       | 3/12 [00:05<00:17,  1.90s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [00:06<00:11,  1.41s/it]                                               33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [00:06<00:11,  1.41s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 5/12 [00:08<00:11,  1.57s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 6/12 [00:10<00:09,  1.66s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 7/12 [00:11<00:08,  1.69s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [00:12<00:05,  1.37s/it]                                               67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [00:12<00:05,  1.37s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 9/12 [00:14<00:04,  1.52s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 10/12 [00:16<00:03,  1.60s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 11/12 [00:18<00:01,  1.66s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:18<00:00,  1.36s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:21<00:00,  1.36s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:21<00:00,  1.36s/it]2025-06-17 22:47:47,665 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:21<00:00,  1.79s/it]
{'loss': 2.1899, 'grad_norm': 3.264788866043091, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
{'loss': 1.5785, 'grad_norm': 7.8731842041015625, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
{'loss': 1.4307, 'grad_norm': 3.906820774078369, 'learning_rate': 0.0, 'epoch': 3.0}
{'train_runtime': 21.5291, 'train_samples_per_second': 46.96, 'train_steps_per_second': 0.557, 'train_loss': 1.7330054839452107, 'epoch': 3.0}
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 22:47:50,986 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.83s/it]
2025-06-17 22:47:50,992 - INFO - Training time : 28.442168321926147
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 22:47:54,271 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.78s/it]
2025-06-17 22:47:54,276 - INFO - Evaluation time : 3.2840550569817424
2025-06-17 22:47:54,276 - INFO - Evaluation results on test set: {'eval_loss': 1.191110610961914, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.886929452419281, 'eval_AP': 0.8766389428733083, 'eval_MCC': 0.0, 'eval_NDCG': 0.9709532714717055, 'eval_runtime': 3.2731, 'eval_samples_per_second': 24.442, 'eval_steps_per_second': 0.306, 'epoch': 3.0}
2025-06-17 22:47:54,276 - INFO - Total updates (optimizer steps): 12
2025-06-17 22:47:54,276 - INFO - Avg time / step: 1.795s
2025-06-17 22:47:55,378 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCE_roberta-base_fold-1
2025-06-17 22:47:55,379 - INFO - On test Set (with threshold 0.5) : 
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 22:47:58,686 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.81s/it]
2025-06-17 22:47:58,690 - INFO - Raw predictions shape: (80, 1)
2025-06-17 22:47:58,690 - INFO - Raw predictions: [[2.0206034]
 [2.014564 ]
 [1.8960817]
 [2.016632 ]
 [2.060952 ]
 [2.2014353]
 [1.9647765]
 [2.1910226]
 [1.8554018]
 [1.9003252]]
2025-06-17 22:47:58,690 - INFO - Scores shape: (80,)
2025-06-17 22:47:58,690 - INFO - Scores: [0.88294345 0.8823178  0.8694474  0.8825323  0.8870496  0.90037835
 0.8770489  0.89944047 0.8647601  0.8699283 ]
2025-06-17 22:47:58,690 - INFO - Preds shape: (80,)
2025-06-17 22:47:58,690 - INFO - Preds: [1 1 1 1 1 1 1 1 1 1]
2025-06-17 22:47:58,690 - INFO - Test labels shape: (80,)
2025-06-17 22:47:58,691 - INFO - Test labels: [1, 1, 0, 0, 1, 1, 1, 1, 0, 0]
2025-06-17 22:47:58,691 - INFO - Test split: Dataset({
    features: ['Unnamed: 0', 'title', 'abstract', 'Keywords', 'doi', 'labels'],
    num_rows: 80
})
2025-06-17 22:47:58,691 - INFO - Unique values in predictions: [1]
2025-06-17 22:47:58,691 - INFO - Unique values in labels: [0 1]
2025-06-17 22:47:58,692 - INFO - Confusion matrix:
[[ 0 21]
 [ 0 59]]
2025-06-17 22:47:58,693 - INFO - Confusion matrix: TN=0, FP=21, FN=0, TP=59
2025-06-17 22:48:01,532 - INFO - Metrics: {'f1': 0.8489208633093526, 'recall': 1.0, 'precision': 0.7375, 'accuracy': 0.7375, 'AP': 0.8766389428733083, 'MCC': 0.0, 'NDCG': 0.9709532714717055, 'kappa': 0.0, 'TN': 0, 'FP': 21, 'FN': 0, 'TP': 59}
2025-06-17 22:48:01,643 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-17 22:48:01,734 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 22:48:01,734 - INFO - 
On test Set (optimal threshold of 0.8692460060119629 according to cross validation on the training set): 
2025-06-17 22:48:01,735 - INFO - Confusion matrix: TN=4, FP=17, FN=3, TP=56
2025-06-17 22:48:05,096 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 0.9491525423728814, 'precision': 0.7671232876712328, 'accuracy': 0.75, 'AP': 0.8766389428733083, 'MCC': 0.21742025455279734, 'NDCG': 0.9709532714717055, 'kappa': 0.1778006166495376, 'TN': 4, 'FP': 17, 'FN': 3, 'TP': 56}
2025-06-17 22:48:05,193 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 22:48:05,193 - INFO - Results for fold 1 : [{'f1': 0.8484848484848485, 'recall': 0.9491525423728814, 'precision': 0.7671232876712328, 'accuracy': 0.75, 'AP': 0.8766389428733083, 'MCC': 0.21742025455279734, 'NDCG': 0.9709532714717055, 'kappa': 0.1778006166495376, 'TN': 4, 'FP': 17, 'FN': 3, 'TP': 56}]
2025-06-17 22:48:05,521 - INFO - Cleared CUDA cache. Memory allocated: 1.52 GB, Memory reserved: 1.85 GB
2025-06-17 22:48:05,527 - INFO - Metrics stored successfully at /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/metrics/binary_metrics.csv
Model: dmis-lab/biobert-v1.1
2025-06-17 22:48:12,892 - INFO - Namespace(config='configs/hpo.yaml', fold=0, run=0, gpu=None, model_name='dmis-lab/biobert-v1.1', nb_opt_negs=100, n_trials=3, hpo_metric=None, direction=None, loss='BCE', with_title=True, with_keywords=False)
2025-06-17 22:48:12,893 - INFO - {'model_name': 'google-bert/bert-base-uncased', 'num_trials': 20, 'fold': 0, 'hpo_metric': 'eval_kappa', 'direction': 'max', 'loss_type': 'BCE', 'with_title': True, 'with_keywords': False, 'nb_optional_negs': 100}
2025-06-17 22:48:13,305 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
2025-06-17 22:48:13,305 - INFO - 
fold number 1 | run no. 1
2025-06-17 22:48:13,924 - INFO - train split size : 337
2025-06-17 22:48:13,924 - INFO - dev split size : 80
2025-06-17 22:48:13,924 - INFO - test split size : 80
2025-06-17 22:48:14,170 - INFO - 3 datasets tokenized successfully
2025-06-17 22:48:14,233 - INFO - Fold 1 max seq len = 512
2025-06-17 22:48:14,233 - INFO - Starting hyperparameter search for BCE loss
2025-06-17 22:48:15,655	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
2025-06-17 22:48:16,361	INFO tune.py:253 -- Initializing Ray automatically. For cluster usage or custom Ray initialization, call `ray.init(...)` before `tune.run(...)`.
[36m(trainable pid=134804)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=134804)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=134804)[0m 2025-06-17 22:48:25,030 - INFO - pos_weight value in TrainingArguments : 6.828424226204718
[36m(trainable pid=134804)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=134804)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=135070)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=135070)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=135070)[0m 2025-06-17 22:48:31,386 - INFO - pos_weight value in TrainingArguments : 6.094080202241274
[36m(trainable pid=135070)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=135070)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=135398)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=135398)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=135398)[0m 2025-06-17 22:48:37,640 - INFO - pos_weight value in TrainingArguments : 7.183206941666034
[36m(trainable pid=135398)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=135398)[0m   super().__init__(*args, **kwargs)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     trainable_2025-06-17_22-48-16   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-48-16
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-17_22-48-14_254988_132355/artifacts/2025-06-17_22-48-16/trainable_2025-06-17_22-48-16/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-17 22:48:17. Total running time: 0s
Logical resource usage: 0/32 CPUs, 0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_37bb44bf   PENDING         6.82842       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_37bb44bf started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_37bb44bf config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          6.82842 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=134804)[0m [2025-06-17 22:48:25,264] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=134804)[0m [2025-06-17 22:48:28,045] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=134804)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial trainable_24c71108 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_24c71108 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          6.09408 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=135070)[0m [2025-06-17 22:48:31,760] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=135070)[0m [2025-06-17 22:48:34,682] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=135070)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=134804)[0m {'loss': 2.0817, 'grad_norm': 18.64299201965332, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}

Trial trainable_22f2c6da started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_22f2c6da config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          7.18321 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=135398)[0m [2025-06-17 22:48:37,863] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=135398)[0m [2025-06-17 22:48:40,602] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=135398)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 3 RUNNING
Current time: 2025-06-17 22:48:47. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_37bb44bf   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ trainable_24c71108   RUNNING         6.09408       4.55539e-06         0.123031                    5 â”‚
â”‚ trainable_22f2c6da   RUNNING         7.18321       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=135398)[0m 2025-06-17 22:49:04,395 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=135398)[0m 2025-06-17 22:49:04,401 - INFO - eval_result: {'eval_loss': 0.899509072303772, 'eval_f1': 0.8888888888888888, 'eval_accuracy': 0.825, 'eval_kappa': 0.48482060717571296, 'eval_precision': 0.835820895522388, 'eval_recall': 0.9491525423728814, 'eval_optim_threshold': 0.9557316899299622, 'eval_AP': 0.9592985424417432, 'eval_MCC': 0.5073011940385046, 'eval_NDCG': 0.9913884823256419, 'eval_runtime': 3.3752, 'eval_samples_per_second': 23.702, 'eval_steps_per_second': 1.185, 'epoch': 3.0}
[36m(trainable pid=135398)[0m 2025-06-17 22:49:04,833 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
2025-06-17 22:49:04,859 - INFO - Cleaning up trial 22f2c6da
2025-06-17 22:49:04,859 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-48-16/trainable_22f2c6da_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512_2025-06-17_22-48-30

[36m(trainable pid=135398)[0m {'loss': 1.6355, 'grad_norm': 3.475050926208496, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
[36m(trainable pid=135398)[0m {'loss': 0.7221, 'grad_norm': 1.7614480257034302, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}[32m [repeated 3x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(trainable pid=135398)[0m {'train_runtime': 19.9593, 'train_samples_per_second': 50.653, 'train_steps_per_second': 2.555, 'train_loss': 0.9208488090365541, 'epoch': 3.0}
[36m(trainable pid=135398)[0m STATE at ending of training  :  TrainerState(epoch=3.0, global_step=51, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=266002888614912.0, log_history=[{'loss': 1.6355, 'grad_norm': 3.475050926208496, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0, 'step': 17}, {'loss': 0.7221, 'grad_norm': 1.7614480257034302, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0, 'step': 34}, {'loss': 0.405, 'grad_norm': 14.534883499145508, 'learning_rate': 0.0, 'epoch': 3.0, 'step': 51}, {'train_runtime': 19.9593, 'train_samples_per_second': 50.653, 'train_steps_per_second': 2.555, 'total_flos': 266002888614912.0, 'train_loss': 0.9208488090365541, 'epoch': 3.0, 'step': 51}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=135398)[0m {'loss': 0.405, 'grad_norm': 14.534883499145508, 'learning_rate': 0.0, 'epoch': 3.0}
[36m(trainable pid=135398)[0m {'eval_loss': 0.899509072303772, 'eval_f1': 0.8888888888888888, 'eval_accuracy': 0.825, 'eval_kappa': 0.48482060717571296, 'eval_precision': 0.835820895522388, 'eval_recall': 0.9491525423728814, 'eval_optim_threshold': 0.9557316899299622, 'eval_AP': 0.9592985424417432, 'eval_MCC': 0.5073011940385046, 'eval_NDCG': 0.9913884823256419, 'eval_runtime': 3.3752, 'eval_samples_per_second': 23.702, 'eval_steps_per_second': 1.185, 'epoch': 3.0}

Trial trainable_22f2c6da finished iteration 1 at 2025-06-17 22:49:04. Total running time: 47s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_22f2c6da result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    28.0423 â”‚
â”‚ time_total_s                        28.0423 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     3 â”‚
â”‚ eval_AP                              0.9593 â”‚
â”‚ eval_MCC                             0.5073 â”‚
â”‚ eval_NDCG                           0.99139 â”‚
â”‚ eval_accuracy                         0.825 â”‚
â”‚ eval_f1                             0.88889 â”‚
â”‚ eval_kappa                          0.48482 â”‚
â”‚ eval_loss                           0.89951 â”‚
â”‚ eval_optim_threshold                0.95573 â”‚
â”‚ eval_precision                      0.83582 â”‚
â”‚ eval_recall                         0.94915 â”‚
â”‚ eval_runtime                         3.3752 â”‚
â”‚ eval_samples_per_second              23.702 â”‚
â”‚ eval_steps_per_second                 1.185 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_22f2c6da completed after 1 iterations at 2025-06-17 22:49:04. Total running time: 47s
[36m(trainable pid=135070)[0m {'loss': 1.5674, 'grad_norm': 5.107157230377197, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0}

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 22:49:17. Total running time: 1min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_37bb44bf   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_24c71108   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_22f2c6da   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            28.0423      0.899509    0.888889             0.825       0.484821 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=135070)[0m {'loss': 1.3586, 'grad_norm': 5.521860122680664, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0}[32m [repeated 2x across cluster][0m
[36m(trainable pid=135070)[0m {'loss': 1.2799, 'grad_norm': 4.195321083068848, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0}[32m [repeated 2x across cluster][0m
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 22:49:47. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_37bb44bf   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_24c71108   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_22f2c6da   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            28.0423      0.899509    0.888889             0.825       0.484821 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=134804)[0m 2025-06-17 22:49:55,315 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=134804)[0m 2025-06-17 22:49:55,321 - INFO - eval_result: {'eval_loss': 1.7517127990722656, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.7566184997558594, 'eval_AP': 0.8035193956110969, 'eval_MCC': 0.0, 'eval_NDCG': 0.9447565504491273, 'eval_runtime': 3.8076, 'eval_samples_per_second': 21.011, 'eval_steps_per_second': 1.051, 'epoch': 6.0}
[36m(trainable pid=135070)[0m 2025-06-17 22:49:55,298 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=135070)[0m 2025-06-17 22:49:55,304 - INFO - eval_result: {'eval_loss': 1.1548688411712646, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9016218781471252, 'eval_AP': 0.775354153527694, 'eval_MCC': 0.0, 'eval_NDCG': 0.934951621403637, 'eval_runtime': 4.0373, 'eval_samples_per_second': 19.815, 'eval_steps_per_second': 0.991, 'epoch': 5.0}
2025-06-17 22:49:55,633 - INFO - Cleaning up trial 24c71108
2025-06-17 22:49:55,634 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-48-16/trainable_24c71108_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-17_22-48-24
2025-06-17 22:49:55,634 - INFO - Current best: 22f2c6da with eval_kappa : 0.48482060717571296 at iteration 1
[36m(trainable pid=134804)[0m 2025-06-17 22:49:55,641 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
2025-06-17 22:49:55,662 - INFO - Cleaning up trial 37bb44bf
2025-06-17 22:49:55,662 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-48-16/trainable_37bb44bf_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-17_22-48-17
2025-06-17 22:49:55,662 - INFO - Cleaning up trial 24c71108
2025-06-17 22:49:55,662 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-48-16/trainable_24c71108_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-17_22-48-24
2025-06-17 22:49:55,663 - INFO - Current best: 22f2c6da with eval_kappa : 0.48482060717571296 at iteration 1
2025-06-17 22:49:55,671	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-48-16' in 0.0071s.

[36m(trainable pid=135070)[0m {'train_runtime': 76.2322, 'train_samples_per_second': 22.104, 'train_steps_per_second': 1.115, 'train_loss': 1.5162322773652919, 'epoch': 5.0}
[36m(trainable pid=135070)[0m STATE at ending of training  :  TrainerState(epoch=5.0, global_step=85, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=443338147691520.0, log_history=[{'loss': 2.1267, 'grad_norm': 13.242589950561523, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0, 'step': 17}, {'loss': 1.5674, 'grad_norm': 5.107157230377197, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0, 'step': 34}, {'loss': 1.3586, 'grad_norm': 5.521860122680664, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0, 'step': 51}, {'loss': 1.2799, 'grad_norm': 4.195321083068848, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0, 'step': 68}, {'loss': 1.2485, 'grad_norm': 6.13723087310791, 'learning_rate': 0.0, 'epoch': 5.0, 'step': 85}, {'train_runtime': 76.2322, 'train_samples_per_second': 22.104, 'train_steps_per_second': 1.115, 'total_flos': 443338147691520.0, 'train_loss': 1.5162322773652919, 'epoch': 5.0, 'step': 85}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=135070)[0m {'loss': 1.2485, 'grad_norm': 6.13723087310791, 'learning_rate': 0.0, 'epoch': 5.0}[32m [repeated 2x across cluster][0m
[36m(trainable pid=134804)[0m STATE at ending of training  :  TrainerState(epoch=6.0, global_step=102, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=532005777229824.0, log_history=[{'loss': 2.0817, 'grad_norm': 18.64299201965332, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0, 'step': 17}, {'loss': 1.921, 'grad_norm': 12.622194290161133, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0, 'step': 34}, {'loss': 1.8072, 'grad_norm': 5.1771626472473145, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0, 'step': 51}, {'loss': 1.6956, 'grad_norm': 8.924012184143066, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0, 'step': 68}, {'loss': 1.6648, 'grad_norm': 15.943633079528809, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0, 'step': 85}, {'loss': 1.6522, 'grad_norm': 8.94699764251709, 'learning_rate': 0.0, 'epoch': 6.0, 'step': 102}, {'train_runtime': 82.9978, 'train_samples_per_second': 24.362, 'train_steps_per_second': 1.229, 'total_flos': 532005777229824.0, 'train_loss': 1.8037523568845262, 'epoch': 6.0, 'step': 102}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=134804)[0m {'eval_loss': 1.7517127990722656, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.7566184997558594, 'eval_AP': 0.8035193956110969, 'eval_MCC': 0.0, 'eval_NDCG': 0.9447565504491273, 'eval_runtime': 3.8076, 'eval_samples_per_second': 21.011, 'eval_steps_per_second': 1.051, 'epoch': 6.0}

Trial trainable_24c71108 finished iteration 1 at 2025-06-17 22:49:55. Total running time: 1min 38s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_24c71108 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    85.1354 â”‚
â”‚ time_total_s                        85.1354 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     5 â”‚
â”‚ eval_AP                             0.77535 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.93495 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.15487 â”‚
â”‚ eval_optim_threshold                0.90162 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         4.0373 â”‚
â”‚ eval_samples_per_second              19.815 â”‚
â”‚ eval_steps_per_second                 0.991 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_24c71108 completed after 1 iterations at 2025-06-17 22:49:55. Total running time: 1min 38s

Trial trainable_37bb44bf finished iteration 1 at 2025-06-17 22:49:55. Total running time: 1min 38s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_37bb44bf result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    91.4887 â”‚
â”‚ time_total_s                        91.4887 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     6 â”‚
â”‚ eval_AP                             0.80352 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.94476 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.75171 â”‚
â”‚ eval_optim_threshold                0.75662 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.8076 â”‚
â”‚ eval_samples_per_second              21.011 â”‚
â”‚ eval_steps_per_second                 1.051 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_37bb44bf completed after 1 iterations at 2025-06-17 22:49:55. Total running time: 1min 38s

Trial status: 3 TERMINATED
Current time: 2025-06-17 22:49:55. Total running time: 1min 38s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_37bb44bf   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1            91.4887      1.75171     0.848921            0.7375       0        â”‚
â”‚ trainable_24c71108   TERMINATED        6.09408       4.55539e-06         0.123031                    5        1            85.1354      1.15487     0.848921            0.7375       0        â”‚
â”‚ trainable_22f2c6da   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            28.0423      0.899509    0.888889            0.825        0.484821 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯2025-06-17 22:49:55,677 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x7c20a960dd50>
2025-06-17 22:49:55,677 - INFO - Best trial : trainable_22f2c6da
2025-06-17 22:49:55,678 - INFO - Best config : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-17 22:49:55,678 - INFO - Best trial after optimization: {'eval_loss': 0.899509072303772, 'eval_f1': 0.8888888888888888, 'eval_accuracy': 0.825, 'eval_kappa': 0.48482060717571296, 'eval_precision': 0.835820895522388, 'eval_recall': 0.9491525423728814, 'eval_optim_threshold': 0.9557316899299622, 'eval_AP': 0.9592985424417432, 'eval_MCC': 0.5073011940385046, 'eval_NDCG': 0.9913884823256419, 'eval_runtime': 3.3752, 'eval_samples_per_second': 23.702, 'eval_steps_per_second': 1.185, 'epoch': 3.0, 'timestamp': 1750193344, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '22f2c6da', 'date': '2025-06-17_22-49-04', 'time_this_iter_s': 28.042279958724976, 'time_total_s': 28.042279958724976, 'pid': 135398, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 28.042279958724976, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512'}
2025-06-17 22:49:55,699 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   1.751713  0.848921  ...                        6  37bb44bf
1   1.154869  0.848921  ...                        5  24c71108
2   0.899509  0.888889  ...                        3  22f2c6da

[3 rows x 32 columns]
2025-06-17 22:49:55,846 - INFO - Trial comparison plot saved
2025-06-17 22:49:55,856 - INFO - Best Hyperparameters after HPO : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}


[36m(trainable pid=135070)[0m 2025-06-17 22:49:55,613 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(trainable pid=134804)[0m {'train_runtime': 82.9978, 'train_samples_per_second': 24.362, 'train_steps_per_second': 1.229, 'train_loss': 1.8037523568845262, 'epoch': 6.0}
[36m(trainable pid=134804)[0m {'loss': 1.6522, 'grad_norm': 8.94699764251709, 'learning_rate': 0.0, 'epoch': 6.0}
[36m(trainable pid=135070)[0m {'eval_loss': 1.1548688411712646, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9016218781471252, 'eval_AP': 0.775354153527694, 'eval_MCC': 0.0, 'eval_NDCG': 0.934951621403637, 'eval_runtime': 4.0373, 'eval_samples_per_second': 19.815, 'eval_steps_per_second': 0.991, 'epoch': 5.0}
2025-06-17 22:50:04,809 - INFO - Namespace(config='configs/train.yaml', hp_config='configs/best_hpo.yaml', fold=0, run=0, gpu='2', model_name='dmis-lab/biobert-v1.1', nb_opt_negs=100, loss='BCE', with_title=True, with_keywords=False, best_metric=None)
2025-06-17 22:50:04,811 - INFO - {'model_name': 'bert-base-uncased', 'fold': 0, 'run': 0, 'output_dir': 'outputs/checkpoints', 'best_metric': 'eval_kappa', 'loss_type': 'BCE', 'nb_optional_negs': 100, 'with_title': True, 'with_keywords': False, 'default_hyperparameters': {'learning_rate': 'None', 'num_train_epochs': 'None', 'pos_weight': 'None', 'weight_decay': 'None'}}
2025-06-17 22:50:05,611 - INFO - train split size : 337
2025-06-17 22:50:05,611 - INFO - dev split size : 80
2025-06-17 22:50:05,611 - INFO - test split size : 80
2025-06-17 22:50:05,858 - INFO - 3 datasets tokenized successfully
2025-06-17 22:50:05,859 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-17 22:50:06,583 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
[2025-06-17 22:50:06,810] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-06-17 22:50:09,574] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
2025-06-17 22:50:09,612 - INFO - training size : 337
2025-06-17 22:50:09,612 - INFO - dev size : 80
2025-06-17 22:50:09,612 - INFO - test size : 80
  0%|          | 0/12 [00:00<?, ?it/s]  8%|â–Š         | 1/12 [00:02<00:25,  2.33s/it] 17%|â–ˆâ–‹        | 2/12 [00:04<00:20,  2.04s/it] 25%|â–ˆâ–ˆâ–Œ       | 3/12 [00:05<00:17,  1.92s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [00:06<00:11,  1.43s/it]                                               33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [00:06<00:11,  1.43s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 5/12 [00:08<00:11,  1.60s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 6/12 [00:10<00:10,  1.67s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 7/12 [00:12<00:08,  1.71s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [00:12<00:05,  1.38s/it]                                               67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [00:12<00:05,  1.38s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 9/12 [00:14<00:04,  1.54s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 10/12 [00:16<00:03,  1.63s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 11/12 [00:18<00:01,  1.67s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:18<00:00,  1.37s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:21<00:00,  1.37s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:21<00:00,  1.37s/it]2025-06-17 22:50:31,177 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:21<00:00,  1.77s/it]
{'loss': 2.3661, 'grad_norm': 6.24912691116333, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
{'loss': 1.3888, 'grad_norm': 6.132571697235107, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
{'loss': 1.1773, 'grad_norm': 5.352928161621094, 'learning_rate': 0.0, 'epoch': 3.0}
{'train_runtime': 21.2852, 'train_samples_per_second': 47.498, 'train_steps_per_second': 0.564, 'train_loss': 1.6440595785776775, 'epoch': 3.0}
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 22:50:34,478 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.79s/it]
2025-06-17 22:50:34,485 - INFO - Training time : 28.62601126905065
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 22:50:37,740 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.73s/it]
2025-06-17 22:50:37,744 - INFO - Evaluation time : 3.259428338962607
2025-06-17 22:50:37,744 - INFO - Evaluation results on test set: {'eval_loss': 1.1006499528884888, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9396123290061951, 'eval_AP': 0.831361754740989, 'eval_MCC': 0.0, 'eval_NDCG': 0.9603233235796276, 'eval_runtime': 3.2474, 'eval_samples_per_second': 24.635, 'eval_steps_per_second': 0.308, 'epoch': 3.0}
2025-06-17 22:50:37,744 - INFO - Total updates (optimizer steps): 12
2025-06-17 22:50:37,744 - INFO - Avg time / step: 1.773s
2025-06-17 22:50:38,457 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCE_biobert-v1_fold-1
2025-06-17 22:50:38,457 - INFO - On test Set (with threshold 0.5) : 
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 22:50:41,936 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.96s/it]
2025-06-17 22:50:41,939 - INFO - Raw predictions shape: (80, 1)
2025-06-17 22:50:41,940 - INFO - Raw predictions: [[2.8405025]
 [2.8532145]
 [2.3960092]
 [2.8674572]
 [2.8827693]
 [2.9099655]
 [2.7191558]
 [2.7027187]
 [2.8295653]
 [2.730592 ]]
2025-06-17 22:50:41,940 - INFO - Scores shape: (80,)
2025-06-17 22:50:41,940 - INFO - Scores: [0.94482565 0.94548464 0.9165225  0.9462141  0.9469881  0.9483369
 0.9381476  0.9371869  0.9442527  0.9388079 ]
2025-06-17 22:50:41,940 - INFO - Preds shape: (80,)
2025-06-17 22:50:41,940 - INFO - Preds: [1 1 1 1 1 1 1 1 1 1]
2025-06-17 22:50:41,940 - INFO - Test labels shape: (80,)
2025-06-17 22:50:41,940 - INFO - Test labels: [1, 1, 0, 0, 1, 1, 1, 1, 0, 0]
2025-06-17 22:50:41,940 - INFO - Test split: Dataset({
    features: ['Unnamed: 0', 'title', 'abstract', 'Keywords', 'doi', 'labels'],
    num_rows: 80
})
2025-06-17 22:50:41,940 - INFO - Unique values in predictions: [1]
2025-06-17 22:50:41,941 - INFO - Unique values in labels: [0 1]
2025-06-17 22:50:41,941 - INFO - Confusion matrix:
[[ 0 21]
 [ 0 59]]
2025-06-17 22:50:41,942 - INFO - Confusion matrix: TN=0, FP=21, FN=0, TP=59
2025-06-17 22:50:44,634 - INFO - Metrics: {'f1': 0.8489208633093526, 'recall': 1.0, 'precision': 0.7375, 'accuracy': 0.7375, 'AP': 0.831361754740989, 'MCC': 0.0, 'NDCG': 0.9603233235796276, 'kappa': 0.0, 'TN': 0, 'FP': 21, 'FN': 0, 'TP': 59}
2025-06-17 22:50:44,746 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-17 22:50:44,840 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 22:50:44,840 - INFO - 
On test Set (optimal threshold of 0.938296914100647 according to cross validation on the training set): 
2025-06-17 22:50:44,841 - INFO - Confusion matrix: TN=10, FP=11, FN=19, TP=40
2025-06-17 22:50:47,801 - INFO - Metrics: {'f1': 0.7272727272727273, 'recall': 0.6779661016949152, 'precision': 0.7843137254901961, 'accuracy': 0.625, 'AP': 0.831361754740989, 'MCC': 0.1410956508006341, 'NDCG': 0.9603233235796276, 'kappa': 0.13731128684399707, 'TN': 10, 'FP': 11, 'FN': 19, 'TP': 40}
2025-06-17 22:50:47,898 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 22:50:47,898 - INFO - Results for fold 1 : [{'f1': 0.7272727272727273, 'recall': 0.6779661016949152, 'precision': 0.7843137254901961, 'accuracy': 0.625, 'AP': 0.831361754740989, 'MCC': 0.1410956508006341, 'NDCG': 0.9603233235796276, 'kappa': 0.13731128684399707, 'TN': 10, 'FP': 11, 'FN': 19, 'TP': 40}]
2025-06-17 22:50:48,221 - INFO - Cleared CUDA cache. Memory allocated: 1.32 GB, Memory reserved: 1.63 GB
2025-06-17 22:50:48,226 - INFO - Metrics stored successfully at /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/metrics/binary_metrics.csv
Model: google-bert/bert-base-uncased
2025-06-17 22:50:55,490 - INFO - Namespace(config='configs/hpo.yaml', fold=0, run=0, gpu=None, model_name='google-bert/bert-base-uncased', nb_opt_negs=100, n_trials=3, hpo_metric=None, direction=None, loss='BCE', with_title=True, with_keywords=False)
2025-06-17 22:50:55,492 - INFO - {'model_name': 'google-bert/bert-base-uncased', 'num_trials': 20, 'fold': 0, 'hpo_metric': 'eval_kappa', 'direction': 'max', 'loss_type': 'BCE', 'with_title': True, 'with_keywords': False, 'nb_optional_negs': 100}
2025-06-17 22:50:55,902 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
2025-06-17 22:50:55,902 - INFO - 
fold number 1 | run no. 1
2025-06-17 22:50:56,514 - INFO - train split size : 337
2025-06-17 22:50:56,514 - INFO - dev split size : 80
2025-06-17 22:50:56,514 - INFO - test split size : 80
2025-06-17 22:50:56,760 - INFO - 3 datasets tokenized successfully
2025-06-17 22:50:56,818 - INFO - Fold 1 max seq len = 512
2025-06-17 22:50:56,819 - INFO - Starting hyperparameter search for BCE loss
2025-06-17 22:50:59,124	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
2025-06-17 22:50:59,784	INFO tune.py:253 -- Initializing Ray automatically. For cluster usage or custom Ray initialization, call `ray.init(...)` before `tune.run(...)`.
[36m(trainable pid=139822)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=139822)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=139822)[0m 2025-06-17 22:51:07,863 - INFO - pos_weight value in TrainingArguments : 6.828424226204718
[36m(trainable pid=139822)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=139822)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=140096)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=140096)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=140096)[0m 2025-06-17 22:51:14,245 - INFO - pos_weight value in TrainingArguments : 6.094080202241274
[36m(trainable pid=140096)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=140096)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=140510)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=140510)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=140510)[0m 2025-06-17 22:51:20,924 - INFO - pos_weight value in TrainingArguments : 7.183206941666034
[36m(trainable pid=140510)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=140510)[0m   super().__init__(*args, **kwargs)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     trainable_2025-06-17_22-50-59   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-50-59
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-17_22-50-56_841087_137446/artifacts/2025-06-17_22-50-59/trainable_2025-06-17_22-50-59/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-17 22:51:01. Total running time: 0s
Logical resource usage: 0/32 CPUs, 0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_22316ee3   PENDING         6.82842       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_22316ee3 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_22316ee3 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          6.82842 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=139822)[0m [2025-06-17 22:51:08,101] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=139822)[0m [2025-06-17 22:51:10,990] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=139822)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial trainable_c892ccf6 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_c892ccf6 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          6.09408 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=140096)[0m [2025-06-17 22:51:14,610] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=140096)[0m [2025-06-17 22:51:17,268] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=140096)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=139822)[0m {'loss': 2.9009, 'grad_norm': 40.50669860839844, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}

Trial trainable_c72de8a1 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_c72de8a1 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          7.18321 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=140510)[0m [2025-06-17 22:51:21,151] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=140510)[0m [2025-06-17 22:51:23,780] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=140510)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=140510)[0m {'loss': 1.943, 'grad_norm': 4.659440994262695, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}

Trial status: 3 RUNNING
Current time: 2025-06-17 22:51:31. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_22316ee3   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ trainable_c892ccf6   RUNNING         6.09408       4.55539e-06         0.123031                    5 â”‚
â”‚ trainable_c72de8a1   RUNNING         7.18321       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=140510)[0m 2025-06-17 22:51:47,254 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=140510)[0m 2025-06-17 22:51:47,260 - INFO - eval_result: {'eval_loss': 0.6501545906066895, 'eval_f1': 0.8939393939393939, 'eval_accuracy': 0.825, 'eval_kappa': 0.4244604316546763, 'eval_precision': 0.8082191780821918, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9823418259620667, 'eval_AP': 0.9642425997448705, 'eval_MCC': 0.5190437290769092, 'eval_NDCG': 0.9933064623029737, 'eval_runtime': 3.303, 'eval_samples_per_second': 24.22, 'eval_steps_per_second': 1.211, 'epoch': 3.0}
[36m(trainable pid=140510)[0m 2025-06-17 22:51:47,566 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
2025-06-17 22:51:47,589 - INFO - Cleaning up trial c72de8a1
2025-06-17 22:51:47,589 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-50-59/trainable_c72de8a1_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512_2025-06-17_22-51-13

[36m(trainable pid=140510)[0m {'loss': 0.8132, 'grad_norm': 5.648752689361572, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}[32m [repeated 3x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(trainable pid=140510)[0m {'train_runtime': 19.8366, 'train_samples_per_second': 50.966, 'train_steps_per_second': 2.571, 'train_loss': 1.1259190615485697, 'epoch': 3.0}
[36m(trainable pid=140510)[0m STATE at ending of training  :  TrainerState(epoch=3.0, global_step=51, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=265930944831672.0, log_history=[{'loss': 1.943, 'grad_norm': 4.659440994262695, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0, 'step': 17}, {'loss': 0.8132, 'grad_norm': 5.648752689361572, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0, 'step': 34}, {'loss': 0.6215, 'grad_norm': 23.408397674560547, 'learning_rate': 0.0, 'epoch': 3.0, 'step': 51}, {'train_runtime': 19.8366, 'train_samples_per_second': 50.966, 'train_steps_per_second': 2.571, 'total_flos': 265930944831672.0, 'train_loss': 1.1259190615485697, 'epoch': 3.0, 'step': 51}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=140510)[0m {'loss': 0.6215, 'grad_norm': 23.408397674560547, 'learning_rate': 0.0, 'epoch': 3.0}
[36m(trainable pid=140510)[0m {'eval_loss': 0.6501545906066895, 'eval_f1': 0.8939393939393939, 'eval_accuracy': 0.825, 'eval_kappa': 0.4244604316546763, 'eval_precision': 0.8082191780821918, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9823418259620667, 'eval_AP': 0.9642425997448705, 'eval_MCC': 0.5190437290769092, 'eval_NDCG': 0.9933064623029737, 'eval_runtime': 3.303, 'eval_samples_per_second': 24.22, 'eval_steps_per_second': 1.211, 'epoch': 3.0}

Trial trainable_c72de8a1 finished iteration 1 at 2025-06-17 22:51:47. Total running time: 46s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_c72de8a1 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                      27.06 â”‚
â”‚ time_total_s                          27.06 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     3 â”‚
â”‚ eval_AP                             0.96424 â”‚
â”‚ eval_MCC                            0.51904 â”‚
â”‚ eval_NDCG                           0.99331 â”‚
â”‚ eval_accuracy                         0.825 â”‚
â”‚ eval_f1                             0.89394 â”‚
â”‚ eval_kappa                          0.42446 â”‚
â”‚ eval_loss                           0.65015 â”‚
â”‚ eval_optim_threshold                0.98234 â”‚
â”‚ eval_precision                      0.80822 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                          3.303 â”‚
â”‚ eval_samples_per_second               24.22 â”‚
â”‚ eval_steps_per_second                 1.211 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_c72de8a1 completed after 1 iterations at 2025-06-17 22:51:47. Total running time: 46s
[36m(trainable pid=140096)[0m {'loss': 2.5985, 'grad_norm': 17.819129943847656, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0}

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 22:52:01. Total running time: 1min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_22316ee3   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_c892ccf6   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_c72de8a1   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1              27.06      0.650155    0.893939             0.825        0.42446 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=140096)[0m {'loss': 1.6731, 'grad_norm': 7.036700248718262, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0}[32m [repeated 2x across cluster][0m
[36m(trainable pid=140096)[0m {'loss': 1.4423, 'grad_norm': 9.69477367401123, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0}[32m [repeated 2x across cluster][0m
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 22:52:31. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_22316ee3   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_c892ccf6   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_c72de8a1   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1              27.06      0.650155    0.893939             0.825        0.42446 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=139822)[0m 2025-06-17 22:52:37,937 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=140096)[0m 2025-06-17 22:52:37,924 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=140096)[0m 2025-06-17 22:52:37,930 - INFO - eval_result: {'eval_loss': 1.3860852718353271, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8167442083358765, 'eval_AP': 0.7470058294909956, 'eval_MCC': 0.0, 'eval_NDCG': 0.883279558697759, 'eval_runtime': 3.9206, 'eval_samples_per_second': 20.405, 'eval_steps_per_second': 1.02, 'epoch': 5.0}
2025-06-17 22:52:38,280 - INFO - Cleaning up trial 22316ee3
2025-06-17 22:52:38,280 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-50-59/trainable_22316ee3_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-17_22-51-00
2025-06-17 22:52:38,280 - INFO - Current best: c72de8a1 with eval_kappa : 0.4244604316546763 at iteration 1
[36m(trainable pid=139822)[0m 2025-06-17 22:52:38,260 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
2025-06-17 22:52:38,409 - INFO - Cleaning up trial c892ccf6
2025-06-17 22:52:38,409 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-50-59/trainable_c892ccf6_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-17_22-51-07
2025-06-17 22:52:38,409 - INFO - Cleaning up trial 22316ee3
2025-06-17 22:52:38,409 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-50-59/trainable_22316ee3_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-17_22-51-00
2025-06-17 22:52:38,409 - INFO - Current best: c72de8a1 with eval_kappa : 0.4244604316546763 at iteration 1
2025-06-17 22:52:38,417	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-50-59' in 0.0063s.

[36m(trainable pid=140096)[0m {'train_runtime': 76.271, 'train_samples_per_second': 22.092, 'train_steps_per_second': 1.114, 'train_loss': 2.169224032233743, 'epoch': 5.0}
[36m(trainable pid=140096)[0m STATE at ending of training  :  TrainerState(epoch=5.0, global_step=85, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=443266203908280.0, log_history=[{'loss': 3.7497, 'grad_norm': 34.18121337890625, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0, 'step': 17}, {'loss': 2.5985, 'grad_norm': 17.819129943847656, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0, 'step': 34}, {'loss': 1.6731, 'grad_norm': 7.036700248718262, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0, 'step': 51}, {'loss': 1.4423, 'grad_norm': 9.69477367401123, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0, 'step': 68}, {'loss': 1.3826, 'grad_norm': 13.462550163269043, 'learning_rate': 0.0, 'epoch': 5.0, 'step': 85}, {'train_runtime': 76.271, 'train_samples_per_second': 22.092, 'train_steps_per_second': 1.114, 'total_flos': 443266203908280.0, 'train_loss': 2.169224032233743, 'epoch': 5.0, 'step': 85}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=140096)[0m {'loss': 1.3826, 'grad_norm': 13.462550163269043, 'learning_rate': 0.0, 'epoch': 5.0}[32m [repeated 2x across cluster][0m
[36m(trainable pid=139822)[0m STATE at ending of training  :  TrainerState(epoch=6.0, global_step=102, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=531933833446584.0, log_history=[{'loss': 2.9009, 'grad_norm': 40.50669860839844, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0, 'step': 17}, {'loss': 2.7656, 'grad_norm': 32.53392791748047, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0, 'step': 34}, {'loss': 2.428, 'grad_norm': 14.9981107711792, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0, 'step': 51}, {'loss': 2.203, 'grad_norm': 18.846248626708984, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0, 'step': 68}, {'loss': 2.1044, 'grad_norm': 28.11194610595703, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0, 'step': 85}, {'loss': 2.0213, 'grad_norm': 17.347427368164062, 'learning_rate': 0.0, 'epoch': 6.0, 'step': 102}, {'train_runtime': 82.8254, 'train_samples_per_second': 24.413, 'train_steps_per_second': 1.232, 'total_flos': 531933833446584.0, 'train_loss': 2.4038725460276886, 'epoch': 6.0, 'step': 102}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=140096)[0m {'eval_loss': 1.3860852718353271, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8167442083358765, 'eval_AP': 0.7470058294909956, 'eval_MCC': 0.0, 'eval_NDCG': 0.883279558697759, 'eval_runtime': 3.9206, 'eval_samples_per_second': 20.405, 'eval_steps_per_second': 1.02, 'epoch': 5.0}

Trial trainable_22316ee3 finished iteration 1 at 2025-06-17 22:52:38. Total running time: 1min 37s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_22316ee3 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    90.8431 â”‚
â”‚ time_total_s                        90.8431 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     6 â”‚
â”‚ eval_AP                             0.70236 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.89583 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           2.42004 â”‚
â”‚ eval_optim_threshold                  0.679 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.7895 â”‚
â”‚ eval_samples_per_second              21.111 â”‚
â”‚ eval_steps_per_second                 1.056 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_22316ee3 completed after 1 iterations at 2025-06-17 22:52:38. Total running time: 1min 37s

Trial trainable_c892ccf6 finished iteration 1 at 2025-06-17 22:52:38. Total running time: 1min 37s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_c892ccf6 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    84.5705 â”‚
â”‚ time_total_s                        84.5705 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     5 â”‚
â”‚ eval_AP                             0.74701 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.88328 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.38609 â”‚
â”‚ eval_optim_threshold                0.81674 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.9206 â”‚
â”‚ eval_samples_per_second              20.405 â”‚
â”‚ eval_steps_per_second                  1.02 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_c892ccf6 completed after 1 iterations at 2025-06-17 22:52:38. Total running time: 1min 37s

Trial status: 3 TERMINATED
Current time: 2025-06-17 22:52:38. Total running time: 1min 37s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_22316ee3   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1            90.8432      2.42004     0.848921            0.7375        0       â”‚
â”‚ trainable_c892ccf6   TERMINATED        6.09408       4.55539e-06         0.123031                    5        1            84.5705      1.38609     0.848921            0.7375        0       â”‚
â”‚ trainable_c72de8a1   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.06        0.650155    0.893939            0.825         0.42446 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯2025-06-17 22:52:38,424 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x7a9644377050>
2025-06-17 22:52:38,424 - INFO - Best trial : trainable_c72de8a1
2025-06-17 22:52:38,424 - INFO - Best config : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-17 22:52:38,424 - INFO - Best trial after optimization: {'eval_loss': 0.6501545906066895, 'eval_f1': 0.8939393939393939, 'eval_accuracy': 0.825, 'eval_kappa': 0.4244604316546763, 'eval_precision': 0.8082191780821918, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9823418259620667, 'eval_AP': 0.9642425997448705, 'eval_MCC': 0.5190437290769092, 'eval_NDCG': 0.9933064623029737, 'eval_runtime': 3.303, 'eval_samples_per_second': 24.22, 'eval_steps_per_second': 1.211, 'epoch': 3.0, 'timestamp': 1750193507, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': 'c72de8a1', 'date': '2025-06-17_22-51-47', 'time_this_iter_s': 27.059983253479004, 'time_total_s': 27.059983253479004, 'pid': 140510, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 27.059983253479004, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512'}
2025-06-17 22:52:38,445 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   2.420037  0.848921  ...                        6  22316ee3
1   1.386085  0.848921  ...                        5  c892ccf6
2   0.650155  0.893939  ...                        3  c72de8a1

[3 rows x 32 columns]
2025-06-17 22:52:38,556 - INFO - Trial comparison plot saved
2025-06-17 22:52:38,568 - INFO - Best Hyperparameters after HPO : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}


[36m(trainable pid=139822)[0m 2025-06-17 22:52:37,942 - INFO - eval_result: {'eval_loss': 2.420037269592285, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.6789972186088562, 'eval_AP': 0.7023599926491877, 'eval_MCC': 0.0, 'eval_NDCG': 0.8958295202825485, 'eval_runtime': 3.7895, 'eval_samples_per_second': 21.111, 'eval_steps_per_second': 1.056, 'epoch': 6.0}
[36m(trainable pid=140096)[0m 2025-06-17 22:52:38,369 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(trainable pid=139822)[0m {'train_runtime': 82.8254, 'train_samples_per_second': 24.413, 'train_steps_per_second': 1.232, 'train_loss': 2.4038725460276886, 'epoch': 6.0}
[36m(trainable pid=139822)[0m {'loss': 2.0213, 'grad_norm': 17.347427368164062, 'learning_rate': 0.0, 'epoch': 6.0}
[36m(trainable pid=139822)[0m {'eval_loss': 2.420037269592285, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.6789972186088562, 'eval_AP': 0.7023599926491877, 'eval_MCC': 0.0, 'eval_NDCG': 0.8958295202825485, 'eval_runtime': 3.7895, 'eval_samples_per_second': 21.111, 'eval_steps_per_second': 1.056, 'epoch': 6.0}
2025-06-17 22:52:47,351 - INFO - Namespace(config='configs/train.yaml', hp_config='configs/best_hpo.yaml', fold=0, run=0, gpu='2', model_name='google-bert/bert-base-uncased', nb_opt_negs=100, loss='BCE', with_title=True, with_keywords=False, best_metric=None)
2025-06-17 22:52:47,353 - INFO - {'model_name': 'bert-base-uncased', 'fold': 0, 'run': 0, 'output_dir': 'outputs/checkpoints', 'best_metric': 'eval_kappa', 'loss_type': 'BCE', 'nb_optional_negs': 100, 'with_title': True, 'with_keywords': False, 'default_hyperparameters': {'learning_rate': 'None', 'num_train_epochs': 'None', 'pos_weight': 'None', 'weight_decay': 'None'}}
2025-06-17 22:52:48,176 - INFO - train split size : 337
2025-06-17 22:52:48,176 - INFO - dev split size : 80
2025-06-17 22:52:48,176 - INFO - test split size : 80
2025-06-17 22:52:48,419 - INFO - 3 datasets tokenized successfully
2025-06-17 22:52:48,419 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-17 22:52:48,736 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
[2025-06-17 22:52:48,971] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-06-17 22:52:51,665] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
2025-06-17 22:52:51,702 - INFO - training size : 337
2025-06-17 22:52:51,702 - INFO - dev size : 80
2025-06-17 22:52:51,703 - INFO - test size : 80
  0%|          | 0/12 [00:00<?, ?it/s]  8%|â–Š         | 1/12 [00:02<00:25,  2.34s/it] 17%|â–ˆâ–‹        | 2/12 [00:04<00:20,  2.04s/it] 25%|â–ˆâ–ˆâ–Œ       | 3/12 [00:05<00:17,  1.92s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [00:06<00:11,  1.43s/it]                                               33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [00:06<00:11,  1.43s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 5/12 [00:08<00:11,  1.61s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 6/12 [00:10<00:10,  1.68s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 7/12 [00:12<00:08,  1.71s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [00:12<00:05,  1.38s/it]                                               67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [00:12<00:05,  1.38s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 9/12 [00:14<00:04,  1.54s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 10/12 [00:16<00:03,  1.63s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 11/12 [00:18<00:01,  1.67s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:18<00:00,  1.37s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:21<00:00,  1.37s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:21<00:00,  1.37s/it]2025-06-17 22:53:13,363 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:21<00:00,  1.78s/it]
{'loss': 1.9894, 'grad_norm': 3.9821689128875732, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
{'loss': 1.4669, 'grad_norm': 6.820930004119873, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
{'loss': 1.2903, 'grad_norm': 5.319034576416016, 'learning_rate': 0.0, 'epoch': 3.0}
{'train_runtime': 21.3786, 'train_samples_per_second': 47.29, 'train_steps_per_second': 0.561, 'train_loss': 1.5822134017944336, 'epoch': 3.0}
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 22:53:16,666 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.79s/it]
2025-06-17 22:53:16,673 - INFO - Training time : 28.253913422930054
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 22:53:20,157 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.96s/it]
2025-06-17 22:53:20,162 - INFO - Evaluation time : 3.4888991890475154
2025-06-17 22:53:20,162 - INFO - Evaluation results on test set: {'eval_loss': 1.0696144104003906, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8988329172134399, 'eval_AP': 0.8200481139968032, 'eval_MCC': 0.0, 'eval_NDCG': 0.9518402545856095, 'eval_runtime': 3.4767, 'eval_samples_per_second': 23.011, 'eval_steps_per_second': 0.288, 'epoch': 3.0}
2025-06-17 22:53:20,162 - INFO - Total updates (optimizer steps): 12
2025-06-17 22:53:20,162 - INFO - Avg time / step: 1.783s
2025-06-17 22:53:20,875 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCE_bert-base_fold-1
2025-06-17 22:53:20,875 - INFO - On test Set (with threshold 0.5) : 
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 22:53:24,197 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.80s/it]
2025-06-17 22:53:24,200 - INFO - Raw predictions shape: (80, 1)
2025-06-17 22:53:24,201 - INFO - Raw predictions: [[2.5713527]
 [2.184323 ]
 [2.3175406]
 [2.731238 ]
 [2.72877  ]
 [2.8465638]
 [2.3453503]
 [2.5008144]
 [2.4347014]
 [2.0122576]]
2025-06-17 22:53:24,201 - INFO - Scores shape: (80,)
2025-06-17 22:53:24,201 - INFO - Scores: [0.92899495 0.8988329  0.91031945 0.938845   0.9387031  0.9451407
 0.9125639  0.9241989  0.91943544 0.88207805]
2025-06-17 22:53:24,201 - INFO - Preds shape: (80,)
2025-06-17 22:53:24,201 - INFO - Preds: [1 1 1 1 1 1 1 1 1 1]
2025-06-17 22:53:24,201 - INFO - Test labels shape: (80,)
2025-06-17 22:53:24,201 - INFO - Test labels: [1, 1, 0, 0, 1, 1, 1, 1, 0, 0]
2025-06-17 22:53:24,201 - INFO - Test split: Dataset({
    features: ['Unnamed: 0', 'title', 'abstract', 'Keywords', 'doi', 'labels'],
    num_rows: 80
})
2025-06-17 22:53:24,202 - INFO - Unique values in predictions: [1]
2025-06-17 22:53:24,202 - INFO - Unique values in labels: [0 1]
2025-06-17 22:53:24,203 - INFO - Confusion matrix:
[[ 0 21]
 [ 0 59]]
2025-06-17 22:53:24,204 - INFO - Confusion matrix: TN=0, FP=21, FN=0, TP=59
2025-06-17 22:53:27,130 - INFO - Metrics: {'f1': 0.8489208633093526, 'recall': 1.0, 'precision': 0.7375, 'accuracy': 0.7375, 'AP': 0.8200481139968032, 'MCC': 0.0, 'NDCG': 0.9518402545856095, 'kappa': 0.0, 'TN': 0, 'FP': 21, 'FN': 0, 'TP': 59}
2025-06-17 22:53:27,244 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-17 22:53:27,343 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 22:53:27,343 - INFO - 
On test Set (optimal threshold of 0.8958649635314941 according to cross validation on the training set): 
2025-06-17 22:53:27,344 - INFO - Confusion matrix: TN=7, FP=14, FN=4, TP=55
2025-06-17 22:53:30,153 - INFO - Metrics: {'f1': 0.859375, 'recall': 0.9322033898305084, 'precision': 0.7971014492753623, 'accuracy': 0.775, 'AP': 0.8200481139968032, 'MCC': 0.3392652331827029, 'NDCG': 0.9518402545856095, 'kappa': 0.31363203050524313, 'TN': 7, 'FP': 14, 'FN': 4, 'TP': 55}
2025-06-17 22:53:30,249 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 22:53:30,249 - INFO - Results for fold 1 : [{'f1': 0.859375, 'recall': 0.9322033898305084, 'precision': 0.7971014492753623, 'accuracy': 0.775, 'AP': 0.8200481139968032, 'MCC': 0.3392652331827029, 'NDCG': 0.9518402545856095, 'kappa': 0.31363203050524313, 'TN': 7, 'FP': 14, 'FN': 4, 'TP': 55}]
2025-06-17 22:53:30,578 - INFO - Cleared CUDA cache. Memory allocated: 1.33 GB, Memory reserved: 1.63 GB
2025-06-17 22:53:30,583 - INFO - Metrics stored successfully at /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/metrics/binary_metrics.csv
Ensemble :
2025-06-17 22:53:37,850 - INFO - Namespace(config='configs/ensemble.yaml', fold=0, run=0, model_names=None, nb_opt_negs=100, loss='BCE', with_title=True, with_keywords=False)
2025-06-17 22:53:37,852 - INFO - {'model_names': ['microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract', 'microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext', 'FacebookAI/roberta-base', 'dmis-lab/biobert-v1.1', 'google-bert/bert-base-uncased'], 'fold': 0, 'run': 0, 'loss_type': 'BCE', 'with_title': True, 'with_keywords': False, 'nb_optional_negs': 100}
2025-06-17 22:53:37,859 - INFO - 
fold number 1 | run no. 0
2025-06-17 22:53:38,230 - INFO - Confusion matrix: TN=0, FP=21, FN=0, TP=59
2025-06-17 22:53:40,996 - INFO - Metrics: {'f1': 0.8489208633093526, 'recall': 1.0, 'precision': 0.7375, 'accuracy': 0.7375, 'AP': 0.85056712345235, 'MCC': 0.0, 'NDCG': 0.9584420112442794, 'kappa': 0.0, 'TN': 0, 'FP': 21, 'FN': 0, 'TP': 59}
2025-06-17 22:53:41,000 - INFO - Metrics stored successfully at /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/metrics/binary_metrics.csv
Traceback (most recent call last):
  File "/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/ensemble.py", line 211, in <module>
    main()
  File "/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/ensemble.py", line 208, in main
    ensemble_pred(cfg)
  File "/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/ensemble.py", line 179, in ensemble_pred
    (avg_metrics["loss_type"] == self.loss_type)
                                 ^^^^
NameError: name 'self' is not defined. Did you mean: 'Self'?
Fold number: 1
Run number: 0
Model: microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract
2025-06-17 22:53:47,628 - INFO - Namespace(config='configs/hpo.yaml', fold=1, run=0, gpu=None, model_name='microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract', nb_opt_negs=100, n_trials=3, hpo_metric=None, direction=None, loss='BCE', with_title=True, with_keywords=False)
2025-06-17 22:53:47,629 - INFO - {'model_name': 'google-bert/bert-base-uncased', 'num_trials': 20, 'fold': 0, 'hpo_metric': 'eval_kappa', 'direction': 'max', 'loss_type': 'BCE', 'with_title': True, 'with_keywords': False, 'nb_optional_negs': 100}
2025-06-17 22:53:48,003 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
2025-06-17 22:53:48,003 - INFO - 
fold number 2 | run no. 1
2025-06-17 22:53:48,587 - INFO - train split size : 337
2025-06-17 22:53:48,587 - INFO - dev split size : 80
2025-06-17 22:53:48,587 - INFO - test split size : 80
2025-06-17 22:53:48,829 - INFO - 3 datasets tokenized successfully
2025-06-17 22:53:48,888 - INFO - Fold 2 max seq len = 512
2025-06-17 22:53:48,888 - INFO - Starting hyperparameter search for BCE loss
2025-06-17 22:53:50,279	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
2025-06-17 22:53:50,961	INFO tune.py:253 -- Initializing Ray automatically. For cluster usage or custom Ray initialization, call `ray.init(...)` before `tune.run(...)`.
[36m(trainable pid=145059)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=145059)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=145059)[0m 2025-06-17 22:54:00,129 - INFO - pos_weight value in TrainingArguments : 6.828424226204718
[36m(trainable pid=145059)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=145059)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=145261)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=145261)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=145261)[0m 2025-06-17 22:54:05,932 - INFO - pos_weight value in TrainingArguments : 6.094080202241274
[36m(trainable pid=145261)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=145261)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=145659)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=145659)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=145659)[0m 2025-06-17 22:54:12,215 - INFO - pos_weight value in TrainingArguments : 7.183206941666034
[36m(trainable pid=145659)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=145659)[0m   super().__init__(*args, **kwargs)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     trainable_2025-06-17_22-53-50   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-53-50
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-17_22-53-48_911357_142610/artifacts/2025-06-17_22-53-50/trainable_2025-06-17_22-53-50/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-17 22:53:52. Total running time: 0s
Logical resource usage: 0/32 CPUs, 0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_870b5b4c   PENDING         6.82842       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_870b5b4c started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_870b5b4c config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          6.82842 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=145059)[0m [2025-06-17 22:54:00,353] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=145059)[0m [2025-06-17 22:54:03,024] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=145059)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial trainable_1e59174b started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_1e59174b config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          6.09408 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=145261)[0m [2025-06-17 22:54:06,287] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=145261)[0m [2025-06-17 22:54:08,916] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=145261)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial trainable_d83348f6 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_d83348f6 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          7.18321 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=145059)[0m {'loss': 2.5953, 'grad_norm': 41.3245964050293, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}
[36m(trainable pid=145659)[0m [2025-06-17 22:54:12,435] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=145659)[0m [2025-06-17 22:54:15,068] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=145659)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 3 RUNNING
Current time: 2025-06-17 22:54:22. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_870b5b4c   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ trainable_1e59174b   RUNNING         6.09408       4.55539e-06         0.123031                    5 â”‚
â”‚ trainable_d83348f6   RUNNING         7.18321       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=145659)[0m 2025-06-17 22:54:38,700 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=145659)[0m 2025-06-17 22:54:38,708 - INFO - eval_result: {'eval_loss': 0.893694281578064, 'eval_f1': 0.8613138686131386, 'eval_accuracy': 0.7625, 'eval_kappa': 0.13439635535307526, 'eval_precision': 0.7564102564102564, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9779174327850342, 'eval_AP': 0.8617885672957466, 'eval_MCC': 0.26840095387139007, 'eval_NDCG': 0.9255245841015404, 'eval_runtime': 3.2954, 'eval_samples_per_second': 24.276, 'eval_steps_per_second': 1.214, 'epoch': 3.0}
2025-06-17 22:54:39,176 - INFO - Cleaning up trial d83348f6
2025-06-17 22:54:39,176 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-53-50/trainable_d83348f6_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512_2025-06-17_22-54-05
[36m(trainable pid=145659)[0m 2025-06-17 22:54:39,151 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(trainable pid=145659)[0m /home/leandre/.local/share/uv/python/cpython-3.11.11-linux-x86_64-gnu/lib/python3.11/multiprocessing/resource_tracker.py:123: UserWarning: resource_tracker: process died unexpectedly, relaunching.  Some resources might leak.
[36m(trainable pid=145659)[0m   warnings.warn('resource_tracker: process died unexpectedly, '
[36m(trainable pid=145659)[0m Traceback (most recent call last):
[36m(trainable pid=145659)[0m   File "/home/leandre/.local/share/uv/python/cpython-3.11.11-linux-x86_64-gnu/lib/python3.11/multiprocessing/resource_tracker.py", line 239, in main
[36m(trainable pid=145659)[0m     cache[rtype].remove(name)
[36m(trainable pid=145659)[0m KeyError: '/loky-145659-g9s0fw2s'

[36m(trainable pid=145659)[0m {'loss': 1.5427, 'grad_norm': 46.06742858886719, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
[36m(trainable pid=145261)[0m {'loss': 1.7063, 'grad_norm': 11.502381324768066, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0}
[36m(trainable pid=145659)[0m {'train_runtime': 19.8782, 'train_samples_per_second': 50.86, 'train_steps_per_second': 2.566, 'train_loss': 1.0556821636125153, 'epoch': 3.0}
[36m(trainable pid=145659)[0m STATE at ending of training  :  TrainerState(epoch=3.0, global_step=51, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=266002888614912.0, log_history=[{'loss': 1.5427, 'grad_norm': 46.06742858886719, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0, 'step': 17}, {'loss': 0.8363, 'grad_norm': 17.504323959350586, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0, 'step': 34}, {'loss': 0.788, 'grad_norm': 19.504005432128906, 'learning_rate': 0.0, 'epoch': 3.0, 'step': 51}, {'train_runtime': 19.8782, 'train_samples_per_second': 50.86, 'train_steps_per_second': 2.566, 'total_flos': 266002888614912.0, 'train_loss': 1.0556821636125153, 'epoch': 3.0, 'step': 51}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=145659)[0m {'loss': 0.788, 'grad_norm': 19.504005432128906, 'learning_rate': 0.0, 'epoch': 3.0}[32m [repeated 3x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(trainable pid=145659)[0m {'eval_loss': 0.893694281578064, 'eval_f1': 0.8613138686131386, 'eval_accuracy': 0.7625, 'eval_kappa': 0.13439635535307526, 'eval_precision': 0.7564102564102564, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9779174327850342, 'eval_AP': 0.8617885672957466, 'eval_MCC': 0.26840095387139007, 'eval_NDCG': 0.9255245841015404, 'eval_runtime': 3.2954, 'eval_samples_per_second': 24.276, 'eval_steps_per_second': 1.214, 'epoch': 3.0}

Trial trainable_d83348f6 finished iteration 1 at 2025-06-17 22:54:39. Total running time: 47s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_d83348f6 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    27.7649 â”‚
â”‚ time_total_s                        27.7649 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     3 â”‚
â”‚ eval_AP                             0.86179 â”‚
â”‚ eval_MCC                             0.2684 â”‚
â”‚ eval_NDCG                           0.92552 â”‚
â”‚ eval_accuracy                        0.7625 â”‚
â”‚ eval_f1                             0.86131 â”‚
â”‚ eval_kappa                           0.1344 â”‚
â”‚ eval_loss                           0.89369 â”‚
â”‚ eval_optim_threshold                0.97792 â”‚
â”‚ eval_precision                      0.75641 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.2954 â”‚
â”‚ eval_samples_per_second              24.276 â”‚
â”‚ eval_steps_per_second                 1.214 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_d83348f6 completed after 1 iterations at 2025-06-17 22:54:39. Total running time: 47s
[36m(trainable pid=145059)[0m {'loss': 1.5825, 'grad_norm': 9.862381935119629, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0}[32m [repeated 2x across cluster][0m

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 22:54:52. Total running time: 1min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_870b5b4c   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_1e59174b   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_d83348f6   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.7649      0.893694    0.861314            0.7625       0.134396 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=145261)[0m {'loss': 1.2819, 'grad_norm': 9.811666488647461, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0}
[36m(trainable pid=145059)[0m {'loss': 1.4597, 'grad_norm': 10.936534881591797, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0}
[36m(trainable pid=145261)[0m {'loss': 1.2301, 'grad_norm': 8.257059097290039, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0}
[36m(trainable pid=145059)[0m {'loss': 1.418, 'grad_norm': 15.73354434967041, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 22:55:22. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_870b5b4c   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_1e59174b   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_d83348f6   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.7649      0.893694    0.861314            0.7625       0.134396 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=145261)[0m 2025-06-17 22:55:29,752 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=145261)[0m 2025-06-17 22:55:29,757 - INFO - eval_result: {'eval_loss': 1.102473497390747, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8701968789100647, 'eval_AP': 0.8385822062414591, 'eval_MCC': 0.0, 'eval_NDCG': 0.9514014377366503, 'eval_runtime': 4.0234, 'eval_samples_per_second': 19.884, 'eval_steps_per_second': 0.994, 'epoch': 5.0}
2025-06-17 22:55:30,085 - INFO - Cleaning up trial 1e59174b
2025-06-17 22:55:30,086 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-53-50/trainable_1e59174b_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-17_22-53-58
2025-06-17 22:55:30,086 - INFO - Current best: d83348f6 with eval_kappa : 0.13439635535307526 at iteration 1
[36m(trainable pid=145261)[0m 2025-06-17 22:55:30,066 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(trainable pid=145059)[0m 2025-06-17 22:55:30,452 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=145059)[0m 2025-06-17 22:55:30,458 - INFO - eval_result: {'eval_loss': 1.292070984840393, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8371989727020264, 'eval_AP': 0.7656818085046986, 'eval_MCC': 0.0, 'eval_NDCG': 0.9303599317872473, 'eval_runtime': 3.3042, 'eval_samples_per_second': 24.211, 'eval_steps_per_second': 1.211, 'epoch': 6.0}
2025-06-17 22:55:30,782 - INFO - Cleaning up trial 870b5b4c
2025-06-17 22:55:30,782 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-53-50/trainable_870b5b4c_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-17_22-53-52
2025-06-17 22:55:30,782 - INFO - Cleaning up trial 1e59174b
2025-06-17 22:55:30,782 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-53-50/trainable_1e59174b_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-17_22-53-58
2025-06-17 22:55:30,782 - INFO - Current best: d83348f6 with eval_kappa : 0.13439635535307526 at iteration 1
2025-06-17 22:55:30,790	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-53-50' in 0.0064s.

[36m(trainable pid=145261)[0m {'train_runtime': 76.4765, 'train_samples_per_second': 22.033, 'train_steps_per_second': 1.111, 'train_loss': 1.3569498174330767, 'epoch': 5.0}
[36m(trainable pid=145261)[0m STATE at ending of training  :  TrainerState(epoch=5.0, global_step=85, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=443338147691520.0, log_history=[{'loss': 1.7063, 'grad_norm': 11.502381324768066, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0, 'step': 17}, {'loss': 1.3688, 'grad_norm': 8.185762405395508, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0, 'step': 34}, {'loss': 1.2819, 'grad_norm': 9.811666488647461, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0, 'step': 51}, {'loss': 1.2301, 'grad_norm': 8.257059097290039, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0, 'step': 68}, {'loss': 1.1976, 'grad_norm': 11.481196403503418, 'learning_rate': 0.0, 'epoch': 5.0, 'step': 85}, {'train_runtime': 76.4765, 'train_samples_per_second': 22.033, 'train_steps_per_second': 1.111, 'total_flos': 443338147691520.0, 'train_loss': 1.3569498174330767, 'epoch': 5.0, 'step': 85}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=145261)[0m {'loss': 1.1976, 'grad_norm': 11.481196403503418, 'learning_rate': 0.0, 'epoch': 5.0}
[36m(trainable pid=145059)[0m {'loss': 1.408, 'grad_norm': 8.255256652832031, 'learning_rate': 0.0, 'epoch': 6.0}
[36m(trainable pid=145059)[0m STATE at ending of training  :  TrainerState(epoch=6.0, global_step=102, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=532005777229824.0, log_history=[{'loss': 2.5953, 'grad_norm': 41.3245964050293, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0, 'step': 17}, {'loss': 1.836, 'grad_norm': 18.734737396240234, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0, 'step': 34}, {'loss': 1.5825, 'grad_norm': 9.862381935119629, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0, 'step': 51}, {'loss': 1.4597, 'grad_norm': 10.936534881591797, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0, 'step': 68}, {'loss': 1.418, 'grad_norm': 15.73354434967041, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0, 'step': 85}, {'loss': 1.408, 'grad_norm': 8.255256652832031, 'learning_rate': 0.0, 'epoch': 6.0, 'step': 102}, {'train_runtime': 83.7805, 'train_samples_per_second': 24.134, 'train_steps_per_second': 1.217, 'total_flos': 532005777229824.0, 'train_loss': 1.7165628882015453, 'epoch': 6.0, 'step': 102}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=145261)[0m {'eval_loss': 1.102473497390747, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8701968789100647, 'eval_AP': 0.8385822062414591, 'eval_MCC': 0.0, 'eval_NDCG': 0.9514014377366503, 'eval_runtime': 4.0234, 'eval_samples_per_second': 19.884, 'eval_steps_per_second': 0.994, 'epoch': 5.0}

Trial trainable_1e59174b finished iteration 1 at 2025-06-17 22:55:30. Total running time: 1min 37s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_1e59174b result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    84.9859 â”‚
â”‚ time_total_s                        84.9859 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     5 â”‚
â”‚ eval_AP                             0.83858 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                            0.9514 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.10247 â”‚
â”‚ eval_optim_threshold                 0.8702 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         4.0234 â”‚
â”‚ eval_samples_per_second              19.884 â”‚
â”‚ eval_steps_per_second                 0.994 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_1e59174b completed after 1 iterations at 2025-06-17 22:55:30. Total running time: 1min 37s

Trial trainable_870b5b4c finished iteration 1 at 2025-06-17 22:55:30. Total running time: 1min 38s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_870b5b4c result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    92.0653 â”‚
â”‚ time_total_s                        92.0653 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     6 â”‚
â”‚ eval_AP                             0.76568 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.93036 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.29207 â”‚
â”‚ eval_optim_threshold                 0.8372 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.3042 â”‚
â”‚ eval_samples_per_second              24.211 â”‚
â”‚ eval_steps_per_second                 1.211 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_870b5b4c completed after 1 iterations at 2025-06-17 22:55:30. Total running time: 1min 38s

Trial status: 3 TERMINATED
Current time: 2025-06-17 22:55:30. Total running time: 1min 38s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_870b5b4c   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1            92.0653      1.29207     0.848921            0.7375       0        â”‚
â”‚ trainable_1e59174b   TERMINATED        6.09408       4.55539e-06         0.123031                    5        1            84.9859      1.10247     0.848921            0.7375       0        â”‚
â”‚ trainable_d83348f6   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.7649      0.893694    0.861314            0.7625       0.134396 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯2025-06-17 22:55:30,797 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x70a08f3d63d0>
2025-06-17 22:55:30,797 - INFO - Best trial : trainable_d83348f6
2025-06-17 22:55:30,797 - INFO - Best config : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-17 22:55:30,797 - INFO - Best trial after optimization: {'eval_loss': 0.893694281578064, 'eval_f1': 0.8613138686131386, 'eval_accuracy': 0.7625, 'eval_kappa': 0.13439635535307526, 'eval_precision': 0.7564102564102564, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9779174327850342, 'eval_AP': 0.8617885672957466, 'eval_MCC': 0.26840095387139007, 'eval_NDCG': 0.9255245841015404, 'eval_runtime': 3.2954, 'eval_samples_per_second': 24.276, 'eval_steps_per_second': 1.214, 'epoch': 3.0, 'timestamp': 1750193679, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': 'd83348f6', 'date': '2025-06-17_22-54-39', 'time_this_iter_s': 27.764862775802612, 'time_total_s': 27.764862775802612, 'pid': 145659, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 27.764862775802612, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512'}
2025-06-17 22:55:30,819 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   1.292071  0.848921  ...                        6  870b5b4c
1   1.102473  0.848921  ...                        5  1e59174b
2   0.893694  0.861314  ...                        3  d83348f6

[3 rows x 32 columns]
2025-06-17 22:55:31,026 - INFO - Trial comparison plot saved
2025-06-17 22:55:31,034 - INFO - Best Hyperparameters after HPO : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}


[36m(trainable pid=145059)[0m 2025-06-17 22:55:30,761 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(trainable pid=145059)[0m {'train_runtime': 83.7805, 'train_samples_per_second': 24.134, 'train_steps_per_second': 1.217, 'train_loss': 1.7165628882015453, 'epoch': 6.0}
[36m(trainable pid=145059)[0m {'eval_loss': 1.292070984840393, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8371989727020264, 'eval_AP': 0.7656818085046986, 'eval_MCC': 0.0, 'eval_NDCG': 0.9303599317872473, 'eval_runtime': 3.3042, 'eval_samples_per_second': 24.211, 'eval_steps_per_second': 1.211, 'epoch': 6.0}
2025-06-17 22:55:39,973 - INFO - Namespace(config='configs/train.yaml', hp_config='configs/best_hpo.yaml', fold=1, run=0, gpu='2', model_name='microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract', nb_opt_negs=100, loss='BCE', with_title=True, with_keywords=False, best_metric=None)
2025-06-17 22:55:39,975 - INFO - {'model_name': 'bert-base-uncased', 'fold': 0, 'run': 0, 'output_dir': 'outputs/checkpoints', 'best_metric': 'eval_kappa', 'loss_type': 'BCE', 'nb_optional_negs': 100, 'with_title': True, 'with_keywords': False, 'default_hyperparameters': {'learning_rate': 'None', 'num_train_epochs': 'None', 'pos_weight': 'None', 'weight_decay': 'None'}}
2025-06-17 22:55:40,757 - INFO - train split size : 337
2025-06-17 22:55:40,757 - INFO - dev split size : 80
2025-06-17 22:55:40,757 - INFO - test split size : 80
2025-06-17 22:55:40,995 - INFO - 3 datasets tokenized successfully
2025-06-17 22:55:40,995 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-17 22:55:41,721 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
[2025-06-17 22:55:41,945] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-06-17 22:55:44,720] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
2025-06-17 22:55:44,756 - INFO - training size : 337
2025-06-17 22:55:44,756 - INFO - dev size : 80
2025-06-17 22:55:44,756 - INFO - test size : 80
  0%|          | 0/12 [00:00<?, ?it/s]  8%|â–Š         | 1/12 [00:02<00:26,  2.39s/it] 17%|â–ˆâ–‹        | 2/12 [00:04<00:20,  2.05s/it] 25%|â–ˆâ–ˆâ–Œ       | 3/12 [00:05<00:17,  1.93s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [00:06<00:11,  1.43s/it]                                               33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [00:06<00:11,  1.43s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 5/12 [00:08<00:11,  1.60s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 6/12 [00:10<00:10,  1.68s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 7/12 [00:12<00:08,  1.71s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [00:12<00:05,  1.38s/it]                                               67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [00:12<00:05,  1.38s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 9/12 [00:14<00:04,  1.54s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 10/12 [00:16<00:03,  1.63s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 11/12 [00:18<00:01,  1.67s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:19<00:00,  1.37s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:21<00:00,  1.37s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:21<00:00,  1.37s/it]2025-06-17 22:56:06,416 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:21<00:00,  1.78s/it]
{'loss': 1.9305, 'grad_norm': 5.5708770751953125, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
{'loss': 1.0708, 'grad_norm': 13.116230964660645, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
{'loss': 0.8509, 'grad_norm': 7.934375762939453, 'learning_rate': 0.0, 'epoch': 3.0}
{'train_runtime': 21.3832, 'train_samples_per_second': 47.28, 'train_steps_per_second': 0.561, 'train_loss': 1.2840412457784016, 'epoch': 3.0}
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 22:56:09,815 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.89s/it]
2025-06-17 22:56:09,821 - INFO - Training time : 28.825316329021007
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 22:56:13,068 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.73s/it]
2025-06-17 22:56:13,073 - INFO - Evaluation time : 3.252286418923177
2025-06-17 22:56:13,073 - INFO - Evaluation results on test set: {'eval_loss': 0.9042806625366211, 'eval_f1': 0.8676470588235294, 'eval_accuracy': 0.775, 'eval_kappa': 0.19732441471571893, 'eval_precision': 0.7662337662337663, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9590615034103394, 'eval_AP': 0.9162015211692516, 'eval_MCC': 0.33085036890537656, 'eval_NDCG': 0.9807267929959405, 'eval_runtime': 3.24, 'eval_samples_per_second': 24.691, 'eval_steps_per_second': 0.309, 'epoch': 3.0}
2025-06-17 22:56:13,073 - INFO - Total updates (optimizer steps): 12
2025-06-17 22:56:13,073 - INFO - Avg time / step: 1.783s
2025-06-17 22:56:13,774 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCE_BiomedBERT-abs_fold-2
2025-06-17 22:56:13,774 - INFO - On test Set (with threshold 0.5) : 
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 22:56:17,031 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.74s/it]
2025-06-17 22:56:17,035 - INFO - Raw predictions shape: (80, 1)
2025-06-17 22:56:17,035 - INFO - Raw predictions: [[2.623342  ]
 [3.61979   ]
 [3.2007368 ]
 [3.46529   ]
 [2.6258013 ]
 [3.4824657 ]
 [3.6515853 ]
 [2.6548603 ]
 [3.5943158 ]
 [0.45988414]]
2025-06-17 22:56:17,035 - INFO - Scores shape: (80,)
2025-06-17 22:56:17,035 - INFO - Scores: [0.9323488  0.9739105  0.96086204 0.9696838  0.93250376 0.9701847
 0.9747064  0.9343099  0.9732554  0.6129867 ]
2025-06-17 22:56:17,035 - INFO - Preds shape: (80,)
2025-06-17 22:56:17,036 - INFO - Preds: [1 1 1 1 1 1 1 1 1 1]
2025-06-17 22:56:17,036 - INFO - Test labels shape: (80,)
2025-06-17 22:56:17,036 - INFO - Test labels: [1, 1, 1, 1, 1, 1, 1, 0, 1, 0]
2025-06-17 22:56:17,036 - INFO - Test split: Dataset({
    features: ['Unnamed: 0', 'title', 'abstract', 'Keywords', 'doi', 'labels'],
    num_rows: 80
})
2025-06-17 22:56:17,036 - INFO - Unique values in predictions: [0 1]
2025-06-17 22:56:17,036 - INFO - Unique values in labels: [0 1]
2025-06-17 22:56:17,037 - INFO - Confusion matrix:
[[ 3 18]
 [ 0 59]]
2025-06-17 22:56:17,038 - INFO - Confusion matrix: TN=3, FP=18, FN=0, TP=59
2025-06-17 22:56:19,754 - INFO - Metrics: {'f1': 0.8676470588235294, 'recall': 1.0, 'precision': 0.7662337662337663, 'accuracy': 0.775, 'AP': 0.9162015211692516, 'MCC': 0.33085036890537656, 'NDCG': 0.9807267929959405, 'kappa': 0.19732441471571893, 'TN': 3, 'FP': 18, 'FN': 0, 'TP': 59}
2025-06-17 22:56:19,864 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-17 22:56:19,956 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 22:56:19,956 - INFO - 
On test Set (optimal threshold of 0.9341055750846863 according to cross validation on the training set): 
2025-06-17 22:56:19,957 - INFO - Confusion matrix: TN=15, FP=6, FN=17, TP=42
2025-06-17 22:56:22,683 - INFO - Metrics: {'f1': 0.7850467289719626, 'recall': 0.711864406779661, 'precision': 0.875, 'accuracy': 0.7125, 'AP': 0.9162015211692516, 'MCC': 0.3827389503515715, 'NDCG': 0.9807267929959405, 'kappa': 0.3646408839779006, 'TN': 15, 'FP': 6, 'FN': 17, 'TP': 42}
2025-06-17 22:56:22,775 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 22:56:22,775 - INFO - Results for fold 2 : [{'f1': 0.7850467289719626, 'recall': 0.711864406779661, 'precision': 0.875, 'accuracy': 0.7125, 'AP': 0.9162015211692516, 'MCC': 0.3827389503515715, 'NDCG': 0.9807267929959405, 'kappa': 0.3646408839779006, 'TN': 15, 'FP': 6, 'FN': 17, 'TP': 42}]
2025-06-17 22:56:23,113 - INFO - Cleared CUDA cache. Memory allocated: 1.33 GB, Memory reserved: 1.63 GB
2025-06-17 22:56:23,119 - INFO - Metrics stored successfully at /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/metrics/binary_metrics.csv
Model: microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext
2025-06-17 22:56:30,413 - INFO - Namespace(config='configs/hpo.yaml', fold=1, run=0, gpu=None, model_name='microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext', nb_opt_negs=100, n_trials=3, hpo_metric=None, direction=None, loss='BCE', with_title=True, with_keywords=False)
2025-06-17 22:56:30,414 - INFO - {'model_name': 'google-bert/bert-base-uncased', 'num_trials': 20, 'fold': 0, 'hpo_metric': 'eval_kappa', 'direction': 'max', 'loss_type': 'BCE', 'with_title': True, 'with_keywords': False, 'nb_optional_negs': 100}
2025-06-17 22:56:30,825 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
2025-06-17 22:56:30,825 - INFO - 
fold number 2 | run no. 1
2025-06-17 22:56:31,422 - INFO - train split size : 337
2025-06-17 22:56:31,422 - INFO - dev split size : 80
2025-06-17 22:56:31,422 - INFO - test split size : 80
2025-06-17 22:56:31,663 - INFO - 3 datasets tokenized successfully
2025-06-17 22:56:31,722 - INFO - Fold 2 max seq len = 512
2025-06-17 22:56:31,722 - INFO - Starting hyperparameter search for BCE loss
2025-06-17 22:56:33,018	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
2025-06-17 22:56:33,742	INFO tune.py:253 -- Initializing Ray automatically. For cluster usage or custom Ray initialization, call `ray.init(...)` before `tune.run(...)`.
[36m(trainable pid=150390)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=150390)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=150390)[0m 2025-06-17 22:56:42,224 - INFO - pos_weight value in TrainingArguments : 6.828424226204718
[36m(trainable pid=150390)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=150390)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=150588)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=150588)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=150588)[0m 2025-06-17 22:56:48,656 - INFO - pos_weight value in TrainingArguments : 6.094080202241274
[36m(trainable pid=150588)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=150588)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=150888)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=150888)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=150888)[0m 2025-06-17 22:56:55,045 - INFO - pos_weight value in TrainingArguments : 7.183206941666034
[36m(trainable pid=150888)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=150888)[0m   super().__init__(*args, **kwargs)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     trainable_2025-06-17_22-56-33   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-56-33
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-17_22-56-31_743712_147918/artifacts/2025-06-17_22-56-33/trainable_2025-06-17_22-56-33/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-17 22:56:35. Total running time: 0s
Logical resource usage: 0/32 CPUs, 0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_428e53ad   PENDING         6.82842       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_428e53ad started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_428e53ad config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          6.82842 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=150390)[0m [2025-06-17 22:56:42,448] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=150390)[0m [2025-06-17 22:56:45,109] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=150390)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial trainable_202d260e started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_202d260e config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          6.09408 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=150588)[0m [2025-06-17 22:56:49,023] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=150588)[0m [2025-06-17 22:56:51,652] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=150588)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=150390)[0m {'loss': 2.4419, 'grad_norm': 22.688045501708984, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}

Trial trainable_eabc1b9b started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_eabc1b9b config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          7.18321 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=150888)[0m [2025-06-17 22:56:55,284] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=150888)[0m [2025-06-17 22:56:58,067] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=150888)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 3 RUNNING
Current time: 2025-06-17 22:57:05. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_428e53ad   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ trainable_202d260e   RUNNING         6.09408       4.55539e-06         0.123031                    5 â”‚
â”‚ trainable_eabc1b9b   RUNNING         7.18321       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=150888)[0m 2025-06-17 22:57:21,690 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=150888)[0m 2025-06-17 22:57:21,696 - INFO - eval_result: {'eval_loss': 0.9488154649734497, 'eval_f1': 0.8787878787878788, 'eval_accuracy': 0.8, 'eval_kappa': 0.34224049331963013, 'eval_precision': 0.7945205479452054, 'eval_recall': 0.9830508474576272, 'eval_optim_threshold': 0.9836187958717346, 'eval_AP': 0.9415207561231318, 'eval_MCC': 0.4185025709022053, 'eval_NDCG': 0.9878900140712876, 'eval_runtime': 3.3058, 'eval_samples_per_second': 24.2, 'eval_steps_per_second': 1.21, 'epoch': 3.0}
[36m(trainable pid=150888)[0m 2025-06-17 22:57:22,119 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
2025-06-17 22:57:22,145 - INFO - Cleaning up trial eabc1b9b
2025-06-17 22:57:22,145 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-56-33/trainable_eabc1b9b_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512_2025-06-17_22-56-47

[36m(trainable pid=150888)[0m {'loss': 1.4951, 'grad_norm': 16.508567810058594, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
[36m(trainable pid=150888)[0m {'loss': 0.7886, 'grad_norm': 9.859884262084961, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}[32m [repeated 3x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(trainable pid=150888)[0m {'train_runtime': 19.8604, 'train_samples_per_second': 50.905, 'train_steps_per_second': 2.568, 'train_loss': 0.9208200118120979, 'epoch': 3.0}
[36m(trainable pid=150888)[0m STATE at ending of training  :  TrainerState(epoch=3.0, global_step=51, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=266002888614912.0, log_history=[{'loss': 1.4951, 'grad_norm': 16.508567810058594, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0, 'step': 17}, {'loss': 0.7886, 'grad_norm': 9.859884262084961, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0, 'step': 34}, {'loss': 0.4788, 'grad_norm': 22.674827575683594, 'learning_rate': 0.0, 'epoch': 3.0, 'step': 51}, {'train_runtime': 19.8604, 'train_samples_per_second': 50.905, 'train_steps_per_second': 2.568, 'total_flos': 266002888614912.0, 'train_loss': 0.9208200118120979, 'epoch': 3.0, 'step': 51}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=150888)[0m {'loss': 0.4788, 'grad_norm': 22.674827575683594, 'learning_rate': 0.0, 'epoch': 3.0}
[36m(trainable pid=150888)[0m {'eval_loss': 0.9488154649734497, 'eval_f1': 0.8787878787878788, 'eval_accuracy': 0.8, 'eval_kappa': 0.34224049331963013, 'eval_precision': 0.7945205479452054, 'eval_recall': 0.9830508474576272, 'eval_optim_threshold': 0.9836187958717346, 'eval_AP': 0.9415207561231318, 'eval_MCC': 0.4185025709022053, 'eval_NDCG': 0.9878900140712876, 'eval_runtime': 3.3058, 'eval_samples_per_second': 24.2, 'eval_steps_per_second': 1.21, 'epoch': 3.0}

Trial trainable_eabc1b9b finished iteration 1 at 2025-06-17 22:57:22. Total running time: 47s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_eabc1b9b result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    27.9435 â”‚
â”‚ time_total_s                        27.9435 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     3 â”‚
â”‚ eval_AP                             0.94152 â”‚
â”‚ eval_MCC                             0.4185 â”‚
â”‚ eval_NDCG                           0.98789 â”‚
â”‚ eval_accuracy                           0.8 â”‚
â”‚ eval_f1                             0.87879 â”‚
â”‚ eval_kappa                          0.34224 â”‚
â”‚ eval_loss                           0.94882 â”‚
â”‚ eval_optim_threshold                0.98362 â”‚
â”‚ eval_precision                      0.79452 â”‚
â”‚ eval_recall                         0.98305 â”‚
â”‚ eval_runtime                         3.3058 â”‚
â”‚ eval_samples_per_second                24.2 â”‚
â”‚ eval_steps_per_second                  1.21 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_eabc1b9b completed after 1 iterations at 2025-06-17 22:57:22. Total running time: 47s
[36m(trainable pid=150588)[0m {'loss': 1.3652, 'grad_norm': 5.265766620635986, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0}

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 22:57:35. Total running time: 1min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_428e53ad   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_202d260e   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_eabc1b9b   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.9435      0.948815    0.878788               0.8        0.34224 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=150588)[0m {'loss': 1.2967, 'grad_norm': 7.530550479888916, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0}[32m [repeated 2x across cluster][0m
[36m(trainable pid=150390)[0m {'loss': 1.5316, 'grad_norm': 13.063814163208008, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0}[32m [repeated 2x across cluster][0m
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 22:58:05. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_428e53ad   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_202d260e   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_eabc1b9b   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.9435      0.948815    0.878788               0.8        0.34224 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=150390)[0m 2025-06-17 22:58:12,297 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=150390)[0m 2025-06-17 22:58:12,303 - INFO - eval_result: {'eval_loss': 1.4503227472305298, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8320696353912354, 'eval_AP': 0.7589338128584598, 'eval_MCC': 0.0, 'eval_NDCG': 0.9257230176963771, 'eval_runtime': 4.069, 'eval_samples_per_second': 19.661, 'eval_steps_per_second': 0.983, 'epoch': 6.0}
[36m(trainable pid=150588)[0m 2025-06-17 22:58:12,316 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=150588)[0m 2025-06-17 22:58:12,324 - INFO - eval_result: {'eval_loss': 1.0742549896240234, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8803210258483887, 'eval_AP': 0.8316128053651, 'eval_MCC': 0.0, 'eval_NDCG': 0.9578748483470938, 'eval_runtime': 4.1672, 'eval_samples_per_second': 19.198, 'eval_steps_per_second': 0.96, 'epoch': 5.0}
2025-06-17 22:58:12,655 - INFO - Cleaning up trial 428e53ad
2025-06-17 22:58:12,656 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-56-33/trainable_428e53ad_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-17_22-56-34
2025-06-17 22:58:12,656 - INFO - Current best: eabc1b9b with eval_kappa : 0.34224049331963013 at iteration 1
2025-06-17 22:58:12,674 - INFO - Cleaning up trial 202d260e
2025-06-17 22:58:12,674 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-56-33/trainable_202d260e_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-17_22-56-41
2025-06-17 22:58:12,674 - INFO - Cleaning up trial 428e53ad
2025-06-17 22:58:12,674 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-56-33/trainable_428e53ad_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-17_22-56-34
2025-06-17 22:58:12,674 - INFO - Current best: eabc1b9b with eval_kappa : 0.34224049331963013 at iteration 1
2025-06-17 22:58:12,682	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-56-33' in 0.0059s.

[36m(trainable pid=150390)[0m {'train_runtime': 82.7805, 'train_samples_per_second': 24.426, 'train_steps_per_second': 1.232, 'train_loss': 1.806437847661037, 'epoch': 6.0}
[36m(trainable pid=150390)[0m STATE at ending of training  :  TrainerState(epoch=6.0, global_step=102, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=532005777229824.0, log_history=[{'loss': 2.4419, 'grad_norm': 22.688045501708984, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0, 'step': 17}, {'loss': 2.007, 'grad_norm': 15.195877075195312, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0, 'step': 34}, {'loss': 1.7263, 'grad_norm': 6.383484840393066, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0, 'step': 51}, {'loss': 1.6038, 'grad_norm': 8.243053436279297, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0, 'step': 68}, {'loss': 1.5316, 'grad_norm': 13.063814163208008, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0, 'step': 85}, {'loss': 1.5282, 'grad_norm': 7.873587608337402, 'learning_rate': 0.0, 'epoch': 6.0, 'step': 102}, {'train_runtime': 82.7805, 'train_samples_per_second': 24.426, 'train_steps_per_second': 1.232, 'total_flos': 532005777229824.0, 'train_loss': 1.806437847661037, 'epoch': 6.0, 'step': 102}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=150390)[0m {'loss': 1.5282, 'grad_norm': 7.873587608337402, 'learning_rate': 0.0, 'epoch': 6.0}[32m [repeated 2x across cluster][0m
[36m(trainable pid=150588)[0m STATE at ending of training  :  TrainerState(epoch=5.0, global_step=85, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=443338147691520.0, log_history=[{'loss': 1.8394, 'grad_norm': 8.1826753616333, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0, 'step': 17}, {'loss': 1.3652, 'grad_norm': 5.265766620635986, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0, 'step': 34}, {'loss': 1.2967, 'grad_norm': 7.530550479888916, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0, 'step': 51}, {'loss': 1.2442, 'grad_norm': 5.374694347381592, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0, 'step': 68}, {'loss': 1.2102, 'grad_norm': 7.3833746910095215, 'learning_rate': 0.0, 'epoch': 5.0, 'step': 85}, {'train_runtime': 76.1642, 'train_samples_per_second': 22.123, 'train_steps_per_second': 1.116, 'total_flos': 443338147691520.0, 'train_loss': 1.391162401087144, 'epoch': 5.0, 'step': 85}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=150390)[0m {'eval_loss': 1.4503227472305298, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8320696353912354, 'eval_AP': 0.7589338128584598, 'eval_MCC': 0.0, 'eval_NDCG': 0.9257230176963771, 'eval_runtime': 4.069, 'eval_samples_per_second': 19.661, 'eval_steps_per_second': 0.983, 'epoch': 6.0}

Trial trainable_428e53ad finished iteration 1 at 2025-06-17 22:58:12. Total running time: 1min 37s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_428e53ad result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    91.2585 â”‚
â”‚ time_total_s                        91.2585 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     6 â”‚
â”‚ eval_AP                             0.75893 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.92572 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.45032 â”‚
â”‚ eval_optim_threshold                0.83207 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                          4.069 â”‚
â”‚ eval_samples_per_second              19.661 â”‚
â”‚ eval_steps_per_second                 0.983 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_428e53ad completed after 1 iterations at 2025-06-17 22:58:12. Total running time: 1min 37s

Trial trainable_202d260e finished iteration 1 at 2025-06-17 22:58:12. Total running time: 1min 37s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_202d260e result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                     84.888 â”‚
â”‚ time_total_s                         84.888 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     5 â”‚
â”‚ eval_AP                             0.83161 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.95787 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.07425 â”‚
â”‚ eval_optim_threshold                0.88032 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         4.1672 â”‚
â”‚ eval_samples_per_second              19.198 â”‚
â”‚ eval_steps_per_second                  0.96 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_202d260e completed after 1 iterations at 2025-06-17 22:58:12. Total running time: 1min 37s

Trial status: 3 TERMINATED
Current time: 2025-06-17 22:58:12. Total running time: 1min 37s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_428e53ad   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1            91.2585      1.45032     0.848921            0.7375        0       â”‚
â”‚ trainable_202d260e   TERMINATED        6.09408       4.55539e-06         0.123031                    5        1            84.888       1.07425     0.848921            0.7375        0       â”‚
â”‚ trainable_eabc1b9b   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.9435      0.948815    0.878788            0.8           0.34224 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯2025-06-17 22:58:12,688 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x71a465396b10>
2025-06-17 22:58:12,688 - INFO - Best trial : trainable_eabc1b9b
2025-06-17 22:58:12,688 - INFO - Best config : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-17 22:58:12,688 - INFO - Best trial after optimization: {'eval_loss': 0.9488154649734497, 'eval_f1': 0.8787878787878788, 'eval_accuracy': 0.8, 'eval_kappa': 0.34224049331963013, 'eval_precision': 0.7945205479452054, 'eval_recall': 0.9830508474576272, 'eval_optim_threshold': 0.9836187958717346, 'eval_AP': 0.9415207561231318, 'eval_MCC': 0.4185025709022053, 'eval_NDCG': 0.9878900140712876, 'eval_runtime': 3.3058, 'eval_samples_per_second': 24.2, 'eval_steps_per_second': 1.21, 'epoch': 3.0, 'timestamp': 1750193842, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': 'eabc1b9b', 'date': '2025-06-17_22-57-22', 'time_this_iter_s': 27.943530559539795, 'time_total_s': 27.943530559539795, 'pid': 150888, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 27.943530559539795, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512'}
2025-06-17 22:58:12,712 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   1.450323  0.848921  ...                        6  428e53ad
1   1.074255  0.848921  ...                        5  202d260e
2   0.948815  0.878788  ...                        3  eabc1b9b

[3 rows x 32 columns]
[36m(trainable pid=150390)[0m 2025-06-17 22:58:12,634 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
2025-06-17 22:58:12,879 - INFO - Trial comparison plot saved
2025-06-17 22:58:12,888 - INFO - Best Hyperparameters after HPO : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}


[36m(trainable pid=150588)[0m 2025-06-17 22:58:12,654 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(trainable pid=150588)[0m {'train_runtime': 76.1642, 'train_samples_per_second': 22.123, 'train_steps_per_second': 1.116, 'train_loss': 1.391162401087144, 'epoch': 5.0}
[36m(trainable pid=150588)[0m {'loss': 1.2102, 'grad_norm': 7.3833746910095215, 'learning_rate': 0.0, 'epoch': 5.0}
[36m(trainable pid=150588)[0m {'eval_loss': 1.0742549896240234, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8803210258483887, 'eval_AP': 0.8316128053651, 'eval_MCC': 0.0, 'eval_NDCG': 0.9578748483470938, 'eval_runtime': 4.1672, 'eval_samples_per_second': 19.198, 'eval_steps_per_second': 0.96, 'epoch': 5.0}
2025-06-17 22:58:21,976 - INFO - Namespace(config='configs/train.yaml', hp_config='configs/best_hpo.yaml', fold=1, run=0, gpu='2', model_name='microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext', nb_opt_negs=100, loss='BCE', with_title=True, with_keywords=False, best_metric=None)
2025-06-17 22:58:21,977 - INFO - {'model_name': 'bert-base-uncased', 'fold': 0, 'run': 0, 'output_dir': 'outputs/checkpoints', 'best_metric': 'eval_kappa', 'loss_type': 'BCE', 'nb_optional_negs': 100, 'with_title': True, 'with_keywords': False, 'default_hyperparameters': {'learning_rate': 'None', 'num_train_epochs': 'None', 'pos_weight': 'None', 'weight_decay': 'None'}}
2025-06-17 22:58:22,773 - INFO - train split size : 337
2025-06-17 22:58:22,773 - INFO - dev split size : 80
2025-06-17 22:58:22,773 - INFO - test split size : 80
2025-06-17 22:58:23,022 - INFO - 3 datasets tokenized successfully
2025-06-17 22:58:23,022 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-17 22:58:23,763 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
[2025-06-17 22:58:23,988] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-06-17 22:58:26,745] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
2025-06-17 22:58:26,781 - INFO - training size : 337
2025-06-17 22:58:26,781 - INFO - dev size : 80
2025-06-17 22:58:26,781 - INFO - test size : 80
  0%|          | 0/12 [00:00<?, ?it/s]  8%|â–Š         | 1/12 [00:02<00:26,  2.37s/it] 17%|â–ˆâ–‹        | 2/12 [00:04<00:20,  2.05s/it] 25%|â–ˆâ–ˆâ–Œ       | 3/12 [00:05<00:17,  1.92s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [00:06<00:11,  1.43s/it]                                               33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [00:06<00:11,  1.43s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 5/12 [00:08<00:11,  1.60s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 6/12 [00:10<00:10,  1.68s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 7/12 [00:12<00:08,  1.71s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [00:12<00:05,  1.38s/it]                                               67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [00:12<00:05,  1.38s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 9/12 [00:14<00:04,  1.54s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 10/12 [00:16<00:03,  1.64s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 11/12 [00:18<00:01,  1.68s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:19<00:00,  1.38s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:21<00:00,  1.38s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:21<00:00,  1.38s/it]2025-06-17 22:58:48,578 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:21<00:00,  1.79s/it]
{'loss': 1.8496, 'grad_norm': 3.2476067543029785, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
{'loss': 1.3497, 'grad_norm': 10.158608436584473, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
{'loss': 1.1348, 'grad_norm': 4.9322123527526855, 'learning_rate': 0.0, 'epoch': 3.0}
{'train_runtime': 21.5168, 'train_samples_per_second': 46.986, 'train_steps_per_second': 0.558, 'train_loss': 1.4447058041890461, 'epoch': 3.0}
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 22:58:51,878 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.79s/it]
2025-06-17 22:58:51,884 - INFO - Training time : 28.86193067394197
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 22:58:55,103 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.71s/it]
2025-06-17 22:58:55,107 - INFO - Evaluation time : 3.22350732202176
2025-06-17 22:58:55,108 - INFO - Evaluation results on test set: {'eval_loss': 1.0158674716949463, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9488909840583801, 'eval_AP': 0.8957178780268975, 'eval_MCC': 0.0, 'eval_NDCG': 0.9784633853052342, 'eval_runtime': 3.2114, 'eval_samples_per_second': 24.911, 'eval_steps_per_second': 0.311, 'epoch': 3.0}
2025-06-17 22:58:55,108 - INFO - Total updates (optimizer steps): 12
2025-06-17 22:58:55,108 - INFO - Avg time / step: 1.792s
2025-06-17 22:58:55,806 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCE_BiomedBERT-abs-ft_fold-2
2025-06-17 22:58:55,807 - INFO - On test Set (with threshold 0.5) : 
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 22:58:59,126 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.81s/it]
2025-06-17 22:58:59,129 - INFO - Raw predictions shape: (80, 1)
2025-06-17 22:58:59,130 - INFO - Raw predictions: [[2.3462481]
 [2.9719548]
 [2.3767235]
 [3.1094942]
 [2.163277 ]
 [2.7706501]
 [2.9829323]
 [2.3784842]
 [2.8953202]
 [1.8278311]]
2025-06-17 22:58:59,130 - INFO - Scores shape: (80,)
2025-06-17 22:58:59,130 - INFO - Scores: [0.9126355  0.9512909  0.91503507 0.9572827  0.896903   0.94106907
 0.95179707 0.91517186 0.94761467 0.8615032 ]
2025-06-17 22:58:59,130 - INFO - Preds shape: (80,)
2025-06-17 22:58:59,130 - INFO - Preds: [1 1 1 1 1 1 1 1 1 1]
2025-06-17 22:58:59,130 - INFO - Test labels shape: (80,)
2025-06-17 22:58:59,130 - INFO - Test labels: [1, 1, 1, 1, 1, 1, 1, 0, 1, 0]
2025-06-17 22:58:59,130 - INFO - Test split: Dataset({
    features: ['Unnamed: 0', 'title', 'abstract', 'Keywords', 'doi', 'labels'],
    num_rows: 80
})
2025-06-17 22:58:59,131 - INFO - Unique values in predictions: [1]
2025-06-17 22:58:59,131 - INFO - Unique values in labels: [0 1]
2025-06-17 22:58:59,132 - INFO - Confusion matrix:
[[ 0 21]
 [ 0 59]]
2025-06-17 22:58:59,132 - INFO - Confusion matrix: TN=0, FP=21, FN=0, TP=59
2025-06-17 22:59:01,850 - INFO - Metrics: {'f1': 0.8489208633093526, 'recall': 1.0, 'precision': 0.7375, 'accuracy': 0.7375, 'AP': 0.8957178780268975, 'MCC': 0.0, 'NDCG': 0.9784633853052342, 'kappa': 0.0, 'TN': 0, 'FP': 21, 'FN': 0, 'TP': 59}
2025-06-17 22:59:01,962 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-17 22:59:02,056 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 22:59:02,056 - INFO - 
On test Set (optimal threshold of 0.9290031790733337 according to cross validation on the training set): 
2025-06-17 22:59:02,057 - INFO - Confusion matrix: TN=14, FP=7, FN=19, TP=40
2025-06-17 22:59:05,132 - INFO - Metrics: {'f1': 0.7547169811320755, 'recall': 0.6779661016949152, 'precision': 0.851063829787234, 'accuracy': 0.675, 'AP': 0.8957178780268975, 'MCC': 0.3080252529801705, 'NDCG': 0.9784633853052342, 'kappa': 0.29107021131561006, 'TN': 14, 'FP': 7, 'FN': 19, 'TP': 40}
2025-06-17 22:59:05,228 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 22:59:05,228 - INFO - Results for fold 2 : [{'f1': 0.7547169811320755, 'recall': 0.6779661016949152, 'precision': 0.851063829787234, 'accuracy': 0.675, 'AP': 0.8957178780268975, 'MCC': 0.3080252529801705, 'NDCG': 0.9784633853052342, 'kappa': 0.29107021131561006, 'TN': 14, 'FP': 7, 'FN': 19, 'TP': 40}]
2025-06-17 22:59:05,553 - INFO - Cleared CUDA cache. Memory allocated: 1.33 GB, Memory reserved: 1.63 GB
2025-06-17 22:59:05,558 - INFO - Metrics stored successfully at /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/metrics/binary_metrics.csv
Model: FacebookAI/roberta-base
2025-06-17 22:59:12,951 - INFO - Namespace(config='configs/hpo.yaml', fold=1, run=0, gpu=None, model_name='FacebookAI/roberta-base', nb_opt_negs=100, n_trials=3, hpo_metric=None, direction=None, loss='BCE', with_title=True, with_keywords=False)
2025-06-17 22:59:12,952 - INFO - {'model_name': 'google-bert/bert-base-uncased', 'num_trials': 20, 'fold': 0, 'hpo_metric': 'eval_kappa', 'direction': 'max', 'loss_type': 'BCE', 'with_title': True, 'with_keywords': False, 'nb_optional_negs': 100}
2025-06-17 22:59:13,469 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
2025-06-17 22:59:13,469 - INFO - 
fold number 2 | run no. 1
2025-06-17 22:59:14,076 - INFO - train split size : 337
2025-06-17 22:59:14,076 - INFO - dev split size : 80
2025-06-17 22:59:14,076 - INFO - test split size : 80
2025-06-17 22:59:14,361 - INFO - 3 datasets tokenized successfully
2025-06-17 22:59:14,423 - INFO - Fold 2 max seq len = 512
2025-06-17 22:59:14,423 - INFO - Starting hyperparameter search for BCE loss
2025-06-17 22:59:15,758	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
2025-06-17 22:59:16,507	INFO tune.py:253 -- Initializing Ray automatically. For cluster usage or custom Ray initialization, call `ray.init(...)` before `tune.run(...)`.
[36m(trainable pid=155355)[0m Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at FacebookAI/roberta-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
[36m(trainable pid=155355)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=155355)[0m 2025-06-17 22:59:24,961 - INFO - pos_weight value in TrainingArguments : 6.828424226204718
[36m(trainable pid=155355)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=155355)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=155553)[0m Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at FacebookAI/roberta-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
[36m(trainable pid=155553)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=155553)[0m 2025-06-17 22:59:31,298 - INFO - pos_weight value in TrainingArguments : 6.094080202241274
[36m(trainable pid=155553)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=155553)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=155940)[0m Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at FacebookAI/roberta-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
[36m(trainable pid=155940)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=155940)[0m 2025-06-17 22:59:37,557 - INFO - pos_weight value in TrainingArguments : 7.183206941666034
[36m(trainable pid=155940)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=155940)[0m   super().__init__(*args, **kwargs)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     trainable_2025-06-17_22-59-16   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-59-16
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-17_22-59-14_444567_152915/artifacts/2025-06-17_22-59-16/trainable_2025-06-17_22-59-16/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-17 22:59:17. Total running time: 0s
Logical resource usage: 0/32 CPUs, 0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_0cc3df90   PENDING         6.82842       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_0cc3df90 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_0cc3df90 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          6.82842 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=155355)[0m [2025-06-17 22:59:25,227] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=155355)[0m [2025-06-17 22:59:27,914] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=155355)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial trainable_8a6d273c started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_8a6d273c config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          6.09408 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=155553)[0m [2025-06-17 22:59:31,726] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=155553)[0m [2025-06-17 22:59:34,503] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=155553)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=155355)[0m {'loss': 2.5944, 'grad_norm': 14.979754447937012, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}

Trial trainable_8a985dc5 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_8a985dc5 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          7.18321 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=155940)[0m [2025-06-17 22:59:37,827] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=155940)[0m [2025-06-17 22:59:40,683] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=155940)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 3 RUNNING
Current time: 2025-06-17 22:59:47. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_0cc3df90   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ trainable_8a6d273c   RUNNING         6.09408       4.55539e-06         0.123031                    5 â”‚
â”‚ trainable_8a985dc5   RUNNING         7.18321       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=155940)[0m 2025-06-17 23:00:04,352 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=155940)[0m 2025-06-17 23:00:04,359 - INFO - eval_result: {'eval_loss': 1.002692699432373, 'eval_f1': 0.8529411764705882, 'eval_accuracy': 0.75, 'eval_kappa': 0.10813823857302107, 'eval_precision': 0.7532467532467533, 'eval_recall': 0.9830508474576272, 'eval_optim_threshold': 0.9584366083145142, 'eval_AP': 0.9466386417327105, 'eval_MCC': 0.1813134790046414, 'eval_NDCG': 0.9894647309043242, 'eval_runtime': 3.4457, 'eval_samples_per_second': 23.218, 'eval_steps_per_second': 1.161, 'epoch': 3.0}
[36m(trainable pid=155940)[0m 2025-06-17 23:00:04,811 - INFO - Cleared CUDA cache. Memory allocated: 1.54 GB, Memory reserved: 1.71 GB
2025-06-17 23:00:04,847 - INFO - Cleaning up trial 8a985dc5
2025-06-17 23:00:04,847 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-59-16/trainable_8a985dc5_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512_2025-06-17_22-59-30

[36m(trainable pid=155940)[0m {'loss': 1.7227, 'grad_norm': 6.435796737670898, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
[36m(trainable pid=155940)[0m {'loss': 1.0897, 'grad_norm': 11.059221267700195, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}[32m [repeated 3x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(trainable pid=155940)[0m {'train_runtime': 19.7559, 'train_samples_per_second': 51.175, 'train_steps_per_second': 2.582, 'train_loss': 1.2969273211909276, 'epoch': 3.0}
[36m(trainable pid=155940)[0m STATE at ending of training  :  TrainerState(epoch=3.0, global_step=51, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=266002888614912.0, log_history=[{'loss': 1.7227, 'grad_norm': 6.435796737670898, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0, 'step': 17}, {'loss': 1.0897, 'grad_norm': 11.059221267700195, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0, 'step': 34}, {'loss': 1.0784, 'grad_norm': 6.0254034996032715, 'learning_rate': 0.0, 'epoch': 3.0, 'step': 51}, {'train_runtime': 19.7559, 'train_samples_per_second': 51.175, 'train_steps_per_second': 2.582, 'total_flos': 266002888614912.0, 'train_loss': 1.2969273211909276, 'epoch': 3.0, 'step': 51}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=155940)[0m {'loss': 1.0784, 'grad_norm': 6.0254034996032715, 'learning_rate': 0.0, 'epoch': 3.0}
[36m(trainable pid=155940)[0m {'eval_loss': 1.002692699432373, 'eval_f1': 0.8529411764705882, 'eval_accuracy': 0.75, 'eval_kappa': 0.10813823857302107, 'eval_precision': 0.7532467532467533, 'eval_recall': 0.9830508474576272, 'eval_optim_threshold': 0.9584366083145142, 'eval_AP': 0.9466386417327105, 'eval_MCC': 0.1813134790046414, 'eval_NDCG': 0.9894647309043242, 'eval_runtime': 3.4457, 'eval_samples_per_second': 23.218, 'eval_steps_per_second': 1.161, 'epoch': 3.0}

Trial trainable_8a985dc5 finished iteration 1 at 2025-06-17 23:00:04. Total running time: 47s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_8a985dc5 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    27.9206 â”‚
â”‚ time_total_s                        27.9206 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     3 â”‚
â”‚ eval_AP                             0.94664 â”‚
â”‚ eval_MCC                            0.18131 â”‚
â”‚ eval_NDCG                           0.98946 â”‚
â”‚ eval_accuracy                          0.75 â”‚
â”‚ eval_f1                             0.85294 â”‚
â”‚ eval_kappa                          0.10814 â”‚
â”‚ eval_loss                           1.00269 â”‚
â”‚ eval_optim_threshold                0.95844 â”‚
â”‚ eval_precision                      0.75325 â”‚
â”‚ eval_recall                         0.98305 â”‚
â”‚ eval_runtime                         3.4457 â”‚
â”‚ eval_samples_per_second              23.218 â”‚
â”‚ eval_steps_per_second                 1.161 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_8a985dc5 completed after 1 iterations at 2025-06-17 23:00:04. Total running time: 47s
[36m(trainable pid=155355)[0m {'loss': 2.3446, 'grad_norm': 7.071710586547852, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0}

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 23:00:17. Total running time: 1min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_0cc3df90   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_8a6d273c   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_8a985dc5   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.9206       1.00269    0.852941              0.75       0.108138 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=155355)[0m {'loss': 2.2268, 'grad_norm': 9.087498664855957, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0}[32m [repeated 2x across cluster][0m
[36m(trainable pid=155355)[0m {'loss': 2.1674, 'grad_norm': 18.771404266357422, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0}[32m [repeated 2x across cluster][0m
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 23:00:47. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_0cc3df90   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_8a6d273c   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_8a985dc5   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.9206       1.00269    0.852941              0.75       0.108138 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=155355)[0m 2025-06-17 23:00:55,128 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=155355)[0m 2025-06-17 23:00:55,133 - INFO - eval_result: {'eval_loss': 2.6087841987609863, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.6412272453308105, 'eval_AP': 0.7005423961178995, 'eval_MCC': 0.0, 'eval_NDCG': 0.8905309316559773, 'eval_runtime': 4.0117, 'eval_samples_per_second': 19.942, 'eval_steps_per_second': 0.997, 'epoch': 6.0}
[36m(trainable pid=155553)[0m 2025-06-17 23:00:55,322 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=155553)[0m 2025-06-17 23:00:55,328 - INFO - eval_result: {'eval_loss': 1.1259483098983765, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8802217245101929, 'eval_AP': 0.8578088183213749, 'eval_MCC': 0.0, 'eval_NDCG': 0.9671814437776592, 'eval_runtime': 3.5815, 'eval_samples_per_second': 22.337, 'eval_steps_per_second': 1.117, 'epoch': 5.0}
2025-06-17 23:00:55,470 - INFO - Cleaning up trial 0cc3df90
2025-06-17 23:00:55,471 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-59-16/trainable_0cc3df90_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-17_22-59-17
2025-06-17 23:00:55,471 - INFO - Current best: 8a985dc5 with eval_kappa : 0.10813823857302107 at iteration 1
[36m(trainable pid=155355)[0m 2025-06-17 23:00:55,441 - INFO - Cleared CUDA cache. Memory allocated: 1.54 GB, Memory reserved: 1.71 GB
2025-06-17 23:00:55,805 - INFO - Cleaning up trial 8a6d273c
2025-06-17 23:00:55,806 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-59-16/trainable_8a6d273c_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-17_22-59-24
2025-06-17 23:00:55,806 - INFO - Cleaning up trial 0cc3df90
2025-06-17 23:00:55,806 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-59-16/trainable_0cc3df90_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-17_22-59-17
2025-06-17 23:00:55,806 - INFO - Current best: 8a985dc5 with eval_kappa : 0.10813823857302107 at iteration 1
2025-06-17 23:00:55,814	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_22-59-16' in 0.0060s.

[36m(trainable pid=155355)[0m {'train_runtime': 82.8647, 'train_samples_per_second': 24.401, 'train_steps_per_second': 1.231, 'train_loss': 2.321103189505783, 'epoch': 6.0}
[36m(trainable pid=155355)[0m STATE at ending of training  :  TrainerState(epoch=6.0, global_step=102, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=532005777229824.0, log_history=[{'loss': 2.5944, 'grad_norm': 14.979754447937012, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0, 'step': 17}, {'loss': 2.4742, 'grad_norm': 11.114909172058105, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0, 'step': 34}, {'loss': 2.3446, 'grad_norm': 7.071710586547852, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0, 'step': 51}, {'loss': 2.2268, 'grad_norm': 9.087498664855957, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0, 'step': 68}, {'loss': 2.1674, 'grad_norm': 18.771404266357422, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0, 'step': 85}, {'loss': 2.1192, 'grad_norm': 12.7408447265625, 'learning_rate': 0.0, 'epoch': 6.0, 'step': 102}, {'train_runtime': 82.8647, 'train_samples_per_second': 24.401, 'train_steps_per_second': 1.231, 'total_flos': 532005777229824.0, 'train_loss': 2.321103189505783, 'epoch': 6.0, 'step': 102}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=155355)[0m {'loss': 2.1192, 'grad_norm': 12.7408447265625, 'learning_rate': 0.0, 'epoch': 6.0}[32m [repeated 2x across cluster][0m
[36m(trainable pid=155553)[0m STATE at ending of training  :  TrainerState(epoch=5.0, global_step=85, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=443338147691520.0, log_history=[{'loss': 2.1604, 'grad_norm': 9.433178901672363, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0, 'step': 17}, {'loss': 1.7658, 'grad_norm': 7.297574043273926, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0, 'step': 34}, {'loss': 1.4384, 'grad_norm': 5.818294525146484, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0, 'step': 51}, {'loss': 1.3243, 'grad_norm': 8.42508316040039, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0, 'step': 68}, {'loss': 1.3593, 'grad_norm': 6.9603271484375, 'learning_rate': 0.0, 'epoch': 5.0, 'step': 85}, {'train_runtime': 76.7597, 'train_samples_per_second': 21.952, 'train_steps_per_second': 1.107, 'total_flos': 443338147691520.0, 'train_loss': 1.609649523566751, 'epoch': 5.0, 'step': 85}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=155355)[0m {'eval_loss': 2.6087841987609863, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.6412272453308105, 'eval_AP': 0.7005423961178995, 'eval_MCC': 0.0, 'eval_NDCG': 0.8905309316559773, 'eval_runtime': 4.0117, 'eval_samples_per_second': 19.942, 'eval_steps_per_second': 0.997, 'epoch': 6.0}

Trial trainable_0cc3df90 finished iteration 1 at 2025-06-17 23:00:55. Total running time: 1min 37s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_0cc3df90 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    91.1677 â”‚
â”‚ time_total_s                        91.1677 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     6 â”‚
â”‚ eval_AP                             0.70054 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.89053 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           2.60878 â”‚
â”‚ eval_optim_threshold                0.64123 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         4.0117 â”‚
â”‚ eval_samples_per_second              19.942 â”‚
â”‚ eval_steps_per_second                 0.997 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_0cc3df90 completed after 1 iterations at 2025-06-17 23:00:55. Total running time: 1min 37s

Trial trainable_8a6d273c finished iteration 1 at 2025-06-17 23:00:55. Total running time: 1min 38s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_8a6d273c result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    85.1391 â”‚
â”‚ time_total_s                        85.1391 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     5 â”‚
â”‚ eval_AP                             0.85781 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.96718 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.12595 â”‚
â”‚ eval_optim_threshold                0.88022 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.5815 â”‚
â”‚ eval_samples_per_second              22.337 â”‚
â”‚ eval_steps_per_second                 1.117 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_8a6d273c completed after 1 iterations at 2025-06-17 23:00:55. Total running time: 1min 38s

Trial status: 3 TERMINATED
Current time: 2025-06-17 23:00:55. Total running time: 1min 38s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_0cc3df90   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1            91.1677       2.60878    0.848921            0.7375       0        â”‚
â”‚ trainable_8a6d273c   TERMINATED        6.09408       4.55539e-06         0.123031                    5        1            85.1391       1.12595    0.848921            0.7375       0        â”‚
â”‚ trainable_8a985dc5   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.9206       1.00269    0.852941            0.75         0.108138 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯2025-06-17 23:00:55,820 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x71263d716650>
2025-06-17 23:00:55,820 - INFO - Best trial : trainable_8a985dc5
2025-06-17 23:00:55,820 - INFO - Best config : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-17 23:00:55,820 - INFO - Best trial after optimization: {'eval_loss': 1.002692699432373, 'eval_f1': 0.8529411764705882, 'eval_accuracy': 0.75, 'eval_kappa': 0.10813823857302107, 'eval_precision': 0.7532467532467533, 'eval_recall': 0.9830508474576272, 'eval_optim_threshold': 0.9584366083145142, 'eval_AP': 0.9466386417327105, 'eval_MCC': 0.1813134790046414, 'eval_NDCG': 0.9894647309043242, 'eval_runtime': 3.4457, 'eval_samples_per_second': 23.218, 'eval_steps_per_second': 1.161, 'epoch': 3.0, 'timestamp': 1750194004, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '8a985dc5', 'date': '2025-06-17_23-00-04', 'time_this_iter_s': 27.920576572418213, 'time_total_s': 27.920576572418213, 'pid': 155940, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 27.920576572418213, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512'}
2025-06-17 23:00:55,842 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   2.608784  0.848921  ...                        6  0cc3df90
1   1.125948  0.848921  ...                        5  8a6d273c
2   1.002693  0.852941  ...                        3  8a985dc5

[3 rows x 32 columns]
2025-06-17 23:00:55,965 - INFO - Trial comparison plot saved
2025-06-17 23:00:55,981 - INFO - Best Hyperparameters after HPO : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}


[36m(trainable pid=155553)[0m 2025-06-17 23:00:55,772 - INFO - Cleared CUDA cache. Memory allocated: 1.54 GB, Memory reserved: 1.71 GB
[36m(trainable pid=155553)[0m {'train_runtime': 76.7597, 'train_samples_per_second': 21.952, 'train_steps_per_second': 1.107, 'train_loss': 1.609649523566751, 'epoch': 5.0}
[36m(trainable pid=155553)[0m {'loss': 1.3593, 'grad_norm': 6.9603271484375, 'learning_rate': 0.0, 'epoch': 5.0}
[36m(trainable pid=155553)[0m {'eval_loss': 1.1259483098983765, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8802217245101929, 'eval_AP': 0.8578088183213749, 'eval_MCC': 0.0, 'eval_NDCG': 0.9671814437776592, 'eval_runtime': 3.5815, 'eval_samples_per_second': 22.337, 'eval_steps_per_second': 1.117, 'epoch': 5.0}
2025-06-17 23:01:04,812 - INFO - Namespace(config='configs/train.yaml', hp_config='configs/best_hpo.yaml', fold=1, run=0, gpu='2', model_name='FacebookAI/roberta-base', nb_opt_negs=100, loss='BCE', with_title=True, with_keywords=False, best_metric=None)
2025-06-17 23:01:04,814 - INFO - {'model_name': 'bert-base-uncased', 'fold': 0, 'run': 0, 'output_dir': 'outputs/checkpoints', 'best_metric': 'eval_kappa', 'loss_type': 'BCE', 'nb_optional_negs': 100, 'with_title': True, 'with_keywords': False, 'default_hyperparameters': {'learning_rate': 'None', 'num_train_epochs': 'None', 'pos_weight': 'None', 'weight_decay': 'None'}}
2025-06-17 23:01:05,713 - INFO - train split size : 337
2025-06-17 23:01:05,713 - INFO - dev split size : 80
2025-06-17 23:01:05,713 - INFO - test split size : 80
2025-06-17 23:01:06,011 - INFO - 3 datasets tokenized successfully
2025-06-17 23:01:06,012 - INFO - Final training...
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at FacebookAI/roberta-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-17 23:01:06,369 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
[2025-06-17 23:01:06,619] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-06-17 23:01:09,295] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
2025-06-17 23:01:09,334 - INFO - training size : 337
2025-06-17 23:01:09,334 - INFO - dev size : 80
2025-06-17 23:01:09,334 - INFO - test size : 80
  0%|          | 0/12 [00:00<?, ?it/s]  8%|â–Š         | 1/12 [00:02<00:25,  2.31s/it] 17%|â–ˆâ–‹        | 2/12 [00:04<00:20,  2.01s/it] 25%|â–ˆâ–ˆâ–Œ       | 3/12 [00:05<00:17,  1.89s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [00:06<00:11,  1.41s/it]                                               33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [00:06<00:11,  1.41s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 5/12 [00:08<00:10,  1.57s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 6/12 [00:10<00:09,  1.65s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 7/12 [00:11<00:08,  1.69s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [00:12<00:05,  1.36s/it]                                               67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [00:12<00:05,  1.36s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 9/12 [00:14<00:04,  1.52s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 10/12 [00:16<00:03,  1.60s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 11/12 [00:18<00:01,  1.65s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:18<00:00,  1.36s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:21<00:00,  1.36s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:21<00:00,  1.36s/it]2025-06-17 23:01:31,028 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:21<00:00,  1.78s/it]
{'loss': 2.409, 'grad_norm': 6.30391263961792, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
{'loss': 1.5332, 'grad_norm': 9.24670696258545, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
{'loss': 1.4391, 'grad_norm': 4.802410125732422, 'learning_rate': 0.0, 'epoch': 3.0}
{'train_runtime': 21.4113, 'train_samples_per_second': 47.218, 'train_steps_per_second': 0.56, 'train_loss': 1.793748378753662, 'epoch': 3.0}
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 23:01:34,318 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.80s/it]
2025-06-17 23:01:34,325 - INFO - Training time : 28.313034512102604
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 23:01:37,630 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.81s/it]
2025-06-17 23:01:37,635 - INFO - Evaluation time : 3.3098873909329996
2025-06-17 23:01:37,635 - INFO - Evaluation results on test set: {'eval_loss': 1.2425124645233154, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8794946670532227, 'eval_AP': 0.8555169441110554, 'eval_MCC': 0.0, 'eval_NDCG': 0.9686168130896343, 'eval_runtime': 3.2983, 'eval_samples_per_second': 24.255, 'eval_steps_per_second': 0.303, 'epoch': 3.0}
2025-06-17 23:01:37,635 - INFO - Total updates (optimizer steps): 12
2025-06-17 23:01:37,635 - INFO - Avg time / step: 1.786s
2025-06-17 23:01:38,502 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCE_roberta-base_fold-2
2025-06-17 23:01:38,502 - INFO - On test Set (with threshold 0.5) : 
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 23:01:41,943 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.95s/it]
2025-06-17 23:01:41,946 - INFO - Raw predictions shape: (80, 1)
2025-06-17 23:01:41,947 - INFO - Raw predictions: [[1.9307046]
 [2.0307634]
 [1.8318362]
 [2.0489287]
 [1.8735929]
 [1.8388066]
 [2.074062 ]
 [1.7297688]
 [1.9867887]
 [1.9235594]]
2025-06-17 23:01:41,947 - INFO - Scores shape: (80,)
2025-06-17 23:01:41,947 - INFO - Scores: [0.8733274  0.88398933 0.8619803  0.88583934 0.86687344 0.8628075
 0.88835645 0.8493829  0.87940294 0.8725348 ]
2025-06-17 23:01:41,947 - INFO - Preds shape: (80,)
2025-06-17 23:01:41,947 - INFO - Preds: [1 1 1 1 1 1 1 1 1 1]
2025-06-17 23:01:41,947 - INFO - Test labels shape: (80,)
2025-06-17 23:01:41,948 - INFO - Test labels: [1, 1, 1, 1, 1, 1, 1, 0, 1, 0]
2025-06-17 23:01:41,948 - INFO - Test split: Dataset({
    features: ['Unnamed: 0', 'title', 'abstract', 'Keywords', 'doi', 'labels'],
    num_rows: 80
})
2025-06-17 23:01:41,948 - INFO - Unique values in predictions: [1]
2025-06-17 23:01:41,948 - INFO - Unique values in labels: [0 1]
2025-06-17 23:01:41,949 - INFO - Confusion matrix:
[[ 0 21]
 [ 0 59]]
2025-06-17 23:01:41,950 - INFO - Confusion matrix: TN=0, FP=21, FN=0, TP=59
2025-06-17 23:01:44,648 - INFO - Metrics: {'f1': 0.8489208633093526, 'recall': 1.0, 'precision': 0.7375, 'accuracy': 0.7375, 'AP': 0.8555169441110554, 'MCC': 0.0, 'NDCG': 0.9686168130896343, 'kappa': 0.0, 'TN': 0, 'FP': 21, 'FN': 0, 'TP': 59}
2025-06-17 23:01:44,760 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-17 23:01:44,853 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 23:01:44,854 - INFO - 
On test Set (optimal threshold of 0.8782976865768433 according to cross validation on the training set): 
2025-06-17 23:01:44,854 - INFO - Confusion matrix: TN=18, FP=3, FN=31, TP=28
2025-06-17 23:01:47,698 - INFO - Metrics: {'f1': 0.6222222222222222, 'recall': 0.4745762711864407, 'precision': 0.9032258064516129, 'accuracy': 0.575, 'AP': 0.8555169441110554, 'MCC': 0.29958997846457824, 'NDCG': 0.9686168130896343, 'kappa': 0.23207227555053656, 'TN': 18, 'FP': 3, 'FN': 31, 'TP': 28}
2025-06-17 23:01:47,796 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 23:01:47,796 - INFO - Results for fold 2 : [{'f1': 0.6222222222222222, 'recall': 0.4745762711864407, 'precision': 0.9032258064516129, 'accuracy': 0.575, 'AP': 0.8555169441110554, 'MCC': 0.29958997846457824, 'NDCG': 0.9686168130896343, 'kappa': 0.23207227555053656, 'TN': 18, 'FP': 3, 'FN': 31, 'TP': 28}]
2025-06-17 23:01:48,132 - INFO - Cleared CUDA cache. Memory allocated: 1.52 GB, Memory reserved: 1.85 GB
2025-06-17 23:01:48,137 - INFO - Metrics stored successfully at /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/metrics/binary_metrics.csv
Model: dmis-lab/biobert-v1.1
2025-06-17 23:01:55,463 - INFO - Namespace(config='configs/hpo.yaml', fold=1, run=0, gpu=None, model_name='dmis-lab/biobert-v1.1', nb_opt_negs=100, n_trials=3, hpo_metric=None, direction=None, loss='BCE', with_title=True, with_keywords=False)
2025-06-17 23:01:55,464 - INFO - {'model_name': 'google-bert/bert-base-uncased', 'num_trials': 20, 'fold': 0, 'hpo_metric': 'eval_kappa', 'direction': 'max', 'loss_type': 'BCE', 'with_title': True, 'with_keywords': False, 'nb_optional_negs': 100}
2025-06-17 23:01:55,872 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
2025-06-17 23:01:55,872 - INFO - 
fold number 2 | run no. 1
2025-06-17 23:01:56,482 - INFO - train split size : 337
2025-06-17 23:01:56,482 - INFO - dev split size : 80
2025-06-17 23:01:56,482 - INFO - test split size : 80
2025-06-17 23:01:56,730 - INFO - 3 datasets tokenized successfully
2025-06-17 23:01:56,794 - INFO - Fold 2 max seq len = 512
2025-06-17 23:01:56,794 - INFO - Starting hyperparameter search for BCE loss
2025-06-17 23:01:58,199	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
2025-06-17 23:01:58,919	INFO tune.py:253 -- Initializing Ray automatically. For cluster usage or custom Ray initialization, call `ray.init(...)` before `tune.run(...)`.
[36m(trainable pid=160318)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=160318)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=160318)[0m 2025-06-17 23:02:07,465 - INFO - pos_weight value in TrainingArguments : 6.828424226204718
[36m(trainable pid=160318)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=160318)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=160516)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=160516)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=160516)[0m 2025-06-17 23:02:13,765 - INFO - pos_weight value in TrainingArguments : 6.094080202241274
[36m(trainable pid=160516)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=160516)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=160904)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=160904)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=160904)[0m 2025-06-17 23:02:20,148 - INFO - pos_weight value in TrainingArguments : 7.183206941666034
[36m(trainable pid=160904)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=160904)[0m   super().__init__(*args, **kwargs)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     trainable_2025-06-17_23-01-58   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-01-58
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-17_23-01-56_816705_157878/artifacts/2025-06-17_23-01-58/trainable_2025-06-17_23-01-58/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-17 23:02:00. Total running time: 0s
Logical resource usage: 0/32 CPUs, 0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_7abd6376   PENDING         6.82842       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_7abd6376 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_7abd6376 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          6.82842 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=160318)[0m [2025-06-17 23:02:07,699] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=160318)[0m [2025-06-17 23:02:10,321] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=160318)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial trainable_2b38b229 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_2b38b229 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          6.09408 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=160516)[0m [2025-06-17 23:02:14,165] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=160516)[0m [2025-06-17 23:02:16,799] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=160516)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=160318)[0m {'loss': 3.4513, 'grad_norm': 36.82556915283203, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}

Trial trainable_1fb03353 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_1fb03353 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          7.18321 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=160904)[0m [2025-06-17 23:02:20,393] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=160904)[0m [2025-06-17 23:02:23,250] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=160904)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 3 RUNNING
Current time: 2025-06-17 23:02:30. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_7abd6376   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ trainable_2b38b229   RUNNING         6.09408       4.55539e-06         0.123031                    5 â”‚
â”‚ trainable_1fb03353   RUNNING         7.18321       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=160904)[0m 2025-06-17 23:02:46,981 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=160904)[0m 2025-06-17 23:02:46,986 - INFO - eval_result: {'eval_loss': 0.9044327735900879, 'eval_f1': 0.8676470588235294, 'eval_accuracy': 0.775, 'eval_kappa': 0.19732441471571893, 'eval_precision': 0.7662337662337663, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9734993577003479, 'eval_AP': 0.9166863996275756, 'eval_MCC': 0.33085036890537656, 'eval_NDCG': 0.9808514388202664, 'eval_runtime': 3.3077, 'eval_samples_per_second': 24.186, 'eval_steps_per_second': 1.209, 'epoch': 3.0}
2025-06-17 23:02:47,320 - INFO - Cleaning up trial 1fb03353
2025-06-17 23:02:47,320 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-01-58/trainable_1fb03353_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512_2025-06-17_23-02-12
[36m(trainable pid=160904)[0m 2025-06-17 23:02:47,298 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB

[36m(trainable pid=160904)[0m {'loss': 1.6107, 'grad_norm': 3.6864893436431885, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
[36m(trainable pid=160904)[0m {'loss': 0.809, 'grad_norm': 2.751765489578247, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}[32m [repeated 3x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(trainable pid=160904)[0m {'train_runtime': 19.9632, 'train_samples_per_second': 50.643, 'train_steps_per_second': 2.555, 'train_loss': 0.9836121353448606, 'epoch': 3.0}
[36m(trainable pid=160904)[0m STATE at ending of training  :  TrainerState(epoch=3.0, global_step=51, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=266002888614912.0, log_history=[{'loss': 1.6107, 'grad_norm': 3.6864893436431885, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0, 'step': 17}, {'loss': 0.809, 'grad_norm': 2.751765489578247, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0, 'step': 34}, {'loss': 0.5312, 'grad_norm': 17.50897789001465, 'learning_rate': 0.0, 'epoch': 3.0, 'step': 51}, {'train_runtime': 19.9632, 'train_samples_per_second': 50.643, 'train_steps_per_second': 2.555, 'total_flos': 266002888614912.0, 'train_loss': 0.9836121353448606, 'epoch': 3.0, 'step': 51}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=160904)[0m {'loss': 0.5312, 'grad_norm': 17.50897789001465, 'learning_rate': 0.0, 'epoch': 3.0}
[36m(trainable pid=160904)[0m {'eval_loss': 0.9044327735900879, 'eval_f1': 0.8676470588235294, 'eval_accuracy': 0.775, 'eval_kappa': 0.19732441471571893, 'eval_precision': 0.7662337662337663, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9734993577003479, 'eval_AP': 0.9166863996275756, 'eval_MCC': 0.33085036890537656, 'eval_NDCG': 0.9808514388202664, 'eval_runtime': 3.3077, 'eval_samples_per_second': 24.186, 'eval_steps_per_second': 1.209, 'epoch': 3.0}

Trial trainable_1fb03353 finished iteration 1 at 2025-06-17 23:02:47. Total running time: 47s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_1fb03353 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    27.9745 â”‚
â”‚ time_total_s                        27.9745 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     3 â”‚
â”‚ eval_AP                             0.91669 â”‚
â”‚ eval_MCC                            0.33085 â”‚
â”‚ eval_NDCG                           0.98085 â”‚
â”‚ eval_accuracy                         0.775 â”‚
â”‚ eval_f1                             0.86765 â”‚
â”‚ eval_kappa                          0.19732 â”‚
â”‚ eval_loss                           0.90443 â”‚
â”‚ eval_optim_threshold                 0.9735 â”‚
â”‚ eval_precision                      0.76623 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.3077 â”‚
â”‚ eval_samples_per_second              24.186 â”‚
â”‚ eval_steps_per_second                 1.209 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_1fb03353 completed after 1 iterations at 2025-06-17 23:02:47. Total running time: 47s
[36m(trainable pid=160516)[0m {'loss': 1.5833, 'grad_norm': 5.036136150360107, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0}

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 23:03:00. Total running time: 1min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_7abd6376   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_2b38b229   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_1fb03353   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.9745      0.904433    0.867647             0.775       0.197324 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=160516)[0m {'loss': 1.3765, 'grad_norm': 4.140130519866943, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0}[32m [repeated 2x across cluster][0m
[36m(trainable pid=160516)[0m {'loss': 1.3065, 'grad_norm': 3.4238996505737305, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0}[32m [repeated 2x across cluster][0m
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 23:03:30. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_7abd6376   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_2b38b229   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_1fb03353   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.9745      0.904433    0.867647             0.775       0.197324 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=160318)[0m 2025-06-17 23:03:37,526 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=160318)[0m 2025-06-17 23:03:37,531 - INFO - eval_result: {'eval_loss': 2.8865809440612793, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.6118037104606628, 'eval_AP': 0.7719685150749429, 'eval_MCC': 0.0, 'eval_NDCG': 0.9399916871472009, 'eval_runtime': 3.8821, 'eval_samples_per_second': 20.607, 'eval_steps_per_second': 1.03, 'epoch': 6.0}
[36m(trainable pid=160516)[0m 2025-06-17 23:03:37,472 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=160516)[0m 2025-06-17 23:03:37,478 - INFO - eval_result: {'eval_loss': 1.1303898096084595, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8826848864555359, 'eval_AP': 0.8199863055511968, 'eval_MCC': 0.0, 'eval_NDCG': 0.9478093562018972, 'eval_runtime': 3.9591, 'eval_samples_per_second': 20.207, 'eval_steps_per_second': 1.01, 'epoch': 5.0}
2025-06-17 23:03:37,812 - INFO - Cleaning up trial 2b38b229
2025-06-17 23:03:37,813 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-01-58/trainable_2b38b229_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-17_23-02-06
2025-06-17 23:03:37,813 - INFO - Current best: 1fb03353 with eval_kappa : 0.19732441471571893 at iteration 1
[36m(trainable pid=160318)[0m 2025-06-17 23:03:37,843 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
2025-06-17 23:03:37,862 - INFO - Cleaning up trial 7abd6376
2025-06-17 23:03:37,862 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-01-58/trainable_7abd6376_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-17_23-02-00
2025-06-17 23:03:37,862 - INFO - Cleaning up trial 2b38b229
2025-06-17 23:03:37,862 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-01-58/trainable_2b38b229_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-17_23-02-06
2025-06-17 23:03:37,863 - INFO - Current best: 1fb03353 with eval_kappa : 0.19732441471571893 at iteration 1
2025-06-17 23:03:37,871	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-01-58' in 0.0061s.

[36m(trainable pid=160516)[0m {'train_runtime': 76.3765, 'train_samples_per_second': 22.062, 'train_steps_per_second': 1.113, 'train_loss': 1.5053965175853057, 'epoch': 5.0}
[36m(trainable pid=160516)[0m STATE at ending of training  :  TrainerState(epoch=5.0, global_step=85, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=443338147691520.0, log_history=[{'loss': 1.9766, 'grad_norm': 13.259700775146484, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0, 'step': 17}, {'loss': 1.5833, 'grad_norm': 5.036136150360107, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0, 'step': 34}, {'loss': 1.3765, 'grad_norm': 4.140130519866943, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0, 'step': 51}, {'loss': 1.3065, 'grad_norm': 3.4238996505737305, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0, 'step': 68}, {'loss': 1.284, 'grad_norm': 5.036870956420898, 'learning_rate': 0.0, 'epoch': 5.0, 'step': 85}, {'train_runtime': 76.3765, 'train_samples_per_second': 22.062, 'train_steps_per_second': 1.113, 'total_flos': 443338147691520.0, 'train_loss': 1.5053965175853057, 'epoch': 5.0, 'step': 85}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=160516)[0m {'loss': 1.284, 'grad_norm': 5.036870956420898, 'learning_rate': 0.0, 'epoch': 5.0}[32m [repeated 2x across cluster][0m
[36m(trainable pid=160318)[0m STATE at ending of training  :  TrainerState(epoch=6.0, global_step=102, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=532005777229824.0, log_history=[{'loss': 3.4513, 'grad_norm': 36.82556915283203, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0, 'step': 17}, {'loss': 3.0456, 'grad_norm': 28.67168617248535, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0, 'step': 34}, {'loss': 2.7309, 'grad_norm': 15.939516067504883, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0, 'step': 51}, {'loss': 2.5219, 'grad_norm': 23.53990936279297, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0, 'step': 68}, {'loss': 2.3484, 'grad_norm': 32.310726165771484, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0, 'step': 85}, {'loss': 2.2885, 'grad_norm': 18.36514663696289, 'learning_rate': 0.0, 'epoch': 6.0, 'step': 102}, {'train_runtime': 82.9854, 'train_samples_per_second': 24.366, 'train_steps_per_second': 1.229, 'total_flos': 532005777229824.0, 'train_loss': 2.731091069240196, 'epoch': 6.0, 'step': 102}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=160318)[0m {'eval_loss': 2.8865809440612793, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.6118037104606628, 'eval_AP': 0.7719685150749429, 'eval_MCC': 0.0, 'eval_NDCG': 0.9399916871472009, 'eval_runtime': 3.8821, 'eval_samples_per_second': 20.607, 'eval_steps_per_second': 1.03, 'epoch': 6.0}

Trial trainable_2b38b229 finished iteration 1 at 2025-06-17 23:03:37. Total running time: 1min 37s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_2b38b229 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    84.8764 â”‚
â”‚ time_total_s                        84.8764 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     5 â”‚
â”‚ eval_AP                             0.81999 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.94781 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.13039 â”‚
â”‚ eval_optim_threshold                0.88268 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.9591 â”‚
â”‚ eval_samples_per_second              20.207 â”‚
â”‚ eval_steps_per_second                  1.01 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_2b38b229 completed after 1 iterations at 2025-06-17 23:03:37. Total running time: 1min 37s

Trial trainable_7abd6376 finished iteration 1 at 2025-06-17 23:03:37. Total running time: 1min 37s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_7abd6376 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    91.2281 â”‚
â”‚ time_total_s                        91.2281 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     6 â”‚
â”‚ eval_AP                             0.77197 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.93999 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           2.88658 â”‚
â”‚ eval_optim_threshold                 0.6118 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.8821 â”‚
â”‚ eval_samples_per_second              20.607 â”‚
â”‚ eval_steps_per_second                  1.03 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_7abd6376 completed after 1 iterations at 2025-06-17 23:03:37. Total running time: 1min 37s

Trial status: 3 TERMINATED
Current time: 2025-06-17 23:03:37. Total running time: 1min 37s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_7abd6376   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1            91.2281      2.88658     0.848921            0.7375       0        â”‚
â”‚ trainable_2b38b229   TERMINATED        6.09408       4.55539e-06         0.123031                    5        1            84.8764      1.13039     0.848921            0.7375       0        â”‚
â”‚ trainable_1fb03353   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.9745      0.904433    0.867647            0.775        0.197324 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯2025-06-17 23:03:37,878 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x7074961b2c50>
2025-06-17 23:03:37,878 - INFO - Best trial : trainable_1fb03353
2025-06-17 23:03:37,878 - INFO - Best config : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-17 23:03:37,878 - INFO - Best trial after optimization: {'eval_loss': 0.9044327735900879, 'eval_f1': 0.8676470588235294, 'eval_accuracy': 0.775, 'eval_kappa': 0.19732441471571893, 'eval_precision': 0.7662337662337663, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9734993577003479, 'eval_AP': 0.9166863996275756, 'eval_MCC': 0.33085036890537656, 'eval_NDCG': 0.9808514388202664, 'eval_runtime': 3.3077, 'eval_samples_per_second': 24.186, 'eval_steps_per_second': 1.209, 'epoch': 3.0, 'timestamp': 1750194167, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '1fb03353', 'date': '2025-06-17_23-02-47', 'time_this_iter_s': 27.97452974319458, 'time_total_s': 27.97452974319458, 'pid': 160904, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 27.97452974319458, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512'}
2025-06-17 23:03:37,899 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   2.886581  0.848921  ...                        6  7abd6376
1   1.130390  0.848921  ...                        5  2b38b229
2   0.904433  0.867647  ...                        3  1fb03353

[3 rows x 32 columns]
2025-06-17 23:03:38,058 - INFO - Trial comparison plot saved
2025-06-17 23:03:38,066 - INFO - Best Hyperparameters after HPO : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}


[36m(trainable pid=160318)[0m /home/leandre/.local/share/uv/python/cpython-3.11.11-linux-x86_64-gnu/lib/python3.11/multiprocessing/resource_tracker.py:123: UserWarning: resource_tracker: process died unexpectedly, relaunching.  Some resources might leak.
[36m(trainable pid=160318)[0m   warnings.warn('resource_tracker: process died unexpectedly, '
[36m(trainable pid=160318)[0m Traceback (most recent call last):
[36m(trainable pid=160318)[0m   File "/home/leandre/.local/share/uv/python/cpython-3.11.11-linux-x86_64-gnu/lib/python3.11/multiprocessing/resource_tracker.py", line 239, in main
[36m(trainable pid=160318)[0m     cache[rtype].remove(name)
[36m(trainable pid=160318)[0m KeyError: '/loky-160318-tpnpj482'
[36m(trainable pid=160516)[0m 2025-06-17 23:03:37,793 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(trainable pid=160318)[0m {'train_runtime': 82.9854, 'train_samples_per_second': 24.366, 'train_steps_per_second': 1.229, 'train_loss': 2.731091069240196, 'epoch': 6.0}
[36m(trainable pid=160318)[0m {'loss': 2.2885, 'grad_norm': 18.36514663696289, 'learning_rate': 0.0, 'epoch': 6.0}
[36m(trainable pid=160516)[0m {'eval_loss': 1.1303898096084595, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8826848864555359, 'eval_AP': 0.8199863055511968, 'eval_MCC': 0.0, 'eval_NDCG': 0.9478093562018972, 'eval_runtime': 3.9591, 'eval_samples_per_second': 20.207, 'eval_steps_per_second': 1.01, 'epoch': 5.0}
2025-06-17 23:03:47,255 - INFO - Namespace(config='configs/train.yaml', hp_config='configs/best_hpo.yaml', fold=1, run=0, gpu='2', model_name='dmis-lab/biobert-v1.1', nb_opt_negs=100, loss='BCE', with_title=True, with_keywords=False, best_metric=None)
2025-06-17 23:03:47,257 - INFO - {'model_name': 'bert-base-uncased', 'fold': 0, 'run': 0, 'output_dir': 'outputs/checkpoints', 'best_metric': 'eval_kappa', 'loss_type': 'BCE', 'nb_optional_negs': 100, 'with_title': True, 'with_keywords': False, 'default_hyperparameters': {'learning_rate': 'None', 'num_train_epochs': 'None', 'pos_weight': 'None', 'weight_decay': 'None'}}
2025-06-17 23:03:48,047 - INFO - train split size : 337
2025-06-17 23:03:48,048 - INFO - dev split size : 80
2025-06-17 23:03:48,048 - INFO - test split size : 80
2025-06-17 23:03:48,290 - INFO - 3 datasets tokenized successfully
2025-06-17 23:03:48,290 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-17 23:03:49,025 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
[2025-06-17 23:03:49,249] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-06-17 23:03:51,935] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
2025-06-17 23:03:51,972 - INFO - training size : 337
2025-06-17 23:03:51,972 - INFO - dev size : 80
2025-06-17 23:03:51,972 - INFO - test size : 80
  0%|          | 0/12 [00:00<?, ?it/s]  8%|â–Š         | 1/12 [00:02<00:25,  2.34s/it] 17%|â–ˆâ–‹        | 2/12 [00:04<00:20,  2.04s/it] 25%|â–ˆâ–ˆâ–Œ       | 3/12 [00:05<00:17,  1.92s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [00:06<00:11,  1.43s/it]                                               33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [00:06<00:11,  1.43s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 5/12 [00:08<00:11,  1.60s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 6/12 [00:10<00:10,  1.67s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 7/12 [00:12<00:08,  1.71s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [00:12<00:05,  1.38s/it]                                               67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [00:12<00:05,  1.38s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 9/12 [00:14<00:04,  1.54s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 10/12 [00:16<00:03,  1.63s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 11/12 [00:18<00:01,  1.68s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:18<00:00,  1.37s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:21<00:00,  1.37s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:21<00:00,  1.37s/it]2025-06-17 23:04:13,731 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:21<00:00,  1.79s/it]
{'loss': 1.8569, 'grad_norm': 2.0558435916900635, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
{'loss': 1.4154, 'grad_norm': 7.066696643829346, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
{'loss': 1.2421, 'grad_norm': 3.237182378768921, 'learning_rate': 0.0, 'epoch': 3.0}
{'train_runtime': 21.4711, 'train_samples_per_second': 47.087, 'train_steps_per_second': 0.559, 'train_loss': 1.5047753254572551, 'epoch': 3.0}
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 23:04:17,240 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.99s/it]
2025-06-17 23:04:17,246 - INFO - Training time : 28.955477284966037
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 23:04:20,491 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.72s/it]
2025-06-17 23:04:20,496 - INFO - Evaluation time : 3.2496447369921952
2025-06-17 23:04:20,496 - INFO - Evaluation results on test set: {'eval_loss': 1.0882627964019775, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9017602801322937, 'eval_AP': 0.9236316769901788, 'eval_MCC': 0.0, 'eval_NDCG': 0.98476080301021, 'eval_runtime': 3.2377, 'eval_samples_per_second': 24.709, 'eval_steps_per_second': 0.309, 'epoch': 3.0}
2025-06-17 23:04:20,496 - INFO - Total updates (optimizer steps): 12
2025-06-17 23:04:20,496 - INFO - Avg time / step: 1.789s
2025-06-17 23:04:21,186 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCE_biobert-v1_fold-2
2025-06-17 23:04:21,186 - INFO - On test Set (with threshold 0.5) : 
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 23:04:24,612 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.89s/it]
2025-06-17 23:04:24,616 - INFO - Raw predictions shape: (80, 1)
2025-06-17 23:04:24,616 - INFO - Raw predictions: [[1.8021718]
 [2.746669 ]
 [2.2906952]
 [2.7023194]
 [2.0455065]
 [1.898571 ]
 [2.3957932]
 [2.2068243]
 [2.2613451]
 [1.7994517]]
2025-06-17 23:04:24,616 - INFO - Scores shape: (80,)
2025-06-17 23:04:24,616 - INFO - Scores: [0.85841316 0.939725   0.9081035  0.93716335 0.8854928  0.8697297
 0.916506   0.90086067 0.9056246  0.8580822 ]
2025-06-17 23:04:24,617 - INFO - Preds shape: (80,)
2025-06-17 23:04:24,617 - INFO - Preds: [1 1 1 1 1 1 1 1 1 1]
2025-06-17 23:04:24,617 - INFO - Test labels shape: (80,)
2025-06-17 23:04:24,617 - INFO - Test labels: [1, 1, 1, 1, 1, 1, 1, 0, 1, 0]
2025-06-17 23:04:24,617 - INFO - Test split: Dataset({
    features: ['Unnamed: 0', 'title', 'abstract', 'Keywords', 'doi', 'labels'],
    num_rows: 80
})
2025-06-17 23:04:24,617 - INFO - Unique values in predictions: [1]
2025-06-17 23:04:24,617 - INFO - Unique values in labels: [0 1]
2025-06-17 23:04:24,618 - INFO - Confusion matrix:
[[ 0 21]
 [ 0 59]]
2025-06-17 23:04:24,619 - INFO - Confusion matrix: TN=0, FP=21, FN=0, TP=59
2025-06-17 23:04:27,519 - INFO - Metrics: {'f1': 0.8489208633093526, 'recall': 1.0, 'precision': 0.7375, 'accuracy': 0.7375, 'AP': 0.9236316769901788, 'MCC': 0.0, 'NDCG': 0.98476080301021, 'kappa': 0.0, 'TN': 0, 'FP': 21, 'FN': 0, 'TP': 59}
2025-06-17 23:04:27,628 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-17 23:04:27,718 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 23:04:27,719 - INFO - 
On test Set (optimal threshold of 0.9085505604743958 according to cross validation on the training set): 
2025-06-17 23:04:27,719 - INFO - Confusion matrix: TN=19, FP=2, FN=28, TP=31
2025-06-17 23:04:31,260 - INFO - Metrics: {'f1': 0.6739130434782609, 'recall': 0.5254237288135594, 'precision': 0.9393939393939394, 'accuracy': 0.625, 'AP': 0.9236316769901788, 'MCC': 0.3844905382633042, 'NDCG': 0.98476080301021, 'kappa': 0.3075591459896134, 'TN': 19, 'FP': 2, 'FN': 28, 'TP': 31}
2025-06-17 23:04:31,354 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 23:04:31,354 - INFO - Results for fold 2 : [{'f1': 0.6739130434782609, 'recall': 0.5254237288135594, 'precision': 0.9393939393939394, 'accuracy': 0.625, 'AP': 0.9236316769901788, 'MCC': 0.3844905382633042, 'NDCG': 0.98476080301021, 'kappa': 0.3075591459896134, 'TN': 19, 'FP': 2, 'FN': 28, 'TP': 31}]
2025-06-17 23:04:31,681 - INFO - Cleared CUDA cache. Memory allocated: 1.32 GB, Memory reserved: 1.63 GB
2025-06-17 23:04:31,687 - INFO - Metrics stored successfully at /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/metrics/binary_metrics.csv
Model: google-bert/bert-base-uncased
2025-06-17 23:04:38,974 - INFO - Namespace(config='configs/hpo.yaml', fold=1, run=0, gpu=None, model_name='google-bert/bert-base-uncased', nb_opt_negs=100, n_trials=3, hpo_metric=None, direction=None, loss='BCE', with_title=True, with_keywords=False)
2025-06-17 23:04:38,975 - INFO - {'model_name': 'google-bert/bert-base-uncased', 'num_trials': 20, 'fold': 0, 'hpo_metric': 'eval_kappa', 'direction': 'max', 'loss_type': 'BCE', 'with_title': True, 'with_keywords': False, 'nb_optional_negs': 100}
2025-06-17 23:04:39,382 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
2025-06-17 23:04:39,382 - INFO - 
fold number 2 | run no. 1
2025-06-17 23:04:40,001 - INFO - train split size : 337
2025-06-17 23:04:40,001 - INFO - dev split size : 80
2025-06-17 23:04:40,001 - INFO - test split size : 80
2025-06-17 23:04:40,248 - INFO - 3 datasets tokenized successfully
2025-06-17 23:04:40,311 - INFO - Fold 2 max seq len = 512
2025-06-17 23:04:40,311 - INFO - Starting hyperparameter search for BCE loss
2025-06-17 23:04:41,671	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
2025-06-17 23:04:42,422	INFO tune.py:253 -- Initializing Ray automatically. For cluster usage or custom Ray initialization, call `ray.init(...)` before `tune.run(...)`.
[36m(trainable pid=165288)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=165288)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=165288)[0m 2025-06-17 23:04:50,540 - INFO - pos_weight value in TrainingArguments : 6.828424226204718
[36m(trainable pid=165288)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=165288)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=165486)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=165486)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=165486)[0m 2025-06-17 23:04:56,998 - INFO - pos_weight value in TrainingArguments : 6.094080202241274
[36m(trainable pid=165486)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=165486)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=165873)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=165873)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=165873)[0m 2025-06-17 23:05:03,353 - INFO - pos_weight value in TrainingArguments : 7.183206941666034
[36m(trainable pid=165873)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=165873)[0m   super().__init__(*args, **kwargs)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     trainable_2025-06-17_23-04-42   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-04-42
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-17_23-04-40_334293_162849/artifacts/2025-06-17_23-04-42/trainable_2025-06-17_23-04-42/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-17 23:04:43. Total running time: 0s
Logical resource usage: 0/32 CPUs, 0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_9100c66b   PENDING         6.82842       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_9100c66b started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_9100c66b config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          6.82842 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=165288)[0m [2025-06-17 23:04:50,806] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=165288)[0m [2025-06-17 23:04:53,686] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=165288)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial trainable_cdcbd43f started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_cdcbd43f config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          6.09408 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=165486)[0m [2025-06-17 23:04:57,359] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=165486)[0m [2025-06-17 23:04:59,975] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=165486)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=165288)[0m {'loss': 1.5252, 'grad_norm': 6.680908203125, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}

Trial trainable_6ce346c0 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_6ce346c0 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          7.18321 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=165873)[0m [2025-06-17 23:05:03,609] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=165873)[0m [2025-06-17 23:05:06,297] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=165873)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=165873)[0m {'loss': 1.8246, 'grad_norm': 11.812331199645996, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}

Trial status: 3 RUNNING
Current time: 2025-06-17 23:05:13. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_9100c66b   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ trainable_cdcbd43f   RUNNING         6.09408       4.55539e-06         0.123031                    5 â”‚
â”‚ trainable_6ce346c0   RUNNING         7.18321       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=165873)[0m 2025-06-17 23:05:29,855 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=165873)[0m 2025-06-17 23:05:29,861 - INFO - eval_result: {'eval_loss': 0.9218934774398804, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.977993905544281, 'eval_AP': 0.9449178586630417, 'eval_MCC': 0.0, 'eval_NDCG': 0.9892129733041396, 'eval_runtime': 3.2999, 'eval_samples_per_second': 24.243, 'eval_steps_per_second': 1.212, 'epoch': 3.0}
2025-06-17 23:05:30,187 - INFO - Cleaning up trial 6ce346c0
2025-06-17 23:05:30,187 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-04-42/trainable_6ce346c0_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512_2025-06-17_23-04-56
[36m(trainable pid=165873)[0m 2025-06-17 23:05:30,165 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB

[36m(trainable pid=165873)[0m {'loss': 0.9743, 'grad_norm': 6.414469242095947, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}[32m [repeated 3x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(trainable pid=165873)[0m {'train_runtime': 19.9269, 'train_samples_per_second': 50.736, 'train_steps_per_second': 2.559, 'train_loss': 1.1793754428040748, 'epoch': 3.0}
[36m(trainable pid=165873)[0m STATE at ending of training  :  TrainerState(epoch=3.0, global_step=51, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=266002888614912.0, log_history=[{'loss': 1.8246, 'grad_norm': 11.812331199645996, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0, 'step': 17}, {'loss': 0.9743, 'grad_norm': 6.414469242095947, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0, 'step': 34}, {'loss': 0.7393, 'grad_norm': 11.938727378845215, 'learning_rate': 0.0, 'epoch': 3.0, 'step': 51}, {'train_runtime': 19.9269, 'train_samples_per_second': 50.736, 'train_steps_per_second': 2.559, 'total_flos': 266002888614912.0, 'train_loss': 1.1793754428040748, 'epoch': 3.0, 'step': 51}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=165873)[0m {'loss': 0.7393, 'grad_norm': 11.938727378845215, 'learning_rate': 0.0, 'epoch': 3.0}
[36m(trainable pid=165873)[0m {'eval_loss': 0.9218934774398804, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.977993905544281, 'eval_AP': 0.9449178586630417, 'eval_MCC': 0.0, 'eval_NDCG': 0.9892129733041396, 'eval_runtime': 3.2999, 'eval_samples_per_second': 24.243, 'eval_steps_per_second': 1.212, 'epoch': 3.0}

Trial trainable_6ce346c0 finished iteration 1 at 2025-06-17 23:05:30. Total running time: 46s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_6ce346c0 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    27.2503 â”‚
â”‚ time_total_s                        27.2503 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     3 â”‚
â”‚ eval_AP                             0.94492 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.98921 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           0.92189 â”‚
â”‚ eval_optim_threshold                0.97799 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.2999 â”‚
â”‚ eval_samples_per_second              24.243 â”‚
â”‚ eval_steps_per_second                 1.212 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_6ce346c0 completed after 1 iterations at 2025-06-17 23:05:30. Total running time: 46s
[36m(trainable pid=165486)[0m {'loss': 1.9953, 'grad_norm': 12.416828155517578, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0}

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 23:05:43. Total running time: 1min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_9100c66b   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_cdcbd43f   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_6ce346c0   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.2503      0.921893    0.848921            0.7375              0 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=165486)[0m {'loss': 1.5535, 'grad_norm': 5.2363128662109375, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0}[32m [repeated 2x across cluster][0m
[36m(trainable pid=165486)[0m {'loss': 1.4331, 'grad_norm': 10.002753257751465, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0}[32m [repeated 2x across cluster][0m
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 23:06:13. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_9100c66b   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_cdcbd43f   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_6ce346c0   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.2503      0.921893    0.848921            0.7375              0 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=165486)[0m 2025-06-17 23:06:20,554 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=165486)[0m 2025-06-17 23:06:20,560 - INFO - eval_result: {'eval_loss': 1.3356512784957886, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8207271695137024, 'eval_AP': 0.8460402908840777, 'eval_MCC': 0.0, 'eval_NDCG': 0.9451490437168755, 'eval_runtime': 3.9412, 'eval_samples_per_second': 20.298, 'eval_steps_per_second': 1.015, 'epoch': 5.0}
[36m(trainable pid=165288)[0m 2025-06-17 23:06:20,813 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=165288)[0m 2025-06-17 23:06:20,818 - INFO - eval_result: {'eval_loss': 1.3788318634033203, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8385362029075623, 'eval_AP': 0.8373669533613346, 'eval_MCC': 0.0, 'eval_NDCG': 0.9624906929628222, 'eval_runtime': 3.537, 'eval_samples_per_second': 22.618, 'eval_steps_per_second': 1.131, 'epoch': 6.0}
2025-06-17 23:06:20,888 - INFO - Cleaning up trial cdcbd43f
2025-06-17 23:06:20,888 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-04-42/trainable_cdcbd43f_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-17_23-04-50
2025-06-17 23:06:20,888 - INFO - Current best: 6ce346c0 with eval_kappa : 0.0 at iteration 1
[36m(trainable pid=165486)[0m 2025-06-17 23:06:20,864 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
2025-06-17 23:06:21,155 - INFO - Cleaning up trial 9100c66b
2025-06-17 23:06:21,155 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-04-42/trainable_9100c66b_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-17_23-04-43
2025-06-17 23:06:21,155 - INFO - Current best: cdcbd43f with eval_kappa : 0.0 at iteration 1
2025-06-17 23:06:21,155 - INFO - Current best: 6ce346c0 with eval_kappa : 0.0 at iteration 1
2025-06-17 23:06:21,163	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-04-42' in 0.0060s.

[36m(trainable pid=165486)[0m {'train_runtime': 76.302, 'train_samples_per_second': 22.083, 'train_steps_per_second': 1.114, 'train_loss': 1.880470859303194, 'epoch': 5.0}
[36m(trainable pid=165486)[0m STATE at ending of training  :  TrainerState(epoch=5.0, global_step=85, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=443338147691520.0, log_history=[{'loss': 3.0457, 'grad_norm': 29.00800323486328, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0, 'step': 17}, {'loss': 1.9953, 'grad_norm': 12.416828155517578, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0, 'step': 34}, {'loss': 1.5535, 'grad_norm': 5.2363128662109375, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0, 'step': 51}, {'loss': 1.4331, 'grad_norm': 10.002753257751465, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0, 'step': 68}, {'loss': 1.3748, 'grad_norm': 11.098424911499023, 'learning_rate': 0.0, 'epoch': 5.0, 'step': 85}, {'train_runtime': 76.302, 'train_samples_per_second': 22.083, 'train_steps_per_second': 1.114, 'total_flos': 443338147691520.0, 'train_loss': 1.880470859303194, 'epoch': 5.0, 'step': 85}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=165486)[0m {'loss': 1.3748, 'grad_norm': 11.098424911499023, 'learning_rate': 0.0, 'epoch': 5.0}[32m [repeated 2x across cluster][0m
[36m(trainable pid=165288)[0m STATE at ending of training  :  TrainerState(epoch=6.0, global_step=102, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=532005777229824.0, log_history=[{'loss': 1.5252, 'grad_norm': 6.680908203125, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0, 'step': 17}, {'loss': 1.5274, 'grad_norm': 2.7180862426757812, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0, 'step': 34}, {'loss': 1.5104, 'grad_norm': 5.823872089385986, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0, 'step': 51}, {'loss': 1.5159, 'grad_norm': 2.9742543697357178, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0, 'step': 68}, {'loss': 1.5063, 'grad_norm': 10.42494010925293, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0, 'step': 85}, {'loss': 1.5072, 'grad_norm': 4.311625957489014, 'learning_rate': 0.0, 'epoch': 6.0, 'step': 102}, {'train_runtime': 83.2378, 'train_samples_per_second': 24.292, 'train_steps_per_second': 1.225, 'total_flos': 532005777229824.0, 'train_loss': 1.5154214559816848, 'epoch': 6.0, 'step': 102}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=165486)[0m {'eval_loss': 1.3356512784957886, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8207271695137024, 'eval_AP': 0.8460402908840777, 'eval_MCC': 0.0, 'eval_NDCG': 0.9451490437168755, 'eval_runtime': 3.9412, 'eval_samples_per_second': 20.298, 'eval_steps_per_second': 1.015, 'epoch': 5.0}

Trial trainable_cdcbd43f finished iteration 1 at 2025-06-17 23:06:20. Total running time: 1min 37s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_cdcbd43f result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    84.2906 â”‚
â”‚ time_total_s                        84.2906 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     5 â”‚
â”‚ eval_AP                             0.84604 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.94515 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.33565 â”‚
â”‚ eval_optim_threshold                0.82073 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.9412 â”‚
â”‚ eval_samples_per_second              20.298 â”‚
â”‚ eval_steps_per_second                 1.015 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_cdcbd43f completed after 1 iterations at 2025-06-17 23:06:20. Total running time: 1min 37s

Trial trainable_9100c66b finished iteration 1 at 2025-06-17 23:06:21. Total running time: 1min 37s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_9100c66b result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                     91.047 â”‚
â”‚ time_total_s                         91.047 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     6 â”‚
â”‚ eval_AP                             0.83737 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.96249 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.37883 â”‚
â”‚ eval_optim_threshold                0.83854 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                          3.537 â”‚
â”‚ eval_samples_per_second              22.618 â”‚
â”‚ eval_steps_per_second                 1.131 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_9100c66b completed after 1 iterations at 2025-06-17 23:06:21. Total running time: 1min 37s

Trial status: 3 TERMINATED
Current time: 2025-06-17 23:06:21. Total running time: 1min 37s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_9100c66b   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1            91.047       1.37883     0.848921            0.7375              0 â”‚
â”‚ trainable_cdcbd43f   TERMINATED        6.09408       4.55539e-06         0.123031                    5        1            84.2906      1.33565     0.848921            0.7375              0 â”‚
â”‚ trainable_6ce346c0   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.2503      0.921893    0.848921            0.7375              0 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯2025-06-17 23:06:21,169 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x734c0ff4c750>
2025-06-17 23:06:21,169 - INFO - Best trial : trainable_9100c66b
2025-06-17 23:06:21,169 - INFO - Best config : {'pos_weight': 6.828424226204718, 'learning_rate': 1.4956066518424355e-06, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 6}
2025-06-17 23:06:21,169 - INFO - Best trial after optimization: {'eval_loss': 1.3788318634033203, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8385362029075623, 'eval_AP': 0.8373669533613346, 'eval_MCC': 0.0, 'eval_NDCG': 0.9624906929628222, 'eval_runtime': 3.537, 'eval_samples_per_second': 22.618, 'eval_steps_per_second': 1.131, 'epoch': 6.0, 'timestamp': 1750194381, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '9100c66b', 'date': '2025-06-17_23-06-21', 'time_this_iter_s': 91.0470323562622, 'time_total_s': 91.0470323562622, 'pid': 165288, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 6.828424226204718, 'learning_rate': 1.4956066518424355e-06, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 6}, 'time_since_restore': 91.0470323562622, 'iterations_since_restore': 1, 'experiment_tag': '1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364'}
2025-06-17 23:06:21,191 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   1.378832  0.848921  ...                        6  9100c66b
1   1.335651  0.848921  ...                        5  cdcbd43f
2   0.921893  0.848921  ...                        3  6ce346c0

[3 rows x 32 columns]
2025-06-17 23:06:21,329 - INFO - Trial comparison plot saved
2025-06-17 23:06:21,339 - INFO - Best Hyperparameters after HPO : {'pos_weight': 6.828424226204718, 'learning_rate': 1.4956066518424355e-06, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 6}


[36m(trainable pid=165288)[0m 2025-06-17 23:06:21,134 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(trainable pid=165288)[0m {'train_runtime': 83.2378, 'train_samples_per_second': 24.292, 'train_steps_per_second': 1.225, 'train_loss': 1.5154214559816848, 'epoch': 6.0}
[36m(trainable pid=165288)[0m {'loss': 1.5072, 'grad_norm': 4.311625957489014, 'learning_rate': 0.0, 'epoch': 6.0}
[36m(trainable pid=165288)[0m {'eval_loss': 1.3788318634033203, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8385362029075623, 'eval_AP': 0.8373669533613346, 'eval_MCC': 0.0, 'eval_NDCG': 0.9624906929628222, 'eval_runtime': 3.537, 'eval_samples_per_second': 22.618, 'eval_steps_per_second': 1.131, 'epoch': 6.0}
2025-06-17 23:06:30,564 - INFO - Namespace(config='configs/train.yaml', hp_config='configs/best_hpo.yaml', fold=1, run=0, gpu='2', model_name='google-bert/bert-base-uncased', nb_opt_negs=100, loss='BCE', with_title=True, with_keywords=False, best_metric=None)
2025-06-17 23:06:30,566 - INFO - {'model_name': 'bert-base-uncased', 'fold': 0, 'run': 0, 'output_dir': 'outputs/checkpoints', 'best_metric': 'eval_kappa', 'loss_type': 'BCE', 'nb_optional_negs': 100, 'with_title': True, 'with_keywords': False, 'default_hyperparameters': {'learning_rate': 'None', 'num_train_epochs': 'None', 'pos_weight': 'None', 'weight_decay': 'None'}}
2025-06-17 23:06:31,555 - INFO - train split size : 337
2025-06-17 23:06:31,556 - INFO - dev split size : 80
2025-06-17 23:06:31,556 - INFO - test split size : 80
2025-06-17 23:06:31,805 - INFO - 3 datasets tokenized successfully
2025-06-17 23:06:31,805 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-17 23:06:32,137 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
[2025-06-17 23:06:32,379] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-06-17 23:06:35,139] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
2025-06-17 23:06:35,177 - INFO - training size : 337
2025-06-17 23:06:35,177 - INFO - dev size : 80
2025-06-17 23:06:35,178 - INFO - test size : 80
  0%|          | 0/24 [00:00<?, ?it/s]  4%|â–         | 1/24 [00:02<00:53,  2.35s/it]  8%|â–Š         | 2/24 [00:04<00:44,  2.04s/it] 12%|â–ˆâ–Ž        | 3/24 [00:05<00:40,  1.92s/it] 17%|â–ˆâ–‹        | 4/24 [00:06<00:28,  1.43s/it]                                               17%|â–ˆâ–‹        | 4/24 [00:06<00:28,  1.43s/it] 21%|â–ˆâ–ˆ        | 5/24 [00:08<00:30,  1.60s/it] 25%|â–ˆâ–ˆâ–Œ       | 6/24 [00:10<00:30,  1.67s/it] 29%|â–ˆâ–ˆâ–‰       | 7/24 [00:12<00:29,  1.71s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 8/24 [00:12<00:22,  1.38s/it]                                               33%|â–ˆâ–ˆâ–ˆâ–Ž      | 8/24 [00:12<00:22,  1.38s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 9/24 [00:14<00:23,  1.54s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 10/24 [00:16<00:22,  1.63s/it] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 11/24 [00:18<00:21,  1.67s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 12/24 [00:18<00:16,  1.37s/it]                                                50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 12/24 [00:18<00:16,  1.37s/it] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 13/24 [00:20<00:16,  1.53s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 14/24 [00:22<00:16,  1.62s/it] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 15/24 [00:24<00:15,  1.67s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 16/24 [00:25<00:10,  1.37s/it]                                                67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 16/24 [00:25<00:10,  1.37s/it] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 17/24 [00:27<00:10,  1.54s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 18/24 [00:28<00:09,  1.62s/it] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 19/24 [00:30<00:08,  1.67s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 20/24 [00:31<00:05,  1.37s/it]                                                83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 20/24 [00:31<00:05,  1.37s/it] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 21/24 [00:33<00:04,  1.54s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 22/24 [00:35<00:03,  1.63s/it] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 23/24 [00:36<00:01,  1.68s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 24/24 [00:37<00:00,  1.38s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 24/24 [00:39<00:00,  1.38s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 24/24 [00:39<00:00,  1.38s/it]2025-06-17 23:07:14,935 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 24/24 [00:39<00:00,  1.64s/it]
{'loss': 2.9288, 'grad_norm': 38.66941833496094, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}
{'loss': 2.7875, 'grad_norm': 24.239974975585938, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0}
{'loss': 2.8576, 'grad_norm': 33.358238220214844, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0}
{'loss': 2.8594, 'grad_norm': 44.0296745300293, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0}
{'loss': 2.9038, 'grad_norm': 51.21200942993164, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0}
{'loss': 2.8761, 'grad_norm': 46.31495666503906, 'learning_rate': 0.0, 'epoch': 6.0}
{'train_runtime': 39.4703, 'train_samples_per_second': 51.228, 'train_steps_per_second': 0.608, 'train_loss': 2.8688707749048867, 'epoch': 6.0}
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 23:07:18,266 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.81s/it]
2025-06-17 23:07:18,273 - INFO - Training time : 46.468048107926734
  0%|          | 0/1 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-06-17 23:07:21,534 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.73s/it]
2025-06-17 23:07:21,539 - INFO - Evaluation time : 3.2659346819855273
2025-06-17 23:07:21,539 - INFO - Evaluation results on test set: {'eval_loss': 3.7329049110412598, 'eval_f1': 0.0, 'eval_accuracy': 0.2625, 'eval_kappa': 0.0, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_optim_threshold': 0.4920992851257324, 'eval_AP': 0.7183983252729472, 'eval_MCC': 0.0, 'eval_NDCG': 0.875529752264121, 'eval_runtime': 3.2536, 'eval_samples_per_second': 24.588, 'eval_steps_per_second': 0.307, 'epoch': 6.0}
2025-06-17 23:07:21,539 - INFO - Total updates (optimizer steps): 24
2025-06-17 23:07:21,539 - INFO - Avg time / step: 1.645s
2025-06-17 23:07:22,243 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCE_bert-base_fold-2
2025-06-17 23:07:22,243 - INFO - On test Set (with threshold 0.5) : 
  0%|          | 0/1 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-06-17 23:07:25,522 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.75s/it]
2025-06-17 23:07:25,525 - INFO - Raw predictions shape: (80, 1)
2025-06-17 23:07:25,526 - INFO - Raw predictions: [[-0.03905761]
 [-0.01146078]
 [-0.03751069]
 [-0.01664555]
 [-0.02169663]
 [-0.02476634]
 [-0.03142887]
 [-0.00082309]
 [-0.02459115]
 [-0.0261516 ]]
2025-06-17 23:07:25,526 - INFO - Scores shape: (80,)
2025-06-17 23:07:25,526 - INFO - Scores: [0.49023682 0.49713486 0.49062338 0.4958387  0.4945761  0.49380878
 0.4921434  0.49979421 0.4938525  0.4934625 ]
2025-06-17 23:07:25,526 - INFO - Preds shape: (80,)
2025-06-17 23:07:25,526 - INFO - Preds: [0 0 0 0 0 0 0 0 0 0]
2025-06-17 23:07:25,526 - INFO - Test labels shape: (80,)
2025-06-17 23:07:25,526 - INFO - Test labels: [1, 1, 1, 1, 1, 1, 1, 0, 1, 0]
2025-06-17 23:07:25,526 - INFO - Test split: Dataset({
    features: ['Unnamed: 0', 'title', 'abstract', 'Keywords', 'doi', 'labels'],
    num_rows: 80
})
2025-06-17 23:07:25,527 - INFO - Unique values in predictions: [0]
2025-06-17 23:07:25,527 - INFO - Unique values in labels: [0 1]
2025-06-17 23:07:25,528 - INFO - Confusion matrix:
[[21  0]
 [59  0]]
2025-06-17 23:07:25,528 - INFO - Confusion matrix: TN=21, FP=0, FN=59, TP=0
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-06-17 23:07:28,242 - INFO - Metrics: {'f1': 0.0, 'recall': 0.0, 'precision': 0.0, 'accuracy': 0.2625, 'AP': 0.7183983252729472, 'MCC': 0.0, 'NDCG': 0.875529752264121, 'kappa': 0.0, 'TN': 21, 'FP': 0, 'FN': 59, 'TP': 0}
2025-06-17 23:07:28,355 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-17 23:07:28,448 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 23:07:28,448 - INFO - 
On test Set (optimal threshold of 0.4922295808792114 according to cross validation on the training set): 
2025-06-17 23:07:28,449 - INFO - Confusion matrix: TN=8, FP=13, FN=17, TP=42
2025-06-17 23:07:31,254 - INFO - Metrics: {'f1': 0.7368421052631579, 'recall': 0.711864406779661, 'precision': 0.7636363636363637, 'accuracy': 0.625, 'AP': 0.7183983252729472, 'MCC': 0.08810708603918437, 'NDCG': 0.875529752264121, 'kappa': 0.0874524714828897, 'TN': 8, 'FP': 13, 'FN': 17, 'TP': 42}
2025-06-17 23:07:31,352 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 23:07:31,352 - INFO - Results for fold 2 : [{'f1': 0.7368421052631579, 'recall': 0.711864406779661, 'precision': 0.7636363636363637, 'accuracy': 0.625, 'AP': 0.7183983252729472, 'MCC': 0.08810708603918437, 'NDCG': 0.875529752264121, 'kappa': 0.0874524714828897, 'TN': 8, 'FP': 13, 'FN': 17, 'TP': 42}]
2025-06-17 23:07:31,681 - INFO - Cleared CUDA cache. Memory allocated: 1.33 GB, Memory reserved: 1.63 GB
2025-06-17 23:07:31,687 - INFO - Metrics stored successfully at /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/metrics/binary_metrics.csv
Ensemble :
2025-06-17 23:07:39,071 - INFO - Namespace(config='configs/ensemble.yaml', fold=1, run=0, model_names=None, nb_opt_negs=100, loss='BCE', with_title=True, with_keywords=False)
2025-06-17 23:07:39,072 - INFO - {'model_names': ['microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract', 'microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext', 'FacebookAI/roberta-base', 'dmis-lab/biobert-v1.1', 'google-bert/bert-base-uncased'], 'fold': 0, 'run': 0, 'loss_type': 'BCE', 'with_title': True, 'with_keywords': False, 'nb_optional_negs': 100}
2025-06-17 23:07:39,080 - INFO - 
fold number 2 | run no. 0
2025-06-17 23:07:39,456 - INFO - Confusion matrix: TN=0, FP=21, FN=0, TP=59
2025-06-17 23:07:42,186 - INFO - Metrics: {'f1': 0.8489208633093526, 'recall': 1.0, 'precision': 0.7375, 'accuracy': 0.7375, 'AP': 0.9238127210137657, 'MCC': 0.0, 'NDCG': 0.9848464980495337, 'kappa': 0.0, 'TN': 0, 'FP': 21, 'FN': 0, 'TP': 59}
2025-06-17 23:07:42,190 - INFO - Metrics stored successfully at /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/metrics/binary_metrics.csv
Traceback (most recent call last):
  File "/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/ensemble.py", line 211, in <module>
    main()
  File "/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/ensemble.py", line 208, in main
    ensemble_pred(cfg)
  File "/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/ensemble.py", line 179, in ensemble_pred
    (avg_metrics["loss_type"] == self.loss_type)
                                 ^^^^
NameError: name 'self' is not defined. Did you mean: 'Self'?
Fold number: 2
Run number: 0
Model: microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract
2025-06-17 23:07:49,026 - INFO - Namespace(config='configs/hpo.yaml', fold=2, run=0, gpu=None, model_name='microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract', nb_opt_negs=100, n_trials=3, hpo_metric=None, direction=None, loss='BCE', with_title=True, with_keywords=False)
2025-06-17 23:07:49,027 - INFO - {'model_name': 'google-bert/bert-base-uncased', 'num_trials': 20, 'fold': 0, 'hpo_metric': 'eval_kappa', 'direction': 'max', 'loss_type': 'BCE', 'with_title': True, 'with_keywords': False, 'nb_optional_negs': 100}
2025-06-17 23:07:49,416 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
2025-06-17 23:07:49,416 - INFO - 
fold number 3 | run no. 1
2025-06-17 23:07:50,038 - INFO - train split size : 338
2025-06-17 23:07:50,039 - INFO - dev split size : 80
2025-06-17 23:07:50,039 - INFO - test split size : 79
2025-06-17 23:07:50,287 - INFO - 3 datasets tokenized successfully
2025-06-17 23:07:50,350 - INFO - Fold 3 max seq len = 512
2025-06-17 23:07:50,350 - INFO - Starting hyperparameter search for BCE loss
2025-06-17 23:07:51,711	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
2025-06-17 23:07:52,425	INFO tune.py:253 -- Initializing Ray automatically. For cluster usage or custom Ray initialization, call `ray.init(...)` before `tune.run(...)`.
[36m(trainable pid=170330)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=170330)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=170330)[0m 2025-06-17 23:08:00,873 - INFO - pos_weight value in TrainingArguments : 6.828424226204718
[36m(trainable pid=170330)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=170330)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=170528)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=170528)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=170528)[0m 2025-06-17 23:08:07,416 - INFO - pos_weight value in TrainingArguments : 6.094080202241274
[36m(trainable pid=170528)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=170528)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=170825)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=170825)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=170825)[0m 2025-06-17 23:08:13,349 - INFO - pos_weight value in TrainingArguments : 7.183206941666034
[36m(trainable pid=170825)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=170825)[0m   super().__init__(*args, **kwargs)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     trainable_2025-06-17_23-07-52   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-07-52
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-17_23-07-50_373567_167890/artifacts/2025-06-17_23-07-52/trainable_2025-06-17_23-07-52/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-17 23:07:53. Total running time: 0s
Logical resource usage: 0/32 CPUs, 0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_78145ca5   PENDING         6.82842       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_78145ca5 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_78145ca5 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          6.82842 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=170330)[0m [2025-06-17 23:08:01,112] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=170330)[0m [2025-06-17 23:08:03,736] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=170330)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial trainable_aef23dce started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_aef23dce config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          6.09408 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=170528)[0m [2025-06-17 23:08:07,827] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=170528)[0m [2025-06-17 23:08:10,713] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=170330)[0m {'loss': 2.2232, 'grad_norm': 23.388195037841797, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}
[36m(trainable pid=170528)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial trainable_7a374761 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_7a374761 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          7.18321 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=170825)[0m [2025-06-17 23:08:13,570] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=170825)[0m [2025-06-17 23:08:16,354] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=170825)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 3 RUNNING
Current time: 2025-06-17 23:08:23. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_78145ca5   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ trainable_aef23dce   RUNNING         6.09408       4.55539e-06         0.123031                    5 â”‚
â”‚ trainable_7a374761   RUNNING         7.18321       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=170825)[0m 2025-06-17 23:08:40,308 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=170825)[0m 2025-06-17 23:08:40,315 - INFO - eval_result: {'eval_loss': 3.083333969116211, 'eval_f1': 0.8130081300813008, 'eval_accuracy': 0.7125, 'eval_kappa': 0.19580419580419584, 'eval_precision': 0.78125, 'eval_recall': 0.847457627118644, 'eval_optim_threshold': 0.9916664958000183, 'eval_AP': 0.9351449225353881, 'eval_MCC': 0.19886684640449762, 'eval_NDCG': 0.9875053381604603, 'eval_runtime': 3.5443, 'eval_samples_per_second': 22.571, 'eval_steps_per_second': 1.129, 'epoch': 3.0}
2025-06-17 23:08:40,771 - INFO - Cleaning up trial 7a374761
2025-06-17 23:08:40,771 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-07-52/trainable_7a374761_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512_2025-06-17_23-08-06
[36m(trainable pid=170825)[0m 2025-06-17 23:08:40,747 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB

[36m(trainable pid=170825)[0m {'loss': 1.5615, 'grad_norm': 9.239866256713867, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
[36m(trainable pid=170825)[0m {'loss': 0.6303, 'grad_norm': 29.592586517333984, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}[32m [repeated 3x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(trainable pid=170825)[0m {'train_runtime': 19.9473, 'train_samples_per_second': 50.834, 'train_steps_per_second': 2.557, 'train_loss': 0.8217974363588819, 'epoch': 3.0}
[36m(trainable pid=170825)[0m STATE at ending of training  :  TrainerState(epoch=3.0, global_step=51, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=266792214693888.0, log_history=[{'loss': 1.5615, 'grad_norm': 9.239866256713867, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0, 'step': 17}, {'loss': 0.6303, 'grad_norm': 29.592586517333984, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0, 'step': 34}, {'loss': 0.2735, 'grad_norm': 11.611174583435059, 'learning_rate': 0.0, 'epoch': 3.0, 'step': 51}, {'train_runtime': 19.9473, 'train_samples_per_second': 50.834, 'train_steps_per_second': 2.557, 'total_flos': 266792214693888.0, 'train_loss': 0.8217974363588819, 'epoch': 3.0, 'step': 51}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=170825)[0m {'loss': 0.2735, 'grad_norm': 11.611174583435059, 'learning_rate': 0.0, 'epoch': 3.0}
[36m(trainable pid=170825)[0m {'eval_loss': 3.083333969116211, 'eval_f1': 0.8130081300813008, 'eval_accuracy': 0.7125, 'eval_kappa': 0.19580419580419584, 'eval_precision': 0.78125, 'eval_recall': 0.847457627118644, 'eval_optim_threshold': 0.9916664958000183, 'eval_AP': 0.9351449225353881, 'eval_MCC': 0.19886684640449762, 'eval_NDCG': 0.9875053381604603, 'eval_runtime': 3.5443, 'eval_samples_per_second': 22.571, 'eval_steps_per_second': 1.129, 'epoch': 3.0}
[36m(trainable pid=170330)[0m {'loss': 1.5006, 'grad_norm': 9.422565460205078, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0}

Trial trainable_7a374761 finished iteration 1 at 2025-06-17 23:08:40. Total running time: 47s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_7a374761 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    28.2616 â”‚
â”‚ time_total_s                        28.2616 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     3 â”‚
â”‚ eval_AP                             0.93514 â”‚
â”‚ eval_MCC                            0.19887 â”‚
â”‚ eval_NDCG                           0.98751 â”‚
â”‚ eval_accuracy                        0.7125 â”‚
â”‚ eval_f1                             0.81301 â”‚
â”‚ eval_kappa                           0.1958 â”‚
â”‚ eval_loss                           3.08333 â”‚
â”‚ eval_optim_threshold                0.99167 â”‚
â”‚ eval_precision                      0.78125 â”‚
â”‚ eval_recall                         0.84746 â”‚
â”‚ eval_runtime                         3.5443 â”‚
â”‚ eval_samples_per_second              22.571 â”‚
â”‚ eval_steps_per_second                 1.129 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_7a374761 completed after 1 iterations at 2025-06-17 23:08:40. Total running time: 47s

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 23:08:53. Total running time: 1min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_78145ca5   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_aef23dce   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_7a374761   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            28.2616       3.08333    0.813008            0.7125       0.195804 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=170330)[0m {'loss': 1.4137, 'grad_norm': 13.337431907653809, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0}[32m [repeated 2x across cluster][0m
[36m(trainable pid=170330)[0m {'loss': 1.3827, 'grad_norm': 11.230168342590332, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0}[32m [repeated 2x across cluster][0m
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 23:09:23. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_78145ca5   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_aef23dce   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_7a374761   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            28.2616       3.08333    0.813008            0.7125       0.195804 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=170330)[0m 2025-06-17 23:09:30,294 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=170330)[0m 2025-06-17 23:09:30,299 - INFO - eval_result: {'eval_loss': 1.3087961673736572, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8763151168823242, 'eval_AP': 0.8094440815413644, 'eval_MCC': 0.0, 'eval_NDCG': 0.9539672211429138, 'eval_runtime': 4.227, 'eval_samples_per_second': 18.926, 'eval_steps_per_second': 0.946, 'epoch': 6.0}
2025-06-17 23:09:30,631 - INFO - Cleaning up trial 78145ca5
2025-06-17 23:09:30,632 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-07-52/trainable_78145ca5_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-17_23-07-53
2025-06-17 23:09:30,632 - INFO - Current best: 7a374761 with eval_kappa : 0.19580419580419584 at iteration 1
[36m(trainable pid=170330)[0m 2025-06-17 23:09:30,612 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(trainable pid=170528)[0m 2025-06-17 23:09:30,805 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=170528)[0m 2025-06-17 23:09:30,810 - INFO - eval_result: {'eval_loss': 1.125984787940979, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9102853536605835, 'eval_AP': 0.8266605247039666, 'eval_MCC': 0.0, 'eval_NDCG': 0.9579160926573094, 'eval_runtime': 3.3801, 'eval_samples_per_second': 23.668, 'eval_steps_per_second': 1.183, 'epoch': 5.0}
2025-06-17 23:09:31,275 - INFO - Cleaning up trial aef23dce
2025-06-17 23:09:31,275 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-07-52/trainable_aef23dce_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-17_23-08-00
2025-06-17 23:09:31,275 - INFO - Cleaning up trial 78145ca5
2025-06-17 23:09:31,276 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-07-52/trainable_78145ca5_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-17_23-07-53
2025-06-17 23:09:31,276 - INFO - Current best: 7a374761 with eval_kappa : 0.19580419580419584 at iteration 1
2025-06-17 23:09:31,284	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-07-52' in 0.0060s.

[36m(trainable pid=170330)[0m {'train_runtime': 81.9987, 'train_samples_per_second': 24.732, 'train_steps_per_second': 1.244, 'train_loss': 1.5918392293593462, 'epoch': 6.0}
[36m(trainable pid=170330)[0m STATE at ending of training  :  TrainerState(epoch=6.0, global_step=102, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=533584429387776.0, log_history=[{'loss': 2.2232, 'grad_norm': 23.388195037841797, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0, 'step': 17}, {'loss': 1.6666, 'grad_norm': 16.731624603271484, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0, 'step': 34}, {'loss': 1.5006, 'grad_norm': 9.422565460205078, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0, 'step': 51}, {'loss': 1.4137, 'grad_norm': 13.337431907653809, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0, 'step': 68}, {'loss': 1.3827, 'grad_norm': 11.230168342590332, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0, 'step': 85}, {'loss': 1.3642, 'grad_norm': 10.41429328918457, 'learning_rate': 0.0, 'epoch': 6.0, 'step': 102}, {'train_runtime': 81.9987, 'train_samples_per_second': 24.732, 'train_steps_per_second': 1.244, 'total_flos': 533584429387776.0, 'train_loss': 1.5918392293593462, 'epoch': 6.0, 'step': 102}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=170330)[0m {'loss': 1.3642, 'grad_norm': 10.41429328918457, 'learning_rate': 0.0, 'epoch': 6.0}[32m [repeated 2x across cluster][0m
[36m(trainable pid=170528)[0m STATE at ending of training  :  TrainerState(epoch=5.0, global_step=85, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=444653691156480.0, log_history=[{'loss': 1.5987, 'grad_norm': 9.407465934753418, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0, 'step': 17}, {'loss': 1.2689, 'grad_norm': 7.935882091522217, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0, 'step': 34}, {'loss': 1.1822, 'grad_norm': 10.057454109191895, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0, 'step': 51}, {'loss': 1.1114, 'grad_norm': 10.943946838378906, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0, 'step': 68}, {'loss': 1.08, 'grad_norm': 9.572667121887207, 'learning_rate': 0.0, 'epoch': 5.0, 'step': 85}, {'train_runtime': 76.2432, 'train_samples_per_second': 22.166, 'train_steps_per_second': 1.115, 'total_flos': 444653691156480.0, 'train_loss': 1.2482214086196002, 'epoch': 5.0, 'step': 85}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=170330)[0m {'eval_loss': 1.3087961673736572, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8763151168823242, 'eval_AP': 0.8094440815413644, 'eval_MCC': 0.0, 'eval_NDCG': 0.9539672211429138, 'eval_runtime': 4.227, 'eval_samples_per_second': 18.926, 'eval_steps_per_second': 0.946, 'epoch': 6.0}

Trial trainable_78145ca5 finished iteration 1 at 2025-06-17 23:09:30. Total running time: 1min 37s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_78145ca5 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    90.5836 â”‚
â”‚ time_total_s                        90.5836 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     6 â”‚
â”‚ eval_AP                             0.80944 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.95397 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                            1.3088 â”‚
â”‚ eval_optim_threshold                0.87632 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                          4.227 â”‚
â”‚ eval_samples_per_second              18.926 â”‚
â”‚ eval_steps_per_second                 0.946 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_78145ca5 completed after 1 iterations at 2025-06-17 23:09:30. Total running time: 1min 37s

Trial trainable_aef23dce finished iteration 1 at 2025-06-17 23:09:31. Total running time: 1min 37s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_aef23dce result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    84.9299 â”‚
â”‚ time_total_s                        84.9299 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     5 â”‚
â”‚ eval_AP                             0.82666 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.95792 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.12598 â”‚
â”‚ eval_optim_threshold                0.91029 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.3801 â”‚
â”‚ eval_samples_per_second              23.668 â”‚
â”‚ eval_steps_per_second                 1.183 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_aef23dce completed after 1 iterations at 2025-06-17 23:09:31. Total running time: 1min 37s

Trial status: 3 TERMINATED
Current time: 2025-06-17 23:09:31. Total running time: 1min 37s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_78145ca5   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1            90.5836       1.3088     0.848921            0.7375       0        â”‚
â”‚ trainable_aef23dce   TERMINATED        6.09408       4.55539e-06         0.123031                    5        1            84.9299       1.12598    0.848921            0.7375       0        â”‚
â”‚ trainable_7a374761   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            28.2616       3.08333    0.813008            0.7125       0.195804 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯2025-06-17 23:09:31,290 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x77893226bd50>
2025-06-17 23:09:31,290 - INFO - Best trial : trainable_7a374761
2025-06-17 23:09:31,290 - INFO - Best config : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-17 23:09:31,290 - INFO - Best trial after optimization: {'eval_loss': 3.083333969116211, 'eval_f1': 0.8130081300813008, 'eval_accuracy': 0.7125, 'eval_kappa': 0.19580419580419584, 'eval_precision': 0.78125, 'eval_recall': 0.847457627118644, 'eval_optim_threshold': 0.9916664958000183, 'eval_AP': 0.9351449225353881, 'eval_MCC': 0.19886684640449762, 'eval_NDCG': 0.9875053381604603, 'eval_runtime': 3.5443, 'eval_samples_per_second': 22.571, 'eval_steps_per_second': 1.129, 'epoch': 3.0, 'timestamp': 1750194520, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '7a374761', 'date': '2025-06-17_23-08-40', 'time_this_iter_s': 28.261572122573853, 'time_total_s': 28.261572122573853, 'pid': 170825, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 28.261572122573853, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512'}
2025-06-17 23:09:31,312 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   1.308796  0.848921  ...                        6  78145ca5
1   1.125985  0.848921  ...                        5  aef23dce
2   3.083334  0.813008  ...                        3  7a374761

[3 rows x 32 columns]
2025-06-17 23:09:31,499 - INFO - Trial comparison plot saved
2025-06-17 23:09:31,507 - INFO - Best Hyperparameters after HPO : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}


[36m(trainable pid=170528)[0m 2025-06-17 23:09:31,254 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(trainable pid=170528)[0m {'train_runtime': 76.2432, 'train_samples_per_second': 22.166, 'train_steps_per_second': 1.115, 'train_loss': 1.2482214086196002, 'epoch': 5.0}
[36m(trainable pid=170528)[0m {'loss': 1.08, 'grad_norm': 9.572667121887207, 'learning_rate': 0.0, 'epoch': 5.0}
[36m(trainable pid=170528)[0m {'eval_loss': 1.125984787940979, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9102853536605835, 'eval_AP': 0.8266605247039666, 'eval_MCC': 0.0, 'eval_NDCG': 0.9579160926573094, 'eval_runtime': 3.3801, 'eval_samples_per_second': 23.668, 'eval_steps_per_second': 1.183, 'epoch': 5.0}
2025-06-17 23:09:40,371 - INFO - Namespace(config='configs/train.yaml', hp_config='configs/best_hpo.yaml', fold=2, run=0, gpu='2', model_name='microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract', nb_opt_negs=100, loss='BCE', with_title=True, with_keywords=False, best_metric=None)
2025-06-17 23:09:40,373 - INFO - {'model_name': 'bert-base-uncased', 'fold': 0, 'run': 0, 'output_dir': 'outputs/checkpoints', 'best_metric': 'eval_kappa', 'loss_type': 'BCE', 'nb_optional_negs': 100, 'with_title': True, 'with_keywords': False, 'default_hyperparameters': {'learning_rate': 'None', 'num_train_epochs': 'None', 'pos_weight': 'None', 'weight_decay': 'None'}}
2025-06-17 23:09:41,294 - INFO - train split size : 338
2025-06-17 23:09:41,294 - INFO - dev split size : 80
2025-06-17 23:09:41,294 - INFO - test split size : 79
2025-06-17 23:09:41,540 - INFO - 3 datasets tokenized successfully
2025-06-17 23:09:41,540 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-17 23:09:42,267 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
[2025-06-17 23:09:42,494] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-06-17 23:09:45,195] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
2025-06-17 23:09:45,232 - INFO - training size : 338
2025-06-17 23:09:45,232 - INFO - dev size : 80
2025-06-17 23:09:45,232 - INFO - test size : 79
  0%|          | 0/12 [00:00<?, ?it/s]  8%|â–Š         | 1/12 [00:02<00:25,  2.36s/it] 17%|â–ˆâ–‹        | 2/12 [00:04<00:20,  2.05s/it] 25%|â–ˆâ–ˆâ–Œ       | 3/12 [00:05<00:17,  1.93s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [00:06<00:11,  1.44s/it]                                               33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [00:06<00:11,  1.44s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 5/12 [00:08<00:11,  1.61s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 6/12 [00:10<00:10,  1.68s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 7/12 [00:12<00:08,  1.72s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [00:12<00:05,  1.39s/it]                                               67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [00:12<00:05,  1.39s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 9/12 [00:14<00:04,  1.55s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 10/12 [00:16<00:03,  1.64s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 11/12 [00:18<00:01,  1.68s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:19<00:00,  1.38s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:21<00:00,  1.38s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:21<00:00,  1.38s/it]2025-06-17 23:10:06,823 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:21<00:00,  1.78s/it]
{'loss': 1.9002, 'grad_norm': 6.783247947692871, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
{'loss': 1.0803, 'grad_norm': 9.493266105651855, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
{'loss': 0.8692, 'grad_norm': 7.774380207061768, 'learning_rate': 0.0, 'epoch': 3.0}
{'train_runtime': 21.3069, 'train_samples_per_second': 47.59, 'train_steps_per_second': 0.563, 'train_loss': 1.2832008401552837, 'epoch': 3.0}
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 23:10:10,146 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.82s/it]
2025-06-17 23:10:10,153 - INFO - Training time : 28.613022567005828
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 23:10:13,395 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.73s/it]
2025-06-17 23:10:13,400 - INFO - Evaluation time : 3.2465710500255227
2025-06-17 23:10:13,400 - INFO - Evaluation results on test set: {'eval_loss': 1.0878781080245972, 'eval_f1': 0.855072463768116, 'eval_accuracy': 0.7468354430379747, 'eval_kappa': 0.0, 'eval_precision': 0.7468354430379747, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9211729168891907, 'eval_AP': 0.7967377897241659, 'eval_MCC': 0.0, 'eval_NDCG': 0.9385272678905879, 'eval_runtime': 3.2339, 'eval_samples_per_second': 24.429, 'eval_steps_per_second': 0.309, 'epoch': 3.0}
2025-06-17 23:10:13,400 - INFO - Total updates (optimizer steps): 12
2025-06-17 23:10:13,400 - INFO - Avg time / step: 1.776s
2025-06-17 23:10:14,315 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCE_BiomedBERT-abs_fold-3
2025-06-17 23:10:14,316 - INFO - On test Set (with threshold 0.5) : 
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 23:10:18,330 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:03<00:00,  3.51s/it]
2025-06-17 23:10:18,334 - INFO - Raw predictions shape: (79, 1)
2025-06-17 23:10:18,334 - INFO - Raw predictions: [[2.6261823]
 [2.5176504]
 [2.6353776]
 [1.8110151]
 [2.754936 ]
 [3.217244 ]
 [2.4466908]
 [3.098694 ]
 [3.1885839]
 [3.3659804]]
2025-06-17 23:10:18,334 - INFO - Scores shape: (79,)
2025-06-17 23:10:18,334 - INFO - Scores: [0.9325277  0.9253699  0.93310404 0.8594845  0.94019157 0.9614781
 0.9203192  0.95683885 0.9604024  0.96662426]
2025-06-17 23:10:18,334 - INFO - Preds shape: (79,)
2025-06-17 23:10:18,334 - INFO - Preds: [1 1 1 1 1 1 1 1 1 1]
2025-06-17 23:10:18,334 - INFO - Test labels shape: (79,)
2025-06-17 23:10:18,335 - INFO - Test labels: [0, 1, 1, 1, 1, 1, 0, 1, 1, 0]
2025-06-17 23:10:18,335 - INFO - Test split: Dataset({
    features: ['Unnamed: 0', 'title', 'abstract', 'Keywords', 'doi', 'labels'],
    num_rows: 79
})
2025-06-17 23:10:18,335 - INFO - Unique values in predictions: [1]
2025-06-17 23:10:18,335 - INFO - Unique values in labels: [0 1]
2025-06-17 23:10:18,336 - INFO - Confusion matrix:
[[ 0 20]
 [ 0 59]]
2025-06-17 23:10:18,336 - INFO - Confusion matrix: TN=0, FP=20, FN=0, TP=59
2025-06-17 23:10:21,052 - INFO - Metrics: {'f1': 0.855072463768116, 'recall': 1.0, 'precision': 0.7468354430379747, 'accuracy': 0.7468354430379747, 'AP': 0.7967377897241659, 'MCC': 0.0, 'NDCG': 0.9385272678905879, 'kappa': 0.0, 'TN': 0, 'FP': 20, 'FN': 0, 'TP': 59}
2025-06-17 23:10:21,167 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-17 23:10:21,262 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 23:10:21,262 - INFO - 
On test Set (optimal threshold of 0.8813273906707764 according to cross validation on the training set): 
2025-06-17 23:10:21,263 - INFO - Confusion matrix: TN=7, FP=13, FN=9, TP=50
2025-06-17 23:10:24,147 - INFO - Metrics: {'f1': 0.819672131147541, 'recall': 0.847457627118644, 'precision': 0.7936507936507936, 'accuracy': 0.7215189873417721, 'AP': 0.7967377897241659, 'MCC': 0.2136410241991857, 'NDCG': 0.9385272678905879, 'kappa': 0.21143375680580756, 'TN': 7, 'FP': 13, 'FN': 9, 'TP': 50}
2025-06-17 23:10:24,245 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 23:10:24,245 - INFO - Results for fold 3 : [{'f1': 0.819672131147541, 'recall': 0.847457627118644, 'precision': 0.7936507936507936, 'accuracy': 0.7215189873417721, 'AP': 0.7967377897241659, 'MCC': 0.2136410241991857, 'NDCG': 0.9385272678905879, 'kappa': 0.21143375680580756, 'TN': 7, 'FP': 13, 'FN': 9, 'TP': 50}]
2025-06-17 23:10:24,584 - INFO - Cleared CUDA cache. Memory allocated: 1.33 GB, Memory reserved: 1.63 GB
2025-06-17 23:10:24,589 - INFO - Metrics stored successfully at /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/metrics/binary_metrics.csv
Model: microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext
2025-06-17 23:10:31,944 - INFO - Namespace(config='configs/hpo.yaml', fold=2, run=0, gpu=None, model_name='microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext', nb_opt_negs=100, n_trials=3, hpo_metric=None, direction=None, loss='BCE', with_title=True, with_keywords=False)
2025-06-17 23:10:31,945 - INFO - {'model_name': 'google-bert/bert-base-uncased', 'num_trials': 20, 'fold': 0, 'hpo_metric': 'eval_kappa', 'direction': 'max', 'loss_type': 'BCE', 'with_title': True, 'with_keywords': False, 'nb_optional_negs': 100}
2025-06-17 23:10:32,322 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
2025-06-17 23:10:32,323 - INFO - 
fold number 3 | run no. 1
2025-06-17 23:10:32,928 - INFO - train split size : 338
2025-06-17 23:10:32,928 - INFO - dev split size : 80
2025-06-17 23:10:32,928 - INFO - test split size : 79
2025-06-17 23:10:33,165 - INFO - 3 datasets tokenized successfully
2025-06-17 23:10:33,223 - INFO - Fold 3 max seq len = 512
2025-06-17 23:10:33,224 - INFO - Starting hyperparameter search for BCE loss
2025-06-17 23:10:34,590	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
2025-06-17 23:10:35,301	INFO tune.py:253 -- Initializing Ray automatically. For cluster usage or custom Ray initialization, call `ray.init(...)` before `tune.run(...)`.
[36m(trainable pid=175562)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=175562)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=175562)[0m 2025-06-17 23:10:43,869 - INFO - pos_weight value in TrainingArguments : 6.828424226204718
[36m(trainable pid=175562)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=175562)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=175760)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=175760)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=175760)[0m 2025-06-17 23:10:50,149 - INFO - pos_weight value in TrainingArguments : 6.094080202241274
[36m(trainable pid=175760)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=175760)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=176148)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=176148)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=176148)[0m 2025-06-17 23:10:56,726 - INFO - pos_weight value in TrainingArguments : 7.183206941666034
[36m(trainable pid=176148)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=176148)[0m   super().__init__(*args, **kwargs)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     trainable_2025-06-17_23-10-35   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-10-35
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-17_23-10-33_246847_173121/artifacts/2025-06-17_23-10-35/trainable_2025-06-17_23-10-35/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-17 23:10:36. Total running time: 0s
Logical resource usage: 0/32 CPUs, 0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_46e299cd   PENDING         6.82842       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_46e299cd started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_46e299cd config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          6.82842 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=175562)[0m [2025-06-17 23:10:44,100] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=175562)[0m [2025-06-17 23:10:46,723] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=175562)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial trainable_1f2b2186 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_1f2b2186 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          6.09408 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=175760)[0m [2025-06-17 23:10:50,538] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=175760)[0m [2025-06-17 23:10:53,242] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=175760)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=175562)[0m {'loss': 2.514, 'grad_norm': 19.166654586791992, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}

Trial trainable_c54aacdd started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_c54aacdd config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          7.18321 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=176148)[0m [2025-06-17 23:10:56,944] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=176148)[0m [2025-06-17 23:10:59,528] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=176148)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 3 RUNNING
Current time: 2025-06-17 23:11:06. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_46e299cd   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ trainable_1f2b2186   RUNNING         6.09408       4.55539e-06         0.123031                    5 â”‚
â”‚ trainable_c54aacdd   RUNNING         7.18321       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=176148)[0m 2025-06-17 23:11:23,033 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=176148)[0m 2025-06-17 23:11:23,039 - INFO - eval_result: {'eval_loss': 1.7738564014434814, 'eval_f1': 0.8346456692913385, 'eval_accuracy': 0.7375, 'eval_kappa': 0.2134831460674158, 'eval_precision': 0.7794117647058824, 'eval_recall': 0.8983050847457628, 'eval_optim_threshold': 0.9889425039291382, 'eval_AP': 0.9309409144262357, 'eval_MCC': 0.22675356014913559, 'eval_NDCG': 0.9867672533755727, 'eval_runtime': 3.3029, 'eval_samples_per_second': 24.221, 'eval_steps_per_second': 1.211, 'epoch': 3.0}
2025-06-17 23:11:23,370 - INFO - Cleaning up trial c54aacdd
2025-06-17 23:11:23,370 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-10-35/trainable_c54aacdd_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512_2025-06-17_23-10-49
[36m(trainable pid=176148)[0m 2025-06-17 23:11:23,347 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB

[36m(trainable pid=176148)[0m {'loss': 1.3813, 'grad_norm': 8.641097068786621, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
[36m(trainable pid=176148)[0m {'loss': 0.6975, 'grad_norm': 13.100804328918457, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}[32m [repeated 3x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(trainable pid=176148)[0m {'train_runtime': 19.8522, 'train_samples_per_second': 51.078, 'train_steps_per_second': 2.569, 'train_loss': 0.8361307125465542, 'epoch': 3.0}
[36m(trainable pid=176148)[0m STATE at ending of training  :  TrainerState(epoch=3.0, global_step=51, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=266792214693888.0, log_history=[{'loss': 1.3813, 'grad_norm': 8.641097068786621, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0, 'step': 17}, {'loss': 0.6975, 'grad_norm': 13.100804328918457, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0, 'step': 34}, {'loss': 0.4296, 'grad_norm': 9.5872220993042, 'learning_rate': 0.0, 'epoch': 3.0, 'step': 51}, {'train_runtime': 19.8522, 'train_samples_per_second': 51.078, 'train_steps_per_second': 2.569, 'total_flos': 266792214693888.0, 'train_loss': 0.8361307125465542, 'epoch': 3.0, 'step': 51}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=176148)[0m {'loss': 0.4296, 'grad_norm': 9.5872220993042, 'learning_rate': 0.0, 'epoch': 3.0}
[36m(trainable pid=176148)[0m {'eval_loss': 1.7738564014434814, 'eval_f1': 0.8346456692913385, 'eval_accuracy': 0.7375, 'eval_kappa': 0.2134831460674158, 'eval_precision': 0.7794117647058824, 'eval_recall': 0.8983050847457628, 'eval_optim_threshold': 0.9889425039291382, 'eval_AP': 0.9309409144262357, 'eval_MCC': 0.22675356014913559, 'eval_NDCG': 0.9867672533755727, 'eval_runtime': 3.3029, 'eval_samples_per_second': 24.221, 'eval_steps_per_second': 1.211, 'epoch': 3.0}

Trial trainable_c54aacdd finished iteration 1 at 2025-06-17 23:11:23. Total running time: 46s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_c54aacdd result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    27.4629 â”‚
â”‚ time_total_s                        27.4629 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     3 â”‚
â”‚ eval_AP                             0.93094 â”‚
â”‚ eval_MCC                            0.22675 â”‚
â”‚ eval_NDCG                           0.98677 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.83465 â”‚
â”‚ eval_kappa                          0.21348 â”‚
â”‚ eval_loss                           1.77386 â”‚
â”‚ eval_optim_threshold                0.98894 â”‚
â”‚ eval_precision                      0.77941 â”‚
â”‚ eval_recall                         0.89831 â”‚
â”‚ eval_runtime                         3.3029 â”‚
â”‚ eval_samples_per_second              24.221 â”‚
â”‚ eval_steps_per_second                 1.211 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_c54aacdd completed after 1 iterations at 2025-06-17 23:11:23. Total running time: 46s
[36m(trainable pid=175760)[0m {'loss': 1.3467, 'grad_norm': 5.5317912101745605, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0}

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 23:11:36. Total running time: 1min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_46e299cd   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_1f2b2186   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_c54aacdd   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.4629       1.77386    0.834646            0.7375       0.213483 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=175562)[0m {'loss': 1.6005, 'grad_norm': 14.193305015563965, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0}[32m [repeated 2x across cluster][0m
[36m(trainable pid=175760)[0m {'loss': 1.23, 'grad_norm': 5.825993061065674, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0}[32m [repeated 2x across cluster][0m
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 23:12:06. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_46e299cd   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_1f2b2186   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_c54aacdd   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.4629       1.77386    0.834646            0.7375       0.213483 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=175562)[0m 2025-06-17 23:12:14,198 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=175562)[0m 2025-06-17 23:12:14,204 - INFO - eval_result: {'eval_loss': 1.4788830280303955, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8140177726745605, 'eval_AP': 0.7715881357745389, 'eval_MCC': 0.0, 'eval_NDCG': 0.8705829173777035, 'eval_runtime': 3.9943, 'eval_samples_per_second': 20.028, 'eval_steps_per_second': 1.001, 'epoch': 6.0}
[36m(trainable pid=175760)[0m 2025-06-17 23:12:14,311 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=175760)[0m 2025-06-17 23:12:14,317 - INFO - eval_result: {'eval_loss': 1.0771195888519287, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8803696036338806, 'eval_AP': 0.820569792312342, 'eval_MCC': 0.0, 'eval_NDCG': 0.948549972023179, 'eval_runtime': 4.1417, 'eval_samples_per_second': 19.316, 'eval_steps_per_second': 0.966, 'epoch': 5.0}
2025-06-17 23:12:14,690 - INFO - Cleaning up trial 1f2b2186
2025-06-17 23:12:14,690 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-10-35/trainable_1f2b2186_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-17_23-10-43
2025-06-17 23:12:14,691 - INFO - Current best: c54aacdd with eval_kappa : 0.2134831460674158 at iteration 1
2025-06-17 23:12:14,703 - INFO - Cleaning up trial 46e299cd
2025-06-17 23:12:14,703 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-10-35/trainable_46e299cd_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-17_23-10-36
2025-06-17 23:12:14,703 - INFO - Cleaning up trial 1f2b2186
2025-06-17 23:12:14,703 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-10-35/trainable_1f2b2186_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-17_23-10-43
2025-06-17 23:12:14,703 - INFO - Current best: c54aacdd with eval_kappa : 0.2134831460674158 at iteration 1
2025-06-17 23:12:14,711	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-10-35' in 0.0063s.

[36m(trainable pid=175562)[0m {'train_runtime': 83.1417, 'train_samples_per_second': 24.392, 'train_steps_per_second': 1.227, 'train_loss': 1.825166851866479, 'epoch': 6.0}
[36m(trainable pid=175562)[0m STATE at ending of training  :  TrainerState(epoch=6.0, global_step=102, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=533584429387776.0, log_history=[{'loss': 2.514, 'grad_norm': 19.166654586791992, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0, 'step': 17}, {'loss': 2.0008, 'grad_norm': 18.261829376220703, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0, 'step': 34}, {'loss': 1.7716, 'grad_norm': 9.195463180541992, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0, 'step': 51}, {'loss': 1.6005, 'grad_norm': 14.193305015563965, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0, 'step': 68}, {'loss': 1.5516, 'grad_norm': 10.227235794067383, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0, 'step': 85}, {'loss': 1.5125, 'grad_norm': 10.864272117614746, 'learning_rate': 0.0, 'epoch': 6.0, 'step': 102}, {'train_runtime': 83.1417, 'train_samples_per_second': 24.392, 'train_steps_per_second': 1.227, 'total_flos': 533584429387776.0, 'train_loss': 1.825166851866479, 'epoch': 6.0, 'step': 102}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=175562)[0m {'loss': 1.5125, 'grad_norm': 10.864272117614746, 'learning_rate': 0.0, 'epoch': 6.0}[32m [repeated 2x across cluster][0m
[36m(trainable pid=175760)[0m STATE at ending of training  :  TrainerState(epoch=5.0, global_step=85, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=444653691156480.0, log_history=[{'loss': 1.776, 'grad_norm': 8.531448364257812, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0, 'step': 17}, {'loss': 1.3467, 'grad_norm': 5.5317912101745605, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0, 'step': 34}, {'loss': 1.2724, 'grad_norm': 9.074224472045898, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0, 'step': 51}, {'loss': 1.23, 'grad_norm': 5.825993061065674, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0, 'step': 68}, {'loss': 1.195, 'grad_norm': 6.309096813201904, 'learning_rate': 0.0, 'epoch': 5.0, 'step': 85}, {'train_runtime': 76.5895, 'train_samples_per_second': 22.066, 'train_steps_per_second': 1.11, 'total_flos': 444653691156480.0, 'train_loss': 1.3639945310704849, 'epoch': 5.0, 'step': 85}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=175562)[0m {'eval_loss': 1.4788830280303955, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8140177726745605, 'eval_AP': 0.7715881357745389, 'eval_MCC': 0.0, 'eval_NDCG': 0.8705829173777035, 'eval_runtime': 3.9943, 'eval_samples_per_second': 20.028, 'eval_steps_per_second': 1.001, 'epoch': 6.0}

Trial trainable_1f2b2186 finished iteration 1 at 2025-06-17 23:12:14. Total running time: 1min 38s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_1f2b2186 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    85.3704 â”‚
â”‚ time_total_s                        85.3704 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     5 â”‚
â”‚ eval_AP                             0.82057 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.94855 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.07712 â”‚
â”‚ eval_optim_threshold                0.88037 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         4.1417 â”‚
â”‚ eval_samples_per_second              19.316 â”‚
â”‚ eval_steps_per_second                 0.966 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_1f2b2186 completed after 1 iterations at 2025-06-17 23:12:14. Total running time: 1min 38s

Trial trainable_46e299cd finished iteration 1 at 2025-06-17 23:12:14. Total running time: 1min 38s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_46e299cd result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    91.7016 â”‚
â”‚ time_total_s                        91.7016 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     6 â”‚
â”‚ eval_AP                             0.77159 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.87058 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.47888 â”‚
â”‚ eval_optim_threshold                0.81402 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.9943 â”‚
â”‚ eval_samples_per_second              20.028 â”‚
â”‚ eval_steps_per_second                 1.001 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_46e299cd completed after 1 iterations at 2025-06-17 23:12:14. Total running time: 1min 38s

Trial status: 3 TERMINATED
Current time: 2025-06-17 23:12:14. Total running time: 1min 38s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_46e299cd   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1            91.7016       1.47888    0.848921            0.7375       0        â”‚
â”‚ trainable_1f2b2186   TERMINATED        6.09408       4.55539e-06         0.123031                    5        1            85.3704       1.07712    0.848921            0.7375       0        â”‚
â”‚ trainable_c54aacdd   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.4629       1.77386    0.834646            0.7375       0.213483 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯2025-06-17 23:12:14,717 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x72b50df86390>
2025-06-17 23:12:14,717 - INFO - Best trial : trainable_c54aacdd
2025-06-17 23:12:14,717 - INFO - Best config : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-17 23:12:14,718 - INFO - Best trial after optimization: {'eval_loss': 1.7738564014434814, 'eval_f1': 0.8346456692913385, 'eval_accuracy': 0.7375, 'eval_kappa': 0.2134831460674158, 'eval_precision': 0.7794117647058824, 'eval_recall': 0.8983050847457628, 'eval_optim_threshold': 0.9889425039291382, 'eval_AP': 0.9309409144262357, 'eval_MCC': 0.22675356014913559, 'eval_NDCG': 0.9867672533755727, 'eval_runtime': 3.3029, 'eval_samples_per_second': 24.221, 'eval_steps_per_second': 1.211, 'epoch': 3.0, 'timestamp': 1750194683, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': 'c54aacdd', 'date': '2025-06-17_23-11-23', 'time_this_iter_s': 27.462879180908203, 'time_total_s': 27.462879180908203, 'pid': 176148, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 27.462879180908203, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512'}
2025-06-17 23:12:14,739 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   1.478883  0.848921  ...                        6  46e299cd
1   1.077120  0.848921  ...                        5  1f2b2186
2   1.773856  0.834646  ...                        3  c54aacdd

[3 rows x 32 columns]
[36m(trainable pid=175562)[0m 2025-06-17 23:12:14,680 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
2025-06-17 23:12:14,900 - INFO - Trial comparison plot saved
2025-06-17 23:12:14,911 - INFO - Best Hyperparameters after HPO : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}


[36m(trainable pid=175760)[0m 2025-06-17 23:12:14,669 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(trainable pid=175760)[0m {'train_runtime': 76.5895, 'train_samples_per_second': 22.066, 'train_steps_per_second': 1.11, 'train_loss': 1.3639945310704849, 'epoch': 5.0}
[36m(trainable pid=175760)[0m {'loss': 1.195, 'grad_norm': 6.309096813201904, 'learning_rate': 0.0, 'epoch': 5.0}
[36m(trainable pid=175760)[0m {'eval_loss': 1.0771195888519287, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8803696036338806, 'eval_AP': 0.820569792312342, 'eval_MCC': 0.0, 'eval_NDCG': 0.948549972023179, 'eval_runtime': 4.1417, 'eval_samples_per_second': 19.316, 'eval_steps_per_second': 0.966, 'epoch': 5.0}
2025-06-17 23:12:24,696 - INFO - Namespace(config='configs/train.yaml', hp_config='configs/best_hpo.yaml', fold=2, run=0, gpu='2', model_name='microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext', nb_opt_negs=100, loss='BCE', with_title=True, with_keywords=False, best_metric=None)
2025-06-17 23:12:24,698 - INFO - {'model_name': 'bert-base-uncased', 'fold': 0, 'run': 0, 'output_dir': 'outputs/checkpoints', 'best_metric': 'eval_kappa', 'loss_type': 'BCE', 'nb_optional_negs': 100, 'with_title': True, 'with_keywords': False, 'default_hyperparameters': {'learning_rate': 'None', 'num_train_epochs': 'None', 'pos_weight': 'None', 'weight_decay': 'None'}}
2025-06-17 23:12:25,495 - INFO - train split size : 338
2025-06-17 23:12:25,496 - INFO - dev split size : 80
2025-06-17 23:12:25,496 - INFO - test split size : 79
2025-06-17 23:12:25,723 - INFO - 3 datasets tokenized successfully
2025-06-17 23:12:25,723 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-17 23:12:26,452 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
[2025-06-17 23:12:26,667] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-06-17 23:12:29,283] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
2025-06-17 23:12:29,319 - INFO - training size : 338
2025-06-17 23:12:29,319 - INFO - dev size : 80
2025-06-17 23:12:29,319 - INFO - test size : 79
  0%|          | 0/12 [00:00<?, ?it/s]  8%|â–Š         | 1/12 [00:02<00:25,  2.32s/it] 17%|â–ˆâ–‹        | 2/12 [00:04<00:20,  2.03s/it] 25%|â–ˆâ–ˆâ–Œ       | 3/12 [00:05<00:17,  1.91s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [00:06<00:11,  1.43s/it]                                               33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [00:06<00:11,  1.43s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 5/12 [00:08<00:11,  1.60s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 6/12 [00:10<00:10,  1.67s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 7/12 [00:12<00:08,  1.71s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [00:12<00:05,  1.38s/it]                                               67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [00:12<00:05,  1.38s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 9/12 [00:14<00:04,  1.55s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 10/12 [00:16<00:03,  1.63s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 11/12 [00:18<00:01,  1.68s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:19<00:00,  1.38s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:20<00:00,  1.38s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:20<00:00,  1.38s/it]2025-06-17 23:12:50,458 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:20<00:00,  1.74s/it]
{'loss': 1.8085, 'grad_norm': 3.655944585800171, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
{'loss': 1.2533, 'grad_norm': 4.8153533935546875, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
{'loss': 0.9692, 'grad_norm': 4.985558032989502, 'learning_rate': 0.0, 'epoch': 3.0}
{'train_runtime': 20.8674, 'train_samples_per_second': 48.592, 'train_steps_per_second': 0.575, 'train_loss': 1.3436785141626995, 'epoch': 3.0}
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 23:12:53,756 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.79s/it]
2025-06-17 23:12:53,763 - INFO - Training time : 28.03979268297553
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 23:12:57,005 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.73s/it]
2025-06-17 23:12:57,010 - INFO - Evaluation time : 3.247008478967473
2025-06-17 23:12:57,010 - INFO - Evaluation results on test set: {'eval_loss': 1.1392728090286255, 'eval_f1': 0.855072463768116, 'eval_accuracy': 0.7468354430379747, 'eval_kappa': 0.0, 'eval_precision': 0.7468354430379747, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8592056035995483, 'eval_AP': 0.819051833254898, 'eval_MCC': 0.0, 'eval_NDCG': 0.9473044422018979, 'eval_runtime': 3.2343, 'eval_samples_per_second': 24.426, 'eval_steps_per_second': 0.309, 'epoch': 3.0}
2025-06-17 23:12:57,010 - INFO - Total updates (optimizer steps): 12
2025-06-17 23:12:57,010 - INFO - Avg time / step: 1.739s
2025-06-17 23:12:57,930 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCE_BiomedBERT-abs-ft_fold-3
2025-06-17 23:12:57,930 - INFO - On test Set (with threshold 0.5) : 
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 23:13:01,291 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.84s/it]
2025-06-17 23:13:01,295 - INFO - Raw predictions shape: (79, 1)
2025-06-17 23:13:01,295 - INFO - Raw predictions: [[1.3833488]
 [2.2969878]
 [1.629123 ]
 [1.5755544]
 [2.5749476]
 [3.267602 ]
 [2.397439 ]
 [2.9340148]
 [2.3646417]
 [3.1049411]]
2025-06-17 23:13:01,295 - INFO - Scores shape: (79,)
2025-06-17 23:13:01,295 - INFO - Scores: [0.7995283  0.9086273  0.8360495  0.82857394 0.92923176 0.9633005
 0.91663176 0.9495025  0.91409105 0.95709616]
2025-06-17 23:13:01,295 - INFO - Preds shape: (79,)
2025-06-17 23:13:01,296 - INFO - Preds: [1 1 1 1 1 1 1 1 1 1]
2025-06-17 23:13:01,296 - INFO - Test labels shape: (79,)
2025-06-17 23:13:01,296 - INFO - Test labels: [0, 1, 1, 1, 1, 1, 0, 1, 1, 0]
2025-06-17 23:13:01,296 - INFO - Test split: Dataset({
    features: ['Unnamed: 0', 'title', 'abstract', 'Keywords', 'doi', 'labels'],
    num_rows: 79
})
2025-06-17 23:13:01,296 - INFO - Unique values in predictions: [1]
2025-06-17 23:13:01,296 - INFO - Unique values in labels: [0 1]
2025-06-17 23:13:01,297 - INFO - Confusion matrix:
[[ 0 20]
 [ 0 59]]
2025-06-17 23:13:01,298 - INFO - Confusion matrix: TN=0, FP=20, FN=0, TP=59
2025-06-17 23:13:04,053 - INFO - Metrics: {'f1': 0.855072463768116, 'recall': 1.0, 'precision': 0.7468354430379747, 'accuracy': 0.7468354430379747, 'AP': 0.819051833254898, 'MCC': 0.0, 'NDCG': 0.9473044422018979, 'kappa': 0.0, 'TN': 0, 'FP': 20, 'FN': 0, 'TP': 59}
2025-06-17 23:13:04,169 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-17 23:13:04,263 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 23:13:04,263 - INFO - 
On test Set (optimal threshold of 0.9632633924484253 according to cross validation on the training set): 
2025-06-17 23:13:04,264 - INFO - Confusion matrix: TN=17, FP=3, FN=47, TP=12
2025-06-17 23:13:07,007 - INFO - Metrics: {'f1': 0.32432432432432434, 'recall': 0.2033898305084746, 'precision': 0.8, 'accuracy': 0.3670886075949367, 'AP': 0.819051833254898, 'MCC': 0.05919212470522277, 'NDCG': 0.9473044422018979, 'kappa': 0.030912659470068604, 'TN': 17, 'FP': 3, 'FN': 47, 'TP': 12}
2025-06-17 23:13:07,101 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 23:13:07,101 - INFO - Results for fold 3 : [{'f1': 0.32432432432432434, 'recall': 0.2033898305084746, 'precision': 0.8, 'accuracy': 0.3670886075949367, 'AP': 0.819051833254898, 'MCC': 0.05919212470522277, 'NDCG': 0.9473044422018979, 'kappa': 0.030912659470068604, 'TN': 17, 'FP': 3, 'FN': 47, 'TP': 12}]
2025-06-17 23:13:07,599 - INFO - Cleared CUDA cache. Memory allocated: 1.33 GB, Memory reserved: 1.63 GB
2025-06-17 23:13:07,606 - INFO - Metrics stored successfully at /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/metrics/binary_metrics.csv
Model: FacebookAI/roberta-base
2025-06-17 23:13:15,429 - INFO - Namespace(config='configs/hpo.yaml', fold=2, run=0, gpu=None, model_name='FacebookAI/roberta-base', nb_opt_negs=100, n_trials=3, hpo_metric=None, direction=None, loss='BCE', with_title=True, with_keywords=False)
2025-06-17 23:13:15,430 - INFO - {'model_name': 'google-bert/bert-base-uncased', 'num_trials': 20, 'fold': 0, 'hpo_metric': 'eval_kappa', 'direction': 'max', 'loss_type': 'BCE', 'with_title': True, 'with_keywords': False, 'nb_optional_negs': 100}
2025-06-17 23:13:15,934 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
2025-06-17 23:13:15,934 - INFO - 
fold number 3 | run no. 1
2025-06-17 23:13:16,538 - INFO - train split size : 338
2025-06-17 23:13:16,539 - INFO - dev split size : 80
2025-06-17 23:13:16,539 - INFO - test split size : 79
2025-06-17 23:13:16,814 - INFO - 3 datasets tokenized successfully
2025-06-17 23:13:16,876 - INFO - Fold 3 max seq len = 512
2025-06-17 23:13:16,876 - INFO - Starting hyperparameter search for BCE loss
2025-06-17 23:13:18,265	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
2025-06-17 23:13:18,998	INFO tune.py:253 -- Initializing Ray automatically. For cluster usage or custom Ray initialization, call `ray.init(...)` before `tune.run(...)`.
[36m(trainable pid=180598)[0m Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at FacebookAI/roberta-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
[36m(trainable pid=180598)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=180598)[0m 2025-06-17 23:13:27,193 - INFO - pos_weight value in TrainingArguments : 6.828424226204718
[36m(trainable pid=180598)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=180598)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=180853)[0m Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at FacebookAI/roberta-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
[36m(trainable pid=180853)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=180853)[0m 2025-06-17 23:13:33,500 - INFO - pos_weight value in TrainingArguments : 6.094080202241274
[36m(trainable pid=180853)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=180853)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=181094)[0m Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at FacebookAI/roberta-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
[36m(trainable pid=181094)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=181094)[0m 2025-06-17 23:13:39,716 - INFO - pos_weight value in TrainingArguments : 7.183206941666034
[36m(trainable pid=181094)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=181094)[0m   super().__init__(*args, **kwargs)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     trainable_2025-06-17_23-13-19   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-13-19
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-17_23-13-16_896924_178158/artifacts/2025-06-17_23-13-19/trainable_2025-06-17_23-13-19/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-17 23:13:20. Total running time: 0s
Logical resource usage: 0/32 CPUs, 0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_5e7e4460   PENDING         6.82842       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_5e7e4460 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_5e7e4460 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          6.82842 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=180598)[0m [2025-06-17 23:13:27,444] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=180598)[0m [2025-06-17 23:13:30,223] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=180598)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial trainable_a39498c1 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_a39498c1 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          6.09408 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=180853)[0m [2025-06-17 23:13:33,940] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=180853)[0m [2025-06-17 23:13:36,870] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=180853)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=180598)[0m {'loss': 3.1986, 'grad_norm': 11.260302543640137, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}

Trial trainable_a0bff53a started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_a0bff53a config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          7.18321 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=181094)[0m [2025-06-17 23:13:39,970] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=181094)[0m [2025-06-17 23:13:42,518] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=181094)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=181094)[0m {'loss': 1.5865, 'grad_norm': 7.575013160705566, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}

Trial status: 3 RUNNING
Current time: 2025-06-17 23:13:50. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_5e7e4460   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ trainable_a39498c1   RUNNING         6.09408       4.55539e-06         0.123031                    5 â”‚
â”‚ trainable_a0bff53a   RUNNING         7.18321       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=181094)[0m 2025-06-17 23:14:06,044 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=181094)[0m 2025-06-17 23:14:06,050 - INFO - eval_result: {'eval_loss': 1.5558977127075195, 'eval_f1': 0.8387096774193549, 'eval_accuracy': 0.75, 'eval_kappa': 0.28888888888888886, 'eval_precision': 0.8, 'eval_recall': 0.8813559322033898, 'eval_optim_threshold': 0.9754166007041931, 'eval_AP': 0.854702507129916, 'eval_MCC': 0.2956959661294975, 'eval_NDCG': 0.9514906680183555, 'eval_runtime': 3.4633, 'eval_samples_per_second': 23.099, 'eval_steps_per_second': 1.155, 'epoch': 3.0}
2025-06-17 23:14:06,382 - INFO - Cleaning up trial a0bff53a
2025-06-17 23:14:06,383 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-13-19/trainable_a0bff53a_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512_2025-06-17_23-13-32
[36m(trainable pid=181094)[0m 2025-06-17 23:14:06,354 - INFO - Cleared CUDA cache. Memory allocated: 1.54 GB, Memory reserved: 1.71 GB

[36m(trainable pid=181094)[0m {'loss': 0.9106, 'grad_norm': 26.675704956054688, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}[32m [repeated 3x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(trainable pid=181094)[0m {'train_runtime': 19.7342, 'train_samples_per_second': 51.383, 'train_steps_per_second': 2.584, 'train_loss': 1.0076557421216779, 'epoch': 3.0}
[36m(trainable pid=181094)[0m STATE at ending of training  :  TrainerState(epoch=3.0, global_step=51, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=266792214693888.0, log_history=[{'loss': 1.5865, 'grad_norm': 7.575013160705566, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0, 'step': 17}, {'loss': 0.9106, 'grad_norm': 26.675704956054688, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0, 'step': 34}, {'loss': 0.5259, 'grad_norm': 8.715132713317871, 'learning_rate': 0.0, 'epoch': 3.0, 'step': 51}, {'train_runtime': 19.7342, 'train_samples_per_second': 51.383, 'train_steps_per_second': 2.584, 'total_flos': 266792214693888.0, 'train_loss': 1.0076557421216779, 'epoch': 3.0, 'step': 51}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=181094)[0m {'loss': 0.5259, 'grad_norm': 8.715132713317871, 'learning_rate': 0.0, 'epoch': 3.0}
[36m(trainable pid=181094)[0m {'eval_loss': 1.5558977127075195, 'eval_f1': 0.8387096774193549, 'eval_accuracy': 0.75, 'eval_kappa': 0.28888888888888886, 'eval_precision': 0.8, 'eval_recall': 0.8813559322033898, 'eval_optim_threshold': 0.9754166007041931, 'eval_AP': 0.854702507129916, 'eval_MCC': 0.2956959661294975, 'eval_NDCG': 0.9514906680183555, 'eval_runtime': 3.4633, 'eval_samples_per_second': 23.099, 'eval_steps_per_second': 1.155, 'epoch': 3.0}

Trial trainable_a0bff53a finished iteration 1 at 2025-06-17 23:14:06. Total running time: 46s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_a0bff53a result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    27.2539 â”‚
â”‚ time_total_s                        27.2539 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     3 â”‚
â”‚ eval_AP                              0.8547 â”‚
â”‚ eval_MCC                             0.2957 â”‚
â”‚ eval_NDCG                           0.95149 â”‚
â”‚ eval_accuracy                          0.75 â”‚
â”‚ eval_f1                             0.83871 â”‚
â”‚ eval_kappa                          0.28889 â”‚
â”‚ eval_loss                            1.5559 â”‚
â”‚ eval_optim_threshold                0.97542 â”‚
â”‚ eval_precision                          0.8 â”‚
â”‚ eval_recall                         0.88136 â”‚
â”‚ eval_runtime                         3.4633 â”‚
â”‚ eval_samples_per_second              23.099 â”‚
â”‚ eval_steps_per_second                 1.155 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_a0bff53a completed after 1 iterations at 2025-06-17 23:14:06. Total running time: 46s
[36m(trainable pid=180598)[0m {'loss': 2.8615, 'grad_norm': 16.263565063476562, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0}

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 23:14:20. Total running time: 1min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_5e7e4460   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_a39498c1   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_a0bff53a   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.2539        1.5559     0.83871              0.75       0.288889 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=180598)[0m {'loss': 2.7082, 'grad_norm': 22.07688331604004, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0}[32m [repeated 2x across cluster][0m
[36m(trainable pid=180598)[0m {'loss': 2.5889, 'grad_norm': 18.592243194580078, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0}[32m [repeated 2x across cluster][0m
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 23:14:50. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_5e7e4460   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_a39498c1   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_a0bff53a   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.2539        1.5559     0.83871              0.75       0.288889 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=180853)[0m 2025-06-17 23:14:57,826 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=180853)[0m 2025-06-17 23:14:57,831 - INFO - eval_result: {'eval_loss': 1.1659584045410156, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8596982359886169, 'eval_AP': 0.7549137445232208, 'eval_MCC': 0.0, 'eval_NDCG': 0.915709369337543, 'eval_runtime': 3.4233, 'eval_samples_per_second': 23.369, 'eval_steps_per_second': 1.168, 'epoch': 5.0}
[36m(trainable pid=180598)[0m 2025-06-17 23:14:57,951 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=180598)[0m 2025-06-17 23:14:57,956 - INFO - eval_result: {'eval_loss': 3.349520206451416, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.5234192609786987, 'eval_AP': 0.7191751908945979, 'eval_MCC': 0.0, 'eval_NDCG': 0.9086303577332118, 'eval_runtime': 4.3629, 'eval_samples_per_second': 18.337, 'eval_steps_per_second': 0.917, 'epoch': 6.0}
2025-06-17 23:14:58,182 - INFO - Cleaning up trial a39498c1
2025-06-17 23:14:58,182 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-13-19/trainable_a39498c1_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-17_23-13-26
2025-06-17 23:14:58,182 - INFO - Current best: a0bff53a with eval_kappa : 0.28888888888888886 at iteration 1
[36m(trainable pid=180853)[0m 2025-06-17 23:14:58,153 - INFO - Cleared CUDA cache. Memory allocated: 1.54 GB, Memory reserved: 1.71 GB
2025-06-17 23:14:58,290 - INFO - Cleaning up trial 5e7e4460
2025-06-17 23:14:58,291 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-13-19/trainable_5e7e4460_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-17_23-13-20
2025-06-17 23:14:58,291 - INFO - Cleaning up trial a39498c1
2025-06-17 23:14:58,291 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-13-19/trainable_a39498c1_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-17_23-13-26
2025-06-17 23:14:58,291 - INFO - Current best: a0bff53a with eval_kappa : 0.28888888888888886 at iteration 1
2025-06-17 23:14:58,299	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-13-19' in 0.0062s.

[36m(trainable pid=180598)[0m {'train_runtime': 83.0291, 'train_samples_per_second': 24.425, 'train_steps_per_second': 1.228, 'train_loss': 2.8167713763667086, 'epoch': 6.0}
[36m(trainable pid=180598)[0m STATE at ending of training  :  TrainerState(epoch=6.0, global_step=102, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=533584429387776.0, log_history=[{'loss': 3.1986, 'grad_norm': 11.260302543640137, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0, 'step': 17}, {'loss': 3.0339, 'grad_norm': 17.364547729492188, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0, 'step': 34}, {'loss': 2.8615, 'grad_norm': 16.263565063476562, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0, 'step': 51}, {'loss': 2.7082, 'grad_norm': 22.07688331604004, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0, 'step': 68}, {'loss': 2.5889, 'grad_norm': 18.592243194580078, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0, 'step': 85}, {'loss': 2.5095, 'grad_norm': 16.821237564086914, 'learning_rate': 0.0, 'epoch': 6.0, 'step': 102}, {'train_runtime': 83.0291, 'train_samples_per_second': 24.425, 'train_steps_per_second': 1.228, 'total_flos': 533584429387776.0, 'train_loss': 2.8167713763667086, 'epoch': 6.0, 'step': 102}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=180598)[0m {'loss': 2.5095, 'grad_norm': 16.821237564086914, 'learning_rate': 0.0, 'epoch': 6.0}[32m [repeated 2x across cluster][0m
[36m(trainable pid=180853)[0m STATE at ending of training  :  TrainerState(epoch=5.0, global_step=85, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=444653691156480.0, log_history=[{'loss': 2.1118, 'grad_norm': 6.800278186798096, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0, 'step': 17}, {'loss': 1.7021, 'grad_norm': 9.804062843322754, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0, 'step': 34}, {'loss': 1.3753, 'grad_norm': 6.805392742156982, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0, 'step': 51}, {'loss': 1.3096, 'grad_norm': 6.784692287445068, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0, 'step': 68}, {'loss': 1.305, 'grad_norm': 5.725795269012451, 'learning_rate': 0.0, 'epoch': 5.0, 'step': 85}, {'train_runtime': 77.058, 'train_samples_per_second': 21.932, 'train_steps_per_second': 1.103, 'total_flos': 444653691156480.0, 'train_loss': 1.5607501983642578, 'epoch': 5.0, 'step': 85}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=180853)[0m {'eval_loss': 1.1659584045410156, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8596982359886169, 'eval_AP': 0.7549137445232208, 'eval_MCC': 0.0, 'eval_NDCG': 0.915709369337543, 'eval_runtime': 3.4233, 'eval_samples_per_second': 23.369, 'eval_steps_per_second': 1.168, 'epoch': 5.0}

Trial trainable_a39498c1 finished iteration 1 at 2025-06-17 23:14:58. Total running time: 1min 38s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_a39498c1 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    85.3521 â”‚
â”‚ time_total_s                        85.3521 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     5 â”‚
â”‚ eval_AP                             0.75491 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.91571 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.16596 â”‚
â”‚ eval_optim_threshold                 0.8597 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.4233 â”‚
â”‚ eval_samples_per_second              23.369 â”‚
â”‚ eval_steps_per_second                 1.168 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_a39498c1 completed after 1 iterations at 2025-06-17 23:14:58. Total running time: 1min 38s

Trial trainable_5e7e4460 finished iteration 1 at 2025-06-17 23:14:58. Total running time: 1min 38s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_5e7e4460 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    91.7246 â”‚
â”‚ time_total_s                        91.7246 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     6 â”‚
â”‚ eval_AP                             0.71918 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.90863 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           3.34952 â”‚
â”‚ eval_optim_threshold                0.52342 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         4.3629 â”‚
â”‚ eval_samples_per_second              18.337 â”‚
â”‚ eval_steps_per_second                 0.917 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_5e7e4460 completed after 1 iterations at 2025-06-17 23:14:58. Total running time: 1min 38s

Trial status: 3 TERMINATED
Current time: 2025-06-17 23:14:58. Total running time: 1min 38s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_5e7e4460   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1            91.7246       3.34952    0.848921            0.7375       0        â”‚
â”‚ trainable_a39498c1   TERMINATED        6.09408       4.55539e-06         0.123031                    5        1            85.3521       1.16596    0.848921            0.7375       0        â”‚
â”‚ trainable_a0bff53a   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.2539       1.5559     0.83871             0.75         0.288889 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯2025-06-17 23:14:58,305 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x79f5452a1e10>
2025-06-17 23:14:58,305 - INFO - Best trial : trainable_a0bff53a
2025-06-17 23:14:58,305 - INFO - Best config : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-17 23:14:58,305 - INFO - Best trial after optimization: {'eval_loss': 1.5558977127075195, 'eval_f1': 0.8387096774193549, 'eval_accuracy': 0.75, 'eval_kappa': 0.28888888888888886, 'eval_precision': 0.8, 'eval_recall': 0.8813559322033898, 'eval_optim_threshold': 0.9754166007041931, 'eval_AP': 0.854702507129916, 'eval_MCC': 0.2956959661294975, 'eval_NDCG': 0.9514906680183555, 'eval_runtime': 3.4633, 'eval_samples_per_second': 23.099, 'eval_steps_per_second': 1.155, 'epoch': 3.0, 'timestamp': 1750194846, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': 'a0bff53a', 'date': '2025-06-17_23-14-06', 'time_this_iter_s': 27.253896951675415, 'time_total_s': 27.253896951675415, 'pid': 181094, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 27.253896951675415, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512'}
2025-06-17 23:14:58,329 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   3.349520  0.848921  ...                        6  5e7e4460
1   1.165958  0.848921  ...                        5  a39498c1
2   1.555898  0.838710  ...                        3  a0bff53a

[3 rows x 32 columns]
2025-06-17 23:14:58,530 - INFO - Trial comparison plot saved
2025-06-17 23:14:58,541 - INFO - Best Hyperparameters after HPO : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}


[36m(trainable pid=180598)[0m 2025-06-17 23:14:58,264 - INFO - Cleared CUDA cache. Memory allocated: 1.54 GB, Memory reserved: 1.71 GB
[36m(trainable pid=180853)[0m {'train_runtime': 77.058, 'train_samples_per_second': 21.932, 'train_steps_per_second': 1.103, 'train_loss': 1.5607501983642578, 'epoch': 5.0}
[36m(trainable pid=180853)[0m {'loss': 1.305, 'grad_norm': 5.725795269012451, 'learning_rate': 0.0, 'epoch': 5.0}
[36m(trainable pid=180598)[0m {'eval_loss': 3.349520206451416, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.5234192609786987, 'eval_AP': 0.7191751908945979, 'eval_MCC': 0.0, 'eval_NDCG': 0.9086303577332118, 'eval_runtime': 4.3629, 'eval_samples_per_second': 18.337, 'eval_steps_per_second': 0.917, 'epoch': 6.0}
2025-06-17 23:15:07,341 - INFO - Namespace(config='configs/train.yaml', hp_config='configs/best_hpo.yaml', fold=2, run=0, gpu='2', model_name='FacebookAI/roberta-base', nb_opt_negs=100, loss='BCE', with_title=True, with_keywords=False, best_metric=None)
2025-06-17 23:15:07,343 - INFO - {'model_name': 'bert-base-uncased', 'fold': 0, 'run': 0, 'output_dir': 'outputs/checkpoints', 'best_metric': 'eval_kappa', 'loss_type': 'BCE', 'nb_optional_negs': 100, 'with_title': True, 'with_keywords': False, 'default_hyperparameters': {'learning_rate': 'None', 'num_train_epochs': 'None', 'pos_weight': 'None', 'weight_decay': 'None'}}
2025-06-17 23:15:08,190 - INFO - train split size : 338
2025-06-17 23:15:08,190 - INFO - dev split size : 80
2025-06-17 23:15:08,190 - INFO - test split size : 79
2025-06-17 23:15:08,478 - INFO - 3 datasets tokenized successfully
2025-06-17 23:15:08,478 - INFO - Final training...
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at FacebookAI/roberta-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-17 23:15:08,796 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
[2025-06-17 23:15:09,035] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-06-17 23:15:11,719] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
2025-06-17 23:15:11,757 - INFO - training size : 338
2025-06-17 23:15:11,757 - INFO - dev size : 80
2025-06-17 23:15:11,757 - INFO - test size : 79
  0%|          | 0/12 [00:00<?, ?it/s]  8%|â–Š         | 1/12 [00:02<00:25,  2.33s/it] 17%|â–ˆâ–‹        | 2/12 [00:04<00:20,  2.02s/it] 25%|â–ˆâ–ˆâ–Œ       | 3/12 [00:05<00:17,  1.90s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [00:06<00:11,  1.42s/it]                                               33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [00:06<00:11,  1.42s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 5/12 [00:08<00:11,  1.58s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 6/12 [00:10<00:09,  1.65s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 7/12 [00:12<00:08,  1.69s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [00:12<00:05,  1.37s/it]                                               67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [00:12<00:05,  1.37s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 9/12 [00:14<00:04,  1.53s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 10/12 [00:16<00:03,  1.61s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 11/12 [00:18<00:01,  1.66s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:18<00:00,  1.36s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:21<00:00,  1.36s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:21<00:00,  1.36s/it]2025-06-17 23:15:33,729 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:21<00:00,  1.81s/it]
{'loss': 2.1629, 'grad_norm': 5.9621124267578125, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
{'loss': 1.5175, 'grad_norm': 4.760583400726318, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
{'loss': 1.4154, 'grad_norm': 4.6982221603393555, 'learning_rate': 0.0, 'epoch': 3.0}
{'train_runtime': 21.6975, 'train_samples_per_second': 46.733, 'train_steps_per_second': 0.553, 'train_loss': 1.698588252067566, 'epoch': 3.0}
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 23:15:37,074 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.85s/it]
2025-06-17 23:15:37,087 - INFO - Training time : 28.608641267055646
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 23:15:40,541 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.95s/it]
2025-06-17 23:15:40,546 - INFO - Evaluation time : 3.458867390989326
2025-06-17 23:15:40,546 - INFO - Evaluation results on test set: {'eval_loss': 1.1353447437286377, 'eval_f1': 0.855072463768116, 'eval_accuracy': 0.7468354430379747, 'eval_kappa': 0.0, 'eval_precision': 0.7468354430379747, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9246711134910583, 'eval_AP': 0.7956859363771697, 'eval_MCC': 0.0, 'eval_NDCG': 0.945436170393381, 'eval_runtime': 3.4437, 'eval_samples_per_second': 22.94, 'eval_steps_per_second': 0.29, 'epoch': 3.0}
2025-06-17 23:15:40,546 - INFO - Total updates (optimizer steps): 12
2025-06-17 23:15:40,546 - INFO - Avg time / step: 1.808s
2025-06-17 23:15:41,738 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCE_roberta-base_fold-3
2025-06-17 23:15:41,738 - INFO - On test Set (with threshold 0.5) : 
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 23:15:44,979 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.74s/it]
2025-06-17 23:15:44,982 - INFO - Raw predictions shape: (79, 1)
2025-06-17 23:15:44,982 - INFO - Raw predictions: [[1.9577402]
 [2.2453969]
 [1.86996  ]
 [2.0976982]
 [2.1513588]
 [2.309861 ]
 [2.2550027]
 [2.09131  ]
 [2.1908565]
 [2.302947 ]]
2025-06-17 23:15:44,982 - INFO - Scores shape: (79,)
2025-06-17 23:15:44,983 - INFO - Scores: [0.87628824 0.90425277 0.86645365 0.8906793  0.8957957  0.9096904
 0.90508115 0.89005566 0.8994254  0.90912086]
2025-06-17 23:15:44,983 - INFO - Preds shape: (79,)
2025-06-17 23:15:44,983 - INFO - Preds: [1 1 1 1 1 1 1 1 1 1]
2025-06-17 23:15:44,983 - INFO - Test labels shape: (79,)
2025-06-17 23:15:44,983 - INFO - Test labels: [0, 1, 1, 1, 1, 1, 0, 1, 1, 0]
2025-06-17 23:15:44,983 - INFO - Test split: Dataset({
    features: ['Unnamed: 0', 'title', 'abstract', 'Keywords', 'doi', 'labels'],
    num_rows: 79
})
2025-06-17 23:15:44,983 - INFO - Unique values in predictions: [1]
2025-06-17 23:15:44,983 - INFO - Unique values in labels: [0 1]
2025-06-17 23:15:44,984 - INFO - Confusion matrix:
[[ 0 20]
 [ 0 59]]
2025-06-17 23:15:44,985 - INFO - Confusion matrix: TN=0, FP=20, FN=0, TP=59
2025-06-17 23:15:47,699 - INFO - Metrics: {'f1': 0.855072463768116, 'recall': 1.0, 'precision': 0.7468354430379747, 'accuracy': 0.7468354430379747, 'AP': 0.7956859363771697, 'MCC': 0.0, 'NDCG': 0.945436170393381, 'kappa': 0.0, 'TN': 0, 'FP': 20, 'FN': 0, 'TP': 59}
2025-06-17 23:15:47,810 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-17 23:15:47,902 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 23:15:47,902 - INFO - 
On test Set (optimal threshold of 0.8671544790267944 according to cross validation on the training set): 
2025-06-17 23:15:47,903 - INFO - Confusion matrix: TN=1, FP=19, FN=4, TP=55
2025-06-17 23:15:50,629 - INFO - Metrics: {'f1': 0.8270676691729323, 'recall': 0.9322033898305084, 'precision': 0.7432432432432432, 'accuracy': 0.7088607594936709, 'AP': 0.7956859363771697, 'MCC': -0.03178172233351513, 'NDCG': 0.945436170393381, 'kappa': -0.02366197183098584, 'TN': 1, 'FP': 19, 'FN': 4, 'TP': 55}
2025-06-17 23:15:50,722 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 23:15:50,722 - INFO - Results for fold 3 : [{'f1': 0.8270676691729323, 'recall': 0.9322033898305084, 'precision': 0.7432432432432432, 'accuracy': 0.7088607594936709, 'AP': 0.7956859363771697, 'MCC': -0.03178172233351513, 'NDCG': 0.945436170393381, 'kappa': -0.02366197183098584, 'TN': 1, 'FP': 19, 'FN': 4, 'TP': 55}]
2025-06-17 23:15:51,049 - INFO - Cleared CUDA cache. Memory allocated: 1.52 GB, Memory reserved: 1.85 GB
2025-06-17 23:15:51,055 - INFO - Metrics stored successfully at /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/metrics/binary_metrics.csv
Model: dmis-lab/biobert-v1.1
2025-06-17 23:15:58,173 - INFO - Namespace(config='configs/hpo.yaml', fold=2, run=0, gpu=None, model_name='dmis-lab/biobert-v1.1', nb_opt_negs=100, n_trials=3, hpo_metric=None, direction=None, loss='BCE', with_title=True, with_keywords=False)
2025-06-17 23:15:58,174 - INFO - {'model_name': 'google-bert/bert-base-uncased', 'num_trials': 20, 'fold': 0, 'hpo_metric': 'eval_kappa', 'direction': 'max', 'loss_type': 'BCE', 'with_title': True, 'with_keywords': False, 'nb_optional_negs': 100}
2025-06-17 23:15:58,569 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
2025-06-17 23:15:58,569 - INFO - 
fold number 3 | run no. 1
2025-06-17 23:15:59,175 - INFO - train split size : 338
2025-06-17 23:15:59,175 - INFO - dev split size : 80
2025-06-17 23:15:59,175 - INFO - test split size : 79
2025-06-17 23:15:59,411 - INFO - 3 datasets tokenized successfully
2025-06-17 23:15:59,472 - INFO - Fold 3 max seq len = 512
2025-06-17 23:15:59,473 - INFO - Starting hyperparameter search for BCE loss
2025-06-17 23:16:00,854	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
2025-06-17 23:16:01,537	INFO tune.py:253 -- Initializing Ray automatically. For cluster usage or custom Ray initialization, call `ray.init(...)` before `tune.run(...)`.
[36m(trainable pid=185561)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=185561)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=185561)[0m 2025-06-17 23:16:10,132 - INFO - pos_weight value in TrainingArguments : 6.828424226204718
[36m(trainable pid=185561)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=185561)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=185759)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=185759)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=185759)[0m 2025-06-17 23:16:16,625 - INFO - pos_weight value in TrainingArguments : 6.094080202241274
[36m(trainable pid=185759)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=185759)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=186059)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=186059)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=186059)[0m 2025-06-17 23:16:22,842 - INFO - pos_weight value in TrainingArguments : 7.183206941666034
[36m(trainable pid=186059)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=186059)[0m   super().__init__(*args, **kwargs)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     trainable_2025-06-17_23-16-01   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-16-01
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-17_23-15-59_493582_183121/artifacts/2025-06-17_23-16-01/trainable_2025-06-17_23-16-01/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-17 23:16:02. Total running time: 0s
Logical resource usage: 0/32 CPUs, 0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_0302085a   PENDING         6.82842       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_0302085a started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_0302085a config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          6.82842 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=185561)[0m [2025-06-17 23:16:10,391] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=185561)[0m [2025-06-17 23:16:13,152] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=185561)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial trainable_8db6caaa started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_8db6caaa config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          6.09408 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=185759)[0m [2025-06-17 23:16:17,035] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=185759)[0m [2025-06-17 23:16:19,922] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=185759)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=185561)[0m {'loss': 2.9963, 'grad_norm': 25.020631790161133, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}

Trial trainable_6cf153fc started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_6cf153fc config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          7.18321 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=186059)[0m [2025-06-17 23:16:23,071] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=186059)[0m [2025-06-17 23:16:25,673] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=186059)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 3 RUNNING
Current time: 2025-06-17 23:16:32. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_0302085a   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ trainable_8db6caaa   RUNNING         6.09408       4.55539e-06         0.123031                    5 â”‚
â”‚ trainable_6cf153fc   RUNNING         7.18321       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=186059)[0m 2025-06-17 23:16:49,760 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=186059)[0m 2025-06-17 23:16:49,766 - INFO - eval_result: {'eval_loss': 1.0180482864379883, 'eval_f1': 0.8405797101449275, 'eval_accuracy': 0.725, 'eval_kappa': -0.024447031431897415, 'eval_precision': 0.7341772151898734, 'eval_recall': 0.9830508474576272, 'eval_optim_threshold': 0.9706113934516907, 'eval_AP': 0.8926121256187608, 'eval_MCC': -0.06712280483550427, 'eval_NDCG': 0.9735615183539498, 'eval_runtime': 3.8119, 'eval_samples_per_second': 20.987, 'eval_steps_per_second': 1.049, 'epoch': 3.0}
2025-06-17 23:16:50,231 - INFO - Cleaning up trial 6cf153fc
2025-06-17 23:16:50,231 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-16-01/trainable_6cf153fc_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512_2025-06-17_23-16-15
[36m(trainable pid=186059)[0m 2025-06-17 23:16:50,206 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB

[36m(trainable pid=186059)[0m {'loss': 1.6329, 'grad_norm': 6.935921669006348, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
[36m(trainable pid=186059)[0m {'loss': 1.0052, 'grad_norm': 71.45293426513672, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}[32m [repeated 3x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(trainable pid=186059)[0m {'train_runtime': 19.9384, 'train_samples_per_second': 50.857, 'train_steps_per_second': 2.558, 'train_loss': 1.2464192334343405, 'epoch': 3.0}
[36m(trainable pid=186059)[0m STATE at ending of training  :  TrainerState(epoch=3.0, global_step=51, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=266792214693888.0, log_history=[{'loss': 1.6329, 'grad_norm': 6.935921669006348, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0, 'step': 17}, {'loss': 1.0052, 'grad_norm': 71.45293426513672, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0, 'step': 34}, {'loss': 1.1012, 'grad_norm': 3.51861572265625, 'learning_rate': 0.0, 'epoch': 3.0, 'step': 51}, {'train_runtime': 19.9384, 'train_samples_per_second': 50.857, 'train_steps_per_second': 2.558, 'total_flos': 266792214693888.0, 'train_loss': 1.2464192334343405, 'epoch': 3.0, 'step': 51}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=186059)[0m {'loss': 1.1012, 'grad_norm': 3.51861572265625, 'learning_rate': 0.0, 'epoch': 3.0}
[36m(trainable pid=186059)[0m {'eval_loss': 1.0180482864379883, 'eval_f1': 0.8405797101449275, 'eval_accuracy': 0.725, 'eval_kappa': -0.024447031431897415, 'eval_precision': 0.7341772151898734, 'eval_recall': 0.9830508474576272, 'eval_optim_threshold': 0.9706113934516907, 'eval_AP': 0.8926121256187608, 'eval_MCC': -0.06712280483550427, 'eval_NDCG': 0.9735615183539498, 'eval_runtime': 3.8119, 'eval_samples_per_second': 20.987, 'eval_steps_per_second': 1.049, 'epoch': 3.0}

Trial trainable_6cf153fc finished iteration 1 at 2025-06-17 23:16:50. Total running time: 47s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_6cf153fc result              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                          â”‚
â”‚ time_this_iter_s                     28.5342 â”‚
â”‚ time_total_s                         28.5342 â”‚
â”‚ training_iteration                         1 â”‚
â”‚ epoch                                      3 â”‚
â”‚ eval_AP                              0.89261 â”‚
â”‚ eval_MCC                            -0.06712 â”‚
â”‚ eval_NDCG                            0.97356 â”‚
â”‚ eval_accuracy                          0.725 â”‚
â”‚ eval_f1                              0.84058 â”‚
â”‚ eval_kappa                          -0.02445 â”‚
â”‚ eval_loss                            1.01805 â”‚
â”‚ eval_optim_threshold                 0.97061 â”‚
â”‚ eval_precision                       0.73418 â”‚
â”‚ eval_recall                          0.98305 â”‚
â”‚ eval_runtime                          3.8119 â”‚
â”‚ eval_samples_per_second               20.987 â”‚
â”‚ eval_steps_per_second                  1.049 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_6cf153fc completed after 1 iterations at 2025-06-17 23:16:50. Total running time: 47s
[36m(trainable pid=185561)[0m {'loss': 2.1061, 'grad_norm': 14.714469909667969, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0}

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 23:17:03. Total running time: 1min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_0302085a   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_8db6caaa   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_6cf153fc   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            28.5342       1.01805     0.84058             0.725      -0.024447 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=185561)[0m {'loss': 1.8126, 'grad_norm': 14.749361038208008, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0}[32m [repeated 2x across cluster][0m
[36m(trainable pid=185561)[0m {'loss': 1.7312, 'grad_norm': 13.343856811523438, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0}[32m [repeated 2x across cluster][0m
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 23:17:33. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_0302085a   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_8db6caaa   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_6cf153fc   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            28.5342       1.01805     0.84058             0.725      -0.024447 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=185561)[0m 2025-06-17 23:17:40,130 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=185561)[0m 2025-06-17 23:17:40,135 - INFO - eval_result: {'eval_loss': 1.952646255493164, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.7160475254058838, 'eval_AP': 0.804591405223843, 'eval_MCC': 0.0, 'eval_NDCG': 0.9484275953221637, 'eval_runtime': 3.9386, 'eval_samples_per_second': 20.312, 'eval_steps_per_second': 1.016, 'epoch': 6.0}
[36m(trainable pid=185561)[0m 2025-06-17 23:17:40,458 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(trainable pid=185759)[0m 2025-06-17 23:17:40,438 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=185759)[0m 2025-06-17 23:17:40,443 - INFO - eval_result: {'eval_loss': 1.2743111848831177, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8032318353652954, 'eval_AP': 0.7935665253474437, 'eval_MCC': 0.0, 'eval_NDCG': 0.944572034214126, 'eval_runtime': 3.5467, 'eval_samples_per_second': 22.556, 'eval_steps_per_second': 1.128, 'epoch': 5.0}
2025-06-17 23:17:40,481 - INFO - Cleaning up trial 0302085a
2025-06-17 23:17:40,481 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-16-01/trainable_0302085a_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-17_23-16-02
2025-06-17 23:17:40,481 - INFO - Cleaning up trial 6cf153fc
2025-06-17 23:17:40,481 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-16-01/trainable_6cf153fc_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512_2025-06-17_23-16-15
2025-06-17 23:17:40,779 - INFO - Cleaning up trial 8db6caaa
2025-06-17 23:17:40,779 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-16-01/trainable_8db6caaa_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-17_23-16-09
2025-06-17 23:17:40,779 - INFO - Current best: 0302085a with eval_kappa : 0.0 at iteration 1
2025-06-17 23:17:40,779 - INFO - Cleaning up trial 6cf153fc
2025-06-17 23:17:40,779 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-16-01/trainable_6cf153fc_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512_2025-06-17_23-16-15
2025-06-17 23:17:40,787	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-16-01' in 0.0065s.

[36m(trainable pid=185561)[0m {'train_runtime': 82.7009, 'train_samples_per_second': 24.522, 'train_steps_per_second': 1.233, 'train_loss': 2.143072520985323, 'epoch': 6.0}
[36m(trainable pid=185561)[0m STATE at ending of training  :  TrainerState(epoch=6.0, global_step=102, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=533584429387776.0, log_history=[{'loss': 2.9963, 'grad_norm': 25.020631790161133, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0, 'step': 17}, {'loss': 2.5142, 'grad_norm': 25.43015480041504, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0, 'step': 34}, {'loss': 2.1061, 'grad_norm': 14.714469909667969, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0, 'step': 51}, {'loss': 1.8126, 'grad_norm': 14.749361038208008, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0, 'step': 68}, {'loss': 1.7312, 'grad_norm': 13.343856811523438, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0, 'step': 85}, {'loss': 1.6981, 'grad_norm': 15.364178657531738, 'learning_rate': 0.0, 'epoch': 6.0, 'step': 102}, {'train_runtime': 82.7009, 'train_samples_per_second': 24.522, 'train_steps_per_second': 1.233, 'total_flos': 533584429387776.0, 'train_loss': 2.143072520985323, 'epoch': 6.0, 'step': 102}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=185561)[0m {'loss': 1.6981, 'grad_norm': 15.364178657531738, 'learning_rate': 0.0, 'epoch': 6.0}[32m [repeated 2x across cluster][0m
[36m(trainable pid=185759)[0m STATE at ending of training  :  TrainerState(epoch=5.0, global_step=85, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=444653691156480.0, log_history=[{'loss': 1.927, 'grad_norm': 6.705651760101318, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0, 'step': 17}, {'loss': 1.4973, 'grad_norm': 8.659859657287598, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0, 'step': 34}, {'loss': 1.3649, 'grad_norm': 5.016050338745117, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0, 'step': 51}, {'loss': 1.2902, 'grad_norm': 8.148581504821777, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0, 'step': 68}, {'loss': 1.2553, 'grad_norm': 6.849358081817627, 'learning_rate': 0.0, 'epoch': 5.0, 'step': 85}, {'train_runtime': 76.505, 'train_samples_per_second': 22.09, 'train_steps_per_second': 1.111, 'total_flos': 444653691156480.0, 'train_loss': 1.466931286980124, 'epoch': 5.0, 'step': 85}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=185561)[0m {'eval_loss': 1.952646255493164, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.7160475254058838, 'eval_AP': 0.804591405223843, 'eval_MCC': 0.0, 'eval_NDCG': 0.9484275953221637, 'eval_runtime': 3.9386, 'eval_samples_per_second': 20.312, 'eval_steps_per_second': 1.016, 'epoch': 6.0}

Trial trainable_0302085a finished iteration 1 at 2025-06-17 23:17:40. Total running time: 1min 37s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_0302085a result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                      91.29 â”‚
â”‚ time_total_s                          91.29 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     6 â”‚
â”‚ eval_AP                             0.80459 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.94843 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.95265 â”‚
â”‚ eval_optim_threshold                0.71605 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.9386 â”‚
â”‚ eval_samples_per_second              20.312 â”‚
â”‚ eval_steps_per_second                 1.016 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_0302085a completed after 1 iterations at 2025-06-17 23:17:40. Total running time: 1min 37s

Trial trainable_8db6caaa finished iteration 1 at 2025-06-17 23:17:40. Total running time: 1min 38s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_8db6caaa result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    85.2434 â”‚
â”‚ time_total_s                        85.2434 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     5 â”‚
â”‚ eval_AP                             0.79357 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.94457 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.27431 â”‚
â”‚ eval_optim_threshold                0.80323 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.5467 â”‚
â”‚ eval_samples_per_second              22.556 â”‚
â”‚ eval_steps_per_second                 1.128 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_8db6caaa completed after 1 iterations at 2025-06-17 23:17:40. Total running time: 1min 38s

Trial status: 3 TERMINATED
Current time: 2025-06-17 23:17:40. Total running time: 1min 38s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_0302085a   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1            91.29         1.95265    0.848921            0.7375       0        â”‚
â”‚ trainable_8db6caaa   TERMINATED        6.09408       4.55539e-06         0.123031                    5        1            85.2434       1.27431    0.848921            0.7375       0        â”‚
â”‚ trainable_6cf153fc   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            28.5342       1.01805    0.84058             0.725       -0.024447 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯2025-06-17 23:17:40,795 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x7d2c94676c10>
2025-06-17 23:17:40,795 - INFO - Best trial : trainable_0302085a
2025-06-17 23:17:40,795 - INFO - Best config : {'pos_weight': 6.828424226204718, 'learning_rate': 1.4956066518424355e-06, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 6}
2025-06-17 23:17:40,795 - INFO - Best trial after optimization: {'eval_loss': 1.952646255493164, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.7160475254058838, 'eval_AP': 0.804591405223843, 'eval_MCC': 0.0, 'eval_NDCG': 0.9484275953221637, 'eval_runtime': 3.9386, 'eval_samples_per_second': 20.312, 'eval_steps_per_second': 1.016, 'epoch': 6.0, 'timestamp': 1750195060, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '0302085a', 'date': '2025-06-17_23-17-40', 'time_this_iter_s': 91.28995776176453, 'time_total_s': 91.28995776176453, 'pid': 185561, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 6.828424226204718, 'learning_rate': 1.4956066518424355e-06, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 6}, 'time_since_restore': 91.28995776176453, 'iterations_since_restore': 1, 'experiment_tag': '1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364'}
2025-06-17 23:17:40,818 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   1.952646  0.848921  ...                        6  0302085a
1   1.274311  0.848921  ...                        5  8db6caaa
2   1.018048  0.840580  ...                        3  6cf153fc

[3 rows x 32 columns]
2025-06-17 23:17:41,002 - INFO - Trial comparison plot saved
2025-06-17 23:17:41,012 - INFO - Best Hyperparameters after HPO : {'pos_weight': 6.828424226204718, 'learning_rate': 1.4956066518424355e-06, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 6}


[36m(trainable pid=185759)[0m 2025-06-17 23:17:40,755 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(trainable pid=185759)[0m {'train_runtime': 76.505, 'train_samples_per_second': 22.09, 'train_steps_per_second': 1.111, 'train_loss': 1.466931286980124, 'epoch': 5.0}
[36m(trainable pid=185759)[0m {'loss': 1.2553, 'grad_norm': 6.849358081817627, 'learning_rate': 0.0, 'epoch': 5.0}
[36m(trainable pid=185759)[0m {'eval_loss': 1.2743111848831177, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8032318353652954, 'eval_AP': 0.7935665253474437, 'eval_MCC': 0.0, 'eval_NDCG': 0.944572034214126, 'eval_runtime': 3.5467, 'eval_samples_per_second': 22.556, 'eval_steps_per_second': 1.128, 'epoch': 5.0}
2025-06-17 23:17:49,564 - INFO - Namespace(config='configs/train.yaml', hp_config='configs/best_hpo.yaml', fold=2, run=0, gpu='2', model_name='dmis-lab/biobert-v1.1', nb_opt_negs=100, loss='BCE', with_title=True, with_keywords=False, best_metric=None)
2025-06-17 23:17:49,566 - INFO - {'model_name': 'bert-base-uncased', 'fold': 0, 'run': 0, 'output_dir': 'outputs/checkpoints', 'best_metric': 'eval_kappa', 'loss_type': 'BCE', 'nb_optional_negs': 100, 'with_title': True, 'with_keywords': False, 'default_hyperparameters': {'learning_rate': 'None', 'num_train_epochs': 'None', 'pos_weight': 'None', 'weight_decay': 'None'}}
2025-06-17 23:17:50,357 - INFO - train split size : 338
2025-06-17 23:17:50,357 - INFO - dev split size : 80
2025-06-17 23:17:50,357 - INFO - test split size : 79
2025-06-17 23:17:50,596 - INFO - 3 datasets tokenized successfully
2025-06-17 23:17:50,596 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-17 23:17:51,349 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
[2025-06-17 23:17:51,573] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-06-17 23:17:54,239] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
2025-06-17 23:17:54,276 - INFO - training size : 338
2025-06-17 23:17:54,276 - INFO - dev size : 80
2025-06-17 23:17:54,276 - INFO - test size : 79
  0%|          | 0/24 [00:00<?, ?it/s]  4%|â–         | 1/24 [00:02<00:53,  2.32s/it]  8%|â–Š         | 2/24 [00:04<00:44,  2.04s/it] 12%|â–ˆâ–Ž        | 3/24 [00:05<00:40,  1.92s/it] 17%|â–ˆâ–‹        | 4/24 [00:06<00:28,  1.43s/it]                                               17%|â–ˆâ–‹        | 4/24 [00:06<00:28,  1.43s/it] 21%|â–ˆâ–ˆ        | 5/24 [00:08<00:30,  1.59s/it] 25%|â–ˆâ–ˆâ–Œ       | 6/24 [00:10<00:30,  1.67s/it] 29%|â–ˆâ–ˆâ–‰       | 7/24 [00:12<00:29,  1.71s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 8/24 [00:12<00:22,  1.38s/it]                                               33%|â–ˆâ–ˆâ–ˆâ–Ž      | 8/24 [00:12<00:22,  1.38s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 9/24 [00:14<00:23,  1.54s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 10/24 [00:16<00:22,  1.63s/it] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 11/24 [00:18<00:21,  1.68s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 12/24 [00:18<00:16,  1.37s/it]                                                50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 12/24 [00:18<00:16,  1.37s/it] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 13/24 [00:20<00:16,  1.53s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 14/24 [00:22<00:16,  1.62s/it] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 15/24 [00:24<00:15,  1.67s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 16/24 [00:25<00:10,  1.37s/it]                                                67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 16/24 [00:25<00:10,  1.37s/it] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 17/24 [00:27<00:10,  1.54s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 18/24 [00:28<00:09,  1.63s/it] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 19/24 [00:30<00:08,  1.68s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 20/24 [00:31<00:05,  1.38s/it]                                                83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 20/24 [00:31<00:05,  1.38s/it] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 21/24 [00:33<00:04,  1.55s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 22/24 [00:35<00:03,  1.64s/it] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 23/24 [00:36<00:01,  1.68s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 24/24 [00:37<00:00,  1.38s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 24/24 [00:40<00:00,  1.38s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 24/24 [00:40<00:00,  1.38s/it]2025-06-17 23:18:34,734 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 24/24 [00:40<00:00,  1.67s/it]
{'loss': 3.3435, 'grad_norm': 33.59150695800781, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}
{'loss': 3.2845, 'grad_norm': 35.30921936035156, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0}
{'loss': 3.1123, 'grad_norm': 26.53205680847168, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0}
{'loss': 3.2127, 'grad_norm': 43.18426513671875, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0}
{'loss': 3.0691, 'grad_norm': 32.49988555908203, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0}
{'loss': 2.9102, 'grad_norm': 18.85243034362793, 'learning_rate': 0.0, 'epoch': 6.0}
{'train_runtime': 40.1809, 'train_samples_per_second': 50.472, 'train_steps_per_second': 0.597, 'train_loss': 3.1553824742635093, 'epoch': 6.0}
  0%|          | 0/1 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-06-17 23:18:38,129 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.87s/it]
2025-06-17 23:18:38,135 - INFO - Training time : 47.53856296592858
  0%|          | 0/1 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-06-17 23:18:41,488 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.83s/it]
2025-06-17 23:18:41,492 - INFO - Evaluation time : 3.357307558064349
2025-06-17 23:18:41,492 - INFO - Evaluation results on test set: {'eval_loss': 4.113027095794678, 'eval_f1': 0.0, 'eval_accuracy': 0.25316455696202533, 'eval_kappa': 0.0, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_optim_threshold': 0.45249059796333313, 'eval_AP': 0.767312874247801, 'eval_MCC': 0.0, 'eval_NDCG': 0.9276436874230435, 'eval_runtime': 3.3455, 'eval_samples_per_second': 23.614, 'eval_steps_per_second': 0.299, 'epoch': 6.0}
2025-06-17 23:18:41,492 - INFO - Total updates (optimizer steps): 24
2025-06-17 23:18:41,492 - INFO - Avg time / step: 1.675s
2025-06-17 23:18:42,177 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCE_biobert-v1_fold-3
2025-06-17 23:18:42,177 - INFO - On test Set (with threshold 0.5) : 
  0%|          | 0/1 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-06-17 23:18:45,441 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.75s/it]
2025-06-17 23:18:45,444 - INFO - Raw predictions shape: (79, 1)
2025-06-17 23:18:45,445 - INFO - Raw predictions: [[-0.13237882]
 [-0.15679376]
 [-0.1502437 ]
 [-0.16015358]
 [-0.15440312]
 [-0.1626532 ]
 [-0.20145288]
 [-0.17228906]
 [-0.15624934]
 [-0.18011715]]
2025-06-17 23:18:45,445 - INFO - Scores shape: (79,)
2025-06-17 23:18:45,445 - INFO - Scores: [0.46695358 0.46088168 0.46250957 0.46004692 0.46147573 0.4594261
 0.44980642 0.45703396 0.4610169  0.45509204]
2025-06-17 23:18:45,445 - INFO - Preds shape: (79,)
2025-06-17 23:18:45,445 - INFO - Preds: [0 0 0 0 0 0 0 0 0 0]
2025-06-17 23:18:45,445 - INFO - Test labels shape: (79,)
2025-06-17 23:18:45,445 - INFO - Test labels: [0, 1, 1, 1, 1, 1, 0, 1, 1, 0]
2025-06-17 23:18:45,445 - INFO - Test split: Dataset({
    features: ['Unnamed: 0', 'title', 'abstract', 'Keywords', 'doi', 'labels'],
    num_rows: 79
})
2025-06-17 23:18:45,445 - INFO - Unique values in predictions: [0]
2025-06-17 23:18:45,446 - INFO - Unique values in labels: [0 1]
2025-06-17 23:18:45,447 - INFO - Confusion matrix:
[[20  0]
 [59  0]]
2025-06-17 23:18:45,447 - INFO - Confusion matrix: TN=20, FP=0, FN=59, TP=0
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-06-17 23:18:48,144 - INFO - Metrics: {'f1': 0.0, 'recall': 0.0, 'precision': 0.0, 'accuracy': 0.25316455696202533, 'AP': 0.767312874247801, 'MCC': 0.0, 'NDCG': 0.9276436874230435, 'kappa': 0.0, 'TN': 20, 'FP': 0, 'FN': 59, 'TP': 0}
2025-06-17 23:18:48,252 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-17 23:18:48,345 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 23:18:48,345 - INFO - 
On test Set (optimal threshold of 0.465283066034317 according to cross validation on the training set): 
2025-06-17 23:18:48,346 - INFO - Confusion matrix: TN=15, FP=5, FN=44, TP=15
2025-06-17 23:18:51,063 - INFO - Metrics: {'f1': 0.379746835443038, 'recall': 0.2542372881355932, 'precision': 0.75, 'accuracy': 0.379746835443038, 'AP': 0.767312874247801, 'MCC': 0.00423728813559322, 'NDCG': 0.9276436874230435, 'kappa': 0.002576655501159486, 'TN': 15, 'FP': 5, 'FN': 44, 'TP': 15}
2025-06-17 23:18:51,156 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 23:18:51,156 - INFO - Results for fold 3 : [{'f1': 0.379746835443038, 'recall': 0.2542372881355932, 'precision': 0.75, 'accuracy': 0.379746835443038, 'AP': 0.767312874247801, 'MCC': 0.00423728813559322, 'NDCG': 0.9276436874230435, 'kappa': 0.002576655501159486, 'TN': 15, 'FP': 5, 'FN': 44, 'TP': 15}]
2025-06-17 23:18:51,476 - INFO - Cleared CUDA cache. Memory allocated: 1.32 GB, Memory reserved: 1.63 GB
2025-06-17 23:18:51,482 - INFO - Metrics stored successfully at /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/metrics/binary_metrics.csv
Model: google-bert/bert-base-uncased
2025-06-17 23:18:58,673 - INFO - Namespace(config='configs/hpo.yaml', fold=2, run=0, gpu=None, model_name='google-bert/bert-base-uncased', nb_opt_negs=100, n_trials=3, hpo_metric=None, direction=None, loss='BCE', with_title=True, with_keywords=False)
2025-06-17 23:18:58,674 - INFO - {'model_name': 'google-bert/bert-base-uncased', 'num_trials': 20, 'fold': 0, 'hpo_metric': 'eval_kappa', 'direction': 'max', 'loss_type': 'BCE', 'with_title': True, 'with_keywords': False, 'nb_optional_negs': 100}
2025-06-17 23:18:59,047 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
2025-06-17 23:18:59,047 - INFO - 
fold number 3 | run no. 1
2025-06-17 23:18:59,672 - INFO - train split size : 338
2025-06-17 23:18:59,673 - INFO - dev split size : 80
2025-06-17 23:18:59,673 - INFO - test split size : 79
2025-06-17 23:18:59,914 - INFO - 3 datasets tokenized successfully
2025-06-17 23:18:59,973 - INFO - Fold 3 max seq len = 512
2025-06-17 23:18:59,974 - INFO - Starting hyperparameter search for BCE loss
2025-06-17 23:19:01,362	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
2025-06-17 23:19:02,043	INFO tune.py:253 -- Initializing Ray automatically. For cluster usage or custom Ray initialization, call `ray.init(...)` before `tune.run(...)`.
[36m(trainable pid=190598)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=190598)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=190598)[0m 2025-06-17 23:19:09,993 - INFO - pos_weight value in TrainingArguments : 6.828424226204718
[36m(trainable pid=190598)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=190598)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=190796)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=190796)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=190796)[0m 2025-06-17 23:19:16,429 - INFO - pos_weight value in TrainingArguments : 6.094080202241274
[36m(trainable pid=190796)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=190796)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=191162)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=191162)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=191162)[0m 2025-06-17 23:19:22,617 - INFO - pos_weight value in TrainingArguments : 7.183206941666034
[36m(trainable pid=191162)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=191162)[0m   super().__init__(*args, **kwargs)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     trainable_2025-06-17_23-19-02   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-19-02
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-17_23-18-59_994796_188158/artifacts/2025-06-17_23-19-02/trainable_2025-06-17_23-19-02/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-17 23:19:03. Total running time: 0s
Logical resource usage: 0/32 CPUs, 0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_ee0019cf   PENDING         6.82842       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_ee0019cf started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_ee0019cf config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          6.82842 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=190598)[0m [2025-06-17 23:19:10,231] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=190598)[0m [2025-06-17 23:19:12,873] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=190598)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial trainable_771d4dfd started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_771d4dfd config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          6.09408 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=190796)[0m [2025-06-17 23:19:16,814] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=190796)[0m [2025-06-17 23:19:19,731] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=190598)[0m {'loss': 2.5526, 'grad_norm': 26.741945266723633, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}
[36m(trainable pid=190796)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial trainable_0d8eae1c started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_0d8eae1c config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          7.18321 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=191162)[0m [2025-06-17 23:19:22,863] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=191162)[0m [2025-06-17 23:19:25,418] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=191162)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=191162)[0m {'loss': 1.8324, 'grad_norm': 5.496780872344971, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}

Trial status: 3 RUNNING
Current time: 2025-06-17 23:19:33. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_ee0019cf   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ trainable_771d4dfd   RUNNING         6.09408       4.55539e-06         0.123031                    5 â”‚
â”‚ trainable_0d8eae1c   RUNNING         7.18321       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=191162)[0m 2025-06-17 23:19:49,001 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=191162)[0m 2025-06-17 23:19:49,007 - INFO - eval_result: {'eval_loss': 2.1173019409179688, 'eval_f1': 0.7603305785123967, 'eval_accuracy': 0.6375, 'eval_kappa': 0.018612521150592087, 'eval_precision': 0.7419354838709677, 'eval_recall': 0.7796610169491526, 'eval_optim_threshold': 0.9704369902610779, 'eval_AP': 0.8206711144882055, 'eval_MCC': 0.018709187625119646, 'eval_NDCG': 0.9564974596215265, 'eval_runtime': 3.3378, 'eval_samples_per_second': 23.968, 'eval_steps_per_second': 1.198, 'epoch': 3.0}
[36m(trainable pid=191162)[0m 2025-06-17 23:19:49,306 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
2025-06-17 23:19:49,329 - INFO - Cleaning up trial 0d8eae1c
2025-06-17 23:19:49,329 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-19-02/trainable_0d8eae1c_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512_2025-06-17_23-19-15

[36m(trainable pid=191162)[0m {'loss': 1.1679, 'grad_norm': 52.90009689331055, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}[32m [repeated 3x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(trainable pid=191162)[0m {'train_runtime': 19.9179, 'train_samples_per_second': 50.909, 'train_steps_per_second': 2.561, 'train_loss': 1.2928887348549039, 'epoch': 3.0}
[36m(trainable pid=191162)[0m STATE at ending of training  :  TrainerState(epoch=3.0, global_step=51, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=266792214693888.0, log_history=[{'loss': 1.8324, 'grad_norm': 5.496780872344971, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0, 'step': 17}, {'loss': 1.1679, 'grad_norm': 52.90009689331055, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0, 'step': 34}, {'loss': 0.8784, 'grad_norm': 38.884361267089844, 'learning_rate': 0.0, 'epoch': 3.0, 'step': 51}, {'train_runtime': 19.9179, 'train_samples_per_second': 50.909, 'train_steps_per_second': 2.561, 'total_flos': 266792214693888.0, 'train_loss': 1.2928887348549039, 'epoch': 3.0, 'step': 51}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=191162)[0m {'loss': 0.8784, 'grad_norm': 38.884361267089844, 'learning_rate': 0.0, 'epoch': 3.0}
[36m(trainable pid=191162)[0m {'eval_loss': 2.1173019409179688, 'eval_f1': 0.7603305785123967, 'eval_accuracy': 0.6375, 'eval_kappa': 0.018612521150592087, 'eval_precision': 0.7419354838709677, 'eval_recall': 0.7796610169491526, 'eval_optim_threshold': 0.9704369902610779, 'eval_AP': 0.8206711144882055, 'eval_MCC': 0.018709187625119646, 'eval_NDCG': 0.9564974596215265, 'eval_runtime': 3.3378, 'eval_samples_per_second': 23.968, 'eval_steps_per_second': 1.198, 'epoch': 3.0}

Trial trainable_0d8eae1c finished iteration 1 at 2025-06-17 23:19:49. Total running time: 46s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_0d8eae1c result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    27.1161 â”‚
â”‚ time_total_s                        27.1161 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     3 â”‚
â”‚ eval_AP                             0.82067 â”‚
â”‚ eval_MCC                            0.01871 â”‚
â”‚ eval_NDCG                            0.9565 â”‚
â”‚ eval_accuracy                        0.6375 â”‚
â”‚ eval_f1                             0.76033 â”‚
â”‚ eval_kappa                          0.01861 â”‚
â”‚ eval_loss                            2.1173 â”‚
â”‚ eval_optim_threshold                0.97044 â”‚
â”‚ eval_precision                      0.74194 â”‚
â”‚ eval_recall                         0.77966 â”‚
â”‚ eval_runtime                         3.3378 â”‚
â”‚ eval_samples_per_second              23.968 â”‚
â”‚ eval_steps_per_second                 1.198 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_0d8eae1c completed after 1 iterations at 2025-06-17 23:19:49. Total running time: 46s
[36m(trainable pid=190598)[0m {'loss': 2.261, 'grad_norm': 20.445655822753906, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0}

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 23:20:03. Total running time: 1min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_ee0019cf   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_771d4dfd   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_0d8eae1c   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.1161        2.1173    0.760331            0.6375      0.0186125 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=190598)[0m {'loss': 2.2099, 'grad_norm': 35.83174514770508, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0}[32m [repeated 2x across cluster][0m
[36m(trainable pid=190598)[0m {'loss': 2.1196, 'grad_norm': 28.58296012878418, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0}[32m [repeated 2x across cluster][0m
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 23:20:33. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_ee0019cf   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_771d4dfd   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_0d8eae1c   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.1161        2.1173    0.760331            0.6375      0.0186125 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=190598)[0m 2025-06-17 23:20:39,716 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=190598)[0m 2025-06-17 23:20:39,722 - INFO - eval_result: {'eval_loss': 2.5450432300567627, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.6451596617698669, 'eval_AP': 0.7602108771114089, 'eval_MCC': 0.0, 'eval_NDCG': 0.9340343262581544, 'eval_runtime': 3.9029, 'eval_samples_per_second': 20.498, 'eval_steps_per_second': 1.025, 'epoch': 6.0}
[36m(trainable pid=190598)[0m 2025-06-17 23:20:40,040 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
2025-06-17 23:20:40,069 - INFO - Cleaning up trial ee0019cf
2025-06-17 23:20:40,070 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-19-02/trainable_ee0019cf_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-17_23-19-03
2025-06-17 23:20:40,070 - INFO - Current best: 0d8eae1c with eval_kappa : 0.018612521150592087 at iteration 1
[36m(trainable pid=190796)[0m 2025-06-17 23:20:40,157 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=190796)[0m 2025-06-17 23:20:40,162 - INFO - eval_result: {'eval_loss': 1.597733497619629, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.7662338018417358, 'eval_AP': 0.8568555811920837, 'eval_MCC': 0.0, 'eval_NDCG': 0.9681441583328301, 'eval_runtime': 3.4872, 'eval_samples_per_second': 22.941, 'eval_steps_per_second': 1.147, 'epoch': 5.0}
2025-06-17 23:20:40,499 - INFO - Cleaning up trial 771d4dfd
2025-06-17 23:20:40,499 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-19-02/trainable_771d4dfd_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-17_23-19-09
2025-06-17 23:20:40,499 - INFO - Cleaning up trial ee0019cf
2025-06-17 23:20:40,499 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-19-02/trainable_ee0019cf_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-17_23-19-03
2025-06-17 23:20:40,500 - INFO - Current best: 0d8eae1c with eval_kappa : 0.018612521150592087 at iteration 1
2025-06-17 23:20:40,507	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-19-02' in 0.0059s.

[36m(trainable pid=190598)[0m {'train_runtime': 82.6023, 'train_samples_per_second': 24.551, 'train_steps_per_second': 1.235, 'train_loss': 2.2741413490445006, 'epoch': 6.0}
[36m(trainable pid=190598)[0m STATE at ending of training  :  TrainerState(epoch=6.0, global_step=102, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=533584429387776.0, log_history=[{'loss': 2.5526, 'grad_norm': 26.741945266723633, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0, 'step': 17}, {'loss': 2.424, 'grad_norm': 34.268802642822266, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0, 'step': 34}, {'loss': 2.261, 'grad_norm': 20.445655822753906, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0, 'step': 51}, {'loss': 2.2099, 'grad_norm': 35.83174514770508, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0, 'step': 68}, {'loss': 2.1196, 'grad_norm': 28.58296012878418, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0, 'step': 85}, {'loss': 2.0777, 'grad_norm': 26.75943374633789, 'learning_rate': 0.0, 'epoch': 6.0, 'step': 102}, {'train_runtime': 82.6023, 'train_samples_per_second': 24.551, 'train_steps_per_second': 1.235, 'total_flos': 533584429387776.0, 'train_loss': 2.2741413490445006, 'epoch': 6.0, 'step': 102}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=190598)[0m {'loss': 2.0777, 'grad_norm': 26.75943374633789, 'learning_rate': 0.0, 'epoch': 6.0}[32m [repeated 2x across cluster][0m
[36m(trainable pid=190796)[0m STATE at ending of training  :  TrainerState(epoch=5.0, global_step=85, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=444653691156480.0, log_history=[{'loss': 2.2661, 'grad_norm': 18.66405487060547, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0, 'step': 17}, {'loss': 1.8657, 'grad_norm': 19.723649978637695, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0, 'step': 34}, {'loss': 1.6562, 'grad_norm': 8.80378532409668, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0, 'step': 51}, {'loss': 1.5319, 'grad_norm': 17.404468536376953, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0, 'step': 68}, {'loss': 1.4656, 'grad_norm': 14.60529613494873, 'learning_rate': 0.0, 'epoch': 5.0, 'step': 85}, {'train_runtime': 76.471, 'train_samples_per_second': 22.1, 'train_steps_per_second': 1.112, 'total_flos': 444653691156480.0, 'train_loss': 1.7570982989142923, 'epoch': 5.0, 'step': 85}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=190598)[0m {'eval_loss': 2.5450432300567627, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.6451596617698669, 'eval_AP': 0.7602108771114089, 'eval_MCC': 0.0, 'eval_NDCG': 0.9340343262581544, 'eval_runtime': 3.9029, 'eval_samples_per_second': 20.498, 'eval_steps_per_second': 1.025, 'epoch': 6.0}

Trial trainable_ee0019cf finished iteration 1 at 2025-06-17 23:20:40. Total running time: 1min 36s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_ee0019cf result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    90.4918 â”‚
â”‚ time_total_s                        90.4918 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     6 â”‚
â”‚ eval_AP                             0.76021 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.93403 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           2.54504 â”‚
â”‚ eval_optim_threshold                0.64516 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.9029 â”‚
â”‚ eval_samples_per_second              20.498 â”‚
â”‚ eval_steps_per_second                 1.025 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_ee0019cf completed after 1 iterations at 2025-06-17 23:20:40. Total running time: 1min 36s

Trial trainable_771d4dfd finished iteration 1 at 2025-06-17 23:20:40. Total running time: 1min 37s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_771d4dfd result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    84.5215 â”‚
â”‚ time_total_s                        84.5215 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     5 â”‚
â”‚ eval_AP                             0.85686 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.96814 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.59773 â”‚
â”‚ eval_optim_threshold                0.76623 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.4872 â”‚
â”‚ eval_samples_per_second              22.941 â”‚
â”‚ eval_steps_per_second                 1.147 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_771d4dfd completed after 1 iterations at 2025-06-17 23:20:40. Total running time: 1min 37s

Trial status: 3 TERMINATED
Current time: 2025-06-17 23:20:40. Total running time: 1min 37s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_ee0019cf   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1            90.4918       2.54504    0.848921            0.7375      0         â”‚
â”‚ trainable_771d4dfd   TERMINATED        6.09408       4.55539e-06         0.123031                    5        1            84.5215       1.59773    0.848921            0.7375      0         â”‚
â”‚ trainable_0d8eae1c   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.1161       2.1173     0.760331            0.6375      0.0186125 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯2025-06-17 23:20:40,515 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x7eca361e55d0>
2025-06-17 23:20:40,515 - INFO - Best trial : trainable_0d8eae1c
2025-06-17 23:20:40,515 - INFO - Best config : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-17 23:20:40,515 - INFO - Best trial after optimization: {'eval_loss': 2.1173019409179688, 'eval_f1': 0.7603305785123967, 'eval_accuracy': 0.6375, 'eval_kappa': 0.018612521150592087, 'eval_precision': 0.7419354838709677, 'eval_recall': 0.7796610169491526, 'eval_optim_threshold': 0.9704369902610779, 'eval_AP': 0.8206711144882055, 'eval_MCC': 0.018709187625119646, 'eval_NDCG': 0.9564974596215265, 'eval_runtime': 3.3378, 'eval_samples_per_second': 23.968, 'eval_steps_per_second': 1.198, 'epoch': 3.0, 'timestamp': 1750195189, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '0d8eae1c', 'date': '2025-06-17_23-19-49', 'time_this_iter_s': 27.11609411239624, 'time_total_s': 27.11609411239624, 'pid': 191162, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 27.11609411239624, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512'}
2025-06-17 23:20:40,536 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   2.545043  0.848921  ...                        6  ee0019cf
1   1.597733  0.848921  ...                        5  771d4dfd
2   2.117302  0.760331  ...                        3  0d8eae1c

[3 rows x 32 columns]
2025-06-17 23:20:40,657 - INFO - Trial comparison plot saved
2025-06-17 23:20:40,668 - INFO - Best Hyperparameters after HPO : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}


[36m(trainable pid=190796)[0m /home/leandre/.local/share/uv/python/cpython-3.11.11-linux-x86_64-gnu/lib/python3.11/multiprocessing/resource_tracker.py:123: UserWarning: resource_tracker: process died unexpectedly, relaunching.  Some resources might leak.
[36m(trainable pid=190796)[0m   warnings.warn('resource_tracker: process died unexpectedly, '
[36m(trainable pid=190796)[0m Traceback (most recent call last):
[36m(trainable pid=190796)[0m   File "/home/leandre/.local/share/uv/python/cpython-3.11.11-linux-x86_64-gnu/lib/python3.11/multiprocessing/resource_tracker.py", line 239, in main
[36m(trainable pid=190796)[0m     cache[rtype].remove(name)
[36m(trainable pid=190796)[0m KeyError: '/loky-190796-rfhfv1_5'
[36m(trainable pid=190796)[0m 2025-06-17 23:20:40,479 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(trainable pid=190796)[0m {'train_runtime': 76.471, 'train_samples_per_second': 22.1, 'train_steps_per_second': 1.112, 'train_loss': 1.7570982989142923, 'epoch': 5.0}
[36m(trainable pid=190796)[0m {'loss': 1.4656, 'grad_norm': 14.60529613494873, 'learning_rate': 0.0, 'epoch': 5.0}
[36m(trainable pid=190796)[0m {'eval_loss': 1.597733497619629, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.7662338018417358, 'eval_AP': 0.8568555811920837, 'eval_MCC': 0.0, 'eval_NDCG': 0.9681441583328301, 'eval_runtime': 3.4872, 'eval_samples_per_second': 22.941, 'eval_steps_per_second': 1.147, 'epoch': 5.0}
2025-06-17 23:20:49,243 - INFO - Namespace(config='configs/train.yaml', hp_config='configs/best_hpo.yaml', fold=2, run=0, gpu='2', model_name='google-bert/bert-base-uncased', nb_opt_negs=100, loss='BCE', with_title=True, with_keywords=False, best_metric=None)
2025-06-17 23:20:49,245 - INFO - {'model_name': 'bert-base-uncased', 'fold': 0, 'run': 0, 'output_dir': 'outputs/checkpoints', 'best_metric': 'eval_kappa', 'loss_type': 'BCE', 'nb_optional_negs': 100, 'with_title': True, 'with_keywords': False, 'default_hyperparameters': {'learning_rate': 'None', 'num_train_epochs': 'None', 'pos_weight': 'None', 'weight_decay': 'None'}}
2025-06-17 23:20:50,083 - INFO - train split size : 338
2025-06-17 23:20:50,083 - INFO - dev split size : 80
2025-06-17 23:20:50,083 - INFO - test split size : 79
2025-06-17 23:20:50,329 - INFO - 3 datasets tokenized successfully
2025-06-17 23:20:50,329 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at google-bert/bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-17 23:20:50,635 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
[2025-06-17 23:20:50,861] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-06-17 23:20:53,547] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
2025-06-17 23:20:53,584 - INFO - training size : 338
2025-06-17 23:20:53,584 - INFO - dev size : 80
2025-06-17 23:20:53,584 - INFO - test size : 79
  0%|          | 0/12 [00:00<?, ?it/s]  8%|â–Š         | 1/12 [00:02<00:26,  2.37s/it] 17%|â–ˆâ–‹        | 2/12 [00:04<00:20,  2.06s/it] 25%|â–ˆâ–ˆâ–Œ       | 3/12 [00:05<00:17,  1.93s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [00:06<00:11,  1.43s/it]                                               33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [00:06<00:11,  1.43s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 5/12 [00:08<00:11,  1.60s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 6/12 [00:10<00:10,  1.67s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 7/12 [00:12<00:08,  1.71s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [00:12<00:05,  1.38s/it]                                               67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [00:12<00:05,  1.38s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 9/12 [00:14<00:04,  1.54s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 10/12 [00:16<00:03,  1.63s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 11/12 [00:18<00:01,  1.68s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:19<00:00,  1.37s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:20<00:00,  1.37s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:20<00:00,  1.37s/it]2025-06-17 23:21:14,724 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:20<00:00,  1.74s/it]
{'loss': 2.6502, 'grad_norm': 12.291377067565918, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
{'loss': 1.5782, 'grad_norm': 2.873978853225708, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
{'loss': 1.4274, 'grad_norm': 4.32418155670166, 'learning_rate': 0.0, 'epoch': 3.0}
{'train_runtime': 20.866, 'train_samples_per_second': 48.596, 'train_steps_per_second': 0.575, 'train_loss': 1.8852871656417847, 'epoch': 3.0}
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 23:21:18,274 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:03<00:00,  3.03s/it]
2025-06-17 23:21:18,279 - INFO - Training time : 27.94989892700687
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 23:21:21,535 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.74s/it]
2025-06-17 23:21:21,539 - INFO - Evaluation time : 3.2595275558996946
2025-06-17 23:21:21,539 - INFO - Evaluation results on test set: {'eval_loss': 1.1969225406646729, 'eval_f1': 0.855072463768116, 'eval_accuracy': 0.7468354430379747, 'eval_kappa': 0.0, 'eval_precision': 0.7468354430379747, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8904744982719421, 'eval_AP': 0.8046235682084095, 'eval_MCC': 0.0, 'eval_NDCG': 0.9509398811011531, 'eval_runtime': 3.2486, 'eval_samples_per_second': 24.318, 'eval_steps_per_second': 0.308, 'epoch': 3.0}
2025-06-17 23:21:21,539 - INFO - Total updates (optimizer steps): 12
2025-06-17 23:21:21,539 - INFO - Avg time / step: 1.739s
2025-06-17 23:21:22,250 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCE_bert-base_fold-3
2025-06-17 23:21:22,250 - INFO - On test Set (with threshold 0.5) : 
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 23:21:25,516 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.75s/it]
2025-06-17 23:21:25,519 - INFO - Raw predictions shape: (79, 1)
2025-06-17 23:21:25,519 - INFO - Raw predictions: [[1.8549923]
 [2.051212 ]
 [1.7829996]
 [1.8562086]
 [1.9002149]
 [2.20933  ]
 [2.044661 ]
 [1.952033 ]
 [2.020368 ]
 [2.2400684]]
2025-06-17 23:21:25,519 - INFO - Scores shape: (79,)
2025-06-17 23:21:25,520 - INFO - Scores: [0.86471224 0.8860701  0.8560669  0.86485445 0.86991584 0.90108424
 0.885407   0.8756681  0.8829191  0.90379035]
2025-06-17 23:21:25,520 - INFO - Preds shape: (79,)
2025-06-17 23:21:25,520 - INFO - Preds: [1 1 1 1 1 1 1 1 1 1]
2025-06-17 23:21:25,520 - INFO - Test labels shape: (79,)
2025-06-17 23:21:25,520 - INFO - Test labels: [0, 1, 1, 1, 1, 1, 0, 1, 1, 0]
2025-06-17 23:21:25,520 - INFO - Test split: Dataset({
    features: ['Unnamed: 0', 'title', 'abstract', 'Keywords', 'doi', 'labels'],
    num_rows: 79
})
2025-06-17 23:21:25,520 - INFO - Unique values in predictions: [1]
2025-06-17 23:21:25,520 - INFO - Unique values in labels: [0 1]
2025-06-17 23:21:25,521 - INFO - Confusion matrix:
[[ 0 20]
 [ 0 59]]
2025-06-17 23:21:25,522 - INFO - Confusion matrix: TN=0, FP=20, FN=0, TP=59
2025-06-17 23:21:28,223 - INFO - Metrics: {'f1': 0.855072463768116, 'recall': 1.0, 'precision': 0.7468354430379747, 'accuracy': 0.7468354430379747, 'AP': 0.8046235682084095, 'MCC': 0.0, 'NDCG': 0.9509398811011531, 'kappa': 0.0, 'TN': 0, 'FP': 20, 'FN': 0, 'TP': 59}
2025-06-17 23:21:28,338 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-17 23:21:28,430 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 23:21:28,430 - INFO - 
On test Set (optimal threshold of 0.8870500326156616 according to cross validation on the training set): 
2025-06-17 23:21:28,431 - INFO - Confusion matrix: TN=11, FP=9, FN=29, TP=30
2025-06-17 23:21:31,144 - INFO - Metrics: {'f1': 0.6122448979591837, 'recall': 0.5084745762711864, 'precision': 0.7692307692307693, 'accuracy': 0.5189873417721519, 'AP': 0.8046235682084095, 'MCC': 0.05085642033133931, 'NDCG': 0.9509398811011531, 'kappa': 0.04394904458598725, 'TN': 11, 'FP': 9, 'FN': 29, 'TP': 30}
2025-06-17 23:21:31,235 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 23:21:31,236 - INFO - Results for fold 3 : [{'f1': 0.6122448979591837, 'recall': 0.5084745762711864, 'precision': 0.7692307692307693, 'accuracy': 0.5189873417721519, 'AP': 0.8046235682084095, 'MCC': 0.05085642033133931, 'NDCG': 0.9509398811011531, 'kappa': 0.04394904458598725, 'TN': 11, 'FP': 9, 'FN': 29, 'TP': 30}]
2025-06-17 23:21:31,561 - INFO - Cleared CUDA cache. Memory allocated: 1.33 GB, Memory reserved: 1.63 GB
2025-06-17 23:21:31,567 - INFO - Metrics stored successfully at /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/metrics/binary_metrics.csv
Ensemble :
2025-06-17 23:21:38,713 - INFO - Namespace(config='configs/ensemble.yaml', fold=2, run=0, model_names=None, nb_opt_negs=100, loss='BCE', with_title=True, with_keywords=False)
2025-06-17 23:21:38,714 - INFO - {'model_names': ['microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract', 'microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext', 'FacebookAI/roberta-base', 'dmis-lab/biobert-v1.1', 'google-bert/bert-base-uncased'], 'fold': 0, 'run': 0, 'loss_type': 'BCE', 'with_title': True, 'with_keywords': False, 'nb_optional_negs': 100}
2025-06-17 23:21:38,722 - INFO - 
fold number 3 | run no. 0
2025-06-17 23:21:39,082 - INFO - Confusion matrix: TN=0, FP=20, FN=0, TP=59
2025-06-17 23:21:41,816 - INFO - Metrics: {'f1': 0.855072463768116, 'recall': 1.0, 'precision': 0.7468354430379747, 'accuracy': 0.7468354430379747, 'AP': 0.8296648563619393, 'MCC': 0.0, 'NDCG': 0.9561161898476355, 'kappa': 0.0, 'TN': 0, 'FP': 20, 'FN': 0, 'TP': 59}
2025-06-17 23:21:41,820 - INFO - Metrics stored successfully at /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/metrics/binary_metrics.csv
Traceback (most recent call last):
  File "/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/ensemble.py", line 211, in <module>
    main()
  File "/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/ensemble.py", line 208, in main
    ensemble_pred(cfg)
  File "/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/ensemble.py", line 179, in ensemble_pred
    (avg_metrics["loss_type"] == self.loss_type)
                                 ^^^^
NameError: name 'self' is not defined. Did you mean: 'Self'?
Fold number: 3
Run number: 0
Model: microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract
2025-06-17 23:21:48,400 - INFO - Namespace(config='configs/hpo.yaml', fold=3, run=0, gpu=None, model_name='microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract', nb_opt_negs=100, n_trials=3, hpo_metric=None, direction=None, loss='BCE', with_title=True, with_keywords=False)
2025-06-17 23:21:48,402 - INFO - {'model_name': 'google-bert/bert-base-uncased', 'num_trials': 20, 'fold': 0, 'hpo_metric': 'eval_kappa', 'direction': 'max', 'loss_type': 'BCE', 'with_title': True, 'with_keywords': False, 'nb_optional_negs': 100}
2025-06-17 23:21:48,777 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
2025-06-17 23:21:48,777 - INFO - 
fold number 4 | run no. 1
2025-06-17 23:21:49,379 - INFO - train split size : 338
2025-06-17 23:21:49,379 - INFO - dev split size : 80
2025-06-17 23:21:49,379 - INFO - test split size : 79
2025-06-17 23:21:49,613 - INFO - 3 datasets tokenized successfully
2025-06-17 23:21:49,671 - INFO - Fold 4 max seq len = 512
2025-06-17 23:21:49,671 - INFO - Starting hyperparameter search for BCE loss
2025-06-17 23:21:51,050	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
2025-06-17 23:21:51,807	INFO tune.py:253 -- Initializing Ray automatically. For cluster usage or custom Ray initialization, call `ray.init(...)` before `tune.run(...)`.
[36m(trainable pid=195648)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=195648)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=195648)[0m 2025-06-17 23:22:00,496 - INFO - pos_weight value in TrainingArguments : 6.828424226204718
[36m(trainable pid=195648)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=195648)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=195846)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=195846)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=195846)[0m 2025-06-17 23:22:06,846 - INFO - pos_weight value in TrainingArguments : 6.094080202241274
[36m(trainable pid=195846)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=195846)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=196233)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=196233)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=196233)[0m 2025-06-17 23:22:13,028 - INFO - pos_weight value in TrainingArguments : 7.183206941666034
[36m(trainable pid=196233)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=196233)[0m   super().__init__(*args, **kwargs)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     trainable_2025-06-17_23-21-51   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-21-51
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-17_23-21-49_692151_193207/artifacts/2025-06-17_23-21-51/trainable_2025-06-17_23-21-51/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-17 23:21:53. Total running time: 0s
Logical resource usage: 0/32 CPUs, 0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_2b3adbfb   PENDING         6.82842       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_2b3adbfb started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_2b3adbfb config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          6.82842 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=195648)[0m [2025-06-17 23:22:00,719] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=195648)[0m [2025-06-17 23:22:03,400] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=195648)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial trainable_eea012f1 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_eea012f1 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          6.09408 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=195846)[0m [2025-06-17 23:22:07,229] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=195846)[0m [2025-06-17 23:22:09,797] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=195846)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=195648)[0m {'loss': 2.9738, 'grad_norm': 35.12181091308594, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}

Trial trainable_ec4ab596 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_ec4ab596 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          7.18321 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=196233)[0m [2025-06-17 23:22:13,240] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=196233)[0m [2025-06-17 23:22:15,808] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=196233)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=196233)[0m {'loss': 1.5191, 'grad_norm': 12.356115341186523, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}

Trial status: 3 RUNNING
Current time: 2025-06-17 23:22:23. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_2b3adbfb   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ trainable_eea012f1   RUNNING         6.09408       4.55539e-06         0.123031                    5 â”‚
â”‚ trainable_ec4ab596   RUNNING         7.18321       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=196233)[0m 2025-06-17 23:22:39,732 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=196233)[0m 2025-06-17 23:22:39,738 - INFO - eval_result: {'eval_loss': 0.7819613814353943, 'eval_f1': 0.8740740740740741, 'eval_accuracy': 0.7875, 'eval_kappa': 0.25764192139737985, 'eval_precision': 0.7763157894736842, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9649094343185425, 'eval_AP': 0.9198953599112818, 'eval_MCC': 0.38453826101633065, 'eval_NDCG': 0.9823899904123019, 'eval_runtime': 3.7439, 'eval_samples_per_second': 21.368, 'eval_steps_per_second': 1.068, 'epoch': 3.0}
[36m(trainable pid=196233)[0m 2025-06-17 23:22:40,040 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
2025-06-17 23:22:40,063 - INFO - Cleaning up trial ec4ab596
2025-06-17 23:22:40,063 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-21-51/trainable_ec4ab596_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512_2025-06-17_23-22-06

[36m(trainable pid=195846)[0m {'loss': 1.7366, 'grad_norm': 7.843356132507324, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0}
[36m(trainable pid=196233)[0m {'train_runtime': 19.8486, 'train_samples_per_second': 51.087, 'train_steps_per_second': 2.569, 'train_loss': 1.04026777604047, 'epoch': 3.0}
[36m(trainable pid=196233)[0m STATE at ending of training  :  
[36m(trainable pid=196233)[0m {'loss': 0.7838, 'grad_norm': 5.8513336181640625, 'learning_rate': 0.0, 'epoch': 3.0}[32m [repeated 3x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(trainable pid=196233)[0m TrainerState(epoch=3.0, global_step=51, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=266792214693888.0, log_history=[{'loss': 1.5191, 'grad_norm': 12.356115341186523, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0, 'step': 17}, {'loss': 0.8179, 'grad_norm': 23.921276092529297, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0, 'step': 34}, {'loss': 0.7838, 'grad_norm': 5.8513336181640625, 'learning_rate': 0.0, 'epoch': 3.0, 'step': 51}, {'train_runtime': 19.8486, 'train_samples_per_second': 51.087, 'train_steps_per_second': 2.569, 'total_flos': 266792214693888.0, 'train_loss': 1.04026777604047, 'epoch': 3.0, 'step': 51}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=196233)[0m {'eval_loss': 0.7819613814353943, 'eval_f1': 0.8740740740740741, 'eval_accuracy': 0.7875, 'eval_kappa': 0.25764192139737985, 'eval_precision': 0.7763157894736842, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9649094343185425, 'eval_AP': 0.9198953599112818, 'eval_MCC': 0.38453826101633065, 'eval_NDCG': 0.9823899904123019, 'eval_runtime': 3.7439, 'eval_samples_per_second': 21.368, 'eval_steps_per_second': 1.068, 'epoch': 3.0}

Trial trainable_ec4ab596 finished iteration 1 at 2025-06-17 23:22:40. Total running time: 47s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_ec4ab596 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    27.8299 â”‚
â”‚ time_total_s                        27.8299 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     3 â”‚
â”‚ eval_AP                              0.9199 â”‚
â”‚ eval_MCC                            0.38454 â”‚
â”‚ eval_NDCG                           0.98239 â”‚
â”‚ eval_accuracy                        0.7875 â”‚
â”‚ eval_f1                             0.87407 â”‚
â”‚ eval_kappa                          0.25764 â”‚
â”‚ eval_loss                           0.78196 â”‚
â”‚ eval_optim_threshold                0.96491 â”‚
â”‚ eval_precision                      0.77632 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.7439 â”‚
â”‚ eval_samples_per_second              21.368 â”‚
â”‚ eval_steps_per_second                 1.068 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_ec4ab596 completed after 1 iterations at 2025-06-17 23:22:40. Total running time: 47s
[36m(trainable pid=195648)[0m {'loss': 1.7663, 'grad_norm': 16.290912628173828, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0}[32m [repeated 2x across cluster][0m

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 23:22:53. Total running time: 1min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_2b3adbfb   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_eea012f1   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_ec4ab596   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.8299      0.781961    0.874074            0.7875       0.257642 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=195846)[0m {'loss': 1.2366, 'grad_norm': 9.482227325439453, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0}
[36m(trainable pid=195648)[0m {'loss': 1.559, 'grad_norm': 18.84050178527832, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0}
[36m(trainable pid=195846)[0m {'loss': 1.1784, 'grad_norm': 6.8597846031188965, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0}
[36m(trainable pid=195648)[0m {'loss': 1.4961, 'grad_norm': 14.362298965454102, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 23:23:23. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_2b3adbfb   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_eea012f1   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_ec4ab596   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.8299      0.781961    0.874074            0.7875       0.257642 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=195846)[0m 2025-06-17 23:23:30,202 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=195846)[0m 2025-06-17 23:23:30,208 - INFO - eval_result: {'eval_loss': 1.0953510999679565, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8637245893478394, 'eval_AP': 0.8749930678010573, 'eval_MCC': 0.0, 'eval_NDCG': 0.973388524626568, 'eval_runtime': 3.9442, 'eval_samples_per_second': 20.283, 'eval_steps_per_second': 1.014, 'epoch': 5.0}
[36m(trainable pid=195648)[0m 2025-06-17 23:23:30,488 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=195648)[0m 2025-06-17 23:23:30,494 - INFO - eval_result: {'eval_loss': 1.4922380447387695, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8379056453704834, 'eval_AP': 0.7602163228819332, 'eval_MCC': 0.0, 'eval_NDCG': 0.9329545054089795, 'eval_runtime': 3.5797, 'eval_samples_per_second': 22.348, 'eval_steps_per_second': 1.117, 'epoch': 6.0}
2025-06-17 23:23:30,535 - INFO - Cleaning up trial eea012f1
2025-06-17 23:23:30,536 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-21-51/trainable_eea012f1_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-17_23-21-59
2025-06-17 23:23:30,536 - INFO - Current best: ec4ab596 with eval_kappa : 0.25764192139737985 at iteration 1
[36m(trainable pid=195846)[0m 2025-06-17 23:23:30,515 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
2025-06-17 23:23:30,824 - INFO - Cleaning up trial 2b3adbfb
2025-06-17 23:23:30,825 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-21-51/trainable_2b3adbfb_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-17_23-21-52
2025-06-17 23:23:30,825 - INFO - Cleaning up trial eea012f1
2025-06-17 23:23:30,825 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-21-51/trainable_eea012f1_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-17_23-21-59
2025-06-17 23:23:30,825 - INFO - Current best: ec4ab596 with eval_kappa : 0.25764192139737985 at iteration 1
2025-06-17 23:23:30,833	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-21-51' in 0.0063s.

[36m(trainable pid=195846)[0m {'train_runtime': 76.1249, 'train_samples_per_second': 22.2, 'train_steps_per_second': 1.117, 'train_loss': 1.3244671765495748, 'epoch': 5.0}
[36m(trainable pid=195846)[0m STATE at ending of training  :  TrainerState(epoch=5.0, global_step=85, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=444653691156480.0, log_history=[{'loss': 1.7366, 'grad_norm': 7.843356132507324, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0, 'step': 17}, {'loss': 1.3279, 'grad_norm': 8.502412796020508, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0, 'step': 34}, {'loss': 1.2366, 'grad_norm': 9.482227325439453, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0, 'step': 51}, {'loss': 1.1784, 'grad_norm': 6.8597846031188965, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0, 'step': 68}, {'loss': 1.1429, 'grad_norm': 8.629833221435547, 'learning_rate': 0.0, 'epoch': 5.0, 'step': 85}, {'train_runtime': 76.1249, 'train_samples_per_second': 22.2, 'train_steps_per_second': 1.117, 'total_flos': 444653691156480.0, 'train_loss': 1.3244671765495748, 'epoch': 5.0, 'step': 85}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=195846)[0m {'loss': 1.1429, 'grad_norm': 8.629833221435547, 'learning_rate': 0.0, 'epoch': 5.0}
[36m(trainable pid=195648)[0m {'loss': 1.4638, 'grad_norm': 11.841124534606934, 'learning_rate': 0.0, 'epoch': 6.0}
[36m(trainable pid=195648)[0m STATE at ending of training  :  TrainerState(epoch=6.0, global_step=102, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=533584429387776.0, log_history=[{'loss': 2.9738, 'grad_norm': 35.12181091308594, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0, 'step': 17}, {'loss': 2.0893, 'grad_norm': 29.492889404296875, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0, 'step': 34}, {'loss': 1.7663, 'grad_norm': 16.290912628173828, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0, 'step': 51}, {'loss': 1.559, 'grad_norm': 18.84050178527832, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0, 'step': 68}, {'loss': 1.4961, 'grad_norm': 14.362298965454102, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0, 'step': 85}, {'loss': 1.4638, 'grad_norm': 11.841124534606934, 'learning_rate': 0.0, 'epoch': 6.0, 'step': 102}, {'train_runtime': 83.1659, 'train_samples_per_second': 24.385, 'train_steps_per_second': 1.226, 'total_flos': 533584429387776.0, 'train_loss': 1.8913916419534123, 'epoch': 6.0, 'step': 102}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=195846)[0m {'eval_loss': 1.0953510999679565, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8637245893478394, 'eval_AP': 0.8749930678010573, 'eval_MCC': 0.0, 'eval_NDCG': 0.973388524626568, 'eval_runtime': 3.9442, 'eval_samples_per_second': 20.283, 'eval_steps_per_second': 1.014, 'epoch': 5.0}

Trial trainable_eea012f1 finished iteration 1 at 2025-06-17 23:23:30. Total running time: 1min 37s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_eea012f1 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    84.5144 â”‚
â”‚ time_total_s                        84.5144 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     5 â”‚
â”‚ eval_AP                             0.87499 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.97339 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.09535 â”‚
â”‚ eval_optim_threshold                0.86372 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.9442 â”‚
â”‚ eval_samples_per_second              20.283 â”‚
â”‚ eval_steps_per_second                 1.014 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_eea012f1 completed after 1 iterations at 2025-06-17 23:23:30. Total running time: 1min 37s

Trial trainable_2b3adbfb finished iteration 1 at 2025-06-17 23:23:30. Total running time: 1min 37s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_2b3adbfb result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    91.2155 â”‚
â”‚ time_total_s                        91.2155 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     6 â”‚
â”‚ eval_AP                             0.76022 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.93295 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.49224 â”‚
â”‚ eval_optim_threshold                0.83791 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.5797 â”‚
â”‚ eval_samples_per_second              22.348 â”‚
â”‚ eval_steps_per_second                 1.117 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_2b3adbfb completed after 1 iterations at 2025-06-17 23:23:30. Total running time: 1min 37s

Trial status: 3 TERMINATED
Current time: 2025-06-17 23:23:30. Total running time: 1min 37s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_2b3adbfb   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1            91.2155      1.49224     0.848921            0.7375       0        â”‚
â”‚ trainable_eea012f1   TERMINATED        6.09408       4.55539e-06         0.123031                    5        1            84.5144      1.09535     0.848921            0.7375       0        â”‚
â”‚ trainable_ec4ab596   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.8299      0.781961    0.874074            0.7875       0.257642 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯2025-06-17 23:23:30,839 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x7567531b1790>
2025-06-17 23:23:30,839 - INFO - Best trial : trainable_ec4ab596
2025-06-17 23:23:30,839 - INFO - Best config : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-17 23:23:30,839 - INFO - Best trial after optimization: {'eval_loss': 0.7819613814353943, 'eval_f1': 0.8740740740740741, 'eval_accuracy': 0.7875, 'eval_kappa': 0.25764192139737985, 'eval_precision': 0.7763157894736842, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9649094343185425, 'eval_AP': 0.9198953599112818, 'eval_MCC': 0.38453826101633065, 'eval_NDCG': 0.9823899904123019, 'eval_runtime': 3.7439, 'eval_samples_per_second': 21.368, 'eval_steps_per_second': 1.068, 'epoch': 3.0, 'timestamp': 1750195360, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': 'ec4ab596', 'date': '2025-06-17_23-22-40', 'time_this_iter_s': 27.829944133758545, 'time_total_s': 27.829944133758545, 'pid': 196233, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 27.829944133758545, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512'}
2025-06-17 23:23:30,861 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   1.492238  0.848921  ...                        6  2b3adbfb
1   1.095351  0.848921  ...                        5  eea012f1
2   0.781961  0.874074  ...                        3  ec4ab596

[3 rows x 32 columns]
2025-06-17 23:23:31,041 - INFO - Trial comparison plot saved
2025-06-17 23:23:31,049 - INFO - Best Hyperparameters after HPO : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}


[36m(trainable pid=195846)[0m /home/leandre/.local/share/uv/python/cpython-3.11.11-linux-x86_64-gnu/lib/python3.11/multiprocessing/resource_tracker.py:123: UserWarning: resource_tracker: process died unexpectedly, relaunching.  Some resources might leak.
[36m(trainable pid=195846)[0m   warnings.warn('resource_tracker: process died unexpectedly, '
[36m(trainable pid=195846)[0m Traceback (most recent call last):
[36m(trainable pid=195846)[0m   File "/home/leandre/.local/share/uv/python/cpython-3.11.11-linux-x86_64-gnu/lib/python3.11/multiprocessing/resource_tracker.py", line 239, in main
[36m(trainable pid=195846)[0m     cache[rtype].remove(name)
[36m(trainable pid=195846)[0m KeyError: '/loky-195846-b4qhmbq0'
[36m(trainable pid=195648)[0m 2025-06-17 23:23:30,804 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(trainable pid=195648)[0m {'train_runtime': 83.1659, 'train_samples_per_second': 24.385, 'train_steps_per_second': 1.226, 'train_loss': 1.8913916419534123, 'epoch': 6.0}
[36m(trainable pid=195648)[0m {'eval_loss': 1.4922380447387695, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8379056453704834, 'eval_AP': 0.7602163228819332, 'eval_MCC': 0.0, 'eval_NDCG': 0.9329545054089795, 'eval_runtime': 3.5797, 'eval_samples_per_second': 22.348, 'eval_steps_per_second': 1.117, 'epoch': 6.0}
2025-06-17 23:23:39,685 - INFO - Namespace(config='configs/train.yaml', hp_config='configs/best_hpo.yaml', fold=3, run=0, gpu='2', model_name='microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract', nb_opt_negs=100, loss='BCE', with_title=True, with_keywords=False, best_metric=None)
2025-06-17 23:23:39,687 - INFO - {'model_name': 'bert-base-uncased', 'fold': 0, 'run': 0, 'output_dir': 'outputs/checkpoints', 'best_metric': 'eval_kappa', 'loss_type': 'BCE', 'nb_optional_negs': 100, 'with_title': True, 'with_keywords': False, 'default_hyperparameters': {'learning_rate': 'None', 'num_train_epochs': 'None', 'pos_weight': 'None', 'weight_decay': 'None'}}
2025-06-17 23:23:40,505 - INFO - train split size : 338
2025-06-17 23:23:40,506 - INFO - dev split size : 80
2025-06-17 23:23:40,506 - INFO - test split size : 79
2025-06-17 23:23:40,745 - INFO - 3 datasets tokenized successfully
2025-06-17 23:23:40,746 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-17 23:23:41,464 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
[2025-06-17 23:23:41,680] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-06-17 23:23:44,332] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
2025-06-17 23:23:44,370 - INFO - training size : 338
2025-06-17 23:23:44,370 - INFO - dev size : 80
2025-06-17 23:23:44,370 - INFO - test size : 79
  0%|          | 0/12 [00:00<?, ?it/s]  8%|â–Š         | 1/12 [00:02<00:25,  2.36s/it] 17%|â–ˆâ–‹        | 2/12 [00:04<00:20,  2.05s/it] 25%|â–ˆâ–ˆâ–Œ       | 3/12 [00:05<00:17,  1.92s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [00:06<00:11,  1.44s/it]                                               33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [00:06<00:11,  1.44s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 5/12 [00:08<00:11,  1.60s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 6/12 [00:10<00:10,  1.68s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 7/12 [00:12<00:08,  1.71s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [00:12<00:05,  1.38s/it]                                               67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [00:12<00:05,  1.38s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 9/12 [00:14<00:04,  1.54s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 10/12 [00:16<00:03,  1.63s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 11/12 [00:18<00:01,  1.68s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:19<00:00,  1.38s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:20<00:00,  1.38s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:20<00:00,  1.38s/it]2025-06-17 23:24:05,503 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:20<00:00,  1.74s/it]
{'loss': 1.7506, 'grad_norm': 5.031874179840088, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
{'loss': 1.2361, 'grad_norm': 7.247919082641602, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
{'loss': 1.0199, 'grad_norm': 6.725499629974365, 'learning_rate': 0.0, 'epoch': 3.0}
{'train_runtime': 20.8572, 'train_samples_per_second': 48.616, 'train_steps_per_second': 0.575, 'train_loss': 1.3355114062627156, 'epoch': 3.0}
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 23:24:09,232 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:03<00:00,  3.22s/it]
2025-06-17 23:24:09,238 - INFO - Training time : 28.492036496987566
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 23:24:12,461 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.72s/it]
2025-06-17 23:24:12,466 - INFO - Evaluation time : 3.2278779050102457
2025-06-17 23:24:12,466 - INFO - Evaluation results on test set: {'eval_loss': 1.0605788230895996, 'eval_f1': 0.8467153284671532, 'eval_accuracy': 0.7341772151898734, 'eval_kappa': 0.0, 'eval_precision': 0.7341772151898734, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9471806883811951, 'eval_AP': 0.8711835559186255, 'eval_MCC': 0.0, 'eval_NDCG': 0.9726666229761312, 'eval_runtime': 3.2158, 'eval_samples_per_second': 24.566, 'eval_steps_per_second': 0.311, 'epoch': 3.0}
2025-06-17 23:24:12,466 - INFO - Total updates (optimizer steps): 12
2025-06-17 23:24:12,466 - INFO - Avg time / step: 1.739s
2025-06-17 23:24:13,167 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCE_BiomedBERT-abs_fold-4
2025-06-17 23:24:13,168 - INFO - On test Set (with threshold 0.5) : 
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 23:24:16,459 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.79s/it]
2025-06-17 23:24:16,463 - INFO - Raw predictions shape: (79, 1)
2025-06-17 23:24:16,463 - INFO - Raw predictions: [[2.6976988]
 [3.154275 ]
 [2.8241901]
 [3.1328022]
 [2.7570977]
 [1.3459584]
 [1.1098495]
 [1.9488069]
 [2.9885042]
 [2.2633991]]
2025-06-17 23:24:16,463 - INFO - Scores shape: (79,)
2025-06-17 23:24:16,463 - INFO - Scores: [0.93689066 0.9590769  0.94396913 0.9582257  0.9403129  0.79346806
 0.75210106 0.8753165  0.95205206 0.90580004]
2025-06-17 23:24:16,463 - INFO - Preds shape: (79,)
2025-06-17 23:24:16,463 - INFO - Preds: [1 1 1 1 1 1 1 1 1 1]
2025-06-17 23:24:16,464 - INFO - Test labels shape: (79,)
2025-06-17 23:24:16,464 - INFO - Test labels: [0, 1, 0, 1, 1, 0, 0, 1, 1, 1]
2025-06-17 23:24:16,464 - INFO - Test split: Dataset({
    features: ['Unnamed: 0', 'title', 'abstract', 'Keywords', 'doi', 'labels'],
    num_rows: 79
})
2025-06-17 23:24:16,464 - INFO - Unique values in predictions: [1]
2025-06-17 23:24:16,464 - INFO - Unique values in labels: [0 1]
2025-06-17 23:24:16,465 - INFO - Confusion matrix:
[[ 0 21]
 [ 0 58]]
2025-06-17 23:24:16,466 - INFO - Confusion matrix: TN=0, FP=21, FN=0, TP=58
2025-06-17 23:24:19,332 - INFO - Metrics: {'f1': 0.8467153284671532, 'recall': 1.0, 'precision': 0.7341772151898734, 'accuracy': 0.7341772151898734, 'AP': 0.8711835559186255, 'MCC': 0.0, 'NDCG': 0.9726666229761312, 'kappa': 0.0, 'TN': 0, 'FP': 21, 'FN': 0, 'TP': 58}
2025-06-17 23:24:19,442 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-17 23:24:19,533 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 23:24:19,533 - INFO - 
On test Set (optimal threshold of 0.9434914588928223 according to cross validation on the training set): 
2025-06-17 23:24:19,534 - INFO - Confusion matrix: TN=17, FP=4, FN=34, TP=24
2025-06-17 23:24:22,252 - INFO - Metrics: {'f1': 0.5581395348837209, 'recall': 0.41379310344827586, 'precision': 0.8571428571428571, 'accuracy': 0.5189873417721519, 'AP': 0.8711835559186255, 'MCC': 0.206243920763318, 'NDCG': 0.9726666229761312, 'kappa': 0.15341229554427516, 'TN': 17, 'FP': 4, 'FN': 34, 'TP': 24}
2025-06-17 23:24:22,349 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 23:24:22,350 - INFO - Results for fold 4 : [{'f1': 0.5581395348837209, 'recall': 0.41379310344827586, 'precision': 0.8571428571428571, 'accuracy': 0.5189873417721519, 'AP': 0.8711835559186255, 'MCC': 0.206243920763318, 'NDCG': 0.9726666229761312, 'kappa': 0.15341229554427516, 'TN': 17, 'FP': 4, 'FN': 34, 'TP': 24}]
2025-06-17 23:24:22,668 - INFO - Cleared CUDA cache. Memory allocated: 1.33 GB, Memory reserved: 1.63 GB
2025-06-17 23:24:22,673 - INFO - Metrics stored successfully at /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/metrics/binary_metrics.csv
Model: microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext
2025-06-17 23:24:29,952 - INFO - Namespace(config='configs/hpo.yaml', fold=3, run=0, gpu=None, model_name='microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext', nb_opt_negs=100, n_trials=3, hpo_metric=None, direction=None, loss='BCE', with_title=True, with_keywords=False)
2025-06-17 23:24:29,954 - INFO - {'model_name': 'google-bert/bert-base-uncased', 'num_trials': 20, 'fold': 0, 'hpo_metric': 'eval_kappa', 'direction': 'max', 'loss_type': 'BCE', 'with_title': True, 'with_keywords': False, 'nb_optional_negs': 100}
2025-06-17 23:24:30,356 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
2025-06-17 23:24:30,356 - INFO - 
fold number 4 | run no. 1
2025-06-17 23:24:30,965 - INFO - train split size : 338
2025-06-17 23:24:30,965 - INFO - dev split size : 80
2025-06-17 23:24:30,965 - INFO - test split size : 79
2025-06-17 23:24:31,204 - INFO - 3 datasets tokenized successfully
2025-06-17 23:24:31,262 - INFO - Fold 4 max seq len = 512
2025-06-17 23:24:31,263 - INFO - Starting hyperparameter search for BCE loss
2025-06-17 23:24:32,601	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
2025-06-17 23:24:33,311	INFO tune.py:253 -- Initializing Ray automatically. For cluster usage or custom Ray initialization, call `ray.init(...)` before `tune.run(...)`.
[36m(trainable pid=200882)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=200882)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=200882)[0m 2025-06-17 23:24:41,685 - INFO - pos_weight value in TrainingArguments : 6.828424226204718
[36m(trainable pid=200882)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=200882)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=201080)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=201080)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=201080)[0m 2025-06-17 23:24:47,983 - INFO - pos_weight value in TrainingArguments : 6.094080202241274
[36m(trainable pid=201080)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=201080)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=201378)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=201378)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=201378)[0m 2025-06-17 23:24:54,151 - INFO - pos_weight value in TrainingArguments : 7.183206941666034
[36m(trainable pid=201378)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=201378)[0m   super().__init__(*args, **kwargs)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     trainable_2025-06-17_23-24-33   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-24-33
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-17_23-24-31_283907_198344/artifacts/2025-06-17_23-24-33/trainable_2025-06-17_23-24-33/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-17 23:24:34. Total running time: 0s
Logical resource usage: 0/32 CPUs, 0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_022626f3   PENDING         6.82842       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_022626f3 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_022626f3 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          6.82842 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=200882)[0m [2025-06-17 23:24:41,916] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=200882)[0m [2025-06-17 23:24:44,519] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=200882)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial trainable_e5b3c1a6 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_e5b3c1a6 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          6.09408 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=201080)[0m [2025-06-17 23:24:48,390] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=201080)[0m [2025-06-17 23:24:51,235] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=201080)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=200882)[0m {'loss': 2.7539, 'grad_norm': 20.908845901489258, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}

Trial trainable_53f0f61b started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_53f0f61b config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          7.18321 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=201378)[0m [2025-06-17 23:24:54,372] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=201378)[0m [2025-06-17 23:24:56,918] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=201378)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=201378)[0m {'loss': 1.5831, 'grad_norm': 5.48882532119751, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}

Trial status: 3 RUNNING
Current time: 2025-06-17 23:25:04. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_022626f3   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ trainable_e5b3c1a6   RUNNING         6.09408       4.55539e-06         0.123031                    5 â”‚
â”‚ trainable_53f0f61b   RUNNING         7.18321       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=201378)[0m 2025-06-17 23:25:20,379 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=201378)[0m 2025-06-17 23:25:20,385 - INFO - eval_result: {'eval_loss': 0.9115558862686157, 'eval_f1': 0.8529411764705882, 'eval_accuracy': 0.75, 'eval_kappa': 0.10813823857302107, 'eval_precision': 0.7532467532467533, 'eval_recall': 0.9830508474576272, 'eval_optim_threshold': 0.9649426341056824, 'eval_AP': 0.9007059566728669, 'eval_MCC': 0.1813134790046414, 'eval_NDCG': 0.9744664880913024, 'eval_runtime': 3.33, 'eval_samples_per_second': 24.024, 'eval_steps_per_second': 1.201, 'epoch': 3.0}
2025-06-17 23:25:20,700 - INFO - Cleaning up trial 53f0f61b
2025-06-17 23:25:20,700 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-24-33/trainable_53f0f61b_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512_2025-06-17_23-24-47
[36m(trainable pid=201378)[0m 2025-06-17 23:25:20,680 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB

[36m(trainable pid=201378)[0m {'loss': 0.9298, 'grad_norm': 7.884504795074463, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}[32m [repeated 3x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(trainable pid=201378)[0m {'train_runtime': 19.8094, 'train_samples_per_second': 51.188, 'train_steps_per_second': 2.575, 'train_loss': 1.0991397745469038, 'epoch': 3.0}
[36m(trainable pid=201378)[0m STATE at ending of training  :  TrainerState(epoch=3.0, global_step=51, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=266792214693888.0, log_history=[{'loss': 1.5831, 'grad_norm': 5.48882532119751, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0, 'step': 17}, {'loss': 0.9298, 'grad_norm': 7.884504795074463, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0, 'step': 34}, {'loss': 0.7845, 'grad_norm': 4.283188819885254, 'learning_rate': 0.0, 'epoch': 3.0, 'step': 51}, {'train_runtime': 19.8094, 'train_samples_per_second': 51.188, 'train_steps_per_second': 2.575, 'total_flos': 266792214693888.0, 'train_loss': 1.0991397745469038, 'epoch': 3.0, 'step': 51}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=201378)[0m {'loss': 0.7845, 'grad_norm': 4.283188819885254, 'learning_rate': 0.0, 'epoch': 3.0}
[36m(trainable pid=201378)[0m {'eval_loss': 0.9115558862686157, 'eval_f1': 0.8529411764705882, 'eval_accuracy': 0.75, 'eval_kappa': 0.10813823857302107, 'eval_precision': 0.7532467532467533, 'eval_recall': 0.9830508474576272, 'eval_optim_threshold': 0.9649426341056824, 'eval_AP': 0.9007059566728669, 'eval_MCC': 0.1813134790046414, 'eval_NDCG': 0.9744664880913024, 'eval_runtime': 3.33, 'eval_samples_per_second': 24.024, 'eval_steps_per_second': 1.201, 'epoch': 3.0}

Trial trainable_53f0f61b finished iteration 1 at 2025-06-17 23:25:20. Total running time: 46s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_53f0f61b result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    27.3918 â”‚
â”‚ time_total_s                        27.3918 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     3 â”‚
â”‚ eval_AP                             0.90071 â”‚
â”‚ eval_MCC                            0.18131 â”‚
â”‚ eval_NDCG                           0.97447 â”‚
â”‚ eval_accuracy                          0.75 â”‚
â”‚ eval_f1                             0.85294 â”‚
â”‚ eval_kappa                          0.10814 â”‚
â”‚ eval_loss                           0.91156 â”‚
â”‚ eval_optim_threshold                0.96494 â”‚
â”‚ eval_precision                      0.75325 â”‚
â”‚ eval_recall                         0.98305 â”‚
â”‚ eval_runtime                           3.33 â”‚
â”‚ eval_samples_per_second              24.024 â”‚
â”‚ eval_steps_per_second                 1.201 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_53f0f61b completed after 1 iterations at 2025-06-17 23:25:20. Total running time: 46s
[36m(trainable pid=200882)[0m {'loss': 1.8048, 'grad_norm': 11.937565803527832, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0}

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 23:25:34. Total running time: 1min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_022626f3   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_e5b3c1a6   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_53f0f61b   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.3918      0.911556    0.852941              0.75       0.108138 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=200882)[0m {'loss': 1.6237, 'grad_norm': 15.418739318847656, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0}[32m [repeated 2x across cluster][0m
[36m(trainable pid=200882)[0m {'loss': 1.5499, 'grad_norm': 12.990215301513672, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0}[32m [repeated 2x across cluster][0m
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 23:26:04. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_022626f3   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_e5b3c1a6   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_53f0f61b   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.3918      0.911556    0.852941              0.75       0.108138 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=200882)[0m 2025-06-17 23:26:11,330 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=200882)[0m 2025-06-17 23:26:11,337 - INFO - eval_result: {'eval_loss': 1.5200430154800415, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.7632166147232056, 'eval_AP': 0.7425396262446087, 'eval_MCC': 0.0, 'eval_NDCG': 0.9249461392270072, 'eval_runtime': 3.954, 'eval_samples_per_second': 20.232, 'eval_steps_per_second': 1.012, 'epoch': 6.0}
[36m(trainable pid=201080)[0m 2025-06-17 23:26:11,665 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=201080)[0m 2025-06-17 23:26:11,671 - INFO - eval_result: {'eval_loss': 1.0951751470565796, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8996524810791016, 'eval_AP': 0.7533293554265037, 'eval_MCC': 0.0, 'eval_NDCG': 0.9254608499800145, 'eval_runtime': 3.7109, 'eval_samples_per_second': 21.558, 'eval_steps_per_second': 1.078, 'epoch': 5.0}
2025-06-17 23:26:11,792 - INFO - Cleaning up trial 022626f3
2025-06-17 23:26:11,792 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-24-33/trainable_022626f3_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-17_23-24-34
2025-06-17 23:26:11,792 - INFO - Current best: 53f0f61b with eval_kappa : 0.10813823857302107 at iteration 1
[36m(trainable pid=200882)[0m 2025-06-17 23:26:11,771 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
2025-06-17 23:26:12,135 - INFO - Cleaning up trial e5b3c1a6
2025-06-17 23:26:12,135 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-24-33/trainable_e5b3c1a6_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-17_23-24-40
2025-06-17 23:26:12,135 - INFO - Cleaning up trial 022626f3
2025-06-17 23:26:12,135 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-24-33/trainable_022626f3_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-17_23-24-34
2025-06-17 23:26:12,135 - INFO - Current best: 53f0f61b with eval_kappa : 0.10813823857302107 at iteration 1
2025-06-17 23:26:12,143	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-24-33' in 0.0060s.

[36m(trainable pid=200882)[0m {'train_runtime': 82.5185, 'train_samples_per_second': 24.576, 'train_steps_per_second': 1.236, 'train_loss': 1.8974031934551163, 'epoch': 6.0}
[36m(trainable pid=200882)[0m STATE at ending of training  :  TrainerState(epoch=6.0, global_step=102, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=533584429387776.0, log_history=[{'loss': 2.7539, 'grad_norm': 20.908845901489258, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0, 'step': 17}, {'loss': 2.1374, 'grad_norm': 19.08209991455078, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0, 'step': 34}, {'loss': 1.8048, 'grad_norm': 11.937565803527832, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0, 'step': 51}, {'loss': 1.6237, 'grad_norm': 15.418739318847656, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0, 'step': 68}, {'loss': 1.5499, 'grad_norm': 12.990215301513672, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0, 'step': 85}, {'loss': 1.5148, 'grad_norm': 10.862077713012695, 'learning_rate': 0.0, 'epoch': 6.0, 'step': 102}, {'train_runtime': 82.5185, 'train_samples_per_second': 24.576, 'train_steps_per_second': 1.236, 'total_flos': 533584429387776.0, 'train_loss': 1.8974031934551163, 'epoch': 6.0, 'step': 102}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=200882)[0m {'loss': 1.5148, 'grad_norm': 10.862077713012695, 'learning_rate': 0.0, 'epoch': 6.0}[32m [repeated 2x across cluster][0m
[36m(trainable pid=201080)[0m STATE at ending of training  :  TrainerState(epoch=5.0, global_step=85, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=444653691156480.0, log_history=[{'loss': 2.1348, 'grad_norm': 9.171675682067871, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0, 'step': 17}, {'loss': 1.3439, 'grad_norm': 9.809164047241211, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0, 'step': 34}, {'loss': 1.1664, 'grad_norm': 12.298019409179688, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0, 'step': 51}, {'loss': 1.0785, 'grad_norm': 8.358567237854004, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0, 'step': 68}, {'loss': 1.0303, 'grad_norm': 6.522615909576416, 'learning_rate': 0.0, 'epoch': 5.0, 'step': 85}, {'train_runtime': 76.2516, 'train_samples_per_second': 22.163, 'train_steps_per_second': 1.115, 'total_flos': 444653691156480.0, 'train_loss': 1.3507694693172678, 'epoch': 5.0, 'step': 85}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=200882)[0m {'eval_loss': 1.5200430154800415, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.7632166147232056, 'eval_AP': 0.7425396262446087, 'eval_MCC': 0.0, 'eval_NDCG': 0.9249461392270072, 'eval_runtime': 3.954, 'eval_samples_per_second': 20.232, 'eval_steps_per_second': 1.012, 'epoch': 6.0}

Trial trainable_022626f3 finished iteration 1 at 2025-06-17 23:26:11. Total running time: 1min 37s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_022626f3 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    90.9793 â”‚
â”‚ time_total_s                        90.9793 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     6 â”‚
â”‚ eval_AP                             0.74254 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.92495 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.52004 â”‚
â”‚ eval_optim_threshold                0.76322 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                          3.954 â”‚
â”‚ eval_samples_per_second              20.232 â”‚
â”‚ eval_steps_per_second                 1.012 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_022626f3 completed after 1 iterations at 2025-06-17 23:26:11. Total running time: 1min 37s

Trial trainable_e5b3c1a6 finished iteration 1 at 2025-06-17 23:26:12. Total running time: 1min 37s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_e5b3c1a6 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    85.0343 â”‚
â”‚ time_total_s                        85.0343 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     5 â”‚
â”‚ eval_AP                             0.75333 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.92546 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.09518 â”‚
â”‚ eval_optim_threshold                0.89965 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.7109 â”‚
â”‚ eval_samples_per_second              21.558 â”‚
â”‚ eval_steps_per_second                 1.078 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_e5b3c1a6 completed after 1 iterations at 2025-06-17 23:26:12. Total running time: 1min 37s

Trial status: 3 TERMINATED
Current time: 2025-06-17 23:26:12. Total running time: 1min 37s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_022626f3   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1            90.9793      1.52004     0.848921            0.7375       0        â”‚
â”‚ trainable_e5b3c1a6   TERMINATED        6.09408       4.55539e-06         0.123031                    5        1            85.0343      1.09518     0.848921            0.7375       0        â”‚
â”‚ trainable_53f0f61b   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.3918      0.911556    0.852941            0.75         0.108138 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯2025-06-17 23:26:12,150 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x79751eae9a50>
2025-06-17 23:26:12,150 - INFO - Best trial : trainable_53f0f61b
2025-06-17 23:26:12,150 - INFO - Best config : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-17 23:26:12,150 - INFO - Best trial after optimization: {'eval_loss': 0.9115558862686157, 'eval_f1': 0.8529411764705882, 'eval_accuracy': 0.75, 'eval_kappa': 0.10813823857302107, 'eval_precision': 0.7532467532467533, 'eval_recall': 0.9830508474576272, 'eval_optim_threshold': 0.9649426341056824, 'eval_AP': 0.9007059566728669, 'eval_MCC': 0.1813134790046414, 'eval_NDCG': 0.9744664880913024, 'eval_runtime': 3.33, 'eval_samples_per_second': 24.024, 'eval_steps_per_second': 1.201, 'epoch': 3.0, 'timestamp': 1750195520, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '53f0f61b', 'date': '2025-06-17_23-25-20', 'time_this_iter_s': 27.391762733459473, 'time_total_s': 27.391762733459473, 'pid': 201378, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 27.391762733459473, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512'}
2025-06-17 23:26:12,173 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   1.520043  0.848921  ...                        6  022626f3
1   1.095175  0.848921  ...                        5  e5b3c1a6
2   0.911556  0.852941  ...                        3  53f0f61b

[3 rows x 32 columns]
2025-06-17 23:26:12,314 - INFO - Trial comparison plot saved
2025-06-17 23:26:12,326 - INFO - Best Hyperparameters after HPO : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}


[36m(trainable pid=201080)[0m 2025-06-17 23:26:12,113 - INFO - Cleared CUDA cache. Memory allocated: 1.35 GB, Memory reserved: 1.59 GB
[36m(trainable pid=201080)[0m {'train_runtime': 76.2516, 'train_samples_per_second': 22.163, 'train_steps_per_second': 1.115, 'train_loss': 1.3507694693172678, 'epoch': 5.0}
[36m(trainable pid=201080)[0m {'loss': 1.0303, 'grad_norm': 6.522615909576416, 'learning_rate': 0.0, 'epoch': 5.0}
[36m(trainable pid=201080)[0m {'eval_loss': 1.0951751470565796, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8996524810791016, 'eval_AP': 0.7533293554265037, 'eval_MCC': 0.0, 'eval_NDCG': 0.9254608499800145, 'eval_runtime': 3.7109, 'eval_samples_per_second': 21.558, 'eval_steps_per_second': 1.078, 'epoch': 5.0}
2025-06-17 23:26:21,290 - INFO - Namespace(config='configs/train.yaml', hp_config='configs/best_hpo.yaml', fold=3, run=0, gpu='2', model_name='microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext', nb_opt_negs=100, loss='BCE', with_title=True, with_keywords=False, best_metric=None)
2025-06-17 23:26:21,292 - INFO - {'model_name': 'bert-base-uncased', 'fold': 0, 'run': 0, 'output_dir': 'outputs/checkpoints', 'best_metric': 'eval_kappa', 'loss_type': 'BCE', 'nb_optional_negs': 100, 'with_title': True, 'with_keywords': False, 'default_hyperparameters': {'learning_rate': 'None', 'num_train_epochs': 'None', 'pos_weight': 'None', 'weight_decay': 'None'}}
2025-06-17 23:26:22,100 - INFO - train split size : 338
2025-06-17 23:26:22,100 - INFO - dev split size : 80
2025-06-17 23:26:22,100 - INFO - test split size : 79
2025-06-17 23:26:22,369 - INFO - 3 datasets tokenized successfully
2025-06-17 23:26:22,369 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-17 23:26:23,197 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
[2025-06-17 23:26:23,427] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-06-17 23:26:26,080] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
2025-06-17 23:26:26,115 - INFO - training size : 338
2025-06-17 23:26:26,115 - INFO - dev size : 80
2025-06-17 23:26:26,115 - INFO - test size : 79
  0%|          | 0/12 [00:00<?, ?it/s]  8%|â–Š         | 1/12 [00:02<00:25,  2.36s/it] 17%|â–ˆâ–‹        | 2/12 [00:04<00:20,  2.05s/it] 25%|â–ˆâ–ˆâ–Œ       | 3/12 [00:05<00:17,  1.92s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [00:06<00:11,  1.44s/it]                                               33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [00:06<00:11,  1.44s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 5/12 [00:08<00:11,  1.61s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 6/12 [00:10<00:10,  1.68s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 7/12 [00:12<00:08,  1.71s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [00:12<00:05,  1.39s/it]                                               67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [00:12<00:05,  1.39s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 9/12 [00:14<00:04,  1.55s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 10/12 [00:16<00:03,  1.63s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 11/12 [00:18<00:01,  1.68s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:19<00:00,  1.38s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:20<00:00,  1.38s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:20<00:00,  1.38s/it]2025-06-17 23:26:47,341 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:20<00:00,  1.75s/it]
{'loss': 1.8115, 'grad_norm': 3.780475616455078, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
{'loss': 1.323, 'grad_norm': 5.317643642425537, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
{'loss': 1.1343, 'grad_norm': 5.922591686248779, 'learning_rate': 0.0, 'epoch': 3.0}
{'train_runtime': 20.9456, 'train_samples_per_second': 48.411, 'train_steps_per_second': 0.573, 'train_loss': 1.4229684670766194, 'epoch': 3.0}
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 23:26:50,721 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.87s/it]
2025-06-17 23:26:50,728 - INFO - Training time : 28.358491134946235
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 23:26:53,988 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.75s/it]
2025-06-17 23:26:53,993 - INFO - Evaluation time : 3.2646746990503743
2025-06-17 23:26:53,993 - INFO - Evaluation results on test set: {'eval_loss': 1.0588499307632446, 'eval_f1': 0.8467153284671532, 'eval_accuracy': 0.7341772151898734, 'eval_kappa': 0.0, 'eval_precision': 0.7341772151898734, 'eval_recall': 1.0, 'eval_optim_threshold': 0.9477519989013672, 'eval_AP': 0.8574966677790832, 'eval_MCC': 0.0, 'eval_NDCG': 0.967734934894462, 'eval_runtime': 3.2525, 'eval_samples_per_second': 24.289, 'eval_steps_per_second': 0.307, 'epoch': 3.0}
2025-06-17 23:26:53,993 - INFO - Total updates (optimizer steps): 12
2025-06-17 23:26:53,993 - INFO - Avg time / step: 1.745s
2025-06-17 23:26:54,702 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCE_BiomedBERT-abs-ft_fold-4
2025-06-17 23:26:54,702 - INFO - On test Set (with threshold 0.5) : 
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 23:26:57,960 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.75s/it]
2025-06-17 23:26:57,964 - INFO - Raw predictions shape: (79, 1)
2025-06-17 23:26:57,964 - INFO - Raw predictions: [[2.547837 ]
 [3.0474916]
 [2.994231 ]
 [3.0711162]
 [2.6402488]
 [2.4413886]
 [2.1662025]
 [2.8980904]
 [2.907806 ]
 [2.9169238]]
2025-06-17 23:26:57,964 - INFO - Scores shape: (79,)
2025-06-17 23:26:57,964 - INFO - Scores: [0.92742807 0.9546741  0.95231277 0.9556855  0.9334074  0.9199294
 0.8971732  0.947752   0.948231   0.94867676]
2025-06-17 23:26:57,965 - INFO - Preds shape: (79,)
2025-06-17 23:26:57,965 - INFO - Preds: [1 1 1 1 1 1 1 1 1 1]
2025-06-17 23:26:57,965 - INFO - Test labels shape: (79,)
2025-06-17 23:26:57,965 - INFO - Test labels: [0, 1, 0, 1, 1, 0, 0, 1, 1, 1]
2025-06-17 23:26:57,965 - INFO - Test split: Dataset({
    features: ['Unnamed: 0', 'title', 'abstract', 'Keywords', 'doi', 'labels'],
    num_rows: 79
})
2025-06-17 23:26:57,965 - INFO - Unique values in predictions: [1]
2025-06-17 23:26:57,965 - INFO - Unique values in labels: [0 1]
2025-06-17 23:26:57,966 - INFO - Confusion matrix:
[[ 0 21]
 [ 0 58]]
2025-06-17 23:26:57,967 - INFO - Confusion matrix: TN=0, FP=21, FN=0, TP=58
2025-06-17 23:27:00,764 - INFO - Metrics: {'f1': 0.8467153284671532, 'recall': 1.0, 'precision': 0.7341772151898734, 'accuracy': 0.7341772151898734, 'AP': 0.8574966677790832, 'MCC': 0.0, 'NDCG': 0.967734934894462, 'kappa': 0.0, 'TN': 0, 'FP': 21, 'FN': 0, 'TP': 58}
2025-06-17 23:27:00,878 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-17 23:27:00,972 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 23:27:00,972 - INFO - 
On test Set (optimal threshold of 0.9462242126464844 according to cross validation on the training set): 
2025-06-17 23:27:00,973 - INFO - Confusion matrix: TN=18, FP=3, FN=32, TP=26
2025-06-17 23:27:03,870 - INFO - Metrics: {'f1': 0.5977011494252874, 'recall': 0.4482758620689655, 'precision': 0.896551724137931, 'accuracy': 0.5569620253164557, 'AP': 0.8574966677790832, 'MCC': 0.27992087988892816, 'NDCG': 0.967734934894462, 'kappa': 0.2120262182958107, 'TN': 18, 'FP': 3, 'FN': 32, 'TP': 26}
2025-06-17 23:27:03,963 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 23:27:03,963 - INFO - Results for fold 4 : [{'f1': 0.5977011494252874, 'recall': 0.4482758620689655, 'precision': 0.896551724137931, 'accuracy': 0.5569620253164557, 'AP': 0.8574966677790832, 'MCC': 0.27992087988892816, 'NDCG': 0.967734934894462, 'kappa': 0.2120262182958107, 'TN': 18, 'FP': 3, 'FN': 32, 'TP': 26}]
2025-06-17 23:27:04,290 - INFO - Cleared CUDA cache. Memory allocated: 1.33 GB, Memory reserved: 1.63 GB
2025-06-17 23:27:04,295 - INFO - Metrics stored successfully at /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/metrics/binary_metrics.csv
Model: FacebookAI/roberta-base
2025-06-17 23:27:11,483 - INFO - Namespace(config='configs/hpo.yaml', fold=3, run=0, gpu=None, model_name='FacebookAI/roberta-base', nb_opt_negs=100, n_trials=3, hpo_metric=None, direction=None, loss='BCE', with_title=True, with_keywords=False)
2025-06-17 23:27:11,484 - INFO - {'model_name': 'google-bert/bert-base-uncased', 'num_trials': 20, 'fold': 0, 'hpo_metric': 'eval_kappa', 'direction': 'max', 'loss_type': 'BCE', 'with_title': True, 'with_keywords': False, 'nb_optional_negs': 100}
2025-06-17 23:27:11,977 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
2025-06-17 23:27:11,978 - INFO - 
fold number 4 | run no. 1
2025-06-17 23:27:12,578 - INFO - train split size : 338
2025-06-17 23:27:12,579 - INFO - dev split size : 80
2025-06-17 23:27:12,579 - INFO - test split size : 79
2025-06-17 23:27:12,873 - INFO - 3 datasets tokenized successfully
2025-06-17 23:27:12,934 - INFO - Fold 4 max seq len = 512
2025-06-17 23:27:12,935 - INFO - Starting hyperparameter search for BCE loss
2025-06-17 23:27:14,274	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
2025-06-17 23:27:15,004	INFO tune.py:253 -- Initializing Ray automatically. For cluster usage or custom Ray initialization, call `ray.init(...)` before `tune.run(...)`.
[36m(trainable pid=206138)[0m Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at FacebookAI/roberta-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
[36m(trainable pid=206138)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=206138)[0m 2025-06-17 23:27:23,373 - INFO - pos_weight value in TrainingArguments : 6.828424226204718
[36m(trainable pid=206138)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=206138)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=206579)[0m Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at FacebookAI/roberta-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
[36m(trainable pid=206579)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=206579)[0m 2025-06-17 23:27:29,913 - INFO - pos_weight value in TrainingArguments : 6.094080202241274
[36m(trainable pid=206579)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=206579)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=207119)[0m Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at FacebookAI/roberta-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
[36m(trainable pid=207119)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=207119)[0m 2025-06-17 23:27:36,303 - INFO - pos_weight value in TrainingArguments : 7.183206941666034
[36m(trainable pid=207119)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=207119)[0m   super().__init__(*args, **kwargs)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     trainable_2025-06-17_23-27-15   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-27-15
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-17_23-27-12_957041_203482/artifacts/2025-06-17_23-27-15/trainable_2025-06-17_23-27-15/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-17 23:27:16. Total running time: 0s
Logical resource usage: 0/32 CPUs, 0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_dd241b12   PENDING         6.82842       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_dd241b12 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_dd241b12 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          6.82842 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=206138)[0m [2025-06-17 23:27:23,633] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=206138)[0m [2025-06-17 23:27:26,351] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=206138)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial trainable_b6832633 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_b6832633 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          6.09408 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=206579)[0m [2025-06-17 23:27:30,295] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=206579)[0m [2025-06-17 23:27:32,854] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=206579)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=206138)[0m {'loss': 2.7225, 'grad_norm': 9.157387733459473, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}

Trial trainable_b53497be started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_b53497be config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          7.18321 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=207119)[0m [2025-06-17 23:27:36,549] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=207119)[0m [2025-06-17 23:27:39,142] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=207119)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 3 RUNNING
Current time: 2025-06-17 23:27:46. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_dd241b12   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ trainable_b6832633   RUNNING         6.09408       4.55539e-06         0.123031                    5 â”‚
â”‚ trainable_b53497be   RUNNING         7.18321       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=207119)[0m 2025-06-17 23:28:02,695 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=207119)[0m 2025-06-17 23:28:02,701 - INFO - eval_result: {'eval_loss': 0.7201312184333801, 'eval_f1': 0.8656716417910447, 'eval_accuracy': 0.775, 'eval_kappa': 0.22994652406417115, 'eval_precision': 0.7733333333333333, 'eval_recall': 0.9830508474576272, 'eval_optim_threshold': 0.9351738691329956, 'eval_AP': 0.9778435528356655, 'eval_MCC': 0.3154185078305574, 'eval_NDCG': 0.9959032133779037, 'eval_runtime': 3.2958, 'eval_samples_per_second': 24.273, 'eval_steps_per_second': 1.214, 'epoch': 3.0}
2025-06-17 23:28:03,139 - INFO - Cleaning up trial b53497be
2025-06-17 23:28:03,139 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-27-15/trainable_b53497be_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512_2025-06-17_23-27-29
[36m(trainable pid=207119)[0m 2025-06-17 23:28:03,109 - INFO - Cleared CUDA cache. Memory allocated: 1.54 GB, Memory reserved: 1.71 GB
[36m(trainable pid=207119)[0m /home/leandre/.local/share/uv/python/cpython-3.11.11-linux-x86_64-gnu/lib/python3.11/multiprocessing/resource_tracker.py:123: UserWarning: resource_tracker: process died unexpectedly, relaunching.  Some resources might leak.
[36m(trainable pid=207119)[0m   warnings.warn('resource_tracker: process died unexpectedly, '
[36m(trainable pid=207119)[0m Traceback (most recent call last):
[36m(trainable pid=207119)[0m   File "/home/leandre/.local/share/uv/python/cpython-3.11.11-linux-x86_64-gnu/lib/python3.11/multiprocessing/resource_tracker.py", line 239, in main
[36m(trainable pid=207119)[0m     cache[rtype].remove(name)
[36m(trainable pid=207119)[0m KeyError: '/loky-207119-8276nywu'

[36m(trainable pid=207119)[0m {'loss': 1.6066, 'grad_norm': 7.232330799102783, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
[36m(trainable pid=207119)[0m {'loss': 1.1106, 'grad_norm': 15.608930587768555, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}[32m [repeated 3x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(trainable pid=207119)[0m {'train_runtime': 19.8181, 'train_samples_per_second': 51.165, 'train_steps_per_second': 2.573, 'train_loss': 1.1174607744403915, 'epoch': 3.0}
[36m(trainable pid=207119)[0m STATE at ending of training  :  TrainerState(epoch=3.0, global_step=51, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=266792214693888.0, log_history=[{'loss': 1.6066, 'grad_norm': 7.232330799102783, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0, 'step': 17}, {'loss': 1.1106, 'grad_norm': 15.608930587768555, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0, 'step': 34}, {'loss': 0.6352, 'grad_norm': 15.210437774658203, 'learning_rate': 0.0, 'epoch': 3.0, 'step': 51}, {'train_runtime': 19.8181, 'train_samples_per_second': 51.165, 'train_steps_per_second': 2.573, 'total_flos': 266792214693888.0, 'train_loss': 1.1174607744403915, 'epoch': 3.0, 'step': 51}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=207119)[0m {'loss': 0.6352, 'grad_norm': 15.210437774658203, 'learning_rate': 0.0, 'epoch': 3.0}
[36m(trainable pid=207119)[0m {'eval_loss': 0.7201312184333801, 'eval_f1': 0.8656716417910447, 'eval_accuracy': 0.775, 'eval_kappa': 0.22994652406417115, 'eval_precision': 0.7733333333333333, 'eval_recall': 0.9830508474576272, 'eval_optim_threshold': 0.9351738691329956, 'eval_AP': 0.9778435528356655, 'eval_MCC': 0.3154185078305574, 'eval_NDCG': 0.9959032133779037, 'eval_runtime': 3.2958, 'eval_samples_per_second': 24.273, 'eval_steps_per_second': 1.214, 'epoch': 3.0}

Trial trainable_b53497be finished iteration 1 at 2025-06-17 23:28:03. Total running time: 47s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_b53497be result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                     27.684 â”‚
â”‚ time_total_s                         27.684 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     3 â”‚
â”‚ eval_AP                             0.97784 â”‚
â”‚ eval_MCC                            0.31542 â”‚
â”‚ eval_NDCG                            0.9959 â”‚
â”‚ eval_accuracy                         0.775 â”‚
â”‚ eval_f1                             0.86567 â”‚
â”‚ eval_kappa                          0.22995 â”‚
â”‚ eval_loss                           0.72013 â”‚
â”‚ eval_optim_threshold                0.93517 â”‚
â”‚ eval_precision                      0.77333 â”‚
â”‚ eval_recall                         0.98305 â”‚
â”‚ eval_runtime                         3.2958 â”‚
â”‚ eval_samples_per_second              24.273 â”‚
â”‚ eval_steps_per_second                 1.214 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_b53497be completed after 1 iterations at 2025-06-17 23:28:03. Total running time: 47s
[36m(trainable pid=206579)[0m {'loss': 1.9534, 'grad_norm': 14.051519393920898, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0}

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 23:28:16. Total running time: 1min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_dd241b12   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_b6832633   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_b53497be   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1             27.684      0.720131    0.865672             0.775       0.229947 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=206138)[0m {'loss': 2.3693, 'grad_norm': 18.323028564453125, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0}[32m [repeated 2x across cluster][0m
[36m(trainable pid=206138)[0m {'loss': 2.2803, 'grad_norm': 16.243640899658203, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0}[32m [repeated 2x across cluster][0m
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-17 23:28:46. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_dd241b12   RUNNING           6.82842       1.49561e-06         0.13641                     6                                                                                        â”‚
â”‚ trainable_b6832633   RUNNING           6.09408       4.55539e-06         0.123031                    5                                                                                        â”‚
â”‚ trainable_b53497be   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1             27.684      0.720131    0.865672             0.775       0.229947 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(trainable pid=206138)[0m 2025-06-17 23:28:54,233 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=206138)[0m 2025-06-17 23:28:54,239 - INFO - eval_result: {'eval_loss': 2.8444018363952637, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.5890770554542542, 'eval_AP': 0.710269687598186, 'eval_MCC': 0.0, 'eval_NDCG': 0.9044024759986893, 'eval_runtime': 3.9293, 'eval_samples_per_second': 20.36, 'eval_steps_per_second': 1.018, 'epoch': 6.0}
[36m(trainable pid=206579)[0m 2025-06-17 23:28:54,455 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(trainable pid=206579)[0m 2025-06-17 23:28:54,460 - INFO - eval_result: {'eval_loss': 1.1165603399276733, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8805559873580933, 'eval_AP': 0.8535341257062059, 'eval_MCC': 0.0, 'eval_NDCG': 0.9634234492733147, 'eval_runtime': 4.1612, 'eval_samples_per_second': 19.225, 'eval_steps_per_second': 0.961, 'epoch': 5.0}
[36m(trainable pid=206138)[0m 2025-06-17 23:28:54,558 - INFO - Cleared CUDA cache. Memory allocated: 1.54 GB, Memory reserved: 1.71 GB
2025-06-17 23:28:54,586 - INFO - Cleaning up trial dd241b12
2025-06-17 23:28:54,586 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-27-15/trainable_dd241b12_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-17_23-27-16
2025-06-17 23:28:54,586 - INFO - Current best: b53497be with eval_kappa : 0.22994652406417115 at iteration 1
2025-06-17 23:28:54,876 - INFO - Cleaning up trial b6832633
2025-06-17 23:28:54,876 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-27-15/trainable_b6832633_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=6.0941,weight_decay=0.1230_2025-06-17_23-27-22
2025-06-17 23:28:54,877 - INFO - Cleaning up trial dd241b12
2025-06-17 23:28:54,877 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-27-15/trainable_dd241b12_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=6.8284,weight_decay=0.1364_2025-06-17_23-27-16
2025-06-17 23:28:54,877 - INFO - Current best: b53497be with eval_kappa : 0.22994652406417115 at iteration 1
2025-06-17 23:28:54,884	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-27-15' in 0.0059s.

[36m(trainable pid=206138)[0m {'train_runtime': 83.6198, 'train_samples_per_second': 24.253, 'train_steps_per_second': 1.22, 'train_loss': 2.4493089189716413, 'epoch': 6.0}
[36m(trainable pid=206138)[0m STATE at ending of training  :  TrainerState(epoch=6.0, global_step=102, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=533584429387776.0, log_history=[{'loss': 2.7225, 'grad_norm': 9.157387733459473, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0, 'step': 17}, {'loss': 2.6036, 'grad_norm': 13.939892768859863, 'learning_rate': 9.970711012282902e-07, 'epoch': 2.0, 'step': 34}, {'loss': 2.485, 'grad_norm': 12.778285026550293, 'learning_rate': 7.478033259212177e-07, 'epoch': 3.0, 'step': 51}, {'loss': 2.3693, 'grad_norm': 18.323028564453125, 'learning_rate': 4.985355506141451e-07, 'epoch': 4.0, 'step': 68}, {'loss': 2.2803, 'grad_norm': 16.243640899658203, 'learning_rate': 2.4926777530707256e-07, 'epoch': 5.0, 'step': 85}, {'loss': 2.2351, 'grad_norm': 14.521604537963867, 'learning_rate': 0.0, 'epoch': 6.0, 'step': 102}, {'train_runtime': 83.6198, 'train_samples_per_second': 24.253, 'train_steps_per_second': 1.22, 'total_flos': 533584429387776.0, 'train_loss': 2.4493089189716413, 'epoch': 6.0, 'step': 102}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=206138)[0m {'loss': 2.2351, 'grad_norm': 14.521604537963867, 'learning_rate': 0.0, 'epoch': 6.0}[32m [repeated 2x across cluster][0m
[36m(trainable pid=206579)[0m STATE at ending of training  :  TrainerState(epoch=5.0, global_step=85, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=444653691156480.0, log_history=[{'loss': 2.4041, 'grad_norm': 7.75844669342041, 'learning_rate': 3.6443132246884782e-06, 'epoch': 1.0, 'step': 17}, {'loss': 1.9534, 'grad_norm': 14.051519393920898, 'learning_rate': 2.7332349185163582e-06, 'epoch': 2.0, 'step': 34}, {'loss': 1.4926, 'grad_norm': 8.836758613586426, 'learning_rate': 1.8221566123442391e-06, 'epoch': 3.0, 'step': 51}, {'loss': 1.3387, 'grad_norm': 6.699579238891602, 'learning_rate': 9.110783061721196e-07, 'epoch': 4.0, 'step': 68}, {'loss': 1.3103, 'grad_norm': 5.941619873046875, 'learning_rate': 0.0, 'epoch': 5.0, 'step': 85}, {'train_runtime': 77.1088, 'train_samples_per_second': 21.917, 'train_steps_per_second': 1.102, 'total_flos': 444653691156480.0, 'train_loss': 1.6998403436997358, 'epoch': 5.0, 'step': 85}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=206138)[0m {'eval_loss': 2.8444018363952637, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.5890770554542542, 'eval_AP': 0.710269687598186, 'eval_MCC': 0.0, 'eval_NDCG': 0.9044024759986893, 'eval_runtime': 3.9293, 'eval_samples_per_second': 20.36, 'eval_steps_per_second': 1.018, 'epoch': 6.0}

Trial trainable_dd241b12 finished iteration 1 at 2025-06-17 23:28:54. Total running time: 1min 38s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_dd241b12 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    91.8377 â”‚
â”‚ time_total_s                        91.8377 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     6 â”‚
â”‚ eval_AP                             0.71027 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                            0.9044 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                            2.8444 â”‚
â”‚ eval_optim_threshold                0.58908 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.9293 â”‚
â”‚ eval_samples_per_second               20.36 â”‚
â”‚ eval_steps_per_second                 1.018 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_dd241b12 completed after 1 iterations at 2025-06-17 23:28:54. Total running time: 1min 38s

Trial trainable_b6832633 finished iteration 1 at 2025-06-17 23:28:54. Total running time: 1min 38s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_b6832633 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    85.6072 â”‚
â”‚ time_total_s                        85.6072 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                                     5 â”‚
â”‚ eval_AP                             0.85353 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.96342 â”‚
â”‚ eval_accuracy                        0.7375 â”‚
â”‚ eval_f1                             0.84892 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.11656 â”‚
â”‚ eval_optim_threshold                0.88056 â”‚
â”‚ eval_precision                       0.7375 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         4.1612 â”‚
â”‚ eval_samples_per_second              19.225 â”‚
â”‚ eval_steps_per_second                 0.961 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_b6832633 completed after 1 iterations at 2025-06-17 23:28:54. Total running time: 1min 38s

Trial status: 3 TERMINATED
Current time: 2025-06-17 23:28:54. Total running time: 1min 38s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_accuracy     eval_kappa â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_dd241b12   TERMINATED        6.82842       1.49561e-06         0.13641                     6        1            91.8377      2.8444      0.848921            0.7375       0        â”‚
â”‚ trainable_b6832633   TERMINATED        6.09408       4.55539e-06         0.123031                    5        1            85.6072      1.11656     0.848921            0.7375       0        â”‚
â”‚ trainable_b53497be   TERMINATED        7.18321       7.98818e-05         0.251217                    3        1            27.684       0.720131    0.865672            0.775        0.229947 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯2025-06-17 23:28:54,891 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x7bede021abd0>
2025-06-17 23:28:54,891 - INFO - Best trial : trainable_b53497be
2025-06-17 23:28:54,891 - INFO - Best config : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-17 23:28:54,891 - INFO - Best trial after optimization: {'eval_loss': 0.7201312184333801, 'eval_f1': 0.8656716417910447, 'eval_accuracy': 0.775, 'eval_kappa': 0.22994652406417115, 'eval_precision': 0.7733333333333333, 'eval_recall': 0.9830508474576272, 'eval_optim_threshold': 0.9351738691329956, 'eval_AP': 0.9778435528356655, 'eval_MCC': 0.3154185078305574, 'eval_NDCG': 0.9959032133779037, 'eval_runtime': 3.2958, 'eval_samples_per_second': 24.273, 'eval_steps_per_second': 1.214, 'epoch': 3.0, 'timestamp': 1750195683, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': 'b53497be', 'date': '2025-06-17_23-28-03', 'time_this_iter_s': 27.6840181350708, 'time_total_s': 27.6840181350708, 'pid': 207119, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 27.6840181350708, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=7.1832,weight_decay=0.2512'}
2025-06-17 23:28:54,913 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   2.844402  0.848921  ...                        6  dd241b12
1   1.116560  0.848921  ...                        5  b6832633
2   0.720131  0.865672  ...                        3  b53497be

[3 rows x 32 columns]
2025-06-17 23:28:55,067 - INFO - Trial comparison plot saved
2025-06-17 23:28:55,077 - INFO - Best Hyperparameters after HPO : {'pos_weight': 7.183206941666034, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}


[36m(trainable pid=206579)[0m 2025-06-17 23:28:54,843 - INFO - Cleared CUDA cache. Memory allocated: 1.54 GB, Memory reserved: 1.71 GB
[36m(trainable pid=206579)[0m {'train_runtime': 77.1088, 'train_samples_per_second': 21.917, 'train_steps_per_second': 1.102, 'train_loss': 1.6998403436997358, 'epoch': 5.0}
[36m(trainable pid=206579)[0m {'loss': 1.3103, 'grad_norm': 5.941619873046875, 'learning_rate': 0.0, 'epoch': 5.0}
[36m(trainable pid=206579)[0m {'eval_loss': 1.1165603399276733, 'eval_f1': 0.8489208633093526, 'eval_accuracy': 0.7375, 'eval_kappa': 0.0, 'eval_precision': 0.7375, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8805559873580933, 'eval_AP': 0.8535341257062059, 'eval_MCC': 0.0, 'eval_NDCG': 0.9634234492733147, 'eval_runtime': 4.1612, 'eval_samples_per_second': 19.225, 'eval_steps_per_second': 0.961, 'epoch': 5.0}
2025-06-17 23:29:04,206 - INFO - Namespace(config='configs/train.yaml', hp_config='configs/best_hpo.yaml', fold=3, run=0, gpu='2', model_name='FacebookAI/roberta-base', nb_opt_negs=100, loss='BCE', with_title=True, with_keywords=False, best_metric=None)
2025-06-17 23:29:04,208 - INFO - {'model_name': 'bert-base-uncased', 'fold': 0, 'run': 0, 'output_dir': 'outputs/checkpoints', 'best_metric': 'eval_kappa', 'loss_type': 'BCE', 'nb_optional_negs': 100, 'with_title': True, 'with_keywords': False, 'default_hyperparameters': {'learning_rate': 'None', 'num_train_epochs': 'None', 'pos_weight': 'None', 'weight_decay': 'None'}}
2025-06-17 23:29:05,132 - INFO - train split size : 338
2025-06-17 23:29:05,132 - INFO - dev split size : 80
2025-06-17 23:29:05,132 - INFO - test split size : 79
2025-06-17 23:29:05,437 - INFO - 3 datasets tokenized successfully
2025-06-17 23:29:05,437 - INFO - Final training...
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at FacebookAI/roberta-base and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-17 23:29:05,791 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
[2025-06-17 23:29:06,056] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-06-17 23:29:08,817] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
2025-06-17 23:29:08,854 - INFO - training size : 338
2025-06-17 23:29:08,855 - INFO - dev size : 80
2025-06-17 23:29:08,855 - INFO - test size : 79
  0%|          | 0/12 [00:00<?, ?it/s]  8%|â–Š         | 1/12 [00:02<00:24,  2.27s/it] 17%|â–ˆâ–‹        | 2/12 [00:04<00:19,  1.99s/it] 25%|â–ˆâ–ˆâ–Œ       | 3/12 [00:05<00:16,  1.89s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [00:06<00:11,  1.41s/it]                                               33%|â–ˆâ–ˆâ–ˆâ–Ž      | 4/12 [00:06<00:11,  1.41s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 5/12 [00:08<00:10,  1.57s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 6/12 [00:10<00:09,  1.65s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 7/12 [00:11<00:08,  1.69s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [00:12<00:05,  1.37s/it]                                               67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 8/12 [00:12<00:05,  1.37s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 9/12 [00:14<00:04,  1.52s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 10/12 [00:16<00:03,  1.60s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 11/12 [00:18<00:01,  1.65s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:18<00:00,  1.36s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:20<00:00,  1.36s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:20<00:00,  1.36s/it]2025-06-17 23:29:30,083 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 12/12 [00:20<00:00,  1.75s/it]
{'loss': 2.4508, 'grad_norm': 18.616052627563477, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
{'loss': 1.5246, 'grad_norm': 5.347322940826416, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
{'loss': 1.4084, 'grad_norm': 9.358240127563477, 'learning_rate': 0.0, 'epoch': 3.0}
{'train_runtime': 20.9488, 'train_samples_per_second': 48.404, 'train_steps_per_second': 0.573, 'train_loss': 1.7945836385091145, 'epoch': 3.0}
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 23:29:33,333 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.76s/it]
2025-06-17 23:29:33,339 - INFO - Training time : 27.901737539912574
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 23:29:36,583 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.75s/it]
2025-06-17 23:29:36,587 - INFO - Evaluation time : 3.2481042880099267
2025-06-17 23:29:36,587 - INFO - Evaluation results on test set: {'eval_loss': 1.4099475145339966, 'eval_f1': 0.8467153284671532, 'eval_accuracy': 0.7341772151898734, 'eval_kappa': 0.0, 'eval_precision': 0.7341772151898734, 'eval_recall': 1.0, 'eval_optim_threshold': 0.8657514452934265, 'eval_AP': 0.8105387314129701, 'eval_MCC': 0.0, 'eval_NDCG': 0.9548654073022478, 'eval_runtime': 3.2366, 'eval_samples_per_second': 24.408, 'eval_steps_per_second': 0.309, 'epoch': 3.0}
2025-06-17 23:29:36,587 - INFO - Total updates (optimizer steps): 12
2025-06-17 23:29:36,587 - INFO - Avg time / step: 1.745s
2025-06-17 23:29:37,439 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCE_roberta-base_fold-4
2025-06-17 23:29:37,439 - INFO - On test Set (with threshold 0.5) : 
  0%|          | 0/1 [00:00<?, ?it/s]2025-06-17 23:29:40,789 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.86s/it]
2025-06-17 23:29:40,793 - INFO - Raw predictions shape: (79, 1)
2025-06-17 23:29:40,793 - INFO - Raw predictions: [[1.8598413]
 [1.9354935]
 [1.8514454]
 [2.2115343]
 [1.517952 ]
 [1.5579095]
 [1.1175287]
 [1.5242879]
 [1.9996865]
 [1.7799346]]
2025-06-17 23:29:40,793 - INFO - Scores shape: (79,)
2025-06-17 23:29:40,793 - INFO - Scores: [0.8652784  0.8738562  0.86429673 0.9012805  0.8202367  0.8260532
 0.75353    0.821169   0.8807641  0.85568875]
2025-06-17 23:29:40,793 - INFO - Preds shape: (79,)
2025-06-17 23:29:40,793 - INFO - Preds: [1 1 1 1 1 1 1 1 1 1]
2025-06-17 23:29:40,794 - INFO - Test labels shape: (79,)
2025-06-17 23:29:40,794 - INFO - Test labels: [0, 1, 0, 1, 1, 0, 0, 1, 1, 1]
2025-06-17 23:29:40,794 - INFO - Test split: Dataset({
    features: ['Unnamed: 0', 'title', 'abstract', 'Keywords', 'doi', 'labels'],
    num_rows: 79
})
2025-06-17 23:29:40,794 - INFO - Unique values in predictions: [1]
2025-06-17 23:29:40,794 - INFO - Unique values in labels: [0 1]
2025-06-17 23:29:40,795 - INFO - Confusion matrix:
[[ 0 21]
 [ 0 58]]
2025-06-17 23:29:40,796 - INFO - Confusion matrix: TN=0, FP=21, FN=0, TP=58
2025-06-17 23:29:43,474 - INFO - Metrics: {'f1': 0.8467153284671532, 'recall': 1.0, 'precision': 0.7341772151898734, 'accuracy': 0.7341772151898734, 'AP': 0.8105387314129701, 'MCC': 0.0, 'NDCG': 0.9548654073022478, 'kappa': 0.0, 'TN': 0, 'FP': 21, 'FN': 0, 'TP': 58}
2025-06-17 23:29:43,586 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-17 23:29:43,682 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 23:29:43,682 - INFO - 
On test Set (optimal threshold of 0.87569260597229 according to cross validation on the training set): 
2025-06-17 23:29:43,683 - INFO - Confusion matrix: TN=18, FP=3, FN=43, TP=15
2025-06-17 23:29:46,416 - INFO - Metrics: {'f1': 0.39473684210526316, 'recall': 0.25862068965517243, 'precision': 0.8333333333333334, 'accuracy': 0.4177215189873418, 'AP': 0.8105387314129701, 'MCC': 0.12192543071234882, 'NDCG': 0.9548654073022478, 'kappa': 0.07201225740551587, 'TN': 18, 'FP': 3, 'FN': 43, 'TP': 15}
2025-06-17 23:29:46,511 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-17 23:29:46,511 - INFO - Results for fold 4 : [{'f1': 0.39473684210526316, 'recall': 0.25862068965517243, 'precision': 0.8333333333333334, 'accuracy': 0.4177215189873418, 'AP': 0.8105387314129701, 'MCC': 0.12192543071234882, 'NDCG': 0.9548654073022478, 'kappa': 0.07201225740551587, 'TN': 18, 'FP': 3, 'FN': 43, 'TP': 15}]
2025-06-17 23:29:46,834 - INFO - Cleared CUDA cache. Memory allocated: 1.52 GB, Memory reserved: 1.85 GB
2025-06-17 23:29:46,839 - INFO - Metrics stored successfully at /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/metrics/binary_metrics.csv
Model: dmis-lab/biobert-v1.1
2025-06-17 23:29:53,984 - INFO - Namespace(config='configs/hpo.yaml', fold=3, run=0, gpu=None, model_name='dmis-lab/biobert-v1.1', nb_opt_negs=100, n_trials=3, hpo_metric=None, direction=None, loss='BCE', with_title=True, with_keywords=False)
2025-06-17 23:29:53,985 - INFO - {'model_name': 'google-bert/bert-base-uncased', 'num_trials': 20, 'fold': 0, 'hpo_metric': 'eval_kappa', 'direction': 'max', 'loss_type': 'BCE', 'with_title': True, 'with_keywords': False, 'nb_optional_negs': 100}
2025-06-17 23:29:54,387 - INFO - Cleared CUDA cache. Memory allocated: 0.00 GB, Memory reserved: 0.00 GB
2025-06-17 23:29:54,387 - INFO - 
fold number 4 | run no. 1
2025-06-17 23:29:54,994 - INFO - train split size : 338
2025-06-17 23:29:54,994 - INFO - dev split size : 80
2025-06-17 23:29:54,994 - INFO - test split size : 79
2025-06-17 23:29:55,225 - INFO - 3 datasets tokenized successfully
2025-06-17 23:29:55,285 - INFO - Fold 4 max seq len = 512
2025-06-17 23:29:55,285 - INFO - Starting hyperparameter search for BCE loss
2025-06-17 23:29:56,685	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
2025-06-17 23:29:57,383	INFO tune.py:253 -- Initializing Ray automatically. For cluster usage or custom Ray initialization, call `ray.init(...)` before `tune.run(...)`.
[36m(trainable pid=211524)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=211524)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=211524)[0m 2025-06-17 23:30:05,827 - INFO - pos_weight value in TrainingArguments : 6.828424226204718
[36m(trainable pid=211524)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=211524)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=211726)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=211726)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=211726)[0m 2025-06-17 23:30:12,259 - INFO - pos_weight value in TrainingArguments : 6.094080202241274
[36m(trainable pid=211726)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=211726)[0m   super().__init__(*args, **kwargs)
[36m(trainable pid=212120)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(trainable pid=212120)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(trainable pid=212120)[0m 2025-06-17 23:30:18,666 - INFO - pos_weight value in TrainingArguments : 7.183206941666034
[36m(trainable pid=212120)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:112: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(trainable pid=212120)[0m   super().__init__(*args, **kwargs)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     trainable_2025-06-17_23-29-57   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/trainable_2025-06-17_23-29-57
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-17_23-29-55_306926_209085/artifacts/2025-06-17_23-29-57/trainable_2025-06-17_23-29-57/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-17 23:29:58. Total running time: 0s
Logical resource usage: 0/32 CPUs, 0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_d2ab9558   PENDING         6.82842       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial trainable_d2ab9558 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_d2ab9558 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          6.82842 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=211524)[0m [2025-06-17 23:30:06,075] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=211524)[0m [2025-06-17 23:30:08,934] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=211524)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=102, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial trainable_548e341d started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_548e341d config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          6.09408 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=211726)[0m [2025-06-17 23:30:12,615] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=211726)[0m [2025-06-17 23:30:15,389] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=211726)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=85, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(trainable pid=211524)[0m {'loss': 2.6639, 'grad_norm': 19.451221466064453, 'learning_rate': 1.246338876535363e-06, 'epoch': 1.0}

Trial trainable_f39ec22c started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial trainable_f39ec22c config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          7.18321 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(trainable pid=212120)[0m [2025-06-17 23:30:18,885] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(trainable pid=212120)[0m [2025-06-17 23:30:21,601] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
[36m(trainable pid=212120)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=51, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 3 RUNNING
Current time: 2025-06-17 23:30:28. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ trainable_d2ab9558   RUNNING         6.82842       1.49561e-06         0.13641                     6 â”‚
â”‚ trainable_548e341d   RUNNING         6.09408       4.55539e-06         0.123031                    5 â”‚
â”‚ trainable_f39ec22c   RUNNING         7.18321       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯