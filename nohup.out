2025-06-06 16:23:54,679	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
2025-06-06 16:23:55,355 - INFO - Random seeds set to 42
2025-06-06 16:23:55,457 - INFO - Optional negatives loaded from CSV with 5000 entries.
2025-06-06 16:23:55,457 - INFO - Loading original negatives...
2025-06-06 16:23:55,466 - INFO - Negatives column names: ['Article ID', 'Title', 'Author', 'Publication year', 'Title secondary', 'URL', 'DOI', 'Abstract', 'Criteria for exclusion A', ' Criteria for exclusion B', ' Criteria for exclusion C', 'labels', 'Keywords']
2025-06-06 16:23:55,466 - INFO - Loading original positives...
2025-06-06 16:23:55,482 - INFO - Positives column names: ['Article ID', 'Title', 'Author', 'Secondary authors', 'Keywords', 'title of unpublished reference', 'primary date', 'publication year', 'notes', 'reprint status', 'start page number', 'ending page number', 'periodical full name', 'periodical standard abbreviation', 'periodical in which article was published', 'periodical name - user abbreviation 1', 'periodical name - user abbreviation 2', 'volume number', 'issue number', 'title secondary', 'city of publication', 'publisher', 'user definable 1', 'user definable 5', 'title series', 'Abstract', 'ISSN/ISBN', 'availability', 'Misc. 1', 'Misc. 2', 'address', 'Web/URL', 'link to PDF', 'link to full-text', 'related records', 'images', 'DOI', 'labels']
2025-06-06 16:23:55,487 - INFO - Class balance:
labels
1    326
0    123
Name: count, dtype: int64
2025-06-06 16:23:55,487 - INFO -    Article ID  ...  Criteria for exclusion C
0       12959  ...                       NaN
1       13470  ...                       NaN
2        4686  ...                       NaN
3        2503  ...                       NaN
4        2951  ...                       NaN

[5 rows x 44 columns]
2025-06-06 16:23:55,511 - INFO - Original dataset size: 449
2025-06-06 16:23:55,511 - INFO - Optional negatives size: 5000
2025-06-06 16:23:55,515 - INFO - Optional negatives:                                                title  ... labels
0  Towards evidence-based conservation of subterr...  ...     -1
1                  Marine biodiversity conservation.  ...     -1
2  Climate teleconnections modulate global burned...  ...     -1
3  Integrating carbon sequestration and biodivers...  ...     -1
4  Principle, technique and application of grassl...  ...     -1

[5 rows x 7 columns]
2025-06-06 16:23:55,519 - INFO - Combined dataset size: 949
2025-06-06 16:23:55,519 - INFO - Before cleaning, head:
                                               title  ... labels
0  Feral pig (Sus scrofa) disturbance facilitates...  ...      1
1  Effects of woody plant diversity on abovegroun...  ...      1
2  Scaling species richness and endemism of tropi...  ...      1
3  Not as the crow flies: Assessing effective iso...  ...      0
4  Species-group concepts and biogeography of the...  ...      1

[5 rows x 5 columns]
2025-06-06 16:23:55,524 - INFO - Null counts before cleaning:
title        0
abstract     0
Keywords     8
doi         37
labels       0
dtype: int64
2025-06-06 16:23:55,527 - INFO - Total duplicate title: 0
2025-06-06 16:23:55,532 - INFO - Conflicts on title (same value, multiple labels):
Empty DataFrame
Columns: [title, n_labels]
Index: []
2025-06-06 16:23:55,535 - INFO - Total duplicate abstract: 0
2025-06-06 16:23:55,543 - INFO - Conflicts on abstract (same value, multiple labels):
Empty DataFrame
Columns: [abstract, n_labels]
Index: []
2025-06-06 16:23:55,545 - INFO - Total duplicate doi: 18
2025-06-06 16:23:55,548 - INFO - Conflicts on doi (same value, multiple labels):
Empty DataFrame
Columns: [doi, n_labels]
Index: []
2025-06-06 16:23:55,549 - INFO - Cleaned dataset size: 896
2025-06-06 16:23:55,549 - INFO - Numnber of positives : 293
2025-06-06 16:23:55,550 - INFO - Numnber of negatives : 603
2025-06-06 16:23:55,550 - INFO - clean_og_df size : 397
2025-06-06 16:23:55,550 - INFO - opt_neg_df size : 499
2025-06-06 16:23:55,555 - INFO - Fold 1:
2025-06-06 16:23:55,555 - INFO -   Train label distribution: {-1: 0.7159253945480631, 1: 0.20946915351506457, 0: 0.0746054519368723}
2025-06-06 16:23:55,555 - INFO -   Test label distribution: {1: 0.7368421052631579, 0: 0.2631578947368421}
2025-06-06 16:23:55,558 - INFO - Fold 2:
2025-06-06 16:23:55,558 - INFO -   Train label distribution: {-1: 0.7159253945480631, 1: 0.20946915351506457, 0: 0.0746054519368723}
2025-06-06 16:23:55,558 - INFO -   Test label distribution: {1: 0.7424242424242424, 0: 0.25757575757575757}
2025-06-06 16:23:55,560 - INFO - Fold 3:
2025-06-06 16:23:55,560 - INFO -   Train label distribution: {-1: 0.7159253945480631, 1: 0.20946915351506457, 0: 0.0746054519368723}
2025-06-06 16:23:55,560 - INFO -   Test label distribution: {1: 0.7348484848484849, 0: 0.26515151515151514}
2025-06-06 16:23:55,563 - INFO - Fold 1:
2025-06-06 16:23:55,564 - INFO -   Train label distribution: {-1: 0.7159253945480631, 1: 0.20946915351506457, 0: 0.0746054519368723}
2025-06-06 16:23:55,564 - INFO -   Test label distribution: {1: 0.7368421052631579, 0: 0.2631578947368421}
2025-06-06 16:23:55,566 - INFO - Fold 2:
2025-06-06 16:23:55,566 - INFO -   Train label distribution: {-1: 0.7159253945480631, 1: 0.20946915351506457, 0: 0.0746054519368723}
2025-06-06 16:23:55,566 - INFO -   Test label distribution: {1: 0.7424242424242424, 0: 0.25757575757575757}
2025-06-06 16:23:55,568 - INFO - Fold 3:
2025-06-06 16:23:55,568 - INFO -   Train label distribution: {-1: 0.7159253945480631, 1: 0.20946915351506457, 0: 0.0746054519368723}
2025-06-06 16:23:55,568 - INFO -   Test label distribution: {1: 0.7348484848484849, 0: 0.26515151515151514}
2025-06-06 16:23:55,569 - INFO - Indices of clean_df remain the same after resetting.
2025-06-06 16:23:55,589 - INFO - clean_df index : RangeIndex(start=0, stop=896, step=1)
Stringifying the column:   0%|          | 0/896 [00:00<?, ? examples/s]Stringifying the column: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 896/896 [00:00<00:00, 148230.84 examples/s]
Casting to class labels:   0%|          | 0/896 [00:00<?, ? examples/s]Casting to class labels: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 896/896 [00:00<00:00, 182777.90 examples/s]
2025-06-06 16:23:55,606 - INFO - Number of positives : 293
2025-06-06 16:23:55,607 - INFO - Number of negatives : 603
2025-06-06 16:23:55,611 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
2025-06-06 16:27:18,098 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--accuracy/f887c0aab52c2d38e1f8a215681126379eca617f96c447638f751434e8e65b14 (last modified on Mon Mar 17 17:18:23 2025) since it couldn't be found locally at evaluate-metric--accuracy, or remotely on the Hugging Face Hub.
2025-06-06 16:27:18,109 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': 0.7368421052631579, 'MCC': 0.0, 'NDCG': 0.9189307109272616, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-06 16:27:18,111 - INFO - Confusion matrix: TN=35, FP=0, FN=98, TP=0
2025-06-06 16:27:24,368 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--f1/34c46321f42186df33a6260966e34a368f14868d9cc2ba47d142112e2800d233 (last modified on Mon Mar 17 17:18:24 2025) since it couldn't be found locally at evaluate-metric--f1, or remotely on the Hugging Face Hub.
2025-06-06 16:27:25,524 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--recall/11f90e583db35601050aed380d48e83202a896976b9608432fba9244fb447f24 (last modified on Mon Mar 17 17:18:25 2025) since it couldn't be found locally at evaluate-metric--recall, or remotely on the Hugging Face Hub.
2025-06-06 16:27:26,698 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--precision/155d3220d6cd4a6553f12da68eeb3d1f97cf431206304a4bc6e2d564c29502e9 (last modified on Mon Mar 17 17:18:26 2025) since it couldn't be found locally at evaluate-metric--precision, or remotely on the Hugging Face Hub.
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-06-06 16:27:27,845 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--accuracy/f887c0aab52c2d38e1f8a215681126379eca617f96c447638f751434e8e65b14 (last modified on Mon Mar 17 17:18:23 2025) since it couldn't be found locally at evaluate-metric--accuracy, or remotely on the Hugging Face Hub.
2025-06-06 16:27:27,855 - INFO - Metrics: {'f1': 0.0, 'recall': 0.0, 'precision': 0.0, 'accuracy': 0.2631578947368421, 'AP': 0.7368421052631579, 'MCC': 0.0, 'NDCG': 0.9189307109272616, 'kappa': 0.0, 'TN': 35, 'FP': 0, 'FN': 98, 'TP': 0}
2025-06-06 16:27:27,859 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-06 16:27:29,088 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--f1/34c46321f42186df33a6260966e34a368f14868d9cc2ba47d142112e2800d233 (last modified on Mon Mar 17 17:18:24 2025) since it couldn't be found locally at evaluate-metric--f1, or remotely on the Hugging Face Hub.
2025-06-06 16:27:30,266 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--recall/11f90e583db35601050aed380d48e83202a896976b9608432fba9244fb447f24 (last modified on Mon Mar 17 17:18:25 2025) since it couldn't be found locally at evaluate-metric--recall, or remotely on the Hugging Face Hub.
2025-06-06 16:27:31,413 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--precision/155d3220d6cd4a6553f12da68eeb3d1f97cf431206304a4bc6e2d564c29502e9 (last modified on Mon Mar 17 17:18:26 2025) since it couldn't be found locally at evaluate-metric--precision, or remotely on the Hugging Face Hub.
2025-06-06 16:27:32,568 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--accuracy/f887c0aab52c2d38e1f8a215681126379eca617f96c447638f751434e8e65b14 (last modified on Mon Mar 17 17:18:23 2025) since it couldn't be found locally at evaluate-metric--accuracy, or remotely on the Hugging Face Hub.
2025-06-06 16:27:32,578 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': 0.7424242424242424, 'MCC': 0.0, 'NDCG': 0.9208012714375936, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-06 16:27:32,580 - INFO - Confusion matrix: TN=34, FP=0, FN=98, TP=0
2025-06-06 16:27:33,796 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--f1/34c46321f42186df33a6260966e34a368f14868d9cc2ba47d142112e2800d233 (last modified on Mon Mar 17 17:18:24 2025) since it couldn't be found locally at evaluate-metric--f1, or remotely on the Hugging Face Hub.
2025-06-06 16:27:34,939 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--recall/11f90e583db35601050aed380d48e83202a896976b9608432fba9244fb447f24 (last modified on Mon Mar 17 17:18:25 2025) since it couldn't be found locally at evaluate-metric--recall, or remotely on the Hugging Face Hub.
2025-06-06 16:27:36,128 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--precision/155d3220d6cd4a6553f12da68eeb3d1f97cf431206304a4bc6e2d564c29502e9 (last modified on Mon Mar 17 17:18:26 2025) since it couldn't be found locally at evaluate-metric--precision, or remotely on the Hugging Face Hub.
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-06-06 16:27:37,290 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--accuracy/f887c0aab52c2d38e1f8a215681126379eca617f96c447638f751434e8e65b14 (last modified on Mon Mar 17 17:18:23 2025) since it couldn't be found locally at evaluate-metric--accuracy, or remotely on the Hugging Face Hub.
2025-06-06 16:27:37,300 - INFO - Metrics: {'f1': 0.0, 'recall': 0.0, 'precision': 0.0, 'accuracy': 0.25757575757575757, 'AP': 0.7424242424242424, 'MCC': 0.0, 'NDCG': 0.9208012714375936, 'kappa': 0.0, 'TN': 34, 'FP': 0, 'FN': 98, 'TP': 0}
2025-06-06 16:27:37,305 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-06 16:27:38,530 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--f1/34c46321f42186df33a6260966e34a368f14868d9cc2ba47d142112e2800d233 (last modified on Mon Mar 17 17:18:24 2025) since it couldn't be found locally at evaluate-metric--f1, or remotely on the Hugging Face Hub.
2025-06-06 16:27:39,673 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--recall/11f90e583db35601050aed380d48e83202a896976b9608432fba9244fb447f24 (last modified on Mon Mar 17 17:18:25 2025) since it couldn't be found locally at evaluate-metric--recall, or remotely on the Hugging Face Hub.
2025-06-06 16:27:40,822 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--precision/155d3220d6cd4a6553f12da68eeb3d1f97cf431206304a4bc6e2d564c29502e9 (last modified on Mon Mar 17 17:18:26 2025) since it couldn't be found locally at evaluate-metric--precision, or remotely on the Hugging Face Hub.
2025-06-06 16:27:42,009 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--accuracy/f887c0aab52c2d38e1f8a215681126379eca617f96c447638f751434e8e65b14 (last modified on Mon Mar 17 17:18:23 2025) since it couldn't be found locally at evaluate-metric--accuracy, or remotely on the Hugging Face Hub.
2025-06-06 16:27:42,019 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': 0.7348484848484849, 'MCC': 0.0, 'NDCG': 0.9181159076123374, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-06 16:27:42,021 - INFO - Confusion matrix: TN=35, FP=0, FN=97, TP=0
2025-06-06 16:27:43,245 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--f1/34c46321f42186df33a6260966e34a368f14868d9cc2ba47d142112e2800d233 (last modified on Mon Mar 17 17:18:24 2025) since it couldn't be found locally at evaluate-metric--f1, or remotely on the Hugging Face Hub.
2025-06-06 16:27:44,409 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--recall/11f90e583db35601050aed380d48e83202a896976b9608432fba9244fb447f24 (last modified on Mon Mar 17 17:18:25 2025) since it couldn't be found locally at evaluate-metric--recall, or remotely on the Hugging Face Hub.
2025-06-06 16:27:45,564 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--precision/155d3220d6cd4a6553f12da68eeb3d1f97cf431206304a4bc6e2d564c29502e9 (last modified on Mon Mar 17 17:18:26 2025) since it couldn't be found locally at evaluate-metric--precision, or remotely on the Hugging Face Hub.
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-06-06 16:27:46,716 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--accuracy/f887c0aab52c2d38e1f8a215681126379eca617f96c447638f751434e8e65b14 (last modified on Mon Mar 17 17:18:23 2025) since it couldn't be found locally at evaluate-metric--accuracy, or remotely on the Hugging Face Hub.
2025-06-06 16:27:46,725 - INFO - Metrics: {'f1': 0.0, 'recall': 0.0, 'precision': 0.0, 'accuracy': 0.26515151515151514, 'AP': 0.7348484848484849, 'MCC': 0.0, 'NDCG': 0.9181159076123374, 'kappa': 0.0, 'TN': 35, 'FP': 0, 'FN': 97, 'TP': 0}
2025-06-06 16:27:46,728 - INFO - Pipeline for loss type None and ensemble=True
2025-06-06 16:27:46,728 - INFO - with_title : True
2025-06-06 16:27:46,728 - INFO - with_keywords : True
2025-06-06 16:27:46,728 - INFO - fold indexes for run no.1: [[159, 206, 117, 82, 317, 330, 131, 380, 183, 158, 213, 260, 155, 332, 303, 269, 40, 232, 314, 244, 168, 218, 254, 100, 3, 235, 105, 243, 352, 394, 196, 223, 230, 307, 342, 289, 135, 7, 189, 134, 78, 133, 12, 375, 109, 46, 62, 393, 167, 151, 387, 374, 276, 323, 132, 319, 114, 176, 322, 263, 258, 266, 250, 329, 309, 367, 24, 229, 370, 211, 228, 346, 115, 392, 87, 88, 81, 343, 253, 278, 43, 333, 28, 80, 191, 10, 378, 388, 225, 363, 136, 104, 356, 8, 57, 162, 220, 391, 139, 386, 282, 70, 61, 170, 102, 296, 64, 35, 4, 251, 279, 44, 373, 129, 236, 327, 187, 68, 245, 215, 18, 42, 116, 212, 376, 148, 126, 27, 252, 173, 103, 336, 209, 199, 169, 283, 32, 246, 292, 210, 247, 141, 73, 194, 59, 385, 354, 51, 305, 200, 344, 179, 178, 355, 313, 112, 291, 23, 328, 130, 315, 181, 138, 94, 95, 121, 207, 175, 295, 321, 34, 300, 262, 33, 341, 54, 299, 48, 30, 204, 123, 331, 301, 150, 157, 265, 14, 53, 396, 242, 377, 366, 93, 214, 83, 52, 6, 188, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 532, 533, 534, 535, 536, 537, 538, 539, 540, 541, 542, 543, 544, 545, 546, 547, 548, 549, 550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 560, 561, 562, 563, 564, 565, 566, 567, 568, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582, 583, 584, 585, 586, 587, 588, 589, 590, 591, 592, 593, 594, 595, 596, 597, 598, 599, 600, 601, 602, 603, 604, 605, 606, 607, 608, 609, 610, 611, 612, 613, 614, 615, 616, 617, 618, 619, 620, 621, 622, 623, 624, 625, 626, 627, 628, 629, 630, 631, 632, 633, 634, 635, 636, 637, 638, 639, 640, 641, 642, 643, 644, 645, 646, 647, 648, 649, 650, 651, 652, 653, 654, 655, 656, 657, 658, 659, 660, 661, 662, 663, 664, 665, 666, 667, 668, 669, 670, 671, 672, 673, 674, 675, 676, 677, 678, 679, 680, 681, 682, 683, 684, 685, 686, 687, 688, 689, 690, 691, 692, 693, 694, 695, 696, 697, 698, 699, 700, 701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 714, 715, 716, 717, 718, 719, 720, 721, 722, 723, 724, 725, 726, 727, 728, 729, 730, 731, 732, 733, 734, 735, 736, 737, 738, 739, 740, 741, 742, 743, 744, 745, 746, 747, 748, 749, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764, 765, 766, 767, 768, 769, 770, 771, 772, 773, 774, 775, 776, 777, 778, 779, 780, 781, 782, 783, 784, 785, 786, 787, 788, 789, 790, 791, 792, 793, 794, 795, 796, 797, 798, 799, 800, 801, 802, 803, 804, 805, 806, 807, 808, 809, 810, 811, 812, 813, 814, 815, 816, 817, 818, 819, 820, 821, 822, 823, 824, 825, 826, 827, 828, 829, 830, 831, 832, 833, 834, 835, 836, 837, 838, 839, 840, 841, 842, 843, 844, 845, 846, 847, 848, 849, 850, 851, 852, 853, 854, 855, 856, 857, 858, 859, 860, 861, 862, 863, 864, 865, 866, 867, 868, 869, 870, 871, 872, 873, 874, 875, 876, 877, 878, 879, 880, 881, 882, 883, 884, 885, 886, 887, 888, 889, 890, 891, 892, 893, 894, 895], [177, 268, 97, 248, 298, 320, 224, 137, 161, 145, 339, 98, 39, 66, 17, 325, 226, 91, 348, 67, 55, 237, 273, 353, 381, 261, 31, 2, 290, 107, 38, 113, 120, 1, 222, 84, 358, 202, 63, 337, 92, 99, 144, 256, 19, 171, 219, 285, 274, 174, 118, 233, 156, 324, 284, 190, 255, 357, 205, 111, 72, 384, 294, 71, 163, 217], [0, 5, 9, 11, 13, 15, 16, 20, 21, 22, 25, 26, 29, 36, 37, 41, 45, 47, 49, 50, 56, 58, 60, 65, 69, 74, 75, 76, 77, 79, 85, 86, 89, 90, 96, 101, 106, 108, 110, 119, 122, 124, 125, 127, 128, 140, 142, 143, 146, 147, 149, 152, 153, 154, 160, 164, 165, 166, 172, 180, 182, 184, 185, 186, 192, 193, 195, 197, 198, 201, 203, 208, 216, 221, 227, 231, 234, 238, 239, 240, 241, 249, 257, 259, 264, 267, 270, 271, 272, 275, 277, 280, 281, 286, 287, 288, 293, 297, 302, 304, 306, 308, 310, 311, 312, 316, 318, 326, 334, 335, 338, 340, 345, 347, 349, 350, 351, 359, 360, 361, 362, 364, 365, 368, 369, 371, 372, 379, 382, 383, 389, 390, 395]]
2025-06-06 16:27:46,728 - INFO - Run no 1/2
2025-06-06 16:27:46,728 - INFO - Loss Type : BCE
2025-06-06 16:27:46,728 - INFO - Ensemble learning pipeline
2025-06-06 16:27:46,728 - INFO - Training model 1/2: dmis-lab/biobert-v1.1
2025-06-06 16:27:46,824 - INFO - 
fold number 1 / 3
2025-06-06 16:27:46,830 - INFO - train split size : 697
2025-06-06 16:27:46,830 - INFO - dev split size : 66
2025-06-06 16:27:46,830 - INFO - test split size : 133
Map (num_proc=32):   0%|          | 0/697 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 22/697 [00:00<00:05, 130.52 examples/s]Map (num_proc=32):  13%|â–ˆâ–Ž        | 88/697 [00:00<00:01, 370.39 examples/s]Map (num_proc=32):  22%|â–ˆâ–ˆâ–       | 154/697 [00:00<00:01, 440.69 examples/s]Map (num_proc=32):  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 286/697 [00:00<00:00, 688.64 examples/s]Map (num_proc=32):  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 374/697 [00:00<00:00, 710.35 examples/s]Map (num_proc=32):  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 462/697 [00:00<00:00, 736.90 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 550/697 [00:00<00:00, 741.33 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 634/697 [00:00<00:00, 749.75 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 697/697 [00:01<00:00, 610.31 examples/s]
Map (num_proc=32):   0%|          | 0/66 [00:00<?, ? examples/s]Map (num_proc=32):   5%|â–         | 3/66 [00:00<00:02, 25.84 examples/s]Map (num_proc=32):  18%|â–ˆâ–Š        | 12/66 [00:00<00:00, 55.01 examples/s]Map (num_proc=32):  30%|â–ˆâ–ˆâ–ˆ       | 20/66 [00:00<00:00, 62.61 examples/s]Map (num_proc=32):  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 28/66 [00:00<00:00, 66.89 examples/s]Map (num_proc=32):  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 36/66 [00:00<00:00, 64.19 examples/s]Map (num_proc=32):  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 44/66 [00:00<00:00, 65.74 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 52/66 [00:00<00:00, 68.54 examples/s]Map (num_proc=32):  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 60/66 [00:00<00:00, 69.13 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 66/66 [00:01<00:00, 59.78 examples/s]
Map (num_proc=32):   0%|          | 0/133 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/133 [00:00<00:03, 41.16 examples/s]Map (num_proc=32):  22%|â–ˆâ–ˆâ–       | 29/133 [00:00<00:00, 127.50 examples/s]Map (num_proc=32):  34%|â–ˆâ–ˆâ–ˆâ–      | 45/133 [00:00<00:00, 140.12 examples/s]Map (num_proc=32):  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 65/133 [00:00<00:00, 148.29 examples/s]Map (num_proc=32):  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 85/133 [00:00<00:00, 151.62 examples/s]Map (num_proc=32):  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 101/133 [00:00<00:00, 153.10 examples/s]Map (num_proc=32):  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 117/133 [00:00<00:00, 148.26 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 133/133 [00:01<00:00, 132.33 examples/s]
2025-06-06 16:27:51,963 - INFO - 3 datasets tokenized successfully
2025-06-06 16:27:51,965 - INFO - Starting hyperparameter search for BCE loss
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-06_16-27-52   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_16-27-52
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-06_16-23-53_491015_3810507/artifacts/2025-06-06_16-27-52/train_hpo_2025-06-06_16-27-52/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-06 16:27:53. Total running time: 0s
Logical resource usage: 0/32 CPUs, 0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_51d6e434   PENDING         8.49369       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_51d6e434 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_51d6e434 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          8.49369 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3817530)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3817530)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3817530)[0m 2025-06-06 16:28:01,058 - INFO - pos_weight value in TrainingArguments : 8.493688290834637
[36m(train_hpo pid=3817530)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3817530)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3817530)[0m [2025-06-06 16:28:01,300] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3817530)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=48, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_b8946fa4 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_b8946fa4 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          7.54953 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3817695)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3817695)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3817695)[0m 2025-06-06 16:28:08,173 - INFO - pos_weight value in TrainingArguments : 7.549531688595925
[36m(train_hpo pid=3817695)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3817695)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3817695)[0m [2025-06-06 16:28:08,582] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3817695)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=40, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_34f763f7 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_34f763f7 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          8.94984 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3818063)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3818063)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3818063)[0m 2025-06-06 16:28:14,961 - INFO - pos_weight value in TrainingArguments : 8.949837496427758
[36m(train_hpo pid=3818063)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3818063)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3818063)[0m [2025-06-06 16:28:15,194] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3818063)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=24, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 3 RUNNING
Current time: 2025-06-06 16:28:23. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_51d6e434   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_b8946fa4   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_34f763f7   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3817530)[0m {'loss': 1.8934, 'grad_norm': 9.386770248413086, 'learning_rate': 1.246338876535363e-06, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3818063)[0m {'loss': 1.1304, 'grad_norm': 7.990197658538818, 'learning_rate': 5.325452975187489e-05, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3817695)[0m {'loss': 1.5852, 'grad_norm': 2.5450117588043213, 'learning_rate': 3.6443132246884782e-06, 'epoch': 0.9142857142857143}
Trial status: 3 RUNNING
Current time: 2025-06-06 16:28:53. Total running time: 1min 0s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_51d6e434   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_b8946fa4   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_34f763f7   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3817530)[0m {'loss': 1.8222, 'grad_norm': 9.449230194091797, 'learning_rate': 9.970711012282902e-07, 'epoch': 1.9142857142857141}[32m [repeated 2x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(train_hpo pid=3818063)[0m {'train_runtime': 37.8187, 'train_samples_per_second': 55.29, 'train_steps_per_second': 0.635, 'train_loss': 0.46713607013225555, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3818063)[0m STATE at ending of training  :  TrainerState(epoch=2.914285714285714, global_step=24, max_steps=24, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=515096932631760.0, log_history=[{'loss': 1.1304, 'grad_norm': 7.990197658538818, 'learning_rate': 5.325452975187489e-05, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.2115, 'grad_norm': 1.420823574066162, 'learning_rate': 2.6627264875937445e-05, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 0.0595, 'grad_norm': 0.7051702737808228, 'learning_rate': 0.0, 'epoch': 2.914285714285714, 'step': 24}, {'train_runtime': 37.8187, 'train_samples_per_second': 55.29, 'train_steps_per_second': 0.635, 'total_flos': 515096932631760.0, 'train_loss': 0.46713607013225555, 'epoch': 2.914285714285714, 'step': 24}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3818063)[0m 2025-06-06 16:28:57,869 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--f1/34c46321f42186df33a6260966e34a368f14868d9cc2ba47d142112e2800d233 (last modified on Mon Mar 17 17:18:24 2025) since it couldn't be found locally at evaluate-metric--f1, or remotely on the Hugging Face Hub.
[36m(train_hpo pid=3818063)[0m 2025-06-06 16:28:59,027 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--recall/11f90e583db35601050aed380d48e83202a896976b9608432fba9244fb447f24 (last modified on Mon Mar 17 17:18:25 2025) since it couldn't be found locally at evaluate-metric--recall, or remotely on the Hugging Face Hub.
[36m(train_hpo pid=3818063)[0m 2025-06-06 16:29:00,199 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--accuracy/f887c0aab52c2d38e1f8a215681126379eca617f96c447638f751434e8e65b14 (last modified on Mon Mar 17 17:18:23 2025) since it couldn't be found locally at evaluate-metric--accuracy, or remotely on the Hugging Face Hub.
[36m(train_hpo pid=3818063)[0m 2025-06-06 16:29:01,382 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--precision/155d3220d6cd4a6553f12da68eeb3d1f97cf431206304a4bc6e2d564c29502e9 (last modified on Mon Mar 17 17:18:26 2025) since it couldn't be found locally at evaluate-metric--precision, or remotely on the Hugging Face Hub.

Trial train_hpo_34f763f7 finished iteration 1 at 2025-06-06 16:29:01. Total running time: 1min 8s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_34f763f7 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    47.2839 â”‚
â”‚ time_total_s                        47.2839 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               2.91429 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                                  1 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                             1 â”‚
â”‚ eval_f1                                   1 â”‚
â”‚ eval_kappa                                1 â”‚
â”‚ eval_loss                           0.06747 â”‚
â”‚ eval_optim_threshold                0.97764 â”‚
â”‚ eval_precision                            1 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         5.2805 â”‚
â”‚ eval_samples_per_second              12.499 â”‚
â”‚ eval_steps_per_second                 0.758 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 16:29:01,590 - INFO - Cleaning up trial 34f763f7
2025-06-06 16:29:01,590 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_16-27-52/train_hpo_34f763f7_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512_2025-06-06_16-28-07

Trial train_hpo_34f763f7 completed after 1 iterations at 2025-06-06 16:29:01. Total running time: 1min 8s
[36m(train_hpo pid=3818063)[0m 2025-06-06 16:29:01,522 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3818063)[0m 2025-06-06 16:29:01,528 - INFO - eval_result: {'eval_loss': 0.06747167557477951, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9776414036750793, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 5.2805, 'eval_samples_per_second': 12.499, 'eval_steps_per_second': 0.758, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3818063)[0m 2025-06-06 16:29:01,564 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3818063)[0m {'eval_loss': 0.06747167557477951, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9776414036750793, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 5.2805, 'eval_samples_per_second': 12.499, 'eval_steps_per_second': 0.758, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3818063)[0m {'loss': 0.0595, 'grad_norm': 0.7051702737808228, 'learning_rate': 0.0, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3817695)[0m {'loss': 1.4654, 'grad_norm': 2.7240235805511475, 'learning_rate': 2.7332349185163582e-06, 'epoch': 1.9142857142857141}
[36m(train_hpo pid=3817530)[0m {'loss': 1.7705, 'grad_norm': 5.602956295013428, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.914285714285714}

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 16:29:23. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_51d6e434   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_b8946fa4   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_34f763f7   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            47.2839     0.0674717           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3817695)[0m {'loss': 1.3888, 'grad_norm': 4.9413251876831055, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3817530)[0m {'loss': 1.7541, 'grad_norm': 3.854631185531616, 'learning_rate': 4.985355506141451e-07, 'epoch': 3.914285714285714}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 16:29:53. Total running time: 2min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_51d6e434   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_b8946fa4   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_34f763f7   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            47.2839     0.0674717           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3817695)[0m {'loss': 1.3336, 'grad_norm': 4.935316562652588, 'learning_rate': 9.110783061721196e-07, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3817530)[0m {'loss': 1.7218, 'grad_norm': 13.478766441345215, 'learning_rate': 2.4926777530707256e-07, 'epoch': 4.914285714285715}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 16:30:23. Total running time: 2min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_51d6e434   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_b8946fa4   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_34f763f7   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            47.2839     0.0674717           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3817695)[0m {'loss': 1.257, 'grad_norm': 4.500599384307861, 'learning_rate': 0.0, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3817695)[0m {'train_runtime': 147.2486, 'train_samples_per_second': 23.667, 'train_steps_per_second': 0.272, 'train_loss': 1.4060144186019898, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3817695)[0m STATE at ending of training  :  TrainerState(epoch=4.914285714285715, global_step=40, max_steps=40, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=862318185914640.0, log_history=[{'loss': 1.5852, 'grad_norm': 2.5450117588043213, 'learning_rate': 3.6443132246884782e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 1.4654, 'grad_norm': 2.7240235805511475, 'learning_rate': 2.7332349185163582e-06, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 1.3888, 'grad_norm': 4.9413251876831055, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 1.3336, 'grad_norm': 4.935316562652588, 'learning_rate': 9.110783061721196e-07, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 1.257, 'grad_norm': 4.500599384307861, 'learning_rate': 0.0, 'epoch': 4.914285714285715, 'step': 40}, {'train_runtime': 147.2486, 'train_samples_per_second': 23.667, 'train_steps_per_second': 0.272, 'total_flos': 862318185914640.0, 'train_loss': 1.4060144186019898, 'epoch': 4.914285714285715, 'step': 40}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3817695)[0m 2025-06-06 16:30:42,358 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--f1/34c46321f42186df33a6260966e34a368f14868d9cc2ba47d142112e2800d233 (last modified on Mon Mar 17 17:18:24 2025) since it couldn't be found locally at evaluate-metric--f1, or remotely on the Hugging Face Hub.
[36m(train_hpo pid=3817695)[0m 2025-06-06 16:30:43,531 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--recall/11f90e583db35601050aed380d48e83202a896976b9608432fba9244fb447f24 (last modified on Mon Mar 17 17:18:25 2025) since it couldn't be found locally at evaluate-metric--recall, or remotely on the Hugging Face Hub.
[36m(train_hpo pid=3817695)[0m 2025-06-06 16:30:44,698 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--accuracy/f887c0aab52c2d38e1f8a215681126379eca617f96c447638f751434e8e65b14 (last modified on Mon Mar 17 17:18:23 2025) since it couldn't be found locally at evaluate-metric--accuracy, or remotely on the Hugging Face Hub.
[36m(train_hpo pid=3817530)[0m STATE at ending of training  :  TrainerState(epoch=5.914285714285715, global_step=48, max_steps=48, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=1035969923289360.0, log_history=[{'loss': 1.8934, 'grad_norm': 9.386770248413086, 'learning_rate': 1.246338876535363e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 1.8222, 'grad_norm': 9.449230194091797, 'learning_rate': 9.970711012282902e-07, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 1.7705, 'grad_norm': 5.602956295013428, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 1.7541, 'grad_norm': 3.854631185531616, 'learning_rate': 4.985355506141451e-07, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 1.7218, 'grad_norm': 13.478766441345215, 'learning_rate': 2.4926777530707256e-07, 'epoch': 4.914285714285715, 'step': 40}, {'loss': 1.6767, 'grad_norm': 8.213213920593262, 'learning_rate': 0.0, 'epoch': 5.914285714285715, 'step': 48}, {'train_runtime': 160.7174, 'train_samples_per_second': 26.021, 'train_steps_per_second': 0.299, 'total_flos': 1035969923289360.0, 'train_loss': 1.7731065154075623, 'epoch': 5.914285714285715, 'step': 48}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3817530)[0m {'loss': 1.6767, 'grad_norm': 8.213213920593262, 'learning_rate': 0.0, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3817530)[0m {'train_runtime': 160.7174, 'train_samples_per_second': 26.021, 'train_steps_per_second': 0.299, 'train_loss': 1.7731065154075623, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3817695)[0m 2025-06-06 16:30:45,862 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--precision/155d3220d6cd4a6553f12da68eeb3d1f97cf431206304a4bc6e2d564c29502e9 (last modified on Mon Mar 17 17:18:26 2025) since it couldn't be found locally at evaluate-metric--precision, or remotely on the Hugging Face Hub.

Trial train_hpo_b8946fa4 finished iteration 1 at 2025-06-06 16:30:46. Total running time: 2min 52s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_b8946fa4 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    158.609 â”‚
â”‚ time_total_s                        158.609 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               4.91429 â”‚
â”‚ eval_AP                             0.99777 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.99961 â”‚
â”‚ eval_accuracy                       0.74242 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.94422 â”‚
â”‚ eval_optim_threshold                0.67517 â”‚
â”‚ eval_precision                      0.74242 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                          6.936 â”‚
â”‚ eval_samples_per_second               9.516 â”‚
â”‚ eval_steps_per_second                 0.577 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 16:30:46,066 - INFO - Cleaning up trial b8946fa4
2025-06-06 16:30:46,066 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_16-27-52/train_hpo_b8946fa4_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-06_16-28-00
2025-06-06 16:30:46,066 - INFO - Current best: 34f763f7 with eval_f1 : 1.0 at iteration 1

Trial train_hpo_b8946fa4 completed after 1 iterations at 2025-06-06 16:30:46. Total running time: 2min 52s
[36m(train_hpo pid=3817695)[0m {'eval_loss': 1.944223403930664, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.6751696467399597, 'eval_AP': 0.9977736549165122, 'eval_MCC': 0.0, 'eval_NDCG': 0.999607875692968, 'eval_kappa': 0.0, 'eval_runtime': 6.936, 'eval_samples_per_second': 9.516, 'eval_steps_per_second': 0.577, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3817695)[0m 2025-06-06 16:30:45,997 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3817695)[0m 2025-06-06 16:30:46,003 - INFO - eval_result: {'eval_loss': 1.944223403930664, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.6751696467399597, 'eval_AP': 0.9977736549165122, 'eval_MCC': 0.0, 'eval_NDCG': 0.999607875692968, 'eval_kappa': 0.0, 'eval_runtime': 6.936, 'eval_samples_per_second': 9.516, 'eval_steps_per_second': 0.577, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3817695)[0m 2025-06-06 16:30:46,043 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3817530)[0m 2025-06-06 16:30:46,793 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--f1/34c46321f42186df33a6260966e34a368f14868d9cc2ba47d142112e2800d233 (last modified on Mon Mar 17 17:18:24 2025) since it couldn't be found locally at evaluate-metric--f1, or remotely on the Hugging Face Hub.
[36m(train_hpo pid=3817530)[0m 2025-06-06 16:30:47,951 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--recall/11f90e583db35601050aed380d48e83202a896976b9608432fba9244fb447f24 (last modified on Mon Mar 17 17:18:25 2025) since it couldn't be found locally at evaluate-metric--recall, or remotely on the Hugging Face Hub.
[36m(train_hpo pid=3817530)[0m 2025-06-06 16:30:49,095 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--accuracy/f887c0aab52c2d38e1f8a215681126379eca617f96c447638f751434e8e65b14 (last modified on Mon Mar 17 17:18:23 2025) since it couldn't be found locally at evaluate-metric--accuracy, or remotely on the Hugging Face Hub.

Trial train_hpo_51d6e434 finished iteration 1 at 2025-06-06 16:30:50. Total running time: 2min 56s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_51d6e434 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    170.115 â”‚
â”‚ time_total_s                        170.115 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               5.91429 â”‚
â”‚ eval_AP                             0.96285 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.99301 â”‚
â”‚ eval_accuracy                       0.74242 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           4.02972 â”‚
â”‚ eval_optim_threshold                0.54051 â”‚
â”‚ eval_precision                      0.74242 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         5.2332 â”‚
â”‚ eval_samples_per_second              12.612 â”‚
â”‚ eval_steps_per_second                 0.764 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 16:30:50,456 - INFO - Cleaning up trial 51d6e434
2025-06-06 16:30:50,457 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_16-27-52/train_hpo_51d6e434_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-06_16-27-53
2025-06-06 16:30:50,457 - INFO - Cleaning up trial b8946fa4
2025-06-06 16:30:50,457 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_16-27-52/train_hpo_b8946fa4_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-06_16-28-00
2025-06-06 16:30:50,457 - INFO - Current best: 34f763f7 with eval_f1 : 1.0 at iteration 1

Trial train_hpo_51d6e434 completed after 1 iterations at 2025-06-06 16:30:50. Total running time: 2min 56s
2025-06-06 16:30:50,465	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_16-27-52' in 0.0063s.

Trial status: 3 TERMINATED
Current time: 2025-06-06 16:30:50. Total running time: 2min 56s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_51d6e434   TERMINATED        8.49369       1.49561e-06         0.13641                     6        1           170.115      4.02972      0.852174               1          0.742424 â”‚
â”‚ train_hpo_b8946fa4   TERMINATED        7.54953       4.55539e-06         0.123031                    5        1           158.609      1.94422      0.852174               1          0.742424 â”‚
â”‚ train_hpo_34f763f7   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            47.2839     0.0674717    1                      1          1        â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

2025-06-06 16:30:50,472 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x7629a3205410>
2025-06-06 16:30:50,472 - INFO - Best trial : train_hpo_34f763f7
2025-06-06 16:30:50,472 - INFO - Best config : {'pos_weight': 8.949837496427758, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-06 16:30:50,472 - INFO - Best trial after optimization: {'eval_loss': 0.06747167557477951, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9776414036750793, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 5.2805, 'eval_samples_per_second': 12.499, 'eval_steps_per_second': 0.758, 'epoch': 2.914285714285714, 'timestamp': 1749220141, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '34f763f7', 'date': '2025-06-06_16-29-01', 'time_this_iter_s': 47.2838819026947, 'time_total_s': 47.2838819026947, 'pid': 3818063, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 8.949837496427758, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 47.2838819026947, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512'}
2025-06-06 16:30:50,494 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   4.029723  0.852174  ...                        6  51d6e434
1   1.944223  0.852174  ...                        5  b8946fa4
2   0.067472  1.000000  ...                        3  34f763f7

[3 rows x 32 columns]
2025-06-06 16:30:50,668 - INFO - Trial comparison plot saved
2025-06-06 16:30:50,669 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-06 16:30:51,123 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
[2025-06-06 16:30:51,367] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2025-06-06 16:30:52,840 - INFO - training size : 697
2025-06-06 16:30:52,840 - INFO - dev size : 66
2025-06-06 16:30:52,840 - INFO - test size : 133
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
  0%|          | 0/90 [00:00<?, ?it/s]  1%|          | 1/90 [00:01<02:54,  1.96s/it]  2%|â–         | 2/90 [00:02<01:42,  1.17s/it]  3%|â–Ž         | 3/90 [00:03<01:19,  1.09it/s]  4%|â–         | 4/90 [00:03<01:08,  1.25it/s]  6%|â–Œ         | 5/90 [00:04<01:02,  1.37it/s]  7%|â–‹         | 6/90 [00:05<00:58,  1.45it/s]  8%|â–Š         | 7/90 [00:05<00:55,  1.50it/s]  9%|â–‰         | 8/90 [00:06<00:53,  1.54it/s] 10%|â–ˆ         | 9/90 [00:06<00:51,  1.57it/s] 11%|â–ˆ         | 10/90 [00:07<00:50,  1.58it/s] 12%|â–ˆâ–        | 11/90 [00:08<00:49,  1.60it/s] 13%|â–ˆâ–Ž        | 12/90 [00:08<00:48,  1.60it/s] 14%|â–ˆâ–        | 13/90 [00:09<00:47,  1.61it/s] 16%|â–ˆâ–Œ        | 14/90 [00:09<00:47,  1.62it/s] 17%|â–ˆâ–‹        | 15/90 [00:10<00:46,  1.62it/s] 18%|â–ˆâ–Š        | 16/90 [00:11<00:45,  1.62it/s] 19%|â–ˆâ–‰        | 17/90 [00:11<00:45,  1.62it/s] 20%|â–ˆâ–ˆ        | 18/90 [00:12<00:44,  1.62it/s] 21%|â–ˆâ–ˆ        | 19/90 [00:13<00:43,  1.63it/s] 22%|â–ˆâ–ˆâ–       | 20/90 [00:13<00:43,  1.63it/s] 23%|â–ˆâ–ˆâ–Ž       | 21/90 [00:14<00:42,  1.63it/s] 24%|â–ˆâ–ˆâ–       | 22/90 [00:14<00:41,  1.63it/s] 26%|â–ˆâ–ˆâ–Œ       | 23/90 [00:15<00:41,  1.63it/s] 27%|â–ˆâ–ˆâ–‹       | 24/90 [00:16<00:40,  1.63it/s] 28%|â–ˆâ–ˆâ–Š       | 25/90 [00:16<00:39,  1.63it/s] 29%|â–ˆâ–ˆâ–‰       | 26/90 [00:17<00:39,  1.63it/s] 30%|â–ˆâ–ˆâ–ˆ       | 27/90 [00:17<00:38,  1.63it/s] 31%|â–ˆâ–ˆâ–ˆ       | 28/90 [00:18<00:38,  1.63it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 29/90 [00:19<00:37,  1.64it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 30/90 [00:19<00:27,  2.17it/s]                                               {'loss': 0.4683, 'grad_norm': 0.21811233460903168, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 30/90 [00:19<00:27,  2.17it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 31/90 [00:19<00:30,  1.95it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 32/90 [00:20<00:31,  1.84it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 33/90 [00:21<00:32,  1.77it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 34/90 [00:21<00:32,  1.72it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 35/90 [00:22<00:32,  1.69it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 36/90 [00:22<00:32,  1.67it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 37/90 [00:23<00:31,  1.66it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 38/90 [00:24<00:31,  1.65it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 39/90 [00:24<00:31,  1.64it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 40/90 [00:25<00:30,  1.65it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 41/90 [00:26<00:29,  1.64it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 42/90 [00:26<00:29,  1.64it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 43/90 [00:27<00:28,  1.63it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 44/90 [00:27<00:28,  1.63it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 45/90 [00:28<00:27,  1.63it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 46/90 [00:29<00:26,  1.63it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 47/90 [00:29<00:26,  1.63it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 48/90 [00:30<00:25,  1.63it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 49/90 [00:30<00:25,  1.63it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 50/90 [00:31<00:24,  1.63it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 51/90 [00:32<00:23,  1.63it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 52/90 [00:32<00:23,  1.63it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 53/90 [00:33<00:22,  1.63it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 54/90 [00:34<00:22,  1.63it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 55/90 [00:34<00:21,  1.63it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 56/90 [00:35<00:20,  1.63it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 57/90 [00:35<00:20,  1.63it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 58/90 [00:36<00:19,  1.63it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 59/90 [00:37<00:18,  1.64it/s]                                               {'loss': 0.0049, 'grad_norm': 0.08313211798667908, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 60/90 [00:37<00:18,  1.64it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 61/90 [00:37<00:14,  2.06it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 62/90 [00:38<00:14,  1.94it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 63/90 [00:38<00:14,  1.85it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 64/90 [00:39<00:14,  1.78it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 65/90 [00:40<00:14,  1.74it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 66/90 [00:40<00:14,  1.70it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 67/90 [00:41<00:13,  1.68it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 68/90 [00:42<00:13,  1.66it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 69/90 [00:42<00:12,  1.65it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 70/90 [00:43<00:12,  1.65it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 71/90 [00:43<00:11,  1.64it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 72/90 [00:44<00:11,  1.63it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 73/90 [00:45<00:10,  1.63it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 74/90 [00:45<00:09,  1.63it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 75/90 [00:46<00:09,  1.63it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 76/90 [00:46<00:08,  1.63it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 77/90 [00:47<00:07,  1.63it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 78/90 [00:48<00:07,  1.63it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 79/90 [00:48<00:06,  1.63it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 80/90 [00:49<00:06,  1.63it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 81/90 [00:50<00:05,  1.63it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 82/90 [00:50<00:04,  1.63it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 83/90 [00:51<00:04,  1.63it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 84/90 [00:51<00:03,  1.63it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 85/90 [00:52<00:03,  1.63it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 86/90 [00:53<00:02,  1.63it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 87/90 [00:53<00:01,  1.63it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 88/90 [00:54<00:01,  1.63it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 89/90 [00:54<00:00,  1.64it/s]                                               {'loss': 0.0026, 'grad_norm': 0.051761694252491, 'learning_rate': 0.0, 'epoch': 3.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:57<00:00,  1.64it/s]                                               {'train_runtime': 57.4921, 'train_samples_per_second': 36.37, 'train_steps_per_second': 1.565, 'train_loss': 0.15859165688355764, 'epoch': 3.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:57<00:00,  1.64it/s]2025-06-06 16:31:50,726 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:57<00:00,  1.57it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.34it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.68it/s]2025-06-06 16:31:52,764 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--f1/34c46321f42186df33a6260966e34a368f14868d9cc2ba47d142112e2800d233 (last modified on Mon Mar 17 17:18:24 2025) since it couldn't be found locally at evaluate-metric--f1, or remotely on the Hugging Face Hub.
2025-06-06 16:31:53,950 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--recall/11f90e583db35601050aed380d48e83202a896976b9608432fba9244fb447f24 (last modified on Mon Mar 17 17:18:25 2025) since it couldn't be found locally at evaluate-metric--recall, or remotely on the Hugging Face Hub.
2025-06-06 16:31:55,162 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--accuracy/f887c0aab52c2d38e1f8a215681126379eca617f96c447638f751434e8e65b14 (last modified on Mon Mar 17 17:18:23 2025) since it couldn't be found locally at evaluate-metric--accuracy, or remotely on the Hugging Face Hub.
2025-06-06 16:31:56,315 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--precision/155d3220d6cd4a6553f12da68eeb3d1f97cf431206304a4bc6e2d564c29502e9 (last modified on Mon Mar 17 17:18:26 2025) since it couldn't be found locally at evaluate-metric--precision, or remotely on the Hugging Face Hub.
2025-06-06 16:31:56,441 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:05<00:00,  1.81s/it]
2025-06-06 16:31:56,447 - INFO - Training time : 65.77849738090299
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.16it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.05it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.38it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.13it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.27it/s]2025-06-06 16:31:59,274 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--f1/34c46321f42186df33a6260966e34a368f14868d9cc2ba47d142112e2800d233 (last modified on Mon Mar 17 17:18:24 2025) since it couldn't be found locally at evaluate-metric--f1, or remotely on the Hugging Face Hub.
2025-06-06 16:32:00,444 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--recall/11f90e583db35601050aed380d48e83202a896976b9608432fba9244fb447f24 (last modified on Mon Mar 17 17:18:25 2025) since it couldn't be found locally at evaluate-metric--recall, or remotely on the Hugging Face Hub.
2025-06-06 16:32:01,590 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--accuracy/f887c0aab52c2d38e1f8a215681126379eca617f96c447638f751434e8e65b14 (last modified on Mon Mar 17 17:18:23 2025) since it couldn't be found locally at evaluate-metric--accuracy, or remotely on the Hugging Face Hub.
2025-06-06 16:32:02,738 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--precision/155d3220d6cd4a6553f12da68eeb3d1f97cf431206304a4bc6e2d564c29502e9 (last modified on Mon Mar 17 17:18:26 2025) since it couldn't be found locally at evaluate-metric--precision, or remotely on the Hugging Face Hub.
2025-06-06 16:32:02,862 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:06<00:00,  1.02s/it]
2025-06-06 16:32:02,867 - INFO - Evaluation time : 6.420019621029496
2025-06-06 16:32:02,867 - INFO - Evaluation results on test set: {'eval_loss': 0.04438643157482147, 'eval_f1': 0.9949238578680203, 'eval_recall': 1.0, 'eval_accuracy': 0.9924812030075187, 'eval_precision': 0.98989898989899, 'eval_optim_threshold': 0.9997859597206116, 'eval_AP': 1.0, 'eval_MCC': 0.9806202943118002, 'eval_NDCG': 1.0000000000000004, 'eval_kappa': 0.98043254376931, 'eval_runtime': 6.4154, 'eval_samples_per_second': 20.731, 'eval_steps_per_second': 0.935, 'epoch': 3.0}
2025-06-06 16:32:02,867 - INFO - Total updates (optimizer steps): 90
2025-06-06 16:32:02,867 - INFO - Avg time / step: 0.639s
2025-06-06 16:32:03,908 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCEdmis-lab/biobert-v1.13trials_fold-1
2025-06-06 16:32:03,908 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.19it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.07it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.39it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.13it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.28it/s]2025-06-06 16:32:06,703 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--f1/34c46321f42186df33a6260966e34a368f14868d9cc2ba47d142112e2800d233 (last modified on Mon Mar 17 17:18:24 2025) since it couldn't be found locally at evaluate-metric--f1, or remotely on the Hugging Face Hub.
2025-06-06 16:32:07,834 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--recall/11f90e583db35601050aed380d48e83202a896976b9608432fba9244fb447f24 (last modified on Mon Mar 17 17:18:25 2025) since it couldn't be found locally at evaluate-metric--recall, or remotely on the Hugging Face Hub.
2025-06-06 16:32:08,980 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--accuracy/f887c0aab52c2d38e1f8a215681126379eca617f96c447638f751434e8e65b14 (last modified on Mon Mar 17 17:18:23 2025) since it couldn't be found locally at evaluate-metric--accuracy, or remotely on the Hugging Face Hub.
2025-06-06 16:32:10,447 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:06<00:00,  1.04s/it]
2025-06-06 16:32:10,451 - INFO - Raw predictions shape: (133, 1)
2025-06-06 16:32:10,451 - INFO - Raw predictions: [[ 8.550074 ]
 [ 8.532619 ]
 [ 8.531438 ]
 [-6.0120034]
 [-6.0467076]
 [ 8.538515 ]
 [ 8.524033 ]
 [ 8.547999 ]
 [ 8.504928 ]
 [ 8.547211 ]]
2025-06-06 16:32:10,451 - INFO - Scores shape: (133,)
2025-06-06 16:32:10,451 - INFO - Scores: [0.9998066  0.9998031  0.9998029  0.00244319 0.00236005 0.9998043
 0.99980146 0.9998061  0.99979764 0.999806  ]
2025-06-06 16:32:10,451 - INFO - Preds shape: (133,)
2025-06-06 16:32:10,451 - INFO - Preds: [1 1 1 0 0 1 1 1 1 1]
2025-06-06 16:32:10,452 - INFO - Test labels shape: (133,)
2025-06-06 16:32:10,453 - INFO - Test labels: [1, 1, 1, 0, 0, 1, 1, 1, 1, 1]
2025-06-06 16:32:10,453 - INFO - Unique values in predictions: [0 1]
2025-06-06 16:32:10,454 - INFO - Unique values in labels: [0 1]
2025-06-06 16:32:10,455 - INFO - Confusion matrix:
[[34  1]
 [ 0 98]]
2025-06-06 16:32:10,457 - INFO - Confusion matrix: TN=34, FP=1, FN=0, TP=98
2025-06-06 16:32:17,247 - INFO - Metrics: {'f1': 0.9949238578680203, 'recall': 1.0, 'precision': 0.98989898989899, 'accuracy': 0.9924812030075187, 'AP': 1.0, 'MCC': 0.9806202943118002, 'NDCG': 1.0000000000000004, 'kappa': 0.98043254376931, 'TN': 34, 'FP': 1, 'FN': 0, 'TP': 98}
2025-06-06 16:32:17,368 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-06 16:32:17,459 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 16:32:17,459 - INFO - 
On test Set (optimal threshold of 0.9997826218605042 according to cross validation on the training set): 
2025-06-06 16:32:17,460 - INFO - Confusion matrix: TN=35, FP=0, FN=0, TP=98
2025-06-06 16:32:20,781 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 35, 'FP': 0, 'FN': 0, 'TP': 98}
2025-06-06 16:32:20,873 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 16:32:20,874 - INFO - Results for fold 1 : [{'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 35, 'FP': 0, 'FN': 0, 'TP': 98}]
2025-06-06 16:32:20,985 - INFO - Cleared CUDA cache. Memory allocated: 1.39 GB, Memory reserved: 1.76 GB
2025-06-06 16:32:20,985 - INFO - 
fold number 2 / 3
2025-06-06 16:32:20,992 - INFO - train split size : 697
2025-06-06 16:32:20,992 - INFO - dev split size : 67
2025-06-06 16:32:20,992 - INFO - test split size : 132
Map (num_proc=32):   0%|          | 0/697 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 22/697 [00:00<00:06, 107.45 examples/s]Map (num_proc=32):  22%|â–ˆâ–ˆâ–       | 154/697 [00:00<00:00, 590.36 examples/s]Map (num_proc=32):  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 286/697 [00:00<00:00, 834.30 examples/s]Map (num_proc=32):  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 418/697 [00:00<00:00, 981.36 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 550/697 [00:00<00:00, 1038.46 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 676/697 [00:00<00:00, 1075.41 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 697/697 [00:00<00:00, 796.69 examples/s] 
Map (num_proc=32):   0%|          | 0/67 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/67 [00:00<00:03, 18.74 examples/s]Map (num_proc=32):  22%|â–ˆâ–ˆâ–       | 15/67 [00:00<00:00, 65.72 examples/s]Map (num_proc=32):  37%|â–ˆâ–ˆâ–ˆâ–‹      | 25/67 [00:00<00:00, 77.52 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 35/67 [00:00<00:00, 83.06 examples/s]Map (num_proc=32):  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 47/67 [00:00<00:00, 90.42 examples/s]Map (num_proc=32):  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 57/67 [00:00<00:00, 91.90 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:00<00:00, 72.74 examples/s]
Map (num_proc=32):   0%|          | 0/132 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/132 [00:00<00:03, 33.18 examples/s]Map (num_proc=32):  24%|â–ˆâ–ˆâ–       | 32/132 [00:00<00:00, 135.97 examples/s]Map (num_proc=32):  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 56/132 [00:00<00:00, 158.80 examples/s]Map (num_proc=32):  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 84/132 [00:00<00:00, 188.71 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 104/132 [00:00<00:00, 187.69 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 128/132 [00:00<00:00, 202.71 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 132/132 [00:00<00:00, 155.06 examples/s]
2025-06-06 16:32:28,665 - INFO - 3 datasets tokenized successfully
2025-06-06 16:32:28,667 - INFO - Starting hyperparameter search for BCE loss
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-06_16-32-28   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_16-32-28
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-06_16-23-53_491015_3810507/artifacts/2025-06-06_16-32-28/train_hpo_2025-06-06_16-32-28/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-06 16:32:28. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_66f27a68   PENDING         8.49369       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_66f27a68 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_66f27a68 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          8.49369 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3823172)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3823172)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3817530)[0m 2025-06-06 16:30:50,256 - WARNING - Using the latest cached version of the module from /home/leandre/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--precision/155d3220d6cd4a6553f12da68eeb3d1f97cf431206304a4bc6e2d564c29502e9 (last modified on Mon Mar 17 17:18:26 2025) since it couldn't be found locally at evaluate-metric--precision, or remotely on the Hugging Face Hub.
[36m(train_hpo pid=3817530)[0m 2025-06-06 16:30:50,390 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3817530)[0m 2025-06-06 16:30:50,396 - INFO - eval_result: {'eval_loss': 4.029723167419434, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.5405051112174988, 'eval_AP': 0.9628529216348469, 'eval_MCC': 0.0, 'eval_NDCG': 0.9930064399324269, 'eval_kappa': 0.0, 'eval_runtime': 5.2332, 'eval_samples_per_second': 12.612, 'eval_steps_per_second': 0.764, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3817530)[0m 2025-06-06 16:30:50,432 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3823172)[0m 2025-06-06 16:32:36,558 - INFO - pos_weight value in TrainingArguments : 8.493688290834637
[36m(train_hpo pid=3823172)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3823172)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3823172)[0m [2025-06-06 16:32:36,798] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3817530)[0m {'eval_loss': 4.029723167419434, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.5405051112174988, 'eval_AP': 0.9628529216348469, 'eval_MCC': 0.0, 'eval_NDCG': 0.9930064399324269, 'eval_kappa': 0.0, 'eval_runtime': 5.2332, 'eval_samples_per_second': 12.612, 'eval_steps_per_second': 0.764, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3823172)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=48, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_bf19be9c started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_bf19be9c config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          7.54953 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3823334)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3823334)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3823334)[0m 2025-06-06 16:32:43,251 - INFO - pos_weight value in TrainingArguments : 7.549531688595925
[36m(train_hpo pid=3823334)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3823334)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3823334)[0m [2025-06-06 16:32:43,613] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3823334)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=40, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_70810b22 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_70810b22 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          8.94984 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3823575)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3823575)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3823575)[0m 2025-06-06 16:32:49,973 - INFO - pos_weight value in TrainingArguments : 8.949837496427758
[36m(train_hpo pid=3823575)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3823575)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3823575)[0m [2025-06-06 16:32:50,202] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3823575)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=24, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 3 RUNNING
Current time: 2025-06-06 16:32:58. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_66f27a68   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_bf19be9c   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_70810b22   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3823172)[0m {'loss': 1.7428, 'grad_norm': 5.635291576385498, 'learning_rate': 1.246338876535363e-06, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3823575)[0m {'loss': 1.2778, 'grad_norm': 9.949578285217285, 'learning_rate': 5.325452975187489e-05, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3823334)[0m {'loss': 1.8461, 'grad_norm': 8.350764274597168, 'learning_rate': 3.6443132246884782e-06, 'epoch': 0.9142857142857143}
Trial status: 3 RUNNING
Current time: 2025-06-06 16:33:29. Total running time: 1min 0s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_66f27a68   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_bf19be9c   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_70810b22   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3823172)[0m {'loss': 1.711, 'grad_norm': 5.727144718170166, 'learning_rate': 9.970711012282902e-07, 'epoch': 1.9142857142857141}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3823575)[0m {'train_runtime': 37.9539, 'train_samples_per_second': 55.093, 'train_steps_per_second': 0.632, 'train_loss': 0.5684134537974993, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3823575)[0m STATE at ending of training  :  
[36m(train_hpo pid=3823575)[0m TrainerState(epoch=2.914285714285714, global_step=24, max_steps=24, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=515590261431120.0, log_history=[{'loss': 1.2778, 'grad_norm': 9.949578285217285, 'learning_rate': 5.325452975187489e-05, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.3133, 'grad_norm': 3.207981586456299, 'learning_rate': 2.6627264875937445e-05, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 0.1141, 'grad_norm': 2.1254987716674805, 'learning_rate': 0.0, 'epoch': 2.914285714285714, 'step': 24}, {'train_runtime': 37.9539, 'train_samples_per_second': 55.093, 'train_steps_per_second': 0.632, 'total_flos': 515590261431120.0, 'train_loss': 0.5684134537974993, 'epoch': 2.914285714285714, 'step': 24}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3823575)[0m {'eval_loss': 0.18567068874835968, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9517695307731628, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.9266, 'eval_samples_per_second': 17.063, 'eval_steps_per_second': 1.019, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3823575)[0m 2025-06-06 16:33:35,255 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3823575)[0m 2025-06-06 16:33:35,261 - INFO - eval_result: {'eval_loss': 0.18567068874835968, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9517695307731628, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.9266, 'eval_samples_per_second': 17.063, 'eval_steps_per_second': 1.019, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3823575)[0m 2025-06-06 16:33:35,296 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB

Trial train_hpo_70810b22 finished iteration 1 at 2025-06-06 16:33:35. Total running time: 1min 6s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_70810b22 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    46.2063 â”‚
â”‚ time_total_s                        46.2063 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               2.91429 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                                  1 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                             1 â”‚
â”‚ eval_f1                                   1 â”‚
â”‚ eval_kappa                                1 â”‚
â”‚ eval_loss                           0.18567 â”‚
â”‚ eval_optim_threshold                0.95177 â”‚
â”‚ eval_precision                            1 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.9266 â”‚
â”‚ eval_samples_per_second              17.063 â”‚
â”‚ eval_steps_per_second                 1.019 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 16:33:35,320 - INFO - Cleaning up trial 70810b22
2025-06-06 16:33:35,320 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_16-32-28/train_hpo_70810b22_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512_2025-06-06_16-32-42

Trial train_hpo_70810b22 completed after 1 iterations at 2025-06-06 16:33:35. Total running time: 1min 6s
[36m(train_hpo pid=3823334)[0m {'loss': 1.5512, 'grad_norm': 9.649992942810059, 'learning_rate': 2.7332349185163582e-06, 'epoch': 1.9142857142857141}[32m [repeated 2x across cluster][0m

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 16:33:59. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_66f27a68   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_bf19be9c   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_70810b22   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            46.2063      0.185671           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3823172)[0m {'loss': 1.6908, 'grad_norm': 3.3891654014587402, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3823334)[0m {'loss': 1.2963, 'grad_norm': 12.474658012390137, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.914285714285714}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 16:34:29. Total running time: 2min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_66f27a68   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_bf19be9c   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_70810b22   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            46.2063      0.185671           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3823172)[0m {'loss': 1.6791, 'grad_norm': 1.6039173603057861, 'learning_rate': 4.985355506141451e-07, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3823334)[0m {'loss': 1.135, 'grad_norm': 11.930777549743652, 'learning_rate': 9.110783061721196e-07, 'epoch': 3.914285714285714}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 16:34:59. Total running time: 2min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_66f27a68   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_bf19be9c   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_70810b22   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            46.2063      0.185671           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3823172)[0m {'loss': 1.673, 'grad_norm': 10.113001823425293, 'learning_rate': 2.4926777530707256e-07, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3823334)[0m {'loss': 1.0774, 'grad_norm': 16.18769645690918, 'learning_rate': 0.0, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3823334)[0m {'train_runtime': 147.4273, 'train_samples_per_second': 23.639, 'train_steps_per_second': 0.271, 'train_loss': 1.3812080144882202, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3823334)[0m STATE at ending of training  :  TrainerState(epoch=4.914285714285715, global_step=40, max_steps=40, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=862780681664040.0, log_history=[{'loss': 1.8461, 'grad_norm': 8.350764274597168, 'learning_rate': 3.6443132246884782e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 1.5512, 'grad_norm': 9.649992942810059, 'learning_rate': 2.7332349185163582e-06, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 1.2963, 'grad_norm': 12.474658012390137, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 1.135, 'grad_norm': 11.930777549743652, 'learning_rate': 9.110783061721196e-07, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 1.0774, 'grad_norm': 16.18769645690918, 'learning_rate': 0.0, 'epoch': 4.914285714285715, 'step': 40}, {'train_runtime': 147.4273, 'train_samples_per_second': 23.639, 'train_steps_per_second': 0.271, 'total_flos': 862780681664040.0, 'train_loss': 1.3812080144882202, 'epoch': 4.914285714285715, 'step': 40}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3823334)[0m 2025-06-06 16:35:18,425 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3823334)[0m 2025-06-06 16:35:18,431 - INFO - eval_result: {'eval_loss': 1.9044126272201538, 'eval_f1': 0.875, 'eval_recall': 1.0, 'eval_accuracy': 0.7910447761194029, 'eval_precision': 0.7777777777777778, 'eval_optim_threshold': 0.7095145583152771, 'eval_AP': 1.0, 'eval_MCC': 0.41573970964154905, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 0.2947368421052631, 'eval_runtime': 4.2043, 'eval_samples_per_second': 15.936, 'eval_steps_per_second': 0.951, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3823334)[0m {'eval_loss': 1.9044126272201538, 'eval_f1': 0.875, 'eval_recall': 1.0, 'eval_accuracy': 0.7910447761194029, 'eval_precision': 0.7777777777777778, 'eval_optim_threshold': 0.7095145583152771, 'eval_AP': 1.0, 'eval_MCC': 0.41573970964154905, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 0.2947368421052631, 'eval_runtime': 4.2043, 'eval_samples_per_second': 15.936, 'eval_steps_per_second': 0.951, 'epoch': 4.914285714285715}

Trial train_hpo_bf19be9c finished iteration 1 at 2025-06-06 16:35:18. Total running time: 2min 49s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_bf19be9c result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    156.142 â”‚
â”‚ time_total_s                        156.142 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               4.91429 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                            0.41574 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                       0.79104 â”‚
â”‚ eval_f1                               0.875 â”‚
â”‚ eval_kappa                          0.29474 â”‚
â”‚ eval_loss                           1.90441 â”‚
â”‚ eval_optim_threshold                0.70951 â”‚
â”‚ eval_precision                      0.77778 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         4.2043 â”‚
â”‚ eval_samples_per_second              15.936 â”‚
â”‚ eval_steps_per_second                 0.951 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 16:35:18,488 - INFO - Cleaning up trial bf19be9c
2025-06-06 16:35:18,489 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_16-32-28/train_hpo_bf19be9c_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-06_16-32-35
2025-06-06 16:35:18,489 - INFO - Current best: 70810b22 with eval_f1 : 1.0 at iteration 1

Trial train_hpo_bf19be9c completed after 1 iterations at 2025-06-06 16:35:18. Total running time: 2min 49s
[36m(train_hpo pid=3823334)[0m 2025-06-06 16:35:18,465 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3823172)[0m STATE at ending of training  :  TrainerState(epoch=5.914285714285715, global_step=48, max_steps=48, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=1036432419038760.0, log_history=[{'loss': 1.7428, 'grad_norm': 5.635291576385498, 'learning_rate': 1.246338876535363e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 1.711, 'grad_norm': 5.727144718170166, 'learning_rate': 9.970711012282902e-07, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 1.6908, 'grad_norm': 3.3891654014587402, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 1.6791, 'grad_norm': 1.6039173603057861, 'learning_rate': 4.985355506141451e-07, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 1.673, 'grad_norm': 10.113001823425293, 'learning_rate': 2.4926777530707256e-07, 'epoch': 4.914285714285715, 'step': 40}, {'loss': 1.6281, 'grad_norm': 5.365055084228516, 'learning_rate': 0.0, 'epoch': 5.914285714285715, 'step': 48}, {'train_runtime': 160.8143, 'train_samples_per_second': 26.005, 'train_steps_per_second': 0.298, 'total_flos': 1036432419038760.0, 'train_loss': 1.6874547998110454, 'epoch': 5.914285714285715, 'step': 48}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3823172)[0m {'loss': 1.6281, 'grad_norm': 5.365055084228516, 'learning_rate': 0.0, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3823172)[0m {'train_runtime': 160.8143, 'train_samples_per_second': 26.005, 'train_steps_per_second': 0.298, 'train_loss': 1.6874547998110454, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3823172)[0m 2025-06-06 16:35:24,423 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3823172)[0m 2025-06-06 16:35:24,429 - INFO - eval_result: {'eval_loss': 3.265686273574829, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.6159778237342834, 'eval_AP': 0.8116288533395292, 'eval_MCC': 0.0, 'eval_NDCG': 0.906879843847252, 'eval_kappa': 0.0, 'eval_runtime': 3.5917, 'eval_samples_per_second': 18.654, 'eval_steps_per_second': 1.114, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3823172)[0m {'eval_loss': 3.265686273574829, 'eval_f1': 0.8448275862068966, 'eval_recall': 1.0, 'eval_accuracy': 0.7313432835820896, 'eval_precision': 0.7313432835820896, 'eval_optim_threshold': 0.6159778237342834, 'eval_AP': 0.8116288533395292, 'eval_MCC': 0.0, 'eval_NDCG': 0.906879843847252, 'eval_kappa': 0.0, 'eval_runtime': 3.5917, 'eval_samples_per_second': 18.654, 'eval_steps_per_second': 1.114, 'epoch': 5.914285714285715}

Trial train_hpo_66f27a68 finished iteration 1 at 2025-06-06 16:35:24. Total running time: 2min 55s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_66f27a68 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    168.882 â”‚
â”‚ time_total_s                        168.882 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               5.91429 â”‚
â”‚ eval_AP                             0.81163 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.90688 â”‚
â”‚ eval_accuracy                       0.73134 â”‚
â”‚ eval_f1                             0.84483 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           3.26569 â”‚
â”‚ eval_optim_threshold                0.61598 â”‚
â”‚ eval_precision                      0.73134 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.5917 â”‚
â”‚ eval_samples_per_second              18.654 â”‚
â”‚ eval_steps_per_second                 1.114 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 16:35:24,489 - INFO - Cleaning up trial 66f27a68
2025-06-06 16:35:24,489 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_16-32-28/train_hpo_66f27a68_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-06_16-32-28
2025-06-06 16:35:24,490 - INFO - Cleaning up trial bf19be9c
2025-06-06 16:35:24,490 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_16-32-28/train_hpo_bf19be9c_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-06_16-32-35
2025-06-06 16:35:24,490 - INFO - Current best: 70810b22 with eval_f1 : 1.0 at iteration 1

Trial train_hpo_66f27a68 completed after 1 iterations at 2025-06-06 16:35:24. Total running time: 2min 55s
2025-06-06 16:35:24,497	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_16-32-28' in 0.0052s.

Trial status: 3 TERMINATED
Current time: 2025-06-06 16:35:24. Total running time: 2min 55s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_66f27a68   TERMINATED        8.49369       1.49561e-06         0.13641                     6        1           168.882       3.26569     0.844828               1          0.731343 â”‚
â”‚ train_hpo_bf19be9c   TERMINATED        7.54953       4.55539e-06         0.123031                    5        1           156.142       1.90441     0.875                  1          0.791045 â”‚
â”‚ train_hpo_70810b22   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            46.2063      0.185671    1                      1          1        â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

2025-06-06 16:35:24,504 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x762928441310>
2025-06-06 16:35:24,504 - INFO - Best trial : train_hpo_70810b22
2025-06-06 16:35:24,504 - INFO - Best config : {'pos_weight': 8.949837496427758, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-06 16:35:24,504 - INFO - Best trial after optimization: {'eval_loss': 0.18567068874835968, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9517695307731628, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.9266, 'eval_samples_per_second': 17.063, 'eval_steps_per_second': 1.019, 'epoch': 2.914285714285714, 'timestamp': 1749220415, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '70810b22', 'date': '2025-06-06_16-33-35', 'time_this_iter_s': 46.2063250541687, 'time_total_s': 46.2063250541687, 'pid': 3823575, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 8.949837496427758, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 46.2063250541687, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512'}
2025-06-06 16:35:24,524 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   3.265686  0.844828  ...                        6  66f27a68
1   1.904413  0.875000  ...                        5  bf19be9c
2   0.185671  1.000000  ...                        3  70810b22

[3 rows x 32 columns]
[36m(train_hpo pid=3823172)[0m 2025-06-06 16:35:24,467 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
2025-06-06 16:35:24,711 - INFO - Trial comparison plot saved
2025-06-06 16:35:24,712 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-06 16:35:25,358 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-06-06 16:35:25,463 - INFO - training size : 697
2025-06-06 16:35:25,463 - INFO - dev size : 67
2025-06-06 16:35:25,463 - INFO - test size : 132
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
  0%|          | 0/90 [00:00<?, ?it/s]  1%|          | 1/90 [00:00<00:57,  1.55it/s]  2%|â–         | 2/90 [00:01<00:55,  1.59it/s]  3%|â–Ž         | 3/90 [00:01<00:54,  1.61it/s]  4%|â–         | 4/90 [00:02<00:53,  1.61it/s]  6%|â–Œ         | 5/90 [00:03<00:52,  1.62it/s]  7%|â–‹         | 6/90 [00:03<00:51,  1.62it/s]  8%|â–Š         | 7/90 [00:04<00:51,  1.62it/s]  9%|â–‰         | 8/90 [00:04<00:50,  1.62it/s] 10%|â–ˆ         | 9/90 [00:05<00:49,  1.62it/s] 11%|â–ˆ         | 10/90 [00:06<00:49,  1.62it/s] 12%|â–ˆâ–        | 11/90 [00:06<00:48,  1.62it/s] 13%|â–ˆâ–Ž        | 12/90 [00:07<00:48,  1.62it/s] 14%|â–ˆâ–        | 13/90 [00:08<00:47,  1.62it/s] 16%|â–ˆâ–Œ        | 14/90 [00:08<00:46,  1.62it/s] 17%|â–ˆâ–‹        | 15/90 [00:09<00:46,  1.62it/s] 18%|â–ˆâ–Š        | 16/90 [00:09<00:45,  1.62it/s] 19%|â–ˆâ–‰        | 17/90 [00:10<00:45,  1.62it/s] 20%|â–ˆâ–ˆ        | 18/90 [00:11<00:44,  1.62it/s] 21%|â–ˆâ–ˆ        | 19/90 [00:11<00:43,  1.62it/s] 22%|â–ˆâ–ˆâ–       | 20/90 [00:12<00:43,  1.62it/s] 23%|â–ˆâ–ˆâ–Ž       | 21/90 [00:12<00:42,  1.63it/s] 24%|â–ˆâ–ˆâ–       | 22/90 [00:13<00:41,  1.62it/s] 26%|â–ˆâ–ˆâ–Œ       | 23/90 [00:14<00:41,  1.63it/s] 27%|â–ˆâ–ˆâ–‹       | 24/90 [00:14<00:40,  1.63it/s] 28%|â–ˆâ–ˆâ–Š       | 25/90 [00:15<00:39,  1.63it/s] 29%|â–ˆâ–ˆâ–‰       | 26/90 [00:16<00:39,  1.62it/s] 30%|â–ˆâ–ˆâ–ˆ       | 27/90 [00:16<00:38,  1.62it/s] 31%|â–ˆâ–ˆâ–ˆ       | 28/90 [00:17<00:38,  1.62it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 29/90 [00:17<00:37,  1.64it/s]                                               {'loss': 0.4511, 'grad_norm': 0.2772945463657379, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 30/90 [00:17<00:36,  1.64it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 31/90 [00:18<00:28,  2.04it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 32/90 [00:19<00:30,  1.92it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 33/90 [00:19<00:31,  1.83it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 34/90 [00:20<00:31,  1.77it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 35/90 [00:21<00:31,  1.72it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 36/90 [00:21<00:31,  1.69it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 37/90 [00:22<00:31,  1.67it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 38/90 [00:22<00:31,  1.66it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 39/90 [00:23<00:30,  1.65it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 40/90 [00:24<00:30,  1.64it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 41/90 [00:24<00:29,  1.64it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 42/90 [00:25<00:29,  1.64it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 43/90 [00:25<00:28,  1.63it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 44/90 [00:26<00:28,  1.63it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 45/90 [00:27<00:27,  1.63it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 46/90 [00:27<00:27,  1.63it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 47/90 [00:28<00:26,  1.63it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 48/90 [00:29<00:25,  1.63it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 49/90 [00:29<00:25,  1.62it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 50/90 [00:30<00:24,  1.62it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 51/90 [00:30<00:24,  1.62it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 52/90 [00:31<00:23,  1.62it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 53/90 [00:32<00:22,  1.62it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 54/90 [00:32<00:22,  1.62it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 55/90 [00:33<00:21,  1.62it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 56/90 [00:33<00:20,  1.62it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 57/90 [00:34<00:20,  1.62it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 58/90 [00:35<00:19,  1.62it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 59/90 [00:35<00:18,  1.64it/s]                                               {'loss': 0.0032, 'grad_norm': 0.019421575590968132, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 60/90 [00:35<00:18,  1.64it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 61/90 [00:36<00:14,  2.06it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 62/90 [00:37<00:14,  1.93it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 63/90 [00:37<00:14,  1.84it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 64/90 [00:38<00:14,  1.78it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 65/90 [00:38<00:14,  1.73it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 66/90 [00:39<00:14,  1.70it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 67/90 [00:40<00:13,  1.68it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 68/90 [00:40<00:13,  1.66it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 69/90 [00:41<00:12,  1.65it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 70/90 [00:42<00:12,  1.64it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 71/90 [00:42<00:11,  1.63it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 72/90 [00:43<00:11,  1.63it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 73/90 [00:43<00:10,  1.63it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 74/90 [00:44<00:09,  1.63it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 75/90 [00:45<00:09,  1.63it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 76/90 [00:45<00:08,  1.63it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 77/90 [00:46<00:07,  1.63it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 78/90 [00:46<00:07,  1.62it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 79/90 [00:47<00:06,  1.62it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 80/90 [00:48<00:06,  1.63it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 81/90 [00:48<00:05,  1.63it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 82/90 [00:49<00:04,  1.62it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 83/90 [00:50<00:04,  1.62it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 84/90 [00:50<00:03,  1.62it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 85/90 [00:51<00:03,  1.62it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 86/90 [00:51<00:02,  1.63it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 87/90 [00:52<00:01,  1.62it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 88/90 [00:53<00:01,  1.63it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 89/90 [00:53<00:00,  1.64it/s]                                               {'loss': 0.0009, 'grad_norm': 0.01934669353067875, 'learning_rate': 0.0, 'epoch': 3.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.64it/s]                                               {'train_runtime': 56.5041, 'train_samples_per_second': 37.006, 'train_steps_per_second': 1.593, 'train_loss': 0.15172240446425148, 'epoch': 3.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.64it/s]2025-06-06 16:36:22,425 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:56<00:00,  1.59it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.25it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.42it/s]2025-06-06 16:36:26,368 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:03<00:00,  1.21s/it]
2025-06-06 16:36:26,374 - INFO - Training time : 61.66243752790615
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.14it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.03it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.37it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.12it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.33it/s]2025-06-06 16:36:30,898 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.42it/s]
2025-06-06 16:36:30,903 - INFO - Evaluation time : 4.5291455530095845
2025-06-06 16:36:30,903 - INFO - Evaluation results on test set: {'eval_loss': 0.0014141035499051213, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.9993763566017151, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000004, 'eval_kappa': 1.0, 'eval_runtime': 4.5249, 'eval_samples_per_second': 29.172, 'eval_steps_per_second': 1.326, 'epoch': 3.0}
2025-06-06 16:36:30,903 - INFO - Total updates (optimizer steps): 90
2025-06-06 16:36:30,903 - INFO - Avg time / step: 0.628s
2025-06-06 16:36:32,032 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCEdmis-lab/biobert-v1.13trials_fold-2
2025-06-06 16:36:32,032 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.16it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.04it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.37it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.11it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.35it/s]2025-06-06 16:36:36,534 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:04<00:00,  1.43it/s]
2025-06-06 16:36:36,538 - INFO - Raw predictions shape: (132, 1)
2025-06-06 16:36:36,539 - INFO - Raw predictions: [[ 8.585511]
 [ 8.513341]
 [-8.058667]
 [ 8.569816]
 [ 8.572835]
 [ 8.572337]
 [ 8.508399]
 [ 8.569749]
 [ 8.565928]
 [-7.997693]]
2025-06-06 16:36:36,539 - INFO - Scores shape: (132,)
2025-06-06 16:36:36,539 - INFO - Scores: [9.9981326e-01 9.9979931e-01 3.1624810e-04 9.9981028e-01 9.9981087e-01
 9.9981076e-01 9.9979824e-01 9.9981028e-01 9.9980956e-01 3.3612442e-04]
2025-06-06 16:36:36,539 - INFO - Preds shape: (132,)
2025-06-06 16:36:36,539 - INFO - Preds: [1 1 0 1 1 1 1 1 1 0]
2025-06-06 16:36:36,540 - INFO - Test labels shape: (132,)
2025-06-06 16:36:36,541 - INFO - Test labels: [1, 1, 0, 1, 1, 1, 1, 1, 1, 0]
2025-06-06 16:36:36,541 - INFO - Unique values in predictions: [0 1]
2025-06-06 16:36:36,541 - INFO - Unique values in labels: [0 1]
2025-06-06 16:36:36,543 - INFO - Confusion matrix:
[[34  0]
 [ 0 98]]
2025-06-06 16:36:36,544 - INFO - Confusion matrix: TN=34, FP=0, FN=0, TP=98
2025-06-06 16:36:39,882 - INFO - Metrics: {'f1': 1.0, 'recall': 1.0, 'precision': 1.0, 'accuracy': 1.0, 'AP': 1.0, 'MCC': 1.0, 'NDCG': 1.0000000000000004, 'kappa': 1.0, 'TN': 34, 'FP': 0, 'FN': 0, 'TP': 98}
2025-06-06 16:36:40,000 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-06 16:36:40,095 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 16:36:40,096 - INFO - 
On test Set (optimal threshold of 0.9997970461845398 according to cross validation on the training set): 
2025-06-06 16:36:40,097 - INFO - Confusion matrix: TN=34, FP=0, FN=8, TP=90
2025-06-06 16:36:43,132 - INFO - Metrics: {'f1': 0.9574468085106383, 'recall': 0.9183673469387755, 'precision': 1.0, 'accuracy': 0.9393939393939394, 'AP': 1.0, 'MCC': 0.8622298030317391, 'NDCG': 1.0000000000000004, 'kappa': 0.8528428093645485, 'TN': 34, 'FP': 0, 'FN': 8, 'TP': 90}
2025-06-06 16:36:43,226 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 16:36:43,226 - INFO - Results for fold 2 : [{'f1': 0.9574468085106383, 'recall': 0.9183673469387755, 'precision': 1.0, 'accuracy': 0.9393939393939394, 'AP': 1.0, 'MCC': 0.8622298030317391, 'NDCG': 1.0000000000000004, 'kappa': 0.8528428093645485, 'TN': 34, 'FP': 0, 'FN': 8, 'TP': 90}]
2025-06-06 16:36:43,356 - INFO - Cleared CUDA cache. Memory allocated: 1.40 GB, Memory reserved: 1.78 GB
2025-06-06 16:36:43,356 - INFO - 
fold number 3 / 3
2025-06-06 16:36:43,363 - INFO - train split size : 697
2025-06-06 16:36:43,363 - INFO - dev split size : 67
2025-06-06 16:36:43,363 - INFO - test split size : 132
Map (num_proc=32):   0%|          | 0/697 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 22/697 [00:00<00:06, 107.24 examples/s]Map (num_proc=32):  22%|â–ˆâ–ˆâ–       | 154/697 [00:00<00:00, 543.76 examples/s]Map (num_proc=32):  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 308/697 [00:00<00:00, 844.67 examples/s]Map (num_proc=32):  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 418/697 [00:00<00:00, 914.17 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 550/697 [00:00<00:00, 983.15 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 697/697 [00:00<00:00, 1071.54 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 697/697 [00:00<00:00, 763.88 examples/s] 
Map (num_proc=32):   0%|          | 0/67 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 3/67 [00:00<00:03, 17.81 examples/s]Map (num_proc=32):  25%|â–ˆâ–ˆâ–Œ       | 17/67 [00:00<00:00, 67.65 examples/s]Map (num_proc=32):  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 29/67 [00:00<00:00, 84.51 examples/s]Map (num_proc=32):  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 41/67 [00:00<00:00, 94.76 examples/s]Map (num_proc=32):  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 53/67 [00:00<00:00, 97.48 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 65/67 [00:00<00:00, 102.54 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 67/67 [00:00<00:00, 78.58 examples/s] 
Map (num_proc=32):   0%|          | 0/132 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/132 [00:00<00:04, 29.38 examples/s]Map (num_proc=32):  21%|â–ˆâ–ˆ        | 28/132 [00:00<00:00, 118.70 examples/s]Map (num_proc=32):  36%|â–ˆâ–ˆâ–ˆâ–‹      | 48/132 [00:00<00:00, 147.54 examples/s]Map (num_proc=32):  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 68/132 [00:00<00:00, 157.32 examples/s]Map (num_proc=32):  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 96/132 [00:00<00:00, 190.80 examples/s]Map (num_proc=32):  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 116/132 [00:00<00:00, 192.32 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 132/132 [00:00<00:00, 145.46 examples/s]
2025-06-06 16:36:51,766 - INFO - 3 datasets tokenized successfully
2025-06-06 16:36:51,768 - INFO - Starting hyperparameter search for BCE loss
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-06_16-36-51   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_16-36-51
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-06_16-23-53_491015_3810507/artifacts/2025-06-06_16-36-51/train_hpo_2025-06-06_16-36-51/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-06 16:36:51. Total running time: 0s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_4e1469b3   PENDING         8.49369       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_4e1469b3 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_4e1469b3 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          8.49369 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3828533)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3828533)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3828533)[0m 2025-06-06 16:36:59,469 - INFO - pos_weight value in TrainingArguments : 8.493688290834637
[36m(train_hpo pid=3828533)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3828533)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3828533)[0m [2025-06-06 16:36:59,704] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3828533)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=48, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_b2d398ff started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_b2d398ff config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          7.54953 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3828698)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3828698)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3828698)[0m 2025-06-06 16:37:06,441 - INFO - pos_weight value in TrainingArguments : 7.549531688595925
[36m(train_hpo pid=3828698)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3828698)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3828698)[0m [2025-06-06 16:37:06,824] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3828698)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=40, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_10a764f1 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_10a764f1 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          8.94984 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3829058)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3829058)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3829058)[0m 2025-06-06 16:37:13,057 - INFO - pos_weight value in TrainingArguments : 8.949837496427758
[36m(train_hpo pid=3829058)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3829058)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3829058)[0m [2025-06-06 16:37:13,287] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3829058)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=24, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 3 RUNNING
Current time: 2025-06-06 16:37:22. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_4e1469b3   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_b2d398ff   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_10a764f1   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3828533)[0m {'loss': 1.7335, 'grad_norm': 5.896033763885498, 'learning_rate': 1.246338876535363e-06, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3829058)[0m {'loss': 1.5154, 'grad_norm': 14.894394874572754, 'learning_rate': 5.325452975187489e-05, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3828698)[0m {'loss': 1.583, 'grad_norm': 2.3730297088623047, 'learning_rate': 3.6443132246884782e-06, 'epoch': 0.9142857142857143}
Trial status: 3 RUNNING
Current time: 2025-06-06 16:37:52. Total running time: 1min 0s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_4e1469b3   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_b2d398ff   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_10a764f1   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3828533)[0m {'loss': 1.6557, 'grad_norm': 5.973997592926025, 'learning_rate': 9.970711012282902e-07, 'epoch': 1.9142857142857141}[32m [repeated 2x across cluster][0m
[36m(train_hpo pid=3829058)[0m {'train_runtime': 37.9275, 'train_samples_per_second': 55.132, 'train_steps_per_second': 0.633, 'train_loss': 0.8488731384277344, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3829058)[0m STATE at ending of training  :  TrainerState(epoch=2.914285714285714, global_step=24, max_steps=24, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=515014711165200.0, log_history=[{'loss': 1.5154, 'grad_norm': 14.894394874572754, 'learning_rate': 5.325452975187489e-05, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.7382, 'grad_norm': 6.788540840148926, 'learning_rate': 2.6627264875937445e-05, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 0.293, 'grad_norm': 5.287402629852295, 'learning_rate': 0.0, 'epoch': 2.914285714285714, 'step': 24}, {'train_runtime': 37.9275, 'train_samples_per_second': 55.132, 'train_steps_per_second': 0.633, 'total_flos': 515014711165200.0, 'train_loss': 0.8488731384277344, 'epoch': 2.914285714285714, 'step': 24}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_10a764f1 finished iteration 1 at 2025-06-06 16:37:57. Total running time: 1min 6s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_10a764f1 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    45.7959 â”‚
â”‚ time_total_s                        45.7959 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               2.91429 â”‚
â”‚ eval_AP                             0.99883 â”‚
â”‚ eval_MCC                            0.80107 â”‚
â”‚ eval_NDCG                            0.9998 â”‚
â”‚ eval_accuracy                       0.92537 â”‚
â”‚ eval_f1                             0.95238 â”‚
â”‚ eval_kappa                          0.78176 â”‚
â”‚ eval_loss                           0.48626 â”‚
â”‚ eval_optim_threshold                0.91772 â”‚
â”‚ eval_precision                      0.90909 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.3346 â”‚
â”‚ eval_samples_per_second              20.092 â”‚
â”‚ eval_steps_per_second                   1.2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 16:37:57,893 - INFO - Cleaning up trial 10a764f1
2025-06-06 16:37:57,893 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_16-36-51/train_hpo_10a764f1_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512_2025-06-06_16-37-05

Trial train_hpo_10a764f1 completed after 1 iterations at 2025-06-06 16:37:57. Total running time: 1min 6s
[36m(train_hpo pid=3829058)[0m {'eval_loss': 0.48626214265823364, 'eval_f1': 0.9523809523809523, 'eval_recall': 1.0, 'eval_accuracy': 0.9253731343283582, 'eval_precision': 0.9090909090909091, 'eval_optim_threshold': 0.9177249670028687, 'eval_AP': 0.9988307692307693, 'eval_MCC': 0.8010688047518291, 'eval_NDCG': 0.9997983839371136, 'eval_kappa': 0.7817589576547231, 'eval_runtime': 3.3346, 'eval_samples_per_second': 20.092, 'eval_steps_per_second': 1.2, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3829058)[0m 2025-06-06 16:37:57,825 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3829058)[0m 2025-06-06 16:37:57,831 - INFO - eval_result: {'eval_loss': 0.48626214265823364, 'eval_f1': 0.9523809523809523, 'eval_recall': 1.0, 'eval_accuracy': 0.9253731343283582, 'eval_precision': 0.9090909090909091, 'eval_optim_threshold': 0.9177249670028687, 'eval_AP': 0.9988307692307693, 'eval_MCC': 0.8010688047518291, 'eval_NDCG': 0.9997983839371136, 'eval_kappa': 0.7817589576547231, 'eval_runtime': 3.3346, 'eval_samples_per_second': 20.092, 'eval_steps_per_second': 1.2, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3829058)[0m 2025-06-06 16:37:57,868 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3828698)[0m {'loss': 1.4841, 'grad_norm': 2.526170015335083, 'learning_rate': 2.7332349185163582e-06, 'epoch': 1.9142857142857141}[32m [repeated 2x across cluster][0m

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 16:38:22. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_4e1469b3   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_b2d398ff   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_10a764f1   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.7959      0.486262    0.952381               1          0.925373 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3828533)[0m {'loss': 1.6232, 'grad_norm': 3.5555193424224854, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.914285714285714}
*** SIGTERM received at time=1749220704 on cpu 0 ***
PC: @     0x763373098d71  (unknown)  (unknown)
    @     0x763373045330  1465280768  (unknown)
    @     0x76337309bc8e        224  pthread_cond_timedwait
    @     0x76325dc1f41f       1184  ray::core::GetRequest::Wait()
    @     0x76325dc216a7       1424  ray::core::CoreWorkerMemoryStore::GetImpl()
    @     0x76325dc229e7       1360  ray::core::CoreWorkerMemoryStore::Wait()
    @     0x76325db42640       1776  ray::core::CoreWorker::Wait()
    @     0x76325da3367b        352  __pyx_pw_3ray_7_raylet_10CoreWorker_61wait()
    @     0x7633737eab77  (unknown)  _PyEval_EvalFrameDefault
[2025-06-06 16:38:24,599 E 3810507 3810507] logging.cc:497: *** SIGTERM received at time=1749220704 on cpu 0 ***
[2025-06-06 16:38:24,599 E 3810507 3810507] logging.cc:497: PC: @     0x763373098d71  (unknown)  (unknown)
[2025-06-06 16:38:24,599 E 3810507 3810507] logging.cc:497:     @     0x763373045330  1465280768  (unknown)
[2025-06-06 16:38:24,599 E 3810507 3810507] logging.cc:497:     @     0x76337309bc8e        224  pthread_cond_timedwait
[2025-06-06 16:38:24,599 E 3810507 3810507] logging.cc:497:     @     0x76325dc1f41f       1184  ray::core::GetRequest::Wait()
[2025-06-06 16:38:24,599 E 3810507 3810507] logging.cc:497:     @     0x76325dc216a7       1424  ray::core::CoreWorkerMemoryStore::GetImpl()
[2025-06-06 16:38:24,599 E 3810507 3810507] logging.cc:497:     @     0x76325dc229e7       1360  ray::core::CoreWorkerMemoryStore::Wait()
[2025-06-06 16:38:24,599 E 3810507 3810507] logging.cc:497:     @     0x76325db42640       1776  ray::core::CoreWorker::Wait()
[2025-06-06 16:38:24,599 E 3810507 3810507] logging.cc:497:     @     0x76325da3367b        352  __pyx_pw_3ray_7_raylet_10CoreWorker_61wait()
[2025-06-06 16:38:24,599 E 3810507 3810507] logging.cc:497:     @     0x7633737eab77  (unknown)  _PyEval_EvalFrameDefault
