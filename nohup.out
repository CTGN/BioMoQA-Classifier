[36m(train_hpo pid=3776703)[0m 2025-06-06 16:00:46,331 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3776703)[0m {'eval_loss': 2.9163174629211426, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.6410346627235413, 'eval_AP': 0.9739286793607881, 'eval_MCC': 0.0, 'eval_NDCG': 0.9948719535702539, 'eval_kappa': 0.0, 'eval_runtime': 3.9165, 'eval_samples_per_second': 16.852, 'eval_steps_per_second': 1.021, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3776703)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3776703)[0m   warnings.warn(
2025-06-06 16:00:53,508	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8266 [39m[22m
[36m(train_hpo pid=3776871)[0m {'loss': 1.5274, 'grad_norm': 13.547627449035645, 'learning_rate': 0.0, 'epoch': 4.914285714285715}
2025-06-06 16:00:54,253 - INFO - Random seeds set to 42
2025-06-06 16:00:54,359 - INFO - Optional negatives loaded from CSV with 5000 entries.
2025-06-06 16:00:54,359 - INFO - Loading original negatives...
2025-06-06 16:00:54,368 - INFO - Negatives column names: ['Article ID', 'Title', 'Author', 'Publication year', 'Title secondary', 'URL', 'DOI', 'Abstract', 'Criteria for exclusion A', ' Criteria for exclusion B', ' Criteria for exclusion C', 'labels', 'Keywords']
2025-06-06 16:00:54,368 - INFO - Loading original positives...
2025-06-06 16:00:54,386 - INFO - Positives column names: ['Article ID', 'Title', 'Author', 'Secondary authors', 'Keywords', 'title of unpublished reference', 'primary date', 'publication year', 'notes', 'reprint status', 'start page number', 'ending page number', 'periodical full name', 'periodical standard abbreviation', 'periodical in which article was published', 'periodical name - user abbreviation 1', 'periodical name - user abbreviation 2', 'volume number', 'issue number', 'title secondary', 'city of publication', 'publisher', 'user definable 1', 'user definable 5', 'title series', 'Abstract', 'ISSN/ISBN', 'availability', 'Misc. 1', 'Misc. 2', 'address', 'Web/URL', 'link to PDF', 'link to full-text', 'related records', 'images', 'DOI', 'labels']
2025-06-06 16:00:54,392 - INFO - Class balance:
labels
1    326
0    123
Name: count, dtype: int64
2025-06-06 16:00:54,392 - INFO -    Article ID  ...  Criteria for exclusion C
0       12959  ...                       NaN
1       13470  ...                       NaN
2        4686  ...                       NaN
3        2503  ...                       NaN
4        2951  ...                       NaN

[5 rows x 44 columns]
2025-06-06 16:00:54,417 - INFO - Original dataset size: 449
2025-06-06 16:00:54,417 - INFO - Optional negatives size: 5000
2025-06-06 16:00:54,423 - INFO - Optional negatives:                                                title  ... labels
0  Towards evidence-based conservation of subterr...  ...     -1
1                  Marine biodiversity conservation.  ...     -1
2  Climate teleconnections modulate global burned...  ...     -1
3  Integrating carbon sequestration and biodivers...  ...     -1
4  Principle, technique and application of grassl...  ...     -1

[5 rows x 7 columns]
2025-06-06 16:00:54,426 - INFO - Combined dataset size: 949
2025-06-06 16:00:54,427 - INFO - Before cleaning, head:
                                               title  ... labels
0  Feral pig (Sus scrofa) disturbance facilitates...  ...      1
1  Effects of woody plant diversity on abovegroun...  ...      1
2  Scaling species richness and endemism of tropi...  ...      1
3  Not as the crow flies: Assessing effective iso...  ...      0
4  Species-group concepts and biogeography of the...  ...      1

[5 rows x 5 columns]
2025-06-06 16:00:54,432 - INFO - Null counts before cleaning:
title        0
abstract     0
Keywords     8
doi         37
labels       0
dtype: int64
2025-06-06 16:00:54,436 - INFO - Total duplicate title: 0
2025-06-06 16:00:54,442 - INFO - Conflicts on title (same value, multiple labels):
Empty DataFrame
Columns: [title, n_labels]
Index: []
2025-06-06 16:00:54,445 - INFO - Total duplicate abstract: 0
2025-06-06 16:00:54,454 - INFO - Conflicts on abstract (same value, multiple labels):
Empty DataFrame
Columns: [abstract, n_labels]
Index: []
2025-06-06 16:00:54,456 - INFO - Total duplicate doi: 18
2025-06-06 16:00:54,460 - INFO - Conflicts on doi (same value, multiple labels):
Empty DataFrame
Columns: [doi, n_labels]
Index: []
2025-06-06 16:00:54,460 - INFO - Cleaned dataset size: 896
2025-06-06 16:00:54,461 - INFO - Numnber of positives : 293
2025-06-06 16:00:54,461 - INFO - Numnber of negatives : 603
2025-06-06 16:00:54,462 - INFO - clean_og_df size : 397
2025-06-06 16:00:54,462 - INFO - opt_neg_df size : 499
2025-06-06 16:00:54,467 - INFO - Fold 1:
2025-06-06 16:00:54,467 - INFO -   Train label distribution: {-1: 0.7159253945480631, 1: 0.20946915351506457, 0: 0.0746054519368723}
2025-06-06 16:00:54,467 - INFO -   Test label distribution: {1: 0.7368421052631579, 0: 0.2631578947368421}
2025-06-06 16:00:54,469 - INFO - Fold 2:
2025-06-06 16:00:54,469 - INFO -   Train label distribution: {-1: 0.7159253945480631, 1: 0.20946915351506457, 0: 0.0746054519368723}
2025-06-06 16:00:54,470 - INFO -   Test label distribution: {1: 0.7424242424242424, 0: 0.25757575757575757}
2025-06-06 16:00:54,472 - INFO - Fold 3:
2025-06-06 16:00:54,472 - INFO -   Train label distribution: {-1: 0.7159253945480631, 1: 0.20946915351506457, 0: 0.0746054519368723}
2025-06-06 16:00:54,472 - INFO -   Test label distribution: {1: 0.7348484848484849, 0: 0.26515151515151514}
2025-06-06 16:00:54,476 - INFO - Fold 1:
2025-06-06 16:00:54,476 - INFO -   Train label distribution: {-1: 0.7159253945480631, 1: 0.20946915351506457, 0: 0.0746054519368723}
2025-06-06 16:00:54,476 - INFO -   Test label distribution: {1: 0.7368421052631579, 0: 0.2631578947368421}
2025-06-06 16:00:54,478 - INFO - Fold 2:
2025-06-06 16:00:54,478 - INFO -   Train label distribution: {-1: 0.7159253945480631, 1: 0.20946915351506457, 0: 0.0746054519368723}
2025-06-06 16:00:54,478 - INFO -   Test label distribution: {1: 0.7424242424242424, 0: 0.25757575757575757}
2025-06-06 16:00:54,481 - INFO - Fold 3:
2025-06-06 16:00:54,481 - INFO -   Train label distribution: {-1: 0.7159253945480631, 1: 0.20946915351506457, 0: 0.0746054519368723}
2025-06-06 16:00:54,481 - INFO -   Test label distribution: {1: 0.7348484848484849, 0: 0.26515151515151514}
2025-06-06 16:00:54,481 - INFO - Indices of clean_df remain the same after resetting.
2025-06-06 16:00:54,503 - INFO - clean_df index : RangeIndex(start=0, stop=896, step=1)
Stringifying the column:   0%|          | 0/896 [00:00<?, ? examples/s]Stringifying the column: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 896/896 [00:00<00:00, 149237.41 examples/s]
Casting to class labels:   0%|          | 0/896 [00:00<?, ? examples/s]Casting to class labels: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 896/896 [00:00<00:00, 162913.84 examples/s]
2025-06-06 16:00:54,521 - INFO - Number of positives : 293
2025-06-06 16:00:54,522 - INFO - Number of negatives : 603
2025-06-06 16:00:54,526 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=98
[36m(train_hpo pid=3776871)[0m 2025-06-06 16:00:57,577 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3776871)[0m {'eval_loss': 3.6611313819885254, 'eval_f1': 0.8828828828828829, 'eval_recall': 1.0, 'eval_accuracy': 0.803030303030303, 'eval_precision': 0.7903225806451613, 'eval_optim_threshold': 0.5183560252189636, 'eval_AP': 0.9808786896629174, 'eval_MCC': 0.4312287725435882, 'eval_NDCG': 0.996488746291074, 'eval_kappa': 0.3136, 'eval_runtime': 3.94, 'eval_samples_per_second': 16.751, 'eval_steps_per_second': 1.015, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3776871)[0m {'train_runtime': 147.5611, 'train_samples_per_second': 23.617, 'train_steps_per_second': 0.271, 'train_loss': 1.7082629442214965, 'epoch': 4.914285714285715}
2025-06-06 16:00:57,623 - INFO - Metrics: {'f1': 0.8484848484848485, 'recall': 1.0, 'precision': 0.7368421052631579, 'accuracy': 0.7368421052631579, 'AP': 0.7368421052631579, 'MCC': 0.0, 'NDCG': 0.9189307109272616, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 98}
2025-06-06 16:00:57,626 - INFO - Confusion matrix: TN=35, FP=0, FN=98, TP=0
2025-06-06 16:00:57,671	ERROR tune_controller.py:1331 -- Trial task failed for trial train_hpo_f4c3f5e5
Traceback (most recent call last):
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
             ^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(FileNotFoundError): [36mray::ImplicitFunc.train()[39m (pid=3776871, ip=172.30.120.56, actor_id=0568439029c13c5690541a8401000000, repr=train_hpo)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/ray/tune/trainable/trainable.py", line 330, in train
    raise skipped from exception_cause(skipped)
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/ray/air/_internal/util.py", line 107, in run
    self._ret = self._target(*self._args, **self._kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/ray/tune/trainable/function_trainable.py", line 45, in <lambda>
    training_func=lambda: self._trainable_func(self.config),
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/ray/tune/trainable/function_trainable.py", line 261, in _trainable_func
    output = fn()
             ^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/ray/tune/trainable/util.py", line 130, in inner
    return trainable(config, **fn_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/binary_pipeline.py", line 167, in train_hpo
    eval_result = trainer.evaluate()
    ^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/trainer.py", line 2241, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/trainer.py", line 2697, in _inner_training_loop
    if not os.path.samefile(checkpoint, self.state.best_model_checkpoint):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen genericpath>", line 101, in samefile
FileNotFoundError: [Errno 2] No such file or directory: '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/models/checkpoint-40'

Trial train_hpo_f4c3f5e5 errored after 0 iterations at 2025-06-06 16:00:57. Total running time: 2min 46s
Error file: /tmp/ray/session_2025-06-06_15-57-44_212754_3773245/artifacts/2025-06-06_15-58-09/train_hpo_2025-06-06_15-58-09/driver_artifacts/train_hpo_f4c3f5e5_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-06_15-58-18/error.txt
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-06-06 16:01:00,484 - INFO - Metrics: {'f1': 0.0, 'recall': 0.0, 'precision': 0.0, 'accuracy': 0.2631578947368421, 'AP': 0.7368421052631579, 'MCC': 0.0, 'NDCG': 0.9189307109272616, 'kappa': 0.0, 'TN': 35, 'FP': 0, 'FN': 98, 'TP': 0}
2025-06-06 16:01:00,488 - INFO - Confusion matrix: TN=0, FP=34, FN=0, TP=98
2025-06-06 16:01:03,545 - INFO - Metrics: {'f1': 0.8521739130434782, 'recall': 1.0, 'precision': 0.7424242424242424, 'accuracy': 0.7424242424242424, 'AP': 0.7424242424242424, 'MCC': 0.0, 'NDCG': 0.9208012714375936, 'kappa': 0.0, 'TN': 0, 'FP': 34, 'FN': 0, 'TP': 98}
2025-06-06 16:01:03,548 - INFO - Confusion matrix: TN=34, FP=0, FN=98, TP=0
[36m(train_hpo pid=3776703)[0m {'loss': 1.546, 'grad_norm': 3.943988800048828, 'learning_rate': 0.0, 'epoch': 5.914285714285715}
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-06-06 16:01:06,463 - INFO - Metrics: {'f1': 0.0, 'recall': 0.0, 'precision': 0.0, 'accuracy': 0.25757575757575757, 'AP': 0.7424242424242424, 'MCC': 0.0, 'NDCG': 0.9208012714375936, 'kappa': 0.0, 'TN': 34, 'FP': 0, 'FN': 98, 'TP': 0}
2025-06-06 16:01:06,467 - INFO - Confusion matrix: TN=0, FP=35, FN=0, TP=97
2025-06-06 16:01:06,818	ERROR tune_controller.py:1331 -- Trial task failed for trial train_hpo_86afae34
Traceback (most recent call last):
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/ray/air/execution/_internal/event_manager.py", line 110, in resolve_future
    result = ray.get(future)
             ^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 2782, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/ray/_private/worker.py", line 929, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(FileNotFoundError): [36mray::ImplicitFunc.train()[39m (pid=3776703, ip=172.30.120.56, actor_id=682e2afa9ccd9a8b1bf30d1201000000, repr=train_hpo)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/ray/tune/trainable/trainable.py", line 330, in train
    raise skipped from exception_cause(skipped)
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/ray/air/_internal/util.py", line 107, in run
    self._ret = self._target(*self._args, **self._kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/ray/tune/trainable/function_trainable.py", line 45, in <lambda>
    training_func=lambda: self._trainable_func(self.config),
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/ray/tune/trainable/function_trainable.py", line 261, in _trainable_func
    output = fn()
             ^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/ray/tune/trainable/util.py", line 130, in inner
    return trainable(config, **fn_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/binary_pipeline.py", line 167, in train_hpo
    eval_result = trainer.evaluate()
    ^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/trainer.py", line 2241, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/trainer.py", line 2697, in _inner_training_loop
    if not os.path.samefile(checkpoint, self.state.best_model_checkpoint):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen genericpath>", line 101, in samefile
FileNotFoundError: [Errno 2] No such file or directory: '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/models/checkpoint-8'

Trial train_hpo_86afae34 errored after 0 iterations at 2025-06-06 16:01:06. Total running time: 2min 55s
Error file: /tmp/ray/session_2025-06-06_15-57-44_212754_3773245/artifacts/2025-06-06_15-58-09/train_hpo_2025-06-06_15-58-09/driver_artifacts/train_hpo_86afae34_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-06_15-58-11/error.txt
2025-06-06 16:01:06,824	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_15-58-09' in 0.0036s.

Trial status: 3 ERROR
Current time: 2025-06-06 16:01:06. Total running time: 2min 55s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_86afae34   ERROR           8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_f4c3f5e5   ERROR           7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_ffd7bcc6   ERROR           8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Number of errored trials: 3
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name             # failures   error file                                                                                                                                                                                                                                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_86afae34              1   /tmp/ray/session_2025-06-06_15-57-44_212754_3773245/artifacts/2025-06-06_15-58-09/train_hpo_2025-06-06_15-58-09/driver_artifacts/train_hpo_86afae34_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-06_15-58-11/error.txt â”‚
â”‚ train_hpo_f4c3f5e5              1   /tmp/ray/session_2025-06-06_15-57-44_212754_3773245/artifacts/2025-06-06_15-58-09/train_hpo_2025-06-06_15-58-09/driver_artifacts/train_hpo_f4c3f5e5_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-06_15-58-18/error.txt â”‚
â”‚ train_hpo_ffd7bcc6              1   /tmp/ray/session_2025-06-06_15-57-44_212754_3773245/artifacts/2025-06-06_15-58-09/train_hpo_2025-06-06_15-58-09/driver_artifacts/train_hpo_ffd7bcc6_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512_2025-06-06_15-58-25/error.txt â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Traceback (most recent call last):
  File "/home/leandre/Projects/BioMoQA_Playground/experiments/biomoqa.py", line 54, in <module>
    main()
  File "/home/leandre/Projects/BioMoQA_Playground/experiments/biomoqa.py", line 41, in main
    pipeline.whole_pipeline()
  File "/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/binary_pipeline.py", line 529, in whole_pipeline
    self.store_metrics(self.result_metrics)
                    ^^^^^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/binary_pipeline.py", line 460, in run_pipeline
    
  File "/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/binary_pipeline.py", line 253, in train
    wrapped_trainable,
           ^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/ray/tune/tune.py", line 1035, in run
    raise TuneError("Trials did not complete", incomplete_trials)
ray.tune.error.TuneError: ('Trials did not complete', [train_hpo_86afae34, train_hpo_f4c3f5e5, train_hpo_ffd7bcc6])
[36m(train_hpo pid=3776703)[0m {'eval_loss': 2.891878128051758, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.641955554485321, 'eval_AP': 0.9759138003948454, 'eval_MCC': 0.0, 'eval_NDCG': 0.9952915219803924, 'eval_kappa': 0.0, 'eval_runtime': 3.2268, 'eval_samples_per_second': 20.454, 'eval_steps_per_second': 1.24, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3776703)[0m {'train_runtime': 163.6345, 'train_samples_per_second': 25.557, 'train_steps_per_second': 0.293, 'train_loss': 1.6124297976493835, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3776703)[0m 2025-06-06 16:01:06,793 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
2025-06-06 16:01:09,233 - INFO - Metrics: {'f1': 0.8471615720524017, 'recall': 1.0, 'precision': 0.7348484848484849, 'accuracy': 0.7348484848484849, 'AP': 0.7348484848484849, 'MCC': 0.0, 'NDCG': 0.9181159076123374, 'kappa': 0.0, 'TN': 0, 'FP': 35, 'FN': 0, 'TP': 97}
2025-06-06 16:01:09,235 - INFO - Confusion matrix: TN=35, FP=0, FN=97, TP=0
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
2025-06-06 16:01:12,260 - INFO - Metrics: {'f1': 0.0, 'recall': 0.0, 'precision': 0.0, 'accuracy': 0.26515151515151514, 'AP': 0.7348484848484849, 'MCC': 0.0, 'NDCG': 0.9181159076123374, 'kappa': 0.0, 'TN': 35, 'FP': 0, 'FN': 97, 'TP': 0}
2025-06-06 16:01:12,263 - INFO - Pipeline for loss type None and ensemble=True
2025-06-06 16:01:12,263 - INFO - with_title : True
2025-06-06 16:01:12,263 - INFO - with_keywords : True
2025-06-06 16:01:12,263 - INFO - fold indexes for run no.1: [[159, 206, 117, 82, 317, 330, 131, 380, 183, 158, 213, 260, 155, 332, 303, 269, 40, 232, 314, 244, 168, 218, 254, 100, 3, 235, 105, 243, 352, 394, 196, 223, 230, 307, 342, 289, 135, 7, 189, 134, 78, 133, 12, 375, 109, 46, 62, 393, 167, 151, 387, 374, 276, 323, 132, 319, 114, 176, 322, 263, 258, 266, 250, 329, 309, 367, 24, 229, 370, 211, 228, 346, 115, 392, 87, 88, 81, 343, 253, 278, 43, 333, 28, 80, 191, 10, 378, 388, 225, 363, 136, 104, 356, 8, 57, 162, 220, 391, 139, 386, 282, 70, 61, 170, 102, 296, 64, 35, 4, 251, 279, 44, 373, 129, 236, 327, 187, 68, 245, 215, 18, 42, 116, 212, 376, 148, 126, 27, 252, 173, 103, 336, 209, 199, 169, 283, 32, 246, 292, 210, 247, 141, 73, 194, 59, 385, 354, 51, 305, 200, 344, 179, 178, 355, 313, 112, 291, 23, 328, 130, 315, 181, 138, 94, 95, 121, 207, 175, 295, 321, 34, 300, 262, 33, 341, 54, 299, 48, 30, 204, 123, 331, 301, 150, 157, 265, 14, 53, 396, 242, 377, 366, 93, 214, 83, 52, 6, 188, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 532, 533, 534, 535, 536, 537, 538, 539, 540, 541, 542, 543, 544, 545, 546, 547, 548, 549, 550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 560, 561, 562, 563, 564, 565, 566, 567, 568, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582, 583, 584, 585, 586, 587, 588, 589, 590, 591, 592, 593, 594, 595, 596, 597, 598, 599, 600, 601, 602, 603, 604, 605, 606, 607, 608, 609, 610, 611, 612, 613, 614, 615, 616, 617, 618, 619, 620, 621, 622, 623, 624, 625, 626, 627, 628, 629, 630, 631, 632, 633, 634, 635, 636, 637, 638, 639, 640, 641, 642, 643, 644, 645, 646, 647, 648, 649, 650, 651, 652, 653, 654, 655, 656, 657, 658, 659, 660, 661, 662, 663, 664, 665, 666, 667, 668, 669, 670, 671, 672, 673, 674, 675, 676, 677, 678, 679, 680, 681, 682, 683, 684, 685, 686, 687, 688, 689, 690, 691, 692, 693, 694, 695, 696, 697, 698, 699, 700, 701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 714, 715, 716, 717, 718, 719, 720, 721, 722, 723, 724, 725, 726, 727, 728, 729, 730, 731, 732, 733, 734, 735, 736, 737, 738, 739, 740, 741, 742, 743, 744, 745, 746, 747, 748, 749, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764, 765, 766, 767, 768, 769, 770, 771, 772, 773, 774, 775, 776, 777, 778, 779, 780, 781, 782, 783, 784, 785, 786, 787, 788, 789, 790, 791, 792, 793, 794, 795, 796, 797, 798, 799, 800, 801, 802, 803, 804, 805, 806, 807, 808, 809, 810, 811, 812, 813, 814, 815, 816, 817, 818, 819, 820, 821, 822, 823, 824, 825, 826, 827, 828, 829, 830, 831, 832, 833, 834, 835, 836, 837, 838, 839, 840, 841, 842, 843, 844, 845, 846, 847, 848, 849, 850, 851, 852, 853, 854, 855, 856, 857, 858, 859, 860, 861, 862, 863, 864, 865, 866, 867, 868, 869, 870, 871, 872, 873, 874, 875, 876, 877, 878, 879, 880, 881, 882, 883, 884, 885, 886, 887, 888, 889, 890, 891, 892, 893, 894, 895], [177, 268, 97, 248, 298, 320, 224, 137, 161, 145, 339, 98, 39, 66, 17, 325, 226, 91, 348, 67, 55, 237, 273, 353, 381, 261, 31, 2, 290, 107, 38, 113, 120, 1, 222, 84, 358, 202, 63, 337, 92, 99, 144, 256, 19, 171, 219, 285, 274, 174, 118, 233, 156, 324, 284, 190, 255, 357, 205, 111, 72, 384, 294, 71, 163, 217], [0, 5, 9, 11, 13, 15, 16, 20, 21, 22, 25, 26, 29, 36, 37, 41, 45, 47, 49, 50, 56, 58, 60, 65, 69, 74, 75, 76, 77, 79, 85, 86, 89, 90, 96, 101, 106, 108, 110, 119, 122, 124, 125, 127, 128, 140, 142, 143, 146, 147, 149, 152, 153, 154, 160, 164, 165, 166, 172, 180, 182, 184, 185, 186, 192, 193, 195, 197, 198, 201, 203, 208, 216, 221, 227, 231, 234, 238, 239, 240, 241, 249, 257, 259, 264, 267, 270, 271, 272, 275, 277, 280, 281, 286, 287, 288, 293, 297, 302, 304, 306, 308, 310, 311, 312, 316, 318, 326, 334, 335, 338, 340, 345, 347, 349, 350, 351, 359, 360, 361, 362, 364, 365, 368, 369, 371, 372, 379, 382, 383, 389, 390, 395]]
2025-06-06 16:01:12,263 - INFO - Run no 1/2
2025-06-06 16:01:12,263 - INFO - Loss Type : BCE
2025-06-06 16:01:12,263 - INFO - Ensemble learning pipeline
2025-06-06 16:01:12,263 - INFO - Training model 1/2: dmis-lab/biobert-v1.1
2025-06-06 16:01:12,708 - INFO - 
fold number 1 / 3
2025-06-06 16:01:12,714 - INFO - train split size : 697
2025-06-06 16:01:12,714 - INFO - dev split size : 66
2025-06-06 16:01:12,714 - INFO - test split size : 133
Map (num_proc=32):   0%|          | 0/697 [00:00<?, ? examples/s]Map (num_proc=32):   3%|â–Ž         | 22/697 [00:00<00:05, 121.06 examples/s]Map (num_proc=32):  16%|â–ˆâ–Œ        | 110/697 [00:00<00:01, 422.48 examples/s]Map (num_proc=32):  28%|â–ˆâ–ˆâ–Š       | 198/697 [00:00<00:00, 567.34 examples/s]Map (num_proc=32):  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 308/697 [00:00<00:00, 710.78 examples/s]Map (num_proc=32):  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 396/697 [00:00<00:00, 736.54 examples/s]Map (num_proc=32):  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 484/697 [00:00<00:00, 741.47 examples/s]Map (num_proc=32):  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 571/697 [00:00<00:00, 740.49 examples/s]Map (num_proc=32):  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 655/697 [00:00<00:00, 721.38 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 697/697 [00:01<00:00, 607.70 examples/s]
Map (num_proc=32):   0%|          | 0/66 [00:00<?, ? examples/s]Map (num_proc=32):   5%|â–         | 3/66 [00:00<00:02, 23.17 examples/s]Map (num_proc=32):  21%|â–ˆâ–ˆ        | 14/66 [00:00<00:00, 55.41 examples/s]Map (num_proc=32):  36%|â–ˆâ–ˆâ–ˆâ–‹      | 24/66 [00:00<00:00, 66.40 examples/s]Map (num_proc=32):  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 32/66 [00:00<00:00, 67.92 examples/s]Map (num_proc=32):  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 40/66 [00:00<00:00, 67.69 examples/s]Map (num_proc=32):  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 48/66 [00:00<00:00, 69.85 examples/s]Map (num_proc=32):  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 56/66 [00:00<00:00, 70.50 examples/s]Map (num_proc=32):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 64/66 [00:00<00:00, 69.94 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 66/66 [00:01<00:00, 61.54 examples/s]
Map (num_proc=32):   0%|          | 0/133 [00:00<?, ? examples/s]Map (num_proc=32):   4%|â–         | 5/133 [00:00<00:03, 41.32 examples/s]Map (num_proc=32):  19%|â–ˆâ–‰        | 25/133 [00:00<00:00, 123.60 examples/s]Map (num_proc=32):  34%|â–ˆâ–ˆâ–ˆâ–      | 45/133 [00:00<00:00, 135.68 examples/s]Map (num_proc=32):  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 61/133 [00:00<00:00, 137.09 examples/s]Map (num_proc=32):  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 77/133 [00:00<00:00, 135.99 examples/s]Map (num_proc=32):  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 97/133 [00:00<00:00, 135.92 examples/s]Map (num_proc=32):  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 117/133 [00:00<00:00, 139.22 examples/s]Map (num_proc=32): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 133/133 [00:01<00:00, 124.24 examples/s]
2025-06-06 16:01:17,758 - INFO - 3 datasets tokenized successfully
2025-06-06 16:01:17,760 - INFO - Starting hyperparameter search for BCE loss
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-06-06_16-01-17   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 3                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_16-01-17
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-06-06_16-00-52_311826_3780138/artifacts/2025-06-06_16-01-17/train_hpo_2025-06-06_16-01-17/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-06-06 16:01:19. Total running time: 0s
Logical resource usage: 0/32 CPUs, 0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_6be8f470   PENDING         8.49369       1.49561e-06          0.13641                    6 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_6be8f470 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_6be8f470 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          6 â”‚
â”‚ pos_weight                          8.49369 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3784374)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3784374)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3784374)[0m 2025-06-06 16:01:27,620 - INFO - pos_weight value in TrainingArguments : 8.493688290834637
[36m(train_hpo pid=3784374)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3784374)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3784374)[0m [2025-06-06 16:01:27,874] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3784374)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=48, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3784374)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3784374)[0m   warnings.warn(

Trial train_hpo_0994f0ce started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_0994f0ce config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          5 â”‚
â”‚ pos_weight                          7.54953 â”‚
â”‚ weight_decay                        0.12303 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3784608)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3784608)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3784608)[0m 2025-06-06 16:01:34,357 - INFO - pos_weight value in TrainingArguments : 7.549531688595925
[36m(train_hpo pid=3784608)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3784608)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3784608)[0m [2025-06-06 16:01:34,758] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3784608)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=40, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3784608)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3784608)[0m   warnings.warn(

Trial train_hpo_ffe3a7c8 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_ffe3a7c8 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                         8e-05 â”‚
â”‚ num_train_epochs                          3 â”‚
â”‚ pos_weight                          8.94984 â”‚
â”‚ weight_decay                        0.25122 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3784842)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=3784842)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=3784842)[0m 2025-06-06 16:01:41,377 - INFO - pos_weight value in TrainingArguments : 8.949837496427758
[36m(train_hpo pid=3784842)[0m /home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=3784842)[0m   super().__init__(*args, **kwargs)
[36m(train_hpo pid=3784842)[0m [2025-06-06 16:01:41,622] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=3784842)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=24, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3784842)[0m /home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
[36m(train_hpo pid=3784842)[0m   warnings.warn(

Trial status: 3 RUNNING
Current time: 2025-06-06 16:01:49. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_6be8f470   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_0994f0ce   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_ffe3a7c8   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3784374)[0m {'loss': 1.8619, 'grad_norm': 9.323253631591797, 'learning_rate': 1.246338876535363e-06, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3784842)[0m {'loss': 1.2992, 'grad_norm': 5.4384660720825195, 'learning_rate': 5.325452975187489e-05, 'epoch': 0.9142857142857143}
[36m(train_hpo pid=3784608)[0m {'loss': 1.5213, 'grad_norm': 2.4911608695983887, 'learning_rate': 3.6443132246884782e-06, 'epoch': 0.9142857142857143}
Trial status: 3 RUNNING
Current time: 2025-06-06 16:02:19. Total running time: 1min 0s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_6be8f470   RUNNING         8.49369       1.49561e-06         0.13641                     6 â”‚
â”‚ train_hpo_0994f0ce   RUNNING         7.54953       4.55539e-06         0.123031                    5 â”‚
â”‚ train_hpo_ffe3a7c8   RUNNING         8.94984       7.98818e-05         0.251217                    3 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3784374)[0m {'loss': 1.7852, 'grad_norm': 8.485607147216797, 'learning_rate': 9.970711012282902e-07, 'epoch': 1.9142857142857141}[32m [repeated 2x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(train_hpo pid=3784842)[0m {'train_runtime': 37.8124, 'train_samples_per_second': 55.299, 'train_steps_per_second': 0.635, 'train_loss': 0.5835495591163635, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3784842)[0m STATE at ending of training  :  TrainerState(epoch=2.914285714285714, global_step=24, max_steps=24, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=3, num_input_tokens_seen=0, total_flos=515096932631760.0, log_history=[{'loss': 1.2992, 'grad_norm': 5.4384660720825195, 'learning_rate': 5.325452975187489e-05, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 0.3467, 'grad_norm': 2.666044235229492, 'learning_rate': 2.6627264875937445e-05, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 0.1047, 'grad_norm': 1.4851659536361694, 'learning_rate': 0.0, 'epoch': 2.914285714285714, 'step': 24}, {'train_runtime': 37.8124, 'train_samples_per_second': 55.299, 'train_steps_per_second': 0.635, 'total_flos': 515096932631760.0, 'train_loss': 0.5835495591163635, 'epoch': 2.914285714285714, 'step': 24}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial train_hpo_ffe3a7c8 finished iteration 1 at 2025-06-06 16:02:26. Total running time: 1min 6s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_ffe3a7c8 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    45.6724 â”‚
â”‚ time_total_s                        45.6724 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               2.91429 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                                  1 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                             1 â”‚
â”‚ eval_f1                                   1 â”‚
â”‚ eval_kappa                                1 â”‚
â”‚ eval_loss                           0.11921 â”‚
â”‚ eval_optim_threshold                0.79416 â”‚
â”‚ eval_precision                            1 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.4145 â”‚
â”‚ eval_samples_per_second              19.329 â”‚
â”‚ eval_steps_per_second                 1.171 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3784842)[0m 2025-06-06 16:02:26,091 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3784842)[0m 2025-06-06 16:02:26,097 - INFO - eval_result: {'eval_loss': 0.11921478062868118, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.7941555380821228, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.4145, 'eval_samples_per_second': 19.329, 'eval_steps_per_second': 1.171, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3784842)[0m 2025-06-06 16:02:26,133 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3784842)[0m {'eval_loss': 0.11921478062868118, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.7941555380821228, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.4145, 'eval_samples_per_second': 19.329, 'eval_steps_per_second': 1.171, 'epoch': 2.914285714285714}
2025-06-06 16:02:26,157 - INFO - Cleaning up trial ffe3a7c8
2025-06-06 16:02:26,157 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_16-01-17/train_hpo_ffe3a7c8_3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512_2025-06-06_16-01-33

Trial train_hpo_ffe3a7c8 completed after 1 iterations at 2025-06-06 16:02:26. Total running time: 1min 6s
[36m(train_hpo pid=3784608)[0m {'loss': 1.4406, 'grad_norm': 5.054454803466797, 'learning_rate': 2.7332349185163582e-06, 'epoch': 1.9142857142857141}[32m [repeated 2x across cluster][0m

Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 16:02:49. Total running time: 1min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_6be8f470   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_0994f0ce   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_ffe3a7c8   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.6723      0.119215           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3784374)[0m {'loss': 1.7209, 'grad_norm': 5.644618988037109, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.914285714285714}
[36m(train_hpo pid=3784608)[0m {'loss': 1.3719, 'grad_norm': 5.737361431121826, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.914285714285714}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 16:03:19. Total running time: 2min 0s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_6be8f470   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_0994f0ce   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_ffe3a7c8   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.6723      0.119215           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3784374)[0m {'loss': 1.6765, 'grad_norm': 4.1273908615112305, 'learning_rate': 4.985355506141451e-07, 'epoch': 3.914285714285714}
[36m(train_hpo pid=3784608)[0m {'loss': 1.3142, 'grad_norm': 5.73431396484375, 'learning_rate': 9.110783061721196e-07, 'epoch': 3.914285714285714}
Trial status: 2 RUNNING | 1 TERMINATED
Current time: 2025-06-06 16:03:49. Total running time: 2min 30s
Logical resource usage: 20.0/32 CPUs, 2.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_6be8f470   RUNNING           8.49369       1.49561e-06         0.13641                     6                                                                                         â”‚
â”‚ train_hpo_0994f0ce   RUNNING           7.54953       4.55539e-06         0.123031                    5                                                                                         â”‚
â”‚ train_hpo_ffe3a7c8   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.6723      0.119215           1               1                 1 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=3784374)[0m {'loss': 1.6406, 'grad_norm': 9.970988273620605, 'learning_rate': 2.4926777530707256e-07, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3784608)[0m {'loss': 1.2512, 'grad_norm': 5.072885513305664, 'learning_rate': 0.0, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3784608)[0m {'train_runtime': 149.305, 'train_samples_per_second': 23.341, 'train_steps_per_second': 0.268, 'train_loss': 1.3798181056976317, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3784608)[0m STATE at ending of training  :  TrainerState(epoch=4.914285714285715, global_step=40, max_steps=40, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=5, num_input_tokens_seen=0, total_flos=862318185914640.0, log_history=[{'loss': 1.5213, 'grad_norm': 2.4911608695983887, 'learning_rate': 3.6443132246884782e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 1.4406, 'grad_norm': 5.054454803466797, 'learning_rate': 2.7332349185163582e-06, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 1.3719, 'grad_norm': 5.737361431121826, 'learning_rate': 1.8221566123442391e-06, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 1.3142, 'grad_norm': 5.73431396484375, 'learning_rate': 9.110783061721196e-07, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 1.2512, 'grad_norm': 5.072885513305664, 'learning_rate': 0.0, 'epoch': 4.914285714285715, 'step': 40}, {'train_runtime': 149.305, 'train_samples_per_second': 23.341, 'train_steps_per_second': 0.268, 'total_flos': 862318185914640.0, 'train_loss': 1.3798181056976317, 'epoch': 4.914285714285715, 'step': 40}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3784608)[0m {'eval_loss': 1.8694227933883667, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.6862355470657349, 'eval_AP': 1.0, 'eval_MCC': 0.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 0.0, 'eval_runtime': 4.2254, 'eval_samples_per_second': 15.62, 'eval_steps_per_second': 0.947, 'epoch': 4.914285714285715}
[36m(train_hpo pid=3784608)[0m 2025-06-06 16:04:11,430 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3784608)[0m 2025-06-06 16:04:11,436 - INFO - eval_result: {'eval_loss': 1.8694227933883667, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.6862355470657349, 'eval_AP': 1.0, 'eval_MCC': 0.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 0.0, 'eval_runtime': 4.2254, 'eval_samples_per_second': 15.62, 'eval_steps_per_second': 0.947, 'epoch': 4.914285714285715}

Trial train_hpo_0994f0ce finished iteration 1 at 2025-06-06 16:04:11. Total running time: 2min 52s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_0994f0ce result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    158.043 â”‚
â”‚ time_total_s                        158.043 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               4.91429 â”‚
â”‚ eval_AP                                   1 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                                 1 â”‚
â”‚ eval_accuracy                       0.74242 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                           1.86942 â”‚
â”‚ eval_optim_threshold                0.68624 â”‚
â”‚ eval_precision                      0.74242 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         4.2254 â”‚
â”‚ eval_samples_per_second               15.62 â”‚
â”‚ eval_steps_per_second                 0.947 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 16:04:11,495 - INFO - Cleaning up trial 0994f0ce
2025-06-06 16:04:11,495 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_16-01-17/train_hpo_0994f0ce_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-06_16-01-26
2025-06-06 16:04:11,495 - INFO - Current best: ffe3a7c8 with eval_f1 : 1.0 at iteration 1

Trial train_hpo_0994f0ce completed after 1 iterations at 2025-06-06 16:04:11. Total running time: 2min 52s
[36m(train_hpo pid=3784608)[0m 2025-06-06 16:04:11,472 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
[36m(train_hpo pid=3784374)[0m STATE at ending of training  :  TrainerState(epoch=5.914285714285715, global_step=48, max_steps=48, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=20, num_train_epochs=6, num_input_tokens_seen=0, total_flos=1035969923289360.0, log_history=[{'loss': 1.8619, 'grad_norm': 9.323253631591797, 'learning_rate': 1.246338876535363e-06, 'epoch': 0.9142857142857143, 'step': 8}, {'loss': 1.7852, 'grad_norm': 8.485607147216797, 'learning_rate': 9.970711012282902e-07, 'epoch': 1.9142857142857141, 'step': 16}, {'loss': 1.7209, 'grad_norm': 5.644618988037109, 'learning_rate': 7.478033259212177e-07, 'epoch': 2.914285714285714, 'step': 24}, {'loss': 1.6765, 'grad_norm': 4.1273908615112305, 'learning_rate': 4.985355506141451e-07, 'epoch': 3.914285714285714, 'step': 32}, {'loss': 1.6406, 'grad_norm': 9.970988273620605, 'learning_rate': 2.4926777530707256e-07, 'epoch': 4.914285714285715, 'step': 40}, {'loss': 1.6047, 'grad_norm': 6.833569049835205, 'learning_rate': 0.0, 'epoch': 5.914285714285715, 'step': 48}, {'train_runtime': 162.895, 'train_samples_per_second': 25.673, 'train_steps_per_second': 0.295, 'total_flos': 1035969923289360.0, 'train_loss': 1.7149634559949238, 'epoch': 5.914285714285715, 'step': 48}], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=3784374)[0m {'loss': 1.6047, 'grad_norm': 6.833569049835205, 'learning_rate': 0.0, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3784374)[0m {'train_runtime': 162.895, 'train_samples_per_second': 25.673, 'train_steps_per_second': 0.295, 'train_loss': 1.7149634559949238, 'epoch': 5.914285714285715}

Trial train_hpo_6be8f470 finished iteration 1 at 2025-06-06 16:04:17. Total running time: 2min 58s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_6be8f470 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    170.956 â”‚
â”‚ time_total_s                        170.956 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               5.91429 â”‚
â”‚ eval_AP                             0.98307 â”‚
â”‚ eval_MCC                                  0 â”‚
â”‚ eval_NDCG                           0.99687 â”‚
â”‚ eval_accuracy                       0.74242 â”‚
â”‚ eval_f1                             0.85217 â”‚
â”‚ eval_kappa                                0 â”‚
â”‚ eval_loss                            3.6226 â”‚
â”‚ eval_optim_threshold                0.56038 â”‚
â”‚ eval_precision                      0.74242 â”‚
â”‚ eval_recall                               1 â”‚
â”‚ eval_runtime                         3.4056 â”‚
â”‚ eval_samples_per_second               19.38 â”‚
â”‚ eval_steps_per_second                 1.175 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
2025-06-06 16:04:17,503 - INFO - Cleaning up trial 6be8f470
2025-06-06 16:04:17,503 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_16-01-17/train_hpo_6be8f470_1_learning_rate=0.0000,num_train_epochs=6,pos_weight=8.4937,weight_decay=0.1364_2025-06-06_16-01-19
2025-06-06 16:04:17,503 - INFO - Cleaning up trial 0994f0ce
2025-06-06 16:04:17,503 - INFO - Trial path: /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_16-01-17/train_hpo_0994f0ce_2_learning_rate=0.0000,num_train_epochs=5,pos_weight=7.5495,weight_decay=0.1230_2025-06-06_16-01-26
2025-06-06 16:04:17,503 - INFO - Current best: ffe3a7c8 with eval_f1 : 1.0 at iteration 1

Trial train_hpo_6be8f470 completed after 1 iterations at 2025-06-06 16:04:17. Total running time: 2min 58s
2025-06-06 16:04:17,511	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/results/biomoqa/ray_results/train_hpo_2025-06-06_16-01-17' in 0.0066s.

Trial status: 3 TERMINATED
Current time: 2025-06-06 16:04:17. Total running time: 2min 58s
Logical resource usage: 10.0/32 CPUs, 1.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1     eval_recall     eval_accuracy â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_6be8f470   TERMINATED        8.49369       1.49561e-06         0.13641                     6        1           170.956       3.6226      0.852174               1          0.742424 â”‚
â”‚ train_hpo_0994f0ce   TERMINATED        7.54953       4.55539e-06         0.123031                    5        1           158.043       1.86942     0.852174               1          0.742424 â”‚
â”‚ train_hpo_ffe3a7c8   TERMINATED        8.94984       7.98818e-05         0.251217                    3        1            45.6723      0.119215    1                      1          1        â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

2025-06-06 16:04:17,518 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x7902629e1550>
2025-06-06 16:04:17,518 - INFO - Best trial : train_hpo_ffe3a7c8
2025-06-06 16:04:17,518 - INFO - Best config : {'pos_weight': 8.949837496427758, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}
2025-06-06 16:04:17,519 - INFO - Best trial after optimization: {'eval_loss': 0.11921478062868118, 'eval_f1': 1.0, 'eval_recall': 1.0, 'eval_accuracy': 1.0, 'eval_precision': 1.0, 'eval_optim_threshold': 0.7941555380821228, 'eval_AP': 1.0, 'eval_MCC': 1.0, 'eval_NDCG': 1.0000000000000002, 'eval_kappa': 1.0, 'eval_runtime': 3.4145, 'eval_samples_per_second': 19.329, 'eval_steps_per_second': 1.171, 'epoch': 2.914285714285714, 'timestamp': 1749218546, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': 'ffe3a7c8', 'date': '2025-06-06_16-02-26', 'time_this_iter_s': 45.67234659194946, 'time_total_s': 45.67234659194946, 'pid': 3784842, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 8.949837496427758, 'learning_rate': 7.988179462781234e-05, 'weight_decay': 0.2512165066659852, 'num_train_epochs': 3}, 'time_since_restore': 45.67234659194946, 'iterations_since_restore': 1, 'experiment_tag': '3_learning_rate=0.0001,num_train_epochs=3,pos_weight=8.9498,weight_decay=0.2512'}
2025-06-06 16:04:17,541 - INFO - analysis dataframe :    eval_loss   eval_f1  ...  config/num_train_epochs    logdir
0   3.622601  0.852174  ...                        6  6be8f470
1   1.869423  0.852174  ...                        5  0994f0ce
2   0.119215  1.000000  ...                        3  ffe3a7c8

[3 rows x 32 columns]
[36m(train_hpo pid=3784374)[0m {'eval_loss': 3.622601270675659, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.560377299785614, 'eval_AP': 0.9830704780050292, 'eval_MCC': 0.0, 'eval_NDCG': 0.9968729957496895, 'eval_kappa': 0.0, 'eval_runtime': 3.4056, 'eval_samples_per_second': 19.38, 'eval_steps_per_second': 1.175, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3784374)[0m 2025-06-06 16:04:17,438 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
[36m(train_hpo pid=3784374)[0m 2025-06-06 16:04:17,444 - INFO - eval_result: {'eval_loss': 3.622601270675659, 'eval_f1': 0.8521739130434782, 'eval_recall': 1.0, 'eval_accuracy': 0.7424242424242424, 'eval_precision': 0.7424242424242424, 'eval_optim_threshold': 0.560377299785614, 'eval_AP': 0.9830704780050292, 'eval_MCC': 0.0, 'eval_NDCG': 0.9968729957496895, 'eval_kappa': 0.0, 'eval_runtime': 3.4056, 'eval_samples_per_second': 19.38, 'eval_steps_per_second': 1.175, 'epoch': 5.914285714285715}
[36m(train_hpo pid=3784374)[0m 2025-06-06 16:04:17,480 - INFO - Cleared CUDA cache. Memory allocated: 1.34 GB, Memory reserved: 1.59 GB
2025-06-06 16:04:17,648 - INFO - Trial comparison plot saved
2025-06-06 16:04:17,648 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-06-06 16:04:18,340 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/src/models/biomoqa/model_init.py:111: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
[2025-06-06 16:04:18,578] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2025-06-06 16:04:20,039 - INFO - training size : 697
2025-06-06 16:04:20,039 - INFO - dev size : 66
2025-06-06 16:04:20,039 - INFO - test size : 133
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
  0%|          | 0/90 [00:00<?, ?it/s]/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  1%|          | 1/90 [00:01<02:54,  1.96s/it]  2%|â–         | 2/90 [00:02<01:42,  1.17s/it]  3%|â–Ž         | 3/90 [00:03<01:19,  1.09it/s]  4%|â–         | 4/90 [00:03<01:08,  1.25it/s]  6%|â–Œ         | 5/90 [00:04<01:02,  1.36it/s]  7%|â–‹         | 6/90 [00:05<00:58,  1.44it/s]  8%|â–Š         | 7/90 [00:05<00:55,  1.50it/s]  9%|â–‰         | 8/90 [00:06<00:53,  1.53it/s] 10%|â–ˆ         | 9/90 [00:06<00:51,  1.56it/s] 11%|â–ˆ         | 10/90 [00:07<00:50,  1.58it/s] 12%|â–ˆâ–        | 11/90 [00:08<00:49,  1.59it/s] 13%|â–ˆâ–Ž        | 12/90 [00:08<00:48,  1.60it/s] 14%|â–ˆâ–        | 13/90 [00:09<00:47,  1.61it/s] 16%|â–ˆâ–Œ        | 14/90 [00:09<00:47,  1.61it/s] 17%|â–ˆâ–‹        | 15/90 [00:10<00:46,  1.62it/s] 18%|â–ˆâ–Š        | 16/90 [00:11<00:45,  1.62it/s] 19%|â–ˆâ–‰        | 17/90 [00:11<00:45,  1.62it/s] 20%|â–ˆâ–ˆ        | 18/90 [00:12<00:44,  1.62it/s] 21%|â–ˆâ–ˆ        | 19/90 [00:13<00:43,  1.62it/s] 22%|â–ˆâ–ˆâ–       | 20/90 [00:13<00:43,  1.62it/s] 23%|â–ˆâ–ˆâ–Ž       | 21/90 [00:14<00:42,  1.63it/s] 24%|â–ˆâ–ˆâ–       | 22/90 [00:14<00:41,  1.63it/s] 26%|â–ˆâ–ˆâ–Œ       | 23/90 [00:15<00:41,  1.62it/s] 27%|â–ˆâ–ˆâ–‹       | 24/90 [00:16<00:40,  1.63it/s] 28%|â–ˆâ–ˆâ–Š       | 25/90 [00:16<00:39,  1.63it/s] 29%|â–ˆâ–ˆâ–‰       | 26/90 [00:17<00:39,  1.63it/s] 30%|â–ˆâ–ˆâ–ˆ       | 27/90 [00:17<00:38,  1.63it/s] 31%|â–ˆâ–ˆâ–ˆ       | 28/90 [00:18<00:38,  1.62it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 29/90 [00:19<00:37,  1.64it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 30/90 [00:19<00:27,  2.16it/s]                                               {'loss': 0.4683, 'grad_norm': 0.2183617502450943, 'learning_rate': 5.325452975187489e-05, 'epoch': 1.0}
 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 30/90 [00:19<00:27,  2.16it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 31/90 [00:19<00:30,  1.94it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 32/90 [00:20<00:31,  1.84it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 33/90 [00:21<00:32,  1.77it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 34/90 [00:21<00:32,  1.72it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 35/90 [00:22<00:32,  1.69it/s] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 36/90 [00:23<00:32,  1.67it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 37/90 [00:23<00:31,  1.66it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 38/90 [00:24<00:31,  1.65it/s] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 39/90 [00:24<00:31,  1.64it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 40/90 [00:25<00:30,  1.65it/s] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 41/90 [00:26<00:29,  1.64it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 42/90 [00:26<00:29,  1.64it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 43/90 [00:27<00:28,  1.63it/s] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 44/90 [00:27<00:28,  1.63it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 45/90 [00:28<00:27,  1.63it/s] 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 46/90 [00:29<00:26,  1.63it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 47/90 [00:29<00:26,  1.63it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 48/90 [00:30<00:25,  1.63it/s] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 49/90 [00:30<00:25,  1.63it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 50/90 [00:31<00:24,  1.63it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 51/90 [00:32<00:23,  1.63it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 52/90 [00:32<00:23,  1.62it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 53/90 [00:33<00:22,  1.63it/s] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 54/90 [00:34<00:22,  1.62it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 55/90 [00:34<00:21,  1.62it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 56/90 [00:35<00:20,  1.62it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 57/90 [00:35<00:20,  1.62it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 58/90 [00:36<00:19,  1.63it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 59/90 [00:37<00:18,  1.64it/s]                                               {'loss': 0.0049, 'grad_norm': 0.0832059308886528, 'learning_rate': 2.6627264875937445e-05, 'epoch': 2.0}
 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 60/90 [00:37<00:18,  1.64it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 61/90 [00:37<00:14,  2.06it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 62/90 [00:38<00:14,  1.94it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 63/90 [00:39<00:14,  1.84it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 64/90 [00:39<00:14,  1.78it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 65/90 [00:40<00:14,  1.74it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 66/90 [00:40<00:14,  1.70it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 67/90 [00:41<00:13,  1.68it/s] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 68/90 [00:42<00:13,  1.66it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 69/90 [00:42<00:12,  1.65it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 70/90 [00:43<00:12,  1.64it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 71/90 [00:43<00:11,  1.64it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 72/90 [00:44<00:11,  1.63it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 73/90 [00:45<00:10,  1.63it/s] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 74/90 [00:45<00:09,  1.63it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 75/90 [00:46<00:09,  1.63it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 76/90 [00:47<00:08,  1.63it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 77/90 [00:47<00:07,  1.63it/s] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 78/90 [00:48<00:07,  1.63it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 79/90 [00:48<00:06,  1.63it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 80/90 [00:49<00:06,  1.63it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 81/90 [00:50<00:05,  1.63it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 82/90 [00:50<00:04,  1.63it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 83/90 [00:51<00:04,  1.63it/s] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 84/90 [00:51<00:03,  1.63it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 85/90 [00:52<00:03,  1.63it/s] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 86/90 [00:53<00:02,  1.63it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 87/90 [00:53<00:01,  1.63it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 88/90 [00:54<00:01,  1.63it/s] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 89/90 [00:54<00:00,  1.64it/s]                                               {'loss': 0.0026, 'grad_norm': 0.05208032205700874, 'learning_rate': 0.0, 'epoch': 3.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:57<00:00,  1.64it/s]                                               {'train_runtime': 57.8676, 'train_samples_per_second': 36.134, 'train_steps_per_second': 1.555, 'train_loss': 0.15858480946885214, 'epoch': 3.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:57<00:00,  1.64it/s]2025-06-06 16:05:18,252 - INFO - Early stopping triggered, but no best model checkpoint was saved.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [00:57<00:00,  1.56it/s]
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/3 [00:00<?, ?it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.33it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  5.66it/s]2025-06-06 16:05:22,813 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:04<00:00,  1.42s/it]
2025-06-06 16:05:22,819 - INFO - Training time : 65.17135430802591
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.16it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.04it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.38it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.12it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.26it/s]2025-06-06 16:05:28,312 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:05<00:00,  1.16it/s]
2025-06-06 16:05:28,318 - INFO - Evaluation time : 5.498346350155771
2025-06-06 16:05:28,318 - INFO - Evaluation results on test set: {'eval_loss': 0.05094592645764351, 'eval_f1': 0.9949238578680203, 'eval_recall': 1.0, 'eval_accuracy': 0.9924812030075187, 'eval_precision': 0.98989898989899, 'eval_optim_threshold': 0.9997853636741638, 'eval_AP': 1.0, 'eval_MCC': 0.9806202943118002, 'eval_NDCG': 1.0000000000000004, 'eval_kappa': 0.98043254376931, 'eval_runtime': 5.4938, 'eval_samples_per_second': 24.209, 'eval_steps_per_second': 1.092, 'epoch': 3.0}
2025-06-06 16:05:28,318 - INFO - Total updates (optimizer steps): 90
2025-06-06 16:05:28,318 - INFO - Avg time / step: 0.643s
2025-06-06 16:05:29,456 - INFO - Best model saved to /home/leandre/Projects/BioMoQA_Playground/results/biomoqa/final_model/best_model_cross_val_BCEdmis-lab/biobert-v1.13trials_fold-1
2025-06-06 16:05:29,456 - INFO - On test Set (with threshold 0.5) : 
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/torch/nn/parallel/data_parallel.py:37: UserWarning: 
    There is an imbalance between your GPUs. You may want to exclude GPU 0 which
    has less than 75% of the memory or cores of GPU 2. You can do so by setting
    the device_ids argument to DataParallel, or by setting the CUDA_VISIBLE_DEVICES
    environment variable.
  warnings.warn(
/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2708: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 0/6 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:00<00:00,  7.19it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:00<00:00,  5.08it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:00<00:00,  4.40it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:01<00:00,  4.13it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:01<00:00,  4.28it/s]2025-06-06 16:05:39,671 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_val.png
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:09<00:00,  1.65s/it]
2025-06-06 16:05:39,675 - INFO - Raw predictions shape: (133, 1)
2025-06-06 16:05:39,675 - INFO - Raw predictions: [[ 8.548822 ]
 [ 8.5322485]
 [ 8.532504 ]
 [-6.0116477]
 [-6.04647  ]
 [ 8.535277 ]
 [ 8.522959 ]
 [ 8.547018 ]
 [ 8.509535 ]
 [ 8.546827 ]]
2025-06-06 16:05:39,675 - INFO - Scores shape: (133,)
2025-06-06 16:05:39,676 - INFO - Scores: [0.99980634 0.999803   0.9998031  0.00244406 0.00236061 0.9998036
 0.9998012  0.999806   0.9997985  0.99980587]
2025-06-06 16:05:39,676 - INFO - Preds shape: (133,)
2025-06-06 16:05:39,676 - INFO - Preds: [1 1 1 0 0 1 1 1 1 1]
2025-06-06 16:05:39,676 - INFO - Test labels shape: (133,)
2025-06-06 16:05:39,677 - INFO - Test labels: [1, 1, 1, 0, 0, 1, 1, 1, 1, 1]
2025-06-06 16:05:39,677 - INFO - Unique values in predictions: [0 1]
2025-06-06 16:05:39,678 - INFO - Unique values in labels: [0 1]
2025-06-06 16:05:39,679 - INFO - Confusion matrix:
[[34  1]
 [ 0 98]]
2025-06-06 16:05:39,681 - INFO - Confusion matrix: TN=34, FP=1, FN=0, TP=98
2025-06-06 16:07:00,476 - INFO - Metrics: {'f1': 0.9949238578680203, 'recall': 1.0, 'precision': 0.98989898989899, 'accuracy': 0.9924812030075187, 'AP': 1.0, 'MCC': 0.9806202943118002, 'NDCG': 1.0000000000000004, 'kappa': 0.98043254376931, 'TN': 34, 'FP': 1, 'FN': 0, 'TP': 98}
2025-06-06 16:07:00,598 - INFO - ROC curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/roc_curve_test.png
2025-06-06 16:07:00,690 - INFO - Precision-Recall curve saved to /home/leandre/Projects/BioMoQA_Playground/plots/precision_recall_curvetest.png
2025-06-06 16:07:00,690 - INFO - 
On test Set (optimal threshold of 0.9997828602790833 according to cross validation on the training set): 
2025-06-06 16:07:00,692 - INFO - Confusion matrix: TN=35, FP=0, FN=0, TP=98
