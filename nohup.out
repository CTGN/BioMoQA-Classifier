2025-05-19 12:37:25,875	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
2025-05-19 12:37:26,594 - INFO - Multi Label pipeline for loss type BCE and ensemble=True
2025-05-19 12:37:26,597 - INFO - Random seeds set to 42
2025-05-19 12:37:37,315 - INFO - Balancing dataset...
2025-05-19 12:37:38,759 - INFO - Number of positives: 6060
2025-05-19 12:37:38,759 - INFO - Number of negatives: 4105247
2025-05-19 12:37:39,176 - INFO - Balanced columns: ['doi', 'title', 'text', 'IAS', 'SUA', 'VA']
2025-05-19 12:37:39,176 - INFO - Balanced dataset size: 12120
2025-05-19 12:37:39,182 - INFO - Balanced dataset : Dataset({
    features: ['doi', 'title', 'text', 'IAS', 'SUA', 'VA'],
    num_rows: 12120
})
2025-05-19 12:37:39,216 - INFO - dataset's labels : Dataset({
    features: ['IAS', 'SUA', 'VA'],
    num_rows: 12120
})
2025-05-19 12:37:39,603 - INFO - fold 1 : (array([    0,     1,     4, ..., 12112, 12115, 12119], shape=(6060,)), array([    2,     3,     7, ..., 12116, 12117, 12118], shape=(6060,)))
2025-05-19 12:37:39,615 - INFO - Run no 1/2
2025-05-19 12:37:39,615 - INFO - Loss Type : BCE
2025-05-19 12:37:39,615 - INFO - Ensemble learning pipeline
2025-05-19 12:37:39,616 - INFO - Training model 1/2: dmis-lab/biobert-v1.1
2025-05-19 12:37:39,813 - INFO - 
fold number 1 / 2
2025-05-19 12:37:40,145 - INFO - train+dev split size : 6060
2025-05-19 12:37:40,145 - INFO - test split size : 6060
2025-05-19 12:37:40,310 - INFO - train split size : 4242
2025-05-19 12:37:40,311 - INFO - dev split size : 1818
Parameter 'function'=<function TrainMultiLabelPipeline.train.<locals>.preprocess at 0x7d80f8cb9a80> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.
2025-05-19 12:37:40,897 - WARNING - Parameter 'function'=<function TrainMultiLabelPipeline.train.<locals>.preprocess at 0x7d80f8cb9a80> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.
/home/leandre/Projects/BioMoQA_Playground/data/corpus/Raw/Positives/IPBES IAS_2352922
128
Successfully loaded dataset from: /home/leandre/Projects/BioMoQA_Playground/data/corpus/Raw/Positives/IPBES IAS_2352922
/home/leandre/Projects/BioMoQA_Playground/data/corpus/Raw/Positives/IPBES SUA_2344805
86
Successfully loaded dataset from: /home/leandre/Projects/BioMoQA_Playground/data/corpus/Raw/Positives/IPBES SUA_2344805
/home/leandre/Projects/BioMoQA_Playground/data/corpus/Raw/Positives/IPBES VA_2345372
128
Successfully loaded dataset from: /home/leandre/Projects/BioMoQA_Playground/data/corpus/Raw/Positives/IPBES VA_2345372
pos_ds features for IAS :  {'DOI': Value(dtype='string', id=None), 'Title': Value(dtype='string', id=None), 'Abstract Note': Value(dtype='string', id=None), 'Language': Value(dtype='string', id=None)}
creating corpus dataset
dataset loaded
['id', 'display_name', 'author', 'ab', 'doi', 'topics', 'author_abbr']
Concatenating positive datasets...
creating raw negative dataset
creating raw positive dataset
Finished positives and negatives creation pipeline
pos_combined Dataset({
    features: ['doi', 'title', 'abstract'],
    num_rows: 14405
})
Filtering out rows with no abstracts or DOI...
Size of the dataset before cleaning: 4197487
Applying clean_filter...
Map:   0%|          | 0/4242 [00:00<?, ? examples/s]Map:  24%|â–ˆâ–ˆâ–Ž       | 1000/4242 [00:00<00:03, 1015.66 examples/s]Map:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 2000/4242 [00:02<00:02, 913.14 examples/s] Map:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 3000/4242 [00:03<00:01, 895.01 examples/s]Map:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 4000/4242 [00:04<00:00, 925.05 examples/s]Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4242/4242 [00:04<00:00, 905.16 examples/s]Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4242/4242 [00:04<00:00, 913.99 examples/s]
Map:   0%|          | 0/1818 [00:00<?, ? examples/s]Map:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1000/1818 [00:01<00:00, 887.59 examples/s]Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1818/1818 [00:02<00:00, 854.30 examples/s]Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1818/1818 [00:02<00:00, 855.65 examples/s]
Map:   0%|          | 0/6060 [00:00<?, ? examples/s]Map:  17%|â–ˆâ–‹        | 1000/6060 [00:01<00:05, 922.87 examples/s]Map:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2000/6060 [00:02<00:04, 901.73 examples/s]Map:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 3000/6060 [00:03<00:03, 946.28 examples/s]Map:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 4000/6060 [00:04<00:02, 912.98 examples/s]Map:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5000/6060 [00:05<00:01, 910.28 examples/s]Map:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 6000/6060 [00:06<00:00, 845.46 examples/s]Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6060/6060 [00:06<00:00, 879.16 examples/s]
2025-05-19 12:37:55,781 - INFO - Starting hyperparameter search for BCE loss
[36m(train_hpo pid=109250)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=109250)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=109250)[0m 2025-05-19 12:38:04,910 - INFO - pos_weight value in TrainingArguments : 8.493688290834637
[36m(train_hpo pid=109250)[0m /home/leandre/Projects/BioMoQA_Playground/model/model_init.py:114: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=109250)[0m   super().__init__(*args, **kwargs)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-05-19_12-37-55   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 1                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/model/ray_results/train_hpo_2025-05-19_12-37-55
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-05-19_12-37-24_393283_106014/artifacts/2025-05-19_12-37-55/train_hpo_2025-05-19_12-37-55/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-05-19 12:37:57. Total running time: 0s
Logical resource usage: 0/32 CPUs, 0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_fc6d8da9   PENDING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_fc6d8da9 started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_fc6d8da9 config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          2 â”‚
â”‚ pos_weight                          8.49369 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=109250)[0m [2025-05-19 12:38:05,141] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=109250)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=22, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=96, num_train_epochs=2, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 1 RUNNING
Current time: 2025-05-19 12:38:27. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_fc6d8da9   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
Trial status: 1 RUNNING
Current time: 2025-05-19 12:38:57. Total running time: 1min 0s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_fc6d8da9   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
Trial status: 1 RUNNING
Current time: 2025-05-19 12:39:27. Total running time: 1min 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_fc6d8da9   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
Trial status: 1 RUNNING
Current time: 2025-05-19 12:39:57. Total running time: 2min 0s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)[36m(train_hpo pid=109250)[0m 2025-05-19 12:40:22,519 - INFO - Logits shape : (1818, 3) and logits squeeze shape : (1818, 3)
[36m(train_hpo pid=109250)[0m 2025-05-19 12:42:27,095 - INFO - Logits shape : (1818, 3) and logits squeeze shape : (1818, 3)

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_fc6d8da9   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=109250)[0m {'loss': 1.4533, 'grad_norm': 0.538120448589325, 'learning_rate': 6.798212053829252e-07, 'epoch': 1.0}
[36m(train_hpo pid=109250)[0m {'eval_loss': 1.5315024852752686, 'eval_f1_weighted': 0.20490770692931307, 'eval_recall_weighted': 0.6341730558598029, 'eval_precision_weighted': 0.2644577171976961, 'eval_accuracy': 0.014301430143014302, 'eval_runtime': 17.9535, 'eval_samples_per_second': 101.262, 'eval_steps_per_second': 1.058, 'epoch': 1.0}
Trial status: 1 RUNNING
Current time: 2025-05-19 12:40:27. Total running time: 2min 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_fc6d8da9   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
Trial status: 1 RUNNING
Current time: 2025-05-19 12:40:57. Total running time: 3min 0s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_fc6d8da9   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
Trial status: 1 RUNNING
Current time: 2025-05-19 12:41:27. Total running time: 3min 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_fc6d8da9   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
Trial status: 1 RUNNING
Current time: 2025-05-19 12:41:57. Total running time: 4min 1s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_fc6d8da9   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=109250)[0m {'loss': 1.5246, 'grad_norm': 2.924318552017212, 'learning_rate': 0.0, 'epoch': 1.8888888888888888}
[36m(train_hpo pid=109250)[0m {'eval_loss': 1.5211024284362793, 'eval_f1_weighted': 0.2148165917046886, 'eval_recall_weighted': 0.6429353778751369, 'eval_precision_weighted': 0.19686409943700914, 'eval_accuracy': 0.013751375137513752, 'eval_runtime': 18.0093, 'eval_samples_per_second': 100.948, 'eval_steps_per_second': 1.055, 'epoch': 1.8888888888888888}
Trial status: 1 RUNNING
Current time: 2025-05-19 12:42:27. Total running time: 4min 31s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_fc6d8da9   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(train_hpo pid=109250)[0m 2025-05-19 12:42:47,255 - INFO - Logits shape : (1818, 3) and logits squeeze shape : (1818, 3)
[36m(train_hpo pid=109250)[0m 2025-05-19 12:42:47,263 - INFO - eval_result: {'eval_loss': 1.5211024284362793, 'eval_f1_weighted': 0.2148165917046886, 'eval_recall_weighted': 0.6429353778751369, 'eval_precision_weighted': 0.19686409943700914, 'eval_accuracy': 0.013751375137513752, 'eval_runtime': 17.9713, 'eval_samples_per_second': 101.161, 'eval_steps_per_second': 1.057, 'epoch': 1.8888888888888888}
2025-05-19 12:42:47,423	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/model/ray_results/train_hpo_2025-05-19_12-37-55' in 0.0065s.
2025-05-19 12:42:47,428 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x7d7fc177f250>
2025-05-19 12:42:47,428 - INFO - Best trial : train_hpo_fc6d8da9
2025-05-19 12:42:47,428 - INFO - Best config : {'pos_weight': 8.493688290834637, 'learning_rate': 1.4956066518424355e-06, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 2}
2025-05-19 12:42:47,428 - INFO - Best trial after optimization: {'eval_loss': 1.5211024284362793, 'eval_f1_weighted': 0.2148165917046886, 'eval_recall_weighted': 0.6429353778751369, 'eval_precision_weighted': 0.19686409943700914, 'eval_accuracy': 0.013751375137513752, 'eval_runtime': 17.9713, 'eval_samples_per_second': 101.161, 'eval_steps_per_second': 1.057, 'epoch': 1.8888888888888888, 'timestamp': 1747651367, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': 'fc6d8da9', 'date': '2025-05-19_12-42-47', 'time_this_iter_s': 283.25445795059204, 'time_total_s': 283.25445795059204, 'pid': 109250, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 8.493688290834637, 'learning_rate': 1.4956066518424355e-06, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 2}, 'time_since_restore': 283.25445795059204, 'iterations_since_restore': 1, 'experiment_tag': '1_learning_rate=0.0000,num_train_epochs=2,pos_weight=8.4937,weight_decay=0.1364'}
2025-05-19 12:42:47,429 - WARNING - Could not create parallel coordinates plot: 'ExperimentAnalysis' object has no attribute 'plot_parallel_coordinates'
2025-05-19 12:42:47,448 - INFO - analysis dataframe :    eval_loss  eval_f1_weighted  ...  config/num_train_epochs    logdir
0   1.521102          0.214817  ...                        2  fc6d8da9

[1 rows x 27 columns]
2025-05-19 12:42:47,448 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at dmis-lab/biobert-v1.1 and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-05-19 12:42:48,108 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/model/model_init.py:114: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)

[36m(train_hpo pid=109250)[0m {'train_runtime': 260.8567, 'train_samples_per_second': 32.524, 'train_steps_per_second': 0.084, 'train_loss': 1.4857072830200195, 'epoch': 1.8888888888888888}
[36m(train_hpo pid=109250)[0m STATE at ending of training  :  TrainerState(epoch=1.8888888888888888, global_step=22, max_steps=22, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=96, num_train_epochs=2, num_input_tokens_seen=0, total_flos=2126482642077696.0, log_history=[{'loss': 1.4533, 'grad_norm': 0.538120448589325, 'learning_rate': 6.798212053829252e-07, 'epoch': 1.0, 'step': 12}, {'eval_loss': 1.5315024852752686, 'eval_f1_weighted': 0.20490770692931307, 'eval_recall_weighted': 0.6341730558598029, 'eval_precision_weighted': 0.2644577171976961, 'eval_accuracy': 0.014301430143014302, 'eval_runtime': 17.9535, 'eval_samples_per_second': 101.262, 'eval_steps_per_second': 1.058, 'epoch': 1.0, 'step': 12}, {'loss': 1.5246, 'grad_norm': 2.924318552017212, 'learning_rate': 0.0, 'epoch': 1.8888888888888888, 'step': 22}, {'eval_loss': 1.5211024284362793, 'eval_f1_weighted': 0.2148165917046886, 'eval_recall_weighted': 0.6429353778751369, 'eval_precision_weighted': 0.19686409943700914, 'eval_accuracy': 0.013751375137513752, 'eval_runtime': 18.0093, 'eval_samples_per_second': 100.948, 'eval_steps_per_second': 1.055, 'epoch': 1.8888888888888888, 'step': 22}, {'train_runtime': 260.8567, 'train_samples_per_second': 32.524, 'train_steps_per_second': 0.084, 'total_flos': 2126482642077696.0, 'train_loss': 1.4857072830200195, 'epoch': 1.8888888888888888, 'step': 22}], best_metric=0.2148165917046886, best_model_checkpoint='./checkpoint-22', is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': True, 'should_epoch_stop': False, 'should_save': True, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=109250)[0m {'eval_loss': 1.5211024284362793, 'eval_f1_weighted': 0.2148165917046886, 'eval_recall_weighted': 0.6429353778751369, 'eval_precision_weighted': 0.19686409943700914, 'eval_accuracy': 0.013751375137513752, 'eval_runtime': 17.9713, 'eval_samples_per_second': 101.161, 'eval_steps_per_second': 1.057, 'epoch': 1.8888888888888888}

Trial train_hpo_fc6d8da9 finished iteration 1 at 2025-05-19 12:42:47. Total running time: 4min 50s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_fc6d8da9 result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    283.254 â”‚
â”‚ time_total_s                        283.254 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               1.88889 â”‚
â”‚ eval_accuracy                       0.01375 â”‚
â”‚ eval_f1_weighted                    0.21482 â”‚
â”‚ eval_loss                            1.5211 â”‚
â”‚ eval_precision_weighted             0.19686 â”‚
â”‚ eval_recall_weighted                0.64294 â”‚
â”‚ eval_runtime                        17.9713 â”‚
â”‚ eval_samples_per_second             101.161 â”‚
â”‚ eval_steps_per_second                 1.057 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_fc6d8da9 completed after 1 iterations at 2025-05-19 12:42:47. Total running time: 4min 50s

Trial status: 1 TERMINATED
Current time: 2025-05-19 12:42:47. Total running time: 4min 50s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1_weighted     eval_recall_weighted     ...recision_weighted â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_fc6d8da9   TERMINATED        8.49369       1.49561e-06          0.13641                    2        1            283.254        1.5211             0.214817                 0.642935                 0.196864 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

[2025-05-19 12:42:48,327] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2025-05-19 12:42:50,061 - INFO - training size : 4242
2025-05-19 12:42:50,061 - INFO - test size : 6060
  0%|          | 0/90 [00:00<?, ?it/s]  1%|          | 1/90 [00:03<05:41,  3.84s/it]  2%|â–         | 2/90 [00:06<04:34,  3.12s/it]  3%|â–Ž         | 3/90 [00:09<04:11,  2.90s/it]  4%|â–         | 4/90 [00:11<03:59,  2.79s/it]  6%|â–Œ         | 5/90 [00:14<03:51,  2.73s/it]  7%|â–‹         | 6/90 [00:16<03:46,  2.69s/it]  8%|â–Š         | 7/90 [00:19<03:41,  2.67s/it]  9%|â–‰         | 8/90 [00:22<03:37,  2.65s/it] 10%|â–ˆ         | 9/90 [00:24<03:34,  2.64s/it] 11%|â–ˆ         | 10/90 [00:27<03:31,  2.64s/it] 12%|â–ˆâ–        | 11/90 [00:30<03:27,  2.63s/it] 13%|â–ˆâ–Ž        | 12/90 [00:32<03:24,  2.63s/it] 14%|â–ˆâ–        | 13/90 [00:35<03:22,  2.63s/it] 16%|â–ˆâ–Œ        | 14/90 [00:37<03:19,  2.63s/it] 17%|â–ˆâ–‹        | 15/90 [00:40<03:17,  2.63s/it] 18%|â–ˆâ–Š        | 16/90 [00:43<03:14,  2.62s/it] 19%|â–ˆâ–‰        | 17/90 [00:45<03:11,  2.63s/it] 20%|â–ˆâ–ˆ        | 18/90 [00:48<03:09,  2.63s/it] 21%|â–ˆâ–ˆ        | 19/90 [00:51<03:06,  2.63s/it] 22%|â–ˆâ–ˆâ–       | 20/90 [00:53<03:03,  2.63s/it] 23%|â–ˆâ–ˆâ–Ž       | 21/90 [00:56<03:01,  2.63s/it] 24%|â–ˆâ–ˆâ–       | 22/90 [00:58<02:58,  2.63s/it] 26%|â–ˆâ–ˆâ–Œ       | 23/90 [01:01<02:55,  2.62s/it] 27%|â–ˆâ–ˆâ–‹       | 24/90 [01:04<02:53,  2.63s/it] 28%|â–ˆâ–ˆâ–Š       | 25/90 [01:06<02:51,  2.63s/it] 29%|â–ˆâ–ˆâ–‰       | 26/90 [01:09<02:48,  2.63s/it] 30%|â–ˆâ–ˆâ–ˆ       | 27/90 [01:12<02:45,  2.63s/it] 31%|â–ˆâ–ˆâ–ˆ       | 28/90 [01:14<02:42,  2.62s/it] 32%|â–ˆâ–ˆâ–ˆâ–      | 29/90 [01:17<02:40,  2.62s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 30/90 [01:19<02:37,  2.62s/it] 34%|â–ˆâ–ˆâ–ˆâ–      | 31/90 [01:22<02:34,  2.62s/it] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 32/90 [01:25<02:32,  2.62s/it] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 33/90 [01:27<02:29,  2.62s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 34/90 [01:30<02:26,  2.62s/it] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 35/90 [01:33<02:24,  2.62s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 36/90 [01:35<02:21,  2.62s/it] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 37/90 [01:38<02:19,  2.63s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 38/90 [01:40<02:16,  2.63s/it] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 39/90 [01:43<02:13,  2.63s/it] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 40/90 [01:46<02:11,  2.62s/it] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 41/90 [01:48<02:08,  2.63s/it] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 42/90 [01:51<02:06,  2.63s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 43/90 [01:54<02:03,  2.63s/it] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 44/90 [01:56<02:00,  2.61s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 45/90 [01:57<01:33,  2.08s/it]                                                50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 45/90 [01:57<01:33,  2.08s/it]{'loss': 1.5255, 'grad_norm': 2.244119167327881, 'learning_rate': 7.478033259212177e-07, 'epoch': 1.0}

  0%|          | 0/19 [00:00<?, ?it/s][A
 11%|â–ˆ         | 2/19 [00:00<00:08,  2.11it/s][A
 16%|â–ˆâ–Œ        | 3/19 [00:01<00:10,  1.49it/s][A
 21%|â–ˆâ–ˆ        | 4/19 [00:02<00:11,  1.29it/s][A
 26%|â–ˆâ–ˆâ–‹       | 5/19 [00:03<00:11,  1.19it/s][A
 32%|â–ˆâ–ˆâ–ˆâ–      | 6/19 [00:04<00:11,  1.14it/s][A
 37%|â–ˆâ–ˆâ–ˆâ–‹      | 7/19 [00:05<00:10,  1.11it/s][A
 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 8/19 [00:06<00:10,  1.09it/s][A
 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 9/19 [00:07<00:09,  1.07it/s][A
 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 10/19 [00:08<00:08,  1.07it/s][A
 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 11/19 [00:09<00:07,  1.06it/s][A
 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 12/19 [00:10<00:06,  1.06it/s][A
 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 13/19 [00:11<00:05,  1.06it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 14/19 [00:12<00:04,  1.06it/s][A
 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 15/19 [00:13<00:03,  1.06it/s][A
 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 16/19 [00:14<00:02,  1.05it/s][A
 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 17/19 [00:15<00:01,  1.05it/s][A
 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 18/19 [00:16<00:00,  1.05it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 19/19 [00:17<00:00,  1.08it/s][A2025-05-19 12:45:06,084 - INFO - Logits shape : (1818, 3) and logits squeeze shape : (1818, 3)
                                               
                                               [A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 45/90 [02:15<01:33,  2.08s/it]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 19/19 [00:17<00:00,  1.08it/s][A
                                               [A 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 46/90 [02:20<06:02,  8.24s/it] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 47/90 [02:22<04:41,  6.56s/it] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 48/90 [02:25<03:45,  5.38s/it] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 49/90 [02:28<03:06,  4.55s/it] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 50/90 [02:30<02:39,  3.98s/it] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 51/90 [02:33<02:19,  3.57s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 52/90 [02:35<02:04,  3.29s/it] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 53/90 [02:38<01:54,  3.09s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 54/90 [02:41<01:46,  2.95s/it] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 55/90 [02:43<01:39,  2.85s/it] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 56/90 [02:46<01:34,  2.78s/it] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 57/90 [02:49<01:30,  2.74s/it] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 58/90 [02:51<01:26,  2.70s/it] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 59/90 [02:54<01:23,  2.68s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 60/90 [02:56<01:19,  2.66s/it] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 61/90 [02:59<01:16,  2.65s/it] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 62/90 [03:02<01:14,  2.64s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 63/90 [03:04<01:11,  2.64s/it] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 64/90 [03:07<01:08,  2.64s/it] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 65/90 [03:10<01:05,  2.63s/it] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 66/90 [03:12<01:03,  2.63s/it] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 67/90 [03:15<01:00,  2.63s/it] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 68/90 [03:17<00:57,  2.63s/it] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 69/90 [03:20<00:55,  2.63s/it] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 70/90 [03:23<00:52,  2.63s/it] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 71/90 [03:25<00:50,  2.63s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 72/90 [03:28<00:47,  2.64s/it] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 73/90 [03:31<00:44,  2.63s/it] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 74/90 [03:33<00:42,  2.63s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 75/90 [03:36<00:39,  2.63s/it] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 76/90 [03:38<00:36,  2.63s/it] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 77/90 [03:41<00:34,  2.63s/it] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 78/90 [03:44<00:31,  2.63s/it] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 79/90 [03:46<00:28,  2.63s/it] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 80/90 [03:49<00:26,  2.63s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 81/90 [03:52<00:23,  2.63s/it] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 82/90 [03:54<00:21,  2.63s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 83/90 [03:57<00:18,  2.63s/it] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 84/90 [04:00<00:15,  2.63s/it] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 85/90 [04:02<00:13,  2.63s/it] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 86/90 [04:05<00:10,  2.63s/it] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 87/90 [04:07<00:07,  2.63s/it] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 88/90 [04:10<00:05,  2.63s/it] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 89/90 [04:13<00:02,  2.61s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [04:13<00:00,  2.08s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [04:13<00:00,  2.08s/it]{'eval_loss': 1.4895628690719604, 'eval_f1_weighted': 0.3042602704586418, 'eval_recall_weighted': 0.9901423877327492, 'eval_precision_weighted': 0.18120855817280607, 'eval_accuracy': 0.0016501650165016502, 'eval_runtime': 18.0872, 'eval_samples_per_second': 100.513, 'eval_steps_per_second': 1.05, 'epoch': 1.0}
{'loss': 1.4776, 'grad_norm': 6.164450168609619, 'learning_rate': 0.0, 'epoch': 2.0}

  0%|          | 0/19 [00:00<?, ?it/s][A
 11%|â–ˆ         | 2/19 [00:00<00:08,  2.10it/s][A
 16%|â–ˆâ–Œ        | 3/19 [00:01<00:10,  1.48it/s][A
 21%|â–ˆâ–ˆ        | 4/19 [00:02<00:11,  1.28it/s][A
 26%|â–ˆâ–ˆâ–‹       | 5/19 [00:03<00:11,  1.19it/s][A
 32%|â–ˆâ–ˆâ–ˆâ–      | 6/19 [00:04<00:11,  1.14it/s][A
 37%|â–ˆâ–ˆâ–ˆâ–‹      | 7/19 [00:05<00:10,  1.11it/s][A
 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 8/19 [00:06<00:10,  1.09it/s][A
 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 9/19 [00:07<00:09,  1.08it/s][A
 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 10/19 [00:08<00:08,  1.07it/s][A
 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 11/19 [00:09<00:07,  1.06it/s][A
 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 12/19 [00:10<00:06,  1.06it/s][A
 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 13/19 [00:11<00:05,  1.06it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 14/19 [00:12<00:04,  1.05it/s][A
 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 15/19 [00:13<00:03,  1.05it/s][A
 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 16/19 [00:14<00:02,  1.05it/s][A
 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 17/19 [00:15<00:01,  1.05it/s][A
 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 18/19 [00:16<00:00,  1.05it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 19/19 [00:17<00:00,  1.08it/s][A2025-05-19 12:47:22,539 - INFO - Logits shape : (1818, 3) and logits squeeze shape : (1818, 3)
                                               
                                               [A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [04:32<00:00,  2.08s/it]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 19/19 [00:17<00:00,  1.08it/s][A
                                               [A                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [04:32<00:00,  2.08s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [04:32<00:00,  3.02s/it]
{'eval_loss': 1.4620484113693237, 'eval_f1_weighted': 0.3026786527070896, 'eval_recall_weighted': 0.9912376779846659, 'eval_precision_weighted': 0.1799711301242599, 'eval_accuracy': 0.0011001100110011, 'eval_runtime': 18.1062, 'eval_samples_per_second': 100.408, 'eval_steps_per_second': 1.049, 'epoch': 2.0}
{'train_runtime': 272.1817, 'train_samples_per_second': 31.17, 'train_steps_per_second': 0.331, 'train_loss': 1.5015687730577256, 'epoch': 2.0}
  0%|          | 0/19 [00:00<?, ?it/s] 11%|â–ˆ         | 2/19 [00:00<00:08,  2.11it/s] 16%|â–ˆâ–Œ        | 3/19 [00:01<00:10,  1.49it/s] 21%|â–ˆâ–ˆ        | 4/19 [00:02<00:11,  1.29it/s] 26%|â–ˆâ–ˆâ–‹       | 5/19 [00:03<00:11,  1.20it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 6/19 [00:04<00:11,  1.14it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 7/19 [00:05<00:10,  1.11it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 8/19 [00:06<00:10,  1.09it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 9/19 [00:07<00:09,  1.08it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 10/19 [00:08<00:08,  1.07it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 11/19 [00:09<00:07,  1.06it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 12/19 [00:10<00:06,  1.06it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 13/19 [00:11<00:05,  1.06it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 14/19 [00:12<00:04,  1.06it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 15/19 [00:13<00:03,  1.06it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 16/19 [00:14<00:02,  1.05it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 17/19 [00:15<00:01,  1.05it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 18/19 [00:16<00:00,  1.05it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 19/19 [00:17<00:00,  1.08it/s]2025-05-19 12:47:40,716 - INFO - Logits shape : (1818, 3) and logits squeeze shape : (1818, 3)
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 19/19 [00:17<00:00,  1.11it/s]
2025-05-19 12:47:40,725 - INFO - Training time : 293.27632243800326
  0%|          | 0/64 [00:00<?, ?it/s]  3%|â–Ž         | 2/64 [00:00<00:29,  2.10it/s]  5%|â–         | 3/64 [00:01<00:41,  1.48it/s]  6%|â–‹         | 4/64 [00:02<00:46,  1.28it/s]  8%|â–Š         | 5/64 [00:03<00:49,  1.19it/s]  9%|â–‰         | 6/64 [00:04<00:50,  1.14it/s] 11%|â–ˆ         | 7/64 [00:05<00:51,  1.11it/s] 12%|â–ˆâ–Ž        | 8/64 [00:06<00:51,  1.09it/s] 14%|â–ˆâ–        | 9/64 [00:07<00:50,  1.08it/s] 16%|â–ˆâ–Œ        | 10/64 [00:08<00:50,  1.07it/s] 17%|â–ˆâ–‹        | 11/64 [00:09<00:49,  1.06it/s] 19%|â–ˆâ–‰        | 12/64 [00:10<00:49,  1.06it/s] 20%|â–ˆâ–ˆ        | 13/64 [00:11<00:48,  1.06it/s] 22%|â–ˆâ–ˆâ–       | 14/64 [00:12<00:47,  1.05it/s] 23%|â–ˆâ–ˆâ–Ž       | 15/64 [00:13<00:47,  1.04it/s] 25%|â–ˆâ–ˆâ–Œ       | 16/64 [00:14<00:45,  1.04it/s] 27%|â–ˆâ–ˆâ–‹       | 17/64 [00:15<00:44,  1.05it/s] 28%|â–ˆâ–ˆâ–Š       | 18/64 [00:16<00:43,  1.05it/s] 30%|â–ˆâ–ˆâ–‰       | 19/64 [00:17<00:42,  1.05it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 20/64 [00:18<00:41,  1.05it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 21/64 [00:19<00:41,  1.05it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 22/64 [00:20<00:40,  1.04it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 23/64 [00:21<00:39,  1.05it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 24/64 [00:21<00:38,  1.05it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 25/64 [00:22<00:37,  1.05it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 26/64 [00:23<00:36,  1.05it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 27/64 [00:24<00:35,  1.05it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 28/64 [00:25<00:34,  1.05it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 29/64 [00:26<00:33,  1.05it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 30/64 [00:27<00:32,  1.05it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 31/64 [00:28<00:31,  1.05it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 32/64 [00:29<00:30,  1.05it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 33/64 [00:30<00:29,  1.05it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 34/64 [00:31<00:28,  1.05it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 35/64 [00:32<00:27,  1.05it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 36/64 [00:33<00:26,  1.05it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 37/64 [00:34<00:25,  1.05it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 38/64 [00:35<00:24,  1.05it/s]2025-05-19 12:48:17,964	WARNING tune.py:219 -- Stop signal received (e.g. via SIGINT/Ctrl+C), ending Ray Tune run. This will try to checkpoint the experiment state one last time. Press CTRL+C (or send SIGINT/SIGKILL/SIGTERM) to skip. 
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 39/64 [00:36<00:23,  1.05it/s]Traceback (most recent call last):
  File "/home/leandre/Projects/BioMoQA_Playground/model/multi_label_pipeline.py", line 628, in <module>
    pipeline.whole_pipeline()
  File "/home/leandre/Projects/BioMoQA_Playground/model/multi_label_pipeline.py", line 544, in whole_pipeline
    avg_ens_metrics=self.run_pipeline()
                    ^^^^^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/model/multi_label_pipeline.py", line 469, in run_pipeline
    scores_by_fold = self.train(model_name=model_name)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/model/multi_label_pipeline.py", line 393, in train
    eval_results_test = trainer.evaluate(tokenized_test)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/trainer.py", line 4105, in evaluate
    output = eval_loop(
             ^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/trainer.py", line 4299, in evaluation_loop
    losses, logits, labels = self.prediction_step(model, inputs, prediction_loss_only, ignore_keys=ignore_keys)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/.venv/lib/python3.11/site-packages/transformers/trainer.py", line 4515, in prediction_step
    loss, outputs = self.compute_loss(model, inputs, return_outputs=True)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/leandre/Projects/BioMoQA_Playground/model/model_init.py", line 125, in compute_loss
    pos_weight=torch.tensor(self.args.pos_weight,device=self.model.device)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 39/64 [00:39<00:25,  1.01s/it]
2025-05-19 12:48:50,774	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32mhttp://127.0.0.1:8265 [39m[22m
2025-05-19 12:48:51,409 - INFO - Multi Label pipeline for loss type BCE and ensemble=True
2025-05-19 12:48:51,412 - INFO - Random seeds set to 42
2025-05-19 12:49:01,104 - INFO - Balancing dataset...
2025-05-19 12:49:02,539 - INFO - Number of positives: 6060
2025-05-19 12:49:02,539 - INFO - Number of negatives: 4105247
2025-05-19 12:49:02,976 - INFO - Balanced columns: ['doi', 'title', 'text', 'IAS', 'SUA', 'VA']
2025-05-19 12:49:02,976 - INFO - Balanced dataset size: 12120
2025-05-19 12:49:02,983 - INFO - Balanced dataset : Dataset({
    features: ['doi', 'title', 'text', 'IAS', 'SUA', 'VA'],
    num_rows: 12120
})
2025-05-19 12:49:03,017 - INFO - dataset's labels : Dataset({
    features: ['IAS', 'SUA', 'VA'],
    num_rows: 12120
})
2025-05-19 12:49:03,676 - INFO - fold 1 : (array([    0,     1,     4, ..., 12112, 12115, 12119], shape=(6060,)), array([    2,     3,     7, ..., 12116, 12117, 12118], shape=(6060,)))
2025-05-19 12:49:03,687 - INFO - Run no 1/2
2025-05-19 12:49:03,687 - INFO - Loss Type : BCE
2025-05-19 12:49:03,687 - INFO - Ensemble learning pipeline
2025-05-19 12:49:03,688 - INFO - Training model 1/5: microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract
2025-05-19 12:49:04,009 - INFO - 
fold number 1 / 2
2025-05-19 12:49:04,051 - INFO - train+dev split size : 6060
2025-05-19 12:49:04,051 - INFO - test split size : 6060
2025-05-19 12:49:04,207 - INFO - train split size : 4242
2025-05-19 12:49:04,207 - INFO - dev split size : 1818
Parameter 'function'=<function TrainMultiLabelPipeline.train.<locals>.preprocess at 0x77b61e755b20> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.
2025-05-19 12:49:04,794 - WARNING - Parameter 'function'=<function TrainMultiLabelPipeline.train.<locals>.preprocess at 0x77b61e755b20> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.
/home/leandre/Projects/BioMoQA_Playground/data/corpus/Raw/Positives/IPBES IAS_2352922
128
Successfully loaded dataset from: /home/leandre/Projects/BioMoQA_Playground/data/corpus/Raw/Positives/IPBES IAS_2352922
/home/leandre/Projects/BioMoQA_Playground/data/corpus/Raw/Positives/IPBES SUA_2344805
86
Successfully loaded dataset from: /home/leandre/Projects/BioMoQA_Playground/data/corpus/Raw/Positives/IPBES SUA_2344805
/home/leandre/Projects/BioMoQA_Playground/data/corpus/Raw/Positives/IPBES VA_2345372
128
Successfully loaded dataset from: /home/leandre/Projects/BioMoQA_Playground/data/corpus/Raw/Positives/IPBES VA_2345372
pos_ds features for IAS :  {'DOI': Value(dtype='string', id=None), 'Title': Value(dtype='string', id=None), 'Abstract Note': Value(dtype='string', id=None), 'Language': Value(dtype='string', id=None)}
creating corpus dataset
dataset loaded
['id', 'display_name', 'author', 'ab', 'doi', 'topics', 'author_abbr']
Concatenating positive datasets...
creating raw negative dataset
creating raw positive dataset
Finished positives and negatives creation pipeline
pos_combined Dataset({
    features: ['doi', 'title', 'abstract'],
    num_rows: 14405
})
Filtering out rows with no abstracts or DOI...
Size of the dataset before cleaning: 4197487
Applying clean_filter...
Map:   0%|          | 0/4242 [00:00<?, ? examples/s]Map:  24%|â–ˆâ–ˆâ–Ž       | 1000/4242 [00:01<00:03, 896.67 examples/s]Map:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 2000/4242 [00:02<00:02, 814.26 examples/s]Map:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 3000/4242 [00:03<00:01, 786.67 examples/s]Map:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 4000/4242 [00:04<00:00, 821.38 examples/s]Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4242/4242 [00:05<00:00, 810.18 examples/s]Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4242/4242 [00:05<00:00, 813.68 examples/s]
Map:   0%|          | 0/1818 [00:00<?, ? examples/s]Map:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1000/1818 [00:01<00:01, 796.13 examples/s]Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1818/1818 [00:02<00:00, 683.71 examples/s]Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1818/1818 [00:02<00:00, 697.46 examples/s]
Map:   0%|          | 0/6060 [00:00<?, ? examples/s]Map:  17%|â–ˆâ–‹        | 1000/6060 [00:01<00:06, 832.19 examples/s]Map:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2000/6060 [00:02<00:04, 813.07 examples/s]Map:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 3000/6060 [00:03<00:03, 846.63 examples/s]Map:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 4000/6060 [00:04<00:02, 807.14 examples/s]Map:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5000/6060 [00:06<00:01, 803.22 examples/s]Map:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 6000/6060 [00:07<00:00, 812.82 examples/s]Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6060/6060 [00:07<00:00, 814.18 examples/s]
2025-05-19 12:49:21,258 - INFO - Starting hyperparameter search for BCE loss
[36m(train_hpo pid=123097)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=123097)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=123097)[0m 2025-05-19 12:49:31,550 - INFO - pos_weight value in TrainingArguments : 8.493688290834637
[36m(train_hpo pid=123097)[0m /home/leandre/Projects/BioMoQA_Playground/model/model_init.py:114: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=123097)[0m   super().__init__(*args, **kwargs)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-05-19_12-49-21   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 1                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/model/ray_results/train_hpo_2025-05-19_12-49-21
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-05-19_12-48-49_275921_119885/artifacts/2025-05-19_12-49-21/train_hpo_2025-05-19_12-49-21/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-05-19 12:49:23. Total running time: 0s
Logical resource usage: 0/32 CPUs, 0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_c4a74eea   PENDING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_c4a74eea started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_c4a74eea config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          2 â”‚
â”‚ pos_weight                          8.49369 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=123097)[0m [2025-05-19 12:49:31,764] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=123097)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=22, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=96, num_train_epochs=2, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 1 RUNNING
Current time: 2025-05-19 12:49:53. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_c4a74eea   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
Trial status: 1 RUNNING
Current time: 2025-05-19 12:50:23. Total running time: 1min 0s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_c4a74eea   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
Trial status: 1 RUNNING
Current time: 2025-05-19 12:50:53. Total running time: 1min 31s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_c4a74eea   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
Trial status: 1 RUNNING
Current time: 2025-05-19 12:51:23. Total running time: 2min 1s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)[36m(train_hpo pid=123097)[0m 2025-05-19 12:51:50,026 - INFO - Logits shape : (1818, 3) and logits squeeze shape : (1818, 3)

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_c4a74eea   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=123097)[0m {'loss': 1.4938, 'grad_norm': 2.557219982147217, 'learning_rate': 6.798212053829252e-07, 'epoch': 1.0}
[36m(train_hpo pid=123097)[0m {'eval_loss': 1.5462361574172974, 'eval_f1_weighted': 0.2958537645010361, 'eval_recall_weighted': 0.6122672508214677, 'eval_precision_weighted': 0.19944330180814984, 'eval_accuracy': 0.12981298129812982, 'eval_runtime': 18.1101, 'eval_samples_per_second': 100.386, 'eval_steps_per_second': 1.049, 'epoch': 1.0}
Trial status: 1 RUNNING
Current time: 2025-05-19 12:51:53. Total running time: 2min 31s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_c4a74eea   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
Trial status: 1 RUNNING
Current time: 2025-05-19 12:52:23. Total running time: 3min 1s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_c4a74eea   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
Trial status: 1 RUNNING
Current time: 2025-05-19 12:52:53. Total running time: 3min 31s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_c4a74eea   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
Trial status: 1 RUNNING
Current time: 2025-05-19 12:53:23. Total running time: 4min 1s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_c4a74eea   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=123097)[0m {'loss': 1.5327, 'grad_norm': 5.476688861846924, 'learning_rate': 0.0, 'epoch': 1.8888888888888888}
Trial status: 1 RUNNING
Current time: 2025-05-19 12:53:53. Total running time: 4min 31s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_c4a74eea   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(train_hpo pid=123097)[0m 2025-05-19 12:53:55,402 - INFO - Logits shape : (1818, 3) and logits squeeze shape : (1818, 3)
[36m(train_hpo pid=123097)[0m 2025-05-19 12:54:13,627 - INFO - Logits shape : (1818, 3) and logits squeeze shape : (1818, 3)
[36m(train_hpo pid=123097)[0m 2025-05-19 12:54:13,636 - INFO - eval_result: {'eval_loss': 1.5462361574172974, 'eval_f1_weighted': 0.2958537645010361, 'eval_recall_weighted': 0.6122672508214677, 'eval_precision_weighted': 0.19944330180814984, 'eval_accuracy': 0.12981298129812982, 'eval_runtime': 18.1187, 'eval_samples_per_second': 100.338, 'eval_steps_per_second': 1.049, 'epoch': 1.8888888888888888}
2025-05-19 12:54:13,794	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/model/ray_results/train_hpo_2025-05-19_12-49-21' in 0.0044s.
2025-05-19 12:54:13,798 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x77b62c565a50>
2025-05-19 12:54:13,798 - INFO - Best trial : train_hpo_c4a74eea
2025-05-19 12:54:13,799 - INFO - Best config : {'pos_weight': 8.493688290834637, 'learning_rate': 1.4956066518424355e-06, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 2}
2025-05-19 12:54:13,799 - INFO - Best trial after optimization: {'eval_loss': 1.5462361574172974, 'eval_f1_weighted': 0.2958537645010361, 'eval_recall_weighted': 0.6122672508214677, 'eval_precision_weighted': 0.19944330180814984, 'eval_accuracy': 0.12981298129812982, 'eval_runtime': 18.1187, 'eval_samples_per_second': 100.338, 'eval_steps_per_second': 1.049, 'epoch': 1.8888888888888888, 'timestamp': 1747652053, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': 'c4a74eea', 'date': '2025-05-19_12-54-13', 'time_this_iter_s': 283.7262861728668, 'time_total_s': 283.7262861728668, 'pid': 123097, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 8.493688290834637, 'learning_rate': 1.4956066518424355e-06, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 2}, 'time_since_restore': 283.7262861728668, 'iterations_since_restore': 1, 'experiment_tag': '1_learning_rate=0.0000,num_train_epochs=2,pos_weight=8.4937,weight_decay=0.1364'}
2025-05-19 12:54:13,800 - WARNING - Could not create parallel coordinates plot: 'ExperimentAnalysis' object has no attribute 'plot_parallel_coordinates'
2025-05-19 12:54:13,818 - INFO - analysis dataframe :    eval_loss  eval_f1_weighted  ...  config/num_train_epochs    logdir
0   1.546236          0.295854  ...                        2  c4a74eea

[1 rows x 27 columns]
2025-05-19 12:54:13,818 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-05-19 12:54:14,454 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/model/model_init.py:114: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)

[36m(train_hpo pid=123097)[0m {'eval_loss': 1.526901364326477, 'eval_f1_weighted': 0.2934044039102782, 'eval_recall_weighted': 0.6659364731653888, 'eval_precision_weighted': 0.19233940073667846, 'eval_accuracy': 0.08745874587458746, 'eval_runtime': 18.1308, 'eval_samples_per_second': 100.271, 'eval_steps_per_second': 1.048, 'epoch': 1.8888888888888888}
[36m(train_hpo pid=123097)[0m {'train_runtime': 260.7922, 'train_samples_per_second': 32.532, 'train_steps_per_second': 0.084, 'train_loss': 1.5114993182095615, 'epoch': 1.8888888888888888}
[36m(train_hpo pid=123097)[0m STATE at ending of training  :  TrainerState(epoch=1.8888888888888888, global_step=22, max_steps=22, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=96, num_train_epochs=2, num_input_tokens_seen=0, total_flos=2126482642077696.0, log_history=[{'loss': 1.4938, 'grad_norm': 2.557219982147217, 'learning_rate': 6.798212053829252e-07, 'epoch': 1.0, 'step': 12}, {'eval_loss': 1.5462361574172974, 'eval_f1_weighted': 0.2958537645010361, 'eval_recall_weighted': 0.6122672508214677, 'eval_precision_weighted': 0.19944330180814984, 'eval_accuracy': 0.12981298129812982, 'eval_runtime': 18.1101, 'eval_samples_per_second': 100.386, 'eval_steps_per_second': 1.049, 'epoch': 1.0, 'step': 12}, {'loss': 1.5327, 'grad_norm': 5.476688861846924, 'learning_rate': 0.0, 'epoch': 1.8888888888888888, 'step': 22}, {'eval_loss': 1.526901364326477, 'eval_f1_weighted': 0.2934044039102782, 'eval_recall_weighted': 0.6659364731653888, 'eval_precision_weighted': 0.19233940073667846, 'eval_accuracy': 0.08745874587458746, 'eval_runtime': 18.1308, 'eval_samples_per_second': 100.271, 'eval_steps_per_second': 1.048, 'epoch': 1.8888888888888888, 'step': 22}, {'train_runtime': 260.7922, 'train_samples_per_second': 32.532, 'train_steps_per_second': 0.084, 'total_flos': 2126482642077696.0, 'train_loss': 1.5114993182095615, 'epoch': 1.8888888888888888, 'step': 22}], best_metric=0.2958537645010361, best_model_checkpoint='./checkpoint-12', is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': True, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=123097)[0m {'eval_loss': 1.5462361574172974, 'eval_f1_weighted': 0.2958537645010361, 'eval_recall_weighted': 0.6122672508214677, 'eval_precision_weighted': 0.19944330180814984, 'eval_accuracy': 0.12981298129812982, 'eval_runtime': 18.1187, 'eval_samples_per_second': 100.338, 'eval_steps_per_second': 1.049, 'epoch': 1.8888888888888888}

Trial train_hpo_c4a74eea finished iteration 1 at 2025-05-19 12:54:13. Total running time: 4min 51s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_c4a74eea result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    283.726 â”‚
â”‚ time_total_s                        283.726 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               1.88889 â”‚
â”‚ eval_accuracy                       0.12981 â”‚
â”‚ eval_f1_weighted                    0.29585 â”‚
â”‚ eval_loss                           1.54624 â”‚
â”‚ eval_precision_weighted             0.19944 â”‚
â”‚ eval_recall_weighted                0.61227 â”‚
â”‚ eval_runtime                        18.1187 â”‚
â”‚ eval_samples_per_second             100.338 â”‚
â”‚ eval_steps_per_second                 1.049 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_c4a74eea completed after 1 iterations at 2025-05-19 12:54:13. Total running time: 4min 51s

Trial status: 1 TERMINATED
Current time: 2025-05-19 12:54:13. Total running time: 4min 51s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1_weighted     eval_recall_weighted     ...recision_weighted â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_c4a74eea   TERMINATED        8.49369       1.49561e-06          0.13641                    2        1            283.726       1.54624             0.295854                 0.612267                 0.199443 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

[2025-05-19 12:54:14,664] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
2025-05-19 12:54:15,981 - INFO - training size : 4242
2025-05-19 12:54:15,981 - INFO - test size : 6060
  0%|          | 0/90 [00:00<?, ?it/s]  1%|          | 1/90 [00:03<05:41,  3.84s/it]  2%|â–         | 2/90 [00:06<04:35,  3.14s/it]  3%|â–Ž         | 3/90 [00:09<04:13,  2.91s/it]  4%|â–         | 4/90 [00:11<04:01,  2.81s/it]  6%|â–Œ         | 5/90 [00:14<03:53,  2.75s/it]  7%|â–‹         | 6/90 [00:17<03:47,  2.71s/it]  8%|â–Š         | 7/90 [00:19<03:43,  2.69s/it]  9%|â–‰         | 8/90 [00:22<03:39,  2.68s/it] 10%|â–ˆ         | 9/90 [00:24<03:35,  2.67s/it] 11%|â–ˆ         | 10/90 [00:27<03:32,  2.66s/it] 12%|â–ˆâ–        | 11/90 [00:30<03:29,  2.65s/it] 13%|â–ˆâ–Ž        | 12/90 [00:32<03:26,  2.65s/it] 14%|â–ˆâ–        | 13/90 [00:35<03:23,  2.65s/it] 16%|â–ˆâ–Œ        | 14/90 [00:38<03:21,  2.65s/it] 17%|â–ˆâ–‹        | 15/90 [00:40<03:18,  2.65s/it] 18%|â–ˆâ–Š        | 16/90 [00:43<03:15,  2.65s/it] 19%|â–ˆâ–‰        | 17/90 [00:46<03:13,  2.65s/it] 20%|â–ˆâ–ˆ        | 18/90 [00:48<03:10,  2.65s/it] 21%|â–ˆâ–ˆ        | 19/90 [00:51<03:07,  2.65s/it] 22%|â–ˆâ–ˆâ–       | 20/90 [00:54<03:05,  2.65s/it] 23%|â–ˆâ–ˆâ–Ž       | 21/90 [00:56<03:02,  2.65s/it] 24%|â–ˆâ–ˆâ–       | 22/90 [00:59<03:00,  2.65s/it] 26%|â–ˆâ–ˆâ–Œ       | 23/90 [01:02<02:57,  2.65s/it] 27%|â–ˆâ–ˆâ–‹       | 24/90 [01:04<02:54,  2.65s/it] 28%|â–ˆâ–ˆâ–Š       | 25/90 [01:07<02:52,  2.65s/it] 29%|â–ˆâ–ˆâ–‰       | 26/90 [01:10<02:49,  2.65s/it] 30%|â–ˆâ–ˆâ–ˆ       | 27/90 [01:12<02:46,  2.65s/it] 31%|â–ˆâ–ˆâ–ˆ       | 28/90 [01:15<02:44,  2.65s/it] 32%|â–ˆâ–ˆâ–ˆâ–      | 29/90 [01:17<02:41,  2.65s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 30/90 [01:20<02:39,  2.65s/it] 34%|â–ˆâ–ˆâ–ˆâ–      | 31/90 [01:23<02:36,  2.65s/it] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 32/90 [01:25<02:33,  2.65s/it] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 33/90 [01:28<02:31,  2.65s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 34/90 [01:31<02:28,  2.65s/it] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 35/90 [01:33<02:25,  2.65s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 36/90 [01:36<02:23,  2.65s/it] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 37/90 [01:39<02:20,  2.65s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 38/90 [01:41<02:17,  2.65s/it] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 39/90 [01:44<02:14,  2.65s/it] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 40/90 [01:47<02:12,  2.65s/it] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 41/90 [01:49<02:09,  2.65s/it] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 42/90 [01:52<02:07,  2.65s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 43/90 [01:55<02:04,  2.65s/it] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 44/90 [01:57<02:01,  2.64s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 45/90 [01:58<01:34,  2.10s/it]                                                50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 45/90 [01:58<01:34,  2.10s/it]{'loss': 1.4481, 'grad_norm': 8.087327003479004, 'learning_rate': 7.478033259212177e-07, 'epoch': 1.0}

  0%|          | 0/19 [00:00<?, ?it/s][A
 11%|â–ˆ         | 2/19 [00:00<00:08,  2.09it/s][A
 16%|â–ˆâ–Œ        | 3/19 [00:01<00:10,  1.48it/s][A
 21%|â–ˆâ–ˆ        | 4/19 [00:02<00:11,  1.28it/s][A
 26%|â–ˆâ–ˆâ–‹       | 5/19 [00:03<00:11,  1.19it/s][A
 32%|â–ˆâ–ˆâ–ˆâ–      | 6/19 [00:04<00:11,  1.14it/s][A
 37%|â–ˆâ–ˆâ–ˆâ–‹      | 7/19 [00:05<00:10,  1.11it/s][A
 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 8/19 [00:06<00:10,  1.08it/s][A
 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 9/19 [00:07<00:09,  1.07it/s][A
 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 10/19 [00:08<00:08,  1.06it/s][A
 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 11/19 [00:09<00:07,  1.05it/s][A
 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 12/19 [00:10<00:06,  1.05it/s][A
 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 13/19 [00:11<00:05,  1.05it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 14/19 [00:12<00:04,  1.05it/s][A
 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 15/19 [00:13<00:03,  1.05it/s][A
 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 16/19 [00:14<00:02,  1.05it/s][A
 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 17/19 [00:15<00:01,  1.05it/s][A
 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 18/19 [00:16<00:00,  1.04it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 19/19 [00:17<00:00,  1.07it/s][A2025-05-19 12:56:33,001 - INFO - Logits shape : (1818, 3) and logits squeeze shape : (1818, 3)
                                               
                                               [A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 45/90 [02:16<01:34,  2.10s/it]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 19/19 [00:17<00:00,  1.07it/s][A
                                               [A 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 46/90 [02:21<06:03,  8.26s/it] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 47/90 [02:23<04:42,  6.58s/it] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 48/90 [02:26<03:46,  5.40s/it] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 49/90 [02:29<03:07,  4.57s/it] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 50/90 [02:31<02:39,  4.00s/it] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 51/90 [02:34<02:20,  3.59s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 52/90 [02:37<02:05,  3.31s/it] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 53/90 [02:39<01:55,  3.12s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 54/90 [02:42<01:47,  2.98s/it] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 55/90 [02:44<01:40,  2.88s/it] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 56/90 [02:47<01:35,  2.81s/it] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 57/90 [02:50<01:31,  2.76s/it] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 58/90 [02:52<01:27,  2.72s/it] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 59/90 [02:55<01:23,  2.70s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 60/90 [02:58<01:20,  2.69s/it] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 61/90 [03:00<01:17,  2.68s/it] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 62/90 [03:03<01:14,  2.67s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 63/90 [03:06<01:12,  2.67s/it] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 64/90 [03:08<01:09,  2.67s/it] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 65/90 [03:11<01:06,  2.67s/it] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 66/90 [03:14<01:03,  2.66s/it] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 67/90 [03:16<01:01,  2.65s/it] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 68/90 [03:19<00:58,  2.65s/it] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 69/90 [03:22<00:55,  2.65s/it] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 70/90 [03:24<00:53,  2.65s/it] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 71/90 [03:27<00:50,  2.65s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 72/90 [03:30<00:47,  2.65s/it] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 73/90 [03:32<00:45,  2.65s/it] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 74/90 [03:35<00:42,  2.65s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 75/90 [03:38<00:39,  2.65s/it] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 76/90 [03:40<00:37,  2.65s/it] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 77/90 [03:43<00:34,  2.65s/it] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 78/90 [03:45<00:31,  2.65s/it] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 79/90 [03:48<00:29,  2.65s/it] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 80/90 [03:51<00:26,  2.65s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 81/90 [03:53<00:23,  2.65s/it] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 82/90 [03:56<00:21,  2.66s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 83/90 [03:59<00:18,  2.66s/it] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 84/90 [04:01<00:15,  2.65s/it] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 85/90 [04:04<00:13,  2.65s/it] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 86/90 [04:07<00:10,  2.65s/it] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 87/90 [04:09<00:07,  2.65s/it] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 88/90 [04:12<00:05,  2.65s/it] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 89/90 [04:15<00:02,  2.64s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [04:15<00:00,  2.10s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [04:15<00:00,  2.10s/it]{'eval_loss': 1.3917925357818604, 'eval_f1_weighted': 0.3126949366161407, 'eval_recall_weighted': 0.9474260679079957, 'eval_precision_weighted': 0.1876266050921216, 'eval_accuracy': 0.0088008800880088, 'eval_runtime': 18.1946, 'eval_samples_per_second': 99.92, 'eval_steps_per_second': 1.044, 'epoch': 1.0}
{'loss': 1.3697, 'grad_norm': 12.357400894165039, 'learning_rate': 0.0, 'epoch': 2.0}

  0%|          | 0/19 [00:00<?, ?it/s][A
 11%|â–ˆ         | 2/19 [00:00<00:08,  2.10it/s][A
 16%|â–ˆâ–Œ        | 3/19 [00:01<00:10,  1.48it/s][A
 21%|â–ˆâ–ˆ        | 4/19 [00:02<00:11,  1.28it/s][A
 26%|â–ˆâ–ˆâ–‹       | 5/19 [00:03<00:11,  1.19it/s][A
 32%|â–ˆâ–ˆâ–ˆâ–      | 6/19 [00:04<00:11,  1.14it/s][A
 37%|â–ˆâ–ˆâ–ˆâ–‹      | 7/19 [00:05<00:10,  1.11it/s][A
 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 8/19 [00:06<00:10,  1.09it/s][A
 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 9/19 [00:07<00:09,  1.07it/s][A
 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 10/19 [00:08<00:08,  1.07it/s][A
 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 11/19 [00:09<00:07,  1.06it/s][A
 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 12/19 [00:10<00:06,  1.06it/s][A
 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 13/19 [00:11<00:05,  1.05it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 14/19 [00:12<00:04,  1.05it/s][A
 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 15/19 [00:13<00:03,  1.05it/s][A
 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 16/19 [00:14<00:02,  1.05it/s][A
 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 17/19 [00:15<00:01,  1.05it/s][A
 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 18/19 [00:16<00:00,  1.05it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 19/19 [00:17<00:00,  1.08it/s][A2025-05-19 12:58:50,385 - INFO - Logits shape : (1818, 3) and logits squeeze shape : (1818, 3)
                                               
                                               [A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [04:34<00:00,  2.10s/it]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 19/19 [00:17<00:00,  1.08it/s][A
                                               [A                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [04:36<00:00,  2.10s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [04:36<00:00,  3.07s/it]
{'eval_loss': 1.3590526580810547, 'eval_f1_weighted': 0.3156663024598357, 'eval_recall_weighted': 0.9518072289156626, 'eval_precision_weighted': 0.18958993172741756, 'eval_accuracy': 0.0088008800880088, 'eval_runtime': 18.1483, 'eval_samples_per_second': 100.175, 'eval_steps_per_second': 1.047, 'epoch': 2.0}
{'train_runtime': 276.1354, 'train_samples_per_second': 30.724, 'train_steps_per_second': 0.326, 'train_loss': 1.408880360921224, 'epoch': 2.0}
  0%|          | 0/19 [00:00<?, ?it/s] 11%|â–ˆ         | 2/19 [00:00<00:08,  2.10it/s] 16%|â–ˆâ–Œ        | 3/19 [00:01<00:10,  1.48it/s] 21%|â–ˆâ–ˆ        | 4/19 [00:02<00:11,  1.28it/s] 26%|â–ˆâ–ˆâ–‹       | 5/19 [00:03<00:11,  1.19it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 6/19 [00:04<00:11,  1.14it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 7/19 [00:05<00:10,  1.11it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 8/19 [00:06<00:10,  1.09it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 9/19 [00:07<00:09,  1.07it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 10/19 [00:08<00:08,  1.06it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 11/19 [00:09<00:07,  1.05it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 12/19 [00:10<00:06,  1.05it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 13/19 [00:11<00:05,  1.05it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 14/19 [00:12<00:04,  1.05it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 15/19 [00:13<00:03,  1.05it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 16/19 [00:14<00:02,  1.05it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 17/19 [00:15<00:01,  1.04it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 18/19 [00:16<00:00,  1.04it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 19/19 [00:17<00:00,  1.08it/s]2025-05-19 12:59:10,776 - INFO - Logits shape : (1818, 3) and logits squeeze shape : (1818, 3)
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 19/19 [00:17<00:00,  1.11it/s]
2025-05-19 12:59:10,786 - INFO - Training time : 296.9676681510173
  0%|          | 0/64 [00:00<?, ?it/s]  3%|â–Ž         | 2/64 [00:00<00:29,  2.09it/s]  5%|â–         | 3/64 [00:01<00:41,  1.48it/s]  6%|â–‹         | 4/64 [00:02<00:46,  1.28it/s]  8%|â–Š         | 5/64 [00:03<00:49,  1.19it/s]  9%|â–‰         | 6/64 [00:04<00:51,  1.13it/s] 11%|â–ˆ         | 7/64 [00:05<00:51,  1.10it/s] 12%|â–ˆâ–Ž        | 8/64 [00:06<00:51,  1.09it/s] 14%|â–ˆâ–        | 9/64 [00:07<00:51,  1.07it/s] 16%|â–ˆâ–Œ        | 10/64 [00:08<00:50,  1.07it/s] 17%|â–ˆâ–‹        | 11/64 [00:09<00:50,  1.06it/s] 19%|â–ˆâ–‰        | 12/64 [00:10<00:49,  1.06it/s] 20%|â–ˆâ–ˆ        | 13/64 [00:11<00:48,  1.05it/s] 22%|â–ˆâ–ˆâ–       | 14/64 [00:12<00:47,  1.05it/s] 23%|â–ˆâ–ˆâ–Ž       | 15/64 [00:13<00:46,  1.05it/s] 25%|â–ˆâ–ˆâ–Œ       | 16/64 [00:14<00:45,  1.05it/s] 27%|â–ˆâ–ˆâ–‹       | 17/64 [00:15<00:44,  1.05it/s] 28%|â–ˆâ–ˆâ–Š       | 18/64 [00:16<00:43,  1.05it/s] 30%|â–ˆâ–ˆâ–‰       | 19/64 [00:17<00:42,  1.05it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 20/64 [00:18<00:41,  1.05it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 21/64 [00:19<00:40,  1.05it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 22/64 [00:20<00:39,  1.05it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 23/64 [00:20<00:39,  1.05it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 24/64 [00:21<00:38,  1.05it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 25/64 [00:22<00:37,  1.05it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 26/64 [00:23<00:36,  1.05it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 27/64 [00:24<00:35,  1.05it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 28/64 [00:25<00:34,  1.05it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 29/64 [00:26<00:33,  1.05it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 30/64 [00:27<00:32,  1.05it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 31/64 [00:28<00:31,  1.05it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 32/64 [00:29<00:30,  1.05it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 33/64 [00:30<00:29,  1.05it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 34/64 [00:31<00:28,  1.05it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 35/64 [00:32<00:27,  1.05it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 36/64 [00:33<00:26,  1.05it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 37/64 [00:34<00:25,  1.05it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 38/64 [00:35<00:24,  1.05it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 39/64 [00:36<00:23,  1.05it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 40/64 [00:37<00:22,  1.05it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 41/64 [00:38<00:21,  1.05it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 42/64 [00:39<00:20,  1.05it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 43/64 [00:40<00:20,  1.05it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 44/64 [00:41<00:19,  1.05it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 45/64 [00:41<00:18,  1.05it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 46/64 [00:42<00:17,  1.05it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 47/64 [00:43<00:16,  1.05it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 48/64 [00:44<00:15,  1.05it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 49/64 [00:45<00:14,  1.05it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 50/64 [00:46<00:13,  1.05it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 51/64 [00:47<00:12,  1.05it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 52/64 [00:48<00:11,  1.05it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 53/64 [00:49<00:10,  1.04it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 54/64 [00:50<00:09,  1.04it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 55/64 [00:51<00:08,  1.04it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 56/64 [00:52<00:07,  1.05it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 57/64 [00:53<00:06,  1.03it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 58/64 [00:54<00:06,  1.03s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 59/64 [00:55<00:05,  1.01s/it] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 60/64 [00:56<00:03,  1.01it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 61/64 [00:57<00:02,  1.02it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 62/64 [00:58<00:01,  1.03it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 63/64 [00:59<00:00,  1.05it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:59<00:00,  1.32it/s]2025-05-19 13:00:11,479 - INFO - Logits shape : (6060, 3) and logits squeeze shape : (6060, 3)
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:59<00:00,  1.07it/s]
2025-05-19 13:00:11,491 - INFO - Evaluation time : 60.704773378995014
2025-05-19 13:00:11,491 - INFO - Evaluation results on test set: {'eval_loss': 1.3513699769973755, 'eval_f1_weighted': 0.3181810020939501, 'eval_recall_weighted': 0.9566360052562418, 'eval_precision_weighted': 0.19118281539950172, 'eval_accuracy': 0.004785478547854785, 'eval_runtime': 60.7019, 'eval_samples_per_second': 99.832, 'eval_steps_per_second': 1.054, 'epoch': 2.0}
2025-05-19 13:00:11,491 - INFO - Total updates (optimizer steps): 90
2025-05-19 13:00:11,491 - INFO - Avg time / step: 3.067s
2025-05-19 13:00:12,330 - INFO - Best model saved to ./final_model/best_model_cross_val_BCEmicrosoft/BiomedNLP-BiomedBERT-base-uncased-abstract1trials_fold-1
2025-05-19 13:00:12,330 - INFO - On test Set (with threshold 0.5) : 
  0%|          | 0/64 [00:00<?, ?it/s]  3%|â–Ž         | 2/64 [00:00<00:29,  2.10it/s]  5%|â–         | 3/64 [00:01<00:41,  1.48it/s]  6%|â–‹         | 4/64 [00:02<00:46,  1.29it/s]  8%|â–Š         | 5/64 [00:03<00:49,  1.19it/s]  9%|â–‰         | 6/64 [00:04<00:50,  1.14it/s] 11%|â–ˆ         | 7/64 [00:05<00:51,  1.11it/s] 12%|â–ˆâ–Ž        | 8/64 [00:06<00:51,  1.09it/s] 14%|â–ˆâ–        | 9/64 [00:07<00:51,  1.08it/s] 16%|â–ˆâ–Œ        | 10/64 [00:08<00:50,  1.07it/s] 17%|â–ˆâ–‹        | 11/64 [00:09<00:49,  1.06it/s] 19%|â–ˆâ–‰        | 12/64 [00:10<00:49,  1.06it/s] 20%|â–ˆâ–ˆ        | 13/64 [00:11<00:48,  1.05it/s] 22%|â–ˆâ–ˆâ–       | 14/64 [00:12<00:47,  1.05it/s] 23%|â–ˆâ–ˆâ–Ž       | 15/64 [00:13<00:46,  1.05it/s] 25%|â–ˆâ–ˆâ–Œ       | 16/64 [00:14<00:45,  1.05it/s] 27%|â–ˆâ–ˆâ–‹       | 17/64 [00:15<00:45,  1.04it/s] 28%|â–ˆâ–ˆâ–Š       | 18/64 [00:16<00:44,  1.04it/s] 30%|â–ˆâ–ˆâ–‰       | 19/64 [00:17<00:43,  1.03it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 20/64 [00:18<00:42,  1.03it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 21/64 [00:19<00:41,  1.03it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 22/64 [00:20<00:40,  1.04it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 23/64 [00:21<00:39,  1.04it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 24/64 [00:22<00:38,  1.04it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 25/64 [00:22<00:37,  1.05it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 26/64 [00:23<00:36,  1.05it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 27/64 [00:24<00:35,  1.05it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 28/64 [00:25<00:34,  1.05it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 29/64 [00:26<00:33,  1.04it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 30/64 [00:27<00:32,  1.05it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 31/64 [00:28<00:31,  1.04it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 32/64 [00:29<00:30,  1.04it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 33/64 [00:30<00:29,  1.05it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 34/64 [00:31<00:28,  1.05it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 35/64 [00:32<00:27,  1.05it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 36/64 [00:33<00:26,  1.05it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 37/64 [00:34<00:25,  1.05it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 38/64 [00:35<00:24,  1.05it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 39/64 [00:36<00:23,  1.05it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 40/64 [00:37<00:22,  1.05it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 41/64 [00:38<00:21,  1.05it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 42/64 [00:39<00:20,  1.05it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 43/64 [00:40<00:20,  1.05it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 44/64 [00:41<00:19,  1.05it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 45/64 [00:42<00:18,  1.05it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 46/64 [00:43<00:17,  1.05it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 47/64 [00:43<00:16,  1.05it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 48/64 [00:44<00:15,  1.05it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 49/64 [00:45<00:14,  1.05it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 50/64 [00:46<00:13,  1.05it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 51/64 [00:47<00:12,  1.05it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 52/64 [00:48<00:11,  1.05it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 53/64 [00:49<00:10,  1.05it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 54/64 [00:50<00:09,  1.04it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 55/64 [00:51<00:08,  1.04it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 56/64 [00:52<00:07,  1.05it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 57/64 [00:53<00:06,  1.05it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 58/64 [00:54<00:05,  1.05it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 59/64 [00:55<00:04,  1.05it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 60/64 [00:56<00:03,  1.05it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 61/64 [00:57<00:02,  1.05it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 62/64 [00:58<00:01,  1.05it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 63/64 [00:59<00:00,  1.07it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:59<00:00,  1.34it/s]2025-05-19 13:01:12,840 - INFO - Logits shape : (6060, 3) and logits squeeze shape : (6060, 3)
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:59<00:00,  1.08it/s]
2025-05-19 13:01:12,909 - INFO - label vals shape : (6060, 3)
2025-05-19 13:01:12,909 - INFO - predictions vals shape : (6060, 3)
2025-05-19 13:01:13,067 - INFO - Metrics: {'f1_IAS': 0.36203576341127924, 'f1_SUA': 0.26162260711030083, 'f1_VA': 0.29935559461042766, 'f1_weighted': 0.3181810020939501, 'f1_macro': 0.30767132171066924, 'f1_micro': 0.3150492264416315, 'recall_IAS': 0.9924585218702866, 'recall_SUA': 0.8391812865497076, 'recall_VA': 0.988394584139265, 'recall_weighted': 0.9566360052562418, 'recall_macro': 0.9400114641864197, 'recall_micro': 0.9566360052562418, 'precision_IAS': 0.22139973082099595, 'precision_SUA': 0.15496760259179265, 'precision_VA': 0.17638936831204693, 'precision_weighted': 0.19118281539950172, 'precision_macro': 0.18425223390827852, 'precision_micro': 0.1885766092475068, 'accuracy': 0.004785478547854785}
/home/leandre/Projects/BioMoQA_Playground/model/multi_label_pipeline.py:422: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  self.result_metrics = pd.concat([
2025-05-19 13:01:13,069 - INFO - Results for fold 1 : [{'f1_IAS': 0.36203576341127924, 'f1_SUA': 0.26162260711030083, 'f1_VA': 0.29935559461042766, 'f1_weighted': 0.3181810020939501, 'f1_macro': 0.30767132171066924, 'f1_micro': 0.3150492264416315, 'recall_IAS': 0.9924585218702866, 'recall_SUA': 0.8391812865497076, 'recall_VA': 0.988394584139265, 'recall_weighted': 0.9566360052562418, 'recall_macro': 0.9400114641864197, 'recall_micro': 0.9566360052562418, 'precision_IAS': 0.22139973082099595, 'precision_SUA': 0.15496760259179265, 'precision_VA': 0.17638936831204693, 'precision_weighted': 0.19118281539950172, 'precision_macro': 0.18425223390827852, 'precision_micro': 0.1885766092475068, 'accuracy': 0.004785478547854785}]
2025-05-19 13:01:13,204 - INFO - 
fold number 2 / 2
2025-05-19 13:01:13,249 - INFO - train+dev split size : 6060
2025-05-19 13:01:13,249 - INFO - test split size : 6060
2025-05-19 13:01:13,696 - INFO - train split size : 4242
2025-05-19 13:01:13,696 - INFO - dev split size : 1818
Map:   0%|          | 0/4242 [00:00<?, ? examples/s]Map:  24%|â–ˆâ–ˆâ–Ž       | 1000/4242 [00:01<00:03, 868.75 examples/s]Map:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 2000/4242 [00:02<00:02, 861.57 examples/s]Map:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 3000/4242 [00:03<00:01, 823.11 examples/s]Map:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 4000/4242 [00:04<00:00, 839.20 examples/s]Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4242/4242 [00:05<00:00, 850.71 examples/s]Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4242/4242 [00:05<00:00, 845.97 examples/s]
Map:   0%|          | 0/1818 [00:00<?, ? examples/s]Map:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1000/1818 [00:01<00:00, 894.46 examples/s]Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1818/1818 [00:02<00:00, 869.46 examples/s]Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1818/1818 [00:02<00:00, 870.10 examples/s]
Map:   0%|          | 0/6060 [00:00<?, ? examples/s]Map:  17%|â–ˆâ–‹        | 1000/6060 [00:01<00:06, 833.78 examples/s]Map:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2000/6060 [00:02<00:04, 844.52 examples/s]Map:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 3000/6060 [00:03<00:03, 854.08 examples/s]Map:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 4000/6060 [00:04<00:02, 830.41 examples/s]Map:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5000/6060 [00:05<00:01, 836.51 examples/s]Map:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 6000/6060 [00:07<00:00, 840.35 examples/s]Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6060/6060 [00:07<00:00, 839.52 examples/s]
2025-05-19 13:01:29,786 - INFO - Starting hyperparameter search for BCE loss
[36m(train_hpo pid=135056)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=135056)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=135056)[0m 2025-05-19 13:01:38,081 - INFO - pos_weight value in TrainingArguments : 8.493688290834637
[36m(train_hpo pid=135056)[0m /home/leandre/Projects/BioMoQA_Playground/model/model_init.py:114: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=135056)[0m   super().__init__(*args, **kwargs)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-05-19_13-01-29   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 1                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/model/ray_results/train_hpo_2025-05-19_13-01-29
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-05-19_12-48-49_275921_119885/artifacts/2025-05-19_13-01-29/train_hpo_2025-05-19_13-01-29/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-05-19 13:01:30. Total running time: 0s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_c23b990f   PENDING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_c23b990f started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_c23b990f config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          2 â”‚
â”‚ pos_weight                          8.49369 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=135056)[0m [2025-05-19 13:01:38,297] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=135056)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=22, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=96, num_train_epochs=2, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 1 RUNNING
Current time: 2025-05-19 13:02:00. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_c23b990f   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
Trial status: 1 RUNNING
Current time: 2025-05-19 13:02:30. Total running time: 1min 0s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_c23b990f   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
Trial status: 1 RUNNING
Current time: 2025-05-19 13:03:00. Total running time: 1min 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_c23b990f   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
Trial status: 1 RUNNING
Current time: 2025-05-19 13:03:30. Total running time: 2min 0s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)[36m(train_hpo pid=135056)[0m 2025-05-19 13:03:56,902 - INFO - Logits shape : (1818, 3) and logits squeeze shape : (1818, 3)

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_c23b990f   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=135056)[0m {'loss': 1.3905, 'grad_norm': 2.520428419113159, 'learning_rate': 6.798212053829252e-07, 'epoch': 1.0}
[36m(train_hpo pid=135056)[0m {'eval_loss': 1.4494879245758057, 'eval_f1_weighted': 0.31778864915624805, 'eval_recall_weighted': 0.9244249726177437, 'eval_precision_weighted': 0.1924775563951045, 'eval_accuracy': 0.020902090209020903, 'eval_runtime': 18.0715, 'eval_samples_per_second': 100.6, 'eval_steps_per_second': 1.051, 'epoch': 1.0}
Trial status: 1 RUNNING
Current time: 2025-05-19 13:04:00. Total running time: 2min 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_c23b990f   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
Trial status: 1 RUNNING
Current time: 2025-05-19 13:04:30. Total running time: 3min 0s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_c23b990f   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
Trial status: 1 RUNNING
Current time: 2025-05-19 13:05:00. Total running time: 3min 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_c23b990f   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
Trial status: 1 RUNNING
Current time: 2025-05-19 13:05:30. Total running time: 4min 1s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_c23b990f   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=135056)[0m {'loss': 1.4376, 'grad_norm': 4.24397087097168, 'learning_rate': 0.0, 'epoch': 1.8888888888888888}
Trial status: 1 RUNNING
Current time: 2025-05-19 13:06:00. Total running time: 4min 31s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_c23b990f   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(train_hpo pid=135056)[0m 2025-05-19 13:06:01,935 - INFO - Logits shape : (1818, 3) and logits squeeze shape : (1818, 3)
[36m(train_hpo pid=135056)[0m 2025-05-19 13:06:20,182 - INFO - Logits shape : (1818, 3) and logits squeeze shape : (1818, 3)
[36m(train_hpo pid=135056)[0m 2025-05-19 13:06:20,191 - INFO - eval_result: {'eval_loss': 1.4494879245758057, 'eval_f1_weighted': 0.31778864915624805, 'eval_recall_weighted': 0.9244249726177437, 'eval_precision_weighted': 0.1924775563951045, 'eval_accuracy': 0.020902090209020903, 'eval_runtime': 18.1288, 'eval_samples_per_second': 100.282, 'eval_steps_per_second': 1.048, 'epoch': 1.8888888888888888}
2025-05-19 13:06:20,360	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/model/ray_results/train_hpo_2025-05-19_13-01-29' in 0.0044s.
2025-05-19 13:06:20,364 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x77addc713710>
2025-05-19 13:06:20,364 - INFO - Best trial : train_hpo_c23b990f
2025-05-19 13:06:20,364 - INFO - Best config : {'pos_weight': 8.493688290834637, 'learning_rate': 1.4956066518424355e-06, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 2}
2025-05-19 13:06:20,364 - INFO - Best trial after optimization: {'eval_loss': 1.4494879245758057, 'eval_f1_weighted': 0.31778864915624805, 'eval_recall_weighted': 0.9244249726177437, 'eval_precision_weighted': 0.1924775563951045, 'eval_accuracy': 0.020902090209020903, 'eval_runtime': 18.1288, 'eval_samples_per_second': 100.282, 'eval_steps_per_second': 1.048, 'epoch': 1.8888888888888888, 'timestamp': 1747652780, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': 'c23b990f', 'date': '2025-05-19_13-06-20', 'time_this_iter_s': 283.2141137123108, 'time_total_s': 283.2141137123108, 'pid': 135056, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 8.493688290834637, 'learning_rate': 1.4956066518424355e-06, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 2}, 'time_since_restore': 283.2141137123108, 'iterations_since_restore': 1, 'experiment_tag': '1_learning_rate=0.0000,num_train_epochs=2,pos_weight=8.4937,weight_decay=0.1364'}
2025-05-19 13:06:20,365 - WARNING - Could not create parallel coordinates plot: 'ExperimentAnalysis' object has no attribute 'plot_parallel_coordinates'
2025-05-19 13:06:20,381 - INFO - analysis dataframe :    eval_loss  eval_f1_weighted  ...  config/num_train_epochs    logdir
0   1.449488          0.317789  ...                        2  c23b990f

[1 rows x 27 columns]
2025-05-19 13:06:20,381 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-05-19 13:06:21,009 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/model/model_init.py:114: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-05-19 13:06:21,214 - INFO - training size : 4242
2025-05-19 13:06:21,215 - INFO - test size : 6060

[36m(train_hpo pid=135056)[0m {'eval_loss': 1.4354747533798218, 'eval_f1_weighted': 0.31761683742532787, 'eval_recall_weighted': 0.9452354874041621, 'eval_precision_weighted': 0.19141439547577058, 'eval_accuracy': 0.0165016501650165, 'eval_runtime': 18.1166, 'eval_samples_per_second': 100.35, 'eval_steps_per_second': 1.049, 'epoch': 1.8888888888888888}
[36m(train_hpo pid=135056)[0m {'train_runtime': 260.576, 'train_samples_per_second': 32.559, 'train_steps_per_second': 0.084, 'train_loss': 1.4119531458074397, 'epoch': 1.8888888888888888}
[36m(train_hpo pid=135056)[0m STATE at ending of training  :  TrainerState(epoch=1.8888888888888888, global_step=22, max_steps=22, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=96, num_train_epochs=2, num_input_tokens_seen=0, total_flos=2126482642077696.0, log_history=[{'loss': 1.3905, 'grad_norm': 2.520428419113159, 'learning_rate': 6.798212053829252e-07, 'epoch': 1.0, 'step': 12}, {'eval_loss': 1.4494879245758057, 'eval_f1_weighted': 0.31778864915624805, 'eval_recall_weighted': 0.9244249726177437, 'eval_precision_weighted': 0.1924775563951045, 'eval_accuracy': 0.020902090209020903, 'eval_runtime': 18.0715, 'eval_samples_per_second': 100.6, 'eval_steps_per_second': 1.051, 'epoch': 1.0, 'step': 12}, {'loss': 1.4376, 'grad_norm': 4.24397087097168, 'learning_rate': 0.0, 'epoch': 1.8888888888888888, 'step': 22}, {'eval_loss': 1.4354747533798218, 'eval_f1_weighted': 0.31761683742532787, 'eval_recall_weighted': 0.9452354874041621, 'eval_precision_weighted': 0.19141439547577058, 'eval_accuracy': 0.0165016501650165, 'eval_runtime': 18.1166, 'eval_samples_per_second': 100.35, 'eval_steps_per_second': 1.049, 'epoch': 1.8888888888888888, 'step': 22}, {'train_runtime': 260.576, 'train_samples_per_second': 32.559, 'train_steps_per_second': 0.084, 'total_flos': 2126482642077696.0, 'train_loss': 1.4119531458074397, 'epoch': 1.8888888888888888, 'step': 22}], best_metric=0.31778864915624805, best_model_checkpoint='./checkpoint-12', is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': True, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=135056)[0m {'eval_loss': 1.4494879245758057, 'eval_f1_weighted': 0.31778864915624805, 'eval_recall_weighted': 0.9244249726177437, 'eval_precision_weighted': 0.1924775563951045, 'eval_accuracy': 0.020902090209020903, 'eval_runtime': 18.1288, 'eval_samples_per_second': 100.282, 'eval_steps_per_second': 1.048, 'epoch': 1.8888888888888888}

Trial train_hpo_c23b990f finished iteration 1 at 2025-05-19 13:06:20. Total running time: 4min 50s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_c23b990f result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    283.214 â”‚
â”‚ time_total_s                        283.214 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               1.88889 â”‚
â”‚ eval_accuracy                        0.0209 â”‚
â”‚ eval_f1_weighted                    0.31779 â”‚
â”‚ eval_loss                           1.44949 â”‚
â”‚ eval_precision_weighted             0.19248 â”‚
â”‚ eval_recall_weighted                0.92442 â”‚
â”‚ eval_runtime                        18.1288 â”‚
â”‚ eval_samples_per_second             100.282 â”‚
â”‚ eval_steps_per_second                 1.048 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_c23b990f completed after 1 iterations at 2025-05-19 13:06:20. Total running time: 4min 50s

Trial status: 1 TERMINATED
Current time: 2025-05-19 13:06:20. Total running time: 4min 50s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1_weighted     eval_recall_weighted     ...recision_weighted â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_c23b990f   TERMINATED        8.49369       1.49561e-06          0.13641                    2        1            283.214       1.44949             0.317789                 0.924425                 0.192478 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

  0%|          | 0/90 [00:00<?, ?it/s]  1%|          | 1/90 [00:02<04:02,  2.72s/it]  2%|â–         | 2/90 [00:05<03:55,  2.68s/it]  3%|â–Ž         | 3/90 [00:08<03:51,  2.66s/it]  4%|â–         | 4/90 [00:10<03:48,  2.66s/it]  6%|â–Œ         | 5/90 [00:13<03:45,  2.65s/it]  7%|â–‹         | 6/90 [00:15<03:42,  2.65s/it]  8%|â–Š         | 7/90 [00:18<03:39,  2.64s/it]  9%|â–‰         | 8/90 [00:21<03:36,  2.64s/it] 10%|â–ˆ         | 9/90 [00:23<03:34,  2.64s/it] 11%|â–ˆ         | 10/90 [00:26<03:31,  2.64s/it] 12%|â–ˆâ–        | 11/90 [00:29<03:28,  2.64s/it] 13%|â–ˆâ–Ž        | 12/90 [00:31<03:26,  2.65s/it] 14%|â–ˆâ–        | 13/90 [00:34<03:23,  2.64s/it] 16%|â–ˆâ–Œ        | 14/90 [00:37<03:20,  2.64s/it] 17%|â–ˆâ–‹        | 15/90 [00:39<03:18,  2.64s/it] 18%|â–ˆâ–Š        | 16/90 [00:42<03:16,  2.65s/it] 19%|â–ˆâ–‰        | 17/90 [00:45<03:13,  2.65s/it] 20%|â–ˆâ–ˆ        | 18/90 [00:47<03:10,  2.65s/it] 21%|â–ˆâ–ˆ        | 19/90 [00:50<03:07,  2.65s/it] 22%|â–ˆâ–ˆâ–       | 20/90 [00:52<03:05,  2.65s/it] 23%|â–ˆâ–ˆâ–Ž       | 21/90 [00:55<03:02,  2.65s/it] 24%|â–ˆâ–ˆâ–       | 22/90 [00:58<03:00,  2.65s/it] 26%|â–ˆâ–ˆâ–Œ       | 23/90 [01:00<02:57,  2.65s/it] 27%|â–ˆâ–ˆâ–‹       | 24/90 [01:03<02:55,  2.65s/it] 28%|â–ˆâ–ˆâ–Š       | 25/90 [01:06<02:52,  2.65s/it] 29%|â–ˆâ–ˆâ–‰       | 26/90 [01:08<02:49,  2.65s/it] 30%|â–ˆâ–ˆâ–ˆ       | 27/90 [01:11<02:46,  2.65s/it] 31%|â–ˆâ–ˆâ–ˆ       | 28/90 [01:14<02:44,  2.65s/it] 32%|â–ˆâ–ˆâ–ˆâ–      | 29/90 [01:16<02:41,  2.65s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 30/90 [01:19<02:38,  2.65s/it] 34%|â–ˆâ–ˆâ–ˆâ–      | 31/90 [01:22<02:36,  2.65s/it] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 32/90 [01:24<02:33,  2.65s/it] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 33/90 [01:27<02:30,  2.65s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 34/90 [01:30<02:28,  2.65s/it] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 35/90 [01:32<02:25,  2.65s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 36/90 [01:35<02:23,  2.65s/it] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 37/90 [01:38<02:20,  2.65s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 38/90 [01:40<02:17,  2.65s/it] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 39/90 [01:43<02:15,  2.65s/it] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 40/90 [01:45<02:12,  2.65s/it] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 41/90 [01:48<02:09,  2.65s/it] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 42/90 [01:51<02:07,  2.65s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 43/90 [01:53<02:04,  2.65s/it] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 44/90 [01:56<02:01,  2.63s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 45/90 [01:57<01:34,  2.10s/it]                                                50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 45/90 [01:57<01:34,  2.10s/it]{'loss': 1.467, 'grad_norm': 11.108916282653809, 'learning_rate': 7.478033259212177e-07, 'epoch': 1.0}

  0%|          | 0/19 [00:00<?, ?it/s][A
 11%|â–ˆ         | 2/19 [00:00<00:08,  2.10it/s][A
 16%|â–ˆâ–Œ        | 3/19 [00:01<00:10,  1.47it/s][A
 21%|â–ˆâ–ˆ        | 4/19 [00:02<00:11,  1.28it/s][A
 26%|â–ˆâ–ˆâ–‹       | 5/19 [00:03<00:11,  1.19it/s][A
 32%|â–ˆâ–ˆâ–ˆâ–      | 6/19 [00:04<00:11,  1.14it/s][A
 37%|â–ˆâ–ˆâ–ˆâ–‹      | 7/19 [00:05<00:10,  1.10it/s][A
 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 8/19 [00:06<00:10,  1.08it/s][A
 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 9/19 [00:07<00:09,  1.07it/s][A
 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 10/19 [00:08<00:08,  1.06it/s][A
 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 11/19 [00:09<00:07,  1.06it/s][A
 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 12/19 [00:10<00:06,  1.05it/s][A
 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 13/19 [00:11<00:05,  1.05it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 14/19 [00:12<00:04,  1.05it/s][A
 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 15/19 [00:13<00:03,  1.05it/s][A
 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 16/19 [00:14<00:02,  1.05it/s][A
 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 17/19 [00:15<00:01,  1.05it/s][A
 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 18/19 [00:16<00:00,  1.05it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 19/19 [00:17<00:00,  1.08it/s][A2025-05-19 13:08:37,190 - INFO - Logits shape : (1818, 3) and logits squeeze shape : (1818, 3)
                                               
                                               [A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 45/90 [02:15<01:34,  2.10s/it]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 19/19 [00:17<00:00,  1.08it/s][A
                                               [A 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 46/90 [02:20<06:05,  8.31s/it] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 47/90 [02:22<04:44,  6.61s/it] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 48/90 [02:25<03:47,  5.42s/it] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 49/90 [02:28<03:08,  4.59s/it] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 50/90 [02:30<02:40,  4.00s/it] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 51/90 [02:33<02:20,  3.60s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 52/90 [02:36<02:05,  3.31s/it] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 53/90 [02:38<01:55,  3.11s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 54/90 [02:41<01:46,  2.97s/it] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 55/90 [02:43<01:40,  2.87s/it] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 56/90 [02:46<01:35,  2.80s/it] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 57/90 [02:49<01:30,  2.75s/it] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 58/90 [02:51<01:27,  2.72s/it] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 59/90 [02:54<01:23,  2.71s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 60/90 [02:57<01:20,  2.69s/it] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 61/90 [02:59<01:17,  2.67s/it] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 62/90 [03:02<01:14,  2.67s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 63/90 [03:05<01:11,  2.66s/it] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 64/90 [03:07<01:09,  2.66s/it] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 65/90 [03:10<01:06,  2.65s/it] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 66/90 [03:13<01:03,  2.65s/it] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 67/90 [03:15<01:01,  2.65s/it] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 68/90 [03:18<00:58,  2.65s/it] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 69/90 [03:21<00:55,  2.65s/it] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 70/90 [03:23<00:53,  2.65s/it] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 71/90 [03:26<00:50,  2.65s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 72/90 [03:28<00:47,  2.65s/it] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 73/90 [03:31<00:45,  2.65s/it] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 74/90 [03:34<00:42,  2.65s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 75/90 [03:36<00:39,  2.65s/it] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 76/90 [03:39<00:37,  2.65s/it] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 77/90 [03:42<00:34,  2.65s/it] 87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 78/90 [03:44<00:31,  2.65s/it] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 79/90 [03:47<00:29,  2.65s/it] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 80/90 [03:50<00:26,  2.65s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 81/90 [03:52<00:23,  2.65s/it] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 82/90 [03:55<00:21,  2.65s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 83/90 [03:58<00:18,  2.65s/it] 93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž| 84/90 [04:00<00:15,  2.65s/it] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 85/90 [04:03<00:13,  2.66s/it] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 86/90 [04:06<00:10,  2.65s/it] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 87/90 [04:08<00:07,  2.66s/it] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 88/90 [04:11<00:05,  2.66s/it] 99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 89/90 [04:14<00:02,  2.64s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [04:14<00:00,  2.10s/it]                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [04:14<00:00,  2.10s/it]{'eval_loss': 1.4095072746276855, 'eval_f1_weighted': 0.31151829825793975, 'eval_recall_weighted': 0.9660460021905805, 'eval_precision_weighted': 0.18617585204288403, 'eval_accuracy': 0.00055005500550055, 'eval_runtime': 18.1709, 'eval_samples_per_second': 100.05, 'eval_steps_per_second': 1.046, 'epoch': 1.0}
{'loss': 1.3932, 'grad_norm': 11.311655044555664, 'learning_rate': 0.0, 'epoch': 2.0}

  0%|          | 0/19 [00:00<?, ?it/s][A
 11%|â–ˆ         | 2/19 [00:00<00:08,  2.09it/s][A
 16%|â–ˆâ–Œ        | 3/19 [00:01<00:10,  1.47it/s][A
 21%|â–ˆâ–ˆ        | 4/19 [00:02<00:11,  1.28it/s][A
 26%|â–ˆâ–ˆâ–‹       | 5/19 [00:03<00:11,  1.18it/s][A
 32%|â–ˆâ–ˆâ–ˆâ–      | 6/19 [00:04<00:11,  1.12it/s][A
 37%|â–ˆâ–ˆâ–ˆâ–‹      | 7/19 [00:05<00:10,  1.10it/s][A
 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 8/19 [00:06<00:10,  1.08it/s][A
 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 9/19 [00:07<00:09,  1.06it/s][A
 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 10/19 [00:08<00:08,  1.06it/s][A
 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 11/19 [00:09<00:07,  1.05it/s][A
 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 12/19 [00:10<00:06,  1.05it/s][A
 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 13/19 [00:11<00:05,  1.05it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 14/19 [00:12<00:04,  1.05it/s][A
 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 15/19 [00:13<00:03,  1.05it/s][A
 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 16/19 [00:14<00:02,  1.04it/s][A
 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 17/19 [00:15<00:01,  1.04it/s][A
 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 18/19 [00:16<00:00,  1.04it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 19/19 [00:17<00:00,  1.07it/s][A2025-05-19 13:10:54,798 - INFO - Logits shape : (1818, 3) and logits squeeze shape : (1818, 3)
                                               
                                               [A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [04:33<00:00,  2.10s/it]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 19/19 [00:17<00:00,  1.07it/s][A
                                               [A                                               100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [04:35<00:00,  2.10s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 90/90 [04:35<00:00,  3.06s/it]
{'eval_loss': 1.3836249113082886, 'eval_f1_weighted': 0.3186184279995286, 'eval_recall_weighted': 0.963855421686747, 'eval_precision_weighted': 0.19114767577322672, 'eval_accuracy': 0.0022002200220022, 'eval_runtime': 18.2734, 'eval_samples_per_second': 99.489, 'eval_steps_per_second': 1.04, 'epoch': 2.0}
{'train_runtime': 275.0494, 'train_samples_per_second': 30.845, 'train_steps_per_second': 0.327, 'train_loss': 1.4301344553629558, 'epoch': 2.0}
  0%|          | 0/19 [00:00<?, ?it/s] 11%|â–ˆ         | 2/19 [00:00<00:08,  2.01it/s] 16%|â–ˆâ–Œ        | 3/19 [00:01<00:11,  1.45it/s] 21%|â–ˆâ–ˆ        | 4/19 [00:02<00:11,  1.27it/s] 26%|â–ˆâ–ˆâ–‹       | 5/19 [00:03<00:11,  1.17it/s] 32%|â–ˆâ–ˆâ–ˆâ–      | 6/19 [00:04<00:11,  1.13it/s] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 7/19 [00:05<00:10,  1.10it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 8/19 [00:06<00:10,  1.08it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 9/19 [00:07<00:09,  1.06it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 10/19 [00:08<00:08,  1.05it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 11/19 [00:09<00:07,  1.05it/s] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 12/19 [00:10<00:06,  1.05it/s] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 13/19 [00:11<00:05,  1.05it/s] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 14/19 [00:12<00:04,  1.04it/s] 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 15/19 [00:13<00:03,  1.04it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 16/19 [00:14<00:02,  1.04it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 17/19 [00:15<00:01,  1.04it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 18/19 [00:16<00:00,  1.04it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 19/19 [00:17<00:00,  1.07it/s]2025-05-19 13:11:15,147 - INFO - Logits shape : (1818, 3) and logits squeeze shape : (1818, 3)
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 19/19 [00:17<00:00,  1.10it/s]
2025-05-19 13:11:15,156 - INFO - Training time : 294.7747276640148
  0%|          | 0/64 [00:00<?, ?it/s]  3%|â–Ž         | 2/64 [00:00<00:30,  2.06it/s]  5%|â–         | 3/64 [00:01<00:41,  1.47it/s]  6%|â–‹         | 4/64 [00:02<00:47,  1.28it/s]  8%|â–Š         | 5/64 [00:03<00:49,  1.19it/s]  9%|â–‰         | 6/64 [00:04<00:51,  1.14it/s] 11%|â–ˆ         | 7/64 [00:05<00:51,  1.10it/s] 12%|â–ˆâ–Ž        | 8/64 [00:06<00:51,  1.08it/s] 14%|â–ˆâ–        | 9/64 [00:07<00:51,  1.07it/s] 16%|â–ˆâ–Œ        | 10/64 [00:08<00:50,  1.06it/s] 17%|â–ˆâ–‹        | 11/64 [00:09<00:50,  1.05it/s] 19%|â–ˆâ–‰        | 12/64 [00:10<00:49,  1.05it/s] 20%|â–ˆâ–ˆ        | 13/64 [00:11<00:48,  1.05it/s] 22%|â–ˆâ–ˆâ–       | 14/64 [00:12<00:48,  1.04it/s] 23%|â–ˆâ–ˆâ–Ž       | 15/64 [00:13<00:47,  1.04it/s] 25%|â–ˆâ–ˆâ–Œ       | 16/64 [00:14<00:46,  1.04it/s] 27%|â–ˆâ–ˆâ–‹       | 17/64 [00:15<00:45,  1.03it/s] 28%|â–ˆâ–ˆâ–Š       | 18/64 [00:16<00:44,  1.04it/s] 30%|â–ˆâ–ˆâ–‰       | 19/64 [00:17<00:43,  1.04it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 20/64 [00:18<00:42,  1.04it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 21/64 [00:19<00:41,  1.04it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 22/64 [00:20<00:40,  1.04it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 23/64 [00:21<00:39,  1.04it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 24/64 [00:22<00:38,  1.04it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 25/64 [00:23<00:37,  1.05it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 26/64 [00:24<00:36,  1.04it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 27/64 [00:24<00:35,  1.04it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 28/64 [00:25<00:34,  1.04it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 29/64 [00:26<00:33,  1.04it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 30/64 [00:27<00:32,  1.04it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 31/64 [00:28<00:31,  1.04it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 32/64 [00:29<00:30,  1.05it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 33/64 [00:30<00:29,  1.05it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 34/64 [00:31<00:28,  1.05it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 35/64 [00:32<00:27,  1.05it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 36/64 [00:33<00:26,  1.05it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 37/64 [00:34<00:25,  1.05it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 38/64 [00:35<00:24,  1.05it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 39/64 [00:36<00:23,  1.05it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 40/64 [00:37<00:22,  1.05it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 41/64 [00:38<00:21,  1.05it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 42/64 [00:39<00:20,  1.05it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 43/64 [00:40<00:20,  1.04it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 44/64 [00:41<00:19,  1.04it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 45/64 [00:42<00:18,  1.04it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 46/64 [00:43<00:17,  1.04it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 47/64 [00:44<00:16,  1.04it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 48/64 [00:45<00:15,  1.04it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 49/64 [00:46<00:14,  1.05it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 50/64 [00:47<00:13,  1.05it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 51/64 [00:47<00:12,  1.05it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 52/64 [00:48<00:11,  1.05it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 53/64 [00:49<00:10,  1.05it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 54/64 [00:50<00:09,  1.05it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 55/64 [00:51<00:08,  1.05it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 56/64 [00:52<00:07,  1.05it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 57/64 [00:53<00:06,  1.05it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 58/64 [00:54<00:05,  1.05it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 59/64 [00:55<00:04,  1.05it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 60/64 [00:56<00:03,  1.05it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 61/64 [00:57<00:03,  1.02s/it] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 62/64 [00:58<00:02,  1.01s/it] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 63/64 [00:59<00:00,  1.02it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:59<00:00,  1.29it/s]2025-05-19 13:12:16,090 - INFO - Logits shape : (6060, 3) and logits squeeze shape : (6060, 3)
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:59<00:00,  1.07it/s]
2025-05-19 13:12:16,103 - INFO - Evaluation time : 60.94705315900501
2025-05-19 13:12:16,103 - INFO - Evaluation results on test set: {'eval_loss': 1.3862556219100952, 'eval_f1_weighted': 0.31721243913750335, 'eval_recall_weighted': 0.958634274458306, 'eval_precision_weighted': 0.190346342681318, 'eval_accuracy': 0.0016501650165016502, 'eval_runtime': 60.9445, 'eval_samples_per_second': 99.435, 'eval_steps_per_second': 1.05, 'epoch': 2.0}
2025-05-19 13:12:16,103 - INFO - Total updates (optimizer steps): 90
2025-05-19 13:12:16,103 - INFO - Avg time / step: 3.058s
2025-05-19 13:12:16,892 - INFO - Best model saved to ./final_model/best_model_cross_val_BCEmicrosoft/BiomedNLP-BiomedBERT-base-uncased-abstract1trials_fold-2
2025-05-19 13:12:16,892 - INFO - On test Set (with threshold 0.5) : 
  0%|          | 0/64 [00:00<?, ?it/s]  3%|â–Ž         | 2/64 [00:00<00:29,  2.11it/s]  5%|â–         | 3/64 [00:01<00:41,  1.48it/s]  6%|â–‹         | 4/64 [00:02<00:46,  1.28it/s]  8%|â–Š         | 5/64 [00:03<00:49,  1.19it/s]  9%|â–‰         | 6/64 [00:04<00:50,  1.14it/s] 11%|â–ˆ         | 7/64 [00:05<00:51,  1.11it/s] 12%|â–ˆâ–Ž        | 8/64 [00:06<00:51,  1.09it/s] 14%|â–ˆâ–        | 9/64 [00:07<00:51,  1.07it/s] 16%|â–ˆâ–Œ        | 10/64 [00:08<00:50,  1.06it/s] 17%|â–ˆâ–‹        | 11/64 [00:09<00:50,  1.06it/s] 19%|â–ˆâ–‰        | 12/64 [00:10<00:49,  1.05it/s] 20%|â–ˆâ–ˆ        | 13/64 [00:11<00:48,  1.05it/s] 22%|â–ˆâ–ˆâ–       | 14/64 [00:12<00:47,  1.05it/s] 23%|â–ˆâ–ˆâ–Ž       | 15/64 [00:13<00:46,  1.04it/s] 25%|â–ˆâ–ˆâ–Œ       | 16/64 [00:14<00:46,  1.04it/s] 27%|â–ˆâ–ˆâ–‹       | 17/64 [00:15<00:45,  1.04it/s] 28%|â–ˆâ–ˆâ–Š       | 18/64 [00:16<00:44,  1.04it/s] 30%|â–ˆâ–ˆâ–‰       | 19/64 [00:17<00:43,  1.04it/s] 31%|â–ˆâ–ˆâ–ˆâ–      | 20/64 [00:18<00:42,  1.04it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 21/64 [00:19<00:41,  1.04it/s] 34%|â–ˆâ–ˆâ–ˆâ–      | 22/64 [00:20<00:40,  1.04it/s] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 23/64 [00:21<00:39,  1.04it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 24/64 [00:22<00:38,  1.04it/s] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 25/64 [00:23<00:37,  1.04it/s] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 26/64 [00:23<00:36,  1.04it/s] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 27/64 [00:24<00:35,  1.04it/s] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 28/64 [00:25<00:34,  1.04it/s] 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 29/64 [00:26<00:33,  1.05it/s] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 30/64 [00:27<00:32,  1.04it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 31/64 [00:28<00:31,  1.05it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 32/64 [00:29<00:30,  1.05it/s] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 33/64 [00:30<00:29,  1.04it/s] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 34/64 [00:31<00:28,  1.04it/s] 55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 35/64 [00:32<00:27,  1.04it/s] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 36/64 [00:33<00:26,  1.04it/s] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 37/64 [00:34<00:25,  1.04it/s] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 38/64 [00:35<00:24,  1.05it/s] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 39/64 [00:36<00:23,  1.05it/s] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 40/64 [00:37<00:22,  1.05it/s] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 41/64 [00:38<00:22,  1.04it/s] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 42/64 [00:39<00:21,  1.04it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 43/64 [00:40<00:20,  1.05it/s] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 44/64 [00:41<00:19,  1.04it/s] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 45/64 [00:42<00:18,  1.05it/s] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 46/64 [00:43<00:17,  1.05it/s] 73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 47/64 [00:44<00:16,  1.05it/s] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 48/64 [00:45<00:15,  1.05it/s] 77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 49/64 [00:45<00:14,  1.05it/s] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 50/64 [00:46<00:13,  1.05it/s] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 51/64 [00:47<00:12,  1.05it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 52/64 [00:48<00:11,  1.05it/s] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 53/64 [00:49<00:10,  1.04it/s] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 54/64 [00:50<00:09,  1.04it/s] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 55/64 [00:51<00:08,  1.04it/s] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 56/64 [00:52<00:07,  1.04it/s] 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 57/64 [00:53<00:06,  1.05it/s] 91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 58/64 [00:54<00:05,  1.05it/s] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 59/64 [00:55<00:04,  1.05it/s] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 60/64 [00:56<00:03,  1.05it/s] 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 61/64 [00:57<00:02,  1.05it/s] 97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 62/64 [00:58<00:01,  1.05it/s] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 63/64 [00:59<00:00,  1.06it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:59<00:00,  1.34it/s]2025-05-19 13:13:17,536 - INFO - Logits shape : (6060, 3) and logits squeeze shape : (6060, 3)
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 64/64 [00:59<00:00,  1.07it/s]
2025-05-19 13:13:17,612 - INFO - label vals shape : (6060, 3)
2025-05-19 13:13:17,612 - INFO - predictions vals shape : (6060, 3)
2025-05-19 13:13:17,751 - INFO - Metrics: {'f1_IAS': 0.3579661016949153, 'f1_SUA': 0.2625375548879131, 'f1_VA': 0.3010940919037199, 'f1_weighted': 0.31721243913750335, 'f1_macro': 0.3071992494955161, 'f1_micro': 0.3147060408471197, 'recall_IAS': 0.9947249434815373, 'recall_SUA': 0.8304093567251462, 'recall_VA': 0.9971014492753624, 'recall_weighted': 0.958634274458306, 'recall_macro': 0.9407452498273486, 'recall_micro': 0.958634274458306, 'precision_IAS': 0.21825396825396826, 'precision_SUA': 0.15591545429590997, 'precision_VA': 0.177319587628866, 'precision_weighted': 0.190346342681318, 'precision_macro': 0.1838296700595814, 'precision_micro': 0.18825349751789053, 'accuracy': 0.0016501650165016502}
2025-05-19 13:13:17,752 - INFO - Results for fold 2 : [{'f1_IAS': 0.3579661016949153, 'f1_SUA': 0.2625375548879131, 'f1_VA': 0.3010940919037199, 'f1_weighted': 0.31721243913750335, 'f1_macro': 0.3071992494955161, 'f1_micro': 0.3147060408471197, 'recall_IAS': 0.9947249434815373, 'recall_SUA': 0.8304093567251462, 'recall_VA': 0.9971014492753624, 'recall_weighted': 0.958634274458306, 'recall_macro': 0.9407452498273486, 'recall_micro': 0.958634274458306, 'precision_IAS': 0.21825396825396826, 'precision_SUA': 0.15591545429590997, 'precision_VA': 0.177319587628866, 'precision_weighted': 0.190346342681318, 'precision_macro': 0.1838296700595814, 'precision_micro': 0.18825349751789053, 'accuracy': 0.0016501650165016502}]
2025-05-19 13:13:17,928 - INFO - Cleared CUDA cache. Memory allocated: 0.02 GB, Memory reserved: 0.06 GB
2025-05-19 13:13:17,945 - INFO - Metrics for microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract:                                           model_name  ... precision_micro
0  microsoft/BiomedNLP-BiomedBERT-base-uncased-ab...  ...        0.188577
0  microsoft/BiomedNLP-BiomedBERT-base-uncased-ab...  ...        0.188253

[2 rows x 29 columns]
2025-05-19 13:13:17,945 - INFO - Training model 2/5: microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext
2025-05-19 13:13:18,188 - INFO - 
fold number 1 / 2
2025-05-19 13:13:18,230 - INFO - train+dev split size : 6060
2025-05-19 13:13:18,230 - INFO - test split size : 6060
2025-05-19 13:13:18,388 - INFO - train split size : 4242
2025-05-19 13:13:18,389 - INFO - dev split size : 1818
Map:   0%|          | 0/4242 [00:00<?, ? examples/s]Map:  24%|â–ˆâ–ˆâ–Ž       | 1000/4242 [00:01<00:04, 728.20 examples/s]Map:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 2000/4242 [00:02<00:02, 758.09 examples/s]Map:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 3000/4242 [00:03<00:01, 772.67 examples/s]Map:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 4000/4242 [00:05<00:00, 812.22 examples/s]Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4242/4242 [00:05<00:00, 804.23 examples/s]Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4242/4242 [00:05<00:00, 788.40 examples/s]
Map:   0%|          | 0/1818 [00:00<?, ? examples/s]Map:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 1000/1818 [00:01<00:01, 804.20 examples/s]Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1818/1818 [00:02<00:00, 805.68 examples/s]Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1818/1818 [00:02<00:00, 802.31 examples/s]
Map:   0%|          | 0/6060 [00:00<?, ? examples/s]Map:  17%|â–ˆâ–‹        | 1000/6060 [00:01<00:05, 881.67 examples/s]Map:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2000/6060 [00:02<00:04, 867.90 examples/s]Map:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 3000/6060 [00:03<00:03, 900.77 examples/s]Map:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 4000/6060 [00:04<00:02, 862.96 examples/s]Map:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5000/6060 [00:05<00:01, 850.24 examples/s]Map:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 6000/6060 [00:06<00:00, 868.24 examples/s]Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6060/6060 [00:06<00:00, 867.58 examples/s]
2025-05-19 13:13:34,806 - INFO - Starting hyperparameter search for BCE loss
[36m(train_hpo pid=147157)[0m Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext and are newly initialized: ['classifier.bias', 'classifier.weight']
[36m(train_hpo pid=147157)[0m You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[36m(train_hpo pid=147157)[0m 2025-05-19 13:13:43,744 - INFO - pos_weight value in TrainingArguments : 8.493688290834637
[36m(train_hpo pid=147157)[0m /home/leandre/Projects/BioMoQA_Playground/model/model_init.py:114: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
[36m(train_hpo pid=147157)[0m   super().__init__(*args, **kwargs)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Configuration for experiment     train_hpo_2025-05-19_13-13-34   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search algorithm                 SearchGenerator                 â”‚
â”‚ Scheduler                        AsyncHyperBandScheduler         â”‚
â”‚ Number of trials                 1                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

View detailed results here: /home/leandre/Projects/BioMoQA_Playground/model/ray_results/train_hpo_2025-05-19_13-13-34
To visualize your results with TensorBoard, run: `tensorboard --logdir /tmp/ray/session_2025-05-19_12-48-49_275921_119885/artifacts/2025-05-19_13-13-34/train_hpo_2025-05-19_13-13-34/driver_artifacts`

Trial status: 1 PENDING
Current time: 2025-05-19 13:13:35. Total running time: 0s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_28325b7a   PENDING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_28325b7a started with configuration:
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_28325b7a config             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ learning_rate                             0 â”‚
â”‚ num_train_epochs                          2 â”‚
â”‚ pos_weight                          8.49369 â”‚
â”‚ weight_decay                        0.13641 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=147157)[0m [2025-05-19 13:13:43,968] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[36m(train_hpo pid=147157)[0m STATE at beggining of training :  TrainerState(epoch=0, global_step=0, max_steps=22, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=96, num_train_epochs=2, num_input_tokens_seen=0, total_flos=0, log_history=[], best_metric=None, best_model_checkpoint=None, is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': False, 'should_epoch_stop': False, 'should_save': False, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})

Trial status: 1 RUNNING
Current time: 2025-05-19 13:14:05. Total running time: 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_28325b7a   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
Trial status: 1 RUNNING
Current time: 2025-05-19 13:14:35. Total running time: 1min 0s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_28325b7a   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
Trial status: 1 RUNNING
Current time: 2025-05-19 13:15:05. Total running time: 1min 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_28325b7a   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
Trial status: 1 RUNNING
Current time: 2025-05-19 13:15:35. Total running time: 2min 0s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)[36m(train_hpo pid=147157)[0m 2025-05-19 13:16:02,649 - INFO - Logits shape : (1818, 3) and logits squeeze shape : (1818, 3)

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_28325b7a   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=147157)[0m {'loss': 1.4441, 'grad_norm': 0.929195761680603, 'learning_rate': 6.798212053829252e-07, 'epoch': 1.0}
[36m(train_hpo pid=147157)[0m {'eval_loss': 1.506899356842041, 'eval_f1_weighted': 0.30726951911266914, 'eval_recall_weighted': 0.7086527929901424, 'eval_precision_weighted': 0.20836977576158813, 'eval_accuracy': 0.06875687568756876, 'eval_runtime': 18.1193, 'eval_samples_per_second': 100.335, 'eval_steps_per_second': 1.049, 'epoch': 1.0}
Trial status: 1 RUNNING
Current time: 2025-05-19 13:16:05. Total running time: 2min 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_28325b7a   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
Trial status: 1 RUNNING
Current time: 2025-05-19 13:16:35. Total running time: 3min 0s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_28325b7a   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
Trial status: 1 RUNNING
Current time: 2025-05-19 13:17:05. Total running time: 3min 30s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_28325b7a   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
Trial status: 1 RUNNING
Current time: 2025-05-19 13:17:35. Total running time: 4min 0s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_28325b7a   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
[36m(train_hpo pid=147157)[0m {'loss': 1.5007, 'grad_norm': 3.0502827167510986, 'learning_rate': 0.0, 'epoch': 1.8888888888888888}
Trial status: 1 RUNNING
Current time: 2025-05-19 13:18:05. Total running time: 4min 31s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status       pos_weight     learning_rate     weight_decay     num_train_epochs â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_28325b7a   RUNNING         8.49369       1.49561e-06          0.13641                    2 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯[36m(train_hpo pid=147157)[0m 2025-05-19 13:18:08,387 - INFO - Logits shape : (1818, 3) and logits squeeze shape : (1818, 3)
[36m(train_hpo pid=147157)[0m 2025-05-19 13:18:28,761 - INFO - Logits shape : (1818, 3) and logits squeeze shape : (1818, 3)
[36m(train_hpo pid=147157)[0m 2025-05-19 13:18:28,770 - INFO - eval_result: {'eval_loss': 1.4943928718566895, 'eval_f1_weighted': 0.32480880848442134, 'eval_recall_weighted': 0.7743702081051479, 'eval_precision_weighted': 0.21233709143549054, 'eval_accuracy': 0.061606160616061605, 'eval_runtime': 18.1302, 'eval_samples_per_second': 100.275, 'eval_steps_per_second': 1.048, 'epoch': 1.8888888888888888}
2025-05-19 13:18:28,955	INFO tune.py:1009 -- Wrote the latest version of all result files and experiment state to '/home/leandre/Projects/BioMoQA_Playground/model/ray_results/train_hpo_2025-05-19_13-13-34' in 0.0042s.
2025-05-19 13:18:28,959 - INFO - Analysis results: <ray.tune.analysis.experiment_analysis.ExperimentAnalysis object at 0x77b7581f5e90>
2025-05-19 13:18:28,959 - INFO - Best trial : train_hpo_28325b7a
2025-05-19 13:18:28,959 - INFO - Best config : {'pos_weight': 8.493688290834637, 'learning_rate': 1.4956066518424355e-06, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 2}
2025-05-19 13:18:28,959 - INFO - Best trial after optimization: {'eval_loss': 1.4943928718566895, 'eval_f1_weighted': 0.32480880848442134, 'eval_recall_weighted': 0.7743702081051479, 'eval_precision_weighted': 0.21233709143549054, 'eval_accuracy': 0.061606160616061605, 'eval_runtime': 18.1302, 'eval_samples_per_second': 100.275, 'eval_steps_per_second': 1.048, 'epoch': 1.8888888888888888, 'timestamp': 1747653508, 'checkpoint_dir_name': None, 'done': True, 'training_iteration': 1, 'trial_id': '28325b7a', 'date': '2025-05-19_13-18-28', 'time_this_iter_s': 286.96751046180725, 'time_total_s': 286.96751046180725, 'pid': 147157, 'hostname': 'lcatogni', 'node_ip': '172.30.120.56', 'config': {'pos_weight': 8.493688290834637, 'learning_rate': 1.4956066518424355e-06, 'weight_decay': 0.13641031566641162, 'num_train_epochs': 2}, 'time_since_restore': 286.96751046180725, 'iterations_since_restore': 1, 'experiment_tag': '1_learning_rate=0.0000,num_train_epochs=2,pos_weight=8.4937,weight_decay=0.1364'}
2025-05-19 13:18:28,961 - WARNING - Could not create parallel coordinates plot: 'ExperimentAnalysis' object has no attribute 'plot_parallel_coordinates'
2025-05-19 13:18:28,977 - INFO - analysis dataframe :    eval_loss  eval_f1_weighted  ...  config/num_train_epochs    logdir
0   1.494393          0.324809  ...                        2  28325b7a

[1 rows x 27 columns]
2025-05-19 13:18:28,977 - INFO - Final training...
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at microsoft/BiomedNLP-BiomedBERT-base-uncased-abstract-fulltext and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-05-19 13:18:29,617 - INFO - Positive weight parameter set to default (in TrainingArguments) -> pos_weight=5.0
/home/leandre/Projects/BioMoQA_Playground/model/model_init.py:114: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `CustomTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
2025-05-19 13:18:29,781 - INFO - training size : 4242
2025-05-19 13:18:29,781 - INFO - test size : 6060

[36m(train_hpo pid=147157)[0m {'eval_loss': 1.4943928718566895, 'eval_f1_weighted': 0.32480880848442134, 'eval_recall_weighted': 0.7743702081051479, 'eval_precision_weighted': 0.21233709143549054, 'eval_accuracy': 0.061606160616061605, 'eval_runtime': 18.1575, 'eval_samples_per_second': 100.124, 'eval_steps_per_second': 1.046, 'epoch': 1.8888888888888888}
[36m(train_hpo pid=147157)[0m {'train_runtime': 263.4218, 'train_samples_per_second': 32.207, 'train_steps_per_second': 0.084, 'train_loss': 1.469870003786954, 'epoch': 1.8888888888888888}
[36m(train_hpo pid=147157)[0m STATE at ending of training  :  TrainerState(epoch=1.8888888888888888, global_step=22, max_steps=22, logging_steps=500, eval_steps=500, save_steps=500, train_batch_size=96, num_train_epochs=2, num_input_tokens_seen=0, total_flos=2126482642077696.0, log_history=[{'loss': 1.4441, 'grad_norm': 0.929195761680603, 'learning_rate': 6.798212053829252e-07, 'epoch': 1.0, 'step': 12}, {'eval_loss': 1.506899356842041, 'eval_f1_weighted': 0.30726951911266914, 'eval_recall_weighted': 0.7086527929901424, 'eval_precision_weighted': 0.20836977576158813, 'eval_accuracy': 0.06875687568756876, 'eval_runtime': 18.1193, 'eval_samples_per_second': 100.335, 'eval_steps_per_second': 1.049, 'epoch': 1.0, 'step': 12}, {'loss': 1.5007, 'grad_norm': 3.0502827167510986, 'learning_rate': 0.0, 'epoch': 1.8888888888888888, 'step': 22}, {'eval_loss': 1.4943928718566895, 'eval_f1_weighted': 0.32480880848442134, 'eval_recall_weighted': 0.7743702081051479, 'eval_precision_weighted': 0.21233709143549054, 'eval_accuracy': 0.061606160616061605, 'eval_runtime': 18.1575, 'eval_samples_per_second': 100.124, 'eval_steps_per_second': 1.046, 'epoch': 1.8888888888888888, 'step': 22}, {'train_runtime': 263.4218, 'train_samples_per_second': 32.207, 'train_steps_per_second': 0.084, 'total_flos': 2126482642077696.0, 'train_loss': 1.469870003786954, 'epoch': 1.8888888888888888, 'step': 22}], best_metric=0.32480880848442134, best_model_checkpoint='./checkpoint-22', is_local_process_zero=True, is_world_process_zero=True, is_hyper_param_search=False, trial_name=None, trial_params=None, stateful_callbacks={'TrainerControl': {'args': {'should_training_stop': True, 'should_epoch_stop': False, 'should_save': True, 'should_evaluate': False, 'should_log': False}, 'attributes': {}}})
[36m(train_hpo pid=147157)[0m {'eval_loss': 1.4943928718566895, 'eval_f1_weighted': 0.32480880848442134, 'eval_recall_weighted': 0.7743702081051479, 'eval_precision_weighted': 0.21233709143549054, 'eval_accuracy': 0.061606160616061605, 'eval_runtime': 18.1302, 'eval_samples_per_second': 100.275, 'eval_steps_per_second': 1.048, 'epoch': 1.8888888888888888}

Trial train_hpo_28325b7a finished iteration 1 at 2025-05-19 13:18:28. Total running time: 4min 54s
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial train_hpo_28325b7a result             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ checkpoint_dir_name                         â”‚
â”‚ time_this_iter_s                    286.968 â”‚
â”‚ time_total_s                        286.968 â”‚
â”‚ training_iteration                        1 â”‚
â”‚ epoch                               1.88889 â”‚
â”‚ eval_accuracy                       0.06161 â”‚
â”‚ eval_f1_weighted                    0.32481 â”‚
â”‚ eval_loss                           1.49439 â”‚
â”‚ eval_precision_weighted             0.21234 â”‚
â”‚ eval_recall_weighted                0.77437 â”‚
â”‚ eval_runtime                        18.1302 â”‚
â”‚ eval_samples_per_second             100.275 â”‚
â”‚ eval_steps_per_second                 1.048 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

Trial train_hpo_28325b7a completed after 1 iterations at 2025-05-19 13:18:28. Total running time: 4min 54s

Trial status: 1 TERMINATED
Current time: 2025-05-19 13:18:28. Total running time: 4min 54s
Logical resource usage: 30.0/32 CPUs, 3.0/3 GPUs (0.0/1.0 accelerator_type:A100D)
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Trial name           status         pos_weight     learning_rate     weight_decay     num_train_epochs     iter     total time (s)     eval_loss     eval_f1_weighted     eval_recall_weighted     ...recision_weighted â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ train_hpo_28325b7a   TERMINATED        8.49369       1.49561e-06          0.13641                    2        1            286.968       1.49439             0.324809                  0.77437                 0.212337 â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

  0%|          | 0/90 [00:00<?, ?it/s]  1%|          | 1/90 [00:02<04:01,  2.72s/it]  2%|â–         | 2/90 [00:05<03:56,  2.69s/it]  3%|â–Ž         | 3/90 [00:08<03:52,  2.68s/it]  4%|â–         | 4/90 [00:10<03:49,  2.66s/it]  6%|â–Œ         | 5/90 [00:13<03:45,  2.66s/it]  7%|â–‹         | 6/90 [00:15<03:42,  2.65s/it]  8%|â–Š         | 7/90 [00:18<03:40,  2.66s/it]  9%|â–‰         | 8/90 [00:21<03:37,  2.65s/it] 10%|â–ˆ         | 9/90 [00:23<03:34,  2.65s/it] 11%|â–ˆ         | 10/90 [00:26<03:32,  2.65s/it] 12%|â–ˆâ–        | 11/90 [00:29<03:30,  2.66s/it] 13%|â–ˆâ–Ž        | 12/90 [00:31<03:27,  2.66s/it] 14%|â–ˆâ–        | 13/90 [00:34<03:24,  2.66s/it] 16%|â–ˆâ–Œ        | 14/90 [00:37<03:21,  2.65s/it] 17%|â–ˆâ–‹        | 15/90 [00:39<03:19,  2.65s/it] 18%|â–ˆâ–Š        | 16/90 [00:42<03:16,  2.65s/it] 19%|â–ˆâ–‰        | 17/90 [00:45<03:13,  2.65s/it] 20%|â–ˆâ–ˆ        | 18/90 [00:47<03:10,  2.65s/it] 21%|â–ˆâ–ˆ        | 19/90 [00:50<03:08,  2.65s/it] 22%|â–ˆâ–ˆâ–       | 20/90 [00:53<03:05,  2.65s/it] 23%|â–ˆâ–ˆâ–Ž       | 21/90 [00:55<03:02,  2.65s/it] 24%|â–ˆâ–ˆâ–       | 22/90 [00:58<03:00,  2.65s/it] 26%|â–ˆâ–ˆâ–Œ       | 23/90 [01:01<02:57,  2.65s/it] 27%|â–ˆâ–ˆâ–‹       | 24/90 [01:03<02:54,  2.65s/it] 28%|â–ˆâ–ˆâ–Š       | 25/90 [01:06<02:52,  2.65s/it] 29%|â–ˆâ–ˆâ–‰       | 26/90 [01:09<02:49,  2.65s/it] 30%|â–ˆâ–ˆâ–ˆ       | 27/90 [01:11<02:46,  2.65s/it] 31%|â–ˆâ–ˆâ–ˆ       | 28/90 [01:14<02:44,  2.65s/it] 32%|â–ˆâ–ˆâ–ˆâ–      | 29/90 [01:16<02:41,  2.65s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 30/90 [01:19<02:39,  2.65s/it] 34%|â–ˆâ–ˆâ–ˆâ–      | 31/90 [01:22<02:36,  2.65s/it] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 32/90 [01:24<02:33,  2.65s/it] 37%|â–ˆâ–ˆâ–ˆâ–‹      | 33/90 [01:27<02:31,  2.65s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 34/90 [01:30<02:28,  2.65s/it] 39%|â–ˆâ–ˆâ–ˆâ–‰      | 35/90 [01:32<02:25,  2.65s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 36/90 [01:35<02:23,  2.65s/it] 41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 37/90 [01:38<02:20,  2.65s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 38/90 [01:40<02:17,  2.65s/it] 43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 39/90 [01:43<02:15,  2.65s/it] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 40/90 [01:46<02:12,  2.66s/it] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 41/90 [01:48<02:10,  2.66s/it] 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 42/90 [01:51<02:07,  2.66s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 43/90 [01:54<02:04,  2.65s/it] 49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 44/90 [01:56<02:01,  2.64s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 45/90 [01:57<01:34,  2.10s/it]                                                50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 45/90 [01:57<01:34,  2.10s/it]{'loss': 1.4626, 'grad_norm': 3.591754198074341, 'learning_rate': 7.478033259212177e-07, 'epoch': 1.0}

  0%|          | 0/19 [00:00<?, ?it/s][A
 11%|â–ˆ         | 2/19 [00:00<00:08,  2.09it/s][A
 16%|â–ˆâ–Œ        | 3/19 [00:01<00:10,  1.48it/s][A
 21%|â–ˆâ–ˆ        | 4/19 [00:02<00:11,  1.28it/s][A
 26%|â–ˆâ–ˆâ–‹       | 5/19 [00:03<00:11,  1.19it/s][A
 32%|â–ˆâ–ˆâ–ˆâ–      | 6/19 [00:04<00:11,  1.14it/s][A
 37%|â–ˆâ–ˆâ–ˆâ–‹      | 7/19 [00:05<00:10,  1.11it/s][A
 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 8/19 [00:06<00:10,  1.09it/s][A
 47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 9/19 [00:07<00:09,  1.07it/s][A
 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 10/19 [00:08<00:08,  1.06it/s][A
 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 11/19 [00:09<00:07,  1.05it/s][A
 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 12/19 [00:10<00:06,  1.05it/s][A
 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 13/19 [00:11<00:05,  1.05it/s][A
 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž  | 14/19 [00:12<00:04,  1.05it/s][A
 79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 15/19 [00:13<00:03,  1.04it/s][A
 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 16/19 [00:14<00:02,  1.04it/s][A
 89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 17/19 [00:15<00:01,  1.04it/s][A
 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 18/19 [00:16<00:00,  1.05it/s][A
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 19/19 [00:17<00:00,  1.07it/s][A2025-05-19 13:20:45,832 - INFO - Logits shape : (1818, 3) and logits squeeze shape : (1818, 3)
                                               
                                               [A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 45/90 [02:15<01:34,  2.10s/it]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 19/19 [00:17<00:00,  1.07it/s][A
                                               [A 51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 46/90 [02:19<06:00,  8.18s/it] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 47/90 [02:22<04:40,  6.52s/it] 53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 48/90 [02:25<03:45,  5.36s/it] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 49/90 [02:27<03:06,  4.55s/it] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 50/90 [02:30<02:39,  3.98s/it] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 51/90 [02:33<02:19,  3.58s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 52/90 [02:35<02:05,  3.30s/it] 59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 53/90 [02:38<01:54,  3.11s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 54/90 [02:41<01:46,  2.97s/it] 61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 55/90 [02:43<01:40,  2.87s/it] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 56/90 [02:46<01:35,  2.81s/it] 63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 57/90 [02:49<01:31,  2.76s/it] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 58/90 [02:51<01:27,  2.73s/it] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 59/90 [02:54<01:24,  2.71s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 60/90 [02:57<01:20,  2.69s/it] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 61/90 [02:59<01:17,  2.68s/it] 69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 62/90 [03:02<01:14,  2.67s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 63/90 [03:05<01:12,  2.67s/it]